(self.webpackChunkERP=self.webpackChunkERP||[]).push([[179],{1773:(Lf,Pd,vo)=>{"use strict";function fi(t){return"function"==typeof t}function Do(t){const e=t(n=>{Error.call(n),n.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const Ks=Do(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function Ia(t,i){if(t){const e=t.indexOf(i);0<=e&&t.splice(e,1)}}class lo{constructor(i){this.initialTeardown=i,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let i;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:n}=this;if(fi(n))try{n()}catch(o){i=o instanceof Ks?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{Io(o)}catch(c){i=null!=i?i:[],c instanceof Ks?i=[...i,...c.errors]:i.push(c)}}if(i)throw new Ks(i)}}add(i){var e;if(i&&i!==this)if(this.closed)Io(i);else{if(i instanceof lo){if(i.closed||i._hasParent(this))return;i._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(i)}}_hasParent(i){const{_parentage:e}=this;return e===i||Array.isArray(e)&&e.includes(i)}_addParent(i){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(i),e):e?[e,i]:i}_removeParent(i){const{_parentage:e}=this;e===i?this._parentage=null:Array.isArray(e)&&Ia(e,i)}remove(i){const{_finalizers:e}=this;e&&Ia(e,i),i instanceof lo&&i._removeParent(this)}}lo.EMPTY=(()=>{const t=new lo;return t.closed=!0,t})();const fa=lo.EMPTY;function vs(t){return t instanceof lo||t&&"closed"in t&&fi(t.remove)&&fi(t.add)&&fi(t.unsubscribe)}function Io(t){fi(t)?t():t.unsubscribe()}const Ao={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},pi={setTimeout(t,i,...e){const{delegate:n}=pi;return(null==n?void 0:n.setTimeout)?n.setTimeout(t,i,...e):setTimeout(t,i,...e)},clearTimeout(t){const{delegate:i}=pi;return((null==i?void 0:i.clearTimeout)||clearTimeout)(t)},delegate:void 0};function ji(t){pi.setTimeout(()=>{const{onUnhandledError:i}=Ao;if(!i)throw t;i(t)})}function Os(){}const ar=Pi("C",void 0,void 0);function Pi(t,i,e){return{kind:t,value:i,error:e}}let Ul=null;function Mr(t){if(Ao.useDeprecatedSynchronousErrorHandling){const i=!Ul;if(i&&(Ul={errorThrown:!1,error:null}),t(),i){const{errorThrown:e,error:n}=Ul;if(Ul=null,e)throw n}}else t()}class Ys extends lo{constructor(i){super(),this.isStopped=!1,i?(this.destination=i,vs(i)&&i.add(this)):this.destination=gh}static create(i,e,n){return new Ga(i,e,n)}next(i){this.isStopped?ha(function hh(t){return Pi("N",t,void 0)}(i),this):this._next(i)}error(i){this.isStopped?ha(function Zo(t){return Pi("E",void 0,t)}(i),this):(this.isStopped=!0,this._error(i))}complete(){this.isStopped?ha(ar,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(i){this.destination.next(i)}_error(i){try{this.destination.error(i)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const mh=Function.prototype.bind;function pa(t,i){return mh.call(t,i)}class Oi{constructor(i){this.partialObserver=i}next(i){const{partialObserver:e}=this;if(e.next)try{e.next(i)}catch(n){Hl(n)}}error(i){const{partialObserver:e}=this;if(e.error)try{e.error(i)}catch(n){Hl(n)}else Hl(i)}complete(){const{partialObserver:i}=this;if(i.complete)try{i.complete()}catch(e){Hl(e)}}}class Ga extends Ys{constructor(i,e,n){let r;if(super(),fi(i)||!i)r={next:null!=i?i:void 0,error:null!=e?e:void 0,complete:null!=n?n:void 0};else{let o;this&&Ao.useDeprecatedNextContext?(o=Object.create(i),o.unsubscribe=()=>this.unsubscribe(),r={next:i.next&&pa(i.next,o),error:i.error&&pa(i.error,o),complete:i.complete&&pa(i.complete,o)}):r=i}this.destination=new Oi(r)}}function Hl(t){Ao.useDeprecatedSynchronousErrorHandling?function Jc(t){Ao.useDeprecatedSynchronousErrorHandling&&Ul&&(Ul.errorThrown=!0,Ul.error=t)}(t):ji(t)}function ha(t,i){const{onStoppedNotification:e}=Ao;e&&pi.setTimeout(()=>e(t,i))}const gh={closed:!0,next:Os,error:function Lb(t){throw t},complete:Os},hc="function"==typeof Symbol&&Symbol.observable||"@@observable";function qu(t){return t}let Lr=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(e,n,r){const o=function Rf(t){return t&&t instanceof Ys||function _h(t){return t&&fi(t.next)&&fi(t.error)&&fi(t.complete)}(t)&&vs(t)}(e)?e:new Ga(e,n,r);return Mr(()=>{const{operator:c,source:u}=this;o.add(c?c.call(o,u):u?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(n){e.error(n)}}forEach(e,n){return new(n=Ns(n))((r,o)=>{const c=new Ga({next:u=>{try{e(u)}catch(m){o(m),c.unsubscribe()}},error:o,complete:r});this.subscribe(c)})}_subscribe(e){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(e)}[hc](){return this}pipe(...e){return function es(t){return 0===t.length?qu:1===t.length?t[0]:function(e){return t.reduce((n,r)=>r(n),e)}}(e)(this)}toPromise(e){return new(e=Ns(e))((n,r)=>{let o;this.subscribe(c=>o=c,c=>r(c),()=>n(o))})}}return t.create=i=>new t(i),t})();function Ns(t){var i;return null!==(i=null!=t?t:Ao.Promise)&&void 0!==i?i:Promise}const zl=Do(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Wi=(()=>{class t extends Lr{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const n=new vh(this,this);return n.operator=e,n}_throwIfClosed(){if(this.closed)throw new zl}next(e){Mr(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(e)}})}error(e){Mr(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:n}=this;for(;n.length;)n.shift().error(e)}})}complete(){Mr(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:n,isStopped:r,observers:o}=this;return n||r?fa:(this.currentObservers=null,o.push(e),new lo(()=>{this.currentObservers=null,Ia(o,e)}))}_checkFinalizedStatuses(e){const{hasError:n,thrownError:r,isStopped:o}=this;n?e.error(r):o&&e.complete()}asObservable(){const e=new Lr;return e.source=this,e}}return t.create=(i,e)=>new vh(i,e),t})();class vh extends Wi{constructor(i,e){super(),this.destination=i,this.source=e}next(i){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===n||n.call(e,i)}error(i){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===n||n.call(e,i)}complete(){var i,e;null===(e=null===(i=this.destination)||void 0===i?void 0:i.complete)||void 0===e||e.call(i)}_subscribe(i){var e,n;return null!==(n=null===(e=this.source)||void 0===e?void 0:e.subscribe(i))&&void 0!==n?n:fa}}function Bb(t){return fi(null==t?void 0:t.lift)}function Mo(t){return i=>{if(Bb(i))return i.lift(function(e){try{return t(e,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function co(t,i,e,n,r){return new Bf(t,i,e,n,r)}class Bf extends Ys{constructor(i,e,n,r,o,c){super(i),this.onFinalize=o,this.shouldUnsubscribe=c,this._next=e?function(u){try{e(u)}catch(m){i.error(m)}}:super._next,this._error=r?function(u){try{r(u)}catch(m){i.error(m)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(u){i.error(u)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var i;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(i=this.onFinalize)||void 0===i||i.call(this))}}}function or(t,i){return Mo((e,n)=>{let r=0;e.subscribe(co(n,o=>{n.next(t.call(i,o,r++))}))})}function ma(t){return this instanceof ma?(this.v=t,this):new ma(t)}function U_(t,i,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=e.apply(t,i||[]),o=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",function c(E){return function(R){return Promise.resolve(R).then(E,S)}}),r[Symbol.asyncIterator]=function(){return this},r;function u(E,R){n[E]&&(r[E]=function(B){return new Promise(function(K,q){o.push([E,B,K,q])>1||m(E,B)})},R&&(r[E]=R(r[E])))}function m(E,R){try{!function g(E){E.value instanceof ma?Promise.resolve(E.value.v).then(x,S):M(o[0][2],E)}(n[E](R))}catch(B){M(o[0][3],B)}}function x(E){m("next",E)}function S(E){m("throw",E)}function M(E,R){E(R),o.shift(),o.length&&m(o[0][0],o[0][1])}}function Ub(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,i=t[Symbol.asyncIterator];return i?i.call(t):(t=function V_(t){var i="function"==typeof Symbol&&Symbol.iterator,e=i&&t[i],n=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(o){e[o]=t[o]&&function(c){return new Promise(function(u,m){!function r(o,c,u,m){Promise.resolve(m).then(function(g){o({value:g,done:u})},c)}(u,m,(c=t[o](c)).done,c.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const z_=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Yb(t){return fi(null==t?void 0:t.then)}function $_(t){return fi(t[hc])}function Wl(t){return Symbol.asyncIterator&&fi(null==t?void 0:t[Symbol.asyncIterator])}function mc(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const W_=function k5(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Ku(t){return fi(null==t?void 0:t[W_])}function Xb(t){return U_(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:n,done:r}=yield ma(e.read());if(r)return yield ma(void 0);yield yield ma(n)}}finally{e.releaseLock()}})}function q_(t){return fi(null==t?void 0:t.getReader)}function _a(t){if(t instanceof Lr)return t;if(null!=t){if($_(t))return function D5(t){return new Lr(i=>{const e=t[hc]();if(fi(e.subscribe))return e.subscribe(i);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(z_(t))return function Ka(t){return new Lr(i=>{for(let e=0;e<t.length&&!i.closed;e++)i.next(t[e]);i.complete()})}(t);if(Yb(t))return function gc(t){return new Lr(i=>{t.then(e=>{i.closed||(i.next(e),i.complete())},e=>i.error(e)).then(null,ji)})}(t);if(Wl(t))return Nd(t);if(Ku(t))return function yh(t){return new Lr(i=>{for(const e of t)if(i.next(e),i.closed)return;i.complete()})}(t);if(q_(t))return function Qb(t){return Nd(Xb(t))}(t)}throw mc(t)}function Nd(t){return new Lr(i=>{(function I5(t,i){var e,n,r,o;return function R_(t,i,e,n){return new(e||(e=Promise))(function(o,c){function u(x){try{g(n.next(x))}catch(S){c(S)}}function m(x){try{g(n.throw(x))}catch(S){c(S)}}function g(x){x.done?o(x.value):function r(o){return o instanceof e?o:new e(function(c){c(o)})}(x.value).then(u,m)}g((n=n.apply(t,i||[])).next())})}(this,void 0,void 0,function*(){try{for(e=Ub(t);!(n=yield e.next()).done;)if(i.next(n.value),i.closed)return}catch(c){r={error:c}}finally{try{n&&!n.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}i.complete()})})(t,i).catch(e=>i.error(e))})}function _c(t,i,e,n=0,r=!1){const o=i.schedule(function(){e(),r?t.add(this.schedule(null,n)):this.unsubscribe()},n);if(t.add(o),!r)return o}function ts(t,i,e=1/0){return fi(i)?ts((n,r)=>or((o,c)=>i(n,o,r,c))(_a(t(n,r))),e):("number"==typeof i&&(e=i),Mo((n,r)=>function A5(t,i,e,n,r,o,c,u){const m=[];let g=0,x=0,S=!1;const M=()=>{S&&!m.length&&!g&&i.complete()},E=B=>g<n?R(B):m.push(B),R=B=>{o&&i.next(B),g++;let K=!1;_a(e(B,x++)).subscribe(co(i,q=>{null==r||r(q),o?E(q):i.next(q)},()=>{K=!0},void 0,()=>{if(K)try{for(g--;m.length&&g<n;){const q=m.shift();c?_c(i,c,()=>R(q)):R(q)}M()}catch(q){i.error(q)}}))};return t.subscribe(co(i,E,()=>{S=!0,M()})),()=>{null==u||u()}}(n,r,t,e)))}function bh(t=1/0){return ts(qu,t)}const In=new Lr(t=>t.complete());function Jb(t){return t&&fi(t.schedule)}function Rd(t){return t[t.length-1]}function Zb(t){return fi(Rd(t))?t.pop():void 0}function Gr(t){return Jb(Rd(t))?t.pop():void 0}function xh(t,i=0){return Mo((e,n)=>{e.subscribe(co(n,r=>_c(n,t,()=>n.next(r),i),()=>_c(n,t,()=>n.complete(),i),r=>_c(n,t,()=>n.error(r),i)))})}function wh(t,i=0){return Mo((e,n)=>{n.add(t.schedule(()=>e.subscribe(n),i))})}function n2(t,i){if(!t)throw new Error("Iterable cannot be null");return new Lr(e=>{_c(e,i,()=>{const n=t[Symbol.asyncIterator]();_c(e,i,()=>{n.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function Ls(t,i){return i?function ng(t,i){if(null!=t){if($_(t))return function F5(t,i){return _a(t).pipe(wh(i),xh(i))}(t,i);if(z_(t))return function ns(t,i){return new Lr(e=>{let n=0;return i.schedule(function(){n===t.length?e.complete():(e.next(t[n++]),e.closed||this.schedule())})})}(t,i);if(Yb(t))return function tg(t,i){return _a(t).pipe(wh(i),xh(i))}(t,i);if(Wl(t))return n2(t,i);if(Ku(t))return function t2(t,i){return new Lr(e=>{let n;return _c(e,i,()=>{n=t[W_](),_c(e,i,()=>{let r,o;try{({value:r,done:o}=n.next())}catch(c){return void e.error(c)}o?e.complete():e.next(r)},0,!0)}),()=>fi(null==n?void 0:n.return)&&n.return()})}(t,i);if(q_(t))return function r2(t,i){return n2(Xb(t),i)}(t,i)}throw mc(t)}(t,i):_a(t)}function G_(t={}){const{connector:i=(()=>new Wi),resetOnError:e=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=t;return o=>{let c,u,m,g=0,x=!1,S=!1;const M=()=>{null==u||u.unsubscribe(),u=void 0},E=()=>{M(),c=m=void 0,x=S=!1},R=()=>{const B=c;E(),null==B||B.unsubscribe()};return Mo((B,K)=>{g++,!S&&!x&&M();const q=m=null!=m?m:i();K.add(()=>{g--,0===g&&!S&&!x&&(u=K_(R,r))}),q.subscribe(K),!c&&g>0&&(c=new Ga({next:Y=>q.next(Y),error:Y=>{S=!0,M(),u=K_(E,e,Y),q.error(Y)},complete:()=>{x=!0,M(),u=K_(E,n),q.complete()}}),_a(B).subscribe(c))})(o)}}function K_(t,i,...e){if(!0===i)return void t();if(!1===i)return;const n=new Ga({next:()=>{n.unsubscribe(),t()}});return i(...e).subscribe(n)}function Kn(t){for(let i in t)if(t[i]===Kn)return i;throw Error("Could not find renamed property on target object.")}function Zc(t,i){for(const e in i)i.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=i[e])}function Bn(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Bn).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const i=t.toString();if(null==i)return""+i;const e=i.indexOf("\n");return-1===e?i:i.substring(0,e)}function uo(t,i){return null==t||""===t?null===i?"":i:null==i||""===i?t:t+" "+i}const ql=Kn({__forward_ref__:Kn});function tr(t){return t.__forward_ref__=tr,t.toString=function(){return Bn(this())},t}function si(t){return s2(t)?t():t}function s2(t){return"function"==typeof t&&t.hasOwnProperty(ql)&&t.__forward_ref__===tr}class Tn extends Error{constructor(i,e){super(function Y_(t,i){return`NG0${Math.abs(t)}${i?": "+i:""}`}(i,e)),this.code=i}}function jn(t){return"string"==typeof t?t:null==t?"":String(t)}function Rs(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():jn(t)}function Ch(t,i){const e=i?` in ${i}`:"";throw new Tn(-201,`No provider for ${Rs(t)} found${e}`)}function Aa(t,i){null==t&&function Rr(t,i,e,n){throw new Error(`ASSERTION ERROR: ${t}`+(null==n?"":` [Expected=> ${e} ${n} ${i} <=Actual]`))}(i,t,null,"!=")}function Vt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Ci(t){return{providers:t.providers||[],imports:t.imports||[]}}function Th(t){return u2(t,Vf)||u2(t,X_)}function u2(t,i){return t.hasOwnProperty(i)?t[i]:null}function Kr(t){return t&&(t.hasOwnProperty(rg)||t.hasOwnProperty(og))?t[rg]:null}const Vf=Kn({\u0275prov:Kn}),rg=Kn({\u0275inj:Kn}),X_=Kn({ngInjectableDef:Kn}),og=Kn({ngInjectorDef:Kn});var _n=(()=>((_n=_n||{})[_n.Default=0]="Default",_n[_n.Host=1]="Host",_n[_n.Self=2]="Self",_n[_n.SkipSelf=4]="SkipSelf",_n[_n.Optional=8]="Optional",_n))();let hl;function tu(t){const i=hl;return hl=t,i}function f2(t,i,e){const n=Th(t);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:e&_n.Optional?null:void 0!==i?i:void Ch(Bn(t),"Injector")}function Yu(t){return{toString:t}.toString()}var ml=(()=>((ml=ml||{})[ml.OnPush=0]="OnPush",ml[ml.Default=1]="Default",ml))(),ya=(()=>{return(t=ya||(ya={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",ya;var t})();const Jt="undefined"!=typeof globalThis&&globalThis,Q_="undefined"!=typeof window&&window,V5="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,cr=Jt||"undefined"!=typeof global&&global||Q_||V5,ys={},Br=[],sg=Kn({\u0275cmp:Kn}),ag=Kn({\u0275dir:Kn}),lg=Kn({\u0275pipe:Kn}),J_=Kn({\u0275mod:Kn}),gl=Kn({\u0275fac:Kn}),Uf=Kn({__NG_ELEMENT_ID__:Kn});let h2=0;function dn(t){return Yu(()=>{const e={},n={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===ml.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||Br,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||ya.Emulated,id:"c",styles:t.styles||Br,_:null,setInput:null,schemas:t.schemas||null,tView:null},r=t.directives,o=t.features,c=t.pipes;return n.id+=h2++,n.inputs=ug(t.inputs,e),n.outputs=ug(t.outputs),o&&o.forEach(u=>u(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(Z_):null,n.pipeDefs=c?()=>("function"==typeof c?c():c).map(cg):null,n})}function Z_(t){return Bs(t)||function vc(t){return t[ag]||null}(t)}function cg(t){return function Xu(t){return t[lg]||null}(t)}const e1={};function Ti(t){return Yu(()=>{const i={type:t.type,bootstrap:t.bootstrap||Br,declarations:t.declarations||Br,imports:t.imports||Br,exports:t.exports||Br,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(e1[t.id]=t.type),i})}function ug(t,i){if(null==t)return ys;const e={};for(const n in t)if(t.hasOwnProperty(n)){let r=t[n],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),e[r]=n,i&&(i[r]=o)}return e}const Ln=dn;function Qs(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function Bs(t){return t[sg]||null}function ba(t,i){const e=t[J_]||null;if(!e&&!0===i)throw new Error(`Type ${Bn(t)} does not have '\u0275mod' property.`);return e}function wc(t){return Array.isArray(t)&&"object"==typeof t[1]}function Kl(t){return Array.isArray(t)&&!0===t[1]}function n1(t){return 0!=(8&t.flags)}function Xr(t){return 2==(2&t.flags)}function qn(t){return 1==(1&t.flags)}function no(t){return null!==t.template}function yi(t){return 0!=(512&t[2])}function iu(t,i){return t.hasOwnProperty(gl)?t[gl]:null}class pg{constructor(i,e,n){this.previousValue=i,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function Vs(){return hg}function hg(t){return t.type.prototype.ngOnChanges&&(t.setInput=o1),r1}function r1(){const t=a1(this),i=null==t?void 0:t.current;if(i){const e=t.previous;if(e===ys)t.previous=i;else for(let n in i)e[n]=i[n];t.current=null,this.ngOnChanges(i)}}function o1(t,i,e,n){const r=a1(t)||function z5(t,i){return t[s1]=i}(t,{previous:ys,current:null}),o=r.current||(r.current={}),c=r.previous,u=this.declaredInputs[e],m=c[u];o[u]=new pg(m&&m.currentValue,i,c===ys),t[n]=i}Vs.ngInherit=!0;const s1="__ngSimpleChanges__";function a1(t){return t[s1]||null}let mg;function l1(){return void 0!==mg?mg:"undefined"!=typeof document?document:void 0}function Xi(t){return!!t.listen}const kh={createRenderer:(t,i)=>l1()};function bo(t){for(;Array.isArray(t);)t=t[0];return t}function gg(t,i){return bo(i[t])}function yl(t,i){return bo(i[t.index])}function u1(t,i){return t.data[i]}function qf(t,i){return t[i]}function xr(t,i){const e=i[t];return wc(e)?e:e[0]}function d1(t){return 4==(4&t[2])}function f1(t){return 128==(128&t[2])}function Sc(t,i){return null==i?null:t[i]}function h1(t){t[18]=0}function m1(t,i){t[5]+=i;let e=t,n=t[3];for(;null!==n&&(1===i&&1===e[5]||-1===i&&0===e[5]);)n[5]+=i,e=n,n=n[3]}const ai={lFrame:I2(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function _g(){return ai.bindingsEnabled}function Ut(){return ai.lFrame.lView}function Qi(){return ai.lFrame.tView}function z(t){return ai.lFrame.contextLView=t,t[8]}function xo(){let t=Gf();for(;null!==t&&64===t.type;)t=t.parent;return t}function Gf(){return ai.lFrame.currentTNode}function Ni(t,i){const e=ai.lFrame;e.currentTNode=t,e.isParent=i}function _1(){return ai.lFrame.isParent}function v1(){ai.lFrame.isParent=!1}function yg(){return ai.isInCheckNoChangesMode}function bg(t){ai.isInCheckNoChangesMode=t}function Zs(){const t=ai.lFrame;let i=t.bindingRootIndex;return-1===i&&(i=t.bindingRootIndex=t.tView.bindingStartIndex),i}function qd(){return ai.lFrame.bindingIndex++}function Xl(t){const i=ai.lFrame,e=i.bindingIndex;return i.bindingIndex=i.bindingIndex+t,e}function T2(t,i){const e=ai.lFrame;e.bindingIndex=e.bindingRootIndex=t,y1(i)}function y1(t){ai.lFrame.currentDirectiveIndex=t}function E2(){return ai.lFrame.currentQueryIndex}function b1(t){ai.lFrame.currentQueryIndex=t}function k2(t){const i=t[1];return 2===i.type?i.declTNode:1===i.type?t[6]:null}function wg(t,i,e){if(e&_n.SkipSelf){let r=i,o=t;for(;!(r=r.parent,null!==r||e&_n.Host||(r=k2(o),null===r||(o=o[15],10&r.type))););if(null===r)return!1;i=r,t=o}const n=ai.lFrame=D2();return n.currentTNode=i,n.lView=t,!0}function Kf(t){const i=D2(),e=t[1];ai.lFrame=i,i.currentTNode=e.firstChild,i.lView=t,i.tView=e,i.contextLView=t,i.bindingIndex=e.bindingStartIndex,i.inI18n=!1}function D2(){const t=ai.lFrame,i=null===t?null:t.child;return null===i?I2(t):i}function I2(t){const i={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=i),i}function A2(){const t=ai.lFrame;return ai.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Cg=A2;function Tg(){const t=A2();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function ea(){return ai.lFrame.selectedIndex}function kc(t){ai.lFrame.selectedIndex=t}function To(){const t=ai.lFrame;return u1(t.tView,t.selectedIndex)}function Sg(t,i){for(let e=i.directiveStart,n=i.directiveEnd;e<n;e++){const o=t.data[e].type.prototype,{ngAfterContentInit:c,ngAfterContentChecked:u,ngAfterViewInit:m,ngAfterViewChecked:g,ngOnDestroy:x}=o;c&&(t.contentHooks||(t.contentHooks=[])).push(-e,c),u&&((t.contentHooks||(t.contentHooks=[])).push(e,u),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(e,u)),m&&(t.viewHooks||(t.viewHooks=[])).push(-e,m),g&&((t.viewHooks||(t.viewHooks=[])).push(e,g),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(e,g)),null!=x&&(t.destroyHooks||(t.destroyHooks=[])).push(e,x)}}function Gd(t,i,e){x1(t,i,3,e)}function Dh(t,i,e,n){(3&t[2])===e&&x1(t,i,e,n)}function Eg(t,i){let e=t[2];(3&e)===i&&(e&=2047,e+=1,t[2]=e)}function x1(t,i,e,n){const o=null!=n?n:-1,c=i.length-1;let u=0;for(let m=void 0!==n?65535&t[18]:0;m<c;m++)if("number"==typeof i[m+1]){if(u=i[m],null!=n&&u>=n)break}else i[m]<0&&(t[18]+=65536),(u<o||-1==o)&&(X5(t,e,i,m),t[18]=(4294901760&t[18])+m+2),m++}function X5(t,i,e,n){const r=e[n]<0,o=e[n+1],u=t[r?-e[n]:e[n]];if(r){if(t[2]>>11<t[18]>>16&&(3&t[2])===i){t[2]+=2048;try{o.call(u)}finally{}}}else try{o.call(u)}finally{}}class Yf{constructor(i,e,n){this.factory=i,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function Ah(t,i,e){const n=Xi(t);let r=0;for(;r<e.length;){const o=e[r];if("number"==typeof o){if(0!==o)break;r++;const c=e[r++],u=e[r++],m=e[r++];n?t.setAttribute(i,u,m,c):i.setAttributeNS(c,u,m)}else{const c=o,u=e[++r];kg(c)?n&&t.setProperty(i,c,u):n?t.setAttribute(i,c,u):i.setAttribute(c,u),r++}}return r}function B2(t){return 3===t||4===t||6===t}function kg(t){return 64===t.charCodeAt(0)}function ed(t,i){if(null!==i&&0!==i.length)if(null===t||0===t.length)t=i.slice();else{let e=-1;for(let n=0;n<i.length;n++){const r=i[n];"number"==typeof r?e=r:0===e||j2(t,e,r,null,-1===e||2===e?i[++n]:null)}}return t}function j2(t,i,e,n,r){let o=0,c=t.length;if(-1===i)c=-1;else for(;o<t.length;){const u=t[o++];if("number"==typeof u){if(u===i){c=-1;break}if(u>i){c=o-1;break}}}for(;o<t.length;){const u=t[o];if("number"==typeof u)break;if(u===e){if(null===n)return void(null!==r&&(t[o+1]=r));if(n===t[o+1])return void(t[o+2]=r)}o++,null!==n&&o++,null!==r&&o++}-1!==c&&(t.splice(c,0,i),o=c+1),t.splice(o++,0,e),null!==n&&t.splice(o++,0,n),null!==r&&t.splice(o++,0,r)}function V2(t){return-1!==t}function bl(t){return 32767&t}function xl(t,i){let e=function Mh(t){return t>>16}(t),n=i;for(;e>0;)n=n[15],e--;return n}let Dg=!0;function Ig(t){const i=Dg;return Dg=t,i}let Ag=0;function Fh(t,i){const e=Mg(t,i);if(-1!==e)return e;const n=i[1];n.firstCreatePass&&(t.injectorIndex=i.length,C1(n.data,t),C1(i,null),C1(n.blueprint,null));const r=Ph(t,i),o=t.injectorIndex;if(V2(r)){const c=bl(r),u=xl(r,i),m=u[1].data;for(let g=0;g<8;g++)i[o+g]=u[c+g]|m[c+g]}return i[o+8]=r,o}function C1(t,i){t.push(0,0,0,0,0,0,0,0,i)}function Mg(t,i){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===i[t.injectorIndex+8]?-1:t.injectorIndex}function Ph(t,i){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,n=null,r=i;for(;null!==r;){const o=r[1],c=o.type;if(n=2===c?o.declTNode:1===c?r[6]:null,null===n)return-1;if(e++,r=r[15],-1!==n.injectorIndex)return n.injectorIndex|e<<16}return-1}function Xa(t,i,e){!function z2(t,i,e){let n;"string"==typeof e?n=e.charCodeAt(0)||0:e.hasOwnProperty(Uf)&&(n=e[Uf]),null==n&&(n=e[Uf]=Ag++);const r=255&n;i.data[t+(r>>5)]|=1<<r}(t,i,e)}function $2(t,i,e){if(e&_n.Optional)return t;Ch(i,"NodeInjector")}function W2(t,i,e,n){if(e&_n.Optional&&void 0===n&&(n=null),0==(e&(_n.Self|_n.Host))){const r=t[9],o=tu(void 0);try{return r?r.get(i,n,e&_n.Optional):f2(i,n,e&_n.Optional)}finally{tu(o)}}return $2(n,i,e)}function q2(t,i,e,n=_n.Default,r){if(null!==t){const o=function J5(t){if("string"==typeof t)return t.charCodeAt(0)||0;const i=t.hasOwnProperty(Uf)?t[Uf]:void 0;return"number"==typeof i?i>=0?255&i:Q5:i}(e);if("function"==typeof o){if(!wg(i,t,n))return n&_n.Host?$2(r,e,n):W2(i,e,n,r);try{const c=o(n);if(null!=c||n&_n.Optional)return c;Ch(e)}finally{Cg()}}else if("number"==typeof o){let c=null,u=Mg(t,i),m=-1,g=n&_n.Host?i[16][6]:null;for((-1===u||n&_n.SkipSelf)&&(m=-1===u?Ph(t,i):i[u+8],-1!==m&&G2(n,!1)?(c=i[1],u=bl(m),i=xl(m,i)):u=-1);-1!==u;){const x=i[1];if(S1(o,u,x.data)){const S=Fg(u,i,e,c,n,g);if(S!==T1)return S}m=i[u+8],-1!==m&&G2(n,i[1].data[u+8]===g)&&S1(o,u,i)?(c=x,u=bl(m),i=xl(m,i)):u=-1}}}return W2(i,e,n,r)}const T1={};function Q5(){return new Qf(xo(),Ut())}function Fg(t,i,e,n,r,o){const c=i[1],u=c.data[t+8],x=Oh(u,c,e,null==n?Xr(u)&&Dg:n!=c&&0!=(3&u.type),r&_n.Host&&o===u);return null!==x?Xf(i,c,x,u):T1}function Oh(t,i,e,n,r){const o=t.providerIndexes,c=i.data,u=1048575&o,m=t.directiveStart,x=o>>20,M=r?u+x:t.directiveEnd;for(let E=n?u:u+x;E<M;E++){const R=c[E];if(E<m&&e===R||E>=m&&R.type===e)return E}if(r){const E=c[m];if(E&&no(E)&&E.type===e)return m}return null}function Xf(t,i,e,n){let r=t[e];const o=i.data;if(function R2(t){return t instanceof Yf}(r)){const c=r;c.resolving&&function jo(t,i){const e=i?`. Dependency path: ${i.join(" > ")} > ${t}`:"";throw new Tn(-200,`Circular dependency in DI detected for ${t}${e}`)}(Rs(o[e]));const u=Ig(c.canSeeViewProviders);c.resolving=!0;const m=c.injectImpl?tu(c.injectImpl):null;wg(t,n,_n.Default);try{r=t[e]=c.factory(void 0,o,t,n),i.firstCreatePass&&e>=n.directiveStart&&function L2(t,i,e){const{ngOnChanges:n,ngOnInit:r,ngDoCheck:o}=i.type.prototype;if(n){const c=hg(i);(e.preOrderHooks||(e.preOrderHooks=[])).push(t,c),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,c)}r&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-t,r),o&&((e.preOrderHooks||(e.preOrderHooks=[])).push(t,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,o))}(e,o[e],i)}finally{null!==m&&tu(m),Ig(u),c.resolving=!1,Cg()}}return r}function S1(t,i,e){return!!(e[i+(t>>5)]&1<<t)}function G2(t,i){return!(t&_n.Self||t&_n.Host&&i)}class Qf{constructor(i,e){this._tNode=i,this._lView=e}get(i,e,n){return q2(this._tNode,this._lView,i,n,e)}}function hr(t){return Yu(()=>{const i=t.prototype.constructor,e=i[gl]||E1(i),n=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==n;){const o=r[gl]||E1(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function E1(t){return s2(t)?()=>{const i=E1(si(t));return i&&i()}:iu(t)}function Nh(t){return function Kd(t,i){if("class"===i)return t.classes;if("style"===i)return t.styles;const e=t.attrs;if(e){const n=e.length;let r=0;for(;r<n;){const o=e[r];if(B2(o))break;if(0===o)r+=2;else if("number"==typeof o)for(r++;r<n&&"string"==typeof e[r];)r++;else{if(o===i)return e[r+1];r+=2}}}return null}(xo(),t)}const td="__parameters__";function Zf(t,i,e){return Yu(()=>{const n=function k1(t){return function(...e){if(t){const n=t(...e);for(const r in n)this[r]=n[r]}}}(i);function r(...o){if(this instanceof r)return n.apply(this,o),this;const c=new r(...o);return u.annotation=c,u;function u(m,g,x){const S=m.hasOwnProperty(td)?m[td]:Object.defineProperty(m,td,{value:[]})[td];for(;S.length<=x;)S.push(null);return(S[x]=S[x]||[]).push(c),m}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class hi{constructor(i,e){this._desc=i,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Vt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}const eE=new hi("AnalyzeForEntryComponents");function wl(t,i){void 0===i&&(i=t);for(let e=0;e<t.length;e++){let n=t[e];Array.isArray(n)?(i===t&&(i=t.slice(0,e)),wl(n,i)):i!==t&&i.push(n)}return i}function Dc(t,i){t.forEach(e=>Array.isArray(e)?Dc(e,i):i(e))}function Y2(t,i,e){i>=t.length?t.push(e):t.splice(i,0,e)}function Pg(t,i){return i>=t.length-1?t.pop():t.splice(i,1)[0]}function Bh(t,i){const e=[];for(let n=0;n<t;n++)e.push(i);return e}function Qa(t,i,e){let n=Yd(t,i);return n>=0?t[1|n]=e:(n=~n,function iE(t,i,e,n){let r=t.length;if(r==i)t.push(e,n);else if(1===r)t.push(n,t[0]),t[0]=e;else{for(r--,t.push(t[r-1],t[r]);r>i;)t[r]=t[r-2],r--;t[i]=e,t[i+1]=n}}(t,n,i,e)),n}function I1(t,i){const e=Yd(t,i);if(e>=0)return t[1|e]}function Yd(t,i){return function Z2(t,i,e){let n=0,r=t.length>>e;for(;r!==n;){const o=n+(r-n>>1),c=t[o<<e];if(i===c)return o<<e;c>i?r=o:n=o+1}return~(r<<e)}(t,i,1)}const ep={},A1="__NG_DI_FLAG__",Lg="ngTempTokenPath",ix=/\n/gm,rx="__source",uE=Kn({provide:String,useValue:Kn});let jh;function ox(t){const i=jh;return jh=t,i}function dE(t,i=_n.Default){if(void 0===jh)throw new Tn(203,"");return null===jh?f2(t,void 0,i):jh.get(t,i&_n.Optional?null:void 0,i)}function zt(t,i=_n.Default){return(function Sh(){return hl}()||dE)(si(t),i)}const ax=zt;function M1(t){const i=[];for(let e=0;e<t.length;e++){const n=si(t[e]);if(Array.isArray(n)){if(0===n.length)throw new Tn(900,"");let r,o=_n.Default;for(let c=0;c<n.length;c++){const u=n[c],m=fE(u);"number"==typeof m?-1===m?r=u.token:o|=m:r=u}i.push(zt(r,o))}else i.push(zt(n))}return i}function Vh(t,i){return t[A1]=i,t.prototype[A1]=i,t}function fE(t){return t[A1]}const Rg=Vh(Zf("Inject",t=>({token:t})),-1),nd=Vh(Zf("Optional"),8),Uh=Vh(Zf("SkipSelf"),4);let jg,Vg;function Xd(t){var i;return(null===(i=function zh(){if(void 0===jg&&(jg=null,cr.trustedTypes))try{jg=cr.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(t){}return jg}())||void 0===i?void 0:i.createHTML(t))||t}function mx(t){var i;return(null===(i=function cu(){if(void 0===Vg&&(Vg=null,cr.trustedTypes))try{Vg=cr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(t){}return Vg}())||void 0===i?void 0:i.createHTML(t))||t}class vx{constructor(i){this.changingThisBreaksApplicationSecurity=i}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function id(t){return t instanceof vx?t.changingThisBreaksApplicationSecurity:t}function Wh(t,i){const e=function EE(t){return t instanceof vx&&t.getTypeName()||null}(t);if(null!=e&&e!==i){if("ResourceURL"===e&&"URL"===i)return!0;throw new Error(`Required a safe ${i}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===i}class bx{constructor(i){this.inertDocumentHelper=i}getInertBodyElement(i){i="<body><remove></remove>"+i;try{const e=(new window.DOMParser).parseFromString(Xd(i),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(i):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class uu{constructor(i){if(this.defaultDoc=i,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const n=this.inertDocument.createElement("body");e.appendChild(n)}}getInertBodyElement(i){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=Xd(i),e;const n=this.inertDocument.createElement("body");return n.innerHTML=Xd(i),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(i){const e=i.attributes;for(let r=e.length-1;0<r;r--){const c=e.item(r).name;("xmlns:ns1"===c||0===c.indexOf("ns1:"))&&i.removeAttribute(c)}let n=i.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const IE=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,AE=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Ug(t){return(t=String(t)).match(IE)||t.match(AE)?t:"unsafe:"+t}function xx(t){return(t=String(t)).split(",").map(i=>Ug(i.trim())).join(", ")}function Jl(t){const i={};for(const e of t.split(","))i[e]=!0;return i}function np(...t){const i={};for(const e of t)for(const n in e)e.hasOwnProperty(n)&&(i[n]=!0);return i}const wx=Jl("area,br,col,hr,img,wbr"),Cx=Jl("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Tx=Jl("rp,rt"),qh=np(wx,np(Cx,Jl("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),np(Tx,Jl("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),np(Tx,Cx)),Hg=Jl("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),O1=Jl("srcset"),Sx=np(Hg,O1,Jl("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Jl("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),ME=Jl("script,style,template");class Ex{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(i){let e=i.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(i){const e=i.nodeName.toLowerCase();if(!qh.hasOwnProperty(e))return this.sanitizedSomething=!0,!ME.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=i.attributes;for(let r=0;r<n.length;r++){const o=n.item(r),c=o.name,u=c.toLowerCase();if(!Sx.hasOwnProperty(u)){this.sanitizedSomething=!0;continue}let m=o.value;Hg[u]&&(m=Ug(m)),O1[u]&&(m=xx(m)),this.buf.push(" ",c,'="',kx(m),'"')}return this.buf.push(">"),!0}endElement(i){const e=i.nodeName.toLowerCase();qh.hasOwnProperty(e)&&!wx.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(i){this.buf.push(kx(i))}checkClobberedElement(i,e){if(e&&(i.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${i.outerHTML}`);return e}}const FE=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Gh=/([^\#-~ |!])/g;function kx(t){return t.replace(/&/g,"&amp;").replace(FE,function(i){return"&#"+(1024*(i.charCodeAt(0)-55296)+(i.charCodeAt(1)-56320)+65536)+";"}).replace(Gh,function(i){return"&#"+i.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let zg;function Wg(t){return"content"in t&&function PE(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Uo=(()=>((Uo=Uo||{})[Uo.NONE=0]="NONE",Uo[Uo.HTML=1]="HTML",Uo[Uo.STYLE=2]="STYLE",Uo[Uo.SCRIPT=3]="SCRIPT",Uo[Uo.URL=4]="URL",Uo[Uo.RESOURCE_URL=5]="RESOURCE_URL",Uo))();function Us(t){const i=Qh();return i?mx(i.sanitize(Uo.HTML,t)||""):Wh(t,"HTML")?mx(id(t)):function $g(t,i){let e=null;try{zg=zg||function yx(t){const i=new uu(t);return function DE(){try{return!!(new window.DOMParser).parseFromString(Xd(""),"text/html")}catch(t){return!1}}()?new bx(i):i}(t);let n=i?String(i):"";e=zg.getInertBodyElement(n);let r=5,o=n;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,n=o,o=e.innerHTML,e=zg.getInertBodyElement(n)}while(n!==o);return Xd((new Ex).sanitizeChildren(Wg(e)||e))}finally{if(e){const n=Wg(e)||e;for(;n.firstChild;)n.removeChild(n.firstChild)}}}(l1(),jn(t))}function rd(t){const i=Qh();return i?i.sanitize(Uo.URL,t)||"":Wh(t,"URL")?id(t):Ug(jn(t))}function Qh(){const t=Ut();return t&&t[12]}const Ax="__ngContext__";function ta(t,i){t[Ax]=i}function ip(t){const i=function sd(t){return t[Ax]||null}(t);return i?Array.isArray(i)?i:i.lView:null}function B1(t){return t.ngOriginalError}function Zh(t,...i){t.error(...i)}class em{constructor(){this._console=console}handleError(i){const e=this._findOriginalError(i),n=function Lx(t){return t&&t.ngErrorLogger||Zh}(i);n(this._console,"ERROR",i),e&&n(this._console,"ORIGINAL ERROR",e)}_findOriginalError(i){let e=i&&B1(i);for(;e&&B1(e);)e=B1(e);return e||null}}const XE=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(cr))();function Bx(t){return t.ownerDocument.defaultView}function jx(t){return t.ownerDocument}function Ic(t){return t instanceof Function?t():t}var Ja=(()=>((Ja=Ja||{})[Ja.Important=1]="Important",Ja[Ja.DashCase=2]="DashCase",Ja))();function V1(t,i){return undefined(t,i)}function Qd(t){const i=t[3];return Kl(i)?i[3]:i}function H1(t){return zx(t[13])}function z1(t){return zx(t[4])}function zx(t){for(;null!==t&&!Kl(t);)t=t[4];return t}function op(t,i,e,n,r){if(null!=n){let o,c=!1;Kl(n)?o=n:wc(n)&&(c=!0,n=n[0]);const u=bo(n);0===t&&null!==e?null==r?G1(i,e,u):Cl(i,e,u,r||null,!0):1===t&&null!==e?Cl(i,e,u,r||null,!0):2===t?function ew(t,i,e){const n=tm(t,i);n&&function a4(t,i,e,n){Xi(t)?t.removeChild(i,e,n):i.removeChild(e)}(t,n,i,e)}(i,u,c):3===t&&i.destroyNode(u),null!=o&&function c4(t,i,e,n,r){const o=e[7];o!==bo(e)&&op(i,t,n,o,r);for(let u=10;u<e.length;u++){const m=e[u];nm(m[1],m,t,i,n,o)}}(i,t,o,e,r)}}function W1(t,i,e){if(Xi(t))return t.createElement(i,e);{const n=null!==e?function q5(t){const i=t.toLowerCase();return"svg"===i?"http://www.w3.org/2000/svg":"math"===i?"http://www.w3.org/1998/MathML/":null}(e):null;return null===n?t.createElement(i):t.createElementNS(n,i)}}function Wx(t,i){const e=t[9],n=e.indexOf(i),r=i[3];1024&i[2]&&(i[2]&=-1025,m1(r,-1)),e.splice(n,1)}function Gg(t,i){if(t.length<=10)return;const e=10+i,n=t[e];if(n){const r=n[17];null!==r&&r!==t&&Wx(r,n),i>0&&(t[e-1][4]=n[4]);const o=Pg(t,10+i);!function ZE(t,i){nm(t,i,i[11],2,null,null),i[0]=null,i[6]=null}(n[1],n);const c=o[19];null!==c&&c.detachView(o[1]),n[3]=null,n[4]=null,n[2]&=-129}return n}function qx(t,i){if(!(256&i[2])){const e=i[11];Xi(e)&&e.destroyNode&&nm(t,i,e,3,null,null),function n4(t){let i=t[13];if(!i)return q1(t[1],t);for(;i;){let e=null;if(wc(i))e=i[13];else{const n=i[10];n&&(e=n)}if(!e){for(;i&&!i[4]&&i!==t;)wc(i)&&q1(i[1],i),i=i[3];null===i&&(i=t),wc(i)&&q1(i[1],i),e=i&&i[4]}i=e}}(i)}}function q1(t,i){if(!(256&i[2])){i[2]&=-129,i[2]|=256,function SP(t,i){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let n=0;n<e.length;n+=2){const r=i[e[n]];if(!(r instanceof Yf)){const o=e[n+1];if(Array.isArray(o))for(let c=0;c<o.length;c+=2){const u=r[o[c]],m=o[c+1];try{m.call(u)}finally{}}else try{o.call(r)}finally{}}}}(t,i),function s4(t,i){const e=t.cleanup,n=i[7];let r=-1;if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const c=e[o+1],u="function"==typeof c?c(i):bo(i[c]),m=n[r=e[o+2]],g=e[o+3];"boolean"==typeof g?u.removeEventListener(e[o],m,g):g>=0?n[r=g]():n[r=-g].unsubscribe(),o+=2}else{const c=n[r=e[o+1]];e[o].call(c)}if(null!==n){for(let o=r+1;o<n.length;o++)n[o]();i[7]=null}}(t,i),1===i[1].type&&Xi(i[11])&&i[11].destroy();const e=i[17];if(null!==e&&Kl(i[3])){e!==i[3]&&Wx(e,i);const n=i[19];null!==n&&n.detachView(t)}}}function Gx(t,i,e){return function Kx(t,i,e){let n=i;for(;null!==n&&40&n.type;)n=(i=n).parent;if(null===n)return e[0];if(2&n.flags){const r=t.data[n.directiveStart].encapsulation;if(r===ya.None||r===ya.Emulated)return null}return yl(n,e)}(t,i.parent,e)}function Cl(t,i,e,n,r){Xi(t)?t.insertBefore(i,e,n,r):i.insertBefore(e,n,r)}function G1(t,i,e){Xi(t)?t.appendChild(i,e):i.appendChild(e)}function K1(t,i,e,n,r){null!==n?Cl(t,i,e,n,r):G1(t,i,e)}function tm(t,i){return Xi(t)?t.parentNode(i):i.parentNode}function Yx(t,i,e){return Qx(t,i,e)}let Qx=function Xx(t,i,e){return 40&t.type?yl(t,e):null};function Kg(t,i,e,n){const r=Gx(t,n,i),o=i[11],u=Yx(n.parent||i[6],n,i);if(null!=r)if(Array.isArray(e))for(let m=0;m<e.length;m++)K1(o,r,e[m],u,!1);else K1(o,r,e,u,!1)}function Yg(t,i){if(null!==i){const e=i.type;if(3&e)return yl(i,t);if(4&e)return X1(-1,t[i.index]);if(8&e){const n=i.child;if(null!==n)return Yg(t,n);{const r=t[i.index];return Kl(r)?X1(-1,r):bo(r)}}if(32&e)return V1(i,t)()||bo(t[i.index]);{const n=Zx(t,i);return null!==n?Array.isArray(n)?n[0]:Yg(Qd(t[16]),n):Yg(t,i.next)}}return null}function Zx(t,i){return null!==i?t[16][6].projection[i.projection]:null}function X1(t,i){const e=10+t+1;if(e<i.length){const n=i[e],r=n[1].firstChild;if(null!==r)return Yg(n,r)}return i[7]}function Q1(t,i,e,n,r,o,c){for(;null!=e;){const u=n[e.index],m=e.type;if(c&&0===i&&(u&&ta(bo(u),n),e.flags|=4),64!=(64&e.flags))if(8&m)Q1(t,i,e.child,n,r,o,!1),op(i,t,r,u,o);else if(32&m){const g=V1(e,n);let x;for(;x=g();)op(i,t,r,x,o);op(i,t,r,u,o)}else 16&m?nw(t,i,n,e,r,o):op(i,t,r,u,o);e=c?e.projectionNext:e.next}}function nm(t,i,e,n,r,o){Q1(e,n,t.firstChild,i,r,o,!1)}function nw(t,i,e,n,r,o){const c=e[16],m=c[6].projection[n.projection];if(Array.isArray(m))for(let g=0;g<m.length;g++)op(i,t,r,m[g],o);else Q1(t,i,m,c[3],r,o,!0)}function iw(t,i,e){Xi(t)?t.setAttribute(i,"style",e):i.style.cssText=e}function ad(t,i,e){Xi(t)?""===e?t.removeAttribute(i,"class"):t.setAttribute(i,"class",e):i.className=e}function Xg(t,i,e){let n=t.length;for(;;){const r=t.indexOf(i,e);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const o=i.length;if(r+o===n||t.charCodeAt(r+o)<=32)return r}e=r+1}}const J1="ng-template";function d4(t,i,e){let n=0;for(;n<t.length;){let r=t[n++];if(e&&"class"===r){if(r=t[n],-1!==Xg(r.toLowerCase(),i,0))return!0}else if(1===r){for(;n<t.length&&"string"==typeof(r=t[n++]);)if(r.toLowerCase()===i)return!0;return!1}}return!1}function ow(t){return 4===t.type&&t.value!==J1}function sw(t,i,e){return i===(4!==t.type||e?t.value:J1)}function Ho(t,i,e){let n=4;const r=t.attrs||[],o=function lw(t){for(let i=0;i<t.length;i++)if(B2(t[i]))return i;return t.length}(r);let c=!1;for(let u=0;u<i.length;u++){const m=i[u];if("number"!=typeof m){if(!c)if(4&n){if(n=2|1&n,""!==m&&!sw(t,m,e)||""===m&&1===i.length){if(bs(n))return!1;c=!0}}else{const g=8&n?m:i[++u];if(8&n&&null!==t.attrs){if(!d4(t.attrs,g,e)){if(bs(n))return!1;c=!0}continue}const S=aw(8&n?"class":m,r,ow(t),e);if(-1===S){if(bs(n))return!1;c=!0;continue}if(""!==g){let M;M=S>o?"":r[S+1].toLowerCase();const E=8&n?M:null;if(E&&-1!==Xg(E,g,0)||2&n&&g!==M){if(bs(n))return!1;c=!0}}}}else{if(!c&&!bs(n)&&!bs(m))return!1;if(c&&bs(m))continue;c=!1,n=m|1&n}}return bs(n)||c}function bs(t){return 0==(1&t)}function aw(t,i,e,n){if(null===i)return-1;let r=0;if(n||!e){let o=!1;for(;r<i.length;){const c=i[r];if(c===t)return r;if(3===c||6===c)o=!0;else{if(1===c||2===c){let u=i[++r];for(;"string"==typeof u;)u=i[++r];continue}if(4===c)break;if(0===c){r+=4;continue}}r+=o?1:2}return-1}return function p4(t,i){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const n=t[e];if("number"==typeof n)return-1;if(n===i)return e;e++}return-1}(i,t)}function Z1(t,i,e=!1){for(let n=0;n<i.length;n++)if(Ho(t,i[n],e))return!0;return!1}function h4(t,i){e:for(let e=0;e<i.length;e++){const n=i[e];if(t.length===n.length){for(let r=0;r<t.length;r++)if(t[r]!==n[r])continue e;return!0}}return!1}function cw(t,i){return t?":not("+i.trim()+")":i}function m4(t){let i=t[0],e=1,n=2,r="",o=!1;for(;e<t.length;){let c=t[e];if("string"==typeof c)if(2&n){const u=t[++e];r+="["+c+(u.length>0?'="'+u+'"':"")+"]"}else 8&n?r+="."+c:4&n&&(r+=" "+c);else""!==r&&!bs(c)&&(i+=cw(o,r),r=""),n=c,o=o||!bs(n);e++}return""!==r&&(i+=cw(o,r)),i}const mi={};function v(t){uw(Qi(),Ut(),ea()+t,yg())}function uw(t,i,e,n){if(!n)if(3==(3&i[2])){const o=t.preOrderCheckHooks;null!==o&&Gd(i,o,e)}else{const o=t.preOrderHooks;null!==o&&Dh(i,o,0,e)}kc(e)}function im(t,i){return t<<17|i<<2}function Zl(t){return t>>17&32767}function ev(t){return 2|t}function du(t){return(131068&t)>>2}function Qg(t,i){return-131069&t|i<<2}function tv(t){return 1|t}function ww(t,i){const e=t.contentQueries;if(null!==e)for(let n=0;n<e.length;n+=2){const r=e[n],o=e[n+1];if(-1!==o){const c=t.data[o];b1(r),c.contentQueries(2,i[o],o)}}}function rm(t,i,e,n,r,o,c,u,m,g){const x=i.blueprint.slice();return x[0]=r,x[2]=140|n,h1(x),x[3]=x[15]=t,x[8]=e,x[10]=c||t&&t[10],x[11]=u||t&&t[11],x[12]=m||t&&t[12]||null,x[9]=g||t&&t[9]||null,x[6]=o,x[16]=2==i.type?t[16]:x,x}function sp(t,i,e,n,r){let o=t.data[i];if(null===o)o=function cv(t,i,e,n,r){const o=Gf(),c=_1(),m=t.data[i]=function F4(t,i,e,n,r,o){return{type:e,index:n,insertBeforeIndex:null,injectorIndex:i?i.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:i,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,c?o:o&&o.parent,e,i,n,r);return null===t.firstChild&&(t.firstChild=m),null!==o&&(c?null==o.child&&null!==m.parent&&(o.child=m):null===o.next&&(o.next=m)),m}(t,i,e,n,r),function C2(){return ai.lFrame.inI18n}()&&(o.flags|=64);else if(64&o.type){o.type=e,o.value=n,o.attrs=r;const c=function Ec(){const t=ai.lFrame,i=t.currentTNode;return t.isParent?i:i.parent}();o.injectorIndex=null===c?-1:c.injectorIndex}return Ni(o,!0),o}function Ac(t,i,e,n){if(0===e)return-1;const r=i.length;for(let o=0;o<e;o++)i.push(n),t.blueprint.push(n),t.data.push(null);return r}function fu(t,i,e){Kf(i);try{const n=t.viewQuery;null!==n&&wv(1,n,e);const r=t.template;null!==r&&Tw(t,i,r,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&ww(t,i),t.staticViewQueries&&wv(2,t.viewQuery,e);const o=t.components;null!==o&&function Cw(t,i){for(let e=0;e<i.length;e++)vv(t,i[e])}(i,o)}catch(n){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),n}finally{i[2]&=-5,Tg()}}function ap(t,i,e,n){const r=i[2];if(256==(256&r))return;Kf(i);const o=yg();try{h1(i),function w2(t){return ai.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&Tw(t,i,e,2,n);const c=3==(3&r);if(!o)if(c){const g=t.preOrderCheckHooks;null!==g&&Gd(i,g,null)}else{const g=t.preOrderHooks;null!==g&&Dh(i,g,0,null),Eg(i,0)}if(function H4(t){for(let i=H1(t);null!==i;i=z1(i)){if(!i[2])continue;const e=i[9];for(let n=0;n<e.length;n++){const r=e[n],o=r[3];0==(1024&r[2])&&m1(o,1),r[2]|=1024}}}(i),function U4(t){for(let i=H1(t);null!==i;i=z1(i))for(let e=10;e<i.length;e++){const n=i[e],r=n[1];f1(n)&&ap(r,n,r.template,n[8])}}(i),null!==t.contentQueries&&ww(t,i),!o)if(c){const g=t.contentCheckHooks;null!==g&&Gd(i,g)}else{const g=t.contentHooks;null!==g&&Dh(i,g,1),Eg(i,1)}!function D4(t,i){const e=t.hostBindingOpCodes;if(null!==e)try{for(let n=0;n<e.length;n++){const r=e[n];if(r<0)kc(~r);else{const o=r,c=e[++n],u=e[++n];T2(c,o),u(2,i[o])}}}finally{kc(-1)}}(t,i);const u=t.components;null!==u&&function I4(t,i){for(let e=0;e<i.length;e++)z4(t,i[e])}(i,u);const m=t.viewQuery;if(null!==m&&wv(2,m,n),!o)if(c){const g=t.viewCheckHooks;null!==g&&Gd(i,g)}else{const g=t.viewHooks;null!==g&&Dh(i,g,2),Eg(i,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),o||(i[2]&=-73),1024&i[2]&&(i[2]&=-1025,m1(i[3],-1))}finally{Tg()}}function A4(t,i,e,n){const r=i[10],o=!yg(),c=d1(i);try{o&&!c&&r.begin&&r.begin(),c&&fu(t,i,n),ap(t,i,e,n)}finally{o&&!c&&r.end&&r.end()}}function Tw(t,i,e,n,r){const o=ea(),c=2&n;try{kc(-1),c&&i.length>20&&uw(t,i,20,yg()),e(n,r)}finally{kc(o)}}function uv(t,i,e){if(n1(i)){const r=i.directiveEnd;for(let o=i.directiveStart;o<r;o++){const c=t.data[o];c.contentQueries&&c.contentQueries(1,e[o],o)}}}function n0(t,i,e){!_g()||(function sm(t,i,e,n){const r=e.directiveStart,o=e.directiveEnd;t.firstCreatePass||Fh(e,i),ta(n,i);const c=e.initialInputs;for(let u=r;u<o;u++){const m=t.data[u],g=no(m);g&&B4(i,e,m);const x=Xf(i,t,u,e);ta(x,i),null!==c&&j4(0,u-r,x,m,0,c),g&&(xr(e.index,i)[8]=x)}}(t,i,e,yl(e,i)),128==(128&e.flags)&&function hv(t,i,e){const n=e.directiveStart,r=e.directiveEnd,c=e.index,u=function S2(){return ai.lFrame.currentDirectiveIndex}();try{kc(c);for(let m=n;m<r;m++){const g=t.data[m],x=i[m];y1(m),(null!==g.hostBindings||0!==g.hostVars||null!==g.hostAttrs)&&am(g,x)}}finally{kc(-1),y1(u)}}(t,i,e))}function xs(t,i,e=yl){const n=i.localNames;if(null!==n){let r=i.index+1;for(let o=0;o<n.length;o+=2){const c=n[o+1],u=-1===c?e(i,t):t[c];t[r++]=u}}}function Sw(t){const i=t.tView;return null===i||i.incompleteFirstPass?t.tView=r0(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):i}function r0(t,i,e,n,r,o,c,u,m,g){const x=20+n,S=x+r,M=function M4(t,i){const e=[];for(let n=0;n<i;n++)e.push(n<t?null:mi);return e}(x,S),E="function"==typeof g?g():g;return M[1]={type:t,blueprint:M,template:e,queries:null,viewQuery:u,declTNode:i,data:M.slice().fill(null,x),bindingStartIndex:x,expandoStartIndex:S,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof c?c():c,firstChild:null,schemas:m,consts:E,incompleteFirstPass:!1}}function o0(t,i,e,n){const r=Fw(i);null===e?r.push(n):(r.push(e),t.firstCreatePass&&Pw(t).push(n,r.length-1))}function om(t,i,e){for(let n in t)if(t.hasOwnProperty(n)){const r=t[n];(e=null===e?{}:e).hasOwnProperty(n)?e[n].push(i,r):e[n]=[i,r]}return e}function pv(t,i,e,n){let r=!1;if(_g()){const o=function Jd(t,i,e){const n=t.directiveRegistry;let r=null;if(n)for(let o=0;o<n.length;o++){const c=n[o];Z1(e,c.selectors,!1)&&(r||(r=[]),Xa(Fh(e,i),t,c.type),no(c)?(pu(t,e),r.unshift(c)):r.push(c))}return r}(t,i,e),c=null===n?null:{"":-1};if(null!==o){r=!0,Iw(e,t.data.length,o.length);for(let x=0;x<o.length;x++){const S=o[x];S.providersResolver&&S.providersResolver(S)}let u=!1,m=!1,g=Ac(t,i,o.length,null);for(let x=0;x<o.length;x++){const S=o[x];e.mergedAttrs=ed(e.mergedAttrs,S.hostAttrs),Aw(t,e,i,g,S),R4(g,S,c),null!==S.contentQueries&&(e.flags|=8),(null!==S.hostBindings||null!==S.hostAttrs||0!==S.hostVars)&&(e.flags|=128);const M=S.type.prototype;!u&&(M.ngOnChanges||M.ngOnInit||M.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(e.index),u=!0),!m&&(M.ngOnChanges||M.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(e.index),m=!0),g++}!function P4(t,i){const n=i.directiveEnd,r=t.data,o=i.attrs,c=[];let u=null,m=null;for(let g=i.directiveStart;g<n;g++){const x=r[g],S=x.inputs,M=null===o||ow(i)?null:V4(S,o);c.push(M),u=om(S,g,u),m=om(x.outputs,g,m)}null!==u&&(u.hasOwnProperty("class")&&(i.flags|=16),u.hasOwnProperty("style")&&(i.flags|=32)),i.initialInputs=c,i.inputs=u,i.outputs=m}(t,e)}c&&function Dw(t,i,e){if(i){const n=t.localNames=[];for(let r=0;r<i.length;r+=2){const o=e[i[r+1]];if(null==o)throw new Tn(-301,!1);n.push(i[r],o)}}}(e,n,c)}return e.mergedAttrs=ed(e.mergedAttrs,e.attrs),r}function lp(t,i,e,n,r,o){const c=o.hostBindings;if(c){let u=t.hostBindingOpCodes;null===u&&(u=t.hostBindingOpCodes=[]);const m=~i.index;(function cp(t){let i=t.length;for(;i>0;){const e=t[--i];if("number"==typeof e&&e<0)return e}return 0})(u)!=m&&u.push(m),u.push(n,r,c)}}function am(t,i){null!==t.hostBindings&&t.hostBindings(1,i)}function pu(t,i){i.flags|=2,(t.components||(t.components=[])).push(i.index)}function R4(t,i,e){if(e){if(i.exportAs)for(let n=0;n<i.exportAs.length;n++)e[i.exportAs[n]]=t;no(i)&&(e[""]=t)}}function Iw(t,i,e){t.flags|=1,t.directiveStart=i,t.directiveEnd=i+e,t.providerIndexes=i}function Aw(t,i,e,n,r){t.data[n]=r;const o=r.factory||(r.factory=iu(r.type)),c=new Yf(o,no(r),null);t.blueprint[n]=c,e[n]=c,lp(t,i,0,n,Ac(t,e,r.hostVars,mi),r)}function B4(t,i,e){const n=yl(i,t),r=Sw(e),o=t[10],c=a0(t,rm(t,r,null,e.onPush?64:16,n,i,o,o.createRenderer(n,e),null,null));t[i.index]=c}function Mc(t,i,e,n,r,o){const c=yl(t,i);!function mv(t,i,e,n,r,o,c){if(null==o)Xi(t)?t.removeAttribute(i,r,e):i.removeAttribute(r);else{const u=null==c?jn(o):c(o,n||"",r);Xi(t)?t.setAttribute(i,r,u,e):e?i.setAttributeNS(e,r,u):i.setAttribute(r,u)}}(i[11],c,o,t.value,e,n,r)}function j4(t,i,e,n,r,o){const c=o[i];if(null!==c){const u=n.setInput;for(let m=0;m<c.length;){const g=c[m++],x=c[m++],S=c[m++];null!==u?n.setInput(e,S,g,x):e[x]=S}}}function V4(t,i){let e=null,n=0;for(;n<i.length;){const r=i[n];if(0!==r)if(5!==r){if("number"==typeof r)break;t.hasOwnProperty(r)&&(null===e&&(e=[]),e.push(r,t[r],i[n+1])),n+=2}else n+=2;else n+=4}return e}function gv(t,i,e,n){return new Array(t,!0,!1,i,null,0,n,e,null,null)}function z4(t,i){const e=xr(i,t);if(f1(e)){const n=e[1];80&e[2]?ap(n,e,n.template,e[8]):e[5]>0&&_v(e)}}function _v(t){for(let n=H1(t);null!==n;n=z1(n))for(let r=10;r<n.length;r++){const o=n[r];if(1024&o[2]){const c=o[1];ap(c,o,c.template,o[8])}else o[5]>0&&_v(o)}const e=t[1].components;if(null!==e)for(let n=0;n<e.length;n++){const r=xr(e[n],t);f1(r)&&r[5]>0&&_v(r)}}function vv(t,i){const e=xr(i,t),n=e[1];(function $4(t,i){for(let e=i.length;e<t.blueprint.length;e++)i.push(t.blueprint[e])})(n,e),fu(n,e,e[8])}function a0(t,i){return t[13]?t[14][4]=i:t[13]=i,t[14]=i,i}function yv(t){for(;t;){t[2]|=64;const i=Qd(t);if(yi(t)&&!i)return t;t=i}return null}function xv(t,i,e){const n=i[10];n.begin&&n.begin();try{ap(t,i,t.template,e)}catch(r){throw Nw(i,r),r}finally{n.end&&n.end()}}function Mw(t){!function bv(t){for(let i=0;i<t.components.length;i++){const e=t.components[i],n=ip(e),r=n[1];A4(r,n,r.template,e)}}(t[8])}function wv(t,i,e){b1(0),i(t,e)}const K4=(()=>Promise.resolve(null))();function Fw(t){return t[7]||(t[7]=[])}function Pw(t){return t.cleanup||(t.cleanup=[])}function Nw(t,i){const e=t[9],n=e?e.get(em,null):null;n&&n.handleError(i)}function Lw(t,i,e,n,r){for(let o=0;o<e.length;){const c=e[o++],u=e[o++],m=i[c],g=t.data[c];null!==g.setInput?g.setInput(m,r,n,u):m[u]=r}}function hu(t,i,e){const n=gg(i,t);!function $x(t,i,e){Xi(t)?t.setValue(i,e):i.textContent=e}(t[11],n,e)}function lm(t,i,e){let n=e?t.styles:null,r=e?t.classes:null,o=0;if(null!==i)for(let c=0;c<i.length;c++){const u=i[c];"number"==typeof u?o=u:1==o?r=uo(r,u):2==o&&(n=uo(n,u+": "+i[++c]+";"))}e?t.styles=n:t.stylesWithoutHost=n,e?t.classes=r:t.classesWithoutHost=r}const Cv=new hi("INJECTOR",-1);class Rw{get(i,e=ep){if(e===ep){const n=new Error(`NullInjectorError: No provider for ${Bn(i)}!`);throw n.name="NullInjectorError",n}return e}}const Tv=new hi("Set Injector scope."),cm={},Q4={};let Sv;function Bw(){return void 0===Sv&&(Sv=new Rw),Sv}function jw(t,i=null,e=null,n){const r=Vw(t,i,e,n);return r._resolveInjectorDefTypes(),r}function Vw(t,i=null,e=null,n){return new J4(t,e,i||Bw(),n)}class J4{constructor(i,e,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const o=[];e&&Dc(e,u=>this.processProvider(u,i,e)),Dc([i],u=>this.processInjectorType(u,[],o)),this.records.set(Cv,up(void 0,this));const c=this.records.get(Tv);this.scope=null!=c?c.value:null,this.source=r||("object"==typeof i?null:Bn(i))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(i=>i.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(i,e=ep,n=_n.Default){this.assertNotDestroyed();const r=ox(this),o=tu(void 0);try{if(!(n&_n.SkipSelf)){let u=this.records.get(i);if(void 0===u){const m=function sk(t){return"function"==typeof t||"object"==typeof t&&t instanceof hi}(i)&&Th(i);u=m&&this.injectableDefInScope(m)?up(Ev(i),cm):null,this.records.set(i,u)}if(null!=u)return this.hydrate(i,u)}return(n&_n.Self?Bw():this.parent).get(i,e=n&_n.Optional&&e===ep?null:e)}catch(c){if("NullInjectorError"===c.name){if((c[Lg]=c[Lg]||[]).unshift(Bn(i)),r)throw c;return function pE(t,i,e,n){const r=t[Lg];throw i[rx]&&r.unshift(i[rx]),t.message=function hE(t,i,e,n=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let r=Bn(i);if(Array.isArray(i))r=i.map(Bn).join(" -> ");else if("object"==typeof i){let o=[];for(let c in i)if(i.hasOwnProperty(c)){let u=i[c];o.push(c+":"+("string"==typeof u?JSON.stringify(u):Bn(u)))}r=`{${o.join(", ")}}`}return`${e}${n?"("+n+")":""}[${r}]: ${t.replace(ix,"\n  ")}`}("\n"+t.message,r,e,n),t.ngTokenPath=r,t[Lg]=null,t}(c,i,"R3InjectorError",this.source)}throw c}finally{tu(o),ox(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(i=>this.get(i))}toString(){const i=[];return this.records.forEach((n,r)=>i.push(Bn(r))),`R3Injector[${i.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Tn(205,!1)}processInjectorType(i,e,n){if(!(i=si(i)))return!1;let r=Kr(i);const o=null==r&&i.ngModule||void 0,c=void 0===o?i:o,u=-1!==n.indexOf(c);if(void 0!==o&&(r=Kr(o)),null==r)return!1;if(null!=r.imports&&!u){let x;n.push(c);try{Dc(r.imports,S=>{this.processInjectorType(S,e,n)&&(void 0===x&&(x=[]),x.push(S))})}finally{}if(void 0!==x)for(let S=0;S<x.length;S++){const{ngModule:M,providers:E}=x[S];Dc(E,R=>this.processProvider(R,M,E||Br))}}this.injectorDefTypes.add(c);const m=iu(c)||(()=>new c);this.records.set(c,up(m,cm));const g=r.providers;if(null!=g&&!u){const x=i;Dc(g,S=>this.processProvider(S,x,g))}return void 0!==o&&void 0!==i.providers}processProvider(i,e,n){let r=dp(i=si(i))?i:si(i&&i.provide);const o=function ek(t,i,e){return Hw(t)?up(void 0,t.useValue):up(Uw(t),cm)}(i);if(dp(i)||!0!==i.multi)this.records.get(r);else{let c=this.records.get(r);c||(c=up(void 0,cm,!0),c.factory=()=>M1(c.multi),this.records.set(r,c)),r=i,c.multi.push(i)}this.records.set(r,o)}hydrate(i,e){return e.value===cm&&(e.value=Q4,e.value=e.factory()),"object"==typeof e.value&&e.value&&function ok(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this.onDestroy.add(e.value),e.value}injectableDefInScope(i){if(!i.providedIn)return!1;const e=si(i.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function Ev(t){const i=Th(t),e=null!==i?i.factory:iu(t);if(null!==e)return e;if(t instanceof hi)throw new Tn(204,!1);if(t instanceof Function)return function Z4(t){const i=t.length;if(i>0)throw Bh(i,"?"),new Tn(204,!1);const e=function d2(t){const i=t&&(t[Vf]||t[X_]);if(i){const e=function B5(t){if(t.hasOwnProperty("name"))return t.name;const i=(""+t).match(/^function\s*([^\s(]+)/);return null===i?"":i[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),i}return null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new Tn(204,!1)}function Uw(t,i,e){let n;if(dp(t)){const r=si(t);return iu(r)||Ev(r)}if(Hw(t))n=()=>si(t.useValue);else if(function nk(t){return!(!t||!t.useFactory)}(t))n=()=>t.useFactory(...M1(t.deps||[]));else if(function tk(t){return!(!t||!t.useExisting)}(t))n=()=>zt(si(t.useExisting));else{const r=si(t&&(t.useClass||t.provide));if(!function rk(t){return!!t.deps}(t))return iu(r)||Ev(r);n=()=>new r(...M1(t.deps))}return n}function up(t,i,e=!1){return{factory:t,value:i,multi:e?[]:void 0}}function Hw(t){return null!==t&&"object"==typeof t&&uE in t}function dp(t){return"function"==typeof t}let ws=(()=>{class t{static create(e,n){var r;if(Array.isArray(e))return jw({name:""},n,e,"");{const o=null!==(r=e.name)&&void 0!==r?r:"";return jw({name:o},e.parent,e.providers,o)}}}return t.THROW_IF_NOT_FOUND=ep,t.NULL=new Rw,t.\u0275prov=Vt({token:t,providedIn:"any",factory:()=>zt(Cv)}),t.__NG_ELEMENT_ID__=-1,t})();function mk(t,i){Sg(ip(t)[1],xo())}function wr(t){let i=function eC(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const n=[t];for(;i;){let r;if(no(t))r=i.\u0275cmp||i.\u0275dir;else{if(i.\u0275cmp)throw new Tn(903,"");r=i.\u0275dir}if(r){if(e){n.push(r);const c=t;c.inputs=Iv(t.inputs),c.declaredInputs=Iv(t.declaredInputs),c.outputs=Iv(t.outputs);const u=r.hostBindings;u&&yk(t,u);const m=r.viewQuery,g=r.contentQueries;if(m&&_k(t,m),g&&vk(t,g),Zc(t.inputs,r.inputs),Zc(t.declaredInputs,r.declaredInputs),Zc(t.outputs,r.outputs),no(r)&&r.data.animation){const x=t.data;x.animation=(x.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let c=0;c<o.length;c++){const u=o[c];u&&u.ngInherit&&u(t),u===wr&&(e=!1)}}i=Object.getPrototypeOf(i)}!function gk(t){let i=0,e=null;for(let n=t.length-1;n>=0;n--){const r=t[n];r.hostVars=i+=r.hostVars,r.hostAttrs=ed(r.hostAttrs,e=ed(e,r.hostAttrs))}}(n)}function Iv(t){return t===ys?{}:t===Br?[]:t}function _k(t,i){const e=t.viewQuery;t.viewQuery=e?(n,r)=>{i(n,r),e(n,r)}:i}function vk(t,i){const e=t.contentQueries;t.contentQueries=e?(n,r,o)=>{i(n,r,o),e(n,r,o)}:i}function yk(t,i){const e=t.hostBindings;t.hostBindings=e?(n,r)=>{i(n,r),e(n,r)}:i}let l0=null;function fp(){if(!l0){const t=cr.Symbol;if(t&&t.iterator)l0=t.iterator;else{const i=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<i.length;++e){const n=i[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(l0=n)}}}return l0}function c0(t){return!!Av(t)&&(Array.isArray(t)||!(t instanceof Map)&&fp()in t)}function Av(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Fc(t,i,e){return t[i]=e}function um(t,i){return t[i]}function na(t,i,e){return!Object.is(t[i],e)&&(t[i]=e,!0)}function Zd(t,i,e,n){const r=na(t,i,e);return na(t,i+1,n)||r}function u0(t,i,e,n,r){const o=Zd(t,i,e,n);return na(t,i+2,r)||o}function Tl(t,i,e,n,r,o){const c=Zd(t,i,e,n);return Zd(t,i+2,r,o)||c}function Ai(t,i,e,n){const r=Ut();return na(r,qd(),i)&&(Qi(),Mc(To(),r,t,i,e,n)),Ai}function mp(t,i,e,n,r,o){const u=Zd(t,function Vo(){return ai.lFrame.bindingIndex}(),e,r);return Xl(2),u?i+jn(e)+n+jn(r)+o:mi}function D(t,i,e,n,r,o,c,u){const m=Ut(),g=Qi(),x=t+20,S=g.firstCreatePass?function Ek(t,i,e,n,r,o,c,u,m){const g=i.consts,x=sp(i,t,4,c||null,Sc(g,u));pv(i,e,x,Sc(g,m)),Sg(i,x);const S=x.tViews=r0(2,x,n,r,o,i.directiveRegistry,i.pipeRegistry,null,i.schemas,g);return null!==i.queries&&(i.queries.template(i,x),S.queries=i.queries.embeddedTView(x)),x}(x,g,m,i,e,n,r,o,c):g.data[x];Ni(S,!1);const M=m[11].createComment("");Kg(g,m,M,S),ta(M,m),a0(m,m[x]=gv(M,m,M,S)),qn(S)&&n0(g,m,S),null!=c&&xs(m,S,u)}function Fa(t){return qf(function x2(){return ai.lFrame.contextLView}(),20+t)}function te(t,i=_n.Default){const e=Ut();return null===e?zt(t,i):q2(xo(),e,si(t),i)}function Bv(){throw new Error("invalid")}function T(t,i,e){const n=Ut();return na(n,qd(),i)&&function Za(t,i,e,n,r,o,c,u){const m=yl(i,e);let x,g=i.inputs;!u&&null!=g&&(x=g[n])?(Lw(t,e,x,n,r),Xr(i)&&function O4(t,i){const e=xr(i,t);16&e[2]||(e[2]|=64)}(e,i.index)):3&i.type&&(n=function s0(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(n),r=null!=c?c(r,i.value||"",n):r,Xi(o)?o.setProperty(m,n,r):kg(n)||(m.setProperty?m.setProperty(n,r):m[n]=r))}(Qi(),To(),n,t,i,n[11],e,!1),T}function jv(t,i,e,n,r){const c=r?"class":"style";Lw(t,e,i.inputs[c],c,n)}function f(t,i,e,n){const r=Ut(),o=Qi(),c=20+t,u=r[11],m=r[c]=W1(u,i,function N2(){return ai.lFrame.currentNamespace}()),g=o.firstCreatePass?function Wk(t,i,e,n,r,o,c){const u=i.consts,g=sp(i,t,2,r,Sc(u,o));return pv(i,e,g,Sc(u,c)),null!==g.attrs&&lm(g,g.attrs,!1),null!==g.mergedAttrs&&lm(g,g.mergedAttrs,!0),null!==i.queries&&i.queries.elementStart(i,g),g}(c,o,r,0,i,e,n):o.data[c];Ni(g,!0);const x=g.mergedAttrs;null!==x&&Ah(u,m,x);const S=g.classes;null!==S&&ad(u,m,S);const M=g.styles;return null!==M&&iw(u,m,M),64!=(64&g.flags)&&Kg(o,r,m,g),0===function Wd(){return ai.lFrame.elementDepthCount}()&&ta(m,r),function su(){ai.lFrame.elementDepthCount++}(),qn(g)&&(n0(o,r,g),uv(o,g,r)),null!==n&&xs(r,g),f}function p(){let t=xo();_1()?v1():(t=t.parent,Ni(t,!1));const i=t;!function b2(){ai.lFrame.elementDepthCount--}();const e=Qi();return e.firstCreatePass&&(Sg(e,t),n1(t)&&e.queries.elementEnd(t)),null!=i.classesWithoutHost&&function Fo(t){return 0!=(16&t.flags)}(i)&&jv(e,i,Ut(),i.classesWithoutHost,!0),null!=i.stylesWithoutHost&&function wa(t){return 0!=(32&t.flags)}(i)&&jv(e,i,Ut(),i.stylesWithoutHost,!1),p}function ee(t,i,e,n){return f(t,i,e,n),p(),ee}function ni(t,i,e){const n=Ut(),r=Qi(),o=t+20,c=r.firstCreatePass?function qk(t,i,e,n,r){const o=i.consts,c=Sc(o,n),u=sp(i,t,8,"ng-container",c);return null!==c&&lm(u,c,!0),pv(i,e,u,Sc(o,r)),null!==i.queries&&i.queries.elementStart(i,u),u}(o,r,n,i,e):r.data[o];Ni(c,!0);const u=n[o]=n[11].createComment("");return Kg(r,n,u,c),ta(u,n),qn(c)&&(n0(r,n,c),uv(r,c,n)),null!=e&&xs(n,c),ni}function Si(){let t=xo();const i=Qi();return _1()?v1():(t=t.parent,Ni(t,!1)),i.firstCreatePass&&(Sg(i,t),n1(t)&&i.queries.elementEnd(t)),Si}function Jn(t,i,e){return ni(t,i,e),Si(),Jn}function Ie(){return Ut()}function dm(t){return!!t&&"function"==typeof t.then}const fm=function gC(t){return!!t&&"function"==typeof t.subscribe};function L(t,i,e,n){const r=Ut(),o=Qi(),c=xo();return function tn(t,i,e,n,r,o,c,u){const m=qn(n),x=t.firstCreatePass&&Pw(t),S=i[8],M=Fw(i);let E=!0;if(3&n.type||u){const K=yl(n,i),q=u?u(K):K,Y=M.length,ce=u?De=>u(bo(De[n.index])):n.index;if(Xi(e)){let De=null;if(!u&&m&&(De=function Vv(t,i,e,n){const r=t.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const c=r[o];if(c===e&&r[o+1]===n){const u=i[7],m=r[o+2];return u.length>m?u[m]:null}"string"==typeof c&&(o+=2)}return null}(t,i,r,n.index)),null!==De)(De.__ngLastListenerFn__||De).__ngNextListenerFn__=o,De.__ngLastListenerFn__=o,E=!1;else{o=of(n,i,S,o,!1);const Ye=e.listen(q,r,o);M.push(o,Ye),x&&x.push(r,ce,Y,Y+1)}}else o=of(n,i,S,o,!0),q.addEventListener(r,o,c),M.push(o),x&&x.push(r,ce,Y,c)}else o=of(n,i,S,o,!1);const R=n.outputs;let B;if(E&&null!==R&&(B=R[r])){const K=B.length;if(K)for(let q=0;q<K;q+=2){const yt=i[B[q]][B[q+1]].subscribe(o),Ge=M.length;M.push(o,yt),x&&x.push(r,n.index,Ge,-(Ge+1))}}}(o,r,r[11],c,t,i,!!e,n),L}function _C(t,i,e,n){try{return!1!==e(n)}catch(r){return Nw(t,r),!1}}function of(t,i,e,n,r){return function o(c){if(c===Function)return n;const u=2&t.flags?xr(t.index,i):i;0==(32&i[2])&&yv(u);let m=_C(i,0,n,c),g=o.__ngNextListenerFn__;for(;g;)m=_C(i,0,g,c)&&m,g=g.__ngNextListenerFn__;return r&&!1===m&&(c.preventDefault(),c.returnValue=!1),m}}function A(t=1){return function M2(t){return(ai.lFrame.contextLView=function F2(t,i){for(;t>0;)i=i[15],t--;return i}(t,ai.lFrame.contextLView))[8]}(t)}function Gk(t,i){let e=null;const n=function f4(t){const i=t.attrs;if(null!=i){const e=i.indexOf(5);if(0==(1&e))return i[e+1]}return null}(t);for(let r=0;r<i.length;r++){const o=i[r];if("*"!==o){if(null===n?Z1(t,o,!0):h4(n,o))return r}else e=r}return e}function mu(t){const i=Ut()[16][6];if(!i.projection){const n=i.projection=Bh(t?t.length:1,null),r=n.slice();let o=i.child;for(;null!==o;){const c=t?Gk(o,t):0;null!==c&&(r[c]?r[c].projectionNext=o:n[c]=o,r[c]=o),o=o.next}}}function Sl(t,i=0,e){const n=Ut(),r=Qi(),o=sp(r,20+t,16,null,e||null);null===o.projection&&(o.projection=i),v1(),64!=(64&o.flags)&&function tw(t,i,e){nw(i[11],0,i,e,Gx(t,e,i),Yx(e.parent||i[6],e,i))}(r,n,o)}function Hv(t,i,e,n,r){const o=t[e+1],c=null===i;let u=n?Zl(o):du(o),m=!1;for(;0!==u&&(!1===m||c);){const x=t[u+1];IC(t[u],i)&&(m=!0,t[u+1]=n?tv(x):ev(x)),u=n?Zl(x):du(x)}m&&(t[e+1]=n?ev(o):tv(o))}function IC(t,i){return null===t||null==i||(Array.isArray(t)?t[1]:t)===i||!(!Array.isArray(t)||"string"!=typeof i)&&Yd(t,i)>=0}const zo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function AC(t){return t.substring(zo.key,zo.keyEnd)}function MC(t){return t.substring(zo.value,zo.valueEnd)}function zv(t,i){const e=zo.textEnd;return e===i?-1:(i=zo.keyEnd=function Kk(t,i,e){for(;i<e&&t.charCodeAt(i)>32;)i++;return i}(t,zo.key=i,e),xp(t,i,e))}function OC(t,i){const e=zo.textEnd;let n=zo.key=xp(t,i,e);return e===n?-1:(n=zo.keyEnd=function NC(t,i,e){let n;for(;i<e&&(45===(n=t.charCodeAt(i))||95===n||(-33&n)>=65&&(-33&n)<=90||n>=48&&n<=57);)i++;return i}(t,n,e),n=Wv(t,n,e),n=zo.value=xp(t,n,e),n=zo.valueEnd=function LC(t,i,e){let n=-1,r=-1,o=-1,c=i,u=c;for(;c<e;){const m=t.charCodeAt(c++);if(59===m)return u;34===m||39===m?u=c=qv(t,m,c,e):i===c-4&&85===o&&82===r&&76===n&&40===m?u=c=qv(t,41,c,e):m>32&&(u=c),o=r,r=n,n=-33&m}return u}(t,n,e),Wv(t,n,e))}function $v(t){zo.key=0,zo.keyEnd=0,zo.value=0,zo.valueEnd=0,zo.textEnd=t.length}function xp(t,i,e){for(;i<e&&t.charCodeAt(i)<=32;)i++;return i}function Wv(t,i,e,n){return(i=xp(t,i,e))<e&&i++,i}function qv(t,i,e,n){let r=-1,o=e;for(;o<n;){const c=t.charCodeAt(o++);if(c==i&&92!==r)return o;r=92==c&&92===r?0:c}throw new Error}function ud(t,i,e){return Cs(t,i,e,!1),ud}function po(t,i){return Cs(t,i,null,!0),po}function Ft(t){El(af,Gv,t,!1)}function Gv(t,i){for(let e=function PC(t){return $v(t),OC(t,xp(t,0,zo.textEnd))}(i);e>=0;e=OC(i,e))af(t,AC(i),MC(i))}function Ji(t){El(Qa,Pc,t,!0)}function Pc(t,i){for(let e=function FC(t){return $v(t),zv(t,xp(t,0,zo.textEnd))}(i);e>=0;e=zv(i,e))Qa(t,AC(i),!0)}function Cs(t,i,e,n){const r=Ut(),o=Qi(),c=Xl(2);o.firstUpdatePass&&BC(o,t,c,n),i!==mi&&na(r,c,i)&&el(o,o.data[ea()],r,r[11],t,r[c+1]=function Xk(t,i){return null==t||("string"==typeof i?t+=i:"object"==typeof t&&(t=Bn(id(t)))),t}(i,e),n,c)}function El(t,i,e,n){const r=Qi(),o=Xl(2);r.firstUpdatePass&&BC(r,null,o,n);const c=Ut();if(e!==mi&&na(c,o,e)){const u=r.data[ea()];if(h0(u,n)&&!RC(r,o)){let m=n?u.classesWithoutHost:u.stylesWithoutHost;null!==m&&(e=uo(m,e||"")),jv(r,u,c,e,n)}else!function Yk(t,i,e,n,r,o,c,u){r===mi&&(r=Br);let m=0,g=0,x=0<r.length?r[0]:null,S=0<o.length?o[0]:null;for(;null!==x||null!==S;){const M=m<r.length?r[m+1]:void 0,E=g<o.length?o[g+1]:void 0;let B,R=null;x===S?(m+=2,g+=2,M!==E&&(R=S,B=E)):null===S||null!==x&&x<S?(m+=2,R=x):(g+=2,R=S,B=E),null!==R&&el(t,i,e,n,R,B,c,u),x=m<r.length?r[m]:null,S=g<o.length?o[g]:null}}(r,u,c,c[11],c[o+1],c[o+1]=function kl(t,i,e){if(null==e||""===e)return Br;const n=[],r=id(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)t(n,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&t(n,o,r[o]);else"string"==typeof r&&i(n,r);return n}(t,i,e),n,o)}}function RC(t,i){return i>=t.expandoStartIndex}function BC(t,i,e,n){const r=t.data;if(null===r[e+1]){const o=r[ea()],c=RC(t,e);h0(o,n)&&null===i&&!c&&(i=!1),i=function pm(t,i,e,n){const r=function xg(t){const i=ai.lFrame.currentDirectiveIndex;return-1===i?null:t[i]}(t);let o=n?i.residualClasses:i.residualStyles;if(null===r)0===(n?i.classBindings:i.styleBindings)&&(e=sf(e=$o(null,t,i,e,n),i.attrs,n),o=null);else{const c=i.directiveStylingLast;if(-1===c||t[c]!==r)if(e=$o(r,t,i,e,n),null===o){let m=function Cr(t,i,e){const n=e?i.classBindings:i.styleBindings;if(0!==du(n))return t[Zl(n)]}(t,i,n);void 0!==m&&Array.isArray(m)&&(m=$o(null,t,i,m[1],n),m=sf(m,i.attrs,n),function So(t,i,e,n){t[Zl(e?i.classBindings:i.styleBindings)]=n}(t,i,n,m))}else o=function ur(t,i,e){let n;const r=i.directiveEnd;for(let o=1+i.directiveStylingLast;o<r;o++)n=sf(n,t[o].hostAttrs,e);return sf(n,i.attrs,e)}(t,i,n)}return void 0!==o&&(n?i.residualClasses=o:i.residualStyles=o),e}(r,o,i,n),function kC(t,i,e,n,r,o){let c=o?i.classBindings:i.styleBindings,u=Zl(c),m=du(c);t[n]=e;let x,g=!1;if(Array.isArray(e)){const S=e;x=S[1],(null===x||Yd(S,x)>0)&&(g=!0)}else x=e;if(r)if(0!==m){const M=Zl(t[u+1]);t[n+1]=im(M,u),0!==M&&(t[M+1]=Qg(t[M+1],n)),t[u+1]=function v4(t,i){return 131071&t|i<<17}(t[u+1],n)}else t[n+1]=im(u,0),0!==u&&(t[u+1]=Qg(t[u+1],n)),u=n;else t[n+1]=im(m,0),0===u?u=n:t[m+1]=Qg(t[m+1],n),m=n;g&&(t[n+1]=ev(t[n+1])),Hv(t,x,n,!0),Hv(t,x,n,!1),function DC(t,i,e,n,r){const o=r?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof i&&Yd(o,i)>=0&&(e[n+1]=tv(e[n+1]))}(i,x,t,n,o),c=im(u,m),o?i.classBindings=c:i.styleBindings=c}(r,o,i,e,c,n)}}function $o(t,i,e,n,r){let o=null;const c=e.directiveEnd;let u=e.directiveStylingLast;for(-1===u?u=e.directiveStart:u++;u<c&&(o=i[u],n=sf(n,o.hostAttrs,r),o!==t);)u++;return null!==t&&(e.directiveStylingLast=u),n}function sf(t,i,e){const n=e?1:2;let r=-1;if(null!==i)for(let o=0;o<i.length;o++){const c=i[o];"number"==typeof c?r=c:r===n&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Qa(t,c,!!e||i[++o]))}return void 0===t?null:t}function af(t,i,e){Qa(t,i,id(e))}function el(t,i,e,n,r,o,c,u){if(!(3&i.type))return;const m=t.data,g=m[u+1];p0(function pw(t){return 1==(1&t)}(g)?lf(m,i,e,r,du(g),c):void 0)||(p0(o)||function fw(t){return 2==(2&t)}(g)&&(o=lf(m,null,e,r,u,c)),function u4(t,i,e,n,r){const o=Xi(t);if(i)r?o?t.addClass(e,n):e.classList.add(n):o?t.removeClass(e,n):e.classList.remove(n);else{let c=-1===n.indexOf("-")?void 0:Ja.DashCase;if(null==r)o?t.removeStyle(e,n,c):e.style.removeProperty(n);else{const u="string"==typeof r&&r.endsWith("!important");u&&(r=r.slice(0,-10),c|=Ja.Important),o?t.setStyle(e,n,r,c):e.style.setProperty(n,r,u?"important":"")}}}(n,c,gg(ea(),e),r,o))}function lf(t,i,e,n,r,o){const c=null===i;let u;for(;r>0;){const m=t[r],g=Array.isArray(m),x=g?m[1]:m,S=null===x;let M=e[r+1];M===mi&&(M=S?Br:void 0);let E=S?I1(M,n):x===n?M:void 0;if(g&&!p0(E)&&(E=I1(m,n)),p0(E)&&(u=E,c))return u;const R=t[r+1];r=c?Zl(R):du(R)}if(null!==i){let m=o?i.residualClasses:i.residualStyles;null!=m&&(u=I1(m,n))}return u}function p0(t){return void 0!==t}function h0(t,i){return 0!=(t.flags&(i?16:32))}function _(t,i=""){const e=Ut(),n=Qi(),r=t+20,o=n.firstCreatePass?sp(n,r,1,i,null):n.data[r],c=e[r]=function $1(t,i){return Xi(t)?t.createText(i):t.createTextNode(i)}(e[11],i);Kg(n,e,c,o),Ni(o,!1)}function U(t){return hn("",t,""),U}function hn(t,i,e){const n=Ut(),r=function hp(t,i,e,n){return na(t,qd(),e)?i+jn(e)+n:mi}(n,t,i,e);return r!==mi&&hu(n,ea(),r),hn}function Kv(t,i,e,n,r){const o=Ut(),c=mp(o,t,i,e,n,r);return c!==mi&&hu(o,ea(),c),Kv}const cf=void 0;var aD=["en",[["a","p"],["AM","PM"],cf],[["AM","PM"],cf,cf],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],cf,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],cf,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",cf,"{1} 'at' {0}",cf],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Oc(t){const e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let gu={};function Ts(t){const i=function g0(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=t3(i);if(e)return e;const n=i.split("-")[0];if(e=t3(n),e)return e;if("en"===n)return aD;throw new Error(`Missing locale data for the locale "${t}".`)}function t3(t){return t in gu||(gu[t]=cr.ng&&cr.ng.common&&cr.ng.common.locales&&cr.ng.common.locales[t]),gu[t]}var mn=(()=>((mn=mn||{})[mn.LocaleId=0]="LocaleId",mn[mn.DayPeriodsFormat=1]="DayPeriodsFormat",mn[mn.DayPeriodsStandalone=2]="DayPeriodsStandalone",mn[mn.DaysFormat=3]="DaysFormat",mn[mn.DaysStandalone=4]="DaysStandalone",mn[mn.MonthsFormat=5]="MonthsFormat",mn[mn.MonthsStandalone=6]="MonthsStandalone",mn[mn.Eras=7]="Eras",mn[mn.FirstDayOfWeek=8]="FirstDayOfWeek",mn[mn.WeekendRange=9]="WeekendRange",mn[mn.DateFormat=10]="DateFormat",mn[mn.TimeFormat=11]="TimeFormat",mn[mn.DateTimeFormat=12]="DateTimeFormat",mn[mn.NumberSymbols=13]="NumberSymbols",mn[mn.NumberFormats=14]="NumberFormats",mn[mn.CurrencyCode=15]="CurrencyCode",mn[mn.CurrencySymbol=16]="CurrencySymbol",mn[mn.CurrencyName=17]="CurrencyName",mn[mn.Currencies=18]="Currencies",mn[mn.Directionality=19]="Directionality",mn[mn.PluralCase=20]="PluralCase",mn[mn.ExtraData=21]="ExtraData",mn))();const wp="en-US";let o3=wp;function Mi(t,i,e,n,r){if(t=si(t),Array.isArray(t))for(let o=0;o<t.length;o++)Mi(t[o],i,e,n,r);else{const o=Qi(),c=Ut();let u=dp(t)?t:si(t.provide),m=Uw(t);const g=xo(),x=1048575&g.providerIndexes,S=g.directiveStart,M=g.providerIndexes>>20;if(dp(t)||!t.multi){const E=new Yf(m,r,te),R=Oo(u,i,r?x:x+M,S);-1===R?(Xa(Fh(g,c),o,u),wo(o,t,i.length),i.push(u),g.directiveStart++,g.directiveEnd++,r&&(g.providerIndexes+=1048576),e.push(E),c.push(E)):(e[R]=E,c[R]=E)}else{const E=Oo(u,i,x+M,S),R=Oo(u,i,x,x+M),B=E>=0&&e[E],K=R>=0&&e[R];if(r&&!K||!r&&!B){Xa(Fh(g,c),o,u);const q=function hD(t,i,e,n,r){const o=new Yf(t,e,te);return o.multi=[],o.index=i,o.componentProviders=0,nl(o,r,n&&!e),o}(r?d3:uf,e.length,r,n,m);!r&&K&&(e[R].providerFactory=q),wo(o,t,i.length,0),i.push(u),g.directiveStart++,g.directiveEnd++,r&&(g.providerIndexes+=1048576),e.push(q),c.push(q)}else wo(o,t,E>-1?E:R,nl(e[r?R:E],m,!r&&n));!r&&n&&K&&e[R].componentProviders++}}}function wo(t,i,e,n){const r=dp(i),o=function ik(t){return!!t.useClass}(i);if(r||o){const m=(o?si(i.useClass):i).prototype.ngOnDestroy;if(m){const g=t.destroyHooks||(t.destroyHooks=[]);if(!r&&i.multi){const x=g.indexOf(e);-1===x?g.push(e,[n,m]):g[x+1].push(n,m)}else g.push(e,m)}}}function nl(t,i,e){return e&&t.componentProviders++,t.multi.push(i)-1}function Oo(t,i,e,n){for(let r=e;r<n;r++)if(i[r]===t)return r;return-1}function uf(t,i,e,n){return ly(this.multi,[])}function d3(t,i,e,n){const r=this.multi;let o;if(this.providerFactory){const c=this.providerFactory.componentProviders,u=Xf(e,e[1],this.providerFactory.index,n);o=u.slice(0,c),ly(r,o);for(let m=c;m<u.length;m++)o.push(u[m])}else o=[],ly(r,o);return o}function ly(t,i){for(let e=0;e<t.length;e++)i.push((0,t[e])());return i}function Nn(t,i=[]){return e=>{e.providersResolver=(n,r)=>function Lc(t,i,e){const n=Qi();if(n.firstCreatePass){const r=no(t);Mi(e,n.data,n.blueprint,r,!0),Mi(i,n.data,n.blueprint,r,!1)}}(n,r?r(t):t,i)}}class cy{}class gD{resolveComponentFactory(i){throw function mD(t){const i=Error(`No component factory found for ${Bn(t)}. Did you add it to @NgModule.entryComponents?`);return i.ngComponent=t,i}(i)}}let df=(()=>{class t{}return t.NULL=new gD,t})();function _D(){return Tp(xo(),Ut())}function Tp(t,i){return new mr(yl(t,i))}let mr=(()=>{class t{constructor(e){this.nativeElement=e}}return t.__NG_ELEMENT_ID__=_D,t})();function vD(t){return t instanceof mr?t.nativeElement:t}class _m{}let Ss=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function bD(){const t=Ut(),e=xr(xo().index,t);return function yD(t){return t[11]}(wc(e)?e:t)}(),t})(),xD=(()=>{class t{}return t.\u0275prov=Vt({token:t,providedIn:"root",factory:()=>null}),t})();class oe{constructor(i){this.full=i,this.major=i.split(".")[0],this.minor=i.split(".")[1],this.patch=i.split(".").slice(2).join(".")}}const ye=new oe("13.2.7"),ue={};function pe(t,i,e,n,r=!1){for(;null!==e;){const o=i[e.index];if(null!==o&&n.push(bo(o)),Kl(o))for(let u=10;u<o.length;u++){const m=o[u],g=m[1].firstChild;null!==g&&pe(m[1],m,g,n)}const c=e.type;if(8&c)pe(t,i,e.child,n);else if(32&c){const u=V1(e,i);let m;for(;m=u();)n.push(m)}else if(16&c){const u=Zx(i,e);if(Array.isArray(u))n.push(...u);else{const m=Qd(i[16]);pe(m[1],m,u,n,!0)}}e=r?e.projectionNext:e.next}return n}class _e{constructor(i,e){this._lView=i,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const i=this._lView,e=i[1];return pe(e,i,e.firstChild,[])}get context(){return this._lView[8]}set context(i){this._lView[8]=i}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const i=this._lView[3];if(Kl(i)){const e=i[8],n=e?e.indexOf(this):-1;n>-1&&(Gg(i,n),Pg(e,n))}this._attachedToViewContainer=!1}qx(this._lView[1],this._lView)}onDestroy(i){o0(this._lView[1],this._lView,null,i)}markForCheck(){yv(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){xv(this._lView[1],this._lView,this.context)}checkNoChanges(){!function q4(t,i,e){bg(!0);try{xv(t,i,e)}finally{bg(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Tn(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function t4(t,i){nm(t,i,i[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(i){if(this._attachedToViewContainer)throw new Tn(902,"");this._appRef=i}}class xe extends _e{constructor(i){super(i),this._view=i}detectChanges(){Mw(this._view)}checkNoChanges(){!function G4(t){bg(!0);try{Mw(t)}finally{bg(!1)}}(this._view)}get context(){return null}}class at extends df{constructor(i){super(),this.ngModule=i}resolveComponentFactory(i){const e=Bs(i);return new ht(e,this.ngModule)}}function kt(t){const i=[];for(let e in t)t.hasOwnProperty(e)&&i.push({propName:t[e],templateName:e});return i}class ht extends cy{constructor(i,e){super(),this.componentDef=i,this.ngModule=e,this.componentType=i.type,this.selector=function g4(t){return t.map(m4).join(",")}(i.selectors),this.ngContentSelectors=i.ngContentSelectors?i.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return kt(this.componentDef.inputs)}get outputs(){return kt(this.componentDef.outputs)}create(i,e,n,r){const o=(r=r||this.ngModule)?function ut(t,i){return{get:(e,n,r)=>{const o=t.get(e,ue,r);return o!==ue||n===ue?o:i.get(e,n,r)}}}(i,r.injector):i,c=o.get(_m,kh),u=o.get(xD,null),m=c.createRenderer(null,this.componentDef),g=this.componentDef.selectors[0][0]||"div",x=n?function kw(t,i,e){if(Xi(t))return t.selectRootElement(i,e===ya.ShadowDom);let n="string"==typeof i?t.querySelector(i):i;return n.textContent="",n}(m,n,this.componentDef.encapsulation):W1(c.createRenderer(null,this.componentDef),g,function ft(t){const i=t.toLowerCase();return"svg"===i?"svg":"math"===i?"math":null}(g)),S=this.componentDef.onPush?576:528,M=function Zw(t,i){return{components:[],scheduler:t||XE,clean:K4,playerHandler:i||null,flags:0}}(),E=r0(0,null,null,1,0,null,null,null,null,null),R=rm(null,E,M,S,null,null,c,m,u,o);let B,K;Kf(R);try{const q=function Qw(t,i,e,n,r,o){const c=e[1];e[20]=t;const m=sp(c,20,2,"#host",null),g=m.mergedAttrs=i.hostAttrs;null!==g&&(lm(m,g,!0),null!==t&&(Ah(r,t,g),null!==m.classes&&ad(r,t,m.classes),null!==m.styles&&iw(r,t,m.styles)));const x=n.createRenderer(t,i),S=rm(e,Sw(i),null,i.onPush?64:16,e[20],m,n,x,o||null,null);return c.firstCreatePass&&(Xa(Fh(m,e),c,i.type),pu(c,m),Iw(m,e.length,1)),a0(e,S),e[20]=S}(x,this.componentDef,R,c,m);if(x)if(n)Ah(m,x,["ng-version",ye.full]);else{const{attrs:Y,classes:ce}=function _4(t){const i=[],e=[];let n=1,r=2;for(;n<t.length;){let o=t[n];if("string"==typeof o)2===r?""!==o&&i.push(o,t[++n]):8===r&&e.push(o);else{if(!bs(r))break;r=o}n++}return{attrs:i,classes:e}}(this.componentDef.selectors[0]);Y&&Ah(m,x,Y),ce&&ce.length>0&&ad(m,x,ce.join(" "))}if(K=u1(E,20),void 0!==e){const Y=K.projection=[];for(let ce=0;ce<this.ngContentSelectors.length;ce++){const De=e[ce];Y.push(null!=De?Array.from(De):null)}}B=function Jw(t,i,e,n,r){const o=e[1],c=function fv(t,i,e){const n=xo();t.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),Aw(t,n,i,Ac(t,i,1,null),e));const r=Xf(i,t,n.directiveStart,n);ta(r,i);const o=yl(n,i);return o&&ta(o,i),r}(o,e,i);if(n.components.push(c),t[8]=c,r&&r.forEach(m=>m(c,i)),i.contentQueries){const m=xo();i.contentQueries(1,c,m.directiveStart)}const u=xo();return!o.firstCreatePass||null===i.hostBindings&&null===i.hostAttrs||(kc(u.index),lp(e[1],u,0,u.directiveStart,u.directiveEnd,i),am(i,c)),c}(q,this.componentDef,R,M,[mk]),fu(E,R,null)}finally{Tg()}return new An(this.componentType,B,Tp(K,R),R,K)}}class An extends class f3{}{constructor(i,e,n,r,o){super(),this.location=n,this._rootLView=r,this._tNode=o,this.instance=e,this.hostView=this.changeDetectorRef=new xe(r),this.componentType=i}get injector(){return new Qf(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(i){this.hostView.onDestroy(i)}}class en{}class ci{}const Sr=new Map;class x0 extends en{constructor(i,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new at(this);const n=ba(i);this._bootstrapComponents=Ic(n.bootstrap),this._r3Injector=Vw(i,e,[{provide:en,useValue:this},{provide:df,useValue:this.componentFactoryResolver}],Bn(i)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(i)}get(i,e=ws.THROW_IF_NOT_FOUND,n=_n.Default){return i===ws||i===en||i===Cv?this:this._r3Injector.get(i,e,n)}destroy(){const i=this._r3Injector;!i.destroyed&&i.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(i){this.destroyCbs.push(i)}}class tc extends ci{constructor(i){super(),this.moduleType=i,null!==ba(i)&&function rl(t){const i=new Set;!function e(n){const r=ba(n,!0),o=r.id;null!==o&&(function No(t,i,e){if(i&&i!==e)throw new Error(`Duplicate module registered for ${t} - ${Bn(i)} vs ${Bn(i.name)}`)}(o,Sr.get(o),n),Sr.set(o,n));const c=Ic(r.imports);for(const u of c)i.has(u)||(i.add(u),e(u))}(t)}(i)}create(i){return new x0(this.moduleType,i)}}function rt(t,i,e){const n=Zs()+t,r=Ut();return r[n]===mi?Fc(r,n,e?i.call(e):i()):um(r,n)}function Ei(t,i,e,n){return function u6(t,i,e,n,r,o){const c=i+e;return na(t,c,r)?Fc(t,c+1,o?n.call(o,r):n(r)):fy(t,c+1)}(Ut(),Zs(),t,i,e,n)}function ia(t,i,e,n,r){return d6(Ut(),Zs(),t,i,e,n,r)}function kp(t,i,e,n,r,o){return function f6(t,i,e,n,r,o,c,u){const m=i+e;return u0(t,m,r,o,c)?Fc(t,m+3,u?n.call(u,r,o,c):n(r,o,c)):fy(t,m+3)}(Ut(),Zs(),t,i,e,n,r,o)}function Dp(t,i,e,n,r,o,c){return p6(Ut(),Zs(),t,i,e,n,r,o,c)}function dy(t,i,e,n,r,o,c,u){const m=Zs()+t,g=Ut(),x=Tl(g,m,e,n,r,o);return na(g,m+4,c)||x?Fc(g,m+5,u?i.call(u,e,n,r,o,c):i(e,n,r,o,c)):um(g,m+5)}function w0(t,i,e,n,r,o,c,u,m){const g=Zs()+t,x=Ut(),S=Tl(x,g,e,n,r,o);return Zd(x,g+4,c,u)||S?Fc(x,g+6,m?i.call(m,e,n,r,o,c,u):i(e,n,r,o,c,u)):um(x,g+6)}function wD(t,i,e,n){return function h6(t,i,e,n,r,o){let c=i+e,u=!1;for(let m=0;m<r.length;m++)na(t,c++,r[m])&&(u=!0);return u?Fc(t,c,n.apply(o,r)):fy(t,c)}(Ut(),Zs(),t,i,e,n)}function fy(t,i){const e=t[i];return e===mi?void 0:e}function d6(t,i,e,n,r,o,c){const u=i+e;return Zd(t,u,r,o)?Fc(t,u+2,c?n.call(c,r,o):n(r,o)):fy(t,u+2)}function p6(t,i,e,n,r,o,c,u,m){const g=i+e;return Tl(t,g,r,o,c,u)?Fc(t,g+4,m?n.call(m,r,o,c,u):n(r,o,c,u)):fy(t,g+4)}function Ne(t,i){const e=Qi();let n;const r=t+20;e.firstCreatePass?(n=function PB(t,i){if(i)for(let e=i.length-1;e>=0;e--){const n=i[e];if(t===n.name)return n}}(i,e.pipeRegistry),e.data[r]=n,n.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,n.onDestroy)):n=e.data[r];const o=n.factory||(n.factory=iu(n.type)),c=tu(te);try{const u=Ig(!1),m=o();return Ig(u),function kk(t,i,e,n){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),i[e]=n}(e,Ut(),r,m),m}finally{tu(c)}}function Oa(t,i,e,n){const r=t+20,o=Ut(),c=qf(o,r);return py(o,r)?d6(o,Zs(),i,c.transform,e,n,c):c.transform(e,n)}function He(t,i,e,n,r,o){const c=t+20,u=Ut(),m=qf(u,c);return py(u,c)?p6(u,Zs(),i,m.transform,e,n,r,o,m):m.transform(e,n,r,o)}function py(t,i){return t[1].data[i].pure}function CD(t){return i=>{setTimeout(t,void 0,i)}}const Et=class RB extends Wi{constructor(i=!1){super(),this.__isAsync=i}emit(i){super.next(i)}subscribe(i,e,n){var r,o,c;let u=i,m=e||(()=>null),g=n;if(i&&"object"==typeof i){const S=i;u=null===(r=S.next)||void 0===r?void 0:r.bind(S),m=null===(o=S.error)||void 0===o?void 0:o.bind(S),g=null===(c=S.complete)||void 0===c?void 0:c.bind(S)}this.__isAsync&&(m=CD(m),u&&(u=CD(u)),g&&(g=CD(g)));const x=super.subscribe({next:u,error:m,complete:g});return i instanceof lo&&i.add(x),x}};function BB(){return this._results[fp()]()}class TD{constructor(i=!1){this._emitDistinctChangesOnly=i,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=fp(),n=TD.prototype;n[e]||(n[e]=BB)}get changes(){return this._changes||(this._changes=new Et)}get(i){return this._results[i]}map(i){return this._results.map(i)}filter(i){return this._results.filter(i)}find(i){return this._results.find(i)}reduce(i,e){return this._results.reduce(i,e)}forEach(i){this._results.forEach(i)}some(i){return this._results.some(i)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(i,e){const n=this;n.dirty=!1;const r=wl(i);(this._changesDetected=!function nE(t,i,e){if(t.length!==i.length)return!1;for(let n=0;n<t.length;n++){let r=t[n],o=i[n];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}(n._results,r,e))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Rc=(()=>{class t{}return t.__NG_ELEMENT_ID__=UB,t})();const jB=Rc,VB=class extends jB{constructor(i,e,n){super(),this._declarationLView=i,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(i){const e=this._declarationTContainer.tViews,n=rm(this._declarationLView,e,i,16,null,e.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(n[19]=o.createEmbeddedView(e)),fu(e,n,i),new _e(n)}};function UB(){return h3(xo(),Ut())}function h3(t,i){return 4&t.type?new VB(i,t,Tp(t,i)):null}let Al=(()=>{class t{}return t.__NG_ELEMENT_ID__=HB,t})();function HB(){return _6(xo(),Ut())}const zB=Al,m6=class extends zB{constructor(i,e,n){super(),this._lContainer=i,this._hostTNode=e,this._hostLView=n}get element(){return Tp(this._hostTNode,this._hostLView)}get injector(){return new Qf(this._hostTNode,this._hostLView)}get parentInjector(){const i=Ph(this._hostTNode,this._hostLView);if(V2(i)){const e=xl(i,this._hostLView),n=bl(i);return new Qf(e[1].data[n+8],e)}return new Qf(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(i){const e=g6(this._lContainer);return null!==e&&e[i]||null}get length(){return this._lContainer.length-10}createEmbeddedView(i,e,n){const r=i.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(i,e,n,r,o){const c=i&&!function Rh(t){return"function"==typeof t}(i);let u;if(c)u=e;else{const S=e||{};u=S.index,n=S.injector,r=S.projectableNodes,o=S.ngModuleRef}const m=c?i:new ht(Bs(i)),g=n||this.parentInjector;if(!o&&null==m.ngModule){const M=(c?g:this.parentInjector).get(en,null);M&&(o=M)}const x=m.create(g,r,void 0,o);return this.insert(x.hostView,u),x}insert(i,e){const n=i._lView,r=n[1];if(function p1(t){return Kl(t[3])}(n)){const x=this.indexOf(i);if(-1!==x)this.detach(x);else{const S=n[3],M=new m6(S,S[6],S[3]);M.detach(M.indexOf(i))}}const o=this._adjustIndex(e),c=this._lContainer;!function r4(t,i,e,n){const r=10+n,o=e.length;n>0&&(e[r-1][4]=i),n<o-10?(i[4]=e[r],Y2(e,10+n,i)):(e.push(i),i[4]=null),i[3]=e;const c=i[17];null!==c&&e!==c&&function o4(t,i){const e=t[9];i[16]!==i[3][3][16]&&(t[2]=!0),null===e?t[9]=[i]:e.push(i)}(c,i);const u=i[19];null!==u&&u.insertView(t),i[2]|=128}(r,n,c,o);const u=X1(o,c),m=n[11],g=tm(m,c[7]);return null!==g&&function e4(t,i,e,n,r,o){n[0]=r,n[6]=i,nm(t,n,e,1,r,o)}(r,c[6],m,n,g,u),i.attachToViewContainerRef(),Y2(SD(c),o,i),i}move(i,e){return this.insert(i,e)}indexOf(i){const e=g6(this._lContainer);return null!==e?e.indexOf(i):-1}remove(i){const e=this._adjustIndex(i,-1),n=Gg(this._lContainer,e);n&&(Pg(SD(this._lContainer),e),qx(n[1],n))}detach(i){const e=this._adjustIndex(i,-1),n=Gg(this._lContainer,e);return n&&null!=Pg(SD(this._lContainer),e)?new _e(n):null}_adjustIndex(i,e=0){return null==i?this.length+e:i}};function g6(t){return t[8]}function SD(t){return t[8]||(t[8]=[])}function _6(t,i){let e;const n=i[t.index];if(Kl(n))e=n;else{let r;if(8&t.type)r=bo(n);else{const o=i[11];r=o.createComment("");const c=yl(t,i);Cl(o,tm(o,c),r,function l4(t,i){return Xi(t)?t.nextSibling(i):i.nextSibling}(o,c),!1)}i[t.index]=e=gv(n,i,r,t),a0(i,e)}return new m6(e,t,i)}class ED{constructor(i){this.queryList=i,this.matches=null}clone(){return new ED(this.queryList)}setDirty(){this.queryList.setDirty()}}class kD{constructor(i=[]){this.queries=i}createEmbeddedView(i){const e=i.queries;if(null!==e){const n=null!==i.contentQueries?i.contentQueries[0]:e.length,r=[];for(let o=0;o<n;o++){const c=e.getByIndex(o);r.push(this.queries[c.indexInDeclarationView].clone())}return new kD(r)}return null}insertView(i){this.dirtyQueriesWithMatches(i)}detachView(i){this.dirtyQueriesWithMatches(i)}dirtyQueriesWithMatches(i){for(let e=0;e<this.queries.length;e++)null!==w6(i,e).matches&&this.queries[e].setDirty()}}class v6{constructor(i,e,n=null){this.predicate=i,this.flags=e,this.read=n}}class DD{constructor(i=[]){this.queries=i}elementStart(i,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(i,e)}elementEnd(i){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(i)}embeddedTView(i){let e=null;for(let n=0;n<this.length;n++){const r=null!==e?e.length:0,o=this.getByIndex(n).embeddedTView(i,r);o&&(o.indexInDeclarationView=n,null!==e?e.push(o):e=[o])}return null!==e?new DD(e):null}template(i,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(i,e)}getByIndex(i){return this.queries[i]}get length(){return this.queries.length}track(i){this.queries.push(i)}}class ID{constructor(i,e=-1){this.metadata=i,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(i,e){this.isApplyingToNode(e)&&this.matchTNode(i,e)}elementEnd(i){this._declarationNodeIndex===i.index&&(this._appliesToNextNode=!1)}template(i,e){this.elementStart(i,e)}embeddedTView(i,e){return this.isApplyingToNode(i)?(this.crossesNgTemplate=!0,this.addMatch(-i.index,e),new ID(this.metadata)):null}isApplyingToNode(i){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let n=i.parent;for(;null!==n&&8&n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(i,e){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const o=n[r];this.matchTNodeWithReadOption(i,e,qB(e,o)),this.matchTNodeWithReadOption(i,e,Oh(e,i,o,!1,!1))}else n===Rc?4&e.type&&this.matchTNodeWithReadOption(i,e,-1):this.matchTNodeWithReadOption(i,e,Oh(e,i,n,!1,!1))}matchTNodeWithReadOption(i,e,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===mr||r===Al||r===Rc&&4&e.type)this.addMatch(e.index,-2);else{const o=Oh(e,i,r,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,n)}}addMatch(i,e){null===this.matches?this.matches=[i,e]:this.matches.push(i,e)}}function qB(t,i){const e=t.localNames;if(null!==e)for(let n=0;n<e.length;n+=2)if(e[n]===i)return e[n+1];return null}function KB(t,i,e,n){return-1===e?function GB(t,i){return 11&t.type?Tp(t,i):4&t.type?h3(t,i):null}(i,t):-2===e?function YB(t,i,e){return e===mr?Tp(i,t):e===Rc?h3(i,t):e===Al?_6(i,t):void 0}(t,i,n):Xf(t,t[1],e,i)}function y6(t,i,e,n){const r=i[19].queries[n];if(null===r.matches){const o=t.data,c=e.matches,u=[];for(let m=0;m<c.length;m+=2){const g=c[m];u.push(g<0?null:KB(i,o[g],c[m+1],e.metadata.read))}r.matches=u}return r.matches}function AD(t,i,e,n){const r=t.queries.getByIndex(e),o=r.matches;if(null!==o){const c=y6(t,i,r,e);for(let u=0;u<o.length;u+=2){const m=o[u];if(m>0)n.push(c[u/2]);else{const g=o[u+1],x=i[-m];for(let S=10;S<x.length;S++){const M=x[S];M[17]===M[3]&&AD(M[1],M,g,n)}if(null!==x[9]){const S=x[9];for(let M=0;M<S.length;M++){const E=S[M];AD(E[1],E,g,n)}}}}}return n}function xt(t){const i=Ut(),e=Qi(),n=E2();b1(n+1);const r=w6(e,n);if(t.dirty&&d1(i)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const o=r.crossesNgTemplate?AD(e,i,n,[]):y6(e,i,r,n);t.reset(o,vD),t.notifyOnChanges()}return!0}return!1}function Mt(t,i,e){const n=Qi();n.firstCreatePass&&(x6(n,new v6(t,i,e),-1),2==(2&i)&&(n.staticViewQueries=!0)),b6(n,Ut(),i)}function ol(t,i,e,n){const r=Qi();if(r.firstCreatePass){const o=xo();x6(r,new v6(i,e,n),o.index),function QB(t,i){const e=t.contentQueries||(t.contentQueries=[]);i!==(e.length?e[e.length-1]:-1)&&e.push(t.queries.length-1,i)}(r,t),2==(2&e)&&(r.staticContentQueries=!0)}b6(r,Ut(),e)}function wt(){return function XB(t,i){return t[19].queries[i].queryList}(Ut(),E2())}function b6(t,i,e){const n=new TD(4==(4&e));o0(t,i,n,n.destroy),null===i[19]&&(i[19]=new kD),i[19].queries.push(new ED(n))}function x6(t,i,e){null===t.queries&&(t.queries=new DD),t.queries.track(new ID(i,e))}function w6(t,i){return t.queries.getByIndex(i)}function m3(t,i){return h3(t,i)}function v3(...t){}const LD=new hi("Application Initializer");let RD=(()=>{class t{constructor(e){this.appInits=e,this.resolve=v3,this.reject=v3,this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],n=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const o=this.appInits[r]();if(dm(o))e.push(o);else if(fm(o)){const c=new Promise((u,m)=>{o.subscribe({complete:u,error:m})});e.push(c)}}Promise.all(e).then(()=>{n()}).catch(r=>{this.reject(r)}),0===e.length&&n(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(zt(LD,8))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const my=new hi("AppId",{providedIn:"root",factory:function j6(){return`${BD()}${BD()}${BD()}`}});function BD(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const V6=new hi("Platform Initializer"),gy=new hi("Platform ID"),U6=new hi("appBootstrapListener");let H6=(()=>{class t{log(e){console.log(e)}warn(e){console.warn(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();const Ip=new hi("LocaleId",{providedIn:"root",factory:()=>ax(Ip,_n.Optional|_n.SkipSelf)||function hj(){return"undefined"!=typeof $localize&&$localize.locale||wp}()}),mj=new hi("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class gj{constructor(i,e){this.ngModuleFactory=i,this.componentFactories=e}}let z6=(()=>{class t{compileModuleSync(e){return new tc(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const n=this.compileModuleSync(e),o=Ic(ba(e).declarations).reduce((c,u)=>{const m=Bs(u);return m&&c.push(new ht(m)),c},[]);return new gj(n,o)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const vj=(()=>Promise.resolve(0))();function jD(t){"undefined"==typeof Zone?vj.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class gr{constructor({enableLongStackTrace:i=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Et(!1),this.onMicrotaskEmpty=new Et(!1),this.onStable=new Et(!1),this.onError=new Et(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&e,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function yj(){let t=cr.requestAnimationFrame,i=cr.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&i){const e=t[Zone.__symbol__("OriginalDelegate")];e&&(t=e);const n=i[Zone.__symbol__("OriginalDelegate")];n&&(i=n)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:i}}().nativeRequestAnimationFrame,function wj(t){const i=()=>{!function xj(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(cr,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,UD(t),t.isCheckStableRunning=!0,VD(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),UD(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,n,r,o,c,u)=>{try{return $6(t),e.invokeTask(r,o,c,u)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&i(),W6(t)}},onInvoke:(e,n,r,o,c,u,m)=>{try{return $6(t),e.invoke(r,o,c,u,m)}finally{t.shouldCoalesceRunChangeDetection&&i(),W6(t)}},onHasTask:(e,n,r,o)=>{e.hasTask(r,o),n===r&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,UD(t),VD(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,n,r,o)=>(e.handleError(r,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!gr.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(gr.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(i,e,n){return this._inner.run(i,e,n)}runTask(i,e,n,r){const o=this._inner,c=o.scheduleEventTask("NgZoneEvent: "+r,i,bj,v3,v3);try{return o.runTask(c,e,n)}finally{o.cancelTask(c)}}runGuarded(i,e,n){return this._inner.runGuarded(i,e,n)}runOutsideAngular(i){return this._outer.run(i)}}const bj={};function VD(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function UD(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function $6(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function W6(t){t._nesting--,VD(t)}class Cj{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Et,this.onMicrotaskEmpty=new Et,this.onStable=new Et,this.onError=new Et}run(i,e,n){return i.apply(e,n)}runGuarded(i,e,n){return i.apply(e,n)}runOutsideAngular(i){return i()}runTask(i,e,n,r){return i.apply(e,n)}}let HD=(()=>{class t{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{gr.assertNotInAngularZone(),jD(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())jD(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(e)||(clearTimeout(n.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,n,r){let o=-1;n&&n>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(c=>c.timeoutId!==o),e(this._didWork,this.getPendingTasks())},n)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:r})}whenStable(e,n,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,n,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,n,r){return[]}}return t.\u0275fac=function(e){return new(e||t)(zt(gr))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})(),q6=(()=>{class t{constructor(){this._applications=new Map,zD.addToWindow(this)}registerApplication(e,n){this._applications.set(e,n)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,n=!0){return zD.findTestabilityInTree(this,e,n)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();class Tj{addToWindow(i){}findTestabilityInTree(i,e,n){return null}}let xu,zD=new Tj;const G6=new hi("AllowMultipleToken");class K6{constructor(i,e){this.name=i,this.token=e}}function Y6(t,i,e=[]){const n=`Platform: ${i}`,r=new hi(n);return(o=[])=>{let c=X6();if(!c||c.injector.get(G6,!1))if(t)t(e.concat(o).concat({provide:r,useValue:!0}));else{const u=e.concat(o).concat({provide:r,useValue:!0},{provide:Tv,useValue:"platform"});!function Dj(t){if(xu&&!xu.destroyed&&!xu.injector.get(G6,!1))throw new Tn(400,"");xu=t.get(Q6);const i=t.get(V6,null);i&&i.forEach(e=>e())}(ws.create({providers:u,name:n}))}return function Ij(t){const i=X6();if(!i)throw new Tn(401,"");return i}()}}function X6(){return xu&&!xu.destroyed?xu:null}let Q6=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,n){const u=function Aj(t,i){let e;return e="noop"===t?new Cj:("zone.js"===t?void 0:t)||new gr({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==i?void 0:i.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==i?void 0:i.ngZoneRunCoalescing)}),e}(n?n.ngZone:void 0,{ngZoneEventCoalescing:n&&n.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:n&&n.ngZoneRunCoalescing||!1}),m=[{provide:gr,useValue:u}];return u.run(()=>{const g=ws.create({providers:m,parent:this.injector,name:e.moduleType.name}),x=e.create(g),S=x.injector.get(em,null);if(!S)throw new Tn(402,"");return u.runOutsideAngular(()=>{const M=u.onError.subscribe({next:E=>{S.handleError(E)}});x.onDestroy(()=>{$D(this._modules,x),M.unsubscribe()})}),function Mj(t,i,e){try{const n=e();return dm(n)?n.catch(r=>{throw i.runOutsideAngular(()=>t.handleError(r)),r}):n}catch(n){throw i.runOutsideAngular(()=>t.handleError(n)),n}}(S,u,()=>{const M=x.injector.get(RD);return M.runInitializers(),M.donePromise.then(()=>(function oy(t){Aa(t,"Expected localeId to be defined"),"string"==typeof t&&(o3=t.toLowerCase().replace(/_/g,"-"))}(x.injector.get(Ip,wp)||wp),this._moduleDoBootstrap(x),x))})})}bootstrapModule(e,n=[]){const r=J6({},n);return function Ej(t,i,e){const n=new tc(e);return Promise.resolve(n)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(e){const n=e.injector.get(y3);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>n.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new Tn(403,"");e.instance.ngDoBootstrap(n)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Tn(404,"");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(zt(ws))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();function J6(t,i){return Array.isArray(i)?i.reduce(J6,t):Object.assign(Object.assign({},t),i)}let y3=(()=>{class t{constructor(e,n,r,o,c){this._zone=e,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=o,this._initStatus=c,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const u=new Lr(g=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{g.next(this._stable),g.complete()})}),m=new Lr(g=>{let x;this._zone.runOutsideAngular(()=>{x=this._zone.onStable.subscribe(()=>{gr.assertNotInAngularZone(),jD(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,g.next(!0))})})});const S=this._zone.onUnstable.subscribe(()=>{gr.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{g.next(!1)}))});return()=>{x.unsubscribe(),S.unsubscribe()}});this.isStable=function o2(...t){const i=Gr(t),e=function e2(t,i){return"number"==typeof Rd(t)?t.pop():i}(t,1/0),n=t;return n.length?1===n.length?_a(n[0]):bh(e)(Ls(n,i)):In}(u,m.pipe(G_()))}bootstrap(e,n){if(!this._initStatus.done)throw new Tn(405,"");let r;r=e instanceof cy?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(r.componentType);const o=function kj(t){return t.isBoundToModule}(r)?void 0:this._injector.get(en),u=r.create(ws.NULL,[],n||r.selector,o),m=u.location.nativeElement,g=u.injector.get(HD,null),x=g&&u.injector.get(q6);return g&&x&&x.registerApplication(m,g),u.onDestroy(()=>{this.detachView(u.hostView),$D(this.components,u),x&&x.unregisterApplication(m)}),this._loadComponent(u),u}tick(){if(this._runningTick)throw new Tn(101,"");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const n=e;this._views.push(n),n.attachToAppRef(this)}detachView(e){const n=e;$D(this._views,n),n.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(U6,[]).concat(this._bootstrapListeners).forEach(r=>r(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(zt(gr),zt(ws),zt(em),zt(df),zt(RD))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function $D(t,i){const e=t.indexOf(i);e>-1&&t.splice(e,1)}let eO=!0,Wo=(()=>{class t{}return t.__NG_ELEMENT_ID__=Oj,t})();function Oj(t){return function Nj(t,i,e){if(Xr(t)&&!e){const n=xr(t.index,i);return new _e(n,n)}return 47&t.type?new _e(i[16],i):null}(xo(),Ut(),16==(16&t))}class oO{constructor(){}supports(i){return c0(i)}create(i){return new Uj(i)}}const Vj=(t,i)=>i;class Uj{constructor(i){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=i||Vj}forEachItem(i){let e;for(e=this._itHead;null!==e;e=e._next)i(e)}forEachOperation(i){let e=this._itHead,n=this._removalsHead,r=0,o=null;for(;e||n;){const c=!n||e&&e.currentIndex<aO(n,r,o)?e:n,u=aO(c,r,o),m=c.currentIndex;if(c===n)r--,n=n._nextRemoved;else if(e=e._next,null==c.previousIndex)r++;else{o||(o=[]);const g=u-r,x=m-r;if(g!=x){for(let M=0;M<g;M++){const E=M<o.length?o[M]:o[M]=0,R=E+M;x<=R&&R<g&&(o[M]=E+1)}o[c.previousIndex]=x-g}}u!==m&&i(c,u,m)}}forEachPreviousItem(i){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)i(e)}forEachAddedItem(i){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)i(e)}forEachMovedItem(i){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)i(e)}forEachRemovedItem(i){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)i(e)}forEachIdentityChange(i){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)i(e)}diff(i){if(null==i&&(i=[]),!c0(i))throw new Tn(900,"");return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let r,o,c,e=this._itHead,n=!1;if(Array.isArray(i)){this.length=i.length;for(let u=0;u<this.length;u++)o=i[u],c=this._trackByFn(u,o),null!==e&&Object.is(e.trackById,c)?(n&&(e=this._verifyReinsertion(e,o,c,u)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,c,u),n=!0),e=e._next}else r=0,function Sk(t,i){if(Array.isArray(t))for(let e=0;e<t.length;e++)i(t[e]);else{const e=t[fp()]();let n;for(;!(n=e.next()).done;)i(n.value)}}(i,u=>{c=this._trackByFn(r,u),null!==e&&Object.is(e.trackById,c)?(n&&(e=this._verifyReinsertion(e,u,c,r)),Object.is(e.item,u)||this._addIdentityChange(e,u)):(e=this._mismatch(e,u,c,r),n=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=i,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let i;for(i=this._previousItHead=this._itHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._additionsHead;null!==i;i=i._nextAdded)i.previousIndex=i.currentIndex;for(this._additionsHead=this._additionsTail=null,i=this._movesHead;null!==i;i=i._nextMoved)i.previousIndex=i.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(i,e,n,r){let o;return null===i?o=this._itTail:(o=i._prev,this._remove(i)),null!==(i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(i.item,e)||this._addIdentityChange(i,e),this._reinsertAfter(i,o,r)):null!==(i=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(i.item,e)||this._addIdentityChange(i,e),this._moveAfter(i,o,r)):i=this._addAfter(new Hj(e,n),o,r),i}_verifyReinsertion(i,e,n,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==o?i=this._reinsertAfter(o,i._prev,r):i.currentIndex!=r&&(i.currentIndex=r,this._addToMoves(i,r)),i}_truncate(i){for(;null!==i;){const e=i._next;this._addToRemovals(this._unlink(i)),i=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(i,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(i);const r=i._prevRemoved,o=i._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(i,e,n),this._addToMoves(i,n),i}_moveAfter(i,e,n){return this._unlink(i),this._insertAfter(i,e,n),this._addToMoves(i,n),i}_addAfter(i,e,n){return this._insertAfter(i,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=i:this._additionsTail._nextAdded=i,i}_insertAfter(i,e,n){const r=null===e?this._itHead:e._next;return i._next=r,i._prev=e,null===r?this._itTail=i:r._prev=i,null===e?this._itHead=i:e._next=i,null===this._linkedRecords&&(this._linkedRecords=new sO),this._linkedRecords.put(i),i.currentIndex=n,i}_remove(i){return this._addToRemovals(this._unlink(i))}_unlink(i){null!==this._linkedRecords&&this._linkedRecords.remove(i);const e=i._prev,n=i._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,i}_addToMoves(i,e){return i.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=i:this._movesTail._nextMoved=i),i}_addToRemovals(i){return null===this._unlinkedRecords&&(this._unlinkedRecords=new sO),this._unlinkedRecords.put(i),i.currentIndex=null,i._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=i,i._prevRemoved=null):(i._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=i),i}_addIdentityChange(i,e){return i.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=i:this._identityChangesTail._nextIdentityChange=i,i}}class Hj{constructor(i,e){this.item=i,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class zj{constructor(){this._head=null,this._tail=null}add(i){null===this._head?(this._head=this._tail=i,i._nextDup=null,i._prevDup=null):(this._tail._nextDup=i,i._prevDup=this._tail,i._nextDup=null,this._tail=i)}get(i,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,i))return n;return null}remove(i){const e=i._prevDup,n=i._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class sO{constructor(){this.map=new Map}put(i){const e=i.trackById;let n=this.map.get(e);n||(n=new zj,this.map.set(e,n)),n.add(i)}get(i,e){const r=this.map.get(i);return r?r.get(i,e):null}remove(i){const e=i.trackById;return this.map.get(e).remove(i)&&this.map.delete(e),i}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function aO(t,i,e){const n=t.previousIndex;if(null===n)return n;let r=0;return e&&n<e.length&&(r=e[n]),n+i+r}class lO{constructor(){}supports(i){return i instanceof Map||Av(i)}create(){return new $j}}class $j{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(i){let e;for(e=this._mapHead;null!==e;e=e._next)i(e)}forEachPreviousItem(i){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)i(e)}forEachChangedItem(i){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)i(e)}forEachAddedItem(i){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)i(e)}forEachRemovedItem(i){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)i(e)}diff(i){if(i){if(!(i instanceof Map||Av(i)))throw new Tn(900,"")}else i=new Map;return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(i,(n,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,n),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(r,n);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let n=e;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(i,e){if(i){const n=i._prev;return e._next=i,e._prev=n,i._prev=e,n&&(n._next=e),i===this._mapHead&&(this._mapHead=e),this._appendAfter=i,i}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(i,e){if(this._records.has(i)){const r=this._records.get(i);this._maybeAddToChanges(r,e);const o=r._prev,c=r._next;return o&&(o._next=c),c&&(c._prev=o),r._next=null,r._prev=null,r}const n=new Wj(i);return this._records.set(i,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let i;for(this._previousMapHead=this._mapHead,i=this._previousMapHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._changesHead;null!==i;i=i._nextChanged)i.previousValue=i.currentValue;for(i=this._additionsHead;null!=i;i=i._nextAdded)i.previousValue=i.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(i,e){Object.is(e,i.currentValue)||(i.previousValue=i.currentValue,i.currentValue=e,this._addToChanges(i))}_addToAdditions(i){null===this._additionsHead?this._additionsHead=this._additionsTail=i:(this._additionsTail._nextAdded=i,this._additionsTail=i)}_addToChanges(i){null===this._changesHead?this._changesHead=this._changesTail=i:(this._changesTail._nextChanged=i,this._changesTail=i)}_forEach(i,e){i instanceof Map?i.forEach(e):Object.keys(i).forEach(n=>e(i[n],n))}}class Wj{constructor(i){this.key=i,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function cO(){return new _y([new oO])}let _y=(()=>{class t{constructor(e){this.factories=e}static create(e,n){if(null!=n){const r=n.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>t.create(e,n||cO()),deps:[[t,new Uh,new nd]]}}find(e){const n=this.factories.find(r=>r.supports(e));if(null!=n)return n;throw new Tn(901,"")}}return t.\u0275prov=Vt({token:t,providedIn:"root",factory:cO}),t})();function uO(){return new vy([new lO])}let vy=(()=>{class t{constructor(e){this.factories=e}static create(e,n){if(n){const r=n.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>t.create(e,n||uO()),deps:[[t,new Uh,new nd]]}}find(e){const n=this.factories.find(o=>o.supports(e));if(n)return n;throw new Tn(901,"")}}return t.\u0275prov=Vt({token:t,providedIn:"root",factory:uO}),t})();const Kj=Y6(null,"core",[{provide:gy,useValue:"unknown"},{provide:Q6,deps:[ws]},{provide:q6,deps:[]},{provide:H6,deps:[]}]);let Yj=(()=>{class t{constructor(e){}}return t.\u0275fac=function(e){return new(e||t)(zt(y3))},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({}),t})(),w3=null;function fd(){return w3}const ra=new hi("DocumentToken");let ym=(()=>{class t{historyGo(e){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:function(){return function Zj(){return zt(dO)}()},providedIn:"platform"}),t})();const eV=new hi("Location Initialized");let dO=(()=>{class t extends ym{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return fd().getBaseHref(this._doc)}onPopState(e){const n=fd().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",e,!1),()=>n.removeEventListener("popstate",e)}onHashChange(e){const n=fd().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",e,!1),()=>n.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,n,r){fO()?this._history.pushState(e,n,r):this.location.hash=r}replaceState(e,n,r){fO()?this._history.replaceState(e,n,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(zt(ra))},t.\u0275prov=Vt({token:t,factory:function(){return function tV(){return new dO(zt(ra))}()},providedIn:"platform"}),t})();function fO(){return!!window.history.pushState}function YD(t,i){if(0==t.length)return i;if(0==i.length)return t;let e=0;return t.endsWith("/")&&e++,i.startsWith("/")&&e++,2==e?t+i.substring(1):1==e?t+i:t+"/"+i}function pO(t){const i=t.match(/#|\?|$/),e=i&&i.index||t.length;return t.slice(0,e-("/"===t[e-1]?1:0))+t.slice(e)}function ff(t){return t&&"?"!==t[0]?"?"+t:t}let T0=(()=>{class t{historyGo(e){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:function(){return function nV(t){const i=zt(ra).location;return new hO(zt(ym),i&&i.origin||"")}()},providedIn:"root"}),t})();const XD=new hi("appBaseHref");let hO=(()=>{class t extends T0{constructor(e,n){if(super(),this._platformLocation=e,this._removeListenerFns=[],null==n&&(n=this._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=n}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return YD(this._baseHref,e)}path(e=!1){const n=this._platformLocation.pathname+ff(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?`${n}${r}`:n}pushState(e,n,r,o){const c=this.prepareExternalUrl(r+ff(o));this._platformLocation.pushState(e,n,c)}replaceState(e,n,r,o){const c=this.prepareExternalUrl(r+ff(o));this._platformLocation.replaceState(e,n,c)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var n,r;null===(r=(n=this._platformLocation).historyGo)||void 0===r||r.call(n,e)}}return t.\u0275fac=function(e){return new(e||t)(zt(ym),zt(XD,8))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})(),iV=(()=>{class t extends T0{constructor(e,n){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(e){const n=YD(this._baseHref,e);return n.length>0?"#"+n:n}pushState(e,n,r,o){let c=this.prepareExternalUrl(r+ff(o));0==c.length&&(c=this._platformLocation.pathname),this._platformLocation.pushState(e,n,c)}replaceState(e,n,r,o){let c=this.prepareExternalUrl(r+ff(o));0==c.length&&(c=this._platformLocation.pathname),this._platformLocation.replaceState(e,n,c)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var n,r;null===(r=(n=this._platformLocation).historyGo)||void 0===r||r.call(n,e)}}return t.\u0275fac=function(e){return new(e||t)(zt(ym),zt(XD,8))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})(),QD=(()=>{class t{constructor(e,n){this._subject=new Et,this._urlChangeListeners=[],this._platformStrategy=e;const r=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=pO(mO(r)),this._platformStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}path(e=!1){return this.normalize(this._platformStrategy.path(e))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,n=""){return this.path()==this.normalize(e+ff(n))}normalize(e){return t.stripTrailingSlash(function oV(t,i){return t&&i.startsWith(t)?i.substring(t.length):i}(this._baseHref,mO(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}go(e,n="",r=null){this._platformStrategy.pushState(r,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+ff(n)),r)}replaceState(e,n="",r=null){this._platformStrategy.replaceState(r,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+ff(n)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(e=0){var n,r;null===(r=(n=this._platformStrategy).historyGo)||void 0===r||r.call(n,e)}onUrlChange(e){this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}))}_notifyUrlChangeListeners(e="",n){this._urlChangeListeners.forEach(r=>r(e,n))}subscribe(e,n,r){return this._subject.subscribe({next:e,error:n,complete:r})}}return t.normalizeQueryParams=ff,t.joinWithSlash=YD,t.stripTrailingSlash=pO,t.\u0275fac=function(e){return new(e||t)(zt(T0),zt(ym))},t.\u0275prov=Vt({token:t,factory:function(){return function rV(){return new QD(zt(T0),zt(ym))}()},providedIn:"root"}),t})();function mO(t){return t.replace(/\/index.html$/,"")}const gO={ADP:[void 0,void 0,0],AFN:[void 0,"\u060b",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058f",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20bc"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09f3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,"\u0440.",2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xa5","\xa5"],COP:[void 0,"$",2],CRC:[void 0,"\u20a1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010d",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xa3"],ESP:[void 0,"\u20a7",0],EUR:["\u20ac"],FJD:[void 0,"$"],FKP:[void 0,"\xa3"],GBP:["\xa3"],GEL:[void 0,"\u20be"],GHS:[void 0,"GH\u20b5"],GIP:[void 0,"\xa3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20aa"],INR:["\u20b9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xa5",void 0,0],KHR:[void 0,"\u17db"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20a9",0],KRW:["\u20a9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20b8"],LAK:[void 0,"\u20ad",0],LBP:[void 0,"L\xa3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20ae",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20a6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20b1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20b2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20bd"],RUR:[void 0,"\u0440."],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xa3"],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xa3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xa3",0],THB:[void 0,"\u0e3f"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20ba"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20b4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20ab",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XOF:["F\u202fCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xa4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]};var Ml=(()=>((Ml=Ml||{})[Ml.Decimal=0]="Decimal",Ml[Ml.Percent=1]="Percent",Ml[Ml.Currency=2]="Currency",Ml[Ml.Scientific=3]="Scientific",Ml))(),as=(()=>((as=as||{})[as.Format=0]="Format",as[as.Standalone=1]="Standalone",as))(),Zi=(()=>((Zi=Zi||{})[Zi.Narrow=0]="Narrow",Zi[Zi.Abbreviated=1]="Abbreviated",Zi[Zi.Wide=2]="Wide",Zi[Zi.Short=3]="Short",Zi))(),Lo=(()=>((Lo=Lo||{})[Lo.Short=0]="Short",Lo[Lo.Medium=1]="Medium",Lo[Lo.Long=2]="Long",Lo[Lo.Full=3]="Full",Lo))(),Xn=(()=>((Xn=Xn||{})[Xn.Decimal=0]="Decimal",Xn[Xn.Group=1]="Group",Xn[Xn.List=2]="List",Xn[Xn.PercentSign=3]="PercentSign",Xn[Xn.PlusSign=4]="PlusSign",Xn[Xn.MinusSign=5]="MinusSign",Xn[Xn.Exponential=6]="Exponential",Xn[Xn.SuperscriptingExponent=7]="SuperscriptingExponent",Xn[Xn.PerMille=8]="PerMille",Xn[Xn.Infinity=9]="Infinity",Xn[Xn.NaN=10]="NaN",Xn[Xn.TimeSeparator=11]="TimeSeparator",Xn[Xn.CurrencyDecimal=12]="CurrencyDecimal",Xn[Xn.CurrencyGroup=13]="CurrencyGroup",Xn))();function C3(t,i){return jc(Ts(t)[mn.DateFormat],i)}function T3(t,i){return jc(Ts(t)[mn.TimeFormat],i)}function S3(t,i){return jc(Ts(t)[mn.DateTimeFormat],i)}function Bc(t,i){const e=Ts(t),n=e[mn.NumberSymbols][i];if(void 0===n){if(i===Xn.CurrencyDecimal)return e[mn.NumberSymbols][Xn.Decimal];if(i===Xn.CurrencyGroup)return e[mn.NumberSymbols][Xn.Group]}return n}function _O(t){if(!t[mn.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[mn.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function jc(t,i){for(let e=i;e>-1;e--)if(void 0!==t[e])return t[e];throw new Error("Locale data API: locale data undefined")}function ZD(t){const[i,e]=t.split(":");return{hours:+i,minutes:+e}}const vV=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,yy={},yV=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Hs=(()=>((Hs=Hs||{})[Hs.Short=0]="Short",Hs[Hs.ShortGMT=1]="ShortGMT",Hs[Hs.Long=2]="Long",Hs[Hs.Extended=3]="Extended",Hs))(),ii=(()=>((ii=ii||{})[ii.FullYear=0]="FullYear",ii[ii.Month=1]="Month",ii[ii.Date=2]="Date",ii[ii.Hours=3]="Hours",ii[ii.Minutes=4]="Minutes",ii[ii.Seconds=5]="Seconds",ii[ii.FractionalSeconds=6]="FractionalSeconds",ii[ii.Day=7]="Day",ii))(),Ri=(()=>((Ri=Ri||{})[Ri.DayPeriods=0]="DayPeriods",Ri[Ri.Days=1]="Days",Ri[Ri.Months=2]="Months",Ri[Ri.Eras=3]="Eras",Ri))();function bV(t,i,e,n){let r=function IV(t){if(bO(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[r,o=1,c=1]=t.split("-").map(u=>+u);return E3(r,o-1,c)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let n;if(n=t.match(vV))return function AV(t){const i=new Date(0);let e=0,n=0;const r=t[8]?i.setUTCFullYear:i.setFullYear,o=t[8]?i.setUTCHours:i.setHours;t[9]&&(e=Number(t[9]+t[10]),n=Number(t[9]+t[11])),r.call(i,Number(t[1]),Number(t[2])-1,Number(t[3]));const c=Number(t[4]||0)-e,u=Number(t[5]||0)-n,m=Number(t[6]||0),g=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return o.call(i,c,u,m,g),i}(n)}const i=new Date(t);if(!bO(i))throw new Error(`Unable to convert "${t}" into a date`);return i}(t);i=pf(e,i)||i;let u,c=[];for(;i;){if(u=yV.exec(i),!u){c.push(i);break}{c=c.concat(u.slice(1));const x=c.pop();if(!x)break;i=x}}let m=r.getTimezoneOffset();n&&(m=yO(n,m),r=function DV(t,i,e){const n=e?-1:1,r=t.getTimezoneOffset();return function kV(t,i){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+i),t}(t,n*(yO(i,r)-r))}(r,n,!0));let g="";return c.forEach(x=>{const S=function EV(t){if(tI[t])return tI[t];let i;switch(t){case"G":case"GG":case"GGG":i=ho(Ri.Eras,Zi.Abbreviated);break;case"GGGG":i=ho(Ri.Eras,Zi.Wide);break;case"GGGGG":i=ho(Ri.Eras,Zi.Narrow);break;case"y":i=ks(ii.FullYear,1,0,!1,!0);break;case"yy":i=ks(ii.FullYear,2,0,!0,!0);break;case"yyy":i=ks(ii.FullYear,3,0,!1,!0);break;case"yyyy":i=ks(ii.FullYear,4,0,!1,!0);break;case"Y":i=A3(1);break;case"YY":i=A3(2,!0);break;case"YYY":i=A3(3);break;case"YYYY":i=A3(4);break;case"M":case"L":i=ks(ii.Month,1,1);break;case"MM":case"LL":i=ks(ii.Month,2,1);break;case"MMM":i=ho(Ri.Months,Zi.Abbreviated);break;case"MMMM":i=ho(Ri.Months,Zi.Wide);break;case"MMMMM":i=ho(Ri.Months,Zi.Narrow);break;case"LLL":i=ho(Ri.Months,Zi.Abbreviated,as.Standalone);break;case"LLLL":i=ho(Ri.Months,Zi.Wide,as.Standalone);break;case"LLLLL":i=ho(Ri.Months,Zi.Narrow,as.Standalone);break;case"w":i=eI(1);break;case"ww":i=eI(2);break;case"W":i=eI(1,!0);break;case"d":i=ks(ii.Date,1);break;case"dd":i=ks(ii.Date,2);break;case"c":case"cc":i=ks(ii.Day,1);break;case"ccc":i=ho(Ri.Days,Zi.Abbreviated,as.Standalone);break;case"cccc":i=ho(Ri.Days,Zi.Wide,as.Standalone);break;case"ccccc":i=ho(Ri.Days,Zi.Narrow,as.Standalone);break;case"cccccc":i=ho(Ri.Days,Zi.Short,as.Standalone);break;case"E":case"EE":case"EEE":i=ho(Ri.Days,Zi.Abbreviated);break;case"EEEE":i=ho(Ri.Days,Zi.Wide);break;case"EEEEE":i=ho(Ri.Days,Zi.Narrow);break;case"EEEEEE":i=ho(Ri.Days,Zi.Short);break;case"a":case"aa":case"aaa":i=ho(Ri.DayPeriods,Zi.Abbreviated);break;case"aaaa":i=ho(Ri.DayPeriods,Zi.Wide);break;case"aaaaa":i=ho(Ri.DayPeriods,Zi.Narrow);break;case"b":case"bb":case"bbb":i=ho(Ri.DayPeriods,Zi.Abbreviated,as.Standalone,!0);break;case"bbbb":i=ho(Ri.DayPeriods,Zi.Wide,as.Standalone,!0);break;case"bbbbb":i=ho(Ri.DayPeriods,Zi.Narrow,as.Standalone,!0);break;case"B":case"BB":case"BBB":i=ho(Ri.DayPeriods,Zi.Abbreviated,as.Format,!0);break;case"BBBB":i=ho(Ri.DayPeriods,Zi.Wide,as.Format,!0);break;case"BBBBB":i=ho(Ri.DayPeriods,Zi.Narrow,as.Format,!0);break;case"h":i=ks(ii.Hours,1,-12);break;case"hh":i=ks(ii.Hours,2,-12);break;case"H":i=ks(ii.Hours,1);break;case"HH":i=ks(ii.Hours,2);break;case"m":i=ks(ii.Minutes,1);break;case"mm":i=ks(ii.Minutes,2);break;case"s":i=ks(ii.Seconds,1);break;case"ss":i=ks(ii.Seconds,2);break;case"S":i=ks(ii.FractionalSeconds,1);break;case"SS":i=ks(ii.FractionalSeconds,2);break;case"SSS":i=ks(ii.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":i=D3(Hs.Short);break;case"ZZZZZ":i=D3(Hs.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":i=D3(Hs.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":i=D3(Hs.Long);break;default:return null}return tI[t]=i,i}(x);g+=S?S(r,e,m):"''"===x?"'":x.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),g}function E3(t,i,e){const n=new Date(0);return n.setFullYear(t,i,e),n.setHours(0,0,0),n}function pf(t,i){const e=function sV(t){return Ts(t)[mn.LocaleId]}(t);if(yy[e]=yy[e]||{},yy[e][i])return yy[e][i];let n="";switch(i){case"shortDate":n=C3(t,Lo.Short);break;case"mediumDate":n=C3(t,Lo.Medium);break;case"longDate":n=C3(t,Lo.Long);break;case"fullDate":n=C3(t,Lo.Full);break;case"shortTime":n=T3(t,Lo.Short);break;case"mediumTime":n=T3(t,Lo.Medium);break;case"longTime":n=T3(t,Lo.Long);break;case"fullTime":n=T3(t,Lo.Full);break;case"short":const r=pf(t,"shortTime"),o=pf(t,"shortDate");n=k3(S3(t,Lo.Short),[r,o]);break;case"medium":const c=pf(t,"mediumTime"),u=pf(t,"mediumDate");n=k3(S3(t,Lo.Medium),[c,u]);break;case"long":const m=pf(t,"longTime"),g=pf(t,"longDate");n=k3(S3(t,Lo.Long),[m,g]);break;case"full":const x=pf(t,"fullTime"),S=pf(t,"fullDate");n=k3(S3(t,Lo.Full),[x,S])}return n&&(yy[e][i]=n),n}function k3(t,i){return i&&(t=t.replace(/\{([^}]+)}/g,function(e,n){return null!=i&&n in i?i[n]:e})),t}function wu(t,i,e="-",n,r){let o="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,o=e));let c=String(t);for(;c.length<i;)c="0"+c;return n&&(c=c.substr(c.length-i)),o+c}function ks(t,i,e=0,n=!1,r=!1){return function(o,c){let u=function wV(t,i){switch(t){case ii.FullYear:return i.getFullYear();case ii.Month:return i.getMonth();case ii.Date:return i.getDate();case ii.Hours:return i.getHours();case ii.Minutes:return i.getMinutes();case ii.Seconds:return i.getSeconds();case ii.FractionalSeconds:return i.getMilliseconds();case ii.Day:return i.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,o);if((e>0||u>-e)&&(u+=e),t===ii.Hours)0===u&&-12===e&&(u=12);else if(t===ii.FractionalSeconds)return function xV(t,i){return wu(t,3).substr(0,i)}(u,i);const m=Bc(c,Xn.MinusSign);return wu(u,i,m,n,r)}}function ho(t,i,e=as.Format,n=!1){return function(r,o){return function CV(t,i,e,n,r,o){switch(e){case Ri.Months:return function cV(t,i,e){const n=Ts(t),o=jc([n[mn.MonthsFormat],n[mn.MonthsStandalone]],i);return jc(o,e)}(i,r,n)[t.getMonth()];case Ri.Days:return function lV(t,i,e){const n=Ts(t),o=jc([n[mn.DaysFormat],n[mn.DaysStandalone]],i);return jc(o,e)}(i,r,n)[t.getDay()];case Ri.DayPeriods:const c=t.getHours(),u=t.getMinutes();if(o){const g=function pV(t){const i=Ts(t);return _O(i),(i[mn.ExtraData][2]||[]).map(n=>"string"==typeof n?ZD(n):[ZD(n[0]),ZD(n[1])])}(i),x=function hV(t,i,e){const n=Ts(t);_O(n);const o=jc([n[mn.ExtraData][0],n[mn.ExtraData][1]],i)||[];return jc(o,e)||[]}(i,r,n),S=g.findIndex(M=>{if(Array.isArray(M)){const[E,R]=M,B=c>=E.hours&&u>=E.minutes,K=c<R.hours||c===R.hours&&u<R.minutes;if(E.hours<R.hours){if(B&&K)return!0}else if(B||K)return!0}else if(M.hours===c&&M.minutes===u)return!0;return!1});if(-1!==S)return x[S]}return function aV(t,i,e){const n=Ts(t),o=jc([n[mn.DayPeriodsFormat],n[mn.DayPeriodsStandalone]],i);return jc(o,e)}(i,r,n)[c<12?0:1];case Ri.Eras:return function uV(t,i){return jc(Ts(t)[mn.Eras],i)}(i,n)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,o,t,i,e,n)}}function D3(t){return function(i,e,n){const r=-1*n,o=Bc(e,Xn.MinusSign),c=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case Hs.Short:return(r>=0?"+":"")+wu(c,2,o)+wu(Math.abs(r%60),2,o);case Hs.ShortGMT:return"GMT"+(r>=0?"+":"")+wu(c,1,o);case Hs.Long:return"GMT"+(r>=0?"+":"")+wu(c,2,o)+":"+wu(Math.abs(r%60),2,o);case Hs.Extended:return 0===n?"Z":(r>=0?"+":"")+wu(c,2,o)+":"+wu(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${t}"`)}}}function vO(t){return E3(t.getFullYear(),t.getMonth(),t.getDate()+(4-t.getDay()))}function eI(t,i=!1){return function(e,n){let r;if(i){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,c=e.getDate();r=1+Math.floor((c+o)/7)}else{const o=vO(e),c=function SV(t){const i=E3(t,0,1).getDay();return E3(t,0,1+(i<=4?4:11)-i)}(o.getFullYear()),u=o.getTime()-c.getTime();r=1+Math.round(u/6048e5)}return wu(r,t,Bc(n,Xn.MinusSign))}}function A3(t,i=!1){return function(e,n){return wu(vO(e).getFullYear(),t,Bc(n,Xn.MinusSign),i)}}const tI={};function yO(t,i){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?i:e}function bO(t){return t instanceof Date&&!isNaN(t.valueOf())}const MV=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function NV(t,i,e,n,r){const c=function rI(t,i="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},n=t.split(";"),r=n[0],o=n[1],c=-1!==r.indexOf(".")?r.split("."):[r.substring(0,r.lastIndexOf("0")+1),r.substring(r.lastIndexOf("0")+1)],u=c[0],m=c[1]||"";e.posPre=u.substr(0,u.indexOf("#"));for(let x=0;x<m.length;x++){const S=m.charAt(x);"0"===S?e.minFrac=e.maxFrac=x+1:"#"===S?e.maxFrac=x+1:e.posSuf+=S}const g=u.split(",");if(e.gSize=g[1]?g[1].length:0,e.lgSize=g[2]||g[1]?(g[2]||g[1]).length:0,o){const x=r.length-e.posPre.length-e.posSuf.length,S=o.indexOf("#");e.negPre=o.substr(0,S).replace(/'/g,""),e.negSuf=o.substr(S+x).replace(/'/g,"")}else e.negPre=i+e.posPre,e.negSuf=e.posSuf;return e}(function JD(t,i){return Ts(t)[mn.NumberFormats][i]}(i,Ml.Currency),Bc(i,Xn.MinusSign));return c.minFrac=function _V(t){let i;const e=gO[t];return e&&(i=e[2]),"number"==typeof i?i:2}(n),c.maxFrac=c.minFrac,function iI(t,i,e,n,r,o,c=!1){let u="",m=!1;if(isFinite(t)){let g=function jV(t){let n,r,o,c,u,i=Math.abs(t)+"",e=0;for((r=i.indexOf("."))>-1&&(i=i.replace(".","")),(o=i.search(/e/i))>0?(r<0&&(r=o),r+=+i.slice(o+1),i=i.substring(0,o)):r<0&&(r=i.length),o=0;"0"===i.charAt(o);o++);if(o===(u=i.length))n=[0],r=1;else{for(u--;"0"===i.charAt(u);)u--;for(r-=o,n=[],c=0;o<=u;o++,c++)n[c]=Number(i.charAt(o))}return r>22&&(n=n.splice(0,21),e=r-1,r=1),{digits:n,exponent:e,integerLen:r}}(t);c&&(g=function BV(t){if(0===t.digits[0])return t;const i=t.digits.length-t.integerLen;return t.exponent?t.exponent+=2:(0===i?t.digits.push(0,0):1===i&&t.digits.push(0),t.integerLen+=2),t}(g));let x=i.minInt,S=i.minFrac,M=i.maxFrac;if(o){const Y=o.match(MV);if(null===Y)throw new Error(`${o} is not a valid digit info`);const ce=Y[1],De=Y[3],Ye=Y[5];null!=ce&&(x=oI(ce)),null!=De&&(S=oI(De)),null!=Ye?M=oI(Ye):null!=De&&S>M&&(M=S)}!function VV(t,i,e){if(i>e)throw new Error(`The minimum number of digits after fraction (${i}) is higher than the maximum (${e}).`);let n=t.digits,r=n.length-t.integerLen;const o=Math.min(Math.max(i,r),e);let c=o+t.integerLen,u=n[c];if(c>0){n.splice(Math.max(t.integerLen,c));for(let S=c;S<n.length;S++)n[S]=0}else{r=Math.max(0,r),t.integerLen=1,n.length=Math.max(1,c=o+1),n[0]=0;for(let S=1;S<c;S++)n[S]=0}if(u>=5)if(c-1<0){for(let S=0;S>c;S--)n.unshift(0),t.integerLen++;n.unshift(1),t.integerLen++}else n[c-1]++;for(;r<Math.max(0,o);r++)n.push(0);let m=0!==o;const g=i+t.integerLen,x=n.reduceRight(function(S,M,E,R){return R[E]=(M+=S)<10?M:M-10,m&&(0===R[E]&&E>=g?R.pop():m=!1),M>=10?1:0},0);x&&(n.unshift(x),t.integerLen++)}(g,S,M);let E=g.digits,R=g.integerLen;const B=g.exponent;let K=[];for(m=E.every(Y=>!Y);R<x;R++)E.unshift(0);for(;R<0;R++)E.unshift(0);R>0?K=E.splice(R,E.length):(K=E,E=[0]);const q=[];for(E.length>=i.lgSize&&q.unshift(E.splice(-i.lgSize,E.length).join(""));E.length>i.gSize;)q.unshift(E.splice(-i.gSize,E.length).join(""));E.length&&q.unshift(E.join("")),u=q.join(Bc(e,n)),K.length&&(u+=Bc(e,r)+K.join("")),B&&(u+=Bc(e,Xn.Exponential)+"+"+B)}else u=Bc(e,Xn.Infinity);return u=t<0&&!m?i.negPre+u+i.negSuf:i.posPre+u+i.posSuf,u}(t,c,i,Xn.CurrencyGroup,Xn.CurrencyDecimal,r).replace("\xa4",e).replace("\xa4","").trim()}function oI(t){const i=parseInt(t);if(isNaN(i))throw new Error("Invalid integer literal when parsing "+t);return i}function TO(t,i){i=encodeURIComponent(i);for(const e of t.split(";")){const n=e.indexOf("="),[r,o]=-1==n?[e,""]:[e.slice(0,n),e.slice(n+1)];if(r.trim()===i)return decodeURIComponent(o)}return null}let Na=(()=>{class t{constructor(e,n,r,o){this._iterableDiffers=e,this._keyValueDiffers=n,this._ngEl=r,this._renderer=o,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(c0(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(n=>this._toggleClass(n.key,n.currentValue)),e.forEachChangedItem(n=>this._toggleClass(n.key,n.currentValue)),e.forEachRemovedItem(n=>{n.previousValue&&this._toggleClass(n.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(n=>{if("string"!=typeof n.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Bn(n.item)}`);this._toggleClass(n.item,!0)}),e.forEachRemovedItem(n=>this._toggleClass(n.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(n=>this._toggleClass(n,!0)):Object.keys(e).forEach(n=>this._toggleClass(n,!!e[n])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(n=>this._toggleClass(n,!1)):Object.keys(e).forEach(n=>this._toggleClass(n,!1)))}_toggleClass(e,n){(e=e.trim())&&e.split(/\s+/g).forEach(r=>{n?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return t.\u0275fac=function(e){return new(e||t)(te(_y),te(vy),te(mr),te(Ss))},t.\u0275dir=Ln({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class zV{constructor(i,e,n,r){this.$implicit=i,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let nc=(()=>{class t{constructor(e,n,r){this._viewContainer=e,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const n=this._viewContainer;e.forEachOperation((r,o,c)=>{if(null==r.previousIndex)n.createEmbeddedView(this._template,new zV(r.item,this._ngForOf,-1,-1),null===c?void 0:c);else if(null==c)n.remove(null===o?void 0:o);else if(null!==o){const u=n.get(o);n.move(u,c),SO(u,r)}});for(let r=0,o=n.length;r<o;r++){const u=n.get(r).context;u.index=r,u.count=o,u.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{SO(n.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,n){return!0}}return t.\u0275fac=function(e){return new(e||t)(te(Al),te(Rc),te(_y))},t.\u0275dir=Ln({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();function SO(t,i){t.context.$implicit=i.item}let Sn=(()=>{class t{constructor(e,n){this._viewContainer=e,this._context=new $V,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){EO("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){EO("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,n){return!0}}return t.\u0275fac=function(e){return new(e||t)(te(Al),te(Rc))},t.\u0275dir=Ln({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class $V{constructor(){this.$implicit=null,this.ngIf=null}}function EO(t,i){if(i&&!i.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Bn(i)}'.`)}let La=(()=>{class t{constructor(e,n,r){this._ngEl=e,this._differs=n,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,n){const[r,o]=e.split(".");null!=(n=null!=n&&o?`${n}${o}`:n)?this._renderer.setStyle(this._ngEl.nativeElement,r,n):this._renderer.removeStyle(this._ngEl.nativeElement,r)}_applyChanges(e){e.forEachRemovedItem(n=>this._setStyle(n.key,null)),e.forEachAddedItem(n=>this._setStyle(n.key,n.currentValue)),e.forEachChangedItem(n=>this._setStyle(n.key,n.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(vy),te(Ss))},t.\u0275dir=Ln({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),t})(),ic=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(e){if(e.ngTemplateOutlet){const n=this._viewContainerRef;this._viewRef&&n.remove(n.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?n.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return t.\u0275fac=function(e){return new(e||t)(te(Al))},t.\u0275dir=Ln({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[Vs]}),t})();function Cu(t,i){return new Tn(2100,"")}const iU=new hi("DATE_PIPE_DEFAULT_TIMEZONE");let al=(()=>{class t{constructor(e,n){this.locale=e,this.defaultTimezone=n}transform(e,n="mediumDate",r,o){var c;if(null==e||""===e||e!=e)return null;try{return bV(e,n,o||this.locale,null!==(c=null!=r?r:this.defaultTimezone)&&void 0!==c?c:void 0)}catch(u){throw Cu()}}}return t.\u0275fac=function(e){return new(e||t)(te(Ip,16),te(iU,24))},t.\u0275pipe=Qs({name:"date",type:t,pure:!0}),t})(),dr=(()=>{class t{constructor(e,n="USD"){this._locale=e,this._defaultCurrencyCode=n}transform(e,n=this._defaultCurrencyCode,r="symbol",o,c){if(!function cI(t){return!(null==t||""===t||t!=t)}(e))return null;c=c||this._locale,"boolean"==typeof r&&(r=r?"symbol":"code");let u=n||this._defaultCurrencyCode;"code"!==r&&(u="symbol"===r||"symbol-narrow"===r?function mV(t,i,e="en"){const n=function dV(t){return Ts(t)[mn.Currencies]}(e)[t]||gO[t]||[],r=n[1];return"narrow"===i&&"string"==typeof r?r:n[0]||t}(u,"symbol"===r?"wide":"narrow",c):r);try{return NV(function uI(t){if("string"==typeof t&&!isNaN(Number(t)-parseFloat(t)))return Number(t);if("number"!=typeof t)throw new Error(`${t} is not a number`);return t}(e),c,u,n,o)}catch(m){throw Cu()}}}return t.\u0275fac=function(e){return new(e||t)(te(Ip,16),te(mj,16))},t.\u0275pipe=Qs({name:"currency",type:t,pure:!0}),t})();let Ro=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({}),t})();const IO="browser";let _U=(()=>{class t{}return t.\u0275prov=Vt({token:t,providedIn:"root",factory:()=>new vU(zt(ra),window)}),t})();class vU{constructor(i,e){this.document=i,this.window=e,this.offset=()=>[0,0]}setOffset(i){this.offset=Array.isArray(i)?()=>i:i}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(i){this.supportsScrolling()&&this.window.scrollTo(i[0],i[1])}scrollToAnchor(i){if(!this.supportsScrolling())return;const e=function yU(t,i){const e=t.getElementById(i)||t.getElementsByName(i)[0];if(e)return e;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const n=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const o=r.shadowRoot;if(o){const c=o.getElementById(i)||o.querySelector(`[name="${i}"]`);if(c)return c}r=n.nextNode()}}return null}(this.document,i);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(i){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=i)}}scrollToElement(i){const e=i.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(n-o[0],r-o[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const i=AO(this.window.history)||AO(Object.getPrototypeOf(this.window.history));return!(!i||!i.writable&&!i.set)}catch(i){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(i){return!1}}}function AO(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class MO{}class dI extends class bU extends class Jj{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function Qj(t){w3||(w3=t)}(new dI)}onAndCancel(i,e,n){return i.addEventListener(e,n,!1),()=>{i.removeEventListener(e,n,!1)}}dispatchEvent(i,e){i.dispatchEvent(e)}remove(i){i.parentNode&&i.parentNode.removeChild(i)}createElement(i,e){return(e=e||this.getDefaultDocument()).createElement(i)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(i){return i.nodeType===Node.ELEMENT_NODE}isShadowRoot(i){return i instanceof DocumentFragment}getGlobalEventTarget(i,e){return"window"===e?window:"document"===e?i:"body"===e?i.body:null}getBaseHref(i){const e=function xU(){return xy=xy||document.querySelector("base"),xy?xy.getAttribute("href"):null}();return null==e?null:function wU(t){F3=F3||document.createElement("a"),F3.setAttribute("href",t);const i=F3.pathname;return"/"===i.charAt(0)?i:`/${i}`}(e)}resetBaseElement(){xy=null}getUserAgent(){return window.navigator.userAgent}getCookie(i){return TO(document.cookie,i)}}let F3,xy=null;const FO=new hi("TRANSITION_ID"),TU=[{provide:LD,useFactory:function CU(t,i,e){return()=>{e.get(RD).donePromise.then(()=>{const n=fd(),r=i.querySelectorAll(`style[ng-transition="${t}"]`);for(let o=0;o<r.length;o++)n.remove(r[o])})}},deps:[FO,ra,ws],multi:!0}];class fI{static init(){!function Sj(t){zD=t}(new fI)}addToWindow(i){cr.getAngularTestability=(n,r=!0)=>{const o=i.findTestabilityInTree(n,r);if(null==o)throw new Error("Could not find testability for element.");return o},cr.getAllAngularTestabilities=()=>i.getAllTestabilities(),cr.getAllAngularRootElements=()=>i.getAllRootElements(),cr.frameworkStabilizers||(cr.frameworkStabilizers=[]),cr.frameworkStabilizers.push(n=>{const r=cr.getAllAngularTestabilities();let o=r.length,c=!1;const u=function(m){c=c||m,o--,0==o&&n(c)};r.forEach(function(m){m.whenStable(u)})})}findTestabilityInTree(i,e,n){if(null==e)return null;const r=i.getTestability(e);return null!=r?r:n?fd().isShadowRoot(e)?this.findTestabilityInTree(i,e.host,!0):this.findTestabilityInTree(i,e.parentElement,!0):null}}let SU=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();const P3=new hi("EventManagerPlugins");let O3=(()=>{class t{constructor(e,n){this._zone=n,this._eventNameToPlugin=new Map,e.forEach(r=>r.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,n,r){return this._findPluginFor(n).addEventListener(e,n,r)}addGlobalEventListener(e,n,r){return this._findPluginFor(n).addGlobalEventListener(e,n,r)}getZone(){return this._zone}_findPluginFor(e){const n=this._eventNameToPlugin.get(e);if(n)return n;const r=this._plugins;for(let o=0;o<r.length;o++){const c=r[o];if(c.supports(e))return this._eventNameToPlugin.set(e,c),c}throw new Error(`No event manager plugin found for event ${e}`)}}return t.\u0275fac=function(e){return new(e||t)(zt(P3),zt(gr))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();class PO{constructor(i){this._doc=i}addGlobalEventListener(i,e,n){const r=fd().getGlobalEventTarget(this._doc,i);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,n)}}let OO=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(e){const n=new Set;e.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),n.add(r))}),this.onStylesAdded(n)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})(),wy=(()=>{class t extends OO{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,n,r){e.forEach(o=>{const c=this._doc.createElement("style");c.textContent=o,r.push(n.appendChild(c))})}addHost(e){const n=[];this._addStylesToHost(this._stylesSet,e,n),this._hostNodes.set(e,n)}removeHost(e){const n=this._hostNodes.get(e);n&&n.forEach(NO),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((n,r)=>{this._addStylesToHost(e,r,n)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(NO))}}return t.\u0275fac=function(e){return new(e||t)(zt(ra))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();function NO(t){fd().remove(t)}const pI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},hI=/%COMP%/g;function N3(t,i,e){for(let n=0;n<i.length;n++){let r=i[n];Array.isArray(r)?N3(t,r,e):(r=r.replace(hI,t),e.push(r))}return e}function BO(t){return i=>{if("__ngUnwrap__"===i)return t;!1===t(i)&&(i.preventDefault(),i.returnValue=!1)}}let L3=(()=>{class t{constructor(e,n,r){this.eventManager=e,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new mI(e)}createRenderer(e,n){if(!e||!n)return this.defaultRenderer;switch(n.encapsulation){case ya.Emulated:{let r=this.rendererByCompId.get(n.id);return r||(r=new MU(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,r)),r.applyToHost(e),r}case 1:case ya.ShadowDom:return new FU(this.eventManager,this.sharedStylesHost,e,n);default:if(!this.rendererByCompId.has(n.id)){const r=N3(n.id,n.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(zt(O3),zt(wy),zt(my))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();class mI{constructor(i){this.eventManager=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(i,e){return e?document.createElementNS(pI[e]||e,i):document.createElement(i)}createComment(i){return document.createComment(i)}createText(i){return document.createTextNode(i)}appendChild(i,e){i.appendChild(e)}insertBefore(i,e,n){i&&i.insertBefore(e,n)}removeChild(i,e){i&&i.removeChild(e)}selectRootElement(i,e){let n="string"==typeof i?document.querySelector(i):i;if(!n)throw new Error(`The selector "${i}" did not match any elements`);return e||(n.textContent=""),n}parentNode(i){return i.parentNode}nextSibling(i){return i.nextSibling}setAttribute(i,e,n,r){if(r){e=r+":"+e;const o=pI[r];o?i.setAttributeNS(o,e,n):i.setAttribute(e,n)}else i.setAttribute(e,n)}removeAttribute(i,e,n){if(n){const r=pI[n];r?i.removeAttributeNS(r,e):i.removeAttribute(`${n}:${e}`)}else i.removeAttribute(e)}addClass(i,e){i.classList.add(e)}removeClass(i,e){i.classList.remove(e)}setStyle(i,e,n,r){r&(Ja.DashCase|Ja.Important)?i.style.setProperty(e,n,r&Ja.Important?"important":""):i.style[e]=n}removeStyle(i,e,n){n&Ja.DashCase?i.style.removeProperty(e):i.style[e]=""}setProperty(i,e,n){i[e]=n}setValue(i,e){i.nodeValue=e}listen(i,e,n){return"string"==typeof i?this.eventManager.addGlobalEventListener(i,e,BO(n)):this.eventManager.addEventListener(i,e,BO(n))}}class MU extends mI{constructor(i,e,n,r){super(i),this.component=n;const o=N3(r+"-"+n.id,n.styles,[]);e.addStyles(o),this.contentAttr=function DU(t){return"_ngcontent-%COMP%".replace(hI,t)}(r+"-"+n.id),this.hostAttr=function IU(t){return"_nghost-%COMP%".replace(hI,t)}(r+"-"+n.id)}applyToHost(i){super.setAttribute(i,this.hostAttr,"")}createElement(i,e){const n=super.createElement(i,e);return super.setAttribute(n,this.contentAttr,""),n}}class FU extends mI{constructor(i,e,n,r){super(i),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=N3(r.id,r.styles,[]);for(let c=0;c<o.length;c++){const u=document.createElement("style");u.textContent=o[c],this.shadowRoot.appendChild(u)}}nodeOrShadowRoot(i){return i===this.hostEl?this.shadowRoot:i}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(i,e){return super.appendChild(this.nodeOrShadowRoot(i),e)}insertBefore(i,e,n){return super.insertBefore(this.nodeOrShadowRoot(i),e,n)}removeChild(i,e){return super.removeChild(this.nodeOrShadowRoot(i),e)}parentNode(i){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(i)))}}let PU=(()=>{class t extends PO{constructor(e){super(e)}supports(e){return!0}addEventListener(e,n,r){return e.addEventListener(n,r,!1),()=>this.removeEventListener(e,n,r)}removeEventListener(e,n,r){return e.removeEventListener(n,r)}}return t.\u0275fac=function(e){return new(e||t)(zt(ra))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();const VO=["alt","control","meta","shift"],NU={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},UO={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},LU={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let RU=(()=>{class t extends PO{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,r){const o=t.parseEventName(n),c=t.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>fd().onAndCancel(e,o.domEventName,c))}static parseEventName(e){const n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const o=t._normalizeKey(n.pop());let c="";if(VO.forEach(m=>{const g=n.indexOf(m);g>-1&&(n.splice(g,1),c+=m+".")}),c+=o,0!=n.length||0===o.length)return null;const u={};return u.domEventName=r,u.fullKey=c,u}static getEventFullKey(e){let n="",r=function BU(t){let i=t.key;if(null==i){if(i=t.keyIdentifier,null==i)return"Unidentified";i.startsWith("U+")&&(i=String.fromCharCode(parseInt(i.substring(2),16)),3===t.location&&UO.hasOwnProperty(i)&&(i=UO[i]))}return NU[i]||i}(e);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),VO.forEach(o=>{o!=r&&LU[o](e)&&(n+=o+".")}),n+=r,n}static eventCallback(e,n,r){return o=>{t.getEventFullKey(o)===e&&r.runGuarded(()=>n(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return t.\u0275fac=function(e){return new(e||t)(zt(ra))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();const HU=Y6(Kj,"browser",[{provide:gy,useValue:IO},{provide:V6,useValue:function jU(){dI.makeCurrent(),fI.init()},multi:!0},{provide:ra,useFactory:function UU(){return function G5(t){mg=t}(document),document},deps:[]}]),zU=[{provide:Tv,useValue:"root"},{provide:em,useFactory:function VU(){return new em},deps:[]},{provide:P3,useClass:PU,multi:!0,deps:[ra,gr,gy]},{provide:P3,useClass:RU,multi:!0,deps:[ra]},{provide:L3,useClass:L3,deps:[O3,wy,my]},{provide:_m,useExisting:L3},{provide:OO,useExisting:wy},{provide:wy,useClass:wy,deps:[ra]},{provide:HD,useClass:HD,deps:[gr]},{provide:O3,useClass:O3,deps:[P3,gr]},{provide:MO,useClass:SU,deps:[]}];let R3=(()=>{class t{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:my,useValue:e.appId},{provide:FO,useExisting:my},TU]}}}return t.\u0275fac=function(e){return new(e||t)(zt(t,12))},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({providers:zU,imports:[Ro,Yj]}),t})();function _i(...t){return Ls(t,Gr(t))}"undefined"!=typeof window&&window;class Tu extends Wi{constructor(i){super(),this._value=i}get value(){return this.getValue()}_subscribe(i){const e=super._subscribe(i);return!e.closed&&i.next(this._value),e}getValue(){const{hasError:i,thrownError:e,_value:n}=this;if(i)throw e;return this._throwIfClosed(),n}next(i){super.next(this._value=i)}}const{isArray:eH}=Array,{getPrototypeOf:tH,prototype:nH,keys:iH}=Object;function $O(t){if(1===t.length){const i=t[0];if(eH(i))return{args:i,keys:null};if(function rH(t){return t&&"object"==typeof t&&tH(t)===nH}(i)){const e=iH(i);return{args:e.map(n=>i[n]),keys:e}}}return{args:t,keys:null}}const{isArray:oH}=Array;function _I(t){return or(i=>function sH(t,i){return oH(i)?t(...i):t(i)}(t,i))}function WO(t,i){return t.reduce((e,n,r)=>(e[n]=i[r],e),{})}function qO(t,i,e){t?_c(e,t,i):i()}function B3(t,i){const e=fi(t)?t:()=>t,n=r=>r.error(e());return new Lr(i?r=>i.schedule(n,0,r):n)}const j3=Do(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function vI(...t){return function cH(){return bh(1)}()(Ls(t,Gr(t)))}function GO(t){return new Lr(i=>{_a(t()).subscribe(i)})}function KO(){return Mo((t,i)=>{let e=null;t._refCount++;const n=co(i,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(e=null);const r=t._connection,o=e;e=null,r&&(!o||r===o)&&r.unsubscribe(),i.unsubscribe()});t.subscribe(n),n.closed||(e=t.connect())})}class uH extends Lr{constructor(i,e){super(),this.source=i,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,Bb(i)&&(this.lift=i.lift)}_subscribe(i){return this.getSubject().subscribe(i)}getSubject(){const i=this._subject;return(!i||i.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:i}=this;this._subject=this._connection=null,null==i||i.unsubscribe()}connect(){let i=this._connection;if(!i){i=this._connection=new lo;const e=this.getSubject();i.add(this.source.subscribe(co(e,void 0,()=>{this._teardown(),e.complete()},n=>{this._teardown(),e.error(n)},()=>this._teardown()))),i.closed&&(this._connection=null,i=lo.EMPTY)}return i}refCount(){return KO()(this)}}function Mp(t,i){return Mo((e,n)=>{let r=null,o=0,c=!1;const u=()=>c&&!r&&n.complete();e.subscribe(co(n,m=>{null==r||r.unsubscribe();let g=0;const x=o++;_a(t(m,x)).subscribe(r=co(n,S=>n.next(i?i(m,S,x,g++):S),()=>{r=null,u()}))},()=>{c=!0,u()}))})}function yI(t){return t<=0?()=>In:Mo((i,e)=>{let n=0;i.subscribe(co(e,r=>{++n<=t&&(e.next(r),t<=n&&e.complete())}))})}function bI(...t){const i=Gr(t);return Mo((e,n)=>{(i?vI(t,e,i):vI(t,e)).subscribe(n)})}function dH(t,i,e,n,r){return(o,c)=>{let u=e,m=i,g=0;o.subscribe(co(c,x=>{const S=g++;m=u?t(m,x,S):(u=!0,x),n&&c.next(m)},r&&(()=>{u&&c.next(m),c.complete()})))}}function YO(t,i){return Mo(dH(t,i,arguments.length>=2,!0))}function Fp(t,i){return Mo((e,n)=>{let r=0;e.subscribe(co(n,o=>t.call(i,o,r++)&&n.next(o)))})}function Pp(t){return Mo((i,e)=>{let o,n=null,r=!1;n=i.subscribe(co(e,void 0,void 0,c=>{o=_a(t(c,Pp(t)(i))),n?(n.unsubscribe(),n=null,o.subscribe(e)):r=!0})),r&&(n.unsubscribe(),n=null,o.subscribe(e))})}function S0(t,i){return fi(i)?ts(t,i,1):ts(t,1)}function xI(t){return t<=0?()=>In:Mo((i,e)=>{let n=[];i.subscribe(co(e,r=>{n.push(r),t<n.length&&n.shift()},()=>{for(const r of n)e.next(r);e.complete()},void 0,()=>{n=null}))})}function XO(t=fH){return Mo((i,e)=>{let n=!1;i.subscribe(co(e,r=>{n=!0,e.next(r)},()=>n?e.complete():e.error(t())))})}function fH(){return new j3}function QO(t){return Mo((i,e)=>{let n=!1;i.subscribe(co(e,r=>{n=!0,e.next(r)},()=>{n||e.next(t),e.complete()}))})}function E0(t,i){const e=arguments.length>=2;return n=>n.pipe(t?Fp((r,o)=>t(r,o,n)):qu,yI(1),e?QO(i):XO(()=>new j3))}function rc(t,i,e){const n=fi(t)||i||e?{next:t,error:i,complete:e}:t;return n?Mo((r,o)=>{var c;null===(c=n.subscribe)||void 0===c||c.call(n);let u=!0;r.subscribe(co(o,m=>{var g;null===(g=n.next)||void 0===g||g.call(n,m),o.next(m)},()=>{var m;u=!1,null===(m=n.complete)||void 0===m||m.call(n),o.complete()},m=>{var g;u=!1,null===(g=n.error)||void 0===g||g.call(n,m),o.error(m)},()=>{var m,g;u&&(null===(m=n.unsubscribe)||void 0===m||m.call(n)),null===(g=n.finalize)||void 0===g||g.call(n)}))}):qu}class hf{constructor(i,e){this.id=i,this.url=e}}class wI extends hf{constructor(i,e,n="imperative",r=null){super(i,e),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class k0 extends hf{constructor(i,e,n){super(i,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class JO extends hf{constructor(i,e,n){super(i,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class mH extends hf{constructor(i,e,n){super(i,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class gH extends hf{constructor(i,e,n,r){super(i,e),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class _H extends hf{constructor(i,e,n,r){super(i,e),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class vH extends hf{constructor(i,e,n,r,o){super(i,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class yH extends hf{constructor(i,e,n,r){super(i,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class bH extends hf{constructor(i,e,n,r){super(i,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ZO{constructor(i){this.route=i}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class eN{constructor(i){this.route=i}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class xH{constructor(i){this.snapshot=i}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class wH{constructor(i){this.snapshot=i}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class CH{constructor(i){this.snapshot=i}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class TH{constructor(i){this.snapshot=i}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class tN{constructor(i,e,n){this.routerEvent=i,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Gi="primary";class SH{constructor(i){this.params=i||{}}has(i){return Object.prototype.hasOwnProperty.call(this.params,i)}get(i){if(this.has(i)){const e=this.params[i];return Array.isArray(e)?e[0]:e}return null}getAll(i){if(this.has(i)){const e=this.params[i];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function D0(t){return new SH(t)}const nN="ngNavigationCancelingError";function CI(t){const i=Error("NavigationCancelingError: "+t);return i[nN]=!0,i}function kH(t,i,e){const n=e.path.split("/");if(n.length>t.length||"full"===e.pathMatch&&(i.hasChildren()||n.length<t.length))return null;const r={};for(let o=0;o<n.length;o++){const c=n[o],u=t[o];if(c.startsWith(":"))r[c.substring(1)]=u;else if(c!==u.path)return null}return{consumed:t.slice(0,n.length),posParams:r}}function pd(t,i){const e=t?Object.keys(t):void 0,n=i?Object.keys(i):void 0;if(!e||!n||e.length!=n.length)return!1;let r;for(let o=0;o<e.length;o++)if(r=e[o],!iN(t[r],i[r]))return!1;return!0}function iN(t,i){if(Array.isArray(t)&&Array.isArray(i)){if(t.length!==i.length)return!1;const e=[...t].sort(),n=[...i].sort();return e.every((r,o)=>n[o]===r)}return t===i}function rN(t){return Array.prototype.concat.apply([],t)}function oN(t){return t.length>0?t[t.length-1]:null}function Sa(t,i){for(const e in t)t.hasOwnProperty(e)&&i(t[e],e)}function hd(t){return fm(t)?t:dm(t)?Ls(Promise.resolve(t)):_i(t)}const AH={exact:function lN(t,i,e){if(!xm(t.segments,i.segments)||!V3(t.segments,i.segments,e)||t.numberOfChildren!==i.numberOfChildren)return!1;for(const n in i.children)if(!t.children[n]||!lN(t.children[n],i.children[n],e))return!1;return!0},subset:cN},sN={exact:function MH(t,i){return pd(t,i)},subset:function FH(t,i){return Object.keys(i).length<=Object.keys(t).length&&Object.keys(i).every(e=>iN(t[e],i[e]))},ignored:()=>!0};function aN(t,i,e){return AH[e.paths](t.root,i.root,e.matrixParams)&&sN[e.queryParams](t.queryParams,i.queryParams)&&!("exact"===e.fragment&&t.fragment!==i.fragment)}function cN(t,i,e){return uN(t,i,i.segments,e)}function uN(t,i,e,n){if(t.segments.length>e.length){const r=t.segments.slice(0,e.length);return!(!xm(r,e)||i.hasChildren()||!V3(r,e,n))}if(t.segments.length===e.length){if(!xm(t.segments,e)||!V3(t.segments,e,n))return!1;for(const r in i.children)if(!t.children[r]||!cN(t.children[r],i.children[r],n))return!1;return!0}{const r=e.slice(0,t.segments.length),o=e.slice(t.segments.length);return!!(xm(t.segments,r)&&V3(t.segments,r,n)&&t.children[Gi])&&uN(t.children[Gi],i,o,n)}}function V3(t,i,e){return i.every((n,r)=>sN[e](t[r].parameters,n.parameters))}class bm{constructor(i,e,n){this.root=i,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=D0(this.queryParams)),this._queryParamMap}toString(){return NH.serialize(this)}}class nr{constructor(i,e){this.segments=i,this.children=e,this.parent=null,Sa(e,(n,r)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return U3(this)}}class Cy{constructor(i,e){this.path=i,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=D0(this.parameters)),this._parameterMap}toString(){return mN(this)}}function xm(t,i){return t.length===i.length&&t.every((e,n)=>e.path===i[n].path)}class dN{}class fN{parse(i){const e=new $H(i);return new bm(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(i){const e=`/${Ty(i.root,!0)}`,n=function BH(t){const i=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(r=>`${H3(e)}=${H3(r)}`).join("&"):`${H3(e)}=${H3(n)}`}).filter(e=>!!e);return i.length?`?${i.join("&")}`:""}(i.queryParams);return`${e}${n}${"string"==typeof i.fragment?`#${function LH(t){return encodeURI(t)}(i.fragment)}`:""}`}}const NH=new fN;function U3(t){return t.segments.map(i=>mN(i)).join("/")}function Ty(t,i){if(!t.hasChildren())return U3(t);if(i){const e=t.children[Gi]?Ty(t.children[Gi],!1):"",n=[];return Sa(t.children,(r,o)=>{o!==Gi&&n.push(`${o}:${Ty(r,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}{const e=function OH(t,i){let e=[];return Sa(t.children,(n,r)=>{r===Gi&&(e=e.concat(i(n,r)))}),Sa(t.children,(n,r)=>{r!==Gi&&(e=e.concat(i(n,r)))}),e}(t,(n,r)=>r===Gi?[Ty(t.children[Gi],!1)]:[`${r}:${Ty(n,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[Gi]?`${U3(t)}/${e[0]}`:`${U3(t)}/(${e.join("//")})`}}function pN(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function H3(t){return pN(t).replace(/%3B/gi,";")}function TI(t){return pN(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function z3(t){return decodeURIComponent(t)}function hN(t){return z3(t.replace(/\+/g,"%20"))}function mN(t){return`${TI(t.path)}${function RH(t){return Object.keys(t).map(i=>`;${TI(i)}=${TI(t[i])}`).join("")}(t.parameters)}`}const jH=/^[^\/()?;=#]+/;function $3(t){const i=t.match(jH);return i?i[0]:""}const VH=/^[^=?&#]+/,HH=/^[^&#]+/;class $H{constructor(i){this.url=i,this.remaining=i}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new nr([],{}):new nr([],this.parseChildren())}parseQueryParams(){const i={};if(this.consumeOptional("?"))do{this.parseQueryParam(i)}while(this.consumeOptional("&"));return i}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const i=[];for(this.peekStartsWith("(")||i.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),i.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(i.length>0||Object.keys(e).length>0)&&(n[Gi]=new nr(i,e)),n}parseSegment(){const i=$3(this.remaining);if(""===i&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(i),new Cy(z3(i),this.parseMatrixParams())}parseMatrixParams(){const i={};for(;this.consumeOptional(";");)this.parseParam(i);return i}parseParam(i){const e=$3(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const r=$3(this.remaining);r&&(n=r,this.capture(n))}i[z3(e)]=z3(n)}parseQueryParam(i){const e=function UH(t){const i=t.match(VH);return i?i[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const c=function zH(t){const i=t.match(HH);return i?i[0]:""}(this.remaining);c&&(n=c,this.capture(n))}const r=hN(e),o=hN(n);if(i.hasOwnProperty(r)){let c=i[r];Array.isArray(c)||(c=[c],i[r]=c),c.push(o)}else i[r]=o}parseParens(i){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=$3(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let o;n.indexOf(":")>-1?(o=n.substr(0,n.indexOf(":")),this.capture(o),this.capture(":")):i&&(o=Gi);const c=this.parseChildren();e[o]=1===Object.keys(c).length?c[Gi]:new nr([],c),this.consumeOptional("//")}return e}peekStartsWith(i){return this.remaining.startsWith(i)}consumeOptional(i){return!!this.peekStartsWith(i)&&(this.remaining=this.remaining.substring(i.length),!0)}capture(i){if(!this.consumeOptional(i))throw new Error(`Expected "${i}".`)}}class gN{constructor(i){this._root=i}get root(){return this._root.value}parent(i){const e=this.pathFromRoot(i);return e.length>1?e[e.length-2]:null}children(i){const e=SI(i,this._root);return e?e.children.map(n=>n.value):[]}firstChild(i){const e=SI(i,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(i){const e=EI(i,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==i)}pathFromRoot(i){return EI(i,this._root).map(e=>e.value)}}function SI(t,i){if(t===i.value)return i;for(const e of i.children){const n=SI(t,e);if(n)return n}return null}function EI(t,i){if(t===i.value)return[i];for(const e of i.children){const n=EI(t,e);if(n.length)return n.unshift(i),n}return[]}class mf{constructor(i,e){this.value=i,this.children=e}toString(){return`TreeNode(${this.value})`}}function I0(t){const i={};return t&&t.children.forEach(e=>i[e.value.outlet]=e),i}class _N extends gN{constructor(i,e){super(i),this.snapshot=e,kI(this,i)}toString(){return this.snapshot.toString()}}function vN(t,i){const e=function WH(t,i){const c=new W3([],{},{},"",{},Gi,i,null,t.root,-1,{});return new bN("",new mf(c,[]))}(t,i),n=new Tu([new Cy("",{})]),r=new Tu({}),o=new Tu({}),c=new Tu({}),u=new Tu(""),m=new A0(n,r,c,u,o,Gi,i,e.root);return m.snapshot=e.root,new _N(new mf(m,[]),e)}class A0{constructor(i,e,n,r,o,c,u,m){this.url=i,this.params=e,this.queryParams=n,this.fragment=r,this.data=o,this.outlet=c,this.component=u,this._futureSnapshot=m}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(or(i=>D0(i)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(or(i=>D0(i)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function yN(t,i="emptyOnly"){const e=t.pathFromRoot;let n=0;if("always"!==i)for(n=e.length-1;n>=1;){const r=e[n],o=e[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(o.component)break;n--}}return function qH(t){return t.reduce((i,e)=>({params:Object.assign(Object.assign({},i.params),e.params),data:Object.assign(Object.assign({},i.data),e.data),resolve:Object.assign(Object.assign({},i.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(e.slice(n))}class W3{constructor(i,e,n,r,o,c,u,m,g,x,S){this.url=i,this.params=e,this.queryParams=n,this.fragment=r,this.data=o,this.outlet=c,this.component=u,this.routeConfig=m,this._urlSegment=g,this._lastPathIndex=x,this._resolve=S}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=D0(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=D0(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class bN extends gN{constructor(i,e){super(e),this.url=i,kI(this,e)}toString(){return xN(this._root)}}function kI(t,i){i.value._routerState=t,i.children.forEach(e=>kI(t,e))}function xN(t){const i=t.children.length>0?` { ${t.children.map(xN).join(", ")} } `:"";return`${t.value}${i}`}function DI(t){if(t.snapshot){const i=t.snapshot,e=t._futureSnapshot;t.snapshot=e,pd(i.queryParams,e.queryParams)||t.queryParams.next(e.queryParams),i.fragment!==e.fragment&&t.fragment.next(e.fragment),pd(i.params,e.params)||t.params.next(e.params),function DH(t,i){if(t.length!==i.length)return!1;for(let e=0;e<t.length;++e)if(!pd(t[e],i[e]))return!1;return!0}(i.url,e.url)||t.url.next(e.url),pd(i.data,e.data)||t.data.next(e.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function II(t,i){const e=pd(t.params,i.params)&&function PH(t,i){return xm(t,i)&&t.every((e,n)=>pd(e.parameters,i[n].parameters))}(t.url,i.url);return e&&!(!t.parent!=!i.parent)&&(!t.parent||II(t.parent,i.parent))}function Sy(t,i,e){if(e&&t.shouldReuseRoute(i.value,e.value.snapshot)){const n=e.value;n._futureSnapshot=i.value;const r=function KH(t,i,e){return i.children.map(n=>{for(const r of e.children)if(t.shouldReuseRoute(n.value,r.value.snapshot))return Sy(t,n,r);return Sy(t,n)})}(t,i,e);return new mf(n,r)}{if(t.shouldAttach(i.value)){const o=t.retrieve(i.value);if(null!==o){const c=o.route;return c.value._futureSnapshot=i.value,c.children=i.children.map(u=>Sy(t,u)),c}}const n=function YH(t){return new A0(new Tu(t.url),new Tu(t.params),new Tu(t.queryParams),new Tu(t.fragment),new Tu(t.data),t.outlet,t.component,t)}(i.value),r=i.children.map(o=>Sy(t,o));return new mf(n,r)}}function q3(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function Ey(t){return"object"==typeof t&&null!=t&&t.outlets}function AI(t,i,e,n,r){let o={};if(n&&Sa(n,(u,m)=>{o[m]=Array.isArray(u)?u.map(g=>`${g}`):`${u}`}),t===i)return new bm(e,o,r);const c=wN(t,i,e);return new bm(c,o,r)}function wN(t,i,e){const n={};return Sa(t.children,(r,o)=>{n[o]=r===i?e:wN(r,i,e)}),new nr(t.segments,n)}class CN{constructor(i,e,n){if(this.isAbsolute=i,this.numberOfDoubleDots=e,this.commands=n,i&&n.length>0&&q3(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(Ey);if(r&&r!==oN(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class MI{constructor(i,e,n){this.segmentGroup=i,this.processChildren=e,this.index=n}}function TN(t,i,e){if(t||(t=new nr([],{})),0===t.segments.length&&t.hasChildren())return G3(t,i,e);const n=function tz(t,i,e){let n=0,r=i;const o={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(n>=e.length)return o;const c=t.segments[r],u=e[n];if(Ey(u))break;const m=`${u}`,g=n<e.length-1?e[n+1]:null;if(r>0&&void 0===m)break;if(m&&g&&"object"==typeof g&&void 0===g.outlets){if(!EN(m,g,c))return o;n+=2}else{if(!EN(m,{},c))return o;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(t,i,e),r=e.slice(n.commandIndex);if(n.match&&n.pathIndex<t.segments.length){const o=new nr(t.segments.slice(0,n.pathIndex),{});return o.children[Gi]=new nr(t.segments.slice(n.pathIndex),t.children),G3(o,0,r)}return n.match&&0===r.length?new nr(t.segments,{}):n.match&&!t.hasChildren()?FI(t,i,e):n.match?G3(t,0,r):FI(t,i,e)}function G3(t,i,e){if(0===e.length)return new nr(t.segments,{});{const n=function ez(t){return Ey(t[0])?t[0].outlets:{[Gi]:t}}(e),r={};return Sa(n,(o,c)=>{"string"==typeof o&&(o=[o]),null!==o&&(r[c]=TN(t.children[c],i,o))}),Sa(t.children,(o,c)=>{void 0===n[c]&&(r[c]=o)}),new nr(t.segments,r)}}function FI(t,i,e){const n=t.segments.slice(0,i);let r=0;for(;r<e.length;){const o=e[r];if(Ey(o)){const m=nz(o.outlets);return new nr(n,m)}if(0===r&&q3(e[0])){n.push(new Cy(t.segments[i].path,SN(e[0]))),r++;continue}const c=Ey(o)?o.outlets[Gi]:`${o}`,u=r<e.length-1?e[r+1]:null;c&&u&&q3(u)?(n.push(new Cy(c,SN(u))),r+=2):(n.push(new Cy(c,{})),r++)}return new nr(n,{})}function nz(t){const i={};return Sa(t,(e,n)=>{"string"==typeof e&&(e=[e]),null!==e&&(i[n]=FI(new nr([],{}),0,e))}),i}function SN(t){const i={};return Sa(t,(e,n)=>i[n]=`${e}`),i}function EN(t,i,e){return t==e.path&&pd(i,e.parameters)}class rz{constructor(i,e,n,r){this.routeReuseStrategy=i,this.futureState=e,this.currState=n,this.forwardEvent=r}activate(i){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,i),DI(this.futureState.root),this.activateChildRoutes(e,n,i)}deactivateChildRoutes(i,e,n){const r=I0(e);i.children.forEach(o=>{const c=o.value.outlet;this.deactivateRoutes(o,r[c],n),delete r[c]}),Sa(r,(o,c)=>{this.deactivateRouteAndItsChildren(o,n)})}deactivateRoutes(i,e,n){const r=i.value,o=e?e.value:null;if(r===o)if(r.component){const c=n.getContext(r.outlet);c&&this.deactivateChildRoutes(i,e,c.children)}else this.deactivateChildRoutes(i,e,n);else o&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(i,e){i.value.component&&this.routeReuseStrategy.shouldDetach(i.value.snapshot)?this.detachAndStoreRouteSubtree(i,e):this.deactivateRouteAndOutlet(i,e)}detachAndStoreRouteSubtree(i,e){const n=e.getContext(i.value.outlet),r=n&&i.value.component?n.children:e,o=I0(i);for(const c of Object.keys(o))this.deactivateRouteAndItsChildren(o[c],r);if(n&&n.outlet){const c=n.outlet.detach(),u=n.children.onOutletDeactivated();this.routeReuseStrategy.store(i.value.snapshot,{componentRef:c,route:i,contexts:u})}}deactivateRouteAndOutlet(i,e){const n=e.getContext(i.value.outlet),r=n&&i.value.component?n.children:e,o=I0(i);for(const c of Object.keys(o))this.deactivateRouteAndItsChildren(o[c],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(i,e,n){const r=I0(e);i.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],n),this.forwardEvent(new TH(o.value.snapshot))}),i.children.length&&this.forwardEvent(new wH(i.value.snapshot))}activateRoutes(i,e,n){const r=i.value,o=e?e.value:null;if(DI(r),r===o)if(r.component){const c=n.getOrCreateContext(r.outlet);this.activateChildRoutes(i,e,c.children)}else this.activateChildRoutes(i,e,n);else if(r.component){const c=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const u=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),c.children.onOutletReAttached(u.contexts),c.attachRef=u.componentRef,c.route=u.route.value,c.outlet&&c.outlet.attach(u.componentRef,u.route.value),DI(u.route.value),this.activateChildRoutes(i,null,c.children)}else{const u=function oz(t){for(let i=t.parent;i;i=i.parent){const e=i.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig;if(e&&e.component)return null}return null}(r.snapshot),m=u?u.module.componentFactoryResolver:null;c.attachRef=null,c.route=r,c.resolver=m,c.outlet&&c.outlet.activateWith(r,m),this.activateChildRoutes(i,null,c.children)}}else this.activateChildRoutes(i,null,n)}}class PI{constructor(i,e){this.routes=i,this.module=e}}function Op(t){return"function"==typeof t}function wm(t){return t instanceof bm}const ky=Symbol("INITIAL_VALUE");function Dy(){return Mp(t=>function aH(...t){const i=Gr(t),e=Zb(t),{args:n,keys:r}=$O(t);if(0===n.length)return Ls([],i);const o=new Lr(function lH(t,i,e=qu){return n=>{qO(i,()=>{const{length:r}=t,o=new Array(r);let c=r,u=r;for(let m=0;m<r;m++)qO(i,()=>{const g=Ls(t[m],i);let x=!1;g.subscribe(co(n,S=>{o[m]=S,x||(x=!0,u--),u||n.next(e(o.slice()))},()=>{--c||n.complete()}))},n)},n)}}(n,i,r?c=>WO(r,c):qu));return e?o.pipe(_I(e)):o}(t.map(i=>i.pipe(yI(1),bI(ky)))).pipe(YO((i,e)=>{let n=!1;return e.reduce((r,o,c)=>r!==ky?r:(o===ky&&(n=!0),n||!1!==o&&c!==e.length-1&&!wm(o)?r:o),i)},ky),Fp(i=>i!==ky),or(i=>wm(i)?i:!0===i),yI(1)))}class dz{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Iy,this.attachRef=null}}class Iy{constructor(){this.contexts=new Map}onChildOutletCreated(i,e){const n=this.getOrCreateContext(i);n.outlet=e,this.contexts.set(i,n)}onChildOutletDestroyed(i){const e=this.getContext(i);e&&(e.outlet=null,e.attachRef=null)}onOutletDeactivated(){const i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let e=this.getContext(i);return e||(e=new dz,this.contexts.set(i,e)),e}getContext(i){return this.contexts.get(i)||null}}let OI=(()=>{class t{constructor(e,n,r,o,c){this.parentContexts=e,this.location=n,this.resolver=r,this.changeDetector=c,this.activated=null,this._activatedRoute=null,this.activateEvents=new Et,this.deactivateEvents=new Et,this.attachEvents=new Et,this.detachEvents=new Et,this.name=o||Gi,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,n){this.activated=e,this._activatedRoute=n,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,n){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;const c=(n=n||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),u=this.parentContexts.getOrCreateContext(this.name).children,m=new fz(e,u,this.location.injector);this.activated=this.location.createComponent(c,this.location.length,m),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(te(Iy),te(Al),te(df),Nh("name"),te(Wo))},t.\u0275dir=Ln({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),t})();class fz{constructor(i,e,n){this.route=i,this.childContexts=e,this.parent=n}get(i,e){return i===A0?this.route:i===Iy?this.childContexts:this.parent.get(i,e)}}let kN=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=dn({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,n){1&e&&ee(0,"router-outlet")},directives:[OI],encapsulation:2}),t})();function DN(t,i=""){for(let e=0;e<t.length;e++){const n=t[e];pz(n,hz(i,n))}}function pz(t,i){t.children&&DN(t.children,i)}function hz(t,i){return i?t||i.path?t&&!i.path?`${t}/`:!t&&i.path?i.path:`${t}/${i.path}`:"":t}function NI(t){const i=t.children&&t.children.map(NI),e=i?Object.assign(Object.assign({},t),{children:i}):Object.assign({},t);return!e.component&&(i||e.loadChildren)&&e.outlet&&e.outlet!==Gi&&(e.component=kN),e}function Vc(t){return t.outlet||Gi}function IN(t,i){const e=t.filter(n=>Vc(n)===i);return e.push(...t.filter(n=>Vc(n)!==i)),e}const AN={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function K3(t,i,e){var n;if(""===i.path)return"full"===i.pathMatch&&(t.hasChildren()||e.length>0)?Object.assign({},AN):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const o=(i.matcher||kH)(e,t,i);if(!o)return Object.assign({},AN);const c={};Sa(o.posParams,(m,g)=>{c[g]=m.path});const u=o.consumed.length>0?Object.assign(Object.assign({},c),o.consumed[o.consumed.length-1].parameters):c;return{matched:!0,consumedSegments:o.consumed,remainingSegments:e.slice(o.consumed.length),parameters:u,positionalParamSegments:null!==(n=o.posParams)&&void 0!==n?n:{}}}function Y3(t,i,e,n,r="corrected"){if(e.length>0&&function _z(t,i,e){return e.some(n=>X3(t,i,n)&&Vc(n)!==Gi)}(t,e,n)){const c=new nr(i,function gz(t,i,e,n){const r={};r[Gi]=n,n._sourceSegment=t,n._segmentIndexShift=i.length;for(const o of e)if(""===o.path&&Vc(o)!==Gi){const c=new nr([],{});c._sourceSegment=t,c._segmentIndexShift=i.length,r[Vc(o)]=c}return r}(t,i,n,new nr(e,t.children)));return c._sourceSegment=t,c._segmentIndexShift=i.length,{segmentGroup:c,slicedSegments:[]}}if(0===e.length&&function vz(t,i,e){return e.some(n=>X3(t,i,n))}(t,e,n)){const c=new nr(t.segments,function mz(t,i,e,n,r,o){const c={};for(const u of n)if(X3(t,e,u)&&!r[Vc(u)]){const m=new nr([],{});m._sourceSegment=t,m._segmentIndexShift="legacy"===o?t.segments.length:i.length,c[Vc(u)]=m}return Object.assign(Object.assign({},r),c)}(t,i,e,n,t.children,r));return c._sourceSegment=t,c._segmentIndexShift=i.length,{segmentGroup:c,slicedSegments:e}}const o=new nr(t.segments,t.children);return o._sourceSegment=t,o._segmentIndexShift=i.length,{segmentGroup:o,slicedSegments:e}}function X3(t,i,e){return(!(t.hasChildren()||i.length>0)||"full"!==e.pathMatch)&&""===e.path}function MN(t,i,e,n){return!!(Vc(t)===n||n!==Gi&&X3(i,e,t))&&("**"===t.path||K3(i,t,e).matched)}function FN(t,i,e){return 0===i.length&&!t.children[e]}class Q3{constructor(i){this.segmentGroup=i||null}}class PN{constructor(i){this.urlTree=i}}function Ay(t){return B3(new Q3(t))}function ON(t){return B3(new PN(t))}class wz{constructor(i,e,n,r,o){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=o,this.allowRedirects=!0,this.ngModule=i.get(en)}apply(){const i=Y3(this.urlTree.root,[],[],this.config).segmentGroup,e=new nr(i.segments,i.children);return this.expandSegmentGroup(this.ngModule,this.config,e,Gi).pipe(or(o=>this.createUrlTree(LI(o),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Pp(o=>{if(o instanceof PN)return this.allowRedirects=!1,this.match(o.urlTree);throw o instanceof Q3?this.noMatchError(o):o}))}match(i){return this.expandSegmentGroup(this.ngModule,this.config,i.root,Gi).pipe(or(r=>this.createUrlTree(LI(r),i.queryParams,i.fragment))).pipe(Pp(r=>{throw r instanceof Q3?this.noMatchError(r):r}))}noMatchError(i){return new Error(`Cannot match any routes. URL Segment: '${i.segmentGroup}'`)}createUrlTree(i,e,n){const r=i.segments.length>0?new nr([],{[Gi]:i}):i;return new bm(r,e,n)}expandSegmentGroup(i,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(i,e,n).pipe(or(o=>new nr([],o))):this.expandSegment(i,n,e,n.segments,r,!0)}expandChildren(i,e,n){const r=[];for(const o of Object.keys(n.children))"primary"===o?r.unshift(o):r.push(o);return Ls(r).pipe(S0(o=>{const c=n.children[o],u=IN(e,o);return this.expandSegmentGroup(i,u,c,o).pipe(or(m=>({segment:m,outlet:o})))}),YO((o,c)=>(o[c.outlet]=c.segment,o),{}),function pH(t,i){const e=arguments.length>=2;return n=>n.pipe(t?Fp((r,o)=>t(r,o,n)):qu,xI(1),e?QO(i):XO(()=>new j3))}())}expandSegment(i,e,n,r,o,c){return Ls(n).pipe(S0(u=>this.expandSegmentAgainstRoute(i,e,n,u,r,o,c).pipe(Pp(g=>{if(g instanceof Q3)return _i(null);throw g}))),E0(u=>!!u),Pp((u,m)=>{if(u instanceof j3||"EmptyError"===u.name)return FN(e,r,o)?_i(new nr([],{})):Ay(e);throw u}))}expandSegmentAgainstRoute(i,e,n,r,o,c,u){return MN(r,e,o,c)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(i,e,r,o,c):u&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(i,e,n,r,o,c):Ay(e):Ay(e)}expandSegmentAgainstRouteUsingRedirect(i,e,n,r,o,c){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(i,n,r,c):this.expandRegularSegmentAgainstRouteUsingRedirect(i,e,n,r,o,c)}expandWildCardWithParamsAgainstRouteUsingRedirect(i,e,n,r){const o=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?ON(o):this.lineralizeSegments(n,o).pipe(ts(c=>{const u=new nr(c,{});return this.expandSegment(i,u,e,c,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(i,e,n,r,o,c){const{matched:u,consumedSegments:m,remainingSegments:g,positionalParamSegments:x}=K3(e,r,o);if(!u)return Ay(e);const S=this.applyRedirectCommands(m,r.redirectTo,x);return r.redirectTo.startsWith("/")?ON(S):this.lineralizeSegments(r,S).pipe(ts(M=>this.expandSegment(i,e,n,M.concat(g),c,!1)))}matchSegmentAgainstRoute(i,e,n,r,o){if("**"===n.path)return n.loadChildren?(n._loadedConfig?_i(n._loadedConfig):this.configLoader.load(i.injector,n)).pipe(or(S=>(n._loadedConfig=S,new nr(r,{})))):_i(new nr(r,{}));const{matched:c,consumedSegments:u,remainingSegments:m}=K3(e,n,r);return c?this.getChildConfig(i,n,r).pipe(ts(x=>{const S=x.module,M=x.routes,{segmentGroup:E,slicedSegments:R}=Y3(e,u,m,M),B=new nr(E.segments,E.children);if(0===R.length&&B.hasChildren())return this.expandChildren(S,M,B).pipe(or(ce=>new nr(u,ce)));if(0===M.length&&0===R.length)return _i(new nr(u,{}));const K=Vc(n)===o;return this.expandSegment(S,B,M,R,K?Gi:o,!0).pipe(or(Y=>new nr(u.concat(Y.segments),Y.children)))})):Ay(e)}getChildConfig(i,e,n){return e.children?_i(new PI(e.children,i)):e.loadChildren?void 0!==e._loadedConfig?_i(e._loadedConfig):this.runCanLoadGuards(i.injector,e,n).pipe(ts(r=>r?this.configLoader.load(i.injector,e).pipe(or(o=>(e._loadedConfig=o,o))):function bz(t){return B3(CI(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`))}(e))):_i(new PI([],i))}runCanLoadGuards(i,e,n){const r=e.canLoad;return r&&0!==r.length?_i(r.map(c=>{const u=i.get(c);let m;if(function az(t){return t&&Op(t.canLoad)}(u))m=u.canLoad(e,n);else{if(!Op(u))throw new Error("Invalid CanLoad guard");m=u(e,n)}return hd(m)})).pipe(Dy(),rc(c=>{if(!wm(c))return;const u=CI(`Redirecting to "${this.urlSerializer.serialize(c)}"`);throw u.url=c,u}),or(c=>!0===c)):_i(!0)}lineralizeSegments(i,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return _i(n);if(r.numberOfChildren>1||!r.children[Gi])return B3(new Error(`Only absolute redirects can have named outlets. redirectTo: '${i.redirectTo}'`));r=r.children[Gi]}}applyRedirectCommands(i,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),i,n)}applyRedirectCreatreUrlTree(i,e,n,r){const o=this.createSegmentGroup(i,e.root,n,r);return new bm(o,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(i,e){const n={};return Sa(i,(r,o)=>{if("string"==typeof r&&r.startsWith(":")){const u=r.substring(1);n[o]=e[u]}else n[o]=r}),n}createSegmentGroup(i,e,n,r){const o=this.createSegments(i,e.segments,n,r);let c={};return Sa(e.children,(u,m)=>{c[m]=this.createSegmentGroup(i,u,n,r)}),new nr(o,c)}createSegments(i,e,n,r){return e.map(o=>o.path.startsWith(":")?this.findPosParam(i,o,r):this.findOrReturn(o,n))}findPosParam(i,e,n){const r=n[e.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${i}'. Cannot find '${e.path}'.`);return r}findOrReturn(i,e){let n=0;for(const r of e){if(r.path===i.path)return e.splice(n),r;n++}return i}}function LI(t){const i={};for(const n of Object.keys(t.children)){const o=LI(t.children[n]);(o.segments.length>0||o.hasChildren())&&(i[n]=o)}return function Cz(t){if(1===t.numberOfChildren&&t.children[Gi]){const i=t.children[Gi];return new nr(t.segments.concat(i.segments),i.children)}return t}(new nr(t.segments,i))}class NN{constructor(i){this.path=i,this.route=this.path[this.path.length-1]}}class J3{constructor(i,e){this.component=i,this.route=e}}function Sz(t,i,e){const n=t._root;return My(n,i?i._root:null,e,[n.value])}function Z3(t,i,e){const n=function kz(t){if(!t)return null;for(let i=t.parent;i;i=i.parent){const e=i.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig}return null}(i);return(n?n.module.injector:e).get(t)}function My(t,i,e,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=I0(i);return t.children.forEach(c=>{(function Dz(t,i,e,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=t.value,c=i?i.value:null,u=e?e.getContext(t.value.outlet):null;if(c&&o.routeConfig===c.routeConfig){const m=function Iz(t,i,e){if("function"==typeof e)return e(t,i);switch(e){case"pathParamsChange":return!xm(t.url,i.url);case"pathParamsOrQueryParamsChange":return!xm(t.url,i.url)||!pd(t.queryParams,i.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!II(t,i)||!pd(t.queryParams,i.queryParams);default:return!II(t,i)}}(c,o,o.routeConfig.runGuardsAndResolvers);m?r.canActivateChecks.push(new NN(n)):(o.data=c.data,o._resolvedData=c._resolvedData),My(t,i,o.component?u?u.children:null:e,n,r),m&&u&&u.outlet&&u.outlet.isActivated&&r.canDeactivateChecks.push(new J3(u.outlet.component,c))}else c&&Fy(i,u,r),r.canActivateChecks.push(new NN(n)),My(t,null,o.component?u?u.children:null:e,n,r)})(c,o[c.value.outlet],e,n.concat([c.value]),r),delete o[c.value.outlet]}),Sa(o,(c,u)=>Fy(c,e.getContext(u),r)),r}function Fy(t,i,e){const n=I0(t),r=t.value;Sa(n,(o,c)=>{Fy(o,r.component?i?i.children.getContext(c):null:i,e)}),e.canDeactivateChecks.push(new J3(r.component&&i&&i.outlet&&i.outlet.isActivated?i.outlet.component:null,r))}class Bz{}function LN(t){return new Lr(i=>i.error(t))}class Vz{constructor(i,e,n,r,o,c){this.rootComponentType=i,this.config=e,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=c}recognize(){const i=Y3(this.urlTree.root,[],[],this.config.filter(c=>void 0===c.redirectTo),this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,i,Gi);if(null===e)return null;const n=new W3([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Gi,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new mf(n,e),o=new bN(this.url,r);return this.inheritParamsAndData(o._root),o}inheritParamsAndData(i){const e=i.value,n=yN(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),i.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(i,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(i,e):this.processSegment(i,e,e.segments,n)}processChildren(i,e){const n=[];for(const o of Object.keys(e.children)){const c=e.children[o],u=IN(i,o),m=this.processSegmentGroup(u,c,o);if(null===m)return null;n.push(...m)}const r=RN(n);return function Uz(t){t.sort((i,e)=>i.value.outlet===Gi?-1:e.value.outlet===Gi?1:i.value.outlet.localeCompare(e.value.outlet))}(r),r}processSegment(i,e,n,r){for(const o of i){const c=this.processSegmentAgainstRoute(o,e,n,r);if(null!==c)return c}return FN(e,n,r)?[]:null}processSegmentAgainstRoute(i,e,n,r){if(i.redirectTo||!MN(i,e,n,r))return null;let o,c=[],u=[];if("**"===i.path){const E=n.length>0?oN(n).parameters:{};o=new W3(n,E,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,VN(i),Vc(i),i.component,i,BN(e),jN(e)+n.length,UN(i))}else{const E=K3(e,i,n);if(!E.matched)return null;c=E.consumedSegments,u=E.remainingSegments,o=new W3(c,E.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,VN(i),Vc(i),i.component,i,BN(e),jN(e)+c.length,UN(i))}const m=function Hz(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(i),{segmentGroup:g,slicedSegments:x}=Y3(e,c,u,m.filter(E=>void 0===E.redirectTo),this.relativeLinkResolution);if(0===x.length&&g.hasChildren()){const E=this.processChildren(m,g);return null===E?null:[new mf(o,E)]}if(0===m.length&&0===x.length)return[new mf(o,[])];const S=Vc(i)===r,M=this.processSegment(m,g,x,S?Gi:r);return null===M?null:[new mf(o,M)]}}function zz(t){const i=t.value.routeConfig;return i&&""===i.path&&void 0===i.redirectTo}function RN(t){const i=[],e=new Set;for(const n of t){if(!zz(n)){i.push(n);continue}const r=i.find(o=>n.value.routeConfig===o.value.routeConfig);void 0!==r?(r.children.push(...n.children),e.add(r)):i.push(n)}for(const n of e){const r=RN(n.children);i.push(new mf(n.value,r))}return i.filter(n=>!e.has(n))}function BN(t){let i=t;for(;i._sourceSegment;)i=i._sourceSegment;return i}function jN(t){let i=t,e=i._segmentIndexShift?i._segmentIndexShift:0;for(;i._sourceSegment;)i=i._sourceSegment,e+=i._segmentIndexShift?i._segmentIndexShift:0;return e-1}function VN(t){return t.data||{}}function UN(t){return t.resolve||{}}function HN(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function RI(t){return Mp(i=>{const e=t(i);return e?Ls(e).pipe(or(()=>i)):_i(i)})}class Qz extends class Xz{shouldDetach(i){return!1}store(i,e){}shouldAttach(i){return!1}retrieve(i){return null}shouldReuseRoute(i,e){return i.routeConfig===e.routeConfig}}{}const BI=new hi("ROUTES");class zN{constructor(i,e,n,r){this.injector=i,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=r}load(i,e){if(e._loader$)return e._loader$;this.onLoadStartListener&&this.onLoadStartListener(e);const r=this.loadModuleFactory(e.loadChildren).pipe(or(o=>{this.onLoadEndListener&&this.onLoadEndListener(e);const c=o.create(i);return new PI(rN(c.injector.get(BI,void 0,_n.Self|_n.Optional)).map(NI),c)}),Pp(o=>{throw e._loader$=void 0,o}));return e._loader$=new uH(r,()=>new Wi).pipe(KO()),e._loader$}loadModuleFactory(i){return hd(i()).pipe(ts(e=>e instanceof ci?_i(e):Ls(this.compiler.compileModuleAsync(e))))}}class Zz{shouldProcessUrl(i){return!0}extract(i){return i}merge(i,e){return i}}function e$(t){throw t}function t$(t,i,e){return i.parse("/")}function $N(t,i){return _i(null)}const n$={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},i$={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let zs=(()=>{class t{constructor(e,n,r,o,c,u,m){this.rootComponentType=e,this.urlSerializer=n,this.rootContexts=r,this.location=o,this.config=m,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Wi,this.errorHandler=e$,this.malformedUriErrorHandler=t$,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:$N,afterPreactivation:$N},this.urlHandlingStrategy=new Zz,this.routeReuseStrategy=new Qz,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=c.get(en),this.console=c.get(H6);const S=c.get(gr);this.isNgZoneEnabled=S instanceof gr&&gr.isInAngularZone(),this.resetConfig(m),this.currentUrlTree=function IH(){return new bm(new nr([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new zN(c,u,M=>this.triggerEvent(new ZO(M)),M=>this.triggerEvent(new eN(M))),this.routerState=vN(this.currentUrlTree,this.rootComponentType),this.transitions=new Tu({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}setupNavigations(e){const n=this.events;return e.pipe(Fp(r=>0!==r.id),or(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Mp(r=>{let o=!1,c=!1;return _i(r).pipe(rc(u=>{this.currentNavigation={id:u.id,initialUrl:u.currentRawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Mp(u=>{const m=this.browserUrlTree.toString(),g=!this.navigated||u.extractedUrl.toString()!==m||m!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||g)&&this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return WN(u.source)&&(this.browserUrlTree=u.extractedUrl),_i(u).pipe(Mp(S=>{const M=this.transitions.getValue();return n.next(new wI(S.id,this.serializeUrl(S.extractedUrl),S.source,S.restoredState)),M!==this.transitions.getValue()?In:Promise.resolve(S)}),function Tz(t,i,e,n){return Mp(r=>function xz(t,i,e,n,r){return new wz(t,i,e,n,r).apply()}(t,i,e,r.extractedUrl,n).pipe(or(o=>Object.assign(Object.assign({},r),{urlAfterRedirects:o}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),rc(S=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:S.urlAfterRedirects})}),function $z(t,i,e,n,r){return ts(o=>function jz(t,i,e,n,r="emptyOnly",o="legacy"){try{const c=new Vz(t,i,e,n,r,o).recognize();return null===c?LN(new Bz):_i(c)}catch(c){return LN(c)}}(t,i,o.urlAfterRedirects,e(o.urlAfterRedirects),n,r).pipe(or(c=>Object.assign(Object.assign({},o),{targetSnapshot:c}))))}(this.rootComponentType,this.config,S=>this.serializeUrl(S),this.paramsInheritanceStrategy,this.relativeLinkResolution),rc(S=>{if("eager"===this.urlUpdateStrategy){if(!S.extras.skipLocationChange){const E=this.urlHandlingStrategy.merge(S.urlAfterRedirects,S.rawUrl);this.setBrowserUrl(E,S)}this.browserUrlTree=S.urlAfterRedirects}const M=new gH(S.id,this.serializeUrl(S.extractedUrl),this.serializeUrl(S.urlAfterRedirects),S.targetSnapshot);n.next(M)}));if(g&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:M,extractedUrl:E,source:R,restoredState:B,extras:K}=u,q=new wI(M,this.serializeUrl(E),R,B);n.next(q);const Y=vN(E,this.rootComponentType).snapshot;return _i(Object.assign(Object.assign({},u),{targetSnapshot:Y,urlAfterRedirects:E,extras:Object.assign(Object.assign({},K),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=u.rawUrl,u.resolve(null),In}),RI(u=>{const{targetSnapshot:m,id:g,extractedUrl:x,rawUrl:S,extras:{skipLocationChange:M,replaceUrl:E}}=u;return this.hooks.beforePreactivation(m,{navigationId:g,appliedUrlTree:x,rawUrlTree:S,skipLocationChange:!!M,replaceUrl:!!E})}),rc(u=>{const m=new _H(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(m)}),or(u=>Object.assign(Object.assign({},u),{guards:Sz(u.targetSnapshot,u.currentSnapshot,this.rootContexts)})),function Az(t,i){return ts(e=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:c}}=e;return 0===c.length&&0===o.length?_i(Object.assign(Object.assign({},e),{guardsResult:!0})):function Mz(t,i,e,n){return Ls(t).pipe(ts(r=>function Rz(t,i,e,n,r){const o=i&&i.routeConfig?i.routeConfig.canDeactivate:null;return o&&0!==o.length?_i(o.map(u=>{const m=Z3(u,i,r);let g;if(function uz(t){return t&&Op(t.canDeactivate)}(m))g=hd(m.canDeactivate(t,i,e,n));else{if(!Op(m))throw new Error("Invalid CanDeactivate guard");g=hd(m(t,i,e,n))}return g.pipe(E0())})).pipe(Dy()):_i(!0)}(r.component,r.route,e,i,n)),E0(r=>!0!==r,!0))}(c,n,r,t).pipe(ts(u=>u&&function sz(t){return"boolean"==typeof t}(u)?function Fz(t,i,e,n){return Ls(i).pipe(S0(r=>vI(function Oz(t,i){return null!==t&&i&&i(new xH(t)),_i(!0)}(r.route.parent,n),function Pz(t,i){return null!==t&&i&&i(new CH(t)),_i(!0)}(r.route,n),function Lz(t,i,e){const n=i[i.length-1],o=i.slice(0,i.length-1).reverse().map(c=>function Ez(t){const i=t.routeConfig?t.routeConfig.canActivateChild:null;return i&&0!==i.length?{node:t,guards:i}:null}(c)).filter(c=>null!==c).map(c=>GO(()=>_i(c.guards.map(m=>{const g=Z3(m,c.node,e);let x;if(function cz(t){return t&&Op(t.canActivateChild)}(g))x=hd(g.canActivateChild(n,t));else{if(!Op(g))throw new Error("Invalid CanActivateChild guard");x=hd(g(n,t))}return x.pipe(E0())})).pipe(Dy())));return _i(o).pipe(Dy())}(t,r.path,e),function Nz(t,i,e){const n=i.routeConfig?i.routeConfig.canActivate:null;if(!n||0===n.length)return _i(!0);const r=n.map(o=>GO(()=>{const c=Z3(o,i,e);let u;if(function lz(t){return t&&Op(t.canActivate)}(c))u=hd(c.canActivate(i,t));else{if(!Op(c))throw new Error("Invalid CanActivate guard");u=hd(c(i,t))}return u.pipe(E0())}));return _i(r).pipe(Dy())}(t,r.route,e))),E0(r=>!0!==r,!0))}(n,o,t,i):_i(u)),or(u=>Object.assign(Object.assign({},e),{guardsResult:u})))})}(this.ngModule.injector,u=>this.triggerEvent(u)),rc(u=>{if(wm(u.guardsResult)){const g=CI(`Redirecting to "${this.serializeUrl(u.guardsResult)}"`);throw g.url=u.guardsResult,g}const m=new vH(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.triggerEvent(m)}),Fp(u=>!!u.guardsResult||(this.restoreHistory(u),this.cancelNavigationTransition(u,""),!1)),RI(u=>{if(u.guards.canActivateChecks.length)return _i(u).pipe(rc(m=>{const g=new yH(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);this.triggerEvent(g)}),Mp(m=>{let g=!1;return _i(m).pipe(function Wz(t,i){return ts(e=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=e;if(!r.length)return _i(e);let o=0;return Ls(r).pipe(S0(c=>function qz(t,i,e,n){return function Gz(t,i,e,n){const r=HN(t);if(0===r.length)return _i({});const o={};return Ls(r).pipe(ts(c=>function Kz(t,i,e,n){const r=Z3(t,i,n);return hd(r.resolve?r.resolve(i,e):r(i,e))}(t[c],i,e,n).pipe(rc(u=>{o[c]=u}))),xI(1),ts(()=>HN(o).length===r.length?_i(o):In))}(t._resolve,t,i,n).pipe(or(o=>(t._resolvedData=o,t.data=Object.assign(Object.assign({},t.data),yN(t,e).resolve),null)))}(c.route,n,t,i)),rc(()=>o++),xI(1),ts(c=>o===r.length?_i(e):In))})}(this.paramsInheritanceStrategy,this.ngModule.injector),rc({next:()=>g=!0,complete:()=>{g||(this.restoreHistory(m),this.cancelNavigationTransition(m,"At least one route resolver didn't emit any value."))}}))}),rc(m=>{const g=new bH(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);this.triggerEvent(g)}))}),RI(u=>{const{targetSnapshot:m,id:g,extractedUrl:x,rawUrl:S,extras:{skipLocationChange:M,replaceUrl:E}}=u;return this.hooks.afterPreactivation(m,{navigationId:g,appliedUrlTree:x,rawUrlTree:S,skipLocationChange:!!M,replaceUrl:!!E})}),or(u=>{const m=function GH(t,i,e){const n=Sy(t,i._root,e?e._root:void 0);return new _N(n,i)}(this.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return Object.assign(Object.assign({},u),{targetRouterState:m})}),rc(u=>{this.currentUrlTree=u.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(u.urlAfterRedirects,u.rawUrl),this.routerState=u.targetRouterState,"deferred"===this.urlUpdateStrategy&&(u.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,u),this.browserUrlTree=u.urlAfterRedirects)}),((t,i,e)=>or(n=>(new rz(i,n.targetRouterState,n.currentRouterState,e).activate(t),n)))(this.rootContexts,this.routeReuseStrategy,u=>this.triggerEvent(u)),rc({next(){o=!0},complete(){o=!0}}),function hH(t){return Mo((i,e)=>{try{i.subscribe(e)}finally{e.add(t)}})}(()=>{var u;o||c||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),(null===(u=this.currentNavigation)||void 0===u?void 0:u.id)===r.id&&(this.currentNavigation=null)}),Pp(u=>{if(c=!0,function EH(t){return t&&t[nN]}(u)){const m=wm(u.url);m||(this.navigated=!0,this.restoreHistory(r,!0));const g=new JO(r.id,this.serializeUrl(r.extractedUrl),u.message);n.next(g),m?setTimeout(()=>{const x=this.urlHandlingStrategy.merge(u.url,this.rawUrlTree),S={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||WN(r.source)};this.scheduleNavigation(x,"imperative",null,S,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const m=new mH(r.id,this.serializeUrl(r.extractedUrl),u);n.next(m);try{r.resolve(this.errorHandler(u))}catch(g){r.reject(g)}}return In}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),e))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const n="popstate"===e.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{var r;const o={replaceUrl:!0},c=(null===(r=e.state)||void 0===r?void 0:r.navigationId)?e.state:null;if(c){const m=Object.assign({},c);delete m.navigationId,delete m.\u0275routerPageId,0!==Object.keys(m).length&&(o.state=m)}const u=this.parseUrl(e.url);this.scheduleNavigation(u,n,c,o)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){DN(e),this.config=e.map(NI),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,n={}){const{relativeTo:r,queryParams:o,fragment:c,queryParamsHandling:u,preserveFragment:m}=n,g=r||this.routerState.root,x=m?this.currentUrlTree.fragment:c;let S=null;switch(u){case"merge":S=Object.assign(Object.assign({},this.currentUrlTree.queryParams),o);break;case"preserve":S=this.currentUrlTree.queryParams;break;default:S=o||null}return null!==S&&(S=this.removeEmptyProps(S)),function XH(t,i,e,n,r){if(0===e.length)return AI(i.root,i.root,i.root,n,r);const o=function QH(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new CN(!0,0,t);let i=0,e=!1;const n=t.reduce((r,o,c)=>{if("object"==typeof o&&null!=o){if(o.outlets){const u={};return Sa(o.outlets,(m,g)=>{u[g]="string"==typeof m?m.split("/"):m}),[...r,{outlets:u}]}if(o.segmentPath)return[...r,o.segmentPath]}return"string"!=typeof o?[...r,o]:0===c?(o.split("/").forEach((u,m)=>{0==m&&"."===u||(0==m&&""===u?e=!0:".."===u?i++:""!=u&&r.push(u))}),r):[...r,o]},[]);return new CN(e,i,n)}(e);if(o.toRoot())return AI(i.root,i.root,new nr([],{}),n,r);const c=function JH(t,i,e){if(t.isAbsolute)return new MI(i.root,!0,0);if(-1===e.snapshot._lastPathIndex){const o=e.snapshot._urlSegment;return new MI(o,o===i.root,0)}const n=q3(t.commands[0])?0:1;return function ZH(t,i,e){let n=t,r=i,o=e;for(;o>r;){if(o-=r,n=n.parent,!n)throw new Error("Invalid number of '../'");r=n.segments.length}return new MI(n,!1,r-o)}(e.snapshot._urlSegment,e.snapshot._lastPathIndex+n,t.numberOfDoubleDots)}(o,i,t),u=c.processChildren?G3(c.segmentGroup,c.index,o.commands):TN(c.segmentGroup,c.index,o.commands);return AI(i.root,c.segmentGroup,u,n,r)}(g,this.currentUrlTree,e,S,null!=x?x:null)}navigateByUrl(e,n={skipLocationChange:!1}){const r=wm(e)?e:this.parseUrl(e),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,"imperative",null,n)}navigate(e,n={skipLocationChange:!1}){return function r$(t){for(let i=0;i<t.length;i++){const e=t[i];if(null==e)throw new Error(`The requested path contains ${e} segment at index ${i}`)}}(e),this.navigateByUrl(this.createUrlTree(e,n),n)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let n;try{n=this.urlSerializer.parse(e)}catch(r){n=this.malformedUriErrorHandler(r,this.urlSerializer,e)}return n}isActive(e,n){let r;if(r=!0===n?Object.assign({},n$):!1===n?Object.assign({},i$):n,wm(e))return aN(this.currentUrlTree,e,r);const o=this.parseUrl(e);return aN(this.currentUrlTree,o,r)}removeEmptyProps(e){return Object.keys(e).reduce((n,r)=>{const o=e[r];return null!=o&&(n[r]=o),n},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new k0(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,n,r,o,c){var u,m;if(this.disposed)return Promise.resolve(!1);let g,x,S;c?(g=c.resolve,x=c.reject,S=c.promise):S=new Promise((R,B)=>{g=R,x=B});const M=++this.navigationId;let E;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),E=r&&r.\u0275routerPageId?r.\u0275routerPageId:o.replaceUrl||o.skipLocationChange?null!==(u=this.browserPageId)&&void 0!==u?u:0:(null!==(m=this.browserPageId)&&void 0!==m?m:0)+1):E=0,this.setTransition({id:M,targetPageId:E,source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:o,resolve:g,reject:x,promise:S,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),S.catch(R=>Promise.reject(R))}setBrowserUrl(e,n){const r=this.urlSerializer.serialize(e),o=Object.assign(Object.assign({},n.extras.state),this.generateNgRouterState(n.id,n.targetPageId));this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl?this.location.replaceState(r,"",o):this.location.go(r,"",o)}restoreHistory(e,n=!1){var r,o;if("computed"===this.canceledNavigationResolution){const c=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===c?this.currentUrlTree===(null===(o=this.currentNavigation)||void 0===o?void 0:o.finalUrl)&&0===c&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(c)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,n){const r=new JO(e.id,this.serializeUrl(e.extractedUrl),n);this.triggerEvent(r),e.resolve(!1)}generateNgRouterState(e,n){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:n}:{navigationId:e}}}return t.\u0275fac=function(e){Bv()},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();function WN(t){return"imperative"!==t}let jI=(()=>{class t{constructor(e,n,r,o,c){this.router=e,this.route=n,this.tabIndexAttribute=r,this.renderer=o,this.el=c,this.commands=null,this.onChanges=new Wi,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(e){if(null!=this.tabIndexAttribute)return;const n=this.renderer,r=this.el.nativeElement;null!==e?n.setAttribute(r,"tabindex",e):n.removeAttribute(r,"tabindex")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const e={skipLocationChange:M0(this.skipLocationChange),replaceUrl:M0(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:M0(this.preserveFragment)})}}return t.\u0275fac=function(e){return new(e||t)(te(zs),te(A0),Nh("tabindex"),te(Ss),te(mr))},t.\u0275dir=Ln({type:t,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,n){1&e&&L("click",function(){return n.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[Vs]}),t})(),eT=(()=>{class t{constructor(e,n,r){this.router=e,this.route=n,this.locationStrategy=r,this.commands=null,this.href=null,this.onChanges=new Wi,this.subscription=e.events.subscribe(o=>{o instanceof k0&&this.updateTargetUrlAndHref()})}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:null}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,n,r,o,c){if(0!==e||n||r||o||c||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const u={skipLocationChange:M0(this.skipLocationChange),replaceUrl:M0(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,u),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:M0(this.preserveFragment)})}}return t.\u0275fac=function(e){return new(e||t)(te(zs),te(A0),te(T0))},t.\u0275dir=Ln({type:t,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,n){1&e&&L("click",function(o){return n.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&e&&Ai("target",n.target)("href",n.href,rd)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[Vs]}),t})();function M0(t){return""===t||!!t}let qN=(()=>{class t{constructor(e,n,r,o,c,u){this.router=e,this.element=n,this.renderer=r,this.cdr=o,this.link=c,this.linkWithHref=u,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new Et,this.routerEventsSubscription=e.events.subscribe(m=>{m instanceof k0&&this.update()})}ngAfterContentInit(){_i(this.links.changes,this.linksWithHrefs.changes,_i(null)).pipe(bh()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){var e;null===(e=this.linkInputChangesSubscription)||void 0===e||e.unsubscribe();const n=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=Ls(n).pipe(bh()).subscribe(r=>{this.isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(e){const n=Array.isArray(e)?e:e.split(" ");this.classes=n.filter(r=>!!r)}ngOnChanges(e){this.update()}ngOnDestroy(){var e;this.routerEventsSubscription.unsubscribe(),null===(e=this.linkInputChangesSubscription)||void 0===e||e.unsubscribe()}update(){!this.links||!this.linksWithHrefs||!this.router.navigated||Promise.resolve().then(()=>{const e=this.hasActiveLinks();this.isActive!==e&&(this.isActive=e,this.cdr.markForCheck(),this.classes.forEach(n=>{e?this.renderer.addClass(this.element.nativeElement,n):this.renderer.removeClass(this.element.nativeElement,n)}),this.isActiveChange.emit(e))})}isLinkActive(e){const n=function o$(t){return!!t.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>!!r.urlTree&&e.isActive(r.urlTree,n)}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.linkWithHref&&e(this.linkWithHref)||this.links.some(e)||this.linksWithHrefs.some(e)}}return t.\u0275fac=function(e){return new(e||t)(te(zs),te(mr),te(Ss),te(Wo),te(jI,8),te(eT,8))},t.\u0275dir=Ln({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(e,n,r){if(1&e&&(ol(r,jI,5),ol(r,eT,5)),2&e){let o;xt(o=wt())&&(n.links=o),xt(o=wt())&&(n.linksWithHrefs=o)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[Vs]}),t})();class GN{}class KN{preload(i,e){return _i(null)}}let YN=(()=>{class t{constructor(e,n,r,o){this.router=e,this.injector=r,this.preloadingStrategy=o,this.loader=new zN(r,n,m=>e.triggerEvent(new ZO(m)),m=>e.triggerEvent(new eN(m)))}setUpPreloading(){this.subscription=this.router.events.pipe(Fp(e=>e instanceof k0),S0(()=>this.preload())).subscribe(()=>{})}preload(){const e=this.injector.get(en);return this.processRoutes(e,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,n){const r=[];for(const o of n)if(o.loadChildren&&!o.canLoad&&o._loadedConfig){const c=o._loadedConfig;r.push(this.processRoutes(c.module,c.routes))}else o.loadChildren&&!o.canLoad?r.push(this.preloadConfig(e,o)):o.children&&r.push(this.processRoutes(e,o.children));return Ls(r).pipe(bh(),or(o=>{}))}preloadConfig(e,n){return this.preloadingStrategy.preload(n,()=>(n._loadedConfig?_i(n._loadedConfig):this.loader.load(e.injector,n)).pipe(ts(o=>(n._loadedConfig=o,this.processRoutes(o.module,o.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(zt(zs),zt(z6),zt(ws),zt(GN))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})(),VI=(()=>{class t{constructor(e,n,r={}){this.router=e,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof wI?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof k0&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof tN&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,n){this.router.triggerEvent(new tN(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){Bv()},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();const Cm=new hi("ROUTER_CONFIGURATION"),XN=new hi("ROUTER_FORROOT_GUARD"),a$=[QD,{provide:dN,useClass:fN},{provide:zs,useFactory:function f$(t,i,e,n,r,o,c={},u,m){const g=new zs(null,t,i,e,n,r,rN(o));return u&&(g.urlHandlingStrategy=u),m&&(g.routeReuseStrategy=m),function p$(t,i){t.errorHandler&&(i.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(i.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(i.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(i.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(i.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(i.urlUpdateStrategy=t.urlUpdateStrategy),t.canceledNavigationResolution&&(i.canceledNavigationResolution=t.canceledNavigationResolution)}(c,g),c.enableTracing&&g.events.subscribe(x=>{var S,M;null===(S=console.group)||void 0===S||S.call(console,`Router Event: ${x.constructor.name}`),console.log(x.toString()),console.log(x),null===(M=console.groupEnd)||void 0===M||M.call(console)}),g},deps:[dN,Iy,QD,ws,z6,BI,Cm,[class Jz{},new nd],[class Yz{},new nd]]},Iy,{provide:A0,useFactory:function h$(t){return t.routerState.root},deps:[zs]},YN,KN,class s${preload(i,e){return e().pipe(Pp(()=>_i(null)))}},{provide:Cm,useValue:{enableTracing:!1}}];function l$(){return new K6("Router",zs)}let QN=(()=>{class t{constructor(e,n){}static forRoot(e,n){return{ngModule:t,providers:[a$,JN(e),{provide:XN,useFactory:d$,deps:[[zs,new nd,new Uh]]},{provide:Cm,useValue:n||{}},{provide:T0,useFactory:u$,deps:[ym,[new Rg(XD),new nd],Cm]},{provide:VI,useFactory:c$,deps:[zs,_U,Cm]},{provide:GN,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:KN},{provide:K6,multi:!0,useFactory:l$},[UI,{provide:LD,multi:!0,useFactory:m$,deps:[UI]},{provide:ZN,useFactory:g$,deps:[UI]},{provide:U6,multi:!0,useExisting:ZN}]]}}static forChild(e){return{ngModule:t,providers:[JN(e)]}}}return t.\u0275fac=function(e){return new(e||t)(zt(XN,8),zt(zs,8))},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({}),t})();function c$(t,i,e){return e.scrollOffset&&i.setOffset(e.scrollOffset),new VI(t,i,e)}function u$(t,i,e={}){return e.useHash?new iV(t,i):new hO(t,i)}function d$(t){return"guarded"}function JN(t){return[{provide:eE,multi:!0,useValue:t},{provide:BI,multi:!0,useValue:t}]}let UI=(()=>{class t{constructor(e){this.injector=e,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Wi}appInitializer(){return this.injector.get(eV,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let n=null;const r=new Promise(u=>n=u),o=this.injector.get(zs),c=this.injector.get(Cm);return"disabled"===c.initialNavigation?(o.setUpLocationChangeListener(),n(!0)):"enabled"===c.initialNavigation||"enabledBlocking"===c.initialNavigation?(o.hooks.afterPreactivation=()=>this.initNavigation?_i(null):(this.initNavigation=!0,n(!0),this.resultOfPreactivationDone),o.initialNavigation()):n(!0),r})}bootstrapListener(e){const n=this.injector.get(Cm),r=this.injector.get(YN),o=this.injector.get(VI),c=this.injector.get(zs),u=this.injector.get(y3);e===u.components[0]&&(("enabledNonBlocking"===n.initialNavigation||void 0===n.initialNavigation)&&c.initialNavigation(),r.setUpPreloading(),o.init(),c.resetRootComponentType(u.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return t.\u0275fac=function(e){return new(e||t)(zt(ws))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();function m$(t){return t.appInitializer.bind(t)}function g$(t){return t.bootstrapListener.bind(t)}const ZN=new hi("Router Initializer");class e8{}class t8{}class io{constructor(i){this.normalizedNames=new Map,this.lazyUpdate=null,i?this.lazyInit="string"==typeof i?()=>{this.headers=new Map,i.split("\n").forEach(e=>{const n=e.indexOf(":");if(n>0){const r=e.slice(0,n),o=r.toLowerCase(),c=e.slice(n+1).trim();this.maybeSetNormalizedName(r,o),this.headers.has(o)?this.headers.get(o).push(c):this.headers.set(o,[c])}})}:()=>{this.headers=new Map,Object.keys(i).forEach(e=>{let n=i[e];const r=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(e,r))})}:this.headers=new Map}has(i){return this.init(),this.headers.has(i.toLowerCase())}get(i){this.init();const e=this.headers.get(i.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(i){return this.init(),this.headers.get(i.toLowerCase())||null}append(i,e){return this.clone({name:i,value:e,op:"a"})}set(i,e){return this.clone({name:i,value:e,op:"s"})}delete(i,e){return this.clone({name:i,value:e,op:"d"})}maybeSetNormalizedName(i,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,i)}init(){this.lazyInit&&(this.lazyInit instanceof io?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(i=>this.applyUpdate(i)),this.lazyUpdate=null))}copyFrom(i){i.init(),Array.from(i.headers.keys()).forEach(e=>{this.headers.set(e,i.headers.get(e)),this.normalizedNames.set(e,i.normalizedNames.get(e))})}clone(i){const e=new io;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof io?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([i]),e}applyUpdate(i){const e=i.name.toLowerCase();switch(i.op){case"a":case"s":let n=i.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(i.name,e);const r=("a"===i.op?this.headers.get(e):void 0)||[];r.push(...n),this.headers.set(e,r);break;case"d":const o=i.value;if(o){let c=this.headers.get(e);if(!c)return;c=c.filter(u=>-1===o.indexOf(u)),0===c.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,c)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(i){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>i(this.normalizedNames.get(e),this.headers.get(e)))}}class v${encodeKey(i){return n8(i)}encodeValue(i){return n8(i)}decodeKey(i){return decodeURIComponent(i)}decodeValue(i){return decodeURIComponent(i)}}const b$=/%(\d[a-f0-9])/gi,x$={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function n8(t){return encodeURIComponent(t).replace(b$,(i,e)=>{var n;return null!==(n=x$[e])&&void 0!==n?n:i})}function r8(t){return`${t}`}class Np{constructor(i={}){if(this.updates=null,this.cloneFrom=null,this.encoder=i.encoder||new v$,i.fromString){if(i.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function y$(t,i){const e=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(r=>{const o=r.indexOf("="),[c,u]=-1==o?[i.decodeKey(r),""]:[i.decodeKey(r.slice(0,o)),i.decodeValue(r.slice(o+1))],m=e.get(c)||[];m.push(u),e.set(c,m)}),e}(i.fromString,this.encoder)}else i.fromObject?(this.map=new Map,Object.keys(i.fromObject).forEach(e=>{const n=i.fromObject[e];this.map.set(e,Array.isArray(n)?n:[n])})):this.map=null}has(i){return this.init(),this.map.has(i)}get(i){this.init();const e=this.map.get(i);return e?e[0]:null}getAll(i){return this.init(),this.map.get(i)||null}keys(){return this.init(),Array.from(this.map.keys())}append(i,e){return this.clone({param:i,value:e,op:"a"})}appendAll(i){const e=[];return Object.keys(i).forEach(n=>{const r=i[n];Array.isArray(r)?r.forEach(o=>{e.push({param:n,value:o,op:"a"})}):e.push({param:n,value:r,op:"a"})}),this.clone(e)}set(i,e){return this.clone({param:i,value:e,op:"s"})}delete(i,e){return this.clone({param:i,value:e,op:"d"})}toString(){return this.init(),this.keys().map(i=>{const e=this.encoder.encodeKey(i);return this.map.get(i).map(n=>e+"="+this.encoder.encodeValue(n)).join("&")}).filter(i=>""!==i).join("&")}clone(i){const e=new Np({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(i),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(i=>this.map.set(i,this.cloneFrom.map.get(i))),this.updates.forEach(i=>{switch(i.op){case"a":case"s":const e=("a"===i.op?this.map.get(i.param):void 0)||[];e.push(r8(i.value)),this.map.set(i.param,e);break;case"d":if(void 0===i.value){this.map.delete(i.param);break}{let n=this.map.get(i.param)||[];const r=n.indexOf(r8(i.value));-1!==r&&n.splice(r,1),n.length>0?this.map.set(i.param,n):this.map.delete(i.param)}}}),this.cloneFrom=this.updates=null)}}class w${constructor(){this.map=new Map}set(i,e){return this.map.set(i,e),this}get(i){return this.map.has(i)||this.map.set(i,i.defaultValue()),this.map.get(i)}delete(i){return this.map.delete(i),this}has(i){return this.map.has(i)}keys(){return this.map.keys()}}function o8(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function s8(t){return"undefined"!=typeof Blob&&t instanceof Blob}function a8(t){return"undefined"!=typeof FormData&&t instanceof FormData}class Py{constructor(i,e,n,r){let o;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=i.toUpperCase(),function C$(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,o=r):o=n,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params)),this.headers||(this.headers=new io),this.context||(this.context=new w$),this.params){const c=this.params.toString();if(0===c.length)this.urlWithParams=e;else{const u=e.indexOf("?");this.urlWithParams=e+(-1===u?"?":u<e.length-1?"&":"")+c}}else this.params=new Np,this.urlWithParams=e}serializeBody(){return null===this.body?null:o8(this.body)||s8(this.body)||a8(this.body)||function T$(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Np?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||a8(this.body)?null:s8(this.body)?this.body.type||null:o8(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Np?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(i={}){var e;const n=i.method||this.method,r=i.url||this.url,o=i.responseType||this.responseType,c=void 0!==i.body?i.body:this.body,u=void 0!==i.withCredentials?i.withCredentials:this.withCredentials,m=void 0!==i.reportProgress?i.reportProgress:this.reportProgress;let g=i.headers||this.headers,x=i.params||this.params;const S=null!==(e=i.context)&&void 0!==e?e:this.context;return void 0!==i.setHeaders&&(g=Object.keys(i.setHeaders).reduce((M,E)=>M.set(E,i.setHeaders[E]),g)),i.setParams&&(x=Object.keys(i.setParams).reduce((M,E)=>M.set(E,i.setParams[E]),x)),new Py(n,r,c,{params:x,headers:g,context:S,reportProgress:m,responseType:o,withCredentials:u})}}var Ds=(()=>((Ds=Ds||{})[Ds.Sent=0]="Sent",Ds[Ds.UploadProgress=1]="UploadProgress",Ds[Ds.ResponseHeader=2]="ResponseHeader",Ds[Ds.DownloadProgress=3]="DownloadProgress",Ds[Ds.Response=4]="Response",Ds[Ds.User=5]="User",Ds))();class HI{constructor(i,e=200,n="OK"){this.headers=i.headers||new io,this.status=void 0!==i.status?i.status:e,this.statusText=i.statusText||n,this.url=i.url||null,this.ok=this.status>=200&&this.status<300}}class zI extends HI{constructor(i={}){super(i),this.type=Ds.ResponseHeader}clone(i={}){return new zI({headers:i.headers||this.headers,status:void 0!==i.status?i.status:this.status,statusText:i.statusText||this.statusText,url:i.url||this.url||void 0})}}class tT extends HI{constructor(i={}){super(i),this.type=Ds.Response,this.body=void 0!==i.body?i.body:null}clone(i={}){return new tT({body:void 0!==i.body?i.body:this.body,headers:i.headers||this.headers,status:void 0!==i.status?i.status:this.status,statusText:i.statusText||this.statusText,url:i.url||this.url||void 0})}}class l8 extends HI{constructor(i){super(i,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${i.url||"(unknown url)"}`:`Http failure response for ${i.url||"(unknown url)"}: ${i.status} ${i.statusText}`,this.error=i.error||null}}function $I(t,i){return{body:i,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let $s=(()=>{class t{constructor(e){this.handler=e}request(e,n,r={}){let o;if(e instanceof Py)o=e;else{let m,g;m=r.headers instanceof io?r.headers:new io(r.headers),r.params&&(g=r.params instanceof Np?r.params:new Np({fromObject:r.params})),o=new Py(e,n,void 0!==r.body?r.body:null,{headers:m,context:r.context,params:g,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const c=_i(o).pipe(S0(m=>this.handler.handle(m)));if(e instanceof Py||"events"===r.observe)return c;const u=c.pipe(Fp(m=>m instanceof tT));switch(r.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return u.pipe(or(m=>{if(null!==m.body&&!(m.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return m.body}));case"blob":return u.pipe(or(m=>{if(null!==m.body&&!(m.body instanceof Blob))throw new Error("Response is not a Blob.");return m.body}));case"text":return u.pipe(or(m=>{if(null!==m.body&&"string"!=typeof m.body)throw new Error("Response is not a string.");return m.body}));default:return u.pipe(or(m=>m.body))}case"response":return u;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(e,n={}){return this.request("DELETE",e,n)}get(e,n={}){return this.request("GET",e,n)}head(e,n={}){return this.request("HEAD",e,n)}jsonp(e,n){return this.request("JSONP",e,{params:(new Np).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,n={}){return this.request("OPTIONS",e,n)}patch(e,n,r={}){return this.request("PATCH",e,$I(r,n))}post(e,n,r={}){return this.request("POST",e,$I(r,n))}put(e,n,r={}){return this.request("PUT",e,$I(r,n))}}return t.\u0275fac=function(e){return new(e||t)(zt(e8))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();class c8{constructor(i,e){this.next=i,this.interceptor=e}handle(i){return this.interceptor.intercept(i,this.next)}}const u8=new hi("HTTP_INTERCEPTORS");let S$=(()=>{class t{intercept(e,n){return n.handle(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();const E$=/^\)\]\}',?\n/;let d8=(()=>{class t{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Lr(n=>{const r=this.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach((E,R)=>r.setRequestHeader(E,R.join(","))),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const E=e.detectContentTypeHeader();null!==E&&r.setRequestHeader("Content-Type",E)}if(e.responseType){const E=e.responseType.toLowerCase();r.responseType="json"!==E?E:"text"}const o=e.serializeBody();let c=null;const u=()=>{if(null!==c)return c;const E=r.statusText||"OK",R=new io(r.getAllResponseHeaders()),B=function k$(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(r)||e.url;return c=new zI({headers:R,status:r.status,statusText:E,url:B}),c},m=()=>{let{headers:E,status:R,statusText:B,url:K}=u(),q=null;204!==R&&(q=void 0===r.response?r.responseText:r.response),0===R&&(R=q?200:0);let Y=R>=200&&R<300;if("json"===e.responseType&&"string"==typeof q){const ce=q;q=q.replace(E$,"");try{q=""!==q?JSON.parse(q):null}catch(De){q=ce,Y&&(Y=!1,q={error:De,text:q})}}Y?(n.next(new tT({body:q,headers:E,status:R,statusText:B,url:K||void 0})),n.complete()):n.error(new l8({error:q,headers:E,status:R,statusText:B,url:K||void 0}))},g=E=>{const{url:R}=u(),B=new l8({error:E,status:r.status||0,statusText:r.statusText||"Unknown Error",url:R||void 0});n.error(B)};let x=!1;const S=E=>{x||(n.next(u()),x=!0);let R={type:Ds.DownloadProgress,loaded:E.loaded};E.lengthComputable&&(R.total=E.total),"text"===e.responseType&&!!r.responseText&&(R.partialText=r.responseText),n.next(R)},M=E=>{let R={type:Ds.UploadProgress,loaded:E.loaded};E.lengthComputable&&(R.total=E.total),n.next(R)};return r.addEventListener("load",m),r.addEventListener("error",g),r.addEventListener("timeout",g),r.addEventListener("abort",g),e.reportProgress&&(r.addEventListener("progress",S),null!==o&&r.upload&&r.upload.addEventListener("progress",M)),r.send(o),n.next({type:Ds.Sent}),()=>{r.removeEventListener("error",g),r.removeEventListener("abort",g),r.removeEventListener("load",m),r.removeEventListener("timeout",g),e.reportProgress&&(r.removeEventListener("progress",S),null!==o&&r.upload&&r.upload.removeEventListener("progress",M)),r.readyState!==r.DONE&&r.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(zt(MO))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();const WI=new hi("XSRF_COOKIE_NAME"),qI=new hi("XSRF_HEADER_NAME");class f8{}let D$=(()=>{class t{constructor(e,n,r){this.doc=e,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=TO(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(zt(ra),zt(gy),zt(WI))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})(),GI=(()=>{class t{constructor(e,n){this.tokenService=e,this.headerName=n}intercept(e,n){const r=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||r.startsWith("http://")||r.startsWith("https://"))return n.handle(e);const o=this.tokenService.getToken();return null!==o&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,o)})),n.handle(e)}}return t.\u0275fac=function(e){return new(e||t)(zt(f8),zt(qI))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})(),I$=(()=>{class t{constructor(e,n){this.backend=e,this.injector=n,this.chain=null}handle(e){if(null===this.chain){const n=this.injector.get(u8,[]);this.chain=n.reduceRight((r,o)=>new c8(r,o),this.backend)}return this.chain.handle(e)}}return t.\u0275fac=function(e){return new(e||t)(zt(t8),zt(ws))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})(),A$=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:GI,useClass:S$}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:WI,useValue:e.cookieName}:[],e.headerName?{provide:qI,useValue:e.headerName}:[]]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({providers:[GI,{provide:u8,useExisting:GI,multi:!0},{provide:f8,useClass:D$},{provide:WI,useValue:"XSRF-TOKEN"},{provide:qI,useValue:"X-XSRF-TOKEN"}]}),t})(),p8=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({providers:[$s,{provide:e8,useClass:I$},d8,{provide:t8,useExisting:d8}],imports:[[A$.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})();const Ws_apiUrl="http://localhost:5000/api/",Fr=Ws_apiUrl,Tm={headers:new io({"Content-Type":"application/json"})};let ll=(()=>{class t{constructor(e){this._http=e}getPlotDashboard(){return this._http.get(Fr+"getPlotDashboard",{})}getProjDashboard(){return this._http.get(Fr+"getProjDashboard",{})}getProjDetails(e){return this._http.get(Fr+"getProjDetails",{params:{id:e.toString()}})}getProfitSummary(){return this._http.get(Fr+"getProfitSummary",{})}getNovitaRecordsSummary(){return this._http.get(Fr+"getNovitaRecordsSummary",{})}getBranchesSummary(){return this._http.get(Fr+"getBranchesDBSummary",{})}getInvestorSummary(){return this._http.get(Fr+"getInvestorSummary",{})}getClientInventorySummary(){return this._http.get(Fr+"getClientInventorySummary",{})}getCashSummary(){return this._http.get(Fr+"getCashSummary",{})}addProject(e){const n=sessionStorage.getItem("role"),r=sessionStorage.getItem("userid"),o=e.value.location,c=e.value.status,{name:u,description:m,budget:g,enddate:x,landcost:S,taxes:M,commission:E,notes:R,coveredarea:B,type:K}=e.value,q=new Date(e.value.startdate),Y=this.formatDate(q);return this._http.post(Fr+"addProject",{name:u,location:o,status:c,description:m,budget:g,startdate:Y,enddate:x,landcost:S,taxes:M,commission:E,notes:R,coveredarea:B,type:K,role:n,userid:r},Tm)}updateProject(e){const n=e.value.location,r=e.value.status,{id:o,name:c,description:u,budget:m,enddate:g,landcost:x,taxes:S,commission:M,notes:E,coveredarea:R,type:B}=e.value,K=new Date(e.value.startdate),q=this.formatDate(K);return this._http.post(Fr+"updateProject",{id:o,name:c,location:n,status:r,description:u,budget:m,startdate:q,enddate:g,landcost:x,taxes:S,commission:M,notes:E,coveredarea:R,type:B},Tm)}getProjects(e){return this._http.get(Fr+"getProjects",{params:{type:e.toString()}})}getProjectsList(){return this._http.get(Fr+"getProjectsList")}getUserAllProjects(e){return this._http.get(Fr+"getUserAllProjects",{params:{userid:e.toString()}})}getUserProjects(e,n){return this._http.get(Fr+"getUserProjects",{params:{type:e.toString(),userid:n.toString()}})}getUsers(){return this._http.get(Fr+"getUsers")}assignProjecttoUsers(e,n,r){return this._http.post(Fr+"assignProjecttoUsers",{userid:e,projects:n,flag:r},Tm)}getUsersProjects(e,n){return this._http.get(Fr+"getUsersProjects",{params:{type:e,userid:n}})}getProjectTypes(){return this._http.get(Fr+"getProjectTypes")}getProjectsCombo(){return this._http.get(Fr+"getProjectsCombo")}deleteProject(e){return this._http.delete(`${Fr}deleteProject`,{body:{id:e}})}addProjectCost(e){const n=e.value.category,r=e.value.project,o=e.value.contractor,{description:c,amount:u,remarks:m}=e.value,g=new Date(e.value.paymentdate),x=this.formatDate(g);return this._http.post(Fr+"addProjectCost",{paymentdate:x,description:c,category:n,project:r,contractor:o,amount:u,remarks:m},Tm)}updateProjectCost(e){const n=e.value.category,r=e.value.project,o=e.value.contractor,{id:c,description:u,amount:m,remarks:g}=e.value,x=new Date(e.value.paymentdate),S=this.formatDate(x);return this._http.post(Fr+"updateProjectCost",{id:c,paymentdate:S,description:u,category:n,project:r,contractor:o,amount:m,remarks:g},Tm)}getProjectCost(e){return this._http.get(Fr+"getProjectCost",{params:{id:e.toString()}})}deleteProjectCost(e){return this._http.delete(`${Fr}deleteProjectCost`,{body:{id:e}})}getProjectsSale(e){return this._http.get(Fr+"getProjectSale",{params:{id:e.toString()}})}getProfitContribution(e){return this._http.get(Fr+"getProfitContribution",{params:{id:e.toString()}})}addProjectSale(e){const{project:n,sellingprice:r,taxes:o,commission:c,totalprice:u,netprofit:m}=e.value,g=new Date(e.value.sellingdate),x=this.formatDate(g);return this._http.post(Fr+"addProjectSale",{project:n,sellingdate:x,sellingprice:r,taxes:o,commission:c,totalprice:u,netprofit:m},Tm)}deleteProjectSale(e){return this._http.delete(`${Fr}deleteProjectSale`,{body:{id:e}})}updateProjectSale(e){const{id:n,project:r,sellingprice:o,taxes:c,commission:u,totalprice:m,netprofit:g}=e.value,x=new Date(e.value.sellingdate),S=this.formatDate(x);return this._http.post(Fr+"updateProjectSale",{id:n,project:r,sellingdate:S,sellingprice:o,taxes:c,commission:u,totalprice:m,netprofit:g},Tm)}formatDate(e){return`${e.getFullYear().toString().slice(-2)}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function M$(t,i){if(1&t){const e=Ie();f(0,"button",28),L("click",function(){const o=z(e).$implicit;return A(2).filterByYear(o)}),ee(1,"i",33),_(2),p()}if(2&t){const e=i.$implicit;po("active",A(2).selectedYear===e),v(2),hn(" ",e," ")}}function F$(t,i){if(1&t&&(f(0,"div",51)(1,"div",52)(2,"div",53)(3,"span",54),_(4,"Total Amount"),p(),f(5,"span",55),_(6),Ne(7,"currency"),p()(),f(8,"div",53)(9,"span",54),_(10,"Total Investment"),p(),f(11,"span",55),_(12),Ne(13,"currency"),p()(),f(14,"div",53)(15,"span",54),_(16,"Total Expenses"),p(),f(17,"span",55),_(18),Ne(19,"currency"),p()(),f(20,"div",53)(21,"span",54),_(22,"Remaining"),p(),f(23,"span",55),_(24),Ne(25,"currency"),p()(),f(26,"div",53)(27,"span",54),_(28,"Net"),p(),f(29,"span",55),_(30),Ne(31,"currency"),p()(),f(32,"div",53)(33,"span",54),_(34,"Assets"),p(),f(35,"span",55),_(36),Ne(37,"currency"),p()()()()),2&t){const e=i.$implicit,n=A(4);v(6),U(He(7,10,e.balance," ","symbol","1.0-0")),v(6),U(He(13,15,e.total_investment," ","symbol","1.0-0")),v(6),U(He(19,20,e.total_expenses," ","symbol","1.0-0")),v(5),po("positive",n.calculateRemaining(e)>=0)("negative",n.calculateRemaining(e)<0),v(1),hn(" ",He(25,25,n.calculateRemaining(e)," ","symbol","1.0-0")," "),v(6),U(He(31,30,n.calculateNet(e)," ","symbol","1.0-0")),v(6),U(He(37,35,e.assets," ","symbol","1.0-0"))}}function P$(t,i){1&t&&(f(0,"div",56),ee(1,"i",57),f(2,"p"),_(3,"No company records for this year"),p()())}function O$(t,i){if(1&t&&(f(0,"div",51)(1,"div",52)(2,"div",53)(3,"span",54),_(4,"Total Income"),p(),f(5,"span",58),_(6),Ne(7,"currency"),p()(),f(8,"div",53)(9,"span",54),_(10,"Total Expenses"),p(),f(11,"span",59),_(12),Ne(13,"currency"),p()(),f(14,"div",60)(15,"span",54),_(16,"Profit/Loss"),p(),f(17,"span",55),_(18),Ne(19,"currency"),p()()()()),2&t){const e=i.$implicit;v(6),U(He(7,7,e.totalincome," ","symbol","1.0-0")),v(6),U(He(13,12,e.totalexpense," ","symbol","1.0-0")),v(5),po("positive",e.totalprofit>=0)("negative",e.totalprofit<0),v(1),hn(" ",He(19,17,e.totalprofit," ","symbol","1.0-0")," ")}}function N$(t,i){1&t&&(f(0,"div",56),ee(1,"i",57),f(2,"p"),_(3,"No branch records for this year"),p()())}function L$(t,i){if(1&t&&(f(0,"div",36)(1,"div",37)(2,"div",38),ee(3,"i",39),_(4),p()(),f(5,"div",40)(6,"div",41)(7,"div",42)(8,"div",43),ee(9,"i",44),p(),f(10,"h4",45),_(11,"Company Records"),p()(),f(12,"div",46),D(13,F$,38,40,"div",47),D(14,P$,4,0,"div",48),p()(),f(15,"div",49)(16,"div",42)(17,"div",43),ee(18,"i",50),p(),f(19,"h4",45),_(20,"Branches Summary"),p()(),f(21,"div",46),D(22,O$,20,22,"div",47),D(23,N$,4,0,"div",48),p()()()()),2&t){const e=i.$implicit,n=A(3);v(4),hn(" Year ",e," "),v(9),T("ngForOf",n.getNovitaRecordByYear(e)),v(1),T("ngIf",0===n.getNovitaRecordByYear(e).length),v(8),T("ngForOf",n.getBranchRecordByYear(e)),v(1),T("ngIf",0===n.getBranchRecordByYear(e).length)}}function R$(t,i){if(1&t&&(f(0,"div",34),D(1,L$,24,5,"div",35),p()),2&t){const e=A(2);v(1),T("ngForOf",e.availableYears)}}function B$(t,i){if(1&t&&(f(0,"div",51)(1,"div",52)(2,"div",53)(3,"span",54),_(4,"Total Amount"),p(),f(5,"span",55),_(6),Ne(7,"currency"),p()(),f(8,"div",53)(9,"span",54),_(10,"Total Investment"),p(),f(11,"span",55),_(12),Ne(13,"currency"),p()(),f(14,"div",53)(15,"span",54),_(16,"Total Expenses"),p(),f(17,"span",55),_(18),Ne(19,"currency"),p()(),f(20,"div",53)(21,"span",54),_(22,"Remaining"),p(),f(23,"span",55),_(24),Ne(25,"currency"),p()(),f(26,"div",53)(27,"span",54),_(28,"Net"),p(),f(29,"span",55),_(30),Ne(31,"currency"),p()(),f(32,"div",53)(33,"span",54),_(34,"Assets"),p(),f(35,"span",55),_(36),Ne(37,"currency"),p()()()()),2&t){const e=i.$implicit,n=A(3);v(6),U(He(7,10,e.balance," ","symbol","1.0-0")),v(6),U(He(13,15,e.total_investment," ","symbol","1.0-0")),v(6),U(He(19,20,e.total_expenses," ","symbol","1.0-0")),v(5),po("positive",n.calculateRemaining(e)>=0)("negative",n.calculateRemaining(e)<0),v(1),hn(" ",He(25,25,n.calculateRemaining(e)," ","symbol","1.0-0")," "),v(6),U(He(31,30,n.calculateNet(e)," ","symbol","1.0-0")),v(6),U(He(37,35,e.assets," ","symbol","1.0-0"))}}function j$(t,i){1&t&&(f(0,"div",56),ee(1,"i",57),f(2,"p"),_(3,"No Novita records for this year"),p()())}function V$(t,i){if(1&t&&(f(0,"div",51)(1,"div",52)(2,"div",53)(3,"span",54),_(4,"Total Income"),p(),f(5,"span",58),_(6),Ne(7,"currency"),p()(),f(8,"div",53)(9,"span",54),_(10,"Total Expenses"),p(),f(11,"span",59),_(12),Ne(13,"currency"),p()(),f(14,"div",60)(15,"span",54),_(16,"Profit/Loss"),p(),f(17,"span",55),_(18),Ne(19,"currency"),p()()()()),2&t){const e=i.$implicit;v(6),U(He(7,7,e.totalincome," ","symbol","1.0-0")),v(6),U(He(13,12,e.totalexpense," ","symbol","1.0-0")),v(5),po("positive",e.totalprofit>=0)("negative",e.totalprofit<0),v(1),hn(" ",He(19,17,e.totalprofit," ","symbol","1.0-0")," ")}}function U$(t,i){1&t&&(f(0,"div",56),ee(1,"i",57),f(2,"p"),_(3,"No branch records for this year"),p()())}function H$(t,i){if(1&t&&(f(0,"div",34)(1,"div",36)(2,"div",37)(3,"div",38),ee(4,"i",39),_(5),p()(),f(6,"div",40)(7,"div",41)(8,"div",42)(9,"div",43),ee(10,"i",44),p(),f(11,"h4",45),_(12,"Company Records"),p()(),f(13,"div",46),D(14,B$,38,40,"div",47),D(15,j$,4,0,"div",48),p()(),f(16,"div",49)(17,"div",42)(18,"div",43),ee(19,"i",50),p(),f(20,"h4",45),_(21,"Branches Summary"),p(),f(22,"span",61),_(23),p()(),f(24,"div",46),D(25,V$,20,22,"div",47),D(26,U$,4,0,"div",48),p()()()()()),2&t){const e=A(2);v(5),hn(" Year ",e.selectedYear," "),v(9),T("ngForOf",e.filteredNrRecords),v(1),T("ngIf",0===e.filteredNrRecords.length),v(8),hn("Total Branches: ",e.br_branches,""),v(2),T("ngForOf",e.filteredBrRecords),v(1),T("ngIf",0===e.filteredBrRecords.length)}}function z$(t,i){if(1&t){const e=Ie();f(0,"div",25)(1,"div",26)(2,"div",27)(3,"button",28),L("click",function(){return z(e),A().selectAllYears()}),ee(4,"i",29),_(5," All Years "),p(),D(6,M$,3,3,"button",30),p()(),f(7,"div",31),D(8,R$,2,1,"div",32),D(9,H$,27,6,"div",32),p()()}if(2&t){const e=A();v(3),po("active",null===e.selectedYear),v(3),T("ngForOf",e.availableYears),v(2),T("ngIf",null===e.selectedYear),v(1),T("ngIf",null!==e.selectedYear)}}let $$=(()=>{class t{constructor(e){this._ps=e,this.total_res_proj=0,this.total_comm_proj=0,this.total_proj=0,this.res_prof=0,this.comm_prof=0,this.plot_prof=0,this.total_prof=0,this.bankamount=0,this.cash=0,this.investors=0,this.investment=0,this.clients=0,this.unitssold=0,this.plots=0,this.br_branches=0,this.availableYears=[],this.selectedYear=null,this.filteredNrRecords=[],this.filteredBrRecords=[]}ngOnInit(){this.getProjDashboard(),this.getProfitSummary(),this.getCashSummary(),this.getInvestorSummary(),this.getClientInventorySummary(),this.getPlotDashboard(),this.getBranchesSummary(),this.getNovitaRecordsSummary()}getProjDashboard(){this._ps.getProjDashboard().subscribe({next:e=>{this.total_res_proj=e.residential,this.total_comm_proj=e.commercial,this.total_proj=this.total_res_proj+this.total_comm_proj},error:e=>{console.error(e)}})}getProfitSummary(){this._ps.getProfitSummary().subscribe({next:e=>{var n,r,o;this.res_prof=null!==(n=e.resprofit)&&void 0!==n?n:0,this.comm_prof=null!==(r=e.commprofit)&&void 0!==r?r:0,this.plot_prof=null!==(o=e.plotprofit)&&void 0!==o?o:0,this.total_prof=Number(this.res_prof)+Number(this.comm_prof)+Number(this.plot_prof)},error:e=>{console.error(e)}})}calculateRemaining(e){return e.balance-e.total_investment-e.total_expenses}calculateNet(e){return Number(e.total_investment)+Number(this.calculateRemaining(e))}getNovitaRecordsSummary(){this._ps.getNovitaRecordsSummary().subscribe({next:e=>{this.nrSummaryArray=e,this.updateAvailableYears()},error:e=>{console.error(e)}})}getBranchesSummary(){this._ps.getBranchesSummary().subscribe({next:e=>{var n,r;this.brSummaryArray=e,this.br_branches=null!==(r=null===(n=e[0])||void 0===n?void 0:n.branches)&&void 0!==r?r:0,this.updateAvailableYears()},error:e=>{console.error(e)}})}updateAvailableYears(){const e=new Set;this.nrSummaryArray&&this.nrSummaryArray.length>0&&this.nrSummaryArray.forEach(r=>{r.year&&e.add(r.year)}),this.brSummaryArray&&this.brSummaryArray.length>0&&this.brSummaryArray.forEach(r=>{r.year&&e.add(r.year)});const n=Array.from(e).sort((r,o)=>o-r);JSON.stringify(this.availableYears)!==JSON.stringify(n)&&(this.availableYears=n,this.availableYears.length>0&&null===this.selectedYear&&(this.selectedYear=this.availableYears[0],this.filterByYear(this.selectedYear)))}filterByYear(e){this.selectedYear=e,this.filteredNrRecords=this.nrSummaryArray&&this.nrSummaryArray.length>0?this.nrSummaryArray.filter(n=>n.year===e):[],this.filteredBrRecords=this.brSummaryArray&&this.brSummaryArray.length>0?this.brSummaryArray.filter(n=>n.year===e):[]}selectAllYears(){this.selectedYear=null,this.filteredNrRecords=this.nrSummaryArray||[],this.filteredBrRecords=this.brSummaryArray||[]}getNovitaRecordByYear(e){return this.nrSummaryArray&&0!==this.nrSummaryArray.length?this.nrSummaryArray.filter(n=>n.year===e):[]}getBranchRecordByYear(e){return this.brSummaryArray&&0!==this.brSummaryArray.length?this.brSummaryArray.filter(n=>n.year===e):[]}getCashSummary(){this._ps.getCashSummary().subscribe({next:e=>{this.cash=e.res_novita,e.res_bank.forEach(n=>{this.bankamount=Number(this.bankamount)+Number(n.current_balance)})},error:e=>{console.error(e)}})}getInvestorSummary(){this._ps.getInvestorSummary().subscribe({next:e=>{var n,r;e.length>0&&(this.investors=null!==(n=e[0].investors)&&void 0!==n?n:0,this.investment=null!==(r=e[0].investment)&&void 0!==r?r:0)},error:e=>{console.error(e)}})}getClientInventorySummary(){this._ps.getClientInventorySummary().subscribe({next:e=>{var n,r;this.clients=null!==(n=e.res_client)&&void 0!==n?n:0,this.unitssold=null!==(r=e.totalunits)&&void 0!==r?r:0},error:e=>{console.error(e)}})}getPlotDashboard(){this._ps.getPlotDashboard().subscribe({next:e=>{this.plots=e[0].plot},error:e=>{console.error(e)}})}}return t.\u0275fac=function(e){return new(e||t)(te(ll))},t.\u0275cmp=dn({type:t,selectors:[["app-dashboard"]],decls:126,vars:50,consts:[[1,"dashboard-wrapper"],[1,"text-muted"],[1,"stats-row"],[1,"stat-card","capital-card"],[1,"stat-icon"],[1,"bi","bi-wallet2"],[1,"stat-content"],[1,"stat-title"],[1,"stat-details"],[1,"stat-item"],[1,"stat-label"],[1,"stat-value"],[1,"stat-card","projects-card"],[1,"bi","bi-building"],[1,"stat-item","highlight"],[1,"stat-value","large"],[1,"stat-card","plots-card"],[1,"bi","bi-grid-3x3-gap"],[1,"stat-card","investors-card"],[1,"bi","bi-people"],[1,"stat-card","profit-card"],[1,"bi","bi-graph-up-arrow"],[1,"stat-card","inventory-card"],[1,"bi","bi-box-seam"],["class","year-section",4,"ngIf"],[1,"year-section"],[1,"year-tabs-container"],[1,"year-tabs"],[1,"year-tab",3,"click"],[1,"bi","bi-calendar-event"],["class","year-tab",3,"active","click",4,"ngFor","ngForOf"],[1,"year-content"],["class","year-view",4,"ngIf"],[1,"bi","bi-calendar-check"],[1,"year-view"],["class","year-card",4,"ngFor","ngForOf"],[1,"year-card"],[1,"year-card-header"],[1,"year-badge"],[1,"bi","bi-calendar-range"],[1,"year-card-body"],[1,"year-section-card","novita-section"],[1,"section-header"],[1,"section-icon"],[1,"bi","bi-file-earmark-text"],[1,"section-title"],[1,"section-content"],["class","record-item",4,"ngFor","ngForOf"],["class","no-data-small",4,"ngIf"],[1,"year-section-card","branches-section"],[1,"bi","bi-diagram-3"],[1,"record-item"],[1,"record-grid"],[1,"record-field"],[1,"field-label"],[1,"field-value"],[1,"no-data-small"],[1,"bi","bi-inbox"],[1,"field-value","positive"],[1,"field-value","negative"],[1,"record-field","highlight-field"],[1,"section-badge"]],template:function(e,n){1&e&&(f(0,"div",0)(1,"h2",1),_(2,"Dashboard"),p(),ee(3,"hr"),f(4,"div",2)(5,"div",3)(6,"div",4),ee(7,"i",5),p(),f(8,"div",6)(9,"h3",7),_(10,"Capital"),p(),f(11,"div",8)(12,"div",9)(13,"span",10),_(14,"Bank Amount"),p(),f(15,"span",11),_(16),Ne(17,"currency"),p()(),f(18,"div",9)(19,"span",10),_(20,"At Hand"),p(),f(21,"span",11),_(22),Ne(23,"currency"),p()()()()(),f(24,"div",12)(25,"div",4),ee(26,"i",13),p(),f(27,"div",6)(28,"h3",7),_(29,"Projects Summary"),p(),f(30,"div",8)(31,"div",9)(32,"span",10),_(33,"Residential"),p(),f(34,"span",11),_(35),p()(),f(36,"div",9)(37,"span",10),_(38,"Commercial"),p(),f(39,"span",11),_(40),p()(),f(41,"div",14)(42,"span",10),_(43,"Total Projects"),p(),f(44,"span",15),_(45),p()()()()(),f(46,"div",16)(47,"div",4),ee(48,"i",17),p(),f(49,"div",6)(50,"h3",7),_(51,"Plots Summary"),p(),f(52,"div",8)(53,"div",14)(54,"span",10),_(55,"Total Plots"),p(),f(56,"span",15),_(57),p()()()()(),f(58,"div",18)(59,"div",4),ee(60,"i",19),p(),f(61,"div",6)(62,"h3",7),_(63,"Investors Summary"),p(),f(64,"div",8)(65,"div",9)(66,"span",10),_(67,"Total Investors"),p(),f(68,"span",11),_(69),p()(),f(70,"div",14)(71,"span",10),_(72,"Total Investment"),p(),f(73,"span",15),_(74),Ne(75,"currency"),p()()()()()(),f(76,"div",2)(77,"div",20)(78,"div",4),ee(79,"i",21),p(),f(80,"div",6)(81,"h3",7),_(82,"Profit Summary"),p(),f(83,"div",8)(84,"div",9)(85,"span",10),_(86,"Residential Projects"),p(),f(87,"span",11),_(88),Ne(89,"currency"),p()(),f(90,"div",9)(91,"span",10),_(92,"Commercial Projects"),p(),f(93,"span",11),_(94),Ne(95,"currency"),p()(),f(96,"div",9)(97,"span",10),_(98,"Plots"),p(),f(99,"span",11),_(100),Ne(101,"currency"),p()(),f(102,"div",14)(103,"span",10),_(104,"Total Profit"),p(),f(105,"span",15),_(106),Ne(107,"currency"),p()()()()(),f(108,"div",22)(109,"div",4),ee(110,"i",23),p(),f(111,"div",6)(112,"h3",7),_(113,"Commercial Inventory"),p(),f(114,"div",8)(115,"div",9)(116,"span",10),_(117,"Total Clients"),p(),f(118,"span",11),_(119),p()(),f(120,"div",14)(121,"span",10),_(122,"Units Sold"),p(),f(123,"span",15),_(124),p()()()()()(),D(125,z$,10,5,"div",24),p()),2&e&&(v(16),U(He(17,15,n.bankamount," ","symbol","1.0-0")),v(6),U(He(23,20,n.cash," ","symbol","1.0-0")),v(13),U(n.total_res_proj),v(5),U(n.total_comm_proj),v(5),U(n.total_proj),v(12),U(n.plots),v(12),U(n.investors),v(5),U(He(75,25,n.investment," ","symbol","1.0-0")),v(14),U(He(89,30,n.res_prof," ","symbol","1.0-0")),v(6),U(He(95,35,n.comm_prof," ","symbol","1.0-0")),v(6),U(He(101,40,n.plot_prof," ","symbol","1.0-0")),v(6),U(He(107,45,n.total_prof," ","symbol","1.0-0")),v(13),U(n.clients),v(5),U(n.unitssold),v(1),T("ngIf",n.availableYears.length>0))},directives:[Sn,nc],pipes:[dr],styles:['.dashboard-wrapper[_ngcontent-%COMP%]{padding:0 30px 30px}.stats-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));grid-gap:20px;gap:20px;margin-bottom:20px}.stat-card[_ngcontent-%COMP%]{background:white;border-radius:15px;padding:25px;box-shadow:0 4px 20px #00000014;transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;display:flex;gap:20px;align-items:flex-start}.stat-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:5px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.5),transparent);transform:translate(-100%);transition:transform .6s}.stat-card[_ngcontent-%COMP%]:hover:before{transform:translate(100%)}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 8px 30px #00000026}.stat-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.8rem;color:#fff;flex-shrink:0;box-shadow:0 4px 15px #0003}.capital-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%)}.projects-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%)}.plots-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#43e97b 0%,#38f9d7 100%)}.profit-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fa709a 0%,#fee140 100%)}.investors-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#30cfd0 0%,#330867 100%)}.inventory-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#a8edea 0%,#fed6e3 100%)}.stat-content[_ngcontent-%COMP%]{flex:1}.stat-title[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:600;margin:0 0 15px;color:#2d3748;letter-spacing:-.3px}.stat-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.stat-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid #e2e8f0}.stat-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.stat-item.highlight[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f6f8fa 0%,#e9ecef 100%);padding:12px 15px;border-radius:10px;margin-top:8px;border:none}.stat-label[_ngcontent-%COMP%]{font-size:.95rem;color:#64748b;font-weight:500}.stat-value[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;color:#1e293b}.stat-value.large[_ngcontent-%COMP%]{font-size:1.4rem;color:#667eea}.year-section[_ngcontent-%COMP%]{margin-top:30px}.year-tabs-container[_ngcontent-%COMP%]{margin-bottom:25px;background:white;border-radius:15px;padding:20px;box-shadow:0 4px 20px #00000014}.year-tabs[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;justify-content:flex-start;align-items:center}.year-tab[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 24px;border:2px solid #e2e8f0;background:white;border-radius:25px;font-size:.95rem;font-weight:600;color:#64748b;cursor:pointer;transition:all .3s ease;white-space:nowrap}.year-tab[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.year-tab[_ngcontent-%COMP%]:hover{border-color:#667eea;color:#667eea;background:#f8f9ff;transform:translateY(-2px);box-shadow:0 4px 12px #667eea33}.year-tab.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-color:#667eea;color:#fff;box-shadow:0 4px 15px #667eea4d}.year-tab.active[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 20px #667eea66}.year-content[_ngcontent-%COMP%]{width:100%}.year-view[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:25px}.year-card[_ngcontent-%COMP%]{background:white;border-radius:15px;padding:30px;box-shadow:0 4px 20px #00000014;transition:all .3s ease}.year-card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 30px #0000001f}.year-card-header[_ngcontent-%COMP%]{margin-bottom:25px;padding-bottom:20px;border-bottom:3px solid #e2e8f0}.year-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:10px;padding:12px 24px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border-radius:25px;font-size:1.3rem;font-weight:700;box-shadow:0 4px 15px #667eea4d}.year-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem}.year-card-body[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));grid-gap:20px;gap:20px}.year-section-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa 0%,#ffffff 100%);border-radius:12px;padding:25px;border:2px solid #e2e8f0;transition:all .3s ease}.year-section-card[_ngcontent-%COMP%]:hover{border-color:#667eea;box-shadow:0 4px 15px #667eea1a;transform:translateY(-2px)}.novita-section[_ngcontent-%COMP%]{border-left:4px solid #dd0f54}.branches-section[_ngcontent-%COMP%]{border-left:4px solid #9e27ae}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:20px;padding-bottom:15px;border-bottom:2px solid #e2e8f0}.section-icon[_ngcontent-%COMP%]{width:45px;height:45px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1.3rem;color:#fff;box-shadow:0 4px 12px #00000026}.novita-section[_ngcontent-%COMP%]   .section-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dd0f54 0%,#ff6b95 100%)}.branches-section[_ngcontent-%COMP%]   .section-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#9e27ae 0%,#ba55d3 100%)}.section-title[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700;margin:0;color:#2d3748;flex:1}.section-badge[_ngcontent-%COMP%]{padding:6px 12px;background:rgba(102,126,234,.1);color:#667eea;border-radius:20px;font-size:.85rem;font-weight:600}.section-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px}.no-data-small[_ngcontent-%COMP%]{text-align:center;padding:30px 20px;color:#94a3b8}.no-data-small[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem;margin-bottom:10px;opacity:.5}.no-data-small[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.95rem;margin:0}.detailed-card[_ngcontent-%COMP%]{background:white;border-radius:15px;padding:30px;box-shadow:0 4px 20px #00000014;transition:all .3s ease}.detailed-card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 30px #0000001f}.detailed-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;margin-bottom:25px;padding-bottom:20px;border-bottom:2px solid #e2e8f0}.detailed-icon[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.5rem;color:#fff;box-shadow:0 4px 15px #0003}.novita-card[_ngcontent-%COMP%]   .detailed-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dd0f54 0%,#ff6b95 100%)}.branches-card[_ngcontent-%COMP%]   .detailed-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#9e27ae 0%,#ba55d3 100%)}.detailed-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;margin:0;color:#2d3748}.detailed-subtitle[_ngcontent-%COMP%]{font-size:.9rem;color:#64748b;margin:5px 0 0}.detailed-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.record-item[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa 0%,#ffffff 100%);border-radius:12px;padding:20px;border:1px solid #e2e8f0;transition:all .3s ease}.record-item[_ngcontent-%COMP%]:hover{border-color:#667eea;box-shadow:0 4px 15px #667eea1a;transform:translate(5px)}.record-header[_ngcontent-%COMP%]{margin-bottom:15px;padding-bottom:10px;border-bottom:2px solid #e2e8f0}.record-year[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;color:#667eea;text-transform:uppercase;letter-spacing:1px}.record-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));grid-gap:15px;gap:15px}.record-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;padding:12px;background:white;border-radius:8px;border:1px solid #e2e8f0;transition:all .2s ease}.record-field[_ngcontent-%COMP%]:hover{border-color:#667eea;background:#f8f9ff}.record-field.highlight-field[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea15 0%,#764ba215 100%);border-color:#667eea}.field-label[_ngcontent-%COMP%]{font-size:.85rem;color:#64748b;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.field-value[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;color:#1e293b}.field-value.positive[_ngcontent-%COMP%]{color:#10b981}.field-value.negative[_ngcontent-%COMP%]{color:#ef4444}.no-data[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#94a3b8}.no-data[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:15px;opacity:.5}.no-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem;margin:0}@media (max-width: 1200px){.detailed-section[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 768px){.dashboard-wrapper[_ngcontent-%COMP%]{padding:0 15px 15px}.stats-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:15px}.stat-card[_ngcontent-%COMP%]{padding:20px}.stat-icon[_ngcontent-%COMP%]{width:50px;height:50px;font-size:1.5rem}.stat-title[_ngcontent-%COMP%]{font-size:1.1rem}.stat-value[_ngcontent-%COMP%]{font-size:1rem}.stat-value.large[_ngcontent-%COMP%]{font-size:1.2rem}.year-tabs-container[_ngcontent-%COMP%]{padding:15px}.year-tabs[_ngcontent-%COMP%]{justify-content:center}.year-tab[_ngcontent-%COMP%]{padding:10px 18px;font-size:.9rem}.year-card[_ngcontent-%COMP%]{padding:20px}.year-card-body[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:15px}.year-section-card[_ngcontent-%COMP%]{padding:20px}.section-title[_ngcontent-%COMP%]{font-size:1.2rem}.year-badge[_ngcontent-%COMP%]{font-size:1.1rem;padding:10px 20px}.record-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 480px){.stat-card[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.stat-icon[_ngcontent-%COMP%]{margin:0 auto}.stat-item[_ngcontent-%COMP%]{flex-direction:column;gap:5px;text-align:center}.detailed-header[_ngcontent-%COMP%]{flex-direction:column;text-align:center}}@keyframes fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.stat-card[_ngcontent-%COMP%], .detailed-card[_ngcontent-%COMP%]{animation:fadeInUp .6s ease-out}.stat-card[_ngcontent-%COMP%]:nth-child(1){animation-delay:.1s}.stat-card[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.stat-card[_ngcontent-%COMP%]:nth-child(3){animation-delay:.3s}.stat-card[_ngcontent-%COMP%]:nth-child(4){animation-delay:.4s}']}),t})(),h8=(()=>{class t{constructor(e,n){this._renderer=e,this._elementRef=n,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,n){this._renderer.setProperty(this._elementRef.nativeElement,e,n)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return t.\u0275fac=function(e){return new(e||t)(te(Ss),te(mr))},t.\u0275dir=Ln({type:t}),t})(),Sm=(()=>{class t extends h8{}return t.\u0275fac=function(){let i;return function(n){return(i||(i=hr(t)))(n||t)}}(),t.\u0275dir=Ln({type:t,features:[wr]}),t})();const Ra=new hi("NgValueAccessor"),G$={provide:Ra,useExisting:tr(()=>Ir),multi:!0},Y$=new hi("CompositionEventMode");let Ir=(()=>{class t extends h8{constructor(e,n,r){super(e,n),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function K$(){const t=fd()?fd().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",null==e?"":e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return t.\u0275fac=function(e){return new(e||t)(te(Ss),te(mr),te(Y$,8))},t.\u0275dir=Ln({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,n){1&e&&L("input",function(o){return n._handleInput(o.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(o){return n._compositionEnd(o.target.value)})},features:[Nn([G$]),wr]}),t})();function Lp(t){return null==t||0===t.length}function g8(t){return null!=t&&"number"==typeof t.length}const Ba=new hi("NgValidators"),Rp=new hi("NgAsyncValidators"),X$=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class jt{static min(i){return _8(i)}static max(i){return function v8(t){return i=>{if(Lp(i.value)||Lp(t))return null;const e=parseFloat(i.value);return!isNaN(e)&&e>t?{max:{max:t,actual:i.value}}:null}}(i)}static required(i){return y8(i)}static requiredTrue(i){return function b8(t){return!0===t.value?null:{required:!0}}(i)}static email(i){return function x8(t){return Lp(t.value)||X$.test(t.value)?null:{email:!0}}(i)}static minLength(i){return function w8(t){return i=>Lp(i.value)||!g8(i.value)?null:i.value.length<t?{minlength:{requiredLength:t,actualLength:i.value.length}}:null}(i)}static maxLength(i){return function C8(t){return i=>g8(i.value)&&i.value.length>t?{maxlength:{requiredLength:t,actualLength:i.value.length}}:null}(i)}static pattern(i){return function T8(t){if(!t)return nT;let i,e;return"string"==typeof t?(e="","^"!==t.charAt(0)&&(e+="^"),e+=t,"$"!==t.charAt(t.length-1)&&(e+="$"),i=new RegExp(e)):(e=t.toString(),i=t),n=>{if(Lp(n.value))return null;const r=n.value;return i.test(r)?null:{pattern:{requiredPattern:e,actualValue:r}}}}(i)}static nullValidator(i){return null}static compose(i){return A8(i)}static composeAsync(i){return M8(i)}}function _8(t){return i=>{if(Lp(i.value)||Lp(t))return null;const e=parseFloat(i.value);return!isNaN(e)&&e<t?{min:{min:t,actual:i.value}}:null}}function y8(t){return Lp(t.value)?{required:!0}:null}function nT(t){return null}function S8(t){return null!=t}function E8(t){const i=dm(t)?Ls(t):t;return fm(i),i}function k8(t){let i={};return t.forEach(e=>{i=null!=e?Object.assign(Object.assign({},i),e):i}),0===Object.keys(i).length?null:i}function D8(t,i){return i.map(e=>e(t))}function I8(t){return t.map(i=>function Q$(t){return!t.validate}(i)?i:e=>i.validate(e))}function A8(t){if(!t)return null;const i=t.filter(S8);return 0==i.length?null:function(e){return k8(D8(e,i))}}function KI(t){return null!=t?A8(I8(t)):null}function M8(t){if(!t)return null;const i=t.filter(S8);return 0==i.length?null:function(e){return function W$(...t){const i=Zb(t),{args:e,keys:n}=$O(t),r=new Lr(o=>{const{length:c}=e;if(!c)return void o.complete();const u=new Array(c);let m=c,g=c;for(let x=0;x<c;x++){let S=!1;_a(e[x]).subscribe(co(o,M=>{S||(S=!0,g--),u[x]=M},()=>m--,void 0,()=>{(!m||!S)&&(g||o.next(n?WO(n,u):u),o.complete())}))}});return i?r.pipe(_I(i)):r}(D8(e,i).map(E8)).pipe(or(k8))}}function YI(t){return null!=t?M8(I8(t)):null}function F8(t,i){return null===t?[i]:Array.isArray(t)?[...t,i]:[t,i]}function P8(t){return t._rawValidators}function O8(t){return t._rawAsyncValidators}function XI(t){return t?Array.isArray(t)?t:[t]:[]}function iT(t,i){return Array.isArray(t)?t.includes(i):t===i}function N8(t,i){const e=XI(i);return XI(t).forEach(r=>{iT(e,r)||e.push(r)}),e}function L8(t,i){return XI(i).filter(e=>!iT(t,e))}class R8{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(i){this._rawValidators=i||[],this._composedValidatorFn=KI(this._rawValidators)}_setAsyncValidators(i){this._rawAsyncValidators=i||[],this._composedAsyncValidatorFn=YI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(i){this._onDestroyCallbacks.push(i)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(i=>i()),this._onDestroyCallbacks=[]}reset(i){this.control&&this.control.reset(i)}hasError(i,e){return!!this.control&&this.control.hasError(i,e)}getError(i,e){return this.control?this.control.getError(i,e):null}}class gf extends R8{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class cl extends R8{get formDirective(){return null}get path(){return null}}class B8{constructor(i){this._cd=i}is(i){var e,n,r;return"submitted"===i?!!(null===(e=this._cd)||void 0===e?void 0:e.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[i])}}let Er=(()=>{class t extends B8{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(te(gf,2))},t.\u0275dir=Ln({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,n){2&e&&po("ng-untouched",n.is("untouched"))("ng-touched",n.is("touched"))("ng-pristine",n.is("pristine"))("ng-dirty",n.is("dirty"))("ng-valid",n.is("valid"))("ng-invalid",n.is("invalid"))("ng-pending",n.is("pending"))},features:[wr]}),t})(),Ur=(()=>{class t extends B8{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(te(cl,10))},t.\u0275dir=Ln({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,n){2&e&&po("ng-untouched",n.is("untouched"))("ng-touched",n.is("touched"))("ng-pristine",n.is("pristine"))("ng-dirty",n.is("dirty"))("ng-valid",n.is("valid"))("ng-invalid",n.is("invalid"))("ng-pending",n.is("pending"))("ng-submitted",n.is("submitted"))},features:[wr]}),t})();function oT(t,i){return[...i.path,t]}function Oy(t,i){ZI(t,i),i.valueAccessor.writeValue(t.value),function oW(t,i){i.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&V8(t,i)})}(t,i),function aW(t,i){const e=(n,r)=>{i.valueAccessor.writeValue(n),r&&i.viewToModelUpdate(n)};t.registerOnChange(e),i._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,i),function sW(t,i){i.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&V8(t,i),"submit"!==t.updateOn&&t.markAsTouched()})}(t,i),function rW(t,i){if(i.valueAccessor.setDisabledState){const e=n=>{i.valueAccessor.setDisabledState(n)};t.registerOnDisabledChange(e),i._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,i)}function sT(t,i,e=!0){const n=()=>{};i.valueAccessor&&(i.valueAccessor.registerOnChange(n),i.valueAccessor.registerOnTouched(n)),lT(t,i),t&&(i._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function aT(t,i){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(i)})}function ZI(t,i){const e=P8(t);null!==i.validator?t.setValidators(F8(e,i.validator)):"function"==typeof e&&t.setValidators([e]);const n=O8(t);null!==i.asyncValidator?t.setAsyncValidators(F8(n,i.asyncValidator)):"function"==typeof n&&t.setAsyncValidators([n]);const r=()=>t.updateValueAndValidity();aT(i._rawValidators,r),aT(i._rawAsyncValidators,r)}function lT(t,i){let e=!1;if(null!==t){if(null!==i.validator){const r=P8(t);if(Array.isArray(r)&&r.length>0){const o=r.filter(c=>c!==i.validator);o.length!==r.length&&(e=!0,t.setValidators(o))}}if(null!==i.asyncValidator){const r=O8(t);if(Array.isArray(r)&&r.length>0){const o=r.filter(c=>c!==i.asyncValidator);o.length!==r.length&&(e=!0,t.setAsyncValidators(o))}}}const n=()=>{};return aT(i._rawValidators,n),aT(i._rawAsyncValidators,n),e}function V8(t,i){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),i.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function U8(t,i){ZI(t,i)}function eA(t,i){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(i,e.currentValue)}function z8(t,i){t._syncPendingControls(),i.forEach(e=>{const n=e.control;"submit"===n.updateOn&&n._pendingChange&&(e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function tA(t,i){if(!i)return null;let e,n,r;return Array.isArray(i),i.forEach(o=>{o.constructor===Ir?e=o:function uW(t){return Object.getPrototypeOf(t.constructor)===Sm}(o)?n=o:r=o}),r||n||e||null}function nA(t,i){const e=t.indexOf(i);e>-1&&t.splice(e,1)}const Ny="VALID",cT="INVALID",F0="PENDING",Ly="DISABLED";function rA(t){return(uT(t)?t.validators:t)||null}function $8(t){return Array.isArray(t)?KI(t):t||null}function oA(t,i){return(uT(i)?i.asyncValidators:t)||null}function W8(t){return Array.isArray(t)?YI(t):t||null}function uT(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}const sA=t=>t instanceof Me,dT=t=>t instanceof Zn,q8=t=>t instanceof X8;function G8(t){return sA(t)?t.value:t.getRawValue()}function K8(t,i){const e=dT(t),n=t.controls;if(!(e?Object.keys(n):n).length)throw new Tn(1e3,"");if(!n[i])throw new Tn(1001,"")}function Y8(t,i){dT(t),t._forEachChild((n,r)=>{if(void 0===i[r])throw new Tn(1002,"")})}class aA{constructor(i,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=i,this._rawAsyncValidators=e,this._composedValidatorFn=$8(this._rawValidators),this._composedAsyncValidatorFn=W8(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(i){this._rawValidators=this._composedValidatorFn=i}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(i){this._rawAsyncValidators=this._composedAsyncValidatorFn=i}get parent(){return this._parent}get valid(){return this.status===Ny}get invalid(){return this.status===cT}get pending(){return this.status==F0}get disabled(){return this.status===Ly}get enabled(){return this.status!==Ly}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(i){this._rawValidators=i,this._composedValidatorFn=$8(i)}setAsyncValidators(i){this._rawAsyncValidators=i,this._composedAsyncValidatorFn=W8(i)}addValidators(i){this.setValidators(N8(i,this._rawValidators))}addAsyncValidators(i){this.setAsyncValidators(N8(i,this._rawAsyncValidators))}removeValidators(i){this.setValidators(L8(i,this._rawValidators))}removeAsyncValidators(i){this.setAsyncValidators(L8(i,this._rawAsyncValidators))}hasValidator(i){return iT(this._rawValidators,i)}hasAsyncValidator(i){return iT(this._rawAsyncValidators,i)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(i={}){this.touched=!0,this._parent&&!i.onlySelf&&this._parent.markAsTouched(i)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(i=>i.markAllAsTouched())}markAsUntouched(i={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!i.onlySelf&&this._parent._updateTouched(i)}markAsDirty(i={}){this.pristine=!1,this._parent&&!i.onlySelf&&this._parent.markAsDirty(i)}markAsPristine(i={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!i.onlySelf&&this._parent._updatePristine(i)}markAsPending(i={}){this.status=F0,!1!==i.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!i.onlySelf&&this._parent.markAsPending(i)}disable(i={}){const e=this._parentMarkedDirty(i.onlySelf);this.status=Ly,this.errors=null,this._forEachChild(n=>{n.disable(Object.assign(Object.assign({},i),{onlySelf:!0}))}),this._updateValue(),!1!==i.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},i),{skipPristineCheck:e})),this._onDisabledChange.forEach(n=>n(!0))}enable(i={}){const e=this._parentMarkedDirty(i.onlySelf);this.status=Ny,this._forEachChild(n=>{n.enable(Object.assign(Object.assign({},i),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:i.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},i),{skipPristineCheck:e})),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(i){this._parent&&!i.onlySelf&&(this._parent.updateValueAndValidity(i),i.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(i){this._parent=i}updateValueAndValidity(i={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ny||this.status===F0)&&this._runAsyncValidator(i.emitEvent)),!1!==i.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!i.onlySelf&&this._parent.updateValueAndValidity(i)}_updateTreeValidity(i={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(i)),this.updateValueAndValidity({onlySelf:!0,emitEvent:i.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ly:Ny}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(i){if(this.asyncValidator){this.status=F0,this._hasOwnPendingAsyncValidator=!0;const e=E8(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:i})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(i,e={}){this.errors=i,this._updateControlsErrors(!1!==e.emitEvent)}get(i){return function dW(t,i,e){if(null==i||(Array.isArray(i)||(i=i.split(e)),Array.isArray(i)&&0===i.length))return null;let n=t;return i.forEach(r=>{n=dT(n)?n.controls.hasOwnProperty(r)?n.controls[r]:null:q8(n)&&n.at(r)||null}),n}(this,i,".")}getError(i,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[i]:null}hasError(i,e){return!!this.getError(i,e)}get root(){let i=this;for(;i._parent;)i=i._parent;return i}_updateControlsErrors(i){this.status=this._calculateStatus(),i&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(i)}_initObservables(){this.valueChanges=new Et,this.statusChanges=new Et}_calculateStatus(){return this._allControlsDisabled()?Ly:this.errors?cT:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(F0)?F0:this._anyControlsHaveStatus(cT)?cT:Ny}_anyControlsHaveStatus(i){return this._anyControls(e=>e.status===i)}_anyControlsDirty(){return this._anyControls(i=>i.dirty)}_anyControlsTouched(){return this._anyControls(i=>i.touched)}_updatePristine(i={}){this.pristine=!this._anyControlsDirty(),this._parent&&!i.onlySelf&&this._parent._updatePristine(i)}_updateTouched(i={}){this.touched=this._anyControlsTouched(),this._parent&&!i.onlySelf&&this._parent._updateTouched(i)}_isBoxedValue(i){return"object"==typeof i&&null!==i&&2===Object.keys(i).length&&"value"in i&&"disabled"in i}_registerOnCollectionChange(i){this._onCollectionChange=i}_setUpdateStrategy(i){uT(i)&&null!=i.updateOn&&(this._updateOn=i.updateOn)}_parentMarkedDirty(i){return!i&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class Me extends aA{constructor(i=null,e,n){super(rA(e),oA(n,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(i),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),uT(e)&&e.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(i)?i.value:i)}setValue(i,e={}){this.value=this._pendingValue=i,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(i,e={}){this.setValue(i,e)}reset(i=this.defaultValue,e={}){this._applyFormState(i),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(i){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(i){this._onChange.push(i)}_unregisterOnChange(i){nA(this._onChange,i)}registerOnDisabledChange(i){this._onDisabledChange.push(i)}_unregisterOnDisabledChange(i){nA(this._onDisabledChange,i)}_forEachChild(i){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(i){this._isBoxedValue(i)?(this.value=this._pendingValue=i.value,i.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=i}}class Zn extends aA{constructor(i,e,n){super(rA(e),oA(n,e)),this.controls=i,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(i,e){return this.controls[i]?this.controls[i]:(this.controls[i]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(i,e,n={}){this.registerControl(i,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(i,e={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),delete this.controls[i],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(i,e,n={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),delete this.controls[i],e&&this.registerControl(i,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(i){return this.controls.hasOwnProperty(i)&&this.controls[i].enabled}setValue(i,e={}){Y8(this,i),Object.keys(i).forEach(n=>{K8(this,n),this.controls[n].setValue(i[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(i,e={}){null!=i&&(Object.keys(i).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(i[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(i={},e={}){this._forEachChild((n,r)=>{n.reset(i[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(i,e,n)=>(i[n]=G8(e),i))}_syncPendingControls(){let i=this._reduceChildren(!1,(e,n)=>!!n._syncPendingControls()||e);return i&&this.updateValueAndValidity({onlySelf:!0}),i}_forEachChild(i){Object.keys(this.controls).forEach(e=>{const n=this.controls[e];n&&i(n,e)})}_setUpControls(){this._forEachChild(i=>{i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(i){for(const e of Object.keys(this.controls)){const n=this.controls[e];if(this.contains(e)&&i(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(i,e,n)=>((e.enabled||this.disabled)&&(i[n]=e.value),i))}_reduceChildren(i,e){let n=i;return this._forEachChild((r,o)=>{n=e(n,r,o)}),n}_allControlsDisabled(){for(const i of Object.keys(this.controls))if(this.controls[i].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class X8 extends aA{constructor(i,e,n){super(rA(e),oA(n,e)),this.controls=i,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(i){return this.controls[i]}push(i,e={}){this.controls.push(i),this._registerControl(i),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(i,e,n={}){this.controls.splice(i,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(i,e={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(i,e,n={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),e&&(this.controls.splice(i,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(i,e={}){Y8(this,i),i.forEach((n,r)=>{K8(this,r),this.at(r).setValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(i,e={}){null!=i&&(i.forEach((n,r)=>{this.at(r)&&this.at(r).patchValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(i=[],e={}){this._forEachChild((n,r)=>{n.reset(i[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(i=>G8(i))}clear(i={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:i.emitEvent}))}_syncPendingControls(){let i=this.controls.reduce((e,n)=>!!n._syncPendingControls()||e,!1);return i&&this.updateValueAndValidity({onlySelf:!0}),i}_forEachChild(i){this.controls.forEach((e,n)=>{i(e,n)})}_updateValue(){this.value=this.controls.filter(i=>i.enabled||this.disabled).map(i=>i.value)}_anyControls(i){return this.controls.some(e=>e.enabled&&i(e))}_setUpControls(){this._forEachChild(i=>this._registerControl(i))}_allControlsDisabled(){for(const i of this.controls)if(i.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(i){i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange)}}const fW={provide:cl,useExisting:tr(()=>fT)},Ry=(()=>Promise.resolve(null))();let fT=(()=>{class t extends cl{constructor(e,n){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new Et,this.form=new Zn({},KI(e),YI(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Ry.then(()=>{const n=this._findContainer(e.path);e.control=n.registerControl(e.name,e.control),Oy(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Ry.then(()=>{const n=this._findContainer(e.path);n&&n.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Ry.then(()=>{const n=this._findContainer(e.path),r=new Zn({});U8(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Ry.then(()=>{const n=this._findContainer(e.path);n&&n.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,n){Ry.then(()=>{this.form.get(e.path).setValue(n)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,z8(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return t.\u0275fac=function(e){return new(e||t)(te(Ba,10),te(Rp,10))},t.\u0275dir=Ln({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,n){1&e&&L("submit",function(o){return n.onSubmit(o)})("reset",function(){return n.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Nn([fW]),wr]}),t})();const hW={provide:gf,useExisting:tr(()=>md)},Z8=(()=>Promise.resolve(null))();let md=(()=>{class t extends gf{constructor(e,n,r,o,c){super(),this._changeDetectorRef=c,this.control=new Me,this._registered=!1,this.update=new Et,this._parent=e,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=tA(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const n=e.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),eA(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Oy(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){Z8.then(()=>{var n;this.control.setValue(e,{emitViewToModelChange:!1}),null===(n=this._changeDetectorRef)||void 0===n||n.markForCheck()})}_updateDisabled(e){const n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;Z8.then(()=>{var o;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(o=this._changeDetectorRef)||void 0===o||o.markForCheck()})}_getPath(e){return this._parent?oT(e,this._parent):[e]}}return t.\u0275fac=function(e){return new(e||t)(te(cl,9),te(Ba,10),te(Rp,10),te(Ra,10),te(Wo,8))},t.\u0275dir=Ln({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Nn([hW]),wr,Vs]}),t})(),Hr=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ln({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const mW={provide:Ra,useExisting:tr(()=>qo),multi:!0};let qo=(()=>{class t extends Sm{writeValue(e){this.setProperty("value",null==e?"":e)}registerOnChange(e){this.onChange=n=>{e(""==n?null:parseFloat(n))}}}return t.\u0275fac=function(){let i;return function(n){return(i||(i=hr(t)))(n||t)}}(),t.\u0275dir=Ln({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,n){1&e&&L("input",function(o){return n.onChange(o.target.value)})("blur",function(){return n.onTouched()})},features:[Nn([mW]),wr]}),t})(),eL=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({}),t})();const lA=new hi("NgModelWithFormControlWarning"),bW={provide:cl,useExisting:tr(()=>Pr)};let Pr=(()=>{class t extends cl{constructor(e,n){super(),this.validators=e,this.asyncValidators=n,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Et,this._setValidators(e),this._setAsyncValidators(n)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(lT(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const n=this.form.get(e.path);return Oy(n,e),n.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),n}getControl(e){return this.form.get(e.path)}removeControl(e){sT(e.control||null,e,!1),nA(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,n){this.form.get(e.path).setValue(n)}onSubmit(e){return this.submitted=!0,z8(this.form,this.directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const n=e.control,r=this.form.get(e.path);n!==r&&(sT(n||null,e),sA(r)&&(Oy(r,e),e.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const n=this.form.get(e.path);U8(n,e),n.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const n=this.form.get(e.path);n&&function lW(t,i){return lT(t,i)}(n,e)&&n.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){ZI(this.form,this),this._oldForm&&lT(this._oldForm,this)}_checkFormPresent(){}}return t.\u0275fac=function(e){return new(e||t)(te(Ba,10),te(Rp,10))},t.\u0275dir=Ln({type:t,selectors:[["","formGroup",""]],hostBindings:function(e,n){1&e&&L("submit",function(o){return n.onSubmit(o)})("reset",function(){return n.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Nn([bW]),wr,Vs]}),t})();const CW={provide:gf,useExisting:tr(()=>zr)};let zr=(()=>{class t extends gf{constructor(e,n,r,o,c){super(),this._ngModelWarningConfig=c,this._added=!1,this.update=new Et,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=tA(0,o)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),eA(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return oT(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return t._ngModelWarningSentOnce=!1,t.\u0275fac=function(e){return new(e||t)(te(cl,13),te(Ba,10),te(Rp,10),te(Ra,10),te(lA,8))},t.\u0275dir=Ln({type:t,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Nn([CW]),wr,Vs]}),t})();let Em=(()=>{class t{constructor(){this._validator=nT}ngOnChanges(e){if(this.inputName in e){const n=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(n),this._validator=this._enabled?this.createValidator(n):nT,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ln({type:t,features:[Vs]}),t})();const FW={provide:Ba,useExisting:tr(()=>P0),multi:!0};let P0=(()=>{class t extends Em{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>function lL(t){return"number"==typeof t?t:parseFloat(t)}(e),this.createValidator=e=>_8(e)}}return t.\u0275fac=function(){let i;return function(n){return(i||(i=hr(t)))(n||t)}}(),t.\u0275dir=Ln({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,n){2&e&&Ai("min",n._enabled?n.min:null)},inputs:{min:"min"},features:[Nn([FW]),wr]}),t})();const PW={provide:Ba,useExisting:tr(()=>By),multi:!0};let By=(()=>{class t extends Em{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=e=>function AW(t){return null!=t&&!1!==t&&"false"!=`${t}`}(e),this.createValidator=e=>y8}enabled(e){return e}}return t.\u0275fac=function(){let i;return function(n){return(i||(i=hr(t)))(n||t)}}(),t.\u0275dir=Ln({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,n){2&e&&Ai("required",n._enabled?"":null)},inputs:{required:"required"},features:[Nn([PW]),wr]}),t})(),mL=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[eL]]}),t})(),O0=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[mL]}),t})(),jy=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:lA,useValue:e.warnOnNgModelWithFormControl}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[mL]}),t})(),pT=(()=>{class t{group(e,n=null){const r=this._reduceControls(e);let u,o=null,c=null;return null!=n&&(function jW(t){return void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn}(n)?(o=null!=n.validators?n.validators:null,c=null!=n.asyncValidators?n.asyncValidators:null,u=null!=n.updateOn?n.updateOn:void 0):(o=null!=n.validator?n.validator:null,c=null!=n.asyncValidator?n.asyncValidator:null)),new Zn(r,{asyncValidators:c,updateOn:u,validators:o})}control(e,n,r){return new Me(e,n,r)}array(e,n,r){const o=e.map(c=>this._createControl(c));return new X8(o,n,r)}_reduceControls(e){const n={};return Object.keys(e).forEach(r=>{n[r]=this._createControl(e[r])}),n}_createControl(e){return sA(e)||dT(e)||q8(e)?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:jy}),t})();const gL=Ws_apiUrl,VW={headers:new io({"Content-Type":"application/json"})};let _L=(()=>{class t{constructor(e){this._http=e}login(e,n){return this._http.post(gL+"login",{username:e,password:n},VW)}getAlowedModules(e){return this._http.get(gL+"getAlowedModules",{params:{username:e.toString()}})}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class Pn{static equals(i,e,n){return n?this.resolveFieldData(i,n)===this.resolveFieldData(e,n):this.equalsByValue(i,e)}static equalsByValue(i,e){if(i===e)return!0;if(i&&e&&"object"==typeof i&&"object"==typeof e){var o,c,u,n=Array.isArray(i),r=Array.isArray(e);if(n&&r){if((c=i.length)!=e.length)return!1;for(o=c;0!=o--;)if(!this.equalsByValue(i[o],e[o]))return!1;return!0}if(n!=r)return!1;var m=i instanceof Date,g=e instanceof Date;if(m!=g)return!1;if(m&&g)return i.getTime()==e.getTime();var x=i instanceof RegExp,S=e instanceof RegExp;if(x!=S)return!1;if(x&&S)return i.toString()==e.toString();var M=Object.keys(i);if((c=M.length)!==Object.keys(e).length)return!1;for(o=c;0!=o--;)if(!Object.prototype.hasOwnProperty.call(e,M[o]))return!1;for(o=c;0!=o--;)if(!this.equalsByValue(i[u=M[o]],e[u]))return!1;return!0}return i!=i&&e!=e}static resolveFieldData(i,e){if(i&&e){if(this.isFunction(e))return e(i);if(-1==e.indexOf("."))return i[e];{let n=e.split("."),r=i;for(let o=0,c=n.length;o<c;++o){if(null==r)return null;r=r[n[o]]}return r}}return null}static isFunction(i){return!!(i&&i.constructor&&i.call&&i.apply)}static reorderArray(i,e,n){i&&e!==n&&(n>=i.length&&(n%=i.length,e%=i.length),i.splice(n,0,i.splice(e,1)[0]))}static insertIntoOrderedArray(i,e,n,r){if(n.length>0){let o=!1;for(let c=0;c<n.length;c++)if(this.findIndexInList(n[c],r)>e){n.splice(c,0,i),o=!0;break}o||n.push(i)}else n.push(i)}static findIndexInList(i,e){let n=-1;if(e)for(let r=0;r<e.length;r++)if(e[r]==i){n=r;break}return n}static contains(i,e){if(null!=i&&e&&e.length)for(let n of e)if(this.equals(i,n))return!0;return!1}static removeAccents(i){return i&&i.search(/[\xC0-\xFF]/g)>-1&&(i=i.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),i}static isEmpty(i){return null==i||""===i||Array.isArray(i)&&0===i.length||!(i instanceof Date)&&"object"==typeof i&&0===Object.keys(i).length}static isNotEmpty(i){return!this.isEmpty(i)}}var vL=0;function N0(){return"pr_id_"+ ++vL}var ls=function UW(){let t=[];const r=o=>o&&parseInt(o.style.zIndex,10)||0;return{get:r,set:(o,c,u)=>{c&&(c.style.zIndex=String(((o,c)=>{let u=t.length>0?t[t.length-1]:{key:o,value:c},m=u.value+(u.key===o?0:c)+1;return t.push({key:o,value:m}),m})(o,u)))},clear:o=>{o&&((o=>{t=t.filter(c=>c.value!==o)})(r(o)),o.style.zIndex="")},getCurrent:()=>t.length>0?t[t.length-1].value:0}}();const yL=["*"];let Ea=(()=>{class t{}return t.STARTS_WITH="startsWith",t.CONTAINS="contains",t.NOT_CONTAINS="notContains",t.ENDS_WITH="endsWith",t.EQUALS="equals",t.NOT_EQUALS="notEquals",t.IN="in",t.LESS_THAN="lt",t.LESS_THAN_OR_EQUAL_TO="lte",t.GREATER_THAN="gt",t.GREATER_THAN_OR_EQUAL_TO="gte",t.BETWEEN="between",t.IS="is",t.IS_NOT="isNot",t.BEFORE="before",t.AFTER="after",t.DATE_IS="dateIs",t.DATE_IS_NOT="dateIsNot",t.DATE_BEFORE="dateBefore",t.DATE_AFTER="dateAfter",t})(),Bp=(()=>{class t{constructor(){this.ripple=!1,this.filterMatchModeOptions={text:[Ea.STARTS_WITH,Ea.CONTAINS,Ea.NOT_CONTAINS,Ea.ENDS_WITH,Ea.EQUALS,Ea.NOT_EQUALS],numeric:[Ea.EQUALS,Ea.NOT_EQUALS,Ea.LESS_THAN,Ea.LESS_THAN_OR_EQUAL_TO,Ea.GREATER_THAN,Ea.GREATER_THAN_OR_EQUAL_TO],date:[Ea.DATE_IS,Ea.DATE_IS_NOT,Ea.DATE_BEFORE,Ea.DATE_AFTER]},this.translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",emptyFilterMessage:"No results found"},this.zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100},this.translationSource=new Wi,this.translationObserver=this.translationSource.asObservable()}getTranslation(e){return this.translation[e]}setTranslation(e){this.translation=Object.assign(Object.assign({},this.translation),e),this.translationSource.next(this.translation)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Fl=(()=>{class t{}return t.STARTS_WITH="startsWith",t.CONTAINS="contains",t.NOT_CONTAINS="notContains",t.ENDS_WITH="endsWith",t.EQUALS="equals",t.NOT_EQUALS="notEquals",t.NO_FILTER="noFilter",t.LT="lt",t.LTE="lte",t.GT="gt",t.GTE="gte",t.IS="is",t.IS_NOT="isNot",t.BEFORE="before",t.AFTER="after",t.CLEAR="clear",t.APPLY="apply",t.MATCH_ALL="matchAll",t.MATCH_ANY="matchAny",t.ADD_RULE="addRule",t.REMOVE_RULE="removeRule",t.ACCEPT="accept",t.REJECT="reject",t.CHOOSE="choose",t.UPLOAD="upload",t.CANCEL="cancel",t.DAY_NAMES="dayNames",t.DAY_NAMES_SHORT="dayNamesShort",t.DAY_NAMES_MIN="dayNamesMin",t.MONTH_NAMES="monthNames",t.MONTH_NAMES_SHORT="monthNamesShort",t.FIRST_DAY_OF_WEEK="firstDayOfWeek",t.TODAY="today",t.WEEK_HEADER="weekHeader",t.WEAK="weak",t.MEDIUM="medium",t.STRONG="strong",t.PASSWORD_PROMPT="passwordPrompt",t.EMPTY_MESSAGE="emptyMessage",t.EMPTY_FILTER_MESSAGE="emptyFilterMessage",t})();var jp=(()=>{return(t=jp||(jp={}))[t.ACCEPT=0]="ACCEPT",t[t.REJECT=1]="REJECT",t[t.CANCEL=2]="CANCEL",jp;var t})();let Un=(()=>{class t{constructor(){this.requireConfirmationSource=new Wi,this.acceptConfirmationSource=new Wi,this.requireConfirmation$=this.requireConfirmationSource.asObservable(),this.accept=this.acceptConfirmationSource.asObservable()}confirm(e){return this.requireConfirmationSource.next(e),this}close(){return this.requireConfirmationSource.next(null),this}onAccept(){this.acceptConfirmationSource.next(null)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})(),bL=(()=>{class t{constructor(){this.filters={startsWith:(e,n,r)=>{if(null==n||""===n.trim())return!0;if(null==e)return!1;let o=Pn.removeAccents(n.toString()).toLocaleLowerCase(r);return Pn.removeAccents(e.toString()).toLocaleLowerCase(r).slice(0,o.length)===o},contains:(e,n,r)=>{if(null==n||"string"==typeof n&&""===n.trim())return!0;if(null==e)return!1;let o=Pn.removeAccents(n.toString()).toLocaleLowerCase(r);return-1!==Pn.removeAccents(e.toString()).toLocaleLowerCase(r).indexOf(o)},notContains:(e,n,r)=>{if(null==n||"string"==typeof n&&""===n.trim())return!0;if(null==e)return!1;let o=Pn.removeAccents(n.toString()).toLocaleLowerCase(r);return-1===Pn.removeAccents(e.toString()).toLocaleLowerCase(r).indexOf(o)},endsWith:(e,n,r)=>{if(null==n||""===n.trim())return!0;if(null==e)return!1;let o=Pn.removeAccents(n.toString()).toLocaleLowerCase(r),c=Pn.removeAccents(e.toString()).toLocaleLowerCase(r);return-1!==c.indexOf(o,c.length-o.length)},equals:(e,n,r)=>null==n||"string"==typeof n&&""===n.trim()||null!=e&&(e.getTime&&n.getTime?e.getTime()===n.getTime():Pn.removeAccents(e.toString()).toLocaleLowerCase(r)==Pn.removeAccents(n.toString()).toLocaleLowerCase(r)),notEquals:(e,n,r)=>!(null==n||"string"==typeof n&&""===n.trim()||null!=e&&(e.getTime&&n.getTime?e.getTime()===n.getTime():Pn.removeAccents(e.toString()).toLocaleLowerCase(r)==Pn.removeAccents(n.toString()).toLocaleLowerCase(r))),in:(e,n)=>{if(null==n||0===n.length)return!0;for(let r=0;r<n.length;r++)if(Pn.equals(e,n[r]))return!0;return!1},between:(e,n)=>null==n||null==n[0]||null==n[1]||null!=e&&(e.getTime?n[0].getTime()<=e.getTime()&&e.getTime()<=n[1].getTime():n[0]<=e&&e<=n[1]),lt:(e,n,r)=>null==n||null!=e&&(e.getTime&&n.getTime?e.getTime()<n.getTime():e<n),lte:(e,n,r)=>null==n||null!=e&&(e.getTime&&n.getTime?e.getTime()<=n.getTime():e<=n),gt:(e,n,r)=>null==n||null!=e&&(e.getTime&&n.getTime?e.getTime()>n.getTime():e>n),gte:(e,n,r)=>null==n||null!=e&&(e.getTime&&n.getTime?e.getTime()>=n.getTime():e>=n),is:(e,n,r)=>this.filters.equals(e,n,r),isNot:(e,n,r)=>this.filters.notEquals(e,n,r),before:(e,n,r)=>this.filters.lt(e,n,r),after:(e,n,r)=>this.filters.gt(e,n,r),dateIs:(e,n)=>null==n||null!=e&&e.toDateString()===n.toDateString(),dateIsNot:(e,n)=>null==n||null!=e&&e.toDateString()!==n.toDateString(),dateBefore:(e,n)=>null==n||null!=e&&e.getTime()<n.getTime(),dateAfter:(e,n)=>null==n||null!=e&&e.getTime()>n.getTime()}}filter(e,n,r,o,c){let u=[];if(e)for(let m of e)for(let g of n){let x=Pn.resolveFieldData(m,g);if(this.filters[o](x,r,c)){u.push(m);break}}return u}register(e,n){this.filters[e]=n}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),kn=(()=>{class t{constructor(){this.messageSource=new Wi,this.clearSource=new Wi,this.messageObserver=this.messageSource.asObservable(),this.clearObserver=this.clearSource.asObservable()}add(e){e&&this.messageSource.next(e)}addAll(e){e&&e.length&&this.messageSource.next(e)}clear(e){this.clearSource.next(e||null)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})(),pA=(()=>{class t{constructor(){this.clickSource=new Wi,this.clickObservable=this.clickSource.asObservable()}add(e){e&&this.clickSource.next(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),xL=(()=>{class t{}return t.AND="and",t.OR="or",t})(),HW=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=dn({type:t,selectors:[["p-header"]],ngContentSelectors:yL,decls:1,vars:0,template:function(e,n){1&e&&(mu(),Sl(0))},encapsulation:2}),t})(),wL=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=dn({type:t,selectors:[["p-footer"]],ngContentSelectors:yL,decls:1,vars:0,template:function(e,n){1&e&&(mu(),Sl(0))},encapsulation:2}),t})(),zn=(()=>{class t{constructor(e){this.template=e}getType(){return this.name}}return t.\u0275fac=function(e){return new(e||t)(te(Rc))},t.\u0275dir=Ln({type:t,selectors:[["","pTemplate",""]],inputs:{type:"type",name:["pTemplate","name"]}}),t})(),Uc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro]]}),t})(),We=(()=>{class t{static addClass(e,n){e.classList?e.classList.add(n):e.className+=" "+n}static addMultipleClasses(e,n){if(e.classList){let r=n.trim().split(" ");for(let o=0;o<r.length;o++)e.classList.add(r[o])}else{let r=n.split(" ");for(let o=0;o<r.length;o++)e.className+=" "+r[o]}}static removeClass(e,n){e.classList?e.classList.remove(n):e.className=e.className.replace(new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi")," ")}static hasClass(e,n){return e.classList?e.classList.contains(n):new RegExp("(^| )"+n+"( |$)","gi").test(e.className)}static siblings(e){return Array.prototype.filter.call(e.parentNode.children,function(n){return n!==e})}static find(e,n){return Array.from(e.querySelectorAll(n))}static findSingle(e,n){return e?e.querySelector(n):null}static index(e){let n=e.parentNode.childNodes,r=0;for(var o=0;o<n.length;o++){if(n[o]==e)return r;1==n[o].nodeType&&r++}return-1}static indexWithinGroup(e,n){let r=e.parentNode?e.parentNode.childNodes:[],o=0;for(var c=0;c<r.length;c++){if(r[c]==e)return o;r[c].attributes&&r[c].attributes[n]&&1==r[c].nodeType&&o++}return-1}static relativePosition(e,n){let r=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e);const o=n.offsetHeight,c=n.getBoundingClientRect(),u=this.getViewport();let m,g;c.top+o+r.height>u.height?(m=-1*r.height,e.style.transformOrigin="bottom",c.top+m<0&&(m=-1*c.top)):(m=o,e.style.transformOrigin="top"),g=r.width>u.width?-1*c.left:c.left+r.width>u.width?-1*(c.left+r.width-u.width):0,e.style.top=m+"px",e.style.left=g+"px"}static absolutePosition(e,n){let E,R,r=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),o=r.height,c=r.width,u=n.offsetHeight,m=n.offsetWidth,g=n.getBoundingClientRect(),x=this.getWindowScrollTop(),S=this.getWindowScrollLeft(),M=this.getViewport();g.top+u+o>M.height?(E=g.top+x-o,e.style.transformOrigin="bottom",E<0&&(E=x)):(E=u+g.top+x,e.style.transformOrigin="top"),R=g.left+c>M.width?Math.max(0,g.left+S+m-c):g.left+S,e.style.top=E+"px",e.style.left=R+"px"}static getParents(e,n=[]){return null===e.parentNode?n:this.getParents(e.parentNode,n.concat([e.parentNode]))}static getScrollableParents(e){let n=[];if(e){let r=this.getParents(e);const o=/(auto|scroll)/,c=u=>{let m=window.getComputedStyle(u,null);return o.test(m.getPropertyValue("overflow"))||o.test(m.getPropertyValue("overflowX"))||o.test(m.getPropertyValue("overflowY"))};for(let u of r){let m=1===u.nodeType&&u.dataset.scrollselectors;if(m){let g=m.split(",");for(let x of g){let S=this.findSingle(u,x);S&&c(S)&&n.push(S)}}9!==u.nodeType&&c(u)&&n.push(u)}}return n}static getHiddenElementOuterHeight(e){e.style.visibility="hidden",e.style.display="block";let n=e.offsetHeight;return e.style.display="none",e.style.visibility="visible",n}static getHiddenElementOuterWidth(e){e.style.visibility="hidden",e.style.display="block";let n=e.offsetWidth;return e.style.display="none",e.style.visibility="visible",n}static getHiddenElementDimensions(e){let n={};return e.style.visibility="hidden",e.style.display="block",n.width=e.offsetWidth,n.height=e.offsetHeight,e.style.display="none",e.style.visibility="visible",n}static scrollInView(e,n){let r=getComputedStyle(e).getPropertyValue("borderTopWidth"),o=r?parseFloat(r):0,c=getComputedStyle(e).getPropertyValue("paddingTop"),u=c?parseFloat(c):0,m=e.getBoundingClientRect(),x=n.getBoundingClientRect().top+document.body.scrollTop-(m.top+document.body.scrollTop)-o-u,S=e.scrollTop,M=e.clientHeight,E=this.getOuterHeight(n);x<0?e.scrollTop=S+x:x+E>M&&(e.scrollTop=S+x-M+E)}static fadeIn(e,n){e.style.opacity=0;let r=+new Date,o=0,c=function(){o=+e.style.opacity.replace(",",".")+((new Date).getTime()-r)/n,e.style.opacity=o,r=+new Date,+o<1&&(window.requestAnimationFrame&&requestAnimationFrame(c)||setTimeout(c,16))};c()}static fadeOut(e,n){var r=1,u=50/n;let m=setInterval(()=>{(r-=u)<=0&&(r=0,clearInterval(m)),e.style.opacity=r},50)}static getWindowScrollTop(){let e=document.documentElement;return(window.pageYOffset||e.scrollTop)-(e.clientTop||0)}static getWindowScrollLeft(){let e=document.documentElement;return(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}static matches(e,n){var r=Element.prototype;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(c){return-1!==[].indexOf.call(document.querySelectorAll(c),this)}).call(e,n)}static getOuterWidth(e,n){let r=e.offsetWidth;if(n){let o=getComputedStyle(e);r+=parseFloat(o.marginLeft)+parseFloat(o.marginRight)}return r}static getHorizontalPadding(e){let n=getComputedStyle(e);return parseFloat(n.paddingLeft)+parseFloat(n.paddingRight)}static getHorizontalMargin(e){let n=getComputedStyle(e);return parseFloat(n.marginLeft)+parseFloat(n.marginRight)}static innerWidth(e){let n=e.offsetWidth,r=getComputedStyle(e);return n+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),n}static width(e){let n=e.offsetWidth,r=getComputedStyle(e);return n-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),n}static getInnerHeight(e){let n=e.offsetHeight,r=getComputedStyle(e);return n+=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),n}static getOuterHeight(e,n){let r=e.offsetHeight;if(n){let o=getComputedStyle(e);r+=parseFloat(o.marginTop)+parseFloat(o.marginBottom)}return r}static getHeight(e){let n=e.offsetHeight,r=getComputedStyle(e);return n-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),n}static getWidth(e){let n=e.offsetWidth,r=getComputedStyle(e);return n-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),n}static getViewport(){let e=window,n=document,r=n.documentElement,o=n.getElementsByTagName("body")[0];return{width:e.innerWidth||r.clientWidth||o.clientWidth,height:e.innerHeight||r.clientHeight||o.clientHeight}}static getOffset(e){var n=e.getBoundingClientRect();return{top:n.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:n.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(e,n){let r=e.parentNode;if(!r)throw"Can't replace element";return r.replaceChild(n,e)}static getUserAgent(){return navigator.userAgent}static isIE(){var e=window.navigator.userAgent;return e.indexOf("MSIE ")>0||(e.indexOf("Trident/")>0?(e.indexOf("rv:"),!0):e.indexOf("Edge/")>0)}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(e,n){if(this.isElement(n))n.appendChild(e);else{if(!n.el||!n.el.nativeElement)throw"Cannot append "+n+" to "+e;n.el.nativeElement.appendChild(e)}}static removeChild(e,n){if(this.isElement(n))n.removeChild(e);else{if(!n.el||!n.el.nativeElement)throw"Cannot remove "+e+" from "+n;n.el.nativeElement.removeChild(e)}}static removeElement(e){"remove"in Element.prototype?e.remove():e.parentNode.removeChild(e)}static isElement(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}static calculateScrollbarWidth(e){if(e){let n=getComputedStyle(e);return e.offsetWidth-e.clientWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.borderRightWidth)}{if(null!==this.calculatedScrollbarWidth)return this.calculatedScrollbarWidth;let n=document.createElement("div");n.className="p-scrollbar-measure",document.body.appendChild(n);let r=n.offsetWidth-n.clientWidth;return document.body.removeChild(n),this.calculatedScrollbarWidth=r,r}}static calculateScrollbarHeight(){if(null!==this.calculatedScrollbarHeight)return this.calculatedScrollbarHeight;let e=document.createElement("div");e.className="p-scrollbar-measure",document.body.appendChild(e);let n=e.offsetHeight-e.clientHeight;return document.body.removeChild(e),this.calculatedScrollbarWidth=n,n}static invokeElementMethod(e,n,r){e[n].apply(e,r)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(e){}}static getBrowser(){if(!this.browser){let e=this.resolveUserAgent();this.browser={},e.browser&&(this.browser[e.browser]=!0,this.browser.version=e.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let e=navigator.userAgent.toLowerCase(),n=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:n[1]||"",version:n[2]||"0"}}static isInteger(e){return Number.isInteger?Number.isInteger(e):"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}static isHidden(e){return null===e.offsetParent}static getFocusableElements(e){let n=t.find(e,'button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),\n                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]):not(.p-disabled)'),r=[];for(let o of n)"none"!=getComputedStyle(o).display&&"hidden"!=getComputedStyle(o).visibility&&r.push(o);return r}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}}return t.zindex=1e3,t.calculatedScrollbarWidth=null,t.calculatedScrollbarHeight=null,t})();class hA{constructor(i,e=(()=>{})){this.element=i,this.listener=e}bindScrollListener(){this.scrollableParents=We.getScrollableParents(this.element);for(let i=0;i<this.scrollableParents.length;i++)this.scrollableParents[i].addEventListener("scroll",this.listener)}unbindScrollListener(){if(this.scrollableParents)for(let i=0;i<this.scrollableParents.length;i++)this.scrollableParents[i].removeEventListener("scroll",this.listener)}destroy(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}let Vp=(()=>{class t{constructor(e,n,r){this.el=e,this.zone=n,this.config=r}ngAfterViewInit(){this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.onMouseDown.bind(this),this.el.nativeElement.addEventListener("mousedown",this.mouseDownListener)})}onMouseDown(e){let n=this.getInk();if(!n||"none"===getComputedStyle(n,null).display)return;if(We.removeClass(n,"p-ink-active"),!We.getHeight(n)&&!We.getWidth(n)){let u=Math.max(We.getOuterWidth(this.el.nativeElement),We.getOuterHeight(this.el.nativeElement));n.style.height=u+"px",n.style.width=u+"px"}let r=We.getOffset(this.el.nativeElement),o=e.pageX-r.left+document.body.scrollTop-We.getWidth(n)/2,c=e.pageY-r.top+document.body.scrollLeft-We.getHeight(n)/2;n.style.top=c+"px",n.style.left=o+"px",We.addClass(n,"p-ink-active")}getInk(){for(let e=0;e<this.el.nativeElement.children.length;e++)if(-1!==this.el.nativeElement.children[e].className.indexOf("p-ink"))return this.el.nativeElement.children[e];return null}resetInk(){let e=this.getInk();e&&We.removeClass(e,"p-ink-active")}onAnimationEnd(e){We.removeClass(e.currentTarget,"p-ink-active")}create(){let e=document.createElement("span");e.className="p-ink",this.el.nativeElement.appendChild(e),this.animationListener=this.onAnimationEnd.bind(this),e.addEventListener("animationend",this.animationListener)}remove(){let e=this.getInk();e&&(this.el.nativeElement.removeEventListener("mousedown",this.mouseDownListener),e.removeEventListener("animationend",this.animationListener),We.removeElement(e))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(gr),te(Bp,8))},t.\u0275dir=Ln({type:t,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"]}),t})(),_f=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro]]}),t})();class CL{}const vf="*";function km(t,i){return{type:7,name:t,definitions:i,options:{}}}function Pl(t,i=null){return{type:4,styles:i,timings:t}}function TL(t,i=null){return{type:2,steps:t,options:i}}function cs(t){return{type:6,styles:t,offset:null}}function SL(t,i,e){return{type:0,name:t,styles:i,options:e}}function ul(t,i,e=null){return{type:1,expr:t,animation:i,options:e}}function L0(t,i=null){return{type:8,animation:t,options:i}}function $W(t=null){return{type:9,options:t}}function R0(t,i=null){return{type:10,animation:t,options:i}}function WW(t,i,e=null){return{type:11,selector:t,animation:i,options:e}}function EL(t){Promise.resolve(null).then(t)}class Vy{constructor(i=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=i+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(i=>i()),this._onDoneFns=[])}onStart(i){this._onStartFns.push(i)}onDone(i){this._onDoneFns.push(i)}onDestroy(i){this._onDestroyFns.push(i)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){EL(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(i=>i()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(i=>i()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(i){this._position=this.totalTime?i*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(i){const e="start"==i?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class kL{constructor(i){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=i;let e=0,n=0,r=0;const o=this.players.length;0==o?EL(()=>this._onFinish()):this.players.forEach(c=>{c.onDone(()=>{++e==o&&this._onFinish()}),c.onDestroy(()=>{++n==o&&this._onDestroy()}),c.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((c,u)=>Math.max(c,u.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(i=>i()),this._onDoneFns=[])}init(){this.players.forEach(i=>i.init())}onStart(i){this._onStartFns.push(i)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(i=>i()),this._onStartFns=[])}onDone(i){this._onDoneFns.push(i)}onDestroy(i){this._onDestroyFns.push(i)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(i=>i.play())}pause(){this.players.forEach(i=>i.pause())}restart(){this.players.forEach(i=>i.restart())}finish(){this._onFinish(),this.players.forEach(i=>i.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(i=>i.destroy()),this._onDestroyFns.forEach(i=>i()),this._onDestroyFns=[])}reset(){this.players.forEach(i=>i.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(i){const e=i*this.totalTime;this.players.forEach(n=>{const r=n.totalTime?Math.min(1,e/n.totalTime):1;n.setPosition(r)})}getPosition(){const i=this.players.reduce((e,n)=>null===e||n.totalTime>e.totalTime?n:e,null);return null!=i?i.getPosition():0}beforeDestroy(){this.players.forEach(i=>{i.beforeDestroy&&i.beforeDestroy()})}triggerCallback(i){const e="start"==i?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}const DL=["container"],qW=function(t,i,e,n){return{"pi-info-circle":t,"pi-exclamation-triangle":i,"pi-times-circle":e,"pi-check":n}};function GW(t,i){if(1&t&&(ni(0),ee(1,"span",6),f(2,"div",7)(3,"div",8),_(4),p(),f(5,"div",9),_(6),p()(),Si()),2&t){const e=A();v(1),Ji("p-toast-message-icon pi"+(e.message.icon?" "+e.message.icon:"")),T("ngClass",Dp(5,qW,"info"==e.message.severity,"warn"==e.message.severity,"error"==e.message.severity,"success"==e.message.severity)),v(3),U(e.message.summary),v(2),U(e.message.detail)}}function KW(t,i){1&t&&Jn(0)}function YW(t,i){if(1&t){const e=Ie();f(0,"button",10),L("click",function(r){return z(e),A().onCloseIconClick(r)})("keydown.enter",function(r){return z(e),A().onCloseIconClick(r)}),ee(1,"span",11),p()}}const XW=function(t){return[t,"p-toast-message"]},QW=function(t,i,e,n){return{showTransformParams:t,hideTransformParams:i,showTransitionParams:e,hideTransitionParams:n}},JW=function(t){return{value:"visible",params:t}},ZW=function(t){return{$implicit:t}};function eq(t,i){if(1&t){const e=Ie();f(0,"p-toastItem",3),L("onClose",function(r){return z(e),A().onMessageClose(r)})("@toastAnimation.start",function(r){return z(e),A().onAnimationStart(r)})("@toastAnimation.done",function(r){return z(e),A().onAnimationEnd(r)}),p()}if(2&t){const e=i.$implicit,n=i.index,r=A();T("message",e)("index",n)("template",r.template)("@toastAnimation",void 0)("showTransformOptions",r.showTransformOptions)("hideTransformOptions",r.hideTransformOptions)("showTransitionOptions",r.showTransitionOptions)("hideTransitionOptions",r.hideTransitionOptions)}}let tq=(()=>{class t{constructor(e){this.zone=e,this.onClose=new Et}ngAfterViewInit(){this.initTimeout()}initTimeout(){this.message.sticky||this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>{this.onClose.emit({index:this.index,message:this.message})},this.message.life||3e3)})}clearTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}onMouseEnter(){this.clearTimeout()}onMouseLeave(){this.initTimeout()}onCloseIconClick(e){this.clearTimeout(),this.onClose.emit({index:this.index,message:this.message}),e.preventDefault()}ngOnDestroy(){this.clearTimeout()}}return t.\u0275fac=function(e){return new(e||t)(te(gr))},t.\u0275cmp=dn({type:t,selectors:[["p-toastItem"]],viewQuery:function(e,n){if(1&e&&Mt(DL,5),2&e){let r;xt(r=wt())&&(n.containerViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{message:"message",index:"index",template:"template",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onClose:"onClose"},decls:6,vars:21,consts:[[3,"ngClass","mouseenter","mouseleave"],["container",""],["role","alert","aria-live","assertive","aria-atomic","true",1,"p-toast-message-content",3,"ngClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["type","button","class","p-toast-icon-close p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[3,"ngClass"],[1,"p-toast-message-text"],[1,"p-toast-summary"],[1,"p-toast-detail"],["type","button","pRipple","",1,"p-toast-icon-close","p-link",3,"click","keydown.enter"],[1,"p-toast-icon-close-icon","pi","pi-times"]],template:function(e,n){1&e&&(f(0,"div",0,1),L("mouseenter",function(){return n.onMouseEnter()})("mouseleave",function(){return n.onMouseLeave()}),f(2,"div",2),D(3,GW,7,10,"ng-container",3),D(4,KW,1,0,"ng-container",4),D(5,YW,2,0,"button",5),p()()),2&e&&(Ji(n.message.styleClass),T("ngClass",Ei(10,XW,"p-toast-message-"+n.message.severity))("@messageState",Ei(17,JW,Dp(12,QW,n.showTransformOptions,n.hideTransformOptions,n.showTransitionOptions,n.hideTransitionOptions))),Ai("id",n.message.id),v(2),T("ngClass",n.message.contentStyleClass),v(1),T("ngIf",!n.template),v(1),T("ngTemplateOutlet",n.template)("ngTemplateOutletContext",Ei(19,ZW,n.message)),v(1),T("ngIf",!1!==n.message.closable))},directives:[Na,Sn,ic,Vp],encapsulation:2,data:{animation:[km("messageState",[SL("visible",cs({transform:"translateY(0)",opacity:1})),ul("void => *",[cs({transform:"{{showTransformParams}}",opacity:0}),Pl("{{showTransitionParams}}")]),ul("* => void",[Pl("{{hideTransitionParams}}",cs({height:0,opacity:0,transform:"{{hideTransformParams}}"}))])])]},changeDetection:0}),t})(),fr=(()=>{class t{constructor(e,n,r){this.messageService=e,this.cd=n,this.config=r,this.autoZIndex=!0,this.baseZIndex=0,this.position="top-right",this.preventOpenDuplicates=!1,this.preventDuplicates=!1,this.showTransformOptions="translateY(100%)",this.hideTransformOptions="translateY(-100%)",this.showTransitionOptions="300ms ease-out",this.hideTransitionOptions="250ms ease-in",this.onClose=new Et,this.id=N0()}ngOnInit(){this.messageSubscription=this.messageService.messageObserver.subscribe(e=>{if(e)if(e instanceof Array){const n=e.filter(r=>this.canAdd(r));this.add(n)}else this.canAdd(e)&&this.add([e])}),this.clearSubscription=this.messageService.clearObserver.subscribe(e=>{e?this.key===e&&(this.messages=null):this.messages=null,this.cd.markForCheck()})}ngAfterViewInit(){this.breakpoints&&this.createStyle()}add(e){this.messages=this.messages?[...this.messages,...e]:[...e],this.preventDuplicates&&(this.messagesArchieve=this.messagesArchieve?[...this.messagesArchieve,...e]:[...e]),this.cd.markForCheck()}canAdd(e){let n=this.key===e.key;return n&&this.preventOpenDuplicates&&(n=!this.containsMessage(this.messages,e)),n&&this.preventDuplicates&&(n=!this.containsMessage(this.messagesArchieve,e)),n}containsMessage(e,n){return!!e&&null!=e.find(r=>r.summary===n.summary&&r.detail==n.detail&&r.severity===n.severity)}ngAfterContentInit(){this.templates.forEach(e=>{e.getType(),this.template=e.template})}onMessageClose(e){this.messages.splice(e.index,1),this.onClose.emit({message:e.message}),this.cd.detectChanges()}onAnimationStart(e){"void"===e.fromState&&(this.containerViewChild.nativeElement.setAttribute(this.id,""),this.autoZIndex&&ls.set("modal",this.containerViewChild.nativeElement,this.baseZIndex||this.config.zIndex.modal))}onAnimationEnd(e){"void"===e.toState&&this.autoZIndex&&Pn.isEmpty(this.messages)&&ls.clear(this.containerViewChild.nativeElement)}createStyle(){if(!this.styleElement){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement);let e="";for(let n in this.breakpoints){let r="";for(let o in this.breakpoints[n])r+=o+":"+this.breakpoints[n][o]+" !important;";e+=`\n                    @media screen and (max-width: ${n}) {\n                        .p-toast[${this.id}] {\n                           ${r}\n                        }\n                    }\n                `}this.styleElement.innerHTML=e}}destroyStyle(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.containerViewChild&&this.autoZIndex&&ls.clear(this.containerViewChild.nativeElement),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.destroyStyle()}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(Wo),te(Bp))},t.\u0275cmp=dn({type:t,selectors:[["p-toast"]],contentQueries:function(e,n,r){if(1&e&&ol(r,zn,4),2&e){let o;xt(o=wt())&&(n.templates=o)}},viewQuery:function(e,n){if(1&e&&Mt(DL,5),2&e){let r;xt(r=wt())&&(n.containerViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{key:"key",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",style:"style",styleClass:"styleClass",position:"position",preventOpenDuplicates:"preventOpenDuplicates",preventDuplicates:"preventDuplicates",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",breakpoints:"breakpoints"},outputs:{onClose:"onClose"},decls:3,vars:5,consts:[[3,"ngClass","ngStyle"],["container",""],[3,"message","index","template","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose",4,"ngFor","ngForOf"],[3,"message","index","template","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose"]],template:function(e,n){1&e&&(f(0,"div",0,1),D(2,eq,1,8,"p-toastItem",2),p()),2&e&&(Ji(n.styleClass),T("ngClass","p-toast p-component p-toast-"+n.position)("ngStyle",n.style),v(2),T("ngForOf",n.messages))},directives:[tq,Na,La,nc],styles:[".p-toast{position:fixed;width:25rem}.p-toast-message{overflow:hidden}.p-toast-message-content{display:flex;align-items:flex-start}.p-toast-message-text{flex:1 1 auto}.p-toast-top-right{top:20px;right:20px}.p-toast-top-left{top:20px;left:20px}.p-toast-bottom-left{bottom:20px;left:20px}.p-toast-bottom-right{bottom:20px;right:20px}.p-toast-top-center{top:20px;left:50%;transform:translate(-50%)}.p-toast-bottom-center{bottom:20px;left:50%;transform:translate(-50%)}.p-toast-center{left:50%;top:50%;min-width:20vw;transform:translate(-50%,-50%)}.p-toast-icon-close{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-toast-icon-close.p-link{cursor:pointer}\n"],encapsulation:2,data:{animation:[km("toastAnimation",[ul(":enter, :leave",[WW("@*",$W())])])]},changeDetection:0}),t})(),gA=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro,_f],Uc]}),t})();function nq(t,i){1&t&&(f(0,"div",19),_(1," Username is required "),p())}function iq(t,i){1&t&&(f(0,"span"),_(1,"Password is required"),p())}function rq(t,i){1&t&&(f(0,"span"),_(1,"Password must be at least 6 characters"),p())}function oq(t,i){if(1&t&&(f(0,"div",19),D(1,iq,2,0,"span",20),D(2,rq,2,0,"span",20),p()),2&t){const e=A();v(1),T("ngIf",e.f.password.errors.required),v(1),T("ngIf",e.f.password.errors.minlength)}}let IL=(()=>{class t{constructor(e,n,r,o,c){this.fb=e,this.renderer=n,this._ls=r,this.router=o,this._ms=c,this.submitted=!1,this.modules=[],this.loginForm=new Zn({username:new Me("",jt.required),password:new Me("",jt.required)}),this.formData={username:"",password:""}}get f(){return this.loginForm.controls}submitForm(e){this.submitted=!0,this.loginForm.invalid||(sessionStorage.getItem("username"),this._ls.getAlowedModules(e.value.username).subscribe(r=>{this.modules=r;const o=JSON.stringify(this.modules);sessionStorage.setItem("modules",o)}),this._ls.login(e.value.username,e.value.password).subscribe({next:r=>{sessionStorage.setItem("accessToken",r.accessToken),sessionStorage.setItem("role",r.role),sessionStorage.setItem("username",e.value.username),sessionStorage.setItem("expiry",r.expiry),sessionStorage.setItem("userid",r.userid);let o="";o=this.modules[0].name.toString().toLowerCase(),this.router.navigate([o])},error:r=>{this._ms.add({severity:"error",summary:"Error",detail:r.error.text}),console.error(r)}}))}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(te(pT),te(Ss),te(_L),te(zs),te(kn))},t.\u0275cmp=dn({type:t,selectors:[["app-userlogin"]],decls:28,vars:7,consts:[[1,"login-page-container"],[1,"login-wrapper"],[1,"login-image"],["xmlns","http://www.w3.org/2000/svg","width","80","height","80","fill","currentColor","viewBox","0 0 16 16"],["d","M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"],["d","M3.5 11.5a3.5 3.5 0 1 1 3.163-5H14L15.5 8 14 9.5l-1-1-1 1-1-1-1 1-1-1-1 1H6.663a3.5 3.5 0 0 1-3.163 2zM2.5 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"],[1,"login-container"],[3,"formGroup","ngSubmit"],[1,"input-group"],[1,"fas","fa-user","input-icon"],["type","text","formControlName","username","id","username","required",""],["for","username"],["class","validation-message",4,"ngIf"],[1,"fas","fa-lock","input-icon"],["type","password","formControlName","password","id","password","required",""],["for","password"],["type","submit"],[1,"forgot-password"],["position","bottom-right"],[1,"validation-message"],[4,"ngIf"]],template:function(e,n){1&e&&(f(0,"div",0)(1,"div",1)(2,"div",2),function P2(){ai.lFrame.currentNamespace="svg"}(),f(3,"svg",3),ee(4,"path",4),p(),f(5,"svg",3),ee(6,"path",5),p(),_(7," Secure Login "),p(),function O2(){!function Y5(){ai.lFrame.currentNamespace=null}()}(),f(8,"div",6)(9,"h2"),_(10,"Welcome Back"),p(),f(11,"form",7),L("ngSubmit",function(){return n.submitForm(n.loginForm)}),f(12,"div",8),ee(13,"i",9)(14,"input",10),f(15,"label",11),_(16,"Username"),p(),D(17,nq,2,0,"div",12),p(),f(18,"div",8),ee(19,"i",13)(20,"input",14),f(21,"label",15),_(22,"Password"),p(),D(23,oq,3,2,"div",12),p(),f(24,"button",16),_(25,"Login"),p(),ee(26,"div",17),p()()()(),ee(27,"p-toast",18)),2&e&&(v(11),T("formGroup",n.loginForm),v(1),po("invalid",n.submitted&&n.f.username.errors),v(5),T("ngIf",n.submitted&&n.f.username.errors),v(1),po("invalid",n.submitted&&n.f.password.errors),v(5),T("ngIf",n.submitted&&n.f.password.errors))},directives:[Hr,Ur,Pr,Ir,Er,zr,By,Sn,fr],styles:['@import"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css";.login-page-container[_ngcontent-%COMP%]{position:fixed;inset:0;display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(rgba(30,136,229,.7),rgba(13,71,161,.7)),url(https://media.istockphoto.com/id/2187597711/photo/modern-office-buildings-and-low-angle-shots-of-the-sky.webp?a=1&b=1&s=612x612&w=0&k=20&c=_tyXHvAL2s2IytVJG-sEd2GcmA1ribA2QEu7jpLGomg=);background-size:cover;background-position:center;background-repeat:no-repeat;animation:gradientBG 15s ease infinite;z-index:0}@keyframes gradientBG{0%{background-color:#1e88e5b3}50%{background-color:#0d47a1b3}to{background-color:#1e88e5b3}}.login-wrapper[_ngcontent-%COMP%]{position:relative;z-index:1}.login-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;background:rgba(255,255,255,.9);border-radius:10px;box-shadow:0 15px 35px #0003;overflow:hidden;animation:fadeIn .8s ease-out}.login-image[_ngcontent-%COMP%]{width:150px;height:400px;background:linear-gradient(to bottom,#1e88e5,#0d47a1);display:flex;flex-direction:column;justify-content:center;align-items:center;padding:20px;color:#fff;position:relative;overflow:hidden}.login-image[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(rgba(30,136,229,.7),rgba(13,71,161,.7)),url(https://images.unsplash.com/photo-1581093450021-4a7360e9a7b8?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80);background-size:cover;background-position:center;opacity:.3;z-index:0}.login-image[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;z-index:1}.login-image[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin-top:20px;font-weight:500;position:relative;z-index:1}.login-container[_ngcontent-%COMP%]{width:400px;padding:40px;transform:translateY(0);transition:transform .3s ease,box-shadow .3s ease;position:relative;z-index:1}.login-wrapper[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 20px 40px #00000040}@keyframes fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}h2[_ngcontent-%COMP%]{text-align:center;color:#333;margin-bottom:30px;font-weight:600}.input-group[_ngcontent-%COMP%]{position:relative;margin-bottom:10px}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:15px 20px 15px 45px;font-size:16px;border:none;border-radius:50px!important;background:rgba(255,255,255,.9);box-shadow:0 5px 15px #0000001a;transition:all .3s ease}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 5px 20px #00000026;background:#fff}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:15px;left:45px;color:#666;font-size:16px;pointer-events:none;transition:all .3s ease}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + label[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:valid + label[_ngcontent-%COMP%]{top:-10px;left:40px;font-size:12px;background:#fff;padding:0 5px;color:#1e88e5}.input-icon[_ngcontent-%COMP%]{position:absolute;left:15px;top:15px;color:#1e88e5;font-size:18px;z-index:2}.validation-message[_ngcontent-%COMP%]{color:red;font-size:12px;margin-top:5px;margin-left:20px;height:14px;opacity:0;transition:opacity .3s ease}.input-group.invalid[_ngcontent-%COMP%]   .validation-message[_ngcontent-%COMP%]{opacity:1}.input-group.invalid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{box-shadow:0 0 0 2px red}button[_ngcontent-%COMP%]{width:100%;padding:15px;background:linear-gradient(to right,#1e88e5,#0d47a1);border:none;border-radius:50px;color:#fff;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 5px 15px #0000001a;margin-top:20px}button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 20px #00000026;background:linear-gradient(to right,#1976d2,#0b3d91)}button[_ngcontent-%COMP%]:active{transform:translateY(0)}.forgot-password[_ngcontent-%COMP%]{text-align:center;margin-top:20px}.forgot-password[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#666;text-decoration:none;font-size:14px;transition:color .3s ease}.forgot-password[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#1e88e5}']}),t})(),ja=(()=>{class t{constructor(e){this.router=e}canActivate(e,n){var r;if(sessionStorage.getItem("accessToken")){const c=sessionStorage.getItem("modules");let u=0;const m=JSON.parse(c),g=null===(r=e.routeConfig)||void 0===r?void 0:r.path;return"login"!=g&&m.forEach(M=>{g==M.link&&(u=1)}),sessionStorage.getItem("expiry"),(new Date).getTime(),0==u?(this.router.navigate(["/login"]),!1):(sessionStorage.setItem("expiry",((new Date).getTime()+9e5).toString()),!0)}return this.router.navigate(["/login"]),!1}}return t.\u0275fac=function(e){return new(e||t)(zt(zs))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const $i=Ws_apiUrl,dl={headers:new io({"Content-Type":"application/json"})};let Su=(()=>{class t{constructor(e){this._http=e}getYears(){return this._http.get($i+"getYears")}addYear(){return this._http.post($i+"addYear",{},dl)}updateYear(e){const{id:n,year:r}=e.value;return this._http.post($i+"updateYear",{id:n,year:r},dl)}deleteYear(e){return this._http.delete(`${$i}deleteYear`,{body:{id:e}})}getNovitaTransaction(e){return this._http.get($i+"getNovitaTransactions",{params:{id:e.toString()}})}getBranchesSummary(e,n){return this._http.get($i+"getBranchesSummary",{params:{id:e.toString(),userid:n}})}getTransactionBalance(e){return this._http.get($i+"getTransactionBalance",{params:{id:e.toString()}})}addNovitaTransaction(e){const{year:n,totalamount:r,profit:o,status:c,remarks:u}=e.value,m=new Date(e.value.transactiondate),g=this.formatDate(m);return this._http.post($i+"addNovitaTransaction",{transactiondate:g,year:n,totalamount:r,profit:o,status:c,remarks:u},dl)}updateNovitaTransaction(e){const{id:n,totalamount:r,profit:o,status:c,remarks:u}=e.value,m=new Date(e.value.transactiondate),g=this.formatDate(m);return this._http.post($i+"updateNovitaTransaction",{id:n,transactiondate:g,totalamount:r,profit:o,status:c,remarks:u},dl)}deleteNovitaTransaction(e){return this._http.delete(`${$i}deleteNovitaTransaction`,{body:{id:e}})}getNovitaInvestment(e){return this._http.get($i+"getNovitaInvestment",{params:{id:e.toString()}})}addNovitaInvestment(e){const{year:n,totalamount:r,remarks:o}=e.value;return this._http.post($i+"addNovitaInvestment",{year:n,totalamount:r,remarks:o},dl)}deleteNovitaInvestment(e){return this._http.delete(`${$i}deleteNovitaInvestment`,{body:{id:e}})}formatDate(e){return`${e.getFullYear().toString().slice(-2)}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`}addExpenseType(e){return this._http.post($i+"addExpenseType",{expensetype:e},dl)}updateExpenseType(e,n){return this._http.post($i+"updateExpenseType",{id:e,expensetype:n},dl)}getExpenseTypes(){return this._http.get($i+"getExpenseTypes")}getBranches(){return this._http.get($i+"getBranches")}getUserAssignedBranches(e){return this._http.get($i+"getUserAssignedBranches",{params:{userid:e}})}deleteExpenseType(e){return this._http.delete(`${$i}deleteExpenseType`,{body:{id:e}})}deleteBranch(e){return this._http.delete(`${$i}deleteBranch`,{body:{id:e}})}addBranch(e){const n=sessionStorage.getItem("role"),r=sessionStorage.getItem("userid"),{branch:o}=e.value;return this._http.post($i+"addBranch",{branch:o,role:n,userid:r},dl)}updateBranch(e){const{id:n,branch:r}=e.value;return this._http.post($i+"updateBranch",{id:n,branch:r},dl)}getBranchExpenses(e,n){const r=sessionStorage.getItem("userid");return this._http.get($i+"getBranchExpenses",{params:{id:e.toString(),branchid:n.toString(),userid:r.toString()}})}addBranchExpense(e){console.log(e.value);const{year:n,branchoffice:r,expense:o,totalamount:c}=e.value,u=new Date(e.value.transactiondate),m=this.formatDate(u);return this._http.post($i+"addBranchExpense",{year:n,branchoffice:r,expense:o,totalamount:c,transactiondate:m},dl)}deleteBranchExpense(e){return this._http.delete(`${$i}deleteBranchExpense`,{body:{id:e}})}getNovitaExpenses(e){return this._http.get($i+"getNovitaExpenses",{params:{id:e.toString()}})}getNovitaAssets(e){return this._http.get($i+"getNovitaAssets",{params:{id:e.toString()}})}addNovitaAssets(e){const{yearid:n,location:r,worth:o,ownership:c,type:u}=e.value,m=new Date(e.value.date_asset),g=this.formatDate(m);return this._http.post($i+"addNovitaAssets",{yearid:n,location:r,worth:o,ownership:c,type:u,date_asset:g},dl)}updateNovitaAssets(e){const{id:n,yearid:r,location:o,worth:c,ownership:u,type:m}=e.value,g=new Date(e.value.date_asset),x=this.formatDate(g);return this._http.post($i+"updateNovitaAsset",{id:n,yearid:r,location:o,worth:c,ownership:u,type:m,date_asset:x},dl)}deleteNovitaAsset(e){return this._http.delete(`${$i}deleteNovitaAsset`,{body:{id:e}})}getNovitaTotalExpenses(e){return this._http.get($i+"getNovitaTotalExpenses",{params:{yearid:e.toString()}})}addNovitaExpense(e){console.log(e.value);const{year:n,expense:r,totalamount:o}=e.value,c=new Date(e.value.transactiondate),u=this.formatDate(c);return this._http.post($i+"addNovitaExpense",{year:n,expense:r,totalamount:o,transactiondate:u},dl)}deleteNovitaExpense(e){return this._http.delete(`${$i}deleteNovitaExpense`,{body:{id:e}})}getBranchInvestment(e,n){return this._http.get($i+"getBranchInvestment",{params:{id:e.toString(),brid:n.toString()}})}addBranchInvestment(e){const{year:n,branchoffice:r,totalamount:o,remarks:c}=e.value;return this._http.post($i+"addBranchInvestment",{year:n,branchoffice:r,totalamount:o,remarks:c},dl)}deleteBranchInvestment(e){return this._http.delete(`${$i}deleteBranchInvestment`,{body:{id:e}})}getUsers(){return this._http.get($i+"getUsers")}assignBranchtoUsers(e,n,r){return this._http.post($i+"assignBranchtoUsers",{userid:e,branches:n,flag:r},dl)}getUsersBranches(e){return this._http.get($i+"getUsersBranches",{params:{userid:e}})}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function hT(t,i=0){return function aq(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):i}const cq=["addListener","removeListener"],uq=["addEventListener","removeEventListener"],dq=["on","off"];function mT(t,i,e,n){if(fi(e)&&(n=e,e=void 0),n)return mT(t,i,e).pipe(_I(n));const[r,o]=function hq(t){return fi(t.addEventListener)&&fi(t.removeEventListener)}(t)?uq.map(c=>u=>t[c](i,u,e)):function fq(t){return fi(t.addListener)&&fi(t.removeListener)}(t)?cq.map(AL(t,i)):function pq(t){return fi(t.on)&&fi(t.off)}(t)?dq.map(AL(t,i)):[];if(!r&&z_(t))return ts(c=>mT(c,i,e))(_a(t));if(!r)throw new TypeError("Invalid event target");return new Lr(c=>{const u=(...m)=>c.next(1<m.length?m:m[0]);return r(u),()=>o(u)})}function AL(t,i){return e=>n=>t[e](i,n)}class mq extends lo{constructor(i,e){super()}schedule(i,e=0){return this}}const gT={setInterval(t,i,...e){const{delegate:n}=gT;return(null==n?void 0:n.setInterval)?n.setInterval(t,i,...e):setInterval(t,i,...e)},clearInterval(t){const{delegate:i}=gT;return((null==i?void 0:i.clearInterval)||clearInterval)(t)},delegate:void 0};class _A extends mq{constructor(i,e){super(i,e),this.scheduler=i,this.work=e,this.pending=!1}schedule(i,e=0){var n;if(this.closed)return this;this.state=i;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,e)),this.pending=!0,this.delay=e,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(o,this.id,e),this}requestAsyncId(i,e,n=0){return gT.setInterval(i.flush.bind(i,this),n)}recycleAsyncId(i,e,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return e;null!=e&&gT.clearInterval(e)}execute(i,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(i,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(i,e){let r,n=!1;try{this.work(i)}catch(o){n=!0,r=o||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:i,scheduler:e}=this,{actions:n}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Ia(n,this),null!=i&&(this.id=this.recycleAsyncId(e,i,null)),this.delay=null,super.unsubscribe()}}}const Uy={schedule(t){let i=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:n}=Uy;n&&(i=n.requestAnimationFrame,e=n.cancelAnimationFrame);const r=i(o=>{e=void 0,t(o)});return new lo(()=>null==e?void 0:e(r))},requestAnimationFrame(...t){const{delegate:i}=Uy;return((null==i?void 0:i.requestAnimationFrame)||requestAnimationFrame)(...t)},cancelAnimationFrame(...t){const{delegate:i}=Uy;return((null==i?void 0:i.cancelAnimationFrame)||cancelAnimationFrame)(...t)},delegate:void 0},vA={now:()=>(vA.delegate||Date).now(),delegate:void 0};class Hy{constructor(i,e=Hy.now){this.schedulerActionCtor=i,this.now=e}schedule(i,e=0,n){return new this.schedulerActionCtor(this,i).schedule(n,e)}}Hy.now=vA.now;class yA extends Hy{constructor(i,e=Hy.now){super(i,e),this.actions=[],this._active=!1}flush(i){const{actions:e}=this;if(this._active)return void e.push(i);let n;this._active=!0;do{if(n=i.execute(i.state,i.delay))break}while(i=e.shift());if(this._active=!1,n){for(;i=e.shift();)i.unsubscribe();throw n}}}const vq=new class _q extends yA{flush(i){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;i=i||n.shift();do{if(r=i.execute(i.state,i.delay))break}while((i=n[0])&&i.id===e&&n.shift());if(this._active=!1,r){for(;(i=n[0])&&i.id===e&&n.shift();)i.unsubscribe();throw r}}}(class gq extends _A{constructor(i,e){super(i,e),this.scheduler=i,this.work=e}requestAsyncId(i,e,n=0){return null!==n&&n>0?super.requestAsyncId(i,e,n):(i.actions.push(this),i._scheduled||(i._scheduled=Uy.requestAnimationFrame(()=>i.flush(void 0))))}recycleAsyncId(i,e,n=0){var r;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(i,e,n);const{actions:o}=i;null!=e&&(null===(r=o[o.length-1])||void 0===r?void 0:r.id)!==e&&(Uy.cancelAnimationFrame(e),i._scheduled=void 0)}});let bA,yq=1;const _T={};function ML(t){return t in _T&&(delete _T[t],!0)}const bq={setImmediate(t){const i=yq++;return _T[i]=!0,bA||(bA=Promise.resolve()),bA.then(()=>ML(i)&&t()),i},clearImmediate(t){ML(t)}},{setImmediate:xq,clearImmediate:wq}=bq,vT={setImmediate(...t){const{delegate:i}=vT;return((null==i?void 0:i.setImmediate)||xq)(...t)},clearImmediate(t){const{delegate:i}=vT;return((null==i?void 0:i.clearImmediate)||wq)(t)},delegate:void 0},Sq=new class Tq extends yA{flush(i){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;i=i||n.shift();do{if(r=i.execute(i.state,i.delay))break}while((i=n[0])&&i.id===e&&n.shift());if(this._active=!1,r){for(;(i=n[0])&&i.id===e&&n.shift();)i.unsubscribe();throw r}}}(class Cq extends _A{constructor(i,e){super(i,e),this.scheduler=i,this.work=e}requestAsyncId(i,e,n=0){return null!==n&&n>0?super.requestAsyncId(i,e,n):(i.actions.push(this),i._scheduled||(i._scheduled=vT.setImmediate(i.flush.bind(i,void 0))))}recycleAsyncId(i,e,n=0){var r;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(i,e,n);const{actions:o}=i;null!=e&&(null===(r=o[o.length-1])||void 0===r?void 0:r.id)!==e&&(vT.clearImmediate(e),i._scheduled=void 0)}});function FL(t){return!!t&&(t instanceof Lr||fi(t.lift)&&fi(t.subscribe))}function kq(t,i){return t===i}const PL=new yA(_A),Dq=PL;function xA(t,i=PL){return function Iq(t){return Mo((i,e)=>{let n=!1,r=null,o=null,c=!1;const u=()=>{if(null==o||o.unsubscribe(),o=null,n){n=!1;const g=r;r=null,e.next(g)}c&&e.complete()},m=()=>{o=null,c&&e.complete()};i.subscribe(co(e,g=>{n=!0,r=g,o||_a(t(g)).subscribe(o=co(e,u,m))},()=>{c=!0,(!n||!o||o.closed)&&e.complete()}))})}(()=>function Mq(t=0,i,e=Dq){let n=-1;return null!=i&&(Jb(i)?e=i:n=i),new Lr(r=>{let o=function Aq(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;o<0&&(o=0);let c=0;return e.schedule(function(){r.closed||(r.next(c++),0<=n?this.schedule(void 0,n):r.complete())},o)})}(t,i))}function wA(t){return Mo((i,e)=>{_a(t).subscribe(co(e,()=>e.complete(),Os)),!e.closed&&i.subscribe(e)})}class Pq extends Wi{constructor(i=1/0,e=1/0,n=vA){super(),this._bufferSize=i,this._windowTime=e,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,i),this._windowTime=Math.max(1,e)}next(i){const{isStopped:e,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:o,_windowTime:c}=this;e||(n.push(i),!r&&n.push(o.now()+c)),this._trimBuffer(),super.next(i)}_subscribe(i){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(i),{_infiniteTimeWindow:n,_buffer:r}=this,o=r.slice();for(let c=0;c<o.length&&!i.closed;c+=n?1:2)i.next(o[c]);return this._checkFinalizedStatuses(i),e}_trimBuffer(){const{_bufferSize:i,_timestampProvider:e,_buffer:n,_infiniteTimeWindow:r}=this,o=(r?1:2)*i;if(i<1/0&&o<n.length&&n.splice(0,n.length-o),!r){const c=e.now();let u=0;for(let m=1;m<n.length&&n[m]<=c;m+=2)u=m;u&&n.splice(0,u+1)}}}let CA;try{CA="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(t){CA=!1}let yT,Dm,OL=(()=>{class t{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function gU(t){return t===IO}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!CA)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return t.\u0275fac=function(e){return new(e||t)(zt(gy))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function $y(){if("object"!=typeof document||!document)return 0;if(null==yT){const t=document.createElement("div"),i=t.style;t.dir="rtl",i.width="1px",i.overflow="auto",i.visibility="hidden",i.pointerEvents="none",i.position="absolute";const e=document.createElement("div"),n=e.style;n.width="2px",n.height="1px",t.appendChild(e),document.body.appendChild(t),yT=0,0===t.scrollLeft&&(t.scrollLeft=1,yT=0===t.scrollLeft?1:2),t.remove()}return yT}const Bq=new hi("cdk-dir-doc",{providedIn:"root",factory:function jq(){return ax(ra)}}),Vq=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let LL=(()=>{class t{constructor(e){if(this.value="ltr",this.change=new Et,e){const r=e.documentElement?e.documentElement.dir:null;this.value=function Uq(t){const i=(null==t?void 0:t.toLowerCase())||"";return"auto"===i&&"undefined"!=typeof navigator&&(null==navigator?void 0:navigator.language)?Vq.test(navigator.language)?"rtl":"ltr":"rtl"===i?"rtl":"ltr"}((e.body?e.body.dir:null)||r||"ltr")}}ngOnDestroy(){this.change.complete()}}return t.\u0275fac=function(e){return new(e||t)(zt(Bq,8))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),RL=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({}),t})();class $q extends class Hq{}{constructor(i){super(),this._data=i}connect(){return FL(this._data)?this._data:_i(this._data)}disconnect(){}}class Wq{constructor(){this.viewCacheSize=20,this._viewCache=[]}applyChanges(i,e,n,r,o){i.forEachOperation((c,u,m)=>{let g,x;null==c.previousIndex?(g=this._insertView(()=>n(c,u,m),m,e,r(c)),x=g?1:0):null==m?(this._detachAndCacheView(u,e),x=3):(g=this._moveView(u,m,e,r(c)),x=2),o&&o({context:null==g?void 0:g.context,operation:x,record:c})})}detach(){for(const i of this._viewCache)i.destroy();this._viewCache=[]}_insertView(i,e,n,r){const o=this._insertViewFromCache(e,n);if(o)return void(o.context.$implicit=r);const c=i();return n.createEmbeddedView(c.templateRef,c.context,c.index)}_detachAndCacheView(i,e){const n=e.detach(i);this._maybeCacheView(n,e)}_moveView(i,e,n,r){const o=n.get(i);return n.move(o,e),o.context.$implicit=r,o}_maybeCacheView(i,e){if(this._viewCache.length<this.viewCacheSize)this._viewCache.push(i);else{const n=e.indexOf(i);-1===n?i.destroy():e.remove(n)}}_insertViewFromCache(i,e){const n=this._viewCache.pop();return n&&e.insert(n,i),n||null}}const BL=new hi("_ViewRepeater"),qq=["contentWrapper"],Gq=["*"],jL=new hi("VIRTUAL_SCROLL_STRATEGY");class Kq{constructor(i,e,n){this._scrolledIndexChange=new Wi,this.scrolledIndexChange=this._scrolledIndexChange.pipe(function Eq(t,i=qu){return t=null!=t?t:kq,Mo((e,n)=>{let r,o=!0;e.subscribe(co(n,c=>{const u=i(c);(o||!t(r,u))&&(o=!1,r=u,n.next(c))}))})}()),this._viewport=null,this._itemSize=i,this._minBufferPx=e,this._maxBufferPx=n}attach(i){this._viewport=i,this._updateTotalContentSize(),this._updateRenderedRange()}detach(){this._scrolledIndexChange.complete(),this._viewport=null}updateItemAndBufferSize(i,e,n){this._itemSize=i,this._minBufferPx=e,this._maxBufferPx=n,this._updateTotalContentSize(),this._updateRenderedRange()}onContentScrolled(){this._updateRenderedRange()}onDataLengthChanged(){this._updateTotalContentSize(),this._updateRenderedRange()}onContentRendered(){}onRenderedOffsetChanged(){}scrollToIndex(i,e){this._viewport&&this._viewport.scrollToOffset(i*this._itemSize,e)}_updateTotalContentSize(){!this._viewport||this._viewport.setTotalContentSize(this._viewport.getDataLength()*this._itemSize)}_updateRenderedRange(){if(!this._viewport)return;const i=this._viewport.getRenderedRange(),e={start:i.start,end:i.end},n=this._viewport.getViewportSize(),r=this._viewport.getDataLength();let o=this._viewport.measureScrollOffset(),c=this._itemSize>0?o/this._itemSize:0;if(e.end>r){const m=Math.ceil(n/this._itemSize),g=Math.max(0,Math.min(c,r-m));c!=g&&(c=g,o=g*this._itemSize,e.start=Math.floor(c)),e.end=Math.max(0,Math.min(r,e.start+m))}const u=o-e.start*this._itemSize;if(u<this._minBufferPx&&0!=e.start){const m=Math.ceil((this._maxBufferPx-u)/this._itemSize);e.start=Math.max(0,e.start-m),e.end=Math.min(r,Math.ceil(c+(n+this._minBufferPx)/this._itemSize))}else{const m=e.end*this._itemSize-(o+n);if(m<this._minBufferPx&&e.end!=r){const g=Math.ceil((this._maxBufferPx-m)/this._itemSize);g>0&&(e.end=Math.min(r,e.end+g),e.start=Math.max(0,Math.floor(c-this._minBufferPx/this._itemSize)))}}this._viewport.setRenderedRange(e),this._viewport.setRenderedContentOffset(this._itemSize*e.start),this._scrolledIndexChange.next(Math.floor(c))}}function Yq(t){return t._scrollStrategy}let VL=(()=>{class t{constructor(){this._itemSize=20,this._minBufferPx=100,this._maxBufferPx=200,this._scrollStrategy=new Kq(this.itemSize,this.minBufferPx,this.maxBufferPx)}get itemSize(){return this._itemSize}set itemSize(e){this._itemSize=hT(e)}get minBufferPx(){return this._minBufferPx}set minBufferPx(e){this._minBufferPx=hT(e)}get maxBufferPx(){return this._maxBufferPx}set maxBufferPx(e){this._maxBufferPx=hT(e)}ngOnChanges(){this._scrollStrategy.updateItemAndBufferSize(this.itemSize,this.minBufferPx,this.maxBufferPx)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Ln({type:t,selectors:[["cdk-virtual-scroll-viewport","itemSize",""]],inputs:{itemSize:"itemSize",minBufferPx:"minBufferPx",maxBufferPx:"maxBufferPx"},features:[Nn([{provide:jL,useFactory:Yq,deps:[tr(()=>t)]}]),Vs]}),t})(),UL=(()=>{class t{constructor(e,n,r){this._ngZone=e,this._platform=n,this._scrolled=new Wi,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const n=this.scrollContainers.get(e);n&&(n.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new Lr(n=>{this._globalSubscription||this._addGlobalListener();const r=e>0?this._scrolled.pipe(xA(e)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):_i()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(e,n){const r=this.getAncestorScrollContainers(e);return this.scrolled(n).pipe(Fp(o=>!o||r.indexOf(o)>-1))}getAncestorScrollContainers(e){const n=[];return this.scrollContainers.forEach((r,o)=>{this._scrollableContainsElement(o,e)&&n.push(o)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,n){let r=function lq(t){return t instanceof mr?t.nativeElement:t}(n),o=e.getElementRef().nativeElement;do{if(r==o)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>mT(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return t.\u0275fac=function(e){return new(e||t)(zt(gr),zt(OL),zt(ra,8))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),HL=(()=>{class t{constructor(e,n,r,o){this.elementRef=e,this.scrollDispatcher=n,this.ngZone=r,this.dir=o,this._destroyed=new Wi,this._elementScrolled=new Lr(c=>this.ngZone.runOutsideAngular(()=>mT(this.elementRef.nativeElement,"scroll").pipe(wA(this._destroyed)).subscribe(c)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){const n=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==e.left&&(e.left=r?e.end:e.start),null==e.right&&(e.right=r?e.start:e.end),null!=e.bottom&&(e.top=n.scrollHeight-n.clientHeight-e.bottom),r&&0!=$y()?(null!=e.left&&(e.right=n.scrollWidth-n.clientWidth-e.left),2==$y()?e.left=e.right:1==$y()&&(e.left=e.right?-e.right:e.right)):null!=e.right&&(e.left=n.scrollWidth-n.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){const n=this.elementRef.nativeElement;!function Lq(){if(null==Dm){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Dm=!1,Dm;if("scrollBehavior"in document.documentElement.style)Dm=!0;else{const t=Element.prototype.scrollTo;Dm=!!t&&!/\{\s*\[native code\]\s*\}/.test(t.toString())}}return Dm}()?(null!=e.top&&(n.scrollTop=e.top),null!=e.left&&(n.scrollLeft=e.left)):n.scrollTo(e)}measureScrollOffset(e){const n="left",r="right",o=this.elementRef.nativeElement;if("top"==e)return o.scrollTop;if("bottom"==e)return o.scrollHeight-o.clientHeight-o.scrollTop;const c=this.dir&&"rtl"==this.dir.value;return"start"==e?e=c?r:n:"end"==e&&(e=c?n:r),c&&2==$y()?e==n?o.scrollWidth-o.clientWidth-o.scrollLeft:o.scrollLeft:c&&1==$y()?e==n?o.scrollLeft+o.scrollWidth-o.clientWidth:-o.scrollLeft:e==n?o.scrollLeft:o.scrollWidth-o.clientWidth-o.scrollLeft}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(UL),te(gr),te(LL,8))},t.\u0275dir=Ln({type:t,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),t})(),Jq=(()=>{class t{constructor(e,n,r){this._platform=e,this._change=new Wi,this._changeListener=o=>{this._change.next(o)},this._document=r,n.runOutsideAngular(()=>{if(e.isBrowser){const o=this._getWindow();o.addEventListener("resize",this._changeListener),o.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:n,height:r}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+r,right:e.left+n,height:r,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,n=this._getWindow(),r=e.documentElement,o=r.getBoundingClientRect();return{top:-o.top||e.body.scrollTop||n.scrollY||r.scrollTop||0,left:-o.left||e.body.scrollLeft||n.scrollX||r.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(xA(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return t.\u0275fac=function(e){return new(e||t)(zt(OL),zt(gr),zt(ra,8))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const eG="undefined"!=typeof requestAnimationFrame?vq:Sq;let Wy=(()=>{class t extends HL{constructor(e,n,r,o,c,u,m){super(e,u,r,c),this.elementRef=e,this._changeDetectorRef=n,this._scrollStrategy=o,this._detachedSubject=new Wi,this._renderedRangeSubject=new Wi,this._orientation="vertical",this._appendOnly=!1,this.scrolledIndexChange=new Lr(g=>this._scrollStrategy.scrolledIndexChange.subscribe(x=>Promise.resolve().then(()=>this.ngZone.run(()=>g.next(x))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=lo.EMPTY,this._viewportChanges=m.change().subscribe(()=>{this.checkViewportSize()})}get orientation(){return this._orientation}set orientation(e){this._orientation!==e&&(this._orientation=e,this._calculateSpacerSize())}get appendOnly(){return this._appendOnly}set appendOnly(e){this._appendOnly=function sq(t){return null!=t&&"false"!=`${t}`}(e)}ngOnInit(){super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.elementScrolled().pipe(bI(null),xA(0,eG)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()}))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(e){this.ngZone.runOutsideAngular(()=>{this._forOf=e,this._forOf.dataStream.pipe(wA(this._detachedSubject)).subscribe(n=>{const r=n.length;r!==this._dataLength&&(this._dataLength=r,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}setTotalContentSize(e){this._totalContentSize!==e&&(this._totalContentSize=e,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(e){(function Zq(t,i){return t.start==i.start&&t.end==i.end})(this._renderedRange,e)||(this.appendOnly&&(e={start:0,end:Math.max(this._renderedRange.end,e.end)}),this._renderedRangeSubject.next(this._renderedRange=e),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(e,n="to-start"){const o="horizontal"==this.orientation,c=o?"X":"Y";let m=`translate${c}(${Number((o&&this.dir&&"rtl"==this.dir.value?-1:1)*e)}px)`;this._renderedContentOffset=e=this.appendOnly&&"to-start"===n?0:e,"to-end"===n&&(m+=` translate${c}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=m&&(this._renderedContentTransform=m,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(e,n="auto"){const r={behavior:n};"horizontal"===this.orientation?r.start=e:r.top=e,this.scrollTo(r)}scrollToIndex(e,n="auto"){this._scrollStrategy.scrollToIndex(e,n)}measureScrollOffset(e){return super.measureScrollOffset(e||("horizontal"===this.orientation?"start":"top"))}measureRenderedContentSize(){const e=this._contentWrapper.nativeElement;return"horizontal"===this.orientation?e.offsetWidth:e.offsetHeight}measureRangeSize(e){return this._forOf?this._forOf.measureRangeSize(e,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){const e=this.elementRef.nativeElement;this._viewportSize="horizontal"===this.orientation?e.clientWidth:e.clientHeight}_markChangeDetectionNeeded(e){e&&this._runAfterChangeDetection.push(e),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());const e=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(const n of e)n()}_calculateSpacerSize(){this._totalContentHeight="horizontal"===this.orientation?"":`${this._totalContentSize}px`,this._totalContentWidth="horizontal"===this.orientation?`${this._totalContentSize}px`:""}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(Wo),te(gr),te(jL,8),te(LL,8),te(UL),te(Jq))},t.\u0275cmp=dn({type:t,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(e,n){if(1&e&&Mt(qq,7),2&e){let r;xt(r=wt())&&(n._contentWrapper=r.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(e,n){2&e&&po("cdk-virtual-scroll-orientation-horizontal","horizontal"===n.orientation)("cdk-virtual-scroll-orientation-vertical","horizontal"!==n.orientation)},inputs:{orientation:"orientation",appendOnly:"appendOnly"},outputs:{scrolledIndexChange:"scrolledIndexChange"},features:[Nn([{provide:HL,useExisting:t}]),wr],ngContentSelectors:Gq,decls:4,vars:4,consts:[[1,"cdk-virtual-scroll-content-wrapper"],["contentWrapper",""],[1,"cdk-virtual-scroll-spacer"]],template:function(e,n){1&e&&(mu(),f(0,"div",0,1),Sl(2),p(),ee(3,"div",2)),2&e&&(v(3),ud("width",n._totalContentWidth)("height",n._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;overflow:auto;contain:strict;transform:translateZ(0);will-change:scroll-position;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{position:absolute;top:0;left:0;height:1px;width:1px;transform-origin:0 0}[dir=rtl] .cdk-virtual-scroll-spacer{right:0;left:auto;transform-origin:100% 0}\n"],encapsulation:2,changeDetection:0}),t})();function zL(t,i,e){if(!e.getBoundingClientRect)return 0;const r=e.getBoundingClientRect();return"horizontal"===t?"start"===i?r.left:r.right:"start"===i?r.top:r.bottom}let $L=(()=>{class t{constructor(e,n,r,o,c,u){this._viewContainerRef=e,this._template=n,this._differs=r,this._viewRepeater=o,this._viewport=c,this.viewChange=new Wi,this._dataSourceChanges=new Wi,this.dataStream=this._dataSourceChanges.pipe(bI(null),function Fq(){return Mo((t,i)=>{let e,n=!1;t.subscribe(co(i,r=>{const o=e;e=r,n&&i.next([o,r]),n=!0}))})}(),Mp(([m,g])=>this._changeDataSource(m,g)),function Oq(t,i,e){let n,r=!1;return t&&"object"==typeof t?({bufferSize:n=1/0,windowTime:i=1/0,refCount:r=!1,scheduler:e}=t):n=null!=t?t:1/0,G_({connector:()=>new Pq(n,i,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}(1)),this._differ=null,this._needsUpdate=!1,this._destroyed=new Wi,this.dataStream.subscribe(m=>{this._data=m,this._onRenderedDataChange()}),this._viewport.renderedRangeStream.pipe(wA(this._destroyed)).subscribe(m=>{this._renderedRange=m,this.viewChange.observers.length&&u.run(()=>this.viewChange.next(this._renderedRange)),this._onRenderedDataChange()}),this._viewport.attach(this)}get cdkVirtualForOf(){return this._cdkVirtualForOf}set cdkVirtualForOf(e){this._cdkVirtualForOf=e,function zq(t){return t&&"function"==typeof t.connect}(e)?this._dataSourceChanges.next(e):this._dataSourceChanges.next(new $q(FL(e)?e:Array.from(e||[])))}get cdkVirtualForTrackBy(){return this._cdkVirtualForTrackBy}set cdkVirtualForTrackBy(e){this._needsUpdate=!0,this._cdkVirtualForTrackBy=e?(n,r)=>e(n+(this._renderedRange?this._renderedRange.start:0),r):void 0}set cdkVirtualForTemplate(e){e&&(this._needsUpdate=!0,this._template=e)}get cdkVirtualForTemplateCacheSize(){return this._viewRepeater.viewCacheSize}set cdkVirtualForTemplateCacheSize(e){this._viewRepeater.viewCacheSize=hT(e)}measureRangeSize(e,n){if(e.start>=e.end)return 0;const r=e.start-this._renderedRange.start,o=e.end-e.start;let c,u;for(let m=0;m<o;m++){const g=this._viewContainerRef.get(m+r);if(g&&g.rootNodes.length){c=u=g.rootNodes[0];break}}for(let m=o-1;m>-1;m--){const g=this._viewContainerRef.get(m+r);if(g&&g.rootNodes.length){u=g.rootNodes[g.rootNodes.length-1];break}}return c&&u?zL(n,"end",u)-zL(n,"start",c):0}ngDoCheck(){if(this._differ&&this._needsUpdate){const e=this._differ.diff(this._renderedItems);e?this._applyChanges(e):this._updateContext(),this._needsUpdate=!1}}ngOnDestroy(){this._viewport.detach(),this._dataSourceChanges.next(void 0),this._dataSourceChanges.complete(),this.viewChange.complete(),this._destroyed.next(),this._destroyed.complete(),this._viewRepeater.detach()}_onRenderedDataChange(){!this._renderedRange||(this._renderedItems=this._data.slice(this._renderedRange.start,this._renderedRange.end),this._differ||(this._differ=this._differs.find(this._renderedItems).create((e,n)=>this.cdkVirtualForTrackBy?this.cdkVirtualForTrackBy(e,n):n)),this._needsUpdate=!0)}_changeDataSource(e,n){return e&&e.disconnect(this),this._needsUpdate=!0,n?n.connect(this):_i()}_updateContext(){const e=this._data.length;let n=this._viewContainerRef.length;for(;n--;){const r=this._viewContainerRef.get(n);r.context.index=this._renderedRange.start+n,r.context.count=e,this._updateComputedContextProperties(r.context),r.detectChanges()}}_applyChanges(e){this._viewRepeater.applyChanges(e,this._viewContainerRef,(o,c,u)=>this._getEmbeddedViewArgs(o,u),o=>o.item),e.forEachIdentityChange(o=>{this._viewContainerRef.get(o.currentIndex).context.$implicit=o.item});const n=this._data.length;let r=this._viewContainerRef.length;for(;r--;){const o=this._viewContainerRef.get(r);o.context.index=this._renderedRange.start+r,o.context.count=n,this._updateComputedContextProperties(o.context)}}_updateComputedContextProperties(e){e.first=0===e.index,e.last=e.index===e.count-1,e.even=e.index%2==0,e.odd=!e.even}_getEmbeddedViewArgs(e,n){return{templateRef:this._template,context:{$implicit:e.item,cdkVirtualForOf:this._cdkVirtualForOf,index:-1,count:-1,first:!1,last:!1,odd:!1,even:!1},index:n}}}return t.\u0275fac=function(e){return new(e||t)(te(Al),te(Rc),te(_y),te(BL),te(Wy,4),te(gr))},t.\u0275dir=Ln({type:t,selectors:[["","cdkVirtualFor","","cdkVirtualForOf",""]],inputs:{cdkVirtualForOf:"cdkVirtualForOf",cdkVirtualForTrackBy:"cdkVirtualForTrackBy",cdkVirtualForTemplate:"cdkVirtualForTemplate",cdkVirtualForTemplateCacheSize:"cdkVirtualForTemplateCacheSize"},features:[Nn([{provide:BL,useClass:Wq}])]}),t})(),WL=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({}),t})(),bT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[RL,WL],RL,WL]}),t})(),qL=(()=>{class t{constructor(e,n,r){this.el=e,this.zone=n,this.config=r,this.escape=!0,this._tooltipOptions={tooltipPosition:"right",tooltipEvent:"hover",appendTo:"body",tooltipZIndex:"auto",escape:!0,positionTop:0,positionLeft:0}}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this.deactivate()}ngAfterViewInit(){this.zone.runOutsideAngular(()=>{if("hover"===this.getOption("tooltipEvent"))this.mouseEnterListener=this.onMouseEnter.bind(this),this.mouseLeaveListener=this.onMouseLeave.bind(this),this.clickListener=this.onClick.bind(this),this.el.nativeElement.addEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.addEventListener("mouseleave",this.mouseLeaveListener),this.el.nativeElement.addEventListener("click",this.clickListener);else if("focus"===this.getOption("tooltipEvent")){this.focusListener=this.onFocus.bind(this),this.blurListener=this.onBlur.bind(this);let e=this.getTarget(this.el.nativeElement);e.addEventListener("focus",this.focusListener),e.addEventListener("blur",this.blurListener)}})}ngOnChanges(e){e.tooltipPosition&&this.setOption({tooltipPosition:e.tooltipPosition.currentValue}),e.tooltipEvent&&this.setOption({tooltipEvent:e.tooltipEvent.currentValue}),e.appendTo&&this.setOption({appendTo:e.appendTo.currentValue}),e.positionStyle&&this.setOption({positionStyle:e.positionStyle.currentValue}),e.tooltipStyleClass&&this.setOption({tooltipStyleClass:e.tooltipStyleClass.currentValue}),e.tooltipZIndex&&this.setOption({tooltipZIndex:e.tooltipZIndex.currentValue}),e.escape&&this.setOption({escape:e.escape.currentValue}),e.showDelay&&this.setOption({showDelay:e.showDelay.currentValue}),e.hideDelay&&this.setOption({hideDelay:e.hideDelay.currentValue}),e.life&&this.setOption({life:e.life.currentValue}),e.positionTop&&this.setOption({positionTop:e.positionTop.currentValue}),e.positionLeft&&this.setOption({positionLeft:e.positionLeft.currentValue}),e.disabled&&this.setOption({disabled:e.disabled.currentValue}),e.text&&(this.setOption({tooltipLabel:e.text.currentValue}),this.active&&(e.text.currentValue?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide())),e.tooltipOptions&&(this._tooltipOptions=Object.assign(Object.assign({},this._tooltipOptions),e.tooltipOptions.currentValue),this.deactivate(),this.active&&(this.getOption("tooltipLabel")?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide()))}onMouseEnter(e){!this.container&&!this.showTimeout&&this.activate()}onMouseLeave(e){this.deactivate()}onFocus(e){this.activate()}onBlur(e){this.deactivate()}onClick(e){this.deactivate()}activate(){if(this.active=!0,this.clearHideTimeout(),this.getOption("showDelay")?this.showTimeout=setTimeout(()=>{this.show()},this.getOption("showDelay")):this.show(),this.getOption("life")){let e=this.getOption("showDelay")?this.getOption("life")+this.getOption("showDelay"):this.getOption("life");this.hideTimeout=setTimeout(()=>{this.hide()},e)}}deactivate(){this.active=!1,this.clearShowTimeout(),this.getOption("hideDelay")?(this.clearHideTimeout(),this.hideTimeout=setTimeout(()=>{this.hide()},this.getOption("hideDelay"))):this.hide()}create(){this.container&&(this.clearHideTimeout(),this.remove()),this.container=document.createElement("div");let e=document.createElement("div");e.className="p-tooltip-arrow",this.container.appendChild(e),this.tooltipText=document.createElement("div"),this.tooltipText.className="p-tooltip-text",this.updateText(),this.getOption("positionStyle")&&(this.container.style.position=this.getOption("positionStyle")),this.container.appendChild(this.tooltipText),"body"===this.getOption("appendTo")?document.body.appendChild(this.container):"target"===this.getOption("appendTo")?We.appendChild(this.container,this.el.nativeElement):We.appendChild(this.container,this.getOption("appendTo")),this.container.style.display="inline-block"}show(){!this.getOption("tooltipLabel")||this.getOption("disabled")||(this.create(),this.align(),We.fadeIn(this.container,250),"auto"===this.getOption("tooltipZIndex")?ls.set("tooltip",this.container,this.config.zIndex.tooltip):this.container.style.zIndex=this.getOption("tooltipZIndex"),this.bindDocumentResizeListener(),this.bindScrollListener())}hide(){"auto"===this.getOption("tooltipZIndex")&&ls.clear(this.container),this.remove()}updateText(){this.getOption("escape")?(this.tooltipText.innerHTML="",this.tooltipText.appendChild(document.createTextNode(this.getOption("tooltipLabel")))):this.tooltipText.innerHTML=this.getOption("tooltipLabel")}align(){switch(this.getOption("tooltipPosition")){case"top":this.alignTop(),this.isOutOfBounds()&&(this.alignBottom(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"bottom":this.alignBottom(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"left":this.alignLeft(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break;case"right":this.alignRight(),this.isOutOfBounds()&&(this.alignLeft(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()))}}getHostOffset(){if("body"===this.getOption("appendTo")||"target"===this.getOption("appendTo")){let e=this.el.nativeElement.getBoundingClientRect();return{left:e.left+We.getWindowScrollLeft(),top:e.top+We.getWindowScrollTop()}}return{left:0,top:0}}alignRight(){this.preAlign("right");let e=this.getHostOffset(),n=e.left+We.getOuterWidth(this.el.nativeElement),r=e.top+(We.getOuterHeight(this.el.nativeElement)-We.getOuterHeight(this.container))/2;this.container.style.left=n+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignLeft(){this.preAlign("left");let e=this.getHostOffset(),n=e.left-We.getOuterWidth(this.container),r=e.top+(We.getOuterHeight(this.el.nativeElement)-We.getOuterHeight(this.container))/2;this.container.style.left=n+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignTop(){this.preAlign("top");let e=this.getHostOffset(),n=e.left+(We.getOuterWidth(this.el.nativeElement)-We.getOuterWidth(this.container))/2,r=e.top-We.getOuterHeight(this.container);this.container.style.left=n+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}alignBottom(){this.preAlign("bottom");let e=this.getHostOffset(),n=e.left+(We.getOuterWidth(this.el.nativeElement)-We.getOuterWidth(this.container))/2,r=e.top+We.getOuterHeight(this.el.nativeElement);this.container.style.left=n+this.getOption("positionLeft")+"px",this.container.style.top=r+this.getOption("positionTop")+"px"}setOption(e){this._tooltipOptions=Object.assign(Object.assign({},this._tooltipOptions),e)}getOption(e){return this._tooltipOptions[e]}getTarget(e){return We.hasClass(e,"p-inputwrapper")?We.findSingle(e,"input"):e}preAlign(e){this.container.style.left="-999px",this.container.style.top="-999px";let n="p-tooltip p-component p-tooltip-"+e;this.container.className=this.getOption("tooltipStyleClass")?n+" "+this.getOption("tooltipStyleClass"):n}isOutOfBounds(){let e=this.container.getBoundingClientRect(),n=e.top,r=e.left,o=We.getOuterWidth(this.container),c=We.getOuterHeight(this.container),u=We.getViewport();return r+o>u.width||r<0||n<0||n+c>u.height}onWindowResize(e){this.hide()}bindDocumentResizeListener(){this.zone.runOutsideAngular(()=>{this.resizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.resizeListener)})}unbindDocumentResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new hA(this.el.nativeElement,()=>{this.container&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindEvents(){if("hover"===this.getOption("tooltipEvent"))this.el.nativeElement.removeEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.removeEventListener("mouseleave",this.mouseLeaveListener),this.el.nativeElement.removeEventListener("click",this.clickListener);else if("focus"===this.getOption("tooltipEvent")){let e=this.getTarget(this.el.nativeElement);e.removeEventListener("focus",this.focusListener),e.removeEventListener("blur",this.blurListener)}this.unbindDocumentResizeListener()}remove(){this.container&&this.container.parentElement&&("body"===this.getOption("appendTo")?document.body.removeChild(this.container):"target"===this.getOption("appendTo")?this.el.nativeElement.removeChild(this.container):We.removeChild(this.container,this.getOption("appendTo"))),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.clearTimeouts(),this.container=null,this.scrollHandler=null}clearShowTimeout(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)}clearHideTimeout(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout()}ngOnDestroy(){this.unbindEvents(),this.container&&ls.clear(this.container),this.remove(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null)}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(gr),te(Bp))},t.\u0275dir=Ln({type:t,selectors:[["","pTooltip",""]],hostAttrs:[1,"p-element"],inputs:{tooltipPosition:"tooltipPosition",tooltipEvent:"tooltipEvent",appendTo:"appendTo",positionStyle:"positionStyle",tooltipStyleClass:"tooltipStyleClass",tooltipZIndex:"tooltipZIndex",escape:"escape",showDelay:"showDelay",hideDelay:"hideDelay",life:"life",positionTop:"positionTop",positionLeft:"positionLeft",text:["pTooltip","text"],disabled:["tooltipDisabled","disabled"],tooltipOptions:"tooltipOptions"},features:[Vs]}),t})(),GL=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro]]}),t})();function tG(t,i){if(1&t&&(f(0,"span"),_(1),p()),2&t){const e=A();v(1),U(e.label||"empty")}}function nG(t,i){1&t&&Jn(0)}const KL=function(t){return{height:t}},iG=function(t,i){return{"p-dropdown-item":!0,"p-highlight":t,"p-disabled":i}},SA=function(t){return{$implicit:t}},rG=["container"],oG=["filter"],sG=["in"],aG=["editableInput"];function lG(t,i){if(1&t&&(ni(0),_(1),Si()),2&t){const e=A(2);v(1),U(e.label||"empty")}}function cG(t,i){1&t&&Jn(0)}const uG=function(t){return{"p-dropdown-label p-inputtext":!0,"p-dropdown-label-empty":t}};function dG(t,i){if(1&t&&(f(0,"span",12),D(1,lG,2,1,"ng-container",13),D(2,cG,1,0,"ng-container",14),p()),2&t){const e=A();T("ngClass",Ei(9,uG,null==e.label||0===e.label.length))("pTooltip",e.tooltip)("tooltipPosition",e.tooltipPosition)("positionStyle",e.tooltipPositionStyle)("tooltipStyleClass",e.tooltipStyleClass),Ai("id",e.labelId),v(1),T("ngIf",!e.selectedItemTemplate),v(1),T("ngTemplateOutlet",e.selectedItemTemplate)("ngTemplateOutletContext",Ei(11,SA,e.selectedOption))}}const fG=function(t){return{"p-dropdown-label p-inputtext p-placeholder":!0,"p-dropdown-label-empty":t}};function pG(t,i){if(1&t&&(f(0,"span",15),_(1),p()),2&t){const e=A();T("ngClass",Ei(2,fG,null==e.placeholder||0===e.placeholder.length)),v(1),U(e.placeholder||"empty")}}function hG(t,i){if(1&t){const e=Ie();f(0,"input",16,17),L("click",function(){return z(e),A().onEditableInputClick()})("input",function(r){return z(e),A().onEditableInputChange(r)})("focus",function(r){return z(e),A().onEditableInputFocus(r)})("blur",function(r){return z(e),A().onInputBlur(r)}),p()}if(2&t){const e=A();T("disabled",e.disabled),Ai("maxlength",e.maxlength)("placeholder",e.placeholder)("aria-expanded",e.overlayVisible)}}function mG(t,i){if(1&t){const e=Ie();f(0,"i",18),L("click",function(r){return z(e),A().clear(r)}),p()}}function gG(t,i){1&t&&Jn(0)}function _G(t,i){if(1&t){const e=Ie();f(0,"div",26)(1,"div",27),L("click",function(r){return r.stopPropagation()}),f(2,"input",28,29),L("keydown.enter",function(r){return r.preventDefault()})("keydown",function(r){return z(e),A(2).onKeydown(r,!1)})("input",function(r){return z(e),A(2).onFilterInputChange(r)}),p(),ee(4,"span",30),p()()}if(2&t){const e=A(2);v(2),T("value",e.filterValue||""),Ai("placeholder",e.filterPlaceholder)("aria-label",e.ariaFilterLabel)("aria-activedescendant",e.overlayVisible?"p-highlighted-option":e.labelId)}}function vG(t,i){if(1&t&&(f(0,"span"),_(1),p()),2&t){const e=A().$implicit,n=A(3);v(1),U(n.getOptionGroupLabel(e)||"empty")}}function yG(t,i){1&t&&Jn(0)}function bG(t,i){1&t&&Jn(0)}const YL=function(t,i){return{$implicit:t,selectedOption:i}};function xG(t,i){if(1&t&&(f(0,"li",32),D(1,vG,2,1,"span",13),D(2,yG,1,0,"ng-container",14),p(),D(3,bG,1,0,"ng-container",14)),2&t){const e=i.$implicit;A(2);const n=Fa(8),r=A();v(1),T("ngIf",!r.groupTemplate),v(1),T("ngTemplateOutlet",r.groupTemplate)("ngTemplateOutletContext",Ei(5,SA,e)),v(1),T("ngTemplateOutlet",n)("ngTemplateOutletContext",ia(7,YL,r.getOptionGroupChildren(e),r.selectedOption))}}function wG(t,i){if(1&t&&(ni(0),D(1,xG,4,10,"ng-template",31),Si()),2&t){const e=A(2);v(1),T("ngForOf",e.optionsToDisplay)}}function CG(t,i){1&t&&Jn(0)}function TG(t,i){if(1&t&&(ni(0),D(1,CG,1,0,"ng-container",14),Si()),2&t){A();const e=Fa(8),n=A();v(1),T("ngTemplateOutlet",e)("ngTemplateOutletContext",ia(2,YL,n.optionsToDisplay,n.selectedOption))}}function SG(t,i){if(1&t){const e=Ie();f(0,"p-dropdownItem",35),L("onClick",function(r){return z(e),A(4).onItemClick(r)}),p()}if(2&t){const e=i.$implicit,n=A(2).selectedOption,r=A(2);T("option",e)("selected",n==e)("label",r.getOptionLabel(e))("disabled",r.isOptionDisabled(e))("template",r.itemTemplate)}}function EG(t,i){if(1&t&&(ni(0),D(1,SG,1,5,"ng-template",31),Si()),2&t){const e=A().$implicit;v(1),T("ngForOf",e)}}function kG(t,i){if(1&t){const e=Ie();ni(0),f(1,"p-dropdownItem",35),L("onClick",function(r){return z(e),A(5).onItemClick(r)}),p(),Si()}if(2&t){const e=i.$implicit,n=A(3).selectedOption,r=A(2);v(1),T("option",e)("selected",n==e)("label",r.getOptionLabel(e))("disabled",r.isOptionDisabled(e))("template",r.itemTemplate)}}function DG(t,i){if(1&t){const e=Ie();f(0,"cdk-virtual-scroll-viewport",37,38),L("scrolledIndexChange",function(){return z(e),A(4).scrollToSelectedVirtualScrollElement()}),D(2,kG,2,5,"ng-container",39),p()}if(2&t){const e=A(2).$implicit,n=A(2);T("ngStyle",Ei(3,KL,n.scrollHeight))("itemSize",n.itemSize),v(2),T("cdkVirtualForOf",e)}}function IG(t,i){if(1&t&&D(0,DG,3,5,"cdk-virtual-scroll-viewport",36),2&t){const e=A(3);T("ngIf",e.virtualScroll&&e.optionsToDisplay&&e.optionsToDisplay.length)}}function AG(t,i){if(1&t&&(D(0,EG,2,1,"ng-container",33),D(1,IG,1,1,"ng-template",null,34,m3)),2&t){const e=Fa(2);T("ngIf",!A(2).virtualScroll)("ngIfElse",e)}}function MG(t,i){if(1&t&&(ni(0),_(1),Si()),2&t){const e=A(3);v(1),hn(" ",e.emptyFilterMessageLabel," ")}}function FG(t,i){1&t&&Jn(0,null,41)}function PG(t,i){if(1&t&&(f(0,"li",40),D(1,MG,2,1,"ng-container",33),D(2,FG,2,0,"ng-container",20),p()),2&t){const e=A(2);v(1),T("ngIf",!e.emptyFilterTemplate&&!e.emptyTemplate)("ngIfElse",e.emptyFilter),v(1),T("ngTemplateOutlet",e.emptyFilterTemplate||e.emptyTemplate)}}function OG(t,i){if(1&t&&(ni(0),_(1),Si()),2&t){const e=A(3);v(1),hn(" ",e.emptyMessageLabel," ")}}function NG(t,i){1&t&&Jn(0,null,42)}function LG(t,i){if(1&t&&(f(0,"li",40),D(1,OG,2,1,"ng-container",33),D(2,NG,2,0,"ng-container",20),p()),2&t){const e=A(2);v(1),T("ngIf",!e.emptyTemplate)("ngIfElse",e.empty),v(1),T("ngTemplateOutlet",e.emptyTemplate)}}function RG(t,i){1&t&&Jn(0)}const BG=function(t,i){return{showTransitionParams:t,hideTransitionParams:i}},jG=function(t){return{value:"visible",params:t}},VG=function(t){return{"p-dropdown-virtualscroll":t}};function UG(t,i){if(1&t){const e=Ie();f(0,"div",19),L("click",function(r){return z(e),A().onOverlayClick(r)})("@overlayAnimation.start",function(r){return z(e),A().onOverlayAnimationStart(r)})("@overlayAnimation.start",function(r){return z(e),A().onOverlayAnimationEnd(r)}),D(1,gG,1,0,"ng-container",20),D(2,_G,5,4,"div",21),f(3,"div",22)(4,"ul",23),D(5,wG,2,1,"ng-container",13),D(6,TG,2,5,"ng-container",13),D(7,AG,3,2,"ng-template",null,24,m3),D(9,PG,3,3,"li",25),D(10,LG,3,3,"li",25),p()(),D(11,RG,1,0,"ng-container",20),p()}if(2&t){const e=A();Ji(e.panelStyleClass),T("ngClass","p-dropdown-panel p-component")("@overlayAnimation",Ei(19,jG,ia(16,BG,e.showTransitionOptions,e.hideTransitionOptions)))("ngStyle",e.panelStyle),v(1),T("ngTemplateOutlet",e.headerTemplate),v(1),T("ngIf",e.filter),v(1),ud("max-height",e.virtualScroll?"auto":e.scrollHeight||"auto"),v(1),T("ngClass",Ei(21,VG,e.virtualScroll)),Ai("id",e.listId),v(1),T("ngIf",e.group),v(1),T("ngIf",!e.group),v(3),T("ngIf",e.filterValue&&e.isEmpty()),v(1),T("ngIf",!e.filterValue&&e.isEmpty()),v(1),T("ngTemplateOutlet",e.footerTemplate)}}const HG=function(t,i,e,n){return{"p-dropdown p-component":!0,"p-disabled":t,"p-dropdown-open":i,"p-focus":e,"p-dropdown-clearable":n}},zG={provide:Ra,useExisting:tr(()=>us),multi:!0};let $G=(()=>{class t{constructor(){this.onClick=new Et}onOptionClick(e){this.onClick.emit({originalEvent:e,option:this.option})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=dn({type:t,selectors:[["p-dropdownItem"]],hostAttrs:[1,"p-element"],inputs:{option:"option",selected:"selected",label:"label",disabled:"disabled",visible:"visible",itemSize:"itemSize",template:"template"},outputs:{onClick:"onClick"},decls:3,vars:15,consts:[["role","option","pRipple","",3,"ngStyle","id","ngClass","click"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,n){1&e&&(f(0,"li",0),L("click",function(o){return n.onOptionClick(o)}),D(1,tG,2,1,"span",1),D(2,nG,1,0,"ng-container",2),p()),2&e&&(T("ngStyle",Ei(8,KL,n.itemSize+"px"))("id",n.selected?"p-highlighted-option":"")("ngClass",ia(10,iG,n.selected,n.disabled)),Ai("aria-label",n.label)("aria-selected",n.selected),v(1),T("ngIf",!n.template),v(1),T("ngTemplateOutlet",n.template)("ngTemplateOutletContext",Ei(13,SA,n.option)))},directives:[Vp,La,Na,Sn,ic],encapsulation:2}),t})(),us=(()=>{class t{constructor(e,n,r,o,c,u,m){this.el=e,this.renderer=n,this.cd=r,this.zone=o,this.filterService=c,this.config=u,this.overlayService=m,this.scrollHeight="200px",this.resetFilterOnHide=!1,this.dropdownIcon="pi pi-chevron-down",this.optionGroupChildren="items",this.autoDisplayFirst=!0,this.emptyFilterMessage="",this.emptyMessage="",this.autoZIndex=!0,this.baseZIndex=0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.filterMatchMode="contains",this.tooltip="",this.tooltipPosition="right",this.tooltipPositionStyle="absolute",this.autofocusFilter=!0,this.onChange=new Et,this.onFilter=new Et,this.onFocus=new Et,this.onBlur=new Et,this.onClick=new Et,this.onShow=new Et,this.onHide=new Et,this.onClear=new Et,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.viewPortOffsetTop=0,this.id=N0()}get disabled(){return this._disabled}set disabled(e){e&&(this.focused=!1,this.overlayVisible&&this.hide()),this._disabled=e,this.cd.destroyed||this.cd.detectChanges()}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":default:this.itemTemplate=e.template;break;case"selectedItem":this.selectedItemTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"emptyfilter":this.emptyFilterTemplate=e.template;break;case"empty":this.emptyTemplate=e.template;break;case"group":this.groupTemplate=e.template}})}ngOnInit(){this.optionsToDisplay=this.options,this.updateSelectedOption(null),this.labelId=this.id+"_label",this.listId=this.id+"_list"}get options(){return this._options}set options(e){this._options=e,this.optionsToDisplay=this._options,this.updateSelectedOption(this.value),this.selectedOption=this.findOption(this.value,this.optionsToDisplay),this.selectedOption||(this.value=null,this.onModelChange(this.value)),this.optionsChanged=!0,this._filterValue&&this._filterValue.length&&this.activateFilter()}get filterValue(){return this._filterValue}set filterValue(e){this._filterValue=e,this.activateFilter()}ngAfterViewInit(){this.editable&&this.updateEditableLabel()}get label(){return this.selectedOption?this.getOptionLabel(this.selectedOption):null}get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(Fl.EMPTY_MESSAGE)}get emptyFilterMessageLabel(){return this.emptyFilterMessage||this.config.getTranslation(Fl.EMPTY_FILTER_MESSAGE)}get filled(){return this.value||null!=this.value||null!=this.value}updateEditableLabel(){this.editableInputViewChild&&this.editableInputViewChild.nativeElement&&(this.editableInputViewChild.nativeElement.value=this.selectedOption?this.getOptionLabel(this.selectedOption):this.value||"")}getOptionLabel(e){return this.optionLabel?Pn.resolveFieldData(e,this.optionLabel):null!=e.label?e.label:e}getOptionValue(e){return this.optionValue?Pn.resolveFieldData(e,this.optionValue):this.optionLabel||void 0===e.value?e:e.value}isOptionDisabled(e){return this.optionDisabled?Pn.resolveFieldData(e,this.optionDisabled):void 0!==e.disabled&&e.disabled}getOptionGroupLabel(e){return this.optionGroupLabel?Pn.resolveFieldData(e,this.optionGroupLabel):null!=e.label?e.label:e}getOptionGroupChildren(e){return this.optionGroupChildren?Pn.resolveFieldData(e,this.optionGroupChildren):e.items}onItemClick(e){const n=e.option;this.isOptionDisabled(n)||(this.selectItem(e.originalEvent,n),this.accessibleViewChild.nativeElement.focus()),setTimeout(()=>{this.hide()},150)}selectItem(e,n){this.selectedOption!=n&&(this.selectedOption=n,this.value=this.getOptionValue(n),this.onModelChange(this.value),this.updateEditableLabel(),this.onChange.emit({originalEvent:e,value:this.value}),this.virtualScroll&&setTimeout(()=>{this.viewPortOffsetTop=this.viewPort?this.viewPort.measureScrollOffset():0},1))}ngAfterViewChecked(){if(this.optionsChanged&&this.overlayVisible&&(this.optionsChanged=!1,this.virtualScroll&&this.updateVirtualScrollSelectedIndex(!0),this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.alignOverlay()},1)})),this.selectedOptionUpdated&&this.itemsWrapper){if(this.virtualScroll&&this.viewPort){let n=this.viewPort.getRenderedRange();this.updateVirtualScrollSelectedIndex(!1),(n.start>this.virtualScrollSelectedIndex||n.end<this.virtualScrollSelectedIndex)&&this.viewPort.scrollToIndex(this.virtualScrollSelectedIndex)}We.findSingle(this.overlay,"li.p-highlight")&&We.scrollInView(this.itemsWrapper,We.findSingle(this.overlay,"li.p-highlight")),this.selectedOptionUpdated=!1}}writeValue(e){this.filter&&this.resetFilter(),this.value=e,this.updateSelectedOption(e),this.updateEditableLabel(),this.cd.markForCheck()}resetFilter(){this._filterValue=null,this.filterViewChild&&this.filterViewChild.nativeElement&&(this.filterViewChild.nativeElement.value=""),this.optionsToDisplay=this.options}updateSelectedOption(e){this.selectedOption=this.findOption(e,this.optionsToDisplay),this.autoDisplayFirst&&!this.placeholder&&!this.selectedOption&&this.optionsToDisplay&&this.optionsToDisplay.length&&!this.editable&&(this.selectedOption=this.group?this.optionsToDisplay[0].items[0]:this.optionsToDisplay[0],this.value=this.getOptionValue(this.selectedOption),this.onModelChange(this.value)),this.selectedOptionUpdated=!0}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onMouseclick(e){this.disabled||this.readonly||this.isInputClick(e)||(this.onClick.emit(e),this.accessibleViewChild.nativeElement.focus(),this.overlayVisible?this.hide():this.show(),this.cd.detectChanges())}onOverlayClick(e){this.overlayService.add({originalEvent:e,target:this.el.nativeElement})}isInputClick(e){return We.hasClass(e.target,"p-dropdown-clear-icon")||e.target.isSameNode(this.accessibleViewChild.nativeElement)||this.editableInputViewChild&&e.target.isSameNode(this.editableInputViewChild.nativeElement)}isOutsideClicked(e){return!(this.el.nativeElement.isSameNode(e.target)||this.el.nativeElement.contains(e.target)||this.overlay&&this.overlay.contains(e.target))}isEmpty(){return!this.optionsToDisplay||this.optionsToDisplay&&0===this.optionsToDisplay.length}onEditableInputClick(){this.bindDocumentClickListener()}onEditableInputFocus(e){this.focused=!0,this.hide(),this.onFocus.emit(e)}onEditableInputChange(e){this.value=e.target.value,this.updateSelectedOption(this.value),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value})}show(){this.overlayVisible=!0,this.cd.markForCheck()}onOverlayAnimationStart(e){switch(e.toState){case"visible":if(this.overlay=e.element,this.itemsWrapper=We.findSingle(this.overlay,this.virtualScroll?".cdk-virtual-scroll-viewport":".p-dropdown-items-wrapper"),this.appendOverlay(),this.autoZIndex&&ls.set("overlay",this.overlay,this.baseZIndex+this.config.zIndex.overlay),this.alignOverlay(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener(),this.options&&this.options.length&&!this.virtualScroll){let r=We.findSingle(this.itemsWrapper,".p-dropdown-item.p-highlight");r&&r.scrollIntoView({block:"nearest",inline:"center"})}this.filterViewChild&&this.filterViewChild.nativeElement&&(this.preventModelTouched=!0,this.autofocusFilter&&this.filterViewChild.nativeElement.focus()),this.onShow.emit(e);break;case"void":this.onOverlayHide(),this.onHide.emit(e)}}onOverlayAnimationEnd(e){"void"===e.toState&&ls.clear(e.element)}scrollToSelectedVirtualScrollElement(){this.virtualAutoScrolled||(this.viewPortOffsetTop?this.viewPort.scrollToOffset(this.viewPortOffsetTop):this.virtualScrollSelectedIndex>-1&&this.viewPort.scrollToIndex(this.virtualScrollSelectedIndex)),this.virtualAutoScrolled=!0}updateVirtualScrollSelectedIndex(e){this.selectedOption&&this.optionsToDisplay&&this.optionsToDisplay.length&&(e&&(this.viewPortOffsetTop=0),this.virtualScrollSelectedIndex=this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay))}appendOverlay(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.overlay):We.appendChild(this.overlay,this.appendTo),this.overlay.style.minWidth||(this.overlay.style.minWidth=We.getWidth(this.containerViewChild.nativeElement)+"px"))}restoreOverlayAppend(){this.overlay&&this.appendTo&&this.el.nativeElement.appendChild(this.overlay)}hide(){this.overlayVisible=!1,this.filter&&this.resetFilterOnHide&&this.resetFilter(),this.virtualScroll&&(this.virtualAutoScrolled=!1),this.cd.markForCheck()}alignOverlay(){this.overlay&&(this.appendTo?We.absolutePosition(this.overlay,this.containerViewChild.nativeElement):We.relativePosition(this.overlay,this.containerViewChild.nativeElement))}onInputFocus(e){this.focused=!0,this.onFocus.emit(e)}onInputBlur(e){this.focused=!1,this.onBlur.emit(e),this.preventModelTouched||this.onModelTouched(),this.preventModelTouched=!1}findPrevEnabledOption(e){let n;if(this.optionsToDisplay&&this.optionsToDisplay.length){for(let r=e-1;0<=r;r--){let o=this.optionsToDisplay[r];if(!this.isOptionDisabled(o)){n=o;break}}if(!n)for(let r=this.optionsToDisplay.length-1;r>=e;r--){let o=this.optionsToDisplay[r];if(!this.isOptionDisabled(o)){n=o;break}}}return n}findNextEnabledOption(e){let n;if(this.optionsToDisplay&&this.optionsToDisplay.length){for(let r=e+1;r<this.optionsToDisplay.length;r++){let o=this.optionsToDisplay[r];if(!this.isOptionDisabled(o)){n=o;break}}if(!n)for(let r=0;r<e;r++){let o=this.optionsToDisplay[r];if(!this.isOptionDisabled(o)){n=o;break}}}return n}onKeydown(e,n){if(!this.readonly&&this.optionsToDisplay&&null!==this.optionsToDisplay.length)switch(e.which){case 40:if(!this.overlayVisible&&e.altKey)this.show();else if(this.group){let r=this.selectedOption?this.findOptionGroupIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;if(-1!==r){let o=r.itemIndex+1;o<this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex]).length?(this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex])[o]),this.selectedOptionUpdated=!0):this.optionsToDisplay[r.groupIndex+1]&&(this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex+1])[0]),this.selectedOptionUpdated=!0)}else this.optionsToDisplay&&this.optionsToDisplay.length>0&&this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[0])[0])}else{let r=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1,o=this.findNextEnabledOption(r);o&&(this.selectItem(e,o),this.selectedOptionUpdated=!0)}e.preventDefault();break;case 38:if(this.group){let r=this.selectedOption?this.findOptionGroupIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;if(-1!==r){let o=r.itemIndex-1;if(o>=0)this.selectItem(e,this.getOptionGroupChildren(this.optionsToDisplay[r.groupIndex])[o]),this.selectedOptionUpdated=!0;else if(o<0){let c=this.optionsToDisplay[r.groupIndex-1];c&&(this.selectItem(e,this.getOptionGroupChildren(c)[this.getOptionGroupChildren(c).length-1]),this.selectedOptionUpdated=!0)}}}else{let r=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1,o=this.findPrevEnabledOption(r);o&&(this.selectItem(e,o),this.selectedOptionUpdated=!0)}e.preventDefault();break;case 32:n&&(this.overlayVisible?this.hide():this.show(),e.preventDefault());break;case 13:this.overlayVisible&&(!this.filter||this.optionsToDisplay&&this.optionsToDisplay.length>0)?this.hide():this.overlayVisible||this.show(),e.preventDefault();break;case 27:case 9:this.hide();break;default:n&&!e.metaKey&&this.search(e)}}search(e){this.searchTimeout&&clearTimeout(this.searchTimeout);const n=e.key;let r;if(this.previousSearchChar=this.currentSearchChar,this.currentSearchChar=n,this.searchValue=this.previousSearchChar===this.currentSearchChar?this.currentSearchChar:this.searchValue?this.searchValue+n:n,this.group){let o=this.selectedOption?this.findOptionGroupIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):{groupIndex:0,itemIndex:0};r=this.searchOptionWithinGroup(o)}else{let o=this.selectedOption?this.findOptionIndex(this.getOptionValue(this.selectedOption),this.optionsToDisplay):-1;r=this.searchOption(++o)}r&&!this.isOptionDisabled(r)&&(this.selectItem(e,r),this.selectedOptionUpdated=!0),this.searchTimeout=setTimeout(()=>{this.searchValue=null},250)}searchOption(e){let n;return this.searchValue&&(n=this.searchOptionInRange(e,this.optionsToDisplay.length),n||(n=this.searchOptionInRange(0,e))),n}searchOptionInRange(e,n){for(let r=e;r<n;r++){let o=this.optionsToDisplay[r];if(this.getOptionLabel(o).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))&&!this.isOptionDisabled(o))return o}return null}searchOptionWithinGroup(e){if(this.searchValue){for(let r=e.groupIndex;r<this.optionsToDisplay.length;r++)for(let o=e.groupIndex===r?e.itemIndex+1:0;o<this.getOptionGroupChildren(this.optionsToDisplay[r]).length;o++){let c=this.getOptionGroupChildren(this.optionsToDisplay[r])[o];if(this.getOptionLabel(c).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))&&!this.isOptionDisabled(c))return c}for(let r=0;r<=e.groupIndex;r++)for(let o=0;o<(e.groupIndex===r?e.itemIndex:this.getOptionGroupChildren(this.optionsToDisplay[r]).length);o++){let c=this.getOptionGroupChildren(this.optionsToDisplay[r])[o];if(this.getOptionLabel(c).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))&&!this.isOptionDisabled(c))return c}}return null}findOptionIndex(e,n){let r=-1;if(n)for(let o=0;o<n.length;o++)if(null==e&&null==this.getOptionValue(n[o])||Pn.equals(e,this.getOptionValue(n[o]),this.dataKey)){r=o;break}return r}findOptionGroupIndex(e,n){let r,o;if(n)for(let c=0;c<n.length&&(r=c,o=this.findOptionIndex(e,this.getOptionGroupChildren(n[c])),-1===o);c++);return-1!==o?{groupIndex:r,itemIndex:o}:-1}findOption(e,n,r){if(this.group&&!r){let o;if(n&&n.length)for(let c of n)if(o=this.findOption(e,this.getOptionGroupChildren(c),!0),o)break;return o}{let o=this.findOptionIndex(e,n);return-1!=o?n[o]:null}}onFilterInputChange(e){let n=e.target.value;n&&n.length?(this._filterValue=n,this.activateFilter()):(this._filterValue=null,this.optionsToDisplay=this.options),this.optionsChanged=!0,this.onFilter.emit({originalEvent:e,filter:this._filterValue})}activateFilter(){let e=(this.filterBy||this.optionLabel||"label").split(",");if(this.options&&this.options.length){if(this.group){let n=[];for(let r of this.options){let o=this.filterService.filter(this.getOptionGroupChildren(r),e,this.filterValue,this.filterMatchMode,this.filterLocale);o&&o.length&&n.push(Object.assign(Object.assign({},r),{[this.optionGroupChildren]:o}))}this.optionsToDisplay=n}else this.optionsToDisplay=this.filterService.filter(this.options,e,this.filterValue,this.filterMatchMode,this.filterLocale);this.optionsChanged=!0}}applyFocus(){this.editable?We.findSingle(this.el.nativeElement,".p-dropdown-label.p-inputtext").focus():We.findSingle(this.el.nativeElement,"input[readonly]").focus()}focus(){this.applyFocus()}bindDocumentClickListener(){this.documentClickListener||(this.documentClickListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","click",n=>{!this.preventDocumentDefault&&this.isOutsideClicked(n)&&(this.hide(),this.unbindDocumentClickListener()),this.preventDocumentDefault=!1}))}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}onWindowResize(){this.overlayVisible&&!We.isTouchDevice()&&this.hide()}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new hA(this.containerViewChild.nativeElement,e=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}clear(e){this.value=null,this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value}),this.updateSelectedOption(this.value),this.updateEditableLabel(),this.onClear.emit(e)}onOverlayHide(){this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.overlay=null,this.itemsWrapper=null,this.onModelTouched()}ngOnDestroy(){this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&ls.clear(this.overlay),this.restoreOverlayAppend(),this.onOverlayHide()}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(Ss),te(Wo),te(gr),te(bL),te(Bp),te(pA))},t.\u0275cmp=dn({type:t,selectors:[["p-dropdown"]],contentQueries:function(e,n,r){if(1&e&&ol(r,zn,4),2&e){let o;xt(o=wt())&&(n.templates=o)}},viewQuery:function(e,n){if(1&e&&(Mt(rG,5),Mt(oG,5),Mt(sG,5),Mt(Wy,5),Mt(aG,5)),2&e){let r;xt(r=wt())&&(n.containerViewChild=r.first),xt(r=wt())&&(n.filterViewChild=r.first),xt(r=wt())&&(n.accessibleViewChild=r.first),xt(r=wt())&&(n.viewPort=r.first),xt(r=wt())&&(n.editableInputViewChild=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:4,hostBindings:function(e,n){2&e&&po("p-inputwrapper-filled",n.filled)("p-inputwrapper-focus",n.focused||n.overlayVisible)},inputs:{scrollHeight:"scrollHeight",filter:"filter",name:"name",style:"style",panelStyle:"panelStyle",styleClass:"styleClass",panelStyleClass:"panelStyleClass",readonly:"readonly",required:"required",editable:"editable",appendTo:"appendTo",tabindex:"tabindex",placeholder:"placeholder",filterPlaceholder:"filterPlaceholder",filterLocale:"filterLocale",inputId:"inputId",selectId:"selectId",dataKey:"dataKey",filterBy:"filterBy",autofocus:"autofocus",resetFilterOnHide:"resetFilterOnHide",dropdownIcon:"dropdownIcon",optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",optionGroupLabel:"optionGroupLabel",optionGroupChildren:"optionGroupChildren",autoDisplayFirst:"autoDisplayFirst",group:"group",showClear:"showClear",emptyFilterMessage:"emptyFilterMessage",emptyMessage:"emptyMessage",virtualScroll:"virtualScroll",itemSize:"itemSize",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",ariaFilterLabel:"ariaFilterLabel",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",filterMatchMode:"filterMatchMode",maxlength:"maxlength",tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",autofocusFilter:"autofocusFilter",disabled:"disabled",options:"options",filterValue:"filterValue"},outputs:{onChange:"onChange",onFilter:"onFilter",onFocus:"onFocus",onBlur:"onBlur",onClick:"onClick",onShow:"onShow",onHide:"onHide",onClear:"onClear"},features:[Nn([zG])],decls:12,vars:25,consts:[[3,"ngClass","ngStyle","click"],["container",""],[1,"p-hidden-accessible"],["type","text","readonly","","aria-haspopup","listbox","aria-haspopup","listbox","role","combobox",3,"disabled","focus","blur","keydown"],["in",""],[3,"ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass",4,"ngIf"],[3,"ngClass",4,"ngIf"],["type","text","class","p-dropdown-label p-inputtext","aria-haspopup","listbox",3,"disabled","click","input","focus","blur",4,"ngIf"],["class","p-dropdown-clear-icon pi pi-times",3,"click",4,"ngIf"],["role","button","aria-label","dropdown trigger","aria-haspopup","listbox",1,"p-dropdown-trigger"],[1,"p-dropdown-trigger-icon",3,"ngClass"],["onOverlayAnimationEnd","",3,"ngClass","ngStyle","class","click",4,"ngIf"],[3,"ngClass","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass"],["type","text","aria-haspopup","listbox",1,"p-dropdown-label","p-inputtext",3,"disabled","click","input","focus","blur"],["editableInput",""],[1,"p-dropdown-clear-icon","pi","pi-times",3,"click"],["onOverlayAnimationEnd","",3,"ngClass","ngStyle","click"],[4,"ngTemplateOutlet"],["class","p-dropdown-header",4,"ngIf"],[1,"p-dropdown-items-wrapper"],["role","listbox",1,"p-dropdown-items",3,"ngClass"],["itemslist",""],["class","p-dropdown-empty-message",4,"ngIf"],[1,"p-dropdown-header"],[1,"p-dropdown-filter-container",3,"click"],["type","text","autocomplete","off",1,"p-dropdown-filter","p-inputtext","p-component",3,"value","keydown.enter","keydown","input"],["filter",""],[1,"p-dropdown-filter-icon","pi","pi-search"],["ngFor","",3,"ngForOf"],[1,"p-dropdown-item-group"],[4,"ngIf","ngIfElse"],["virtualScrollList",""],[3,"option","selected","label","disabled","template","onClick"],[3,"ngStyle","itemSize","scrolledIndexChange",4,"ngIf"],[3,"ngStyle","itemSize","scrolledIndexChange"],["viewport",""],[4,"cdkVirtualFor","cdkVirtualForOf"],[1,"p-dropdown-empty-message"],["emptyFilter",""],["empty",""]],template:function(e,n){1&e&&(f(0,"div",0,1),L("click",function(o){return n.onMouseclick(o)}),f(2,"div",2)(3,"input",3,4),L("focus",function(o){return n.onInputFocus(o)})("blur",function(o){return n.onInputBlur(o)})("keydown",function(o){return n.onKeydown(o,!0)}),p()(),D(5,dG,3,13,"span",5),D(6,pG,2,4,"span",6),D(7,hG,2,4,"input",7),D(8,mG,1,0,"i",8),f(9,"div",9),ee(10,"span",10),p(),D(11,UG,12,23,"div",11),p()),2&e&&(Ji(n.styleClass),T("ngClass",Dp(20,HG,n.disabled,n.overlayVisible,n.focused,n.showClear&&!n.disabled))("ngStyle",n.style),v(3),T("disabled",n.disabled),Ai("id",n.inputId)("placeholder",n.placeholder)("aria-label",n.ariaLabel)("aria-expanded",!1)("aria-labelledby",n.ariaLabelledBy)("tabindex",n.tabindex)("autofocus",n.autofocus)("aria-activedescendant",n.overlayVisible?n.labelId:null),v(2),T("ngIf",!n.editable&&null!=n.label),v(1),T("ngIf",!n.editable&&null==n.label),v(1),T("ngIf",n.editable),v(1),T("ngIf",null!=n.value&&n.showClear&&!n.disabled),v(1),Ai("aria-expanded",n.overlayVisible),v(1),T("ngClass",n.dropdownIcon),v(1),T("ngIf",n.overlayVisible))},directives:[$G,Wy,Na,La,Sn,qL,ic,nc,VL,$L],styles:[".p-dropdown{display:inline-flex;cursor:pointer;position:relative;-webkit-user-select:none;user-select:none}.p-dropdown-clear-icon{position:absolute;top:50%;margin-top:-.5rem}.p-dropdown-trigger{display:flex;align-items:center;justify-content:center;flex-shrink:0}.p-dropdown-label{display:block;white-space:nowrap;overflow:hidden;flex:1 1 auto;width:1%;text-overflow:ellipsis;cursor:pointer}.p-dropdown-label-empty{overflow:hidden;visibility:hidden}input.p-dropdown-label{cursor:default}.p-dropdown .p-dropdown-panel{min-width:100%}.p-dropdown-panel{position:absolute;top:0;left:0}.p-dropdown-items-wrapper{overflow:auto}.p-dropdown-item{cursor:pointer;font-weight:400;white-space:nowrap;position:relative;overflow:hidden}.p-dropdown-items{margin:0;padding:0;list-style-type:none}.p-dropdown-filter{width:100%}.p-dropdown-filter-container{position:relative}.p-dropdown-filter-icon{position:absolute;top:50%;margin-top:-.5rem}.p-fluid .p-dropdown{display:flex}.p-fluid .p-dropdown .p-dropdown-label{width:1%}\n"],encapsulation:2,data:{animation:[km("overlayAnimation",[ul(":enter",[cs({opacity:0,transform:"scaleY(0.8)"}),Pl("{{showTransitionParams}}")]),ul(":leave",[Pl("{{hideTransitionParams}}",cs({opacity:0}))])])]},changeDetection:0}),t})(),Im=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro,Uc,bT,GL,_f],Uc,bT]}),t})(),li=(()=>{class t{constructor(e,n,r){this.el=e,this.ngModel=n,this.cd=r}ngAfterViewInit(){this.updateFilledState(),this.cd.detectChanges()}ngDoCheck(){this.updateFilledState()}onInput(e){this.updateFilledState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length||this.ngModel&&this.ngModel.model}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(md,8),te(Wo))},t.\u0275dir=Ln({type:t,selectors:[["","pInputText",""]],hostAttrs:[1,"p-inputtext","p-component","p-element"],hostVars:2,hostBindings:function(e,n){1&e&&L("input",function(o){return n.onInput(o)}),2&e&&po("p-filled",n.filled)}}),t})(),qy=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro]]}),t})(),_r=(()=>{class t{constructor(e){this.el=e,this.iconPos="left",this.loadingIcon="pi pi-spinner pi-spin",this._loading=!1}ngAfterViewInit(){this._initialStyleClass=this.el.nativeElement.className,We.addMultipleClasses(this.el.nativeElement,this.getStyleClass()),(this.icon||this.loading)&&this.createIconEl();let e=document.createElement("span");this.icon&&!this.label&&e.setAttribute("aria-hidden","true"),e.className="p-button-label",this.label?e.appendChild(document.createTextNode(this.label)):e.innerHTML="&nbsp;",this.el.nativeElement.appendChild(e),this.initialized=!0}getStyleClass(){let e="p-button p-component";return this.icon&&!this.label&&(e+=" p-button-icon-only"),this.loading&&(e+=" p-disabled p-button-loading",!this.icon&&this.label&&(e+=" p-button-loading-label-only")),e}setStyleClass(){let e=this.getStyleClass();this.el.nativeElement.className=e+" "+this._initialStyleClass}createIconEl(){let e=document.createElement("span");e.className="p-button-icon",e.setAttribute("aria-hidden","true");let n=this.label?"p-button-icon-"+this.iconPos:null;n&&We.addClass(e,n);let r=this.getIconClass();r&&We.addMultipleClasses(e,r);let o=We.findSingle(this.el.nativeElement,".p-button-label");o?this.el.nativeElement.insertBefore(e,o):this.el.nativeElement.appendChild(e)}getIconClass(){return this.loading?"p-button-loading-icon "+this.loadingIcon:this._icon}setIconClass(){let e=We.findSingle(this.el.nativeElement,".p-button-icon");e?e.className=this.iconPos?"p-button-icon p-button-icon-"+this.iconPos+" "+this.getIconClass():"p-button-icon "+this.getIconClass():this.createIconEl()}removeIconElement(){let e=We.findSingle(this.el.nativeElement,".p-button-icon");this.el.nativeElement.removeChild(e)}get label(){return this._label}set label(e){this._label=e,this.initialized&&(We.findSingle(this.el.nativeElement,".p-button-label").textContent=this._label||"&nbsp;",(this.loading||this.icon)&&this.setIconClass(),this.setStyleClass())}get icon(){return this._icon}set icon(e){this._icon=e,this.initialized&&(this.setIconClass(),this.setStyleClass())}get loading(){return this._loading}set loading(e){this._loading=e,this.initialized&&(this.loading||this.icon?this.setIconClass():this.removeIconElement(),this.setStyleClass())}ngOnDestroy(){this.initialized=!1}}return t.\u0275fac=function(e){return new(e||t)(te(mr))},t.\u0275dir=Ln({type:t,selectors:[["","pButton",""]],hostAttrs:[1,"p-element"],inputs:{iconPos:"iconPos",loadingIcon:"loadingIcon",label:"label",icon:"icon",loading:"loading"}}),t})(),Up=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro,_f]]}),t})();const qG=["input"];function GG(t,i){if(1&t){const e=Ie();f(0,"i",6),L("click",function(){return z(e),A().clear()}),p()}}const XL=function(){return{"p-inputnumber-button p-inputnumber-button-up":!0}},QL=function(){return{"p-inputnumber-button p-inputnumber-button-down":!0}};function KG(t,i){if(1&t){const e=Ie();f(0,"span",7)(1,"button",8),L("mousedown",function(r){return z(e),A().onUpButtonMouseDown(r)})("mouseup",function(){return z(e),A().onUpButtonMouseUp()})("mouseleave",function(){return z(e),A().onUpButtonMouseLeave()})("keydown",function(r){return z(e),A().onUpButtonKeyDown(r)})("keyup",function(){return z(e),A().onUpButtonKeyUp()}),p(),f(2,"button",8),L("mousedown",function(r){return z(e),A().onDownButtonMouseDown(r)})("mouseup",function(){return z(e),A().onDownButtonMouseUp()})("mouseleave",function(){return z(e),A().onDownButtonMouseLeave()})("keydown",function(r){return z(e),A().onDownButtonKeyDown(r)})("keyup",function(){return z(e),A().onDownButtonKeyUp()}),p()()}if(2&t){const e=A();v(1),Ji(e.incrementButtonClass),T("ngClass",rt(10,XL))("icon",e.incrementButtonIcon)("disabled",e.disabled),v(1),Ji(e.decrementButtonClass),T("ngClass",rt(11,QL))("icon",e.decrementButtonIcon)("disabled",e.disabled)}}function YG(t,i){if(1&t){const e=Ie();f(0,"button",8),L("mousedown",function(r){return z(e),A().onUpButtonMouseDown(r)})("mouseup",function(){return z(e),A().onUpButtonMouseUp()})("mouseleave",function(){return z(e),A().onUpButtonMouseLeave()})("keydown",function(r){return z(e),A().onUpButtonKeyDown(r)})("keyup",function(){return z(e),A().onUpButtonKeyUp()}),p()}if(2&t){const e=A();Ji(e.incrementButtonClass),T("ngClass",rt(5,XL))("icon",e.incrementButtonIcon)("disabled",e.disabled)}}function XG(t,i){if(1&t){const e=Ie();f(0,"button",8),L("mousedown",function(r){return z(e),A().onDownButtonMouseDown(r)})("mouseup",function(){return z(e),A().onDownButtonMouseUp()})("mouseleave",function(){return z(e),A().onDownButtonMouseLeave()})("keydown",function(r){return z(e),A().onDownButtonKeyDown(r)})("keyup",function(){return z(e),A().onDownButtonKeyUp()}),p()}if(2&t){const e=A();Ji(e.decrementButtonClass),T("ngClass",rt(5,QL))("icon",e.decrementButtonIcon)("disabled",e.disabled)}}const QG=function(t,i,e){return{"p-inputnumber p-component":!0,"p-inputnumber-buttons-stacked":t,"p-inputnumber-buttons-horizontal":i,"p-inputnumber-buttons-vertical":e}},JG={provide:Ra,useExisting:tr(()=>JL),multi:!0};let JL=(()=>{class t{constructor(e,n){this.el=e,this.cd=n,this.showButtons=!1,this.format=!0,this.buttonLayout="stacked",this.incrementButtonIcon="pi pi-angle-up",this.decrementButtonIcon="pi pi-angle-down",this.readonly=!1,this.step=1,this.allowEmpty=!0,this.mode="decimal",this.useGrouping=!0,this.showClear=!1,this.onInput=new Et,this.onFocus=new Et,this.onBlur=new Et,this.onKeyDown=new Et,this.onClear=new Et,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.groupChar="",this.prefixChar="",this.suffixChar=""}get disabled(){return this._disabled}set disabled(e){e&&(this.focused=!1),this._disabled=e,this.timer&&this.clearTimer()}ngOnChanges(e){["locale","localeMatcher","mode","currency","currencyDisplay","useGrouping","minFractionDigits","maxFractionDigits","prefix","suffix"].some(r=>!!e[r])&&this.updateConstructParser()}ngOnInit(){this.constructParser(),this.initialized=!0}getOptions(){return{localeMatcher:this.localeMatcher,style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,useGrouping:this.useGrouping,minimumFractionDigits:this.minFractionDigits,maximumFractionDigits:this.maxFractionDigits}}constructParser(){this.numberFormat=new Intl.NumberFormat(this.locale,this.getOptions());const e=[...new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)].reverse(),n=new Map(e.map((r,o)=>[r,o]));this._numeral=new RegExp(`[${e.join("")}]`,"g"),this._group=this.getGroupingExpression(),this._minusSign=this.getMinusSignExpression(),this._currency=this.getCurrencyExpression(),this._decimal=this.getDecimalExpression(),this._suffix=this.getSuffixExpression(),this._prefix=this.getPrefixExpression(),this._index=r=>n.get(r)}updateConstructParser(){this.initialized&&this.constructParser()}escapeRegExp(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}getDecimalExpression(){const e=new Intl.NumberFormat(this.locale,Object.assign(Object.assign({},this.getOptions()),{useGrouping:!1}));return new RegExp(`[${e.format(1.1).replace(this._currency,"").trim().replace(this._numeral,"")}]`,"g")}getGroupingExpression(){const e=new Intl.NumberFormat(this.locale,{useGrouping:!0});return this.groupChar=e.format(1e6).trim().replace(this._numeral,"").charAt(0),new RegExp(`[${this.groupChar}]`,"g")}getMinusSignExpression(){const e=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp(`[${e.format(-1).trim().replace(this._numeral,"")}]`,"g")}getCurrencyExpression(){if(this.currency){const e=new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});return new RegExp(`[${e.format(1).replace(/\s/g,"").replace(this._numeral,"").replace(this._group,"")}]`,"g")}return new RegExp("[]","g")}getPrefixExpression(){if(this.prefix)this.prefixChar=this.prefix;else{const e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay});this.prefixChar=e.format(1).split("1")[0]}return new RegExp(`${this.escapeRegExp(this.prefixChar||"")}`,"g")}getSuffixExpression(){if(this.suffix)this.suffixChar=this.suffix;else{const e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});this.suffixChar=e.format(1).split("1")[1]}return new RegExp(`${this.escapeRegExp(this.suffixChar||"")}`,"g")}formatValue(e){if(null!=e){if("-"===e)return e;if(this.format){let r=new Intl.NumberFormat(this.locale,this.getOptions()).format(e);return this.prefix&&(r=this.prefix+r),this.suffix&&(r+=this.suffix),r}return e.toString()}return""}parseValue(e){let n=e.replace(this._suffix,"").replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").replace(this._group,"").replace(this._minusSign,"-").replace(this._decimal,".").replace(this._numeral,this._index);if(n){if("-"===n)return n;let r=+n;return isNaN(r)?null:r}return null}repeat(e,n,r){if(this.readonly)return;let o=n||500;this.clearTimer(),this.timer=setTimeout(()=>{this.repeat(e,40,r)},o),this.spin(e,r)}spin(e,n){let r=this.step*n,o=this.parseValue(this.input.nativeElement.value)||0,c=this.validateValue(o+r);this.maxlength&&this.maxlength<this.formatValue(c).length||(this.updateInput(c,null,"spin",null),this.updateModel(e,c),this.handleOnInput(e,o,c))}clear(){this.value=null,this.onModelChange(this.value),this.onClear.emit()}onUpButtonMouseDown(e){this.input.nativeElement.focus(),this.repeat(e,null,1),e.preventDefault()}onUpButtonMouseUp(){this.clearTimer()}onUpButtonMouseLeave(){this.clearTimer()}onUpButtonKeyDown(e){(32===e.keyCode||13===e.keyCode)&&this.repeat(e,null,1)}onUpButtonKeyUp(){this.clearTimer()}onDownButtonMouseDown(e){this.input.nativeElement.focus(),this.repeat(e,null,-1),e.preventDefault()}onDownButtonMouseUp(){this.clearTimer()}onDownButtonMouseLeave(){this.clearTimer()}onDownButtonKeyUp(){this.clearTimer()}onDownButtonKeyDown(e){(32===e.keyCode||13===e.keyCode)&&this.repeat(e,null,-1)}onUserInput(e){this.readonly||(this.isSpecialChar&&(e.target.value=this.lastValue),this.isSpecialChar=!1)}onInputKeyDown(e){if(this.readonly)return;if(this.lastValue=e.target.value,e.shiftKey||e.altKey)return void(this.isSpecialChar=!0);let n=e.target.selectionStart,r=e.target.selectionEnd,o=e.target.value,c=null;switch(e.altKey&&e.preventDefault(),e.which){case 38:this.spin(e,1),e.preventDefault();break;case 40:this.spin(e,-1),e.preventDefault();break;case 37:this.isNumeralChar(o.charAt(n-1))||e.preventDefault();break;case 39:this.isNumeralChar(o.charAt(n))||e.preventDefault();break;case 13:c=this.validateValue(this.parseValue(this.input.nativeElement.value)),this.input.nativeElement.value=this.formatValue(c),this.input.nativeElement.setAttribute("aria-valuenow",c),this.updateModel(e,c);break;case 8:if(e.preventDefault(),n===r){const u=o.charAt(n-1),{decimalCharIndex:m,decimalCharIndexWithoutPrefix:g}=this.getDecimalCharIndexes(o);if(this.isNumeralChar(u)){const x=this.getDecimalLength(o);if(this._group.test(u))this._group.lastIndex=0,c=o.slice(0,n-2)+o.slice(n-1);else if(this._decimal.test(u))this._decimal.lastIndex=0,x?this.input.nativeElement.setSelectionRange(n-1,n-1):c=o.slice(0,n-1)+o.slice(n);else if(m>0&&n>m){const S=this.isDecimalMode()&&(this.minFractionDigits||0)<x?"":"0";c=o.slice(0,n-1)+S+o.slice(n)}else 1===g?(c=o.slice(0,n-1)+"0"+o.slice(n),c=this.parseValue(c)>0?c:""):c=o.slice(0,n-1)+o.slice(n)}this.updateValue(e,c,null,"delete-single")}else c=this.deleteRange(o,n,r),this.updateValue(e,c,null,"delete-range");break;case 46:if(e.preventDefault(),n===r){const u=o.charAt(n),{decimalCharIndex:m,decimalCharIndexWithoutPrefix:g}=this.getDecimalCharIndexes(o);if(this.isNumeralChar(u)){const x=this.getDecimalLength(o);if(this._group.test(u))this._group.lastIndex=0,c=o.slice(0,n)+o.slice(n+2);else if(this._decimal.test(u))this._decimal.lastIndex=0,x?this.input.nativeElement.setSelectionRange(n+1,n+1):c=o.slice(0,n)+o.slice(n+1);else if(m>0&&n>m){const S=this.isDecimalMode()&&(this.minFractionDigits||0)<x?"":"0";c=o.slice(0,n)+S+o.slice(n+1)}else 1===g?(c=o.slice(0,n)+"0"+o.slice(n+1),c=this.parseValue(c)>0?c:""):c=o.slice(0,n)+o.slice(n+1)}this.updateValue(e,c,null,"delete-back-single")}else c=this.deleteRange(o,n,r),this.updateValue(e,c,null,"delete-range")}this.onKeyDown.emit(e)}onInputKeyPress(e){if(this.readonly)return;e.preventDefault();let n=e.which||e.keyCode,r=String.fromCharCode(n);const o=this.isDecimalSign(r),c=this.isMinusSign(r);(48<=n&&n<=57||c||o)&&this.insert(e,r,{isDecimalSign:o,isMinusSign:c})}onPaste(e){if(!this.disabled&&!this.readonly){e.preventDefault();let n=(e.clipboardData||window.clipboardData).getData("Text");if(n){let r=this.parseValue(n);null!=r&&this.insert(e,r.toString())}}}allowMinusSign(){return null==this.min||this.min<0}isMinusSign(e){return!(!this._minusSign.test(e)&&"-"!==e||(this._minusSign.lastIndex=0,0))}isDecimalSign(e){return!!this._decimal.test(e)&&(this._decimal.lastIndex=0,!0)}isDecimalMode(){return"decimal"===this.mode}getDecimalCharIndexes(e){let n=e.search(this._decimal);this._decimal.lastIndex=0;const o=e.replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").search(this._decimal);return this._decimal.lastIndex=0,{decimalCharIndex:n,decimalCharIndexWithoutPrefix:o}}getCharIndexes(e){const n=e.search(this._decimal);this._decimal.lastIndex=0;const r=e.search(this._minusSign);this._minusSign.lastIndex=0;const o=e.search(this._suffix);this._suffix.lastIndex=0;const c=e.search(this._currency);return this._currency.lastIndex=0,{decimalCharIndex:n,minusCharIndex:r,suffixCharIndex:o,currencyCharIndex:c}}insert(e,n,r={isDecimalSign:!1,isMinusSign:!1}){const o=n.search(this._minusSign);if(this._minusSign.lastIndex=0,!this.allowMinusSign()&&-1!==o)return;let c=this.input.nativeElement.selectionStart,u=this.input.nativeElement.selectionEnd,m=this.input.nativeElement.value.trim();const{decimalCharIndex:g,minusCharIndex:x,suffixCharIndex:S,currencyCharIndex:M}=this.getCharIndexes(m);let E;if(r.isMinusSign)0===c&&(E=m,(-1===x||0!==u)&&(E=this.insertText(m,n,0,u)),this.updateValue(e,E,n,"insert"));else if(r.isDecimalSign)g>0&&c===g?this.updateValue(e,m,n,"insert"):(g>c&&g<u||-1===g&&this.maxFractionDigits)&&(E=this.insertText(m,n,c,u),this.updateValue(e,E,n,"insert"));else{const R=this.numberFormat.resolvedOptions().maximumFractionDigits,B=c!==u?"range-insert":"insert";if(g>0&&c>g){if(c+n.length-(g+1)<=R){const K=M>=c?M-1:S>=c?S:m.length;E=m.slice(0,c)+n+m.slice(c+n.length,K)+m.slice(K),this.updateValue(e,E,n,B)}}else E=this.insertText(m,n,c,u),this.updateValue(e,E,n,B)}}insertText(e,n,r,o){if(2===("."===n?n:n.split(".")).length){const u=e.slice(r,o).search(this._decimal);return this._decimal.lastIndex=0,u>0?e.slice(0,r)+this.formatValue(n)+e.slice(o):e||this.formatValue(n)}return o-r===e.length?this.formatValue(n):0===r?n+e.slice(o):o===e.length?e.slice(0,r)+n:e.slice(0,r)+n+e.slice(o)}deleteRange(e,n,r){let o;return o=r-n===e.length?"":0===n?e.slice(r):r===e.length?e.slice(0,n):e.slice(0,n)+e.slice(r),o}initCursor(){let e=this.input.nativeElement.selectionStart,n=this.input.nativeElement.value,r=n.length,o=null,c=(this.prefixChar||"").length;n=n.replace(this._prefix,""),e-=c;let u=n.charAt(e);if(this.isNumeralChar(u))return e+c;let m=e-1;for(;m>=0;){if(u=n.charAt(m),this.isNumeralChar(u)){o=m+c;break}m--}if(null!==o)this.input.nativeElement.setSelectionRange(o+1,o+1);else{for(m=e;m<r;){if(u=n.charAt(m),this.isNumeralChar(u)){o=m+c;break}m++}null!==o&&this.input.nativeElement.setSelectionRange(o,o)}return o||0}onInputClick(){this.readonly||this.initCursor()}isNumeralChar(e){return!(1!==e.length||!(this._numeral.test(e)||this._decimal.test(e)||this._group.test(e)||this._minusSign.test(e))||(this.resetRegex(),0))}resetRegex(){this._numeral.lastIndex=0,this._decimal.lastIndex=0,this._group.lastIndex=0,this._minusSign.lastIndex=0}updateValue(e,n,r,o){let c=this.input.nativeElement.value,u=null;null!=n&&(u=this.parseValue(n),u=u||this.allowEmpty?u:0,this.updateInput(u,r,o,n),this.handleOnInput(e,c,u))}handleOnInput(e,n,r){this.isValueChanged(n,r)&&this.onInput.emit({originalEvent:e,value:r})}isValueChanged(e,n){return null===n&&null!==e||null!=n&&n!==("string"==typeof e?this.parseValue(e):e)}validateValue(e){return"-"===e||null==e?null:null!=this.min&&e<this.min?this.min:null!=this.max&&e>this.max?this.max:e}updateInput(e,n,r,o){n=n||"";let c=this.input.nativeElement.value,u=this.formatValue(e),m=c.length;if(u!==o&&(u=this.concatValues(u,o)),0===m){this.input.nativeElement.value=u,this.input.nativeElement.setSelectionRange(0,0);const x=this.initCursor()+n.length;this.input.nativeElement.setSelectionRange(x,x)}else{let g=this.input.nativeElement.selectionStart,x=this.input.nativeElement.selectionEnd;if(this.maxlength&&this.maxlength<u.length)return;this.input.nativeElement.value=u;let S=u.length;if("range-insert"===r){const M=this.parseValue((c||"").slice(0,g)),R=(null!==M?M.toString():"").split("").join(`(${this.groupChar})?`),B=new RegExp(R,"g");B.test(u);const K=n.split("").join(`(${this.groupChar})?`),q=new RegExp(K,"g");q.test(u.slice(B.lastIndex)),x=B.lastIndex+q.lastIndex,this.input.nativeElement.setSelectionRange(x,x)}else if(S===m)"insert"===r||"delete-back-single"===r?this.input.nativeElement.setSelectionRange(x+1,x+1):"delete-single"===r?this.input.nativeElement.setSelectionRange(x-1,x-1):("delete-range"===r||"spin"===r)&&this.input.nativeElement.setSelectionRange(x,x);else if("delete-back-single"===r){let M=c.charAt(x-1),E=c.charAt(x),R=m-S,B=this._group.test(E);B&&1===R?x+=1:!B&&this.isNumeralChar(M)&&(x+=-1*R+1),this._group.lastIndex=0,this.input.nativeElement.setSelectionRange(x,x)}else if("-"===c&&"insert"===r){this.input.nativeElement.setSelectionRange(0,0);const E=this.initCursor()+n.length+1;this.input.nativeElement.setSelectionRange(E,E)}else x+=S-m,this.input.nativeElement.setSelectionRange(x,x)}this.input.nativeElement.setAttribute("aria-valuenow",e)}concatValues(e,n){if(e&&n){let r=n.search(this._decimal);return this._decimal.lastIndex=0,-1!==r?e.split(this._decimal)[0]+n.slice(r):e}return e}getDecimalLength(e){if(e){const n=e.split(this._decimal);if(2===n.length)return n[1].replace(this._suffix,"").trim().replace(/\s/g,"").replace(this._currency,"").length}return 0}onInputFocus(e){this.focused=!0,this.onFocus.emit(e)}onInputBlur(e){this.focused=!1;let n=this.validateValue(this.parseValue(this.input.nativeElement.value));this.input.nativeElement.value=this.formatValue(n),this.input.nativeElement.setAttribute("aria-valuenow",n),this.updateModel(e,n),this.onBlur.emit(e)}formattedValue(){return this.formatValue(this.value||this.allowEmpty?this.value:0)}updateModel(e,n){this.value!==n&&(this.value=n,this.onModelChange(n)),this.onModelTouched()}writeValue(e){this.value=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}get filled(){return null!=this.value&&this.value.toString().length>0}clearTimer(){this.timer&&clearInterval(this.timer)}getFormatter(){return this.numberFormat}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(Wo))},t.\u0275cmp=dn({type:t,selectors:[["p-inputNumber"]],viewQuery:function(e,n){if(1&e&&Mt(qG,5),2&e){let r;xt(r=wt())&&(n.input=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(e,n){2&e&&po("p-inputwrapper-filled",n.filled)("p-inputwrapper-focus",n.focused)("p-inputnumber-clearable",n.showClear&&"vertical"!=n.buttonLayout)},inputs:{showButtons:"showButtons",format:"format",buttonLayout:"buttonLayout",inputId:"inputId",styleClass:"styleClass",style:"style",placeholder:"placeholder",size:"size",maxlength:"maxlength",tabindex:"tabindex",title:"title",ariaLabel:"ariaLabel",ariaRequired:"ariaRequired",name:"name",required:"required",autocomplete:"autocomplete",min:"min",max:"max",incrementButtonClass:"incrementButtonClass",decrementButtonClass:"decrementButtonClass",incrementButtonIcon:"incrementButtonIcon",decrementButtonIcon:"decrementButtonIcon",readonly:"readonly",step:"step",allowEmpty:"allowEmpty",locale:"locale",localeMatcher:"localeMatcher",mode:"mode",currency:"currency",currencyDisplay:"currencyDisplay",useGrouping:"useGrouping",minFractionDigits:"minFractionDigits",maxFractionDigits:"maxFractionDigits",prefix:"prefix",suffix:"suffix",inputStyle:"inputStyle",inputStyleClass:"inputStyleClass",showClear:"showClear",disabled:"disabled"},outputs:{onInput:"onInput",onFocus:"onFocus",onBlur:"onBlur",onKeyDown:"onKeyDown",onClear:"onClear"},features:[Nn([JG]),Vs],decls:7,vars:32,consts:[[3,"ngClass","ngStyle"],["pInputText","","inputmode","decimal",3,"ngClass","ngStyle","value","disabled","readonly","input","keydown","keypress","paste","click","focus","blur"],["input",""],["class","p-inputnumber-clear-icon pi pi-times",3,"click",4,"ngIf"],["class","p-inputnumber-button-group",4,"ngIf"],["type","button","pButton","",3,"ngClass","class","icon","disabled","mousedown","mouseup","mouseleave","keydown","keyup",4,"ngIf"],[1,"p-inputnumber-clear-icon","pi","pi-times",3,"click"],[1,"p-inputnumber-button-group"],["type","button","pButton","",3,"ngClass","icon","disabled","mousedown","mouseup","mouseleave","keydown","keyup"]],template:function(e,n){1&e&&(f(0,"span",0)(1,"input",1,2),L("input",function(o){return n.onUserInput(o)})("keydown",function(o){return n.onInputKeyDown(o)})("keypress",function(o){return n.onInputKeyPress(o)})("paste",function(o){return n.onPaste(o)})("click",function(){return n.onInputClick()})("focus",function(o){return n.onInputFocus(o)})("blur",function(o){return n.onInputBlur(o)}),p(),D(3,GG,1,0,"i",3),D(4,KG,3,12,"span",4),D(5,YG,1,6,"button",5),D(6,XG,1,6,"button",5),p()),2&e&&(Ji(n.styleClass),T("ngClass",kp(28,QG,n.showButtons&&"stacked"===n.buttonLayout,n.showButtons&&"horizontal"===n.buttonLayout,n.showButtons&&"vertical"===n.buttonLayout))("ngStyle",n.style),v(1),Ji(n.inputStyleClass),T("ngClass","p-inputnumber-input")("ngStyle",n.inputStyle)("value",n.formattedValue())("disabled",n.disabled)("readonly",n.readonly),Ai("placeholder",n.placeholder)("title",n.title)("id",n.inputId)("size",n.size)("name",n.name)("autocomplete",n.autocomplete)("maxlength",n.maxlength)("tabindex",n.tabindex)("aria-label",n.ariaLabel)("aria-required",n.ariaRequired)("required",n.required)("min",n.min)("max",n.max),v(2),T("ngIf","vertical"!=n.buttonLayout&&n.showClear&&n.value),v(1),T("ngIf",n.showButtons&&"stacked"===n.buttonLayout),v(1),T("ngIf",n.showButtons&&"stacked"!==n.buttonLayout),v(1),T("ngIf",n.showButtons&&"stacked"!==n.buttonLayout))},directives:[Na,La,li,Sn,_r],styles:["p-inputnumber,.p-inputnumber{display:inline-flex}.p-inputnumber-button{display:flex;align-items:center;justify-content:center;flex:0 0 auto}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button .p-button-label,.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button .p-button-label{display:none}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-up{border-top-left-radius:0;border-bottom-left-radius:0;border-bottom-right-radius:0;padding:0}.p-inputnumber-buttons-stacked .p-inputnumber-input{border-top-right-radius:0;border-bottom-right-radius:0}.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-down{border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:0;padding:0}.p-inputnumber-buttons-stacked .p-inputnumber-button-group{display:flex;flex-direction:column}.p-inputnumber-buttons-stacked .p-inputnumber-button-group .p-button.p-inputnumber-button{flex:1 1 auto}.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-up{order:3;border-top-left-radius:0;border-bottom-left-radius:0}.p-inputnumber-buttons-horizontal .p-inputnumber-input{order:2;border-radius:0}.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-down{order:1;border-top-right-radius:0;border-bottom-right-radius:0}.p-inputnumber-buttons-vertical{flex-direction:column}.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-up{order:1;border-bottom-left-radius:0;border-bottom-right-radius:0;width:100%}.p-inputnumber-buttons-vertical .p-inputnumber-input{order:2;border-radius:0;text-align:center}.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-down{order:3;border-top-left-radius:0;border-top-right-radius:0;width:100%}.p-inputnumber-input{flex:1 1 auto}.p-fluid p-inputnumber,.p-fluid .p-inputnumber{width:100%}.p-fluid .p-inputnumber .p-inputnumber-input{width:1%}.p-fluid .p-inputnumber-buttons-vertical .p-inputnumber-input{width:100%}.p-inputnumber-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-inputnumber-clearable{position:relative}\n"],encapsulation:2,changeDetection:0}),t})(),j0=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro,qy,Up]]}),t})();function ZG(t,i){1&t&&Jn(0)}const EA=function(t){return{$implicit:t}};function eK(t,i){if(1&t&&(f(0,"div",15),D(1,ZG,1,0,"ng-container",16),p()),2&t){const e=A(2);v(1),T("ngTemplateOutlet",e.templateLeft)("ngTemplateOutletContext",Ei(2,EA,e.paginatorState))}}function tK(t,i){if(1&t&&(f(0,"span",17),_(1),p()),2&t){const e=A(2);v(1),U(e.currentPageReport)}}const xT=function(t){return{"p-disabled":t}};function nK(t,i){if(1&t){const e=Ie();f(0,"button",18),L("click",function(r){return z(e),A(2).changePageToFirst(r)}),ee(1,"span",19),p()}if(2&t){const e=A(2);T("disabled",e.isFirstPage()||e.empty())("ngClass",Ei(2,xT,e.isFirstPage()||e.empty()))}}const iK=function(t){return{"p-highlight":t}};function rK(t,i){if(1&t){const e=Ie();f(0,"button",22),L("click",function(r){const c=z(e).$implicit;return A(3).onPageLinkClick(r,c-1)}),_(1),p()}if(2&t){const e=i.$implicit,n=A(3);T("ngClass",Ei(2,iK,e-1==n.getPage())),v(1),U(e)}}function oK(t,i){if(1&t&&(f(0,"span",20),D(1,rK,2,4,"button",21),p()),2&t){const e=A(2);v(1),T("ngForOf",e.pageLinks)}}function sK(t,i){1&t&&_(0),2&t&&U(A(3).currentPageReport)}function aK(t,i){if(1&t){const e=Ie();f(0,"p-dropdown",23),L("onChange",function(r){return z(e),A(2).onPageDropdownChange(r)}),D(1,sK,1,1,"ng-template",24),p()}if(2&t){const e=A(2);T("options",e.pageItems)("ngModel",e.getPage())("disabled",e.empty())("appendTo",e.dropdownAppendTo)("scrollHeight",e.dropdownScrollHeight)}}function lK(t,i){if(1&t){const e=Ie();f(0,"button",25),L("click",function(r){return z(e),A(2).changePageToLast(r)}),ee(1,"span",26),p()}if(2&t){const e=A(2);T("disabled",e.isLastPage()||e.empty())("ngClass",Ei(2,xT,e.isLastPage()||e.empty()))}}function cK(t,i){if(1&t){const e=Ie();f(0,"p-inputNumber",27),L("ngModelChange",function(r){return z(e),A(2).changePage(r-1)}),p()}if(2&t){const e=A(2);T("ngModel",e.currentPage())("disabled",e.empty())}}function uK(t,i){1&t&&Jn(0)}function dK(t,i){if(1&t&&D(0,uK,1,0,"ng-container",16),2&t){const e=i.$implicit;T("ngTemplateOutlet",A(4).dropdownItemTemplate)("ngTemplateOutletContext",Ei(2,EA,e))}}function fK(t,i){1&t&&(ni(0),D(1,dK,1,4,"ng-template",30),Si())}function pK(t,i){if(1&t){const e=Ie();f(0,"p-dropdown",28),L("ngModelChange",function(r){return z(e),A(2).rows=r})("onChange",function(r){return z(e),A(2).onRppChange(r)}),D(1,fK,2,0,"ng-container",29),p()}if(2&t){const e=A(2);T("options",e.rowsPerPageItems)("ngModel",e.rows)("disabled",e.empty())("appendTo",e.dropdownAppendTo)("scrollHeight",e.dropdownScrollHeight),v(1),T("ngIf",e.dropdownItemTemplate)}}function hK(t,i){1&t&&Jn(0)}function mK(t,i){if(1&t&&(f(0,"div",31),D(1,hK,1,0,"ng-container",16),p()),2&t){const e=A(2);v(1),T("ngTemplateOutlet",e.templateRight)("ngTemplateOutletContext",Ei(2,EA,e.paginatorState))}}function gK(t,i){if(1&t){const e=Ie();f(0,"div",1),D(1,eK,2,4,"div",2),D(2,tK,2,1,"span",3),D(3,nK,2,4,"button",4),f(4,"button",5),L("click",function(r){return z(e),A().changePageToPrev(r)}),ee(5,"span",6),p(),D(6,oK,2,1,"span",7),D(7,aK,2,5,"p-dropdown",8),f(8,"button",9),L("click",function(r){return z(e),A().changePageToNext(r)}),ee(9,"span",10),p(),D(10,lK,2,4,"button",11),D(11,cK,1,2,"p-inputNumber",12),D(12,pK,2,6,"p-dropdown",13),D(13,mK,2,4,"div",14),p()}if(2&t){const e=A();Ji(e.styleClass),T("ngStyle",e.style)("ngClass","p-paginator p-component"),v(1),T("ngIf",e.templateLeft),v(1),T("ngIf",e.showCurrentPageReport),v(1),T("ngIf",e.showFirstLastIcon),v(1),T("disabled",e.isFirstPage()||e.empty())("ngClass",Ei(17,xT,e.isFirstPage()||e.empty())),v(2),T("ngIf",e.showPageLinks),v(1),T("ngIf",e.showJumpToPageDropdown),v(1),T("disabled",e.isLastPage()||e.empty())("ngClass",Ei(19,xT,e.isLastPage()||e.empty())),v(2),T("ngIf",e.showFirstLastIcon),v(1),T("ngIf",e.showJumpToPageInput),v(1),T("ngIf",e.rowsPerPageOptions),v(1),T("ngIf",e.templateRight)}}let _K=(()=>{class t{constructor(e){this.cd=e,this.pageLinkSize=5,this.onPageChange=new Et,this.alwaysShow=!0,this.dropdownScrollHeight="200px",this.currentPageReportTemplate="{currentPage} of {totalPages}",this.showFirstLastIcon=!0,this.totalRecords=0,this.rows=0,this.showPageLinks=!0,this._first=0,this._page=0}ngOnInit(){this.updatePaginatorState()}ngOnChanges(e){e.totalRecords&&(this.updatePageLinks(),this.updatePaginatorState(),this.updateFirst(),this.updateRowsPerPageOptions()),e.first&&(this._first=e.first.currentValue,this.updatePageLinks(),this.updatePaginatorState()),e.rows&&(this.updatePageLinks(),this.updatePaginatorState()),e.rowsPerPageOptions&&this.updateRowsPerPageOptions()}get first(){return this._first}set first(e){this._first=e}updateRowsPerPageOptions(){if(this.rowsPerPageOptions){this.rowsPerPageItems=[];for(let e of this.rowsPerPageOptions)"object"==typeof e&&e.showAll?this.rowsPerPageItems.unshift({label:e.showAll,value:this.totalRecords}):this.rowsPerPageItems.push({label:String(e),value:e})}}isFirstPage(){return 0===this.getPage()}isLastPage(){return this.getPage()===this.getPageCount()-1}getPageCount(){return Math.ceil(this.totalRecords/this.rows)}calculatePageLinkBoundaries(){let e=this.getPageCount(),n=Math.min(this.pageLinkSize,e),r=Math.max(0,Math.ceil(this.getPage()-n/2)),o=Math.min(e-1,r+n-1);return r=Math.max(0,r-(this.pageLinkSize-(o-r+1))),[r,o]}updatePageLinks(){this.pageLinks=[];let e=this.calculatePageLinkBoundaries(),r=e[1];for(let o=e[0];o<=r;o++)this.pageLinks.push(o+1);if(this.showJumpToPageDropdown){this.pageItems=[];for(let o=0;o<this.getPageCount();o++)this.pageItems.push({label:String(o+1),value:o})}}changePage(e){var n=this.getPageCount();if(e>=0&&e<n){this._first=this.rows*e;var r={page:e,first:this.first,rows:this.rows,pageCount:n};this.updatePageLinks(),this.onPageChange.emit(r),this.updatePaginatorState()}}updateFirst(){const e=this.getPage();e>0&&this.totalRecords&&this.first>=this.totalRecords&&Promise.resolve(null).then(()=>this.changePage(e-1))}getPage(){return Math.floor(this.first/this.rows)}changePageToFirst(e){this.isFirstPage()||this.changePage(0),e.preventDefault()}changePageToPrev(e){this.changePage(this.getPage()-1),e.preventDefault()}changePageToNext(e){this.changePage(this.getPage()+1),e.preventDefault()}changePageToLast(e){this.isLastPage()||this.changePage(this.getPageCount()-1),e.preventDefault()}onPageLinkClick(e,n){this.changePage(n),e.preventDefault()}onRppChange(e){this.changePage(this.getPage())}onPageDropdownChange(e){this.changePage(e.value)}updatePaginatorState(){this.paginatorState={page:this.getPage(),pageCount:this.getPageCount(),rows:this.rows,first:this.first,totalRecords:this.totalRecords}}empty(){return 0===this.getPageCount()}currentPage(){return this.getPageCount()>0?this.getPage()+1:0}get currentPageReport(){return this.currentPageReportTemplate.replace("{currentPage}",String(this.currentPage())).replace("{totalPages}",String(this.getPageCount())).replace("{first}",String(this.totalRecords>0?this._first+1:0)).replace("{last}",String(Math.min(this._first+this.rows,this.totalRecords))).replace("{rows}",String(this.rows)).replace("{totalRecords}",String(this.totalRecords))}}return t.\u0275fac=function(e){return new(e||t)(te(Wo))},t.\u0275cmp=dn({type:t,selectors:[["p-paginator"]],hostAttrs:[1,"p-element"],inputs:{pageLinkSize:"pageLinkSize",style:"style",styleClass:"styleClass",alwaysShow:"alwaysShow",templateLeft:"templateLeft",templateRight:"templateRight",dropdownAppendTo:"dropdownAppendTo",dropdownScrollHeight:"dropdownScrollHeight",currentPageReportTemplate:"currentPageReportTemplate",showCurrentPageReport:"showCurrentPageReport",showFirstLastIcon:"showFirstLastIcon",totalRecords:"totalRecords",rows:"rows",rowsPerPageOptions:"rowsPerPageOptions",showJumpToPageDropdown:"showJumpToPageDropdown",showJumpToPageInput:"showJumpToPageInput",showPageLinks:"showPageLinks",dropdownItemTemplate:"dropdownItemTemplate",first:"first"},outputs:{onPageChange:"onPageChange"},features:[Vs],decls:1,vars:1,consts:[[3,"class","ngStyle","ngClass",4,"ngIf"],[3,"ngStyle","ngClass"],["class","p-paginator-left-content",4,"ngIf"],["class","p-paginator-current",4,"ngIf"],["type","button","pRipple","","class","p-paginator-first p-paginator-element p-link",3,"disabled","ngClass","click",4,"ngIf"],["type","button","pRipple","",1,"p-paginator-prev","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-left"],["class","p-paginator-pages",4,"ngIf"],["styleClass","p-paginator-page-options",3,"options","ngModel","disabled","appendTo","scrollHeight","onChange",4,"ngIf"],["type","button","pRipple","",1,"p-paginator-next","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-right"],["type","button","pRipple","","class","p-paginator-last p-paginator-element p-link",3,"disabled","ngClass","click",4,"ngIf"],["class","p-paginator-page-input",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["styleClass","p-paginator-rpp-options",3,"options","ngModel","disabled","appendTo","scrollHeight","ngModelChange","onChange",4,"ngIf"],["class","p-paginator-right-content",4,"ngIf"],[1,"p-paginator-left-content"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-paginator-current"],["type","button","pRipple","",1,"p-paginator-first","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-double-left"],[1,"p-paginator-pages"],["type","button","class","p-paginator-page p-paginator-element p-link","pRipple","",3,"ngClass","click",4,"ngFor","ngForOf"],["type","button","pRipple","",1,"p-paginator-page","p-paginator-element","p-link",3,"ngClass","click"],["styleClass","p-paginator-page-options",3,"options","ngModel","disabled","appendTo","scrollHeight","onChange"],["pTemplate","selectedItem"],["type","button","pRipple","",1,"p-paginator-last","p-paginator-element","p-link",3,"disabled","ngClass","click"],[1,"p-paginator-icon","pi","pi-angle-double-right"],[1,"p-paginator-page-input",3,"ngModel","disabled","ngModelChange"],["styleClass","p-paginator-rpp-options",3,"options","ngModel","disabled","appendTo","scrollHeight","ngModelChange","onChange"],[4,"ngIf"],["pTemplate","item"],[1,"p-paginator-right-content"]],template:function(e,n){1&e&&D(0,gK,14,21,"div",0),2&e&&T("ngIf",!!n.alwaysShow||n.pageLinks&&n.pageLinks.length>1)},directives:[us,JL,Sn,La,Na,ic,Vp,nc,Er,md,zn],styles:[".p-paginator{display:flex;align-items:center;justify-content:center;flex-wrap:wrap}.p-paginator-left-content{margin-right:auto}.p-paginator-right-content{margin-left:auto}.p-paginator-page,.p-paginator-next,.p-paginator-last,.p-paginator-first,.p-paginator-prev,.p-paginator-current{cursor:pointer;display:inline-flex;align-items:center;justify-content:center;line-height:1;-webkit-user-select:none;user-select:none;overflow:hidden;position:relative}.p-paginator-element:focus{z-index:1;position:relative}\n"],encapsulation:2,changeDetection:0}),t})(),ZL=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro,Im,j0,O0,Uc,_f],Im,j0,O0,Uc]}),t})();function vK(t,i){1&t&&ee(0,"span",8),2&t&&(Ji(A(2).$implicit.icon),T("ngClass","p-button-icon p-button-icon-left"))}function yK(t,i){if(1&t&&(ni(0),D(1,vK,1,3,"span",6),f(2,"span",7),_(3),p(),Si()),2&t){const e=A().$implicit,n=A();v(1),T("ngIf",e.icon),v(2),U(n.getOptionLabel(e))}}function bK(t,i){1&t&&Jn(0)}const xK=function(t,i){return{$implicit:t,index:i}};function wK(t,i){if(1&t&&D(0,bK,1,0,"ng-container",9),2&t){const e=A(),n=e.$implicit,r=e.index;T("ngTemplateOutlet",A().itemTemplate)("ngTemplateOutletContext",ia(2,xK,n,r))}}const CK=function(t,i,e){return{"p-highlight":t,"p-disabled":i,"p-button-icon-only":e}};function TK(t,i){if(1&t){const e=Ie();f(0,"div",2,3),L("click",function(r){const o=z(e),c=o.$implicit,u=o.index;return A().onItemClick(r,c,u)})("keydown.enter",function(r){const o=z(e),c=o.$implicit,u=o.index;return A().onItemClick(r,c,u)})("blur",function(){return z(e),A().onBlur()}),D(2,yK,4,2,"ng-container",4),D(3,wK,1,5,"ng-template",null,5,m3),p()}if(2&t){const e=i.$implicit,n=Fa(4),r=A();Ji(e.styleClass),T("ngClass",kp(10,CK,r.isSelected(e),r.disabled||r.isOptionDisabled(e),e.icon&&!r.getOptionLabel(e))),Ai("aria-pressed",r.isSelected(e))("title",e.title)("aria-label",e.label)("tabindex",r.disabled?null:r.tabindex)("aria-labelledby",r.getOptionLabel(e)),v(2),T("ngIf",!r.itemTemplate)("ngIfElse",n)}}const SK={provide:Ra,useExisting:tr(()=>EK),multi:!0};let EK=(()=>{class t{constructor(e){this.cd=e,this.tabindex=0,this.onOptionClick=new Et,this.onChange=new Et,this.onModelChange=()=>{},this.onModelTouched=()=>{}}getOptionLabel(e){return this.optionLabel?Pn.resolveFieldData(e,this.optionLabel):null!=e.label?e.label:e}getOptionValue(e){return this.optionValue?Pn.resolveFieldData(e,this.optionValue):this.optionLabel||void 0===e.value?e:e.value}isOptionDisabled(e){return this.optionDisabled?Pn.resolveFieldData(e,this.optionDisabled):void 0!==e.disabled&&e.disabled}writeValue(e){this.value=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onItemClick(e,n,r){if(!this.disabled&&!this.isOptionDisabled(n)){if(this.multiple)this.isSelected(n)?this.removeOption(n):this.value=[...this.value||[],this.getOptionValue(n)],this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value});else{let o=this.getOptionValue(n);this.value!==o&&(this.value=this.getOptionValue(n),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value}))}this.onOptionClick.emit({originalEvent:e,option:n,index:r})}}onBlur(){this.onModelTouched()}removeOption(e){this.value=this.value.filter(n=>!Pn.equals(n,this.getOptionValue(e),this.dataKey))}isSelected(e){let n=!1,r=this.getOptionValue(e);if(this.multiple){if(this.value)for(let o of this.value)if(Pn.equals(o,r,this.dataKey)){n=!0;break}}else n=Pn.equals(this.getOptionValue(e),this.value,this.dataKey);return n}}return t.\u0275fac=function(e){return new(e||t)(te(Wo))},t.\u0275cmp=dn({type:t,selectors:[["p-selectButton"]],contentQueries:function(e,n,r){if(1&e&&ol(r,Rc,5),2&e){let o;xt(o=wt())&&(n.itemTemplate=o.first)}},hostAttrs:[1,"p-element"],inputs:{options:"options",optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",tabindex:"tabindex",multiple:"multiple",style:"style",styleClass:"styleClass",ariaLabelledBy:"ariaLabelledBy",disabled:"disabled",dataKey:"dataKey"},outputs:{onOptionClick:"onOptionClick",onChange:"onChange"},features:[Nn([SK])],decls:2,vars:5,consts:[["role","group",3,"ngClass","ngStyle"],["class","p-button p-component","role","button","pRipple","",3,"class","ngClass","click","keydown.enter","blur",4,"ngFor","ngForOf"],["role","button","pRipple","",1,"p-button","p-component",3,"ngClass","click","keydown.enter","blur"],["btn",""],[4,"ngIf","ngIfElse"],["customcontent",""],[3,"ngClass","class",4,"ngIf"],[1,"p-button-label"],[3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,n){1&e&&(f(0,"div",0),D(1,TK,5,14,"div",1),p()),2&e&&(Ji(n.styleClass),T("ngClass","p-selectbutton p-buttonset p-component")("ngStyle",n.style),v(1),T("ngForOf",n.options))},directives:[Na,La,nc,Vp,Sn,ic],styles:[".p-button{margin:0;display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;align-items:center;vertical-align:bottom;text-align:center;overflow:hidden;position:relative}.p-button-label{flex:1 1 auto}.p-button-icon-right{order:1}.p-button:disabled{cursor:default}.p-button-icon-only{justify-content:center}.p-button-icon-only .p-button-label{visibility:hidden;width:0;flex:0 0 auto}.p-button-vertical{flex-direction:column}.p-button-icon-bottom{order:2}.p-buttonset .p-button{margin:0}.p-buttonset .p-button:not(:last-child){border-right:0 none}.p-buttonset .p-button:not(:first-of-type):not(:last-of-type){border-radius:0}.p-buttonset .p-button:first-of-type{border-top-right-radius:0;border-bottom-right-radius:0}.p-buttonset .p-button:last-of-type{border-top-left-radius:0;border-bottom-left-radius:0}.p-buttonset .p-button:focus{position:relative;z-index:1}\n"],encapsulation:2,changeDetection:0}),t})(),kK=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro,_f]]}),t})();const DK=function(t,i,e){return{"p-checkbox-label-active":t,"p-disabled":i,"p-checkbox-label-focus":e}};function IK(t,i){if(1&t){const e=Ie();f(0,"label",7),L("click",function(r){z(e);const o=A(),c=Fa(3);return o.onClick(r,c)}),_(1),p()}if(2&t){const e=A();T("ngClass",kp(3,DK,null!=e.value,e.disabled,e.focused)),Ai("for",e.inputId),v(1),U(e.label)}}const AK=function(t,i){return{"p-checkbox p-component":!0,"p-checkbox-disabled":t,"p-checkbox-focused":i}},MK=function(t,i,e){return{"p-highlight":t,"p-disabled":i,"p-focus":e}},FK={provide:Ra,useExisting:tr(()=>PK),multi:!0};let PK=(()=>{class t{constructor(e){this.cd=e,this.checkboxTrueIcon="pi pi-check",this.checkboxFalseIcon="pi pi-times",this.onChange=new Et,this.onModelChange=()=>{},this.onModelTouched=()=>{}}onClick(e,n){!this.disabled&&!this.readonly&&(this.toggle(e),this.focused=!0,n.focus())}onKeydown(e){32==e.keyCode&&e.preventDefault()}onKeyup(e){32==e.keyCode&&!this.readonly&&(this.toggle(e),e.preventDefault())}toggle(e){null==this.value||null==this.value?this.value=!0:1==this.value?this.value=!1:0==this.value&&(this.value=null),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value})}onFocus(){this.focused=!0}onBlur(){this.focused=!1,this.onModelTouched()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}writeValue(e){this.value=e,this.cd.markForCheck()}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(te(Wo))},t.\u0275cmp=dn({type:t,selectors:[["p-triStateCheckbox"]],hostAttrs:[1,"p-element"],inputs:{disabled:"disabled",name:"name",ariaLabelledBy:"ariaLabelledBy",tabindex:"tabindex",inputId:"inputId",style:"style",styleClass:"styleClass",label:"label",readonly:"readonly",checkboxTrueIcon:"checkboxTrueIcon",checkboxFalseIcon:"checkboxFalseIcon"},outputs:{onChange:"onChange"},features:[Nn([FK])],decls:7,vars:21,consts:[[3,"ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","text","inputmode","none",3,"name","readonly","disabled","keyup","keydown","focus","blur"],["input",""],["role","checkbox",1,"p-checkbox-box",3,"ngClass","click"],[1,"p-checkbox-icon",3,"ngClass"],["class","p-checkbox-label",3,"ngClass","click",4,"ngIf"],[1,"p-checkbox-label",3,"ngClass","click"]],template:function(e,n){if(1&e){const r=Ie();f(0,"div",0)(1,"div",1)(2,"input",2,3),L("keyup",function(c){return n.onKeyup(c)})("keydown",function(c){return n.onKeydown(c)})("focus",function(){return n.onFocus()})("blur",function(){return n.onBlur()}),p()(),f(4,"div",4),L("click",function(c){z(r);const u=Fa(3);return n.onClick(c,u)}),ee(5,"span",5),p()(),D(6,IK,2,7,"label",6)}2&e&&(Ji(n.styleClass),T("ngStyle",n.style)("ngClass",ia(14,AK,n.disabled,n.focused)),v(2),T("name",n.name)("readonly",n.readonly)("disabled",n.disabled),Ai("id",n.inputId)("tabindex",n.tabindex)("aria-labelledby",n.ariaLabelledBy),v(2),T("ngClass",kp(17,MK,null!=n.value,n.disabled,n.focused)),Ai("aria-checked",!0===n.value),v(1),T("ngClass",!0===n.value?n.checkboxTrueIcon:!1===n.value?n.checkboxFalseIcon:""),v(1),T("ngIf",n.label))},directives:[La,Na,Sn],encapsulation:2,changeDetection:0}),t})(),OK=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro]]}),t})();const NK=["container"],LK=["inputfield"],RK=["contentWrapper"];function BK(t,i){if(1&t){const e=Ie();f(0,"i",8),L("click",function(){return z(e),A(2).clear()}),p()}}function jK(t,i){if(1&t){const e=Ie();f(0,"button",9),L("click",function(r){z(e),A();const o=Fa(1);return A().onButtonClick(r,o)}),p()}if(2&t){const e=A(2);T("icon",e.icon)("disabled",e.disabled),Ai("aria-label",e.iconAriaLabel)}}function VK(t,i){if(1&t){const e=Ie();f(0,"input",4,5),L("focus",function(r){return z(e),A().onInputFocus(r)})("keydown",function(r){return z(e),A().onInputKeydown(r)})("click",function(){return z(e),A().onInputClick()})("blur",function(r){return z(e),A().onInputBlur(r)})("input",function(r){return z(e),A().onUserInput(r)}),p(),D(2,BK,1,0,"i",6),D(3,jK,1,3,"button",7)}if(2&t){const e=A();Ji(e.inputStyleClass),T("value",e.inputFieldValue)("readonly",e.readonlyInput)("ngStyle",e.inputStyle)("placeholder",e.placeholder||"")("disabled",e.disabled)("ngClass","p-inputtext p-component"),Ai("id",e.inputId)("name",e.name)("required",e.required)("aria-required",e.required)("tabindex",e.tabindex)("inputmode",e.touchUI?"off":null)("aria-labelledby",e.ariaLabelledBy),v(2),T("ngIf",e.showClear&&!e.disabled&&null!=e.value),v(1),T("ngIf",e.showIcon)}}function UK(t,i){1&t&&Jn(0)}function HK(t,i){if(1&t){const e=Ie();f(0,"button",30),L("keydown",function(r){return z(e),A(4).onContainerButtonKeydown(r)})("click",function(r){return z(e),A(4).onPrevButtonClick(r)}),ee(1,"span",31),p()}}function zK(t,i){if(1&t){const e=Ie();f(0,"button",32),L("click",function(r){return z(e),A(4).switchToMonthView(r)})("keydown",function(r){return z(e),A(4).onContainerButtonKeydown(r)}),_(1),p()}if(2&t){const e=A().$implicit,n=A(3);T("disabled",n.switchViewButtonDisabled()),v(1),hn(" ",n.getMonthName(e.month)," ")}}function $K(t,i){if(1&t){const e=Ie();f(0,"button",33),L("click",function(r){return z(e),A(4).switchToYearView(r)})("keydown",function(r){return z(e),A(4).onContainerButtonKeydown(r)}),_(1),p()}if(2&t){const e=A().$implicit,n=A(3);T("disabled",n.switchViewButtonDisabled()),v(1),hn(" ",n.getYear(e)," ")}}function WK(t,i){if(1&t&&(ni(0),_(1),Si()),2&t){const e=A(5);v(1),Kv("",e.yearPickerValues()[0]," - ",e.yearPickerValues()[e.yearPickerValues().length-1],"")}}function qK(t,i){1&t&&Jn(0)}const eR=function(t){return{$implicit:t}};function GK(t,i){if(1&t&&(f(0,"span",34),D(1,WK,2,2,"ng-container",13),D(2,qK,1,0,"ng-container",35),p()),2&t){const e=A(4);v(1),T("ngIf",!e.decadeTemplate),v(1),T("ngTemplateOutlet",e.decadeTemplate)("ngTemplateOutletContext",Ei(3,eR,e.yearPickerValues))}}function KK(t,i){if(1&t&&(f(0,"th",41)(1,"span"),_(2),p()()),2&t){const e=A(5);v(2),U(e.getTranslation("weekHeader"))}}function YK(t,i){if(1&t&&(f(0,"th",42)(1,"span"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e)}}function XK(t,i){if(1&t&&(f(0,"td",45)(1,"span",46),_(2),p()()),2&t){const e=A().index,n=A(2).$implicit;v(2),hn(" ",n.weekNumbers[e]," ")}}function QK(t,i){if(1&t&&(ni(0),_(1),Si()),2&t){const e=A(2).$implicit;v(1),U(e.day)}}function JK(t,i){1&t&&Jn(0)}const ZK=function(t,i){return{"p-highlight":t,"p-disabled":i}};function eY(t,i){if(1&t){const e=Ie();ni(0),f(1,"span",48),L("click",function(r){z(e);const o=A().$implicit;return A(6).onDateSelect(r,o)})("keydown",function(r){z(e);const o=A().$implicit,c=A(3).index;return A(3).onDateCellKeydown(r,o,c)}),D(2,QK,2,1,"ng-container",13),D(3,JK,1,0,"ng-container",35),p(),Si()}if(2&t){const e=A().$implicit,n=A(6);v(1),T("ngClass",ia(4,ZK,n.isSelected(e),!e.selectable)),v(1),T("ngIf",!n.dateTemplate),v(1),T("ngTemplateOutlet",n.dateTemplate)("ngTemplateOutletContext",Ei(7,eR,e))}}const tY=function(t,i){return{"p-datepicker-other-month":t,"p-datepicker-today":i}};function nY(t,i){if(1&t&&(f(0,"td",47),D(1,eY,4,9,"ng-container",13),p()),2&t){const e=i.$implicit,n=A(6);T("ngClass",ia(2,tY,e.otherMonth,e.today)),v(1),T("ngIf",!e.otherMonth||n.showOtherMonths)}}function iY(t,i){if(1&t&&(f(0,"tr"),D(1,XK,3,1,"td",43),D(2,nY,2,5,"td",44),p()),2&t){const e=i.$implicit,n=A(5);v(1),T("ngIf",n.showWeek),v(1),T("ngForOf",e)}}function rY(t,i){if(1&t&&(f(0,"div",36)(1,"table",37)(2,"thead")(3,"tr"),D(4,KK,3,1,"th",38),D(5,YK,3,1,"th",39),p()(),f(6,"tbody"),D(7,iY,3,2,"tr",40),p()()()),2&t){const e=A().$implicit,n=A(3);v(4),T("ngIf",n.showWeek),v(1),T("ngForOf",n.weekDays),v(2),T("ngForOf",e.dates)}}function oY(t,i){if(1&t){const e=Ie();f(0,"div",20)(1,"div",21),D(2,HK,2,0,"button",22),f(3,"div",23),D(4,zK,2,2,"button",24),D(5,$K,2,2,"button",25),D(6,GK,3,5,"span",26),p(),f(7,"button",27),L("keydown",function(r){return z(e),A(3).onContainerButtonKeydown(r)})("click",function(r){return z(e),A(3).onNextButtonClick(r)}),ee(8,"span",28),p()(),D(9,rY,8,3,"div",29),p()}if(2&t){const e=i.index,n=A(3);v(2),T("ngIf",0===e),v(2),T("ngIf","date"===n.currentView),v(1),T("ngIf","year"!==n.currentView),v(1),T("ngIf","year"===n.currentView),v(1),ud("display",1===n.numberOfMonths||e===n.numberOfMonths-1?"inline-flex":"none"),v(2),T("ngIf","date"===n.currentView)}}const tR=function(t){return{"p-highlight":t}};function sY(t,i){if(1&t){const e=Ie();f(0,"span",51),L("click",function(r){const c=z(e).index;return A(4).onMonthSelect(r,c)})("keydown",function(r){const c=z(e).index;return A(4).onMonthCellKeydown(r,c)}),_(1),p()}if(2&t){const e=i.$implicit,n=i.index,r=A(4);T("ngClass",Ei(2,tR,r.isMonthSelected(n))),v(1),hn(" ",e," ")}}function aY(t,i){if(1&t&&(f(0,"div",49),D(1,sY,2,4,"span",50),p()),2&t){const e=A(3);v(1),T("ngForOf",e.monthPickerValues())}}function lY(t,i){if(1&t){const e=Ie();f(0,"span",54),L("click",function(r){const c=z(e).$implicit;return A(4).onYearSelect(r,c)})("keydown",function(r){const c=z(e).$implicit;return A(4).onYearCellKeydown(r,c)}),_(1),p()}if(2&t){const e=i.$implicit,n=A(4);T("ngClass",Ei(2,tR,n.isYearSelected(e))),v(1),hn(" ",e," ")}}function cY(t,i){if(1&t&&(f(0,"div",52),D(1,lY,2,4,"span",53),p()),2&t){const e=A(3);v(1),T("ngForOf",e.yearPickerValues())}}function uY(t,i){if(1&t&&(ni(0),f(1,"div",16),D(2,oY,10,7,"div",17),p(),D(3,aY,2,1,"div",18),D(4,cY,2,1,"div",19),Si()),2&t){const e=A(2);v(2),T("ngForOf",e.months),v(1),T("ngIf","month"===e.currentView),v(1),T("ngIf","year"===e.currentView)}}function dY(t,i){1&t&&(ni(0),_(1,"0"),Si())}function fY(t,i){1&t&&(ni(0),_(1,"0"),Si())}function pY(t,i){if(1&t&&(f(0,"div",60)(1,"span"),_(2),p()()),2&t){const e=A(3);v(2),U(e.timeSeparator)}}function hY(t,i){1&t&&(ni(0),_(1,"0"),Si())}function mY(t,i){if(1&t){const e=Ie();f(0,"div",65)(1,"button",57),L("keydown",function(r){return z(e),A(3).onContainerButtonKeydown(r)})("keydown.enter",function(r){return z(e),A(3).incrementSecond(r)})("keydown.space",function(r){return z(e),A(3).incrementSecond(r)})("mousedown",function(r){return z(e),A(3).onTimePickerElementMouseDown(r,2,1)})("mouseup",function(r){return z(e),A(3).onTimePickerElementMouseUp(r)})("keyup.enter",function(r){return z(e),A(3).onTimePickerElementMouseUp(r)})("keyup.space",function(r){return z(e),A(3).onTimePickerElementMouseUp(r)})("mouseleave",function(){return z(e),A(3).onTimePickerElementMouseLeave()}),ee(2,"span",58),p(),f(3,"span"),D(4,hY,2,0,"ng-container",13),_(5),p(),f(6,"button",57),L("keydown",function(r){return z(e),A(3).onContainerButtonKeydown(r)})("keydown.enter",function(r){return z(e),A(3).decrementSecond(r)})("keydown.space",function(r){return z(e),A(3).decrementSecond(r)})("mousedown",function(r){return z(e),A(3).onTimePickerElementMouseDown(r,2,-1)})("mouseup",function(r){return z(e),A(3).onTimePickerElementMouseUp(r)})("keyup.enter",function(r){return z(e),A(3).onTimePickerElementMouseUp(r)})("keyup.space",function(r){return z(e),A(3).onTimePickerElementMouseUp(r)})("mouseleave",function(){return z(e),A(3).onTimePickerElementMouseLeave()}),ee(7,"span",59),p()()}if(2&t){const e=A(3);v(4),T("ngIf",e.currentSecond<10),v(1),U(e.currentSecond)}}function gY(t,i){if(1&t){const e=Ie();f(0,"div",66)(1,"button",67),L("keydown",function(r){return z(e),A(3).onContainerButtonKeydown(r)})("click",function(r){return z(e),A(3).toggleAMPM(r)})("keydown.enter",function(r){return z(e),A(3).toggleAMPM(r)}),ee(2,"span",58),p(),f(3,"span"),_(4),p(),f(5,"button",67),L("keydown",function(r){return z(e),A(3).onContainerButtonKeydown(r)})("click",function(r){return z(e),A(3).toggleAMPM(r)})("keydown.enter",function(r){return z(e),A(3).toggleAMPM(r)}),ee(6,"span",59),p()()}if(2&t){const e=A(3);v(4),U(e.pm?"PM":"AM")}}function _Y(t,i){if(1&t){const e=Ie();f(0,"div",55)(1,"div",56)(2,"button",57),L("keydown",function(r){return z(e),A(2).onContainerButtonKeydown(r)})("keydown.enter",function(r){return z(e),A(2).incrementHour(r)})("keydown.space",function(r){return z(e),A(2).incrementHour(r)})("mousedown",function(r){return z(e),A(2).onTimePickerElementMouseDown(r,0,1)})("mouseup",function(r){return z(e),A(2).onTimePickerElementMouseUp(r)})("keyup.enter",function(r){return z(e),A(2).onTimePickerElementMouseUp(r)})("keyup.space",function(r){return z(e),A(2).onTimePickerElementMouseUp(r)})("mouseleave",function(){return z(e),A(2).onTimePickerElementMouseLeave()}),ee(3,"span",58),p(),f(4,"span"),D(5,dY,2,0,"ng-container",13),_(6),p(),f(7,"button",57),L("keydown",function(r){return z(e),A(2).onContainerButtonKeydown(r)})("keydown.enter",function(r){return z(e),A(2).decrementHour(r)})("keydown.space",function(r){return z(e),A(2).decrementHour(r)})("mousedown",function(r){return z(e),A(2).onTimePickerElementMouseDown(r,0,-1)})("mouseup",function(r){return z(e),A(2).onTimePickerElementMouseUp(r)})("keyup.enter",function(r){return z(e),A(2).onTimePickerElementMouseUp(r)})("keyup.space",function(r){return z(e),A(2).onTimePickerElementMouseUp(r)})("mouseleave",function(){return z(e),A(2).onTimePickerElementMouseLeave()}),ee(8,"span",59),p()(),f(9,"div",60)(10,"span"),_(11),p()(),f(12,"div",61)(13,"button",57),L("keydown",function(r){return z(e),A(2).onContainerButtonKeydown(r)})("keydown.enter",function(r){return z(e),A(2).incrementMinute(r)})("keydown.space",function(r){return z(e),A(2).incrementMinute(r)})("mousedown",function(r){return z(e),A(2).onTimePickerElementMouseDown(r,1,1)})("mouseup",function(r){return z(e),A(2).onTimePickerElementMouseUp(r)})("keyup.enter",function(r){return z(e),A(2).onTimePickerElementMouseUp(r)})("keyup.space",function(r){return z(e),A(2).onTimePickerElementMouseUp(r)})("mouseleave",function(){return z(e),A(2).onTimePickerElementMouseLeave()}),ee(14,"span",58),p(),f(15,"span"),D(16,fY,2,0,"ng-container",13),_(17),p(),f(18,"button",57),L("keydown",function(r){return z(e),A(2).onContainerButtonKeydown(r)})("keydown.enter",function(r){return z(e),A(2).decrementMinute(r)})("keydown.space",function(r){return z(e),A(2).decrementMinute(r)})("mousedown",function(r){return z(e),A(2).onTimePickerElementMouseDown(r,1,-1)})("mouseup",function(r){return z(e),A(2).onTimePickerElementMouseUp(r)})("keyup.enter",function(r){return z(e),A(2).onTimePickerElementMouseUp(r)})("keyup.space",function(r){return z(e),A(2).onTimePickerElementMouseUp(r)})("mouseleave",function(){return z(e),A(2).onTimePickerElementMouseLeave()}),ee(19,"span",59),p()(),D(20,pY,3,1,"div",62),D(21,mY,8,2,"div",63),D(22,gY,7,1,"div",64),p()}if(2&t){const e=A(2);v(5),T("ngIf",e.currentHour<10),v(1),U(e.currentHour),v(5),U(e.timeSeparator),v(5),T("ngIf",e.currentMinute<10),v(1),U(e.currentMinute),v(3),T("ngIf",e.showSeconds),v(1),T("ngIf",e.showSeconds),v(1),T("ngIf","12"==e.hourFormat)}}const nR=function(t){return[t]};function vY(t,i){if(1&t){const e=Ie();f(0,"div",68)(1,"button",69),L("keydown",function(r){return z(e),A(2).onContainerButtonKeydown(r)})("click",function(r){return z(e),A(2).onTodayButtonClick(r)}),p(),f(2,"button",69),L("keydown",function(r){return z(e),A(2).onContainerButtonKeydown(r)})("click",function(r){return z(e),A(2).onClearButtonClick(r)}),p()()}if(2&t){const e=A(2);v(1),T("label",e.getTranslation("today"))("ngClass",Ei(4,nR,e.todayButtonStyleClass)),v(1),T("label",e.getTranslation("clear"))("ngClass",Ei(6,nR,e.clearButtonStyleClass))}}function yY(t,i){1&t&&Jn(0)}const bY=function(t,i,e,n,r,o){return{"p-datepicker p-component":!0,"p-datepicker-inline":t,"p-disabled":i,"p-datepicker-timeonly":e,"p-datepicker-multiple-month":n,"p-datepicker-monthpicker":r,"p-datepicker-touch-ui":o}},iR=function(t,i){return{showTransitionParams:t,hideTransitionParams:i}},xY=function(t){return{value:"visibleTouchUI",params:t}},wY=function(t){return{value:"visible",params:t}};function CY(t,i){if(1&t){const e=Ie();f(0,"div",10,11),L("@overlayAnimation.start",function(r){return z(e),A().onOverlayAnimationStart(r)})("@overlayAnimation.done",function(r){return z(e),A().onOverlayAnimationDone(r)})("click",function(r){return z(e),A().onOverlayClick(r)}),Sl(2),D(3,UK,1,0,"ng-container",12),D(4,uY,5,3,"ng-container",13),D(5,_Y,23,8,"div",14),D(6,vY,3,8,"div",15),Sl(7,1),D(8,yY,1,0,"ng-container",12),p()}if(2&t){const e=A();Ji(e.panelStyleClass),T("ngStyle",e.panelStyle)("ngClass",w0(11,bY,e.inline,e.disabled,e.timeOnly,e.numberOfMonths>1,"month"===e.view,e.touchUI))("@overlayAnimation",e.touchUI?Ei(21,xY,ia(18,iR,e.showTransitionOptions,e.hideTransitionOptions)):Ei(26,wY,ia(23,iR,e.showTransitionOptions,e.hideTransitionOptions)))("@.disabled",!0===e.inline),v(3),T("ngTemplateOutlet",e.headerTemplate),v(1),T("ngIf",!e.timeOnly),v(1),T("ngIf",(e.showTime||e.timeOnly)&&"date"===e.currentView),v(1),T("ngIf",e.showButtonBar),v(2),T("ngTemplateOutlet",e.footerTemplate)}}const TY=[[["p-header"]],[["p-footer"]]],SY=function(t,i,e,n){return{"p-calendar":!0,"p-calendar-w-btn":t,"p-calendar-timeonly":i,"p-calendar-disabled":e,"p-focus":n}},EY=["p-header","p-footer"],kY={provide:Ra,useExisting:tr(()=>oc),multi:!0};let oc=(()=>{class t{constructor(e,n,r,o,c,u){this.el=e,this.renderer=n,this.cd=r,this.zone=o,this.config=c,this.overlayService=u,this.multipleSeparator=",",this.rangeSeparator="-",this.inline=!1,this.showOtherMonths=!0,this.icon="pi pi-calendar",this.shortYearCutoff="+10",this.hourFormat="24",this.stepHour=1,this.stepMinute=1,this.stepSecond=1,this.showSeconds=!1,this.showOnFocus=!0,this.showWeek=!1,this.showClear=!1,this.dataType="date",this.selectionMode="single",this.todayButtonStyleClass="p-button-text",this.clearButtonStyleClass="p-button-text",this.autoZIndex=!0,this.baseZIndex=0,this.keepInvalid=!1,this.hideOnDateTimeSelect=!0,this.timeSeparator=":",this.focusTrap=!0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.onFocus=new Et,this.onBlur=new Et,this.onClose=new Et,this.onSelect=new Et,this.onClear=new Et,this.onInput=new Et,this.onTodayClick=new Et,this.onClearClick=new Et,this.onMonthChange=new Et,this.onYearChange=new Et,this.onClickOutside=new Et,this.onShow=new Et,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.inputFieldValue=null,this.navigationState=null,this._numberOfMonths=1,this._view="date",this.convertTo24Hour=function(m,g){return"12"==this.hourFormat?12===m?g?12:0:g?m+12:m:m}}set content(e){this.contentViewChild=e,this.contentViewChild&&(this.isMonthNavigate?(Promise.resolve(null).then(()=>this.updateFocus()),this.isMonthNavigate=!1):this.focus||this.initFocusableCell())}get view(){return this._view}set view(e){this._view=e,this.currentView=this._view}get defaultDate(){return this._defaultDate}set defaultDate(e){if(this._defaultDate=e,this.initialized){const n=e||new Date;this.currentMonth=n.getMonth(),this.currentYear=n.getFullYear(),this.initTime(n),this.createMonths(this.currentMonth,this.currentYear)}}get minDate(){return this._minDate}set minDate(e){this._minDate=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get disabledDates(){return this._disabledDates}set disabledDates(e){this._disabledDates=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get disabledDays(){return this._disabledDays}set disabledDays(e){this._disabledDays=e,null!=this.currentMonth&&null!=this.currentMonth&&this.currentYear&&this.createMonths(this.currentMonth,this.currentYear)}get yearRange(){return this._yearRange}set yearRange(e){if(this._yearRange=e,e){const n=e.split(":"),r=parseInt(n[0]),o=parseInt(n[1]);this.populateYearOptions(r,o)}}get showTime(){return this._showTime}set showTime(e){this._showTime=e,void 0===this.currentHour&&this.initTime(this.value||new Date),this.updateInputfield()}get locale(){return this._locale}get responsiveOptions(){return this._responsiveOptions}set responsiveOptions(e){this._responsiveOptions=e,this.destroyResponsiveStyleElement(),this.createResponsiveStyle()}get numberOfMonths(){return this._numberOfMonths}set numberOfMonths(e){this._numberOfMonths=e,this.destroyResponsiveStyleElement(),this.createResponsiveStyle()}get firstDayOfWeek(){return this._firstDayOfWeek}set firstDayOfWeek(e){this._firstDayOfWeek=e,this.createWeekDays()}set locale(e){console.warn("Locale property has no effect, use new i18n API instead.")}ngOnInit(){this.attributeSelector=N0();const e=this.defaultDate||new Date;this.createResponsiveStyle(),this.currentMonth=e.getMonth(),this.currentYear=e.getFullYear(),this.currentView=this.view,"date"===this.view&&(this.createWeekDays(),this.initTime(e),this.createMonths(this.currentMonth,this.currentYear),this.ticksTo1970=24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.createWeekDays()}),this.initialized=!0}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"date":default:this.dateTemplate=e.template;break;case"decade":this.decadeTemplate=e.template;break;case"disabledDate":this.disabledDateTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngAfterViewInit(){this.inline&&(this.contentViewChild&&this.contentViewChild.nativeElement.setAttribute(this.attributeSelector,""),this.disabled||(this.initFocusableCell(),1===this.numberOfMonths&&(this.contentViewChild.nativeElement.style.width=We.getOuterWidth(this.containerViewChild.nativeElement)+"px")))}getTranslation(e){return this.config.getTranslation(e)}populateYearOptions(e,n){this.yearOptions=[];for(let r=e;r<=n;r++)this.yearOptions.push(r)}createWeekDays(){this.weekDays=[];let e=this.getFirstDateOfWeek(),n=this.getTranslation(Fl.DAY_NAMES_MIN);for(let r=0;r<7;r++)this.weekDays.push(n[e]),e=6==e?0:++e}monthPickerValues(){let e=[];for(let n=0;n<=11;n++)e.push(this.config.getTranslation("monthNamesShort")[n]);return e}yearPickerValues(){let e=[],n=this.currentYear-this.currentYear%10;for(let r=0;r<10;r++)e.push(n+r);return e}createMonths(e,n){this.months=this.months=[];for(let r=0;r<this.numberOfMonths;r++){let o=e+r,c=n;o>11&&(o=o%11-1,c=n+1),this.months.push(this.createMonth(o,c))}}getWeekNumber(e){let n=new Date(e.getTime());n.setDate(n.getDate()+4-(n.getDay()||7));let r=n.getTime();return n.setMonth(0),n.setDate(1),Math.floor(Math.round((r-n.getTime())/864e5)/7)+1}createMonth(e,n){let r=[],o=this.getFirstDayOfMonthIndex(e,n),c=this.getDaysCountInMonth(e,n),u=this.getDaysCountInPrevMonth(e,n),m=1,g=new Date,x=[],S=Math.ceil((c+o)/7);for(let M=0;M<S;M++){let E=[];if(0==M){for(let B=u-o+1;B<=u;B++){let K=this.getPreviousMonthAndYear(e,n);E.push({day:B,month:K.month,year:K.year,otherMonth:!0,today:this.isToday(g,B,K.month,K.year),selectable:this.isSelectable(B,K.month,K.year,!0)})}let R=7-E.length;for(let B=0;B<R;B++)E.push({day:m,month:e,year:n,today:this.isToday(g,m,e,n),selectable:this.isSelectable(m,e,n,!1)}),m++}else for(let R=0;R<7;R++){if(m>c){let B=this.getNextMonthAndYear(e,n);E.push({day:m-c,month:B.month,year:B.year,otherMonth:!0,today:this.isToday(g,m-c,B.month,B.year),selectable:this.isSelectable(m-c,B.month,B.year,!0)})}else E.push({day:m,month:e,year:n,today:this.isToday(g,m,e,n),selectable:this.isSelectable(m,e,n,!1)});m++}this.showWeek&&x.push(this.getWeekNumber(new Date(E[0].year,E[0].month,E[0].day))),r.push(E)}return{month:e,year:n,dates:r,weekNumbers:x}}initTime(e){this.pm=e.getHours()>11,this.showTime?(this.currentMinute=e.getMinutes(),this.currentSecond=e.getSeconds(),this.setCurrentHourPM(e.getHours())):this.timeOnly&&(this.currentMinute=0,this.currentHour=0,this.currentSecond=0)}navBackward(e){this.disabled?e.preventDefault():(this.isMonthNavigate=!0,"month"===this.currentView?(this.decrementYear(),setTimeout(()=>{this.updateFocus()},1)):"year"===this.currentView?(this.decrementDecade(),setTimeout(()=>{this.updateFocus()},1)):(0===this.currentMonth?(this.currentMonth=11,this.decrementYear()):this.currentMonth--,this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)))}navForward(e){this.disabled?e.preventDefault():(this.isMonthNavigate=!0,"month"===this.currentView?(this.incrementYear(),setTimeout(()=>{this.updateFocus()},1)):"year"===this.currentView?(this.incrementDecade(),setTimeout(()=>{this.updateFocus()},1)):(11===this.currentMonth?(this.currentMonth=0,this.incrementYear()):this.currentMonth++,this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)))}decrementYear(){if(this.currentYear--,this.yearNavigator&&this.currentYear<this.yearOptions[0]){let e=this.yearOptions[this.yearOptions.length-1]-this.yearOptions[0];this.populateYearOptions(this.yearOptions[0]-e,this.yearOptions[this.yearOptions.length-1]-e)}}decrementDecade(){this.currentYear=this.currentYear-10}incrementDecade(){this.currentYear=this.currentYear+10}incrementYear(){if(this.currentYear++,this.yearNavigator&&this.currentYear>this.yearOptions[this.yearOptions.length-1]){let e=this.yearOptions[this.yearOptions.length-1]-this.yearOptions[0];this.populateYearOptions(this.yearOptions[0]+e,this.yearOptions[this.yearOptions.length-1]+e)}}switchToMonthView(e){this.setCurrentView("month"),e.preventDefault()}switchToYearView(e){this.setCurrentView("year"),e.preventDefault()}onDateSelect(e,n){!this.disabled&&n.selectable?(this.isMultipleSelection()&&this.isSelected(n)?(this.value=this.value.filter((r,o)=>!this.isDateEquals(r,n)),0===this.value.length&&(this.value=null),this.updateModel(this.value)):this.shouldSelectDate(n)&&this.selectDate(n),this.isSingleSelection()&&this.hideOnDateTimeSelect&&setTimeout(()=>{e.preventDefault(),this.hideOverlay(),this.mask&&this.disableModality(),this.cd.markForCheck()},150),this.updateInputfield(),e.preventDefault()):e.preventDefault()}shouldSelectDate(e){return!this.isMultipleSelection()||null==this.maxDateCount||this.maxDateCount>(this.value?this.value.length:0)}onMonthSelect(e,n){"month"===this.view?this.onDateSelect(e,{year:this.currentYear,month:n,day:1,selectable:!0}):(this.currentMonth=n,this.createMonths(this.currentMonth,this.currentYear),this.setCurrentView("date"),this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}))}onYearSelect(e,n){"year"===this.view?this.onDateSelect(e,{year:n,month:0,day:1,selectable:!0}):(this.currentYear=n,this.setCurrentView("month"),this.onYearChange.emit({month:this.currentMonth+1,year:this.currentYear}))}updateInputfield(){let e="";if(this.value)if(this.isSingleSelection())e=this.formatDateTime(this.value);else if(this.isMultipleSelection())for(let n=0;n<this.value.length;n++)e+=this.formatDateTime(this.value[n]),n!==this.value.length-1&&(e+=this.multipleSeparator+" ");else if(this.isRangeSelection()&&this.value&&this.value.length){let r=this.value[1];e=this.formatDateTime(this.value[0]),r&&(e+=" "+this.rangeSeparator+" "+this.formatDateTime(r))}this.inputFieldValue=e,this.updateFilledState(),this.inputfieldViewChild&&this.inputfieldViewChild.nativeElement&&(this.inputfieldViewChild.nativeElement.value=this.inputFieldValue)}formatDateTime(e){let n=this.keepInvalid?e:null;return this.isValidDate(e)&&(this.timeOnly?n=this.formatTime(e):(n=this.formatDate(e,this.getDateFormat()),this.showTime&&(n+=" "+this.formatTime(e)))),n}setCurrentHourPM(e){"12"==this.hourFormat?(this.pm=e>11,this.currentHour=e>=12?12==e?12:e-12:0==e?12:e):this.currentHour=e}setCurrentView(e){this.currentView=e,this.cd.detectChanges(),this.alignOverlay()}selectDate(e){let n=new Date(e.year,e.month,e.day);if(this.showTime&&(n.setHours("12"==this.hourFormat?12===this.currentHour?this.pm?12:0:this.pm?this.currentHour+12:this.currentHour:this.currentHour),n.setMinutes(this.currentMinute),n.setSeconds(this.currentSecond)),this.minDate&&this.minDate>n&&(n=this.minDate,this.setCurrentHourPM(n.getHours()),this.currentMinute=n.getMinutes(),this.currentSecond=n.getSeconds()),this.maxDate&&this.maxDate<n&&(n=this.maxDate,this.setCurrentHourPM(n.getHours()),this.currentMinute=n.getMinutes(),this.currentSecond=n.getSeconds()),this.isSingleSelection())this.updateModel(n);else if(this.isMultipleSelection())this.updateModel(this.value?[...this.value,n]:[n]);else if(this.isRangeSelection())if(this.value&&this.value.length){let r=this.value[0],o=this.value[1];!o&&n.getTime()>=r.getTime()?o=n:(r=n,o=null),this.updateModel([r,o])}else this.updateModel([n,null]);this.onSelect.emit(n)}updateModel(e){if(this.value=e,"date"==this.dataType)this.onModelChange(this.value);else if("string"==this.dataType)if(this.isSingleSelection())this.onModelChange(this.formatDateTime(this.value));else{let n=null;this.value&&(n=this.value.map(r=>this.formatDateTime(r))),this.onModelChange(n)}}getFirstDayOfMonthIndex(e,n){let r=new Date;r.setDate(1),r.setMonth(e),r.setFullYear(n);let o=r.getDay()+this.getSundayIndex();return o>=7?o-7:o}getDaysCountInMonth(e,n){return 32-this.daylightSavingAdjust(new Date(n,e,32)).getDate()}getDaysCountInPrevMonth(e,n){let r=this.getPreviousMonthAndYear(e,n);return this.getDaysCountInMonth(r.month,r.year)}getPreviousMonthAndYear(e,n){let r,o;return 0===e?(r=11,o=n-1):(r=e-1,o=n),{month:r,year:o}}getNextMonthAndYear(e,n){let r,o;return 11===e?(r=0,o=n+1):(r=e+1,o=n),{month:r,year:o}}getSundayIndex(){let e=this.getFirstDateOfWeek();return e>0?7-e:0}isSelected(e){if(!this.value)return!1;if(this.isSingleSelection())return this.isDateEquals(this.value,e);if(this.isMultipleSelection()){let n=!1;for(let r of this.value)if(n=this.isDateEquals(r,e),n)break;return n}return this.isRangeSelection()?this.value[1]?this.isDateEquals(this.value[0],e)||this.isDateEquals(this.value[1],e)||this.isDateBetween(this.value[0],this.value[1],e):this.isDateEquals(this.value[0],e):void 0}isComparable(){return null!=this.value&&"string"!=typeof this.value}isMonthSelected(e){if(this.isComparable()){let n=this.isRangeSelection()?this.value[0]:this.value;return!this.isMultipleSelection()&&n.getMonth()===e&&n.getFullYear()===this.currentYear}return!1}isYearSelected(e){if(this.isComparable()){let n=this.isRangeSelection()?this.value[0]:this.value;return!this.isMultipleSelection()&&n.getFullYear()===e}return!1}isDateEquals(e,n){return!!(e&&e instanceof Date)&&e.getDate()===n.day&&e.getMonth()===n.month&&e.getFullYear()===n.year}isDateBetween(e,n,r){if(e&&n){let c=new Date(r.year,r.month,r.day);return e.getTime()<=c.getTime()&&n.getTime()>=c.getTime()}return!1}isSingleSelection(){return"single"===this.selectionMode}isRangeSelection(){return"range"===this.selectionMode}isMultipleSelection(){return"multiple"===this.selectionMode}isToday(e,n,r,o){return e.getDate()===n&&e.getMonth()===r&&e.getFullYear()===o}isSelectable(e,n,r,o){let c=!0,u=!0,m=!0,g=!0;return!(o&&!this.selectOtherMonths)&&(this.minDate&&(this.minDate.getFullYear()>r||this.minDate.getFullYear()===r&&(this.minDate.getMonth()>n||this.minDate.getMonth()===n&&this.minDate.getDate()>e))&&(c=!1),this.maxDate&&(this.maxDate.getFullYear()<r||this.maxDate.getFullYear()===r&&(this.maxDate.getMonth()<n||this.maxDate.getMonth()===n&&this.maxDate.getDate()<e))&&(u=!1),this.disabledDates&&(m=!this.isDateDisabled(e,n,r)),this.disabledDays&&(g=!this.isDayDisabled(e,n,r)),c&&u&&m&&g)}isDateDisabled(e,n,r){if(this.disabledDates)for(let o of this.disabledDates)if(o.getFullYear()===r&&o.getMonth()===n&&o.getDate()===e)return!0;return!1}isDayDisabled(e,n,r){if(this.disabledDays){let c=new Date(r,n,e).getDay();return-1!==this.disabledDays.indexOf(c)}return!1}onInputFocus(e){this.focus=!0,this.showOnFocus&&this.showOverlay(),this.onFocus.emit(e)}onInputClick(){this.showOnFocus&&!this.overlayVisible&&this.showOverlay()}onInputBlur(e){this.focus=!1,this.onBlur.emit(e),this.keepInvalid||this.updateInputfield(),this.onModelTouched()}onButtonClick(e,n){this.overlayVisible?this.hideOverlay():(n.focus(),this.showOverlay())}clear(){this.inputFieldValue=null,this.value=null,this.onModelChange(this.value),this.onClear.emit()}onOverlayClick(e){this.overlayService.add({originalEvent:e,target:this.el.nativeElement})}getMonthName(e){return this.config.getTranslation("monthNames")[e]}getYear(e){return"month"===this.currentView?this.currentYear:e.year}switchViewButtonDisabled(){return this.numberOfMonths>1||this.disabled}onPrevButtonClick(e){this.navigationState={backward:!0,button:!0},this.navBackward(e)}onNextButtonClick(e){this.navigationState={backward:!1,button:!0},this.navForward(e)}onContainerButtonKeydown(e){switch(e.which){case 9:this.inline||this.trapFocus(e);break;case 27:this.overlayVisible=!1,e.preventDefault()}}onInputKeydown(e){this.isKeydown=!0,40===e.keyCode&&this.contentViewChild?this.trapFocus(e):27===e.keyCode||13===e.keyCode?this.overlayVisible&&(this.overlayVisible=!1,e.preventDefault()):9===e.keyCode&&this.contentViewChild&&(We.getFocusableElements(this.contentViewChild.nativeElement).forEach(n=>n.tabIndex="-1"),this.overlayVisible&&(this.overlayVisible=!1))}onDateCellKeydown(e,n,r){const o=e.currentTarget,c=o.parentElement;switch(e.which){case 40:{o.tabIndex="-1";let u=We.index(c),m=c.parentElement.nextElementSibling;m?We.hasClass(m.children[u].children[0],"p-disabled")?(this.navigationState={backward:!1},this.navForward(e)):(m.children[u].children[0].tabIndex="0",m.children[u].children[0].focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 38:{o.tabIndex="-1";let u=We.index(c),m=c.parentElement.previousElementSibling;if(m){let g=m.children[u].children[0];We.hasClass(g,"p-disabled")?(this.navigationState={backward:!0},this.navBackward(e)):(g.tabIndex="0",g.focus())}else this.navigationState={backward:!0},this.navBackward(e);e.preventDefault();break}case 37:{o.tabIndex="-1";let u=c.previousElementSibling;if(u){let m=u.children[0];We.hasClass(m,"p-disabled")||We.hasClass(m.parentElement,"p-datepicker-weeknumber")?this.navigateToMonth(!0,r):(m.tabIndex="0",m.focus())}else this.navigateToMonth(!0,r);e.preventDefault();break}case 39:{o.tabIndex="-1";let u=c.nextElementSibling;if(u){let m=u.children[0];We.hasClass(m,"p-disabled")?this.navigateToMonth(!1,r):(m.tabIndex="0",m.focus())}else this.navigateToMonth(!1,r);e.preventDefault();break}case 13:case 32:this.onDateSelect(e,n),e.preventDefault();break;case 27:this.overlayVisible=!1,e.preventDefault();break;case 9:this.inline||this.trapFocus(e)}}onMonthCellKeydown(e,n){const r=e.currentTarget;switch(e.which){case 38:case 40:{r.tabIndex="-1";var o=r.parentElement.children,c=We.index(r);let u=o[40===e.which?c+3:c-3];u&&(u.tabIndex="0",u.focus()),e.preventDefault();break}case 37:{r.tabIndex="-1";let u=r.previousElementSibling;u?(u.tabIndex="0",u.focus()):(this.navigationState={backward:!0},this.navBackward(e)),e.preventDefault();break}case 39:{r.tabIndex="-1";let u=r.nextElementSibling;u?(u.tabIndex="0",u.focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 13:this.onMonthSelect(e,n),e.preventDefault();break;case 13:case 32:case 27:this.overlayVisible=!1,e.preventDefault();break;case 9:this.inline||this.trapFocus(e)}}onYearCellKeydown(e,n){const r=e.currentTarget;switch(e.which){case 38:case 40:{r.tabIndex="-1";var o=r.parentElement.children,c=We.index(r);let u=o[40===e.which?c+2:c-2];u&&(u.tabIndex="0",u.focus()),e.preventDefault();break}case 37:{r.tabIndex="-1";let u=r.previousElementSibling;u?(u.tabIndex="0",u.focus()):(this.navigationState={backward:!0},this.navBackward(e)),e.preventDefault();break}case 39:{r.tabIndex="-1";let u=r.nextElementSibling;u?(u.tabIndex="0",u.focus()):(this.navigationState={backward:!1},this.navForward(e)),e.preventDefault();break}case 13:case 32:this.onYearSelect(e,n),e.preventDefault();break;case 27:this.overlayVisible=!1,e.preventDefault();break;case 9:this.trapFocus(e)}}navigateToMonth(e,n){if(e)if(1===this.numberOfMonths||0===n)this.navigationState={backward:!0},this.navBackward(event);else{let o=We.find(this.contentViewChild.nativeElement.children[n-1],".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)"),c=o[o.length-1];c.tabIndex="0",c.focus()}else if(1===this.numberOfMonths||n===this.numberOfMonths-1)this.navigationState={backward:!1},this.navForward(event);else{let o=We.findSingle(this.contentViewChild.nativeElement.children[n+1],".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)");o.tabIndex="0",o.focus()}}updateFocus(){let e;if(this.navigationState){if(this.navigationState.button)this.initFocusableCell(),this.navigationState.backward?We.findSingle(this.contentViewChild.nativeElement,".p-datepicker-prev").focus():We.findSingle(this.contentViewChild.nativeElement,".p-datepicker-next").focus();else{if(this.navigationState.backward){let n;n=We.find(this.contentViewChild.nativeElement,"month"===this.currentView?".p-monthpicker .p-monthpicker-month:not(.p-disabled)":"year"===this.currentView?".p-yearpicker .p-yearpicker-year:not(.p-disabled)":".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)"),n&&n.length>0&&(e=n[n.length-1])}else e=We.findSingle(this.contentViewChild.nativeElement,"month"===this.currentView?".p-monthpicker .p-monthpicker-month:not(.p-disabled)":"year"===this.currentView?".p-yearpicker .p-yearpicker-year:not(.p-disabled)":".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)");e&&(e.tabIndex="0",e.focus())}this.navigationState=null}else this.initFocusableCell()}initFocusableCell(){let e;if("month"===this.currentView){let n=We.find(this.contentViewChild.nativeElement,".p-monthpicker .p-monthpicker-month:not(.p-disabled)"),r=We.findSingle(this.contentViewChild.nativeElement,".p-monthpicker .p-monthpicker-month.p-highlight");n.forEach(o=>o.tabIndex=-1),e=r||n[0],0===n.length&&We.find(this.contentViewChild.nativeElement,'.p-monthpicker .p-monthpicker-month.p-disabled[tabindex = "0"]').forEach(c=>c.tabIndex=-1)}else if("year"===this.currentView){let n=We.find(this.contentViewChild.nativeElement,".p-yearpicker .p-yearpicker-year:not(.p-disabled)"),r=We.findSingle(this.contentViewChild.nativeElement,".p-yearpicker .p-yearpicker-year.p-highlight");n.forEach(o=>o.tabIndex=-1),e=r||n[0],0===n.length&&We.find(this.contentViewChild.nativeElement,'.p-yearpicker .p-yearpicker-year.p-disabled[tabindex = "0"]').forEach(c=>c.tabIndex=-1)}else if(e=We.findSingle(this.contentViewChild.nativeElement,"span.p-highlight"),!e){let n=We.findSingle(this.contentViewChild.nativeElement,"td.p-datepicker-today span:not(.p-disabled):not(.p-ink)");e=n||We.findSingle(this.contentViewChild.nativeElement,".p-datepicker-calendar td span:not(.p-disabled):not(.p-ink)")}e&&(e.tabIndex="0",!this.preventFocus&&(!this.navigationState||!this.navigationState.button)&&setTimeout(()=>{e.focus()},1),this.preventFocus=!1)}trapFocus(e){let n=We.getFocusableElements(this.contentViewChild.nativeElement);if(n&&n.length>0)if(n[0].ownerDocument.activeElement){let r=n.indexOf(n[0].ownerDocument.activeElement);if(e.shiftKey)if(-1==r||0===r)if(this.focusTrap)n[n.length-1].focus();else{if(-1===r)return this.hideOverlay();if(0===r)return}else n[r-1].focus();else if(-1==r||r===n.length-1){if(!this.focusTrap&&-1!=r)return this.hideOverlay();n[0].focus()}else n[r+1].focus()}else n[0].focus();e.preventDefault()}onMonthDropdownChange(e){this.currentMonth=parseInt(e),this.onMonthChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)}onYearDropdownChange(e){this.currentYear=parseInt(e),this.onYearChange.emit({month:this.currentMonth+1,year:this.currentYear}),this.createMonths(this.currentMonth,this.currentYear)}validateTime(e,n,r,o){let c=this.value;const u=this.convertTo24Hour(e,o);this.isRangeSelection()&&(c=this.value[1]||this.value[0]),this.isMultipleSelection()&&(c=this.value[this.value.length-1]);const m=c?c.toDateString():null;return!(this.minDate&&m&&this.minDate.toDateString()===m&&(this.minDate.getHours()>u||this.minDate.getHours()===u&&(this.minDate.getMinutes()>n||this.minDate.getMinutes()===n&&this.minDate.getSeconds()>r))||this.maxDate&&m&&this.maxDate.toDateString()===m&&(this.maxDate.getHours()<u||this.maxDate.getHours()===u&&(this.maxDate.getMinutes()<n||this.maxDate.getMinutes()===n&&this.maxDate.getSeconds()<r)))}incrementHour(e){let r=this.currentHour+this.stepHour,o=this.pm;"24"==this.hourFormat?r=r>=24?r-24:r:"12"==this.hourFormat&&(this.currentHour<12&&r>11&&(o=!this.pm),r=r>=13?r-12:r),this.validateTime(r,this.currentMinute,this.currentSecond,o)&&(this.currentHour=r,this.pm=o),e.preventDefault()}onTimePickerElementMouseDown(e,n,r){this.disabled||(this.repeat(e,null,n,r),e.preventDefault())}onTimePickerElementMouseUp(e){this.disabled||(this.clearTimePickerTimer(),this.updateTime())}onTimePickerElementMouseLeave(){!this.disabled&&this.timePickerTimer&&(this.clearTimePickerTimer(),this.updateTime())}repeat(e,n,r,o){let c=n||500;switch(this.clearTimePickerTimer(),this.timePickerTimer=setTimeout(()=>{this.repeat(e,100,r,o),this.cd.markForCheck()},c),r){case 0:1===o?this.incrementHour(e):this.decrementHour(e);break;case 1:1===o?this.incrementMinute(e):this.decrementMinute(e);break;case 2:1===o?this.incrementSecond(e):this.decrementSecond(e)}this.updateInputfield()}clearTimePickerTimer(){this.timePickerTimer&&(clearTimeout(this.timePickerTimer),this.timePickerTimer=null)}decrementHour(e){let n=this.currentHour-this.stepHour,r=this.pm;"24"==this.hourFormat?n=n<0?24+n:n:"12"==this.hourFormat&&(12===this.currentHour&&(r=!this.pm),n=n<=0?12+n:n),this.validateTime(n,this.currentMinute,this.currentSecond,r)&&(this.currentHour=n,this.pm=r),e.preventDefault()}incrementMinute(e){let n=this.currentMinute+this.stepMinute;n=n>59?n-60:n,this.validateTime(this.currentHour,n,this.currentSecond,this.pm)&&(this.currentMinute=n),e.preventDefault()}decrementMinute(e){let n=this.currentMinute-this.stepMinute;n=n<0?60+n:n,this.validateTime(this.currentHour,n,this.currentSecond,this.pm)&&(this.currentMinute=n),e.preventDefault()}incrementSecond(e){let n=this.currentSecond+this.stepSecond;n=n>59?n-60:n,this.validateTime(this.currentHour,this.currentMinute,n,this.pm)&&(this.currentSecond=n),e.preventDefault()}decrementSecond(e){let n=this.currentSecond-this.stepSecond;n=n<0?60+n:n,this.validateTime(this.currentHour,this.currentMinute,n,this.pm)&&(this.currentSecond=n),e.preventDefault()}updateTime(){let e=this.value;this.isRangeSelection()&&(e=this.value[1]||this.value[0]),this.isMultipleSelection()&&(e=this.value[this.value.length-1]),e=e?new Date(e.getTime()):new Date,e.setHours("12"==this.hourFormat?12===this.currentHour?this.pm?12:0:this.pm?this.currentHour+12:this.currentHour:this.currentHour),e.setMinutes(this.currentMinute),e.setSeconds(this.currentSecond),this.isRangeSelection()&&(e=this.value[1]?[this.value[0],e]:[e,null]),this.isMultipleSelection()&&(e=[...this.value.slice(0,-1),e]),this.updateModel(e),this.onSelect.emit(e),this.updateInputfield()}toggleAMPM(e){const n=!this.pm;this.validateTime(this.currentHour,this.currentMinute,this.currentSecond,n)&&(this.pm=n,this.updateTime()),e.preventDefault()}onUserInput(e){if(!this.isKeydown)return;this.isKeydown=!1;let n=e.target.value;try{let r=this.parseValueFromString(n);this.isValidSelection(r)&&(this.updateModel(r),this.updateUI())}catch(r){this.updateModel(this.keepInvalid?n:null)}this.filled=null!=n&&n.length,this.onInput.emit(e)}isValidSelection(e){let n=!0;return this.isSingleSelection()?this.isSelectable(e.getDate(),e.getMonth(),e.getFullYear(),!1)||(n=!1):e.every(r=>this.isSelectable(r.getDate(),r.getMonth(),r.getFullYear(),!1))&&this.isRangeSelection()&&(n=e.length>1&&e[1]>e[0]),n}parseValueFromString(e){if(!e||0===e.trim().length)return null;let n;if(this.isSingleSelection())n=this.parseDateTime(e);else if(this.isMultipleSelection()){let r=e.split(this.multipleSeparator);n=[];for(let o of r)n.push(this.parseDateTime(o.trim()))}else if(this.isRangeSelection()){let r=e.split(" "+this.rangeSeparator+" ");n=[];for(let o=0;o<r.length;o++)n[o]=this.parseDateTime(r[o].trim())}return n}parseDateTime(e){let n,r=e.split(" ");if(this.timeOnly)n=new Date,this.populateTime(n,r[0],r[1]);else{const o=this.getDateFormat();if(this.showTime){let c="12"==this.hourFormat?r.pop():null,u=r.pop();n=this.parseDate(r.join(" "),o),this.populateTime(n,u,c)}else n=this.parseDate(e,o)}return n}populateTime(e,n,r){if("12"==this.hourFormat&&!r)throw"Invalid Time";this.pm="PM"===r||"pm"===r;let o=this.parseTime(n);e.setHours(o.hour),e.setMinutes(o.minute),e.setSeconds(o.second)}isValidDate(e){return e instanceof Date&&Pn.isNotEmpty(e)}updateUI(){let e=this.value;Array.isArray(e)&&(e=e[0]);let n=this.defaultDate&&this.isValidDate(this.defaultDate)&&!this.value?this.defaultDate:e&&this.isValidDate(e)?e:new Date;this.currentMonth=n.getMonth(),this.currentYear=n.getFullYear(),this.createMonths(this.currentMonth,this.currentYear),(this.showTime||this.timeOnly)&&(this.setCurrentHourPM(n.getHours()),this.currentMinute=n.getMinutes(),this.currentSecond=n.getSeconds())}showOverlay(){this.overlayVisible||(this.updateUI(),this.touchUI||(this.preventFocus=!0),this.overlayVisible=!0)}hideOverlay(){this.overlayVisible=!1,this.clearTimePickerTimer(),this.touchUI&&this.disableModality(),this.cd.markForCheck()}toggle(){this.inline||(this.overlayVisible?this.hideOverlay():(this.showOverlay(),this.inputfieldViewChild.nativeElement.focus()))}onOverlayAnimationStart(e){switch(e.toState){case"visible":case"visibleTouchUI":this.inline||(this.overlay=e.element,this.overlay.setAttribute(this.attributeSelector,""),this.appendOverlay(),this.updateFocus(),this.autoZIndex&&(this.touchUI?ls.set("modal",this.overlay,this.baseZIndex||this.config.zIndex.modal):ls.set("overlay",this.overlay,this.baseZIndex||this.config.zIndex.overlay)),this.alignOverlay(),this.onShow.emit(e));break;case"void":this.onOverlayHide(),this.onClose.emit(e)}}onOverlayAnimationDone(e){switch(e.toState){case"visible":case"visibleTouchUI":this.inline||(this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener());break;case"void":this.autoZIndex&&ls.clear(e.element)}}appendOverlay(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.overlay):We.appendChild(this.overlay,this.appendTo))}restoreOverlayAppend(){this.overlay&&this.appendTo&&this.el.nativeElement.appendChild(this.overlay)}alignOverlay(){this.touchUI?this.enableModality(this.overlay):this.overlay&&(this.appendTo?("date"===this.view?(this.overlay.style.width=We.getOuterWidth(this.overlay)+"px",this.overlay.style.minWidth=We.getOuterWidth(this.inputfieldViewChild.nativeElement)+"px"):this.overlay.style.width=We.getOuterWidth(this.inputfieldViewChild.nativeElement)+"px",We.absolutePosition(this.overlay,this.inputfieldViewChild.nativeElement)):We.relativePosition(this.overlay,this.inputfieldViewChild.nativeElement))}enableModality(e){this.mask||(this.mask=document.createElement("div"),this.mask.style.zIndex=String(parseInt(e.style.zIndex)-1),We.addMultipleClasses(this.mask,"p-component-overlay p-datepicker-mask p-datepicker-mask-scrollblocker p-component-overlay p-component-overlay-enter"),this.maskClickListener=this.renderer.listen(this.mask,"click",r=>{this.disableModality()}),document.body.appendChild(this.mask),We.addClass(document.body,"p-overflow-hidden"))}disableModality(){this.mask&&(We.addClass(this.mask,"p-component-overlay-leave"),this.animationEndListener=this.destroyMask.bind(this),this.mask.addEventListener("animationend",this.animationEndListener))}destroyMask(){document.body.removeChild(this.mask);let n,e=document.body.children;for(let r=0;r<e.length;r++)if(We.hasClass(e[r],"p-datepicker-mask-scrollblocker")){n=!0;break}n||We.removeClass(document.body,"p-overflow-hidden"),this.unbindAnimationEndListener(),this.unbindMaskClickListener(),this.mask=null}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}unbindAnimationEndListener(){this.animationEndListener&&this.mask&&(this.mask.removeEventListener("animationend",this.animationEndListener),this.animationEndListener=null)}writeValue(e){if(this.value=e,this.value&&"string"==typeof this.value)try{this.value=this.parseValueFromString(this.value)}catch(n){this.keepInvalid&&(this.value=e)}this.updateInputfield(),this.updateUI(),this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}getDateFormat(){return this.dateFormat||this.getTranslation("dateFormat")}getFirstDateOfWeek(){return this._firstDayOfWeek||this.getTranslation(Fl.FIRST_DAY_OF_WEEK)}formatDate(e,n){if(!e)return"";let r;const o=x=>{const S=r+1<n.length&&n.charAt(r+1)===x;return S&&r++,S},c=(x,S,M)=>{let E=""+S;if(o(x))for(;E.length<M;)E="0"+E;return E},u=(x,S,M,E)=>o(x)?E[S]:M[S];let m="",g=!1;if(e)for(r=0;r<n.length;r++)if(g)"'"!==n.charAt(r)||o("'")?m+=n.charAt(r):g=!1;else switch(n.charAt(r)){case"d":m+=c("d",e.getDate(),2);break;case"D":m+=u("D",e.getDay(),this.getTranslation(Fl.DAY_NAMES_SHORT),this.getTranslation(Fl.DAY_NAMES));break;case"o":m+=c("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":m+=c("m",e.getMonth()+1,2);break;case"M":m+=u("M",e.getMonth(),this.getTranslation(Fl.MONTH_NAMES_SHORT),this.getTranslation(Fl.MONTH_NAMES));break;case"y":m+=o("y")?e.getFullYear():(e.getFullYear()%100<10?"0":"")+e.getFullYear()%100;break;case"@":m+=e.getTime();break;case"!":m+=1e4*e.getTime()+this.ticksTo1970;break;case"'":o("'")?m+="'":g=!0;break;default:m+=n.charAt(r)}return m}formatTime(e){if(!e)return"";let n="",r=e.getHours(),o=e.getMinutes(),c=e.getSeconds();return"12"==this.hourFormat&&r>11&&12!=r&&(r-=12),n+="12"==this.hourFormat&&0===r?12:r<10?"0"+r:r,n+=":",n+=o<10?"0"+o:o,this.showSeconds&&(n+=":",n+=c<10?"0"+c:c),"12"==this.hourFormat&&(n+=e.getHours()>11?" PM":" AM"),n}parseTime(e){let n=e.split(":");if(n.length!==(this.showSeconds?3:2))throw"Invalid time";let o=parseInt(n[0]),c=parseInt(n[1]),u=this.showSeconds?parseInt(n[2]):null;if(isNaN(o)||isNaN(c)||o>23||c>59||"12"==this.hourFormat&&o>12||this.showSeconds&&(isNaN(u)||u>59))throw"Invalid time";return"12"==this.hourFormat&&(12!==o&&this.pm?o+=12:!this.pm&&12===o&&(o-=12)),{hour:o,minute:c,second:u}}parseDate(e,n){if(null==n||null==e)throw"Invalid arguments";if(""===(e="object"==typeof e?e.toString():e+""))return null;let r,o,c,R,u=0,m="string"!=typeof this.shortYearCutoff?this.shortYearCutoff:(new Date).getFullYear()%100+parseInt(this.shortYearCutoff,10),g=-1,x=-1,S=-1,M=-1,E=!1,B=ce=>{let De=r+1<n.length&&n.charAt(r+1)===ce;return De&&r++,De},K=ce=>{let De=B(ce),Ye="@"===ce?14:"!"===ce?20:"y"===ce&&De?4:"o"===ce?3:2,Ge=new RegExp("^\\d{"+("y"===ce?Ye:1)+","+Ye+"}"),Te=e.substring(u).match(Ge);if(!Te)throw"Missing number at position "+u;return u+=Te[0].length,parseInt(Te[0],10)},q=(ce,De,Ye)=>{let yt=-1,Ge=B(ce)?Ye:De,Te=[];for(let mt=0;mt<Ge.length;mt++)Te.push([mt,Ge[mt]]);Te.sort((mt,vt)=>-(mt[1].length-vt[1].length));for(let mt=0;mt<Te.length;mt++){let vt=Te[mt][1];if(e.substr(u,vt.length).toLowerCase()===vt.toLowerCase()){yt=Te[mt][0],u+=vt.length;break}}if(-1!==yt)return yt+1;throw"Unknown name at position "+u},Y=()=>{if(e.charAt(u)!==n.charAt(r))throw"Unexpected literal at position "+u;u++};for("month"===this.view&&(S=1),r=0;r<n.length;r++)if(E)"'"!==n.charAt(r)||B("'")?Y():E=!1;else switch(n.charAt(r)){case"d":S=K("d");break;case"D":q("D",this.getTranslation(Fl.DAY_NAMES_SHORT),this.getTranslation(Fl.DAY_NAMES));break;case"o":M=K("o");break;case"m":x=K("m");break;case"M":x=q("M",this.getTranslation(Fl.MONTH_NAMES_SHORT),this.getTranslation(Fl.MONTH_NAMES));break;case"y":g=K("y");break;case"@":R=new Date(K("@")),g=R.getFullYear(),x=R.getMonth()+1,S=R.getDate();break;case"!":R=new Date((K("!")-this.ticksTo1970)/1e4),g=R.getFullYear(),x=R.getMonth()+1,S=R.getDate();break;case"'":B("'")?Y():E=!0;break;default:Y()}if(u<e.length&&(c=e.substr(u),!/^\s+/.test(c)))throw"Extra/unparsed characters found in date: "+c;if(-1===g?g=(new Date).getFullYear():g<100&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(g<=m?0:-100)),M>-1)for(x=1,S=M;o=this.getDaysCountInMonth(g,x-1),!(S<=o);)x++,S-=o;if(R=this.daylightSavingAdjust(new Date(g,x-1,S)),R.getFullYear()!==g||R.getMonth()+1!==x||R.getDate()!==S)throw"Invalid date";return R}daylightSavingAdjust(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null}updateFilledState(){this.filled=this.inputFieldValue&&""!=this.inputFieldValue}onTodayButtonClick(e){let n=new Date,r={day:n.getDate(),month:n.getMonth(),year:n.getFullYear(),otherMonth:n.getMonth()!==this.currentMonth||n.getFullYear()!==this.currentYear,today:!0,selectable:!0};this.onDateSelect(e,r),this.onTodayClick.emit(e)}onClearButtonClick(e){this.updateModel(null),this.updateInputfield(),this.hideOverlay(),this.onClearClick.emit(e)}createResponsiveStyle(){if(this.numberOfMonths>1&&this.responsiveOptions){this.responsiveStyleElement||(this.responsiveStyleElement=document.createElement("style"),this.responsiveStyleElement.type="text/css",document.body.appendChild(this.responsiveStyleElement));let e="";if(this.responsiveOptions){let n=[...this.responsiveOptions].filter(r=>!(!r.breakpoint||!r.numMonths)).sort((r,o)=>-1*r.breakpoint.localeCompare(o.breakpoint,void 0,{numeric:!0}));for(let r=0;r<n.length;r++){let{breakpoint:o,numMonths:c}=n[r],u=`\n                        .p-datepicker[${this.attributeSelector}] .p-datepicker-group:nth-child(${c}) .p-datepicker-next {\n                            display: inline-flex !important;\n                        }\n                    `;for(let m=c;m<this.numberOfMonths;m++)u+=`\n                            .p-datepicker[${this.attributeSelector}] .p-datepicker-group:nth-child(${m+1}) {\n                                display: none !important;\n                            }\n                        `;e+=`\n                        @media screen and (max-width: ${o}) {\n                            ${u}\n                        }\n                    `}}this.responsiveStyleElement.innerHTML=e}}destroyResponsiveStyleElement(){this.responsiveStyleElement&&(this.responsiveStyleElement.remove(),this.responsiveStyleElement=null)}bindDocumentClickListener(){this.documentClickListener||this.zone.runOutsideAngular(()=>{this.documentClickListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","mousedown",n=>{this.isOutsideClicked(n)&&this.overlayVisible&&this.zone.run(()=>{this.hideOverlay(),this.onClickOutside.emit(n),this.cd.markForCheck()})})})}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){!this.documentResizeListener&&!this.touchUI&&(this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener))}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new hA(this.containerViewChild.nativeElement,()=>{this.overlayVisible&&this.hideOverlay()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}isOutsideClicked(e){return!(this.el.nativeElement.isSameNode(e.target)||this.isNavIconClicked(e)||this.el.nativeElement.contains(e.target)||this.overlay&&this.overlay.contains(e.target))}isNavIconClicked(e){return We.hasClass(e.target,"p-datepicker-prev")||We.hasClass(e.target,"p-datepicker-prev-icon")||We.hasClass(e.target,"p-datepicker-next")||We.hasClass(e.target,"p-datepicker-next-icon")}onWindowResize(){this.overlayVisible&&!We.isAndroid()&&this.hideOverlay()}onOverlayHide(){this.currentView=this.view,this.mask&&this.destroyMask(),this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.overlay=null}ngOnDestroy(){this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.translationSubscription&&this.translationSubscription.unsubscribe(),this.overlay&&this.autoZIndex&&ls.clear(this.overlay),this.destroyResponsiveStyleElement(),this.clearTimePickerTimer(),this.restoreOverlayAppend(),this.onOverlayHide()}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(Ss),te(Wo),te(gr),te(Bp),te(pA))},t.\u0275cmp=dn({type:t,selectors:[["p-calendar"]],contentQueries:function(e,n,r){if(1&e&&ol(r,zn,4),2&e){let o;xt(o=wt())&&(n.templates=o)}},viewQuery:function(e,n){if(1&e&&(Mt(NK,5),Mt(LK,5),Mt(RK,5)),2&e){let r;xt(r=wt())&&(n.containerViewChild=r.first),xt(r=wt())&&(n.inputfieldViewChild=r.first),xt(r=wt())&&(n.content=r.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(e,n){2&e&&po("p-inputwrapper-filled",n.filled)("p-inputwrapper-focus",n.focus)("p-calendar-clearable",n.showClear&&!n.disabled)},inputs:{style:"style",styleClass:"styleClass",inputStyle:"inputStyle",inputId:"inputId",name:"name",inputStyleClass:"inputStyleClass",placeholder:"placeholder",ariaLabelledBy:"ariaLabelledBy",iconAriaLabel:"iconAriaLabel",disabled:"disabled",dateFormat:"dateFormat",multipleSeparator:"multipleSeparator",rangeSeparator:"rangeSeparator",inline:"inline",showOtherMonths:"showOtherMonths",selectOtherMonths:"selectOtherMonths",showIcon:"showIcon",icon:"icon",appendTo:"appendTo",readonlyInput:"readonlyInput",shortYearCutoff:"shortYearCutoff",monthNavigator:"monthNavigator",yearNavigator:"yearNavigator",hourFormat:"hourFormat",timeOnly:"timeOnly",stepHour:"stepHour",stepMinute:"stepMinute",stepSecond:"stepSecond",showSeconds:"showSeconds",required:"required",showOnFocus:"showOnFocus",showWeek:"showWeek",showClear:"showClear",dataType:"dataType",selectionMode:"selectionMode",maxDateCount:"maxDateCount",showButtonBar:"showButtonBar",todayButtonStyleClass:"todayButtonStyleClass",clearButtonStyleClass:"clearButtonStyleClass",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",panelStyleClass:"panelStyleClass",panelStyle:"panelStyle",keepInvalid:"keepInvalid",hideOnDateTimeSelect:"hideOnDateTimeSelect",touchUI:"touchUI",timeSeparator:"timeSeparator",focusTrap:"focusTrap",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",tabindex:"tabindex",view:"view",defaultDate:"defaultDate",minDate:"minDate",maxDate:"maxDate",disabledDates:"disabledDates",disabledDays:"disabledDays",yearRange:"yearRange",showTime:"showTime",responsiveOptions:"responsiveOptions",numberOfMonths:"numberOfMonths",firstDayOfWeek:"firstDayOfWeek",locale:"locale"},outputs:{onFocus:"onFocus",onBlur:"onBlur",onClose:"onClose",onSelect:"onSelect",onClear:"onClear",onInput:"onInput",onTodayClick:"onTodayClick",onClearClick:"onClearClick",onMonthChange:"onMonthChange",onYearChange:"onYearChange",onClickOutside:"onClickOutside",onShow:"onShow"},features:[Nn([kY])],ngContentSelectors:EY,decls:4,vars:11,consts:[[3,"ngClass","ngStyle"],["container",""],[3,"ngIf"],[3,"class","ngStyle","ngClass","click",4,"ngIf"],["type","text","autocomplete","off",3,"value","readonly","ngStyle","placeholder","disabled","ngClass","focus","keydown","click","blur","input"],["inputfield",""],["class","p-calendar-clear-icon pi pi-times",3,"click",4,"ngIf"],["type","button","pButton","","pRipple","","class","p-datepicker-trigger","tabindex","0",3,"icon","disabled","click",4,"ngIf"],[1,"p-calendar-clear-icon","pi","pi-times",3,"click"],["type","button","pButton","","pRipple","","tabindex","0",1,"p-datepicker-trigger",3,"icon","disabled","click"],[3,"ngStyle","ngClass","click"],["contentWrapper",""],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-timepicker",4,"ngIf"],["class","p-datepicker-buttonbar",4,"ngIf"],[1,"p-datepicker-group-container"],["class","p-datepicker-group",4,"ngFor","ngForOf"],["class","p-monthpicker",4,"ngIf"],["class","p-yearpicker",4,"ngIf"],[1,"p-datepicker-group"],[1,"p-datepicker-header"],["class","p-datepicker-prev p-link","type","button","pRipple","",3,"keydown","click",4,"ngIf"],[1,"p-datepicker-title"],["type","button","class","p-datepicker-month p-link",3,"disabled","click","keydown",4,"ngIf"],["type","button","class","p-datepicker-year p-link",3,"disabled","click","keydown",4,"ngIf"],["class","p-datepicker-decade",4,"ngIf"],["type","button","pRipple","",1,"p-datepicker-next","p-link",3,"keydown","click"],[1,"p-datepicker-next-icon","pi","pi-chevron-right"],["class","p-datepicker-calendar-container",4,"ngIf"],["type","button","pRipple","",1,"p-datepicker-prev","p-link",3,"keydown","click"],[1,"p-datepicker-prev-icon","pi","pi-chevron-left"],["type","button",1,"p-datepicker-month","p-link",3,"disabled","click","keydown"],["type","button",1,"p-datepicker-year","p-link",3,"disabled","click","keydown"],[1,"p-datepicker-decade"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-datepicker-calendar-container"],[1,"p-datepicker-calendar"],["class","p-datepicker-weekheader p-disabled",4,"ngIf"],["scope","col",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"p-datepicker-weekheader","p-disabled"],["scope","col"],["class","p-datepicker-weeknumber",4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"p-datepicker-weeknumber"],[1,"p-disabled"],[3,"ngClass"],["draggable","false","pRipple","",3,"ngClass","click","keydown"],[1,"p-monthpicker"],["class","p-monthpicker-month","pRipple","",3,"ngClass","click","keydown",4,"ngFor","ngForOf"],["pRipple","",1,"p-monthpicker-month",3,"ngClass","click","keydown"],[1,"p-yearpicker"],["class","p-yearpicker-year","pRipple","",3,"ngClass","click","keydown",4,"ngFor","ngForOf"],["pRipple","",1,"p-yearpicker-year",3,"ngClass","click","keydown"],[1,"p-timepicker"],[1,"p-hour-picker"],["type","button","pRipple","",1,"p-link",3,"keydown","keydown.enter","keydown.space","mousedown","mouseup","keyup.enter","keyup.space","mouseleave"],[1,"pi","pi-chevron-up"],[1,"pi","pi-chevron-down"],[1,"p-separator"],[1,"p-minute-picker"],["class","p-separator",4,"ngIf"],["class","p-second-picker",4,"ngIf"],["class","p-ampm-picker",4,"ngIf"],[1,"p-second-picker"],[1,"p-ampm-picker"],["type","button","pRipple","",1,"p-link",3,"keydown","click","keydown.enter"],[1,"p-datepicker-buttonbar"],["type","button","pButton","","pRipple","",3,"label","ngClass","keydown","click"]],template:function(e,n){1&e&&(mu(TY),f(0,"span",0,1),D(2,VK,4,17,"ng-template",2),D(3,CY,9,28,"div",3),p()),2&e&&(Ji(n.styleClass),T("ngClass",Dp(6,SY,n.showIcon,n.timeOnly,n.disabled,n.focus))("ngStyle",n.style),v(2),T("ngIf",!n.inline),v(1),T("ngIf",n.inline||n.overlayVisible))},directives:[Na,La,Sn,_r,Vp,ic,nc],styles:[".p-calendar{position:relative;display:inline-flex;max-width:100%}.p-calendar .p-inputtext{flex:1 1 auto;width:1%}.p-calendar-w-btn .p-inputtext{border-top-right-radius:0;border-bottom-right-radius:0}.p-calendar-w-btn .p-datepicker-trigger{border-top-left-radius:0;border-bottom-left-radius:0}.p-fluid .p-calendar{display:flex}.p-fluid .p-calendar .p-inputtext{width:1%}.p-calendar .p-datepicker{min-width:100%}.p-datepicker{width:auto;position:absolute;top:0;left:0}.p-datepicker-inline{display:inline-block;position:static;overflow-x:auto}.p-datepicker-header{display:flex;align-items:center;justify-content:space-between}.p-datepicker-header .p-datepicker-title{margin:0 auto}.p-datepicker-prev,.p-datepicker-next{cursor:pointer;display:inline-flex;justify-content:center;align-items:center;overflow:hidden;position:relative}.p-datepicker-multiple-month .p-datepicker-group-container .p-datepicker-group{flex:1 1 auto}.p-datepicker-multiple-month .p-datepicker-group-container{display:flex}.p-datepicker table{width:100%;border-collapse:collapse}.p-datepicker td>span{display:flex;justify-content:center;align-items:center;cursor:pointer;margin:0 auto;overflow:hidden;position:relative}.p-monthpicker-month{width:33.3%;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-datepicker-buttonbar{display:flex;justify-content:space-between;align-items:center}.p-timepicker{display:flex;justify-content:center;align-items:center}.p-timepicker button{display:flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-timepicker>div{display:flex;align-items:center;flex-direction:column}.p-datepicker-touch-ui,.p-calendar .p-datepicker-touch-ui{position:fixed;top:50%;left:50%;min-width:80vw;transform:translate(-50%,-50%)}.p-yearpicker-year{width:50%;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden;position:relative}.p-calendar-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-calendar-clearable{position:relative}\n"],encapsulation:2,data:{animation:[km("overlayAnimation",[SL("visibleTouchUI",cs({transform:"translate(-50%,-50%)",opacity:1})),ul("void => visible",[cs({opacity:0,transform:"scaleY(0.8)"}),Pl("{{showTransitionParams}}",cs({opacity:1,transform:"*"}))]),ul("visible => void",[Pl("{{hideTransitionParams}}",cs({opacity:0}))]),ul("void => visibleTouchUI",[cs({opacity:0,transform:"translate3d(-50%, -40%, 0) scale(0.9)"}),Pl("{{showTransitionParams}}")]),ul("visibleTouchUI => void",[Pl("{{hideTransitionParams}}",cs({opacity:0,transform:"translate3d(-50%, -40%, 0) scale(0.9)"}))])])]},changeDetection:0}),t})(),wT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro,Up,Uc,_f],Up,Uc]}),t})();const DY=["container"],IY=["resizeHelper"],AY=["reorderIndicatorUp"],MY=["reorderIndicatorDown"],FY=["wrapper"],PY=["table"],OY=["tableHeader"];function NY(t,i){if(1&t&&(f(0,"div",14),ee(1,"i"),p()),2&t){const e=A();v(1),Ji("p-datatable-loading-icon pi-spin "+e.loadingIcon)}}function LY(t,i){1&t&&Jn(0)}function RY(t,i){if(1&t&&(f(0,"div",15),D(1,LY,1,0,"ng-container",16),p()),2&t){const e=A();v(1),T("ngTemplateOutlet",e.captionTemplate)}}function BY(t,i){if(1&t){const e=Ie();f(0,"p-paginator",17),L("onPageChange",function(r){return z(e),A().onPageChange(r)}),p()}if(2&t){const e=A();T("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showJumpToPageInput",e.showJumpToPageInput)("showPageLinks",e.showPageLinks)}}function jY(t,i){1&t&&Jn(0)}function VY(t,i){1&t&&Jn(0)}function UY(t,i){if(1&t&&ee(0,"tbody",25),2&t){const e=A(2);T("value",e.frozenValue)("frozenRows",!0)("pTableBody",e.columns)("pTableBodyTemplate",e.frozenBodyTemplate)("frozen",!0)}}function HY(t,i){1&t&&Jn(0)}const Hp=function(t){return{$implicit:t}};function zY(t,i){if(1&t&&(f(0,"tfoot",26),D(1,HY,1,0,"ng-container",20),p()),2&t){const e=A(2);v(1),T("ngTemplateOutlet",e.footerGroupedTemplate||e.footerTemplate)("ngTemplateOutletContext",Ei(2,Hp,e.columns))}}function $Y(t,i){if(1&t&&(f(0,"table",18,19),D(2,jY,1,0,"ng-container",20),f(3,"thead",21),D(4,VY,1,0,"ng-container",20),p(),D(5,UY,1,5,"tbody",22),ee(6,"tbody",23),D(7,zY,2,4,"tfoot",24),p()),2&t){const e=A();T("ngClass",e.tableStyleClass)("ngStyle",e.tableStyle),Ai("id",e.id+"-table"),v(2),T("ngTemplateOutlet",e.colGroupTemplate)("ngTemplateOutletContext",Ei(12,Hp,e.columns)),v(2),T("ngTemplateOutlet",e.headerGroupedTemplate||e.headerTemplate)("ngTemplateOutletContext",Ei(14,Hp,e.columns)),v(1),T("ngIf",e.frozenValue||e.frozenBodyTemplate),v(1),T("value",e.dataToRender)("pTableBody",e.columns)("pTableBodyTemplate",e.bodyTemplate),v(1),T("ngIf",e.footerGroupedTemplate||e.footerTemplate)}}function WY(t,i){1&t&&Jn(0)}function qY(t,i){1&t&&Jn(0)}function GY(t,i){if(1&t&&ee(0,"tbody",25),2&t){const e=A(2);T("value",e.frozenValue)("frozenRows",!0)("pTableBody",e.columns)("pTableBodyTemplate",e.bodyTemplate)("frozen",!0)}}function KY(t,i){1&t&&Jn(0)}function YY(t,i){if(1&t&&(f(0,"tfoot",26),D(1,KY,1,0,"ng-container",20),p()),2&t){const e=A(2);v(1),T("ngTemplateOutlet",e.footerGroupedTemplate||e.footerTemplate)("ngTemplateOutletContext",Ei(2,Hp,e.columns))}}function XY(t,i){if(1&t){const e=Ie();f(0,"cdk-virtual-scroll-viewport",27),L("scrolledIndexChange",function(r){return z(e),A().onScrollIndexChange(r)}),f(1,"table",18,19),D(3,WY,1,0,"ng-container",20),f(4,"thead",21,28),D(6,qY,1,0,"ng-container",20),p(),D(7,GY,1,5,"tbody",22),ee(8,"tbody",23),D(9,YY,2,4,"tfoot",24),p()()}if(2&t){const e=A();ud("height","flex"!==e.scrollHeight?e.scrollHeight:void 0),T("itemSize",e.virtualRowHeight)("minBufferPx",e.minBufferPx)("maxBufferPx",e.maxBufferPx),v(1),T("ngClass",e.tableStyleClass)("ngStyle",e.tableStyle),Ai("id",e.id+"-table"),v(2),T("ngTemplateOutlet",e.colGroupTemplate)("ngTemplateOutletContext",Ei(17,Hp,e.columns)),v(3),T("ngTemplateOutlet",e.headerGroupedTemplate||e.headerTemplate)("ngTemplateOutletContext",Ei(19,Hp,e.columns)),v(1),T("ngIf",e.frozenValue||e.frozenBodyTemplate),v(1),T("value",e.dataToRender)("pTableBody",e.columns)("pTableBodyTemplate",e.bodyTemplate),v(1),T("ngIf",e.footerGroupedTemplate||e.footerTemplate)}}function QY(t,i){if(1&t){const e=Ie();f(0,"p-paginator",29),L("onPageChange",function(r){return z(e),A().onPageChange(r)}),p()}if(2&t){const e=A();T("rows",e.rows)("first",e.first)("totalRecords",e.totalRecords)("pageLinkSize",e.pageLinks)("alwaysShow",e.alwaysShowPaginator)("rowsPerPageOptions",e.rowsPerPageOptions)("templateLeft",e.paginatorLeftTemplate)("templateRight",e.paginatorRightTemplate)("dropdownAppendTo",e.paginatorDropdownAppendTo)("dropdownScrollHeight",e.paginatorDropdownScrollHeight)("currentPageReportTemplate",e.currentPageReportTemplate)("showFirstLastIcon",e.showFirstLastIcon)("dropdownItemTemplate",e.paginatorDropdownItemTemplate)("showCurrentPageReport",e.showCurrentPageReport)("showJumpToPageDropdown",e.showJumpToPageDropdown)("showJumpToPageInput",e.showJumpToPageInput)("showPageLinks",e.showPageLinks)}}function JY(t,i){1&t&&Jn(0)}function ZY(t,i){if(1&t&&(f(0,"div",30),D(1,JY,1,0,"ng-container",16),p()),2&t){const e=A();v(1),T("ngTemplateOutlet",e.summaryTemplate)}}function eX(t,i){1&t&&ee(0,"div",31,32)}function tX(t,i){1&t&&ee(0,"span",33,34)}function nX(t,i){1&t&&ee(0,"span",35,36)}const iX=function(t,i,e,n,r,o,c,u,m,g,x,S,M,E){return{"p-datatable p-component":!0,"p-datatable-hoverable-rows":t,"p-datatable-auto-layout":i,"p-datatable-resizable":e,"p-datatable-resizable-fit":n,"p-datatable-scrollable":r,"p-datatable-scrollable-vertical":o,"p-datatable-scrollable-horizontal":c,"p-datatable-scrollable-both":u,"p-datatable-flex-scrollable":m,"p-datatable-responsive-stack":g,"p-datatable-responsive-scroll":x,"p-datatable-responsive":S,"p-datatable-grouped-header":M,"p-datatable-grouped-footer":E}},rX=function(t){return{height:t}},oX=["pTableBody",""];function sX(t,i){1&t&&Jn(0)}const CT=function(t,i,e,n,r){return{$implicit:t,rowIndex:i,columns:e,editing:n,frozen:r}};function aX(t,i){if(1&t&&(ni(0,3),D(1,sX,1,0,"ng-container",4),Si()),2&t){const e=A(),n=e.$implicit,r=e.index,o=A(2);v(1),T("ngTemplateOutlet",o.dt.groupHeaderTemplate)("ngTemplateOutletContext",dy(2,CT,n,o.dt.paginator?o.dt.first+r:r,o.columns,"row"===o.dt.editMode&&o.dt.isRowEditing(n),o.frozen))}}function lX(t,i){1&t&&Jn(0)}function cX(t,i){if(1&t&&(ni(0),D(1,lX,1,0,"ng-container",4),Si()),2&t){const e=A(),n=e.$implicit,r=e.index,o=A(2);v(1),T("ngTemplateOutlet",o.template)("ngTemplateOutletContext",dy(2,CT,n,o.dt.paginator?o.dt.first+r:r,o.columns,"row"===o.dt.editMode&&o.dt.isRowEditing(n),o.frozen))}}function uX(t,i){1&t&&Jn(0)}const dX=function(t,i,e,n,r,o,c){return{$implicit:t,rowIndex:i,columns:e,editing:n,frozen:r,rowgroup:o,rowspan:c}};function fX(t,i){if(1&t&&(ni(0),D(1,uX,1,0,"ng-container",4),Si()),2&t){const e=A(),n=e.$implicit,r=e.index,o=A(2);v(1),T("ngTemplateOutlet",o.template)("ngTemplateOutletContext",function c6(t,i,e,n,r,o,c,u,m,g){const x=Zs()+t,S=Ut();let M=Tl(S,x,e,n,r,o);return u0(S,x+4,c,u,m)||M?Fc(S,x+7,g?i.call(g,e,n,r,o,c,u,m):i(e,n,r,o,c,u,m)):um(S,x+7)}(2,dX,n,o.dt.paginator?o.dt.first+r:r,o.columns,"row"===o.dt.editMode&&o.dt.isRowEditing(n),o.frozen,o.shouldRenderRowspan(o.value,n,r),o.calculateRowGroupSize(o.value,n,r)))}}function pX(t,i){1&t&&Jn(0)}function hX(t,i){if(1&t&&(ni(0,3),D(1,pX,1,0,"ng-container",4),Si()),2&t){const e=A(),n=e.$implicit,r=e.index,o=A(2);v(1),T("ngTemplateOutlet",o.dt.groupFooterTemplate)("ngTemplateOutletContext",dy(2,CT,n,o.dt.paginator?o.dt.first+r:r,o.columns,"row"===o.dt.editMode&&o.dt.isRowEditing(n),o.frozen))}}function mX(t,i){if(1&t&&(D(0,aX,2,8,"ng-container",2),D(1,cX,2,8,"ng-container",0),D(2,fX,2,10,"ng-container",0),D(3,hX,2,8,"ng-container",2)),2&t){const e=i.$implicit,n=i.index,r=A(2);T("ngIf",r.dt.groupHeaderTemplate&&"subheader"===r.dt.rowGroupMode&&r.shouldRenderRowGroupHeader(r.value,e,n)),v(1),T("ngIf","rowspan"!==r.dt.rowGroupMode),v(1),T("ngIf","rowspan"===r.dt.rowGroupMode),v(1),T("ngIf",r.dt.groupFooterTemplate&&"subheader"===r.dt.rowGroupMode&&r.shouldRenderRowGroupFooter(r.value,e,n))}}function gX(t,i){if(1&t&&(ni(0),D(1,mX,4,4,"ng-template",1),Si()),2&t){const e=A();v(1),T("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function _X(t,i){1&t&&Jn(0)}function vX(t,i){if(1&t&&D(0,_X,1,0,"ng-container",4),2&t){const e=i.$implicit,n=i.index,r=A(2);T("ngTemplateOutlet",e?r.template:r.dt.loadingBodyTemplate)("ngTemplateOutletContext",dy(2,CT,e,r.dt.paginator?r.dt.first+n:n,r.columns,"row"===r.dt.editMode&&r.dt.isRowEditing(e),r.frozen))}}function yX(t,i){if(1&t&&(ni(0),D(1,vX,1,8,"ng-template",5),Si()),2&t){const e=A();v(1),T("cdkVirtualForOf",e.dt.filteredValue||e.dt.value)("cdkVirtualForTrackBy",e.dt.rowTrackBy)("cdkVirtualForTemplateCacheSize",0)}}function bX(t,i){1&t&&Jn(0)}const TT=function(t,i,e,n,r,o){return{$implicit:t,rowIndex:i,columns:e,expanded:n,editing:r,frozen:o}};function xX(t,i){if(1&t&&(ni(0),D(1,bX,1,0,"ng-container",4),Si()),2&t){const e=A(),n=e.$implicit,r=e.index,o=A(2);v(1),T("ngTemplateOutlet",o.template)("ngTemplateOutletContext",w0(2,TT,n,o.dt.paginator?o.dt.first+r:r,o.columns,o.dt.isRowExpanded(n),"row"===o.dt.editMode&&o.dt.isRowEditing(n),o.frozen))}}function wX(t,i){1&t&&Jn(0)}function CX(t,i){if(1&t&&(ni(0,3),D(1,wX,1,0,"ng-container",4),Si()),2&t){const e=A(),n=e.$implicit,r=e.index,o=A(2);v(1),T("ngTemplateOutlet",o.dt.groupHeaderTemplate)("ngTemplateOutletContext",w0(2,TT,n,o.dt.paginator?o.dt.first+r:r,o.columns,o.dt.isRowExpanded(n),"row"===o.dt.editMode&&o.dt.isRowEditing(n),o.frozen))}}function TX(t,i){1&t&&Jn(0)}function SX(t,i){1&t&&Jn(0)}function EX(t,i){if(1&t&&(ni(0,3),D(1,SX,1,0,"ng-container",4),Si()),2&t){const e=A(2),n=e.$implicit,r=e.index,o=A(2);v(1),T("ngTemplateOutlet",o.dt.groupFooterTemplate)("ngTemplateOutletContext",w0(2,TT,n,o.dt.paginator?o.dt.first+r:r,o.columns,o.dt.isRowExpanded(n),"row"===o.dt.editMode&&o.dt.isRowEditing(n),o.frozen))}}const rR=function(t,i,e,n){return{$implicit:t,rowIndex:i,columns:e,frozen:n}};function kX(t,i){if(1&t&&(ni(0),D(1,TX,1,0,"ng-container",4),D(2,EX,2,9,"ng-container",2),Si()),2&t){const e=A(),n=e.$implicit,r=e.index,o=A(2);v(1),T("ngTemplateOutlet",o.dt.expandedRowTemplate)("ngTemplateOutletContext",Dp(3,rR,n,o.dt.paginator?o.dt.first+r:r,o.columns,o.frozen)),v(1),T("ngIf",o.dt.groupFooterTemplate&&"subheader"===o.dt.rowGroupMode&&o.shouldRenderRowGroupFooter(o.value,n,r))}}function DX(t,i){if(1&t&&(D(0,xX,2,9,"ng-container",0),D(1,CX,2,9,"ng-container",2),D(2,kX,3,8,"ng-container",0)),2&t){const e=i.$implicit,n=i.index,r=A(2);T("ngIf",!r.dt.groupHeaderTemplate),v(1),T("ngIf",r.dt.groupHeaderTemplate&&"subheader"===r.dt.rowGroupMode&&r.shouldRenderRowGroupHeader(r.value,e,n)),v(1),T("ngIf",r.dt.isRowExpanded(e))}}function IX(t,i){if(1&t&&(ni(0),D(1,DX,3,3,"ng-template",1),Si()),2&t){const e=A();v(1),T("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function AX(t,i){1&t&&Jn(0)}function MX(t,i){1&t&&Jn(0)}function FX(t,i){if(1&t&&(ni(0),D(1,MX,1,0,"ng-container",4),Si()),2&t){const e=A(),n=e.$implicit,r=e.index,o=A(2);v(1),T("ngTemplateOutlet",o.dt.frozenExpandedRowTemplate)("ngTemplateOutletContext",Dp(2,rR,n,o.dt.paginator?o.dt.first+r:r,o.columns,o.frozen))}}function PX(t,i){if(1&t&&(D(0,AX,1,0,"ng-container",4),D(1,FX,2,7,"ng-container",0)),2&t){const e=i.$implicit,n=i.index,r=A(2);T("ngTemplateOutlet",r.template)("ngTemplateOutletContext",w0(3,TT,e,r.dt.paginator?r.dt.first+n:n,r.columns,r.dt.isRowExpanded(e),"row"===r.dt.editMode&&r.dt.isRowEditing(e),r.frozen)),v(1),T("ngIf",r.dt.isRowExpanded(e))}}function OX(t,i){if(1&t&&(ni(0),D(1,PX,2,10,"ng-template",1),Si()),2&t){const e=A();v(1),T("ngForOf",e.value)("ngForTrackBy",e.dt.rowTrackBy)}}function NX(t,i){1&t&&Jn(0)}const oR=function(t,i){return{$implicit:t,frozen:i}};function LX(t,i){if(1&t&&(ni(0),D(1,NX,1,0,"ng-container",4),Si()),2&t){const e=A();v(1),T("ngTemplateOutlet",e.dt.loadingBodyTemplate)("ngTemplateOutletContext",ia(2,oR,e.columns,e.frozen))}}function RX(t,i){1&t&&Jn(0)}function BX(t,i){if(1&t&&(ni(0),D(1,RX,1,0,"ng-container",4),Si()),2&t){const e=A();v(1),T("ngTemplateOutlet",e.dt.emptyMessageTemplate)("ngTemplateOutletContext",ia(2,oR,e.columns,e.frozen))}}let kA=(()=>{class t{constructor(){this.sortSource=new Wi,this.selectionSource=new Wi,this.contextMenuSource=new Wi,this.valueSource=new Wi,this.totalRecordsSource=new Wi,this.columnsSource=new Wi,this.resetSource=new Wi,this.sortSource$=this.sortSource.asObservable(),this.selectionSource$=this.selectionSource.asObservable(),this.contextMenuSource$=this.contextMenuSource.asObservable(),this.valueSource$=this.valueSource.asObservable(),this.totalRecordsSource$=this.totalRecordsSource.asObservable(),this.columnsSource$=this.columnsSource.asObservable(),this.resetSource$=this.resetSource.asObservable()}onSort(e){this.sortSource.next(e)}onSelectionChange(){this.selectionSource.next(null)}onResetChange(){this.resetSource.next(null)}onContextMenu(e){this.contextMenuSource.next(e)}onValueChange(e){this.valueSource.next(e)}onTotalRecordsChange(e){this.totalRecordsSource.next(e)}onColumnsChange(e){this.columnsSource.next(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})(),ki=(()=>{class t{constructor(e,n,r,o,c,u){this.el=e,this.zone=n,this.tableService=r,this.cd=o,this.filterService=c,this.overlayService=u,this.pageLinks=5,this.alwaysShowPaginator=!0,this.paginatorPosition="bottom",this.paginatorDropdownScrollHeight="200px",this.currentPageReportTemplate="{currentPage} of {totalPages}",this.showFirstLastIcon=!0,this.showPageLinks=!0,this.defaultSortOrder=1,this.sortMode="single",this.resetPageOnSort=!0,this.selectAllChange=new Et,this.selectionChange=new Et,this.contextMenuSelectionChange=new Et,this.contextMenuSelectionMode="separate",this.rowTrackBy=(m,g)=>g,this.lazy=!1,this.lazyLoadOnInit=!0,this.compareSelectionBy="deepEquals",this.csvSeparator=",",this.exportFilename="download",this.filters={},this.filterDelay=300,this.expandedRowKeys={},this.editingRowKeys={},this.rowExpandMode="multiple",this.scrollDirection="vertical",this.virtualScrollDelay=250,this.virtualRowHeight=28,this.columnResizeMode="fit",this.loadingIcon="pi pi-spinner",this.showLoader=!0,this.showInitialSortBadge=!0,this.stateStorage="session",this.editMode="cell",this.groupRowsByOrder=1,this.responsiveLayout="stack",this.breakpoint="960px",this.onRowSelect=new Et,this.onRowUnselect=new Et,this.onPage=new Et,this.onSort=new Et,this.onFilter=new Et,this.onLazyLoad=new Et,this.onRowExpand=new Et,this.onRowCollapse=new Et,this.onContextMenuSelect=new Et,this.onColResize=new Et,this.onColReorder=new Et,this.onRowReorder=new Et,this.onEditInit=new Et,this.onEditComplete=new Et,this.onEditCancel=new Et,this.onHeaderCheckboxToggle=new Et,this.sortFunction=new Et,this.firstChange=new Et,this.rowsChange=new Et,this.onStateSave=new Et,this.onStateRestore=new Et,this._value=[],this._totalRecords=0,this._first=0,this.selectionKeys={},this._sortOrder=1,this._selectAll=null,this.columnResizing=!1,this.rowGroupHeaderStyleObject={},this.id=N0(),this.virtualScrollInitialized=!1}ngOnInit(){this.lazy&&this.lazyLoadOnInit&&(this.virtualScroll||this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.restoringFilter&&(this.restoringFilter=!1)),"stack"===this.responsiveLayout&&!this.scrollable&&this.createResponsiveStyle(),this.initialized=!0}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"caption":this.captionTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"headergrouped":this.headerGroupedTemplate=e.template;break;case"body":this.bodyTemplate=e.template;break;case"loadingbody":this.loadingBodyTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"footergrouped":this.footerGroupedTemplate=e.template;break;case"summary":this.summaryTemplate=e.template;break;case"colgroup":this.colGroupTemplate=e.template;break;case"rowexpansion":this.expandedRowTemplate=e.template;break;case"groupheader":this.groupHeaderTemplate=e.template;break;case"rowspan":this.rowspanTemplate=e.template;break;case"groupfooter":this.groupFooterTemplate=e.template;break;case"frozenrows":this.frozenRowsTemplate=e.template;break;case"frozenheader":this.frozenHeaderTemplate=e.template;break;case"frozenbody":this.frozenBodyTemplate=e.template;break;case"frozenfooter":this.frozenFooterTemplate=e.template;break;case"frozencolgroup":this.frozenColGroupTemplate=e.template;break;case"frozenrowexpansion":this.frozenExpandedRowTemplate=e.template;break;case"emptymessage":this.emptyMessageTemplate=e.template;break;case"paginatorleft":this.paginatorLeftTemplate=e.template;break;case"paginatorright":this.paginatorRightTemplate=e.template;break;case"paginatordropdownitem":this.paginatorDropdownItemTemplate=e.template}})}ngAfterViewInit(){this.isStateful()&&this.resizableColumns&&this.restoreColumnWidths(),this.scrollable&&this.virtualScroll&&(this.virtualScrollSubscription=this.virtualScrollBody.renderedRangeStream.subscribe(e=>{this.tableHeaderViewChild.nativeElement.style.top=e.start*this.virtualRowHeight*-1+"px"}))}ngOnChanges(e){e.value&&(this.isStateful()&&!this.stateRestored&&this.restoreState(),this._value=e.value.currentValue,this.lazy||(this.totalRecords=this._value?this._value.length:0,"single"==this.sortMode&&(this.sortField||this.groupRowsBy)?this.sortSingle():"multiple"==this.sortMode&&(this.multiSortMeta||this.groupRowsBy)?this.sortMultiple():this.hasFilter()&&this._filter()),this.tableService.onValueChange(e.value.currentValue)),e.columns&&(this._columns=e.columns.currentValue,this.tableService.onColumnsChange(e.columns.currentValue),this._columns&&this.isStateful()&&this.reorderableColumns&&!this.columnOrderStateRestored&&this.restoreColumnOrder()),e.sortField&&(this._sortField=e.sortField.currentValue,(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle()),e.groupRowsBy&&(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle(),e.sortOrder&&(this._sortOrder=e.sortOrder.currentValue,(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle()),e.groupRowsByOrder&&(!this.lazy||this.initialized)&&"single"===this.sortMode&&this.sortSingle(),e.multiSortMeta&&(this._multiSortMeta=e.multiSortMeta.currentValue,"multiple"===this.sortMode&&(this.initialized||!this.lazy&&!this.virtualScroll)&&this.sortMultiple()),e.selection&&(this._selection=e.selection.currentValue,this.preventSelectionSetterPropagation||(this.updateSelectionKeys(),this.tableService.onSelectionChange()),this.preventSelectionSetterPropagation=!1),e.selectAll&&(this._selectAll=e.selectAll.currentValue,this.preventSelectionSetterPropagation||(this.updateSelectionKeys(),this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()),this.preventSelectionSetterPropagation=!1)}get value(){return this._value}set value(e){this._value=e}get columns(){return this._columns}set columns(e){this._columns=e}get first(){return this._first}set first(e){this._first=e}get rows(){return this._rows}set rows(e){this._rows=e}get totalRecords(){return this._totalRecords}set totalRecords(e){this._totalRecords=e,this.tableService.onTotalRecordsChange(this._totalRecords)}get sortField(){return this._sortField}set sortField(e){this._sortField=e}get sortOrder(){return this._sortOrder}set sortOrder(e){this._sortOrder=e}get multiSortMeta(){return this._multiSortMeta}set multiSortMeta(e){this._multiSortMeta=e}get selection(){return this._selection}set selection(e){this._selection=e}get selectAll(){return this._selection}set selectAll(e){this._selection=e}get dataToRender(){let e=this.filteredValue||this.value;return e?this.paginator&&!this.lazy?e.slice(this.first,this.first+this.rows):e:[]}updateSelectionKeys(){if(this.dataKey&&this._selection)if(this.selectionKeys={},Array.isArray(this._selection))for(let e of this._selection)this.selectionKeys[String(Pn.resolveFieldData(e,this.dataKey))]=1;else this.selectionKeys[String(Pn.resolveFieldData(this._selection,this.dataKey))]=1}onPageChange(e){this.first=e.first,this.rows=e.rows,this.lazy&&this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.onPage.emit({first:this.first,rows:this.rows}),this.firstChange.emit(this.first),this.rowsChange.emit(this.rows),this.tableService.onValueChange(this.value),this.isStateful()&&this.saveState(),this.anchorRowIndex=null,this.scrollable&&this.resetScrollTop()}sort(e){let n=e.originalEvent;if("single"===this.sortMode&&(this._sortOrder=this.sortField===e.field?-1*this.sortOrder:this.defaultSortOrder,this._sortField=e.field,this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first),this.scrollable&&this.resetScrollTop()),this.sortSingle()),"multiple"===this.sortMode){let r=n.metaKey||n.ctrlKey,o=this.getSortMeta(e.field);o?r?o.order=-1*o.order:(this._multiSortMeta=[{field:e.field,order:-1*o.order}],this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first),this.scrollable&&this.resetScrollTop())):((!r||!this.multiSortMeta)&&(this._multiSortMeta=[],this.resetPageOnSort&&(this._first=0,this.firstChange.emit(this._first))),this._multiSortMeta.push({field:e.field,order:this.defaultSortOrder})),this.sortMultiple()}this.isStateful()&&this.saveState(),this.anchorRowIndex=null}sortSingle(){let e=this.sortField||this.groupRowsBy,n=this.sortField?this.sortOrder:this.groupRowsByOrder;if(this.groupRowsBy&&this.sortField&&this.groupRowsBy!==this.sortField)return this._multiSortMeta=[this.getGroupRowsMeta(),{field:this.sortField,order:this.sortOrder}],void this.sortMultiple();if(e&&n){this.restoringSort&&(this.restoringSort=!1),this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.value&&(this.customSort?this.sortFunction.emit({data:this.value,mode:this.sortMode,field:e,order:n}):(this.value.sort((o,c)=>{let u=Pn.resolveFieldData(o,e),m=Pn.resolveFieldData(c,e),g=null;return g=null==u&&null!=m?-1:null!=u&&null==m?1:null==u&&null==m?0:"string"==typeof u&&"string"==typeof m?u.localeCompare(m):u<m?-1:u>m?1:0,n*g}),this._value=[...this.value]),this.hasFilter()&&this._filter());let r={field:e,order:n};this.onSort.emit(r),this.tableService.onSort(r)}}sortMultiple(){this.groupRowsBy&&(this._multiSortMeta?this.multiSortMeta[0].field!==this.groupRowsBy&&(this._multiSortMeta=[this.getGroupRowsMeta(),...this._multiSortMeta]):this._multiSortMeta=[this.getGroupRowsMeta()]),this.multiSortMeta&&(this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.value&&(this.customSort?this.sortFunction.emit({data:this.value,mode:this.sortMode,multiSortMeta:this.multiSortMeta}):(this.value.sort((e,n)=>this.multisortField(e,n,this.multiSortMeta,0)),this._value=[...this.value]),this.hasFilter()&&this._filter()),this.onSort.emit({multisortmeta:this.multiSortMeta}),this.tableService.onSort(this.multiSortMeta))}multisortField(e,n,r,o){let c=Pn.resolveFieldData(e,r[o].field),u=Pn.resolveFieldData(n,r[o].field),m=null;if(null==c&&null!=u)m=-1;else if(null!=c&&null==u)m=1;else if(null==c&&null==u)m=0;else if("string"==typeof c||c instanceof String){if(c.localeCompare&&c!=u)return r[o].order*c.localeCompare(u)}else m=c<u?-1:1;return c==u?r.length-1>o?this.multisortField(e,n,r,o+1):0:r[o].order*m}getSortMeta(e){if(this.multiSortMeta&&this.multiSortMeta.length)for(let n=0;n<this.multiSortMeta.length;n++)if(this.multiSortMeta[n].field===e)return this.multiSortMeta[n];return null}isSorted(e){if("single"===this.sortMode)return this.sortField&&this.sortField===e;if("multiple"===this.sortMode){let n=!1;if(this.multiSortMeta)for(let r=0;r<this.multiSortMeta.length;r++)if(this.multiSortMeta[r].field==e){n=!0;break}return n}}handleRowClick(e){let n=e.originalEvent.target,r=n.nodeName,o=n.parentElement&&n.parentElement.nodeName;if("INPUT"!=r&&"BUTTON"!=r&&"A"!=r&&"INPUT"!=o&&"BUTTON"!=o&&"A"!=o&&!We.hasClass(e.originalEvent.target,"p-clickable")){if(this.selectionMode){let c=e.rowData,u=e.rowIndex;if(this.preventSelectionSetterPropagation=!0,this.isMultipleSelectionMode()&&e.originalEvent.shiftKey&&null!=this.anchorRowIndex)We.clearSelection(),null!=this.rangeRowIndex&&this.clearSelectionRange(e.originalEvent),this.rangeRowIndex=u,this.selectRange(e.originalEvent,u);else{let m=this.isSelected(c);if(!m&&!this.isRowSelectable(c,u))return;let g=!this.rowTouched&&this.metaKeySelection,x=this.dataKey?String(Pn.resolveFieldData(c,this.dataKey)):null;if(this.anchorRowIndex=u,this.rangeRowIndex=u,g){let S=e.originalEvent.metaKey||e.originalEvent.ctrlKey;if(m&&S){if(this.isSingleSelectionMode())this._selection=null,this.selectionKeys={},this.selectionChange.emit(null);else{let M=this.findIndexInSelection(c);this._selection=this.selection.filter((E,R)=>R!=M),this.selectionChange.emit(this.selection),x&&delete this.selectionKeys[x]}this.onRowUnselect.emit({originalEvent:e.originalEvent,data:c,type:"row"})}else this.isSingleSelectionMode()?(this._selection=c,this.selectionChange.emit(c),x&&(this.selectionKeys={},this.selectionKeys[x]=1)):this.isMultipleSelectionMode()&&(S?this._selection=this.selection||[]:(this._selection=[],this.selectionKeys={}),this._selection=[...this.selection,c],this.selectionChange.emit(this.selection),x&&(this.selectionKeys[x]=1)),this.onRowSelect.emit({originalEvent:e.originalEvent,data:c,type:"row",index:u})}else if("single"===this.selectionMode)m?(this._selection=null,this.selectionKeys={},this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,data:c,type:"row",index:u})):(this._selection=c,this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,data:c,type:"row",index:u}),x&&(this.selectionKeys={},this.selectionKeys[x]=1));else if("multiple"===this.selectionMode)if(m){let S=this.findIndexInSelection(c);this._selection=this.selection.filter((M,E)=>E!=S),this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,data:c,type:"row",index:u}),x&&delete this.selectionKeys[x]}else this._selection=this.selection?[...this.selection,c]:[c],this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,data:c,type:"row",index:u}),x&&(this.selectionKeys[x]=1)}this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}this.rowTouched=!1}}handleRowTouchEnd(e){this.rowTouched=!0}handleRowRightClick(e){if(this.contextMenu){const n=e.rowData,r=e.rowIndex;if("separate"===this.contextMenuSelectionMode)this.contextMenuSelection=n,this.contextMenuSelectionChange.emit(n),this.onContextMenuSelect.emit({originalEvent:e.originalEvent,data:n,index:e.rowIndex}),this.contextMenu.show(e.originalEvent),this.tableService.onContextMenu(n);else if("joint"===this.contextMenuSelectionMode){this.preventSelectionSetterPropagation=!0;let o=this.isSelected(n),c=this.dataKey?String(Pn.resolveFieldData(n,this.dataKey)):null;if(!o){if(!this.isRowSelectable(n,r))return;this.isSingleSelectionMode()?(this.selection=n,this.selectionChange.emit(n),c&&(this.selectionKeys={},this.selectionKeys[c]=1)):this.isMultipleSelectionMode()&&(this._selection=this.selection?[...this.selection,n]:[n],this.selectionChange.emit(this.selection),c&&(this.selectionKeys[c]=1))}this.tableService.onSelectionChange(),this.contextMenu.show(e.originalEvent),this.onContextMenuSelect.emit({originalEvent:e,data:n,index:e.rowIndex})}}}selectRange(e,n){let r,o;this.anchorRowIndex>n?(r=n,o=this.anchorRowIndex):this.anchorRowIndex<n?(r=this.anchorRowIndex,o=n):(r=n,o=n),this.lazy&&this.paginator&&(r-=this.first,o-=this.first);let c=[];for(let u=r;u<=o;u++){let m=this.filteredValue?this.filteredValue[u]:this.value[u];if(!this.isSelected(m)){if(!this.isRowSelectable(m,n))continue;c.push(m),this._selection=[...this.selection,m];let g=this.dataKey?String(Pn.resolveFieldData(m,this.dataKey)):null;g&&(this.selectionKeys[g]=1)}}this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e,data:c,type:"row"})}clearSelectionRange(e){let n,r;this.rangeRowIndex>this.anchorRowIndex?(n=this.anchorRowIndex,r=this.rangeRowIndex):this.rangeRowIndex<this.anchorRowIndex?(n=this.rangeRowIndex,r=this.anchorRowIndex):(n=this.rangeRowIndex,r=this.rangeRowIndex);for(let o=n;o<=r;o++){let c=this.value[o],u=this.findIndexInSelection(c);this._selection=this.selection.filter((g,x)=>x!=u);let m=this.dataKey?String(Pn.resolveFieldData(c,this.dataKey)):null;m&&delete this.selectionKeys[m],this.onRowUnselect.emit({originalEvent:e,data:c,type:"row"})}}isSelected(e){return!(!e||!this.selection)&&(this.dataKey?void 0!==this.selectionKeys[Pn.resolveFieldData(e,this.dataKey)]:this.selection instanceof Array?this.findIndexInSelection(e)>-1:this.equals(e,this.selection))}findIndexInSelection(e){let n=-1;if(this.selection&&this.selection.length)for(let r=0;r<this.selection.length;r++)if(this.equals(e,this.selection[r])){n=r;break}return n}isRowSelectable(e,n){return!(this.rowSelectable&&!this.rowSelectable({data:e,index:n}))}toggleRowWithRadio(e,n){if(this.preventSelectionSetterPropagation=!0,this.selection!=n){if(!this.isRowSelectable(n,e.rowIndex))return;this._selection=n,this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:n,type:"radiobutton"}),this.dataKey&&(this.selectionKeys={},this.selectionKeys[String(Pn.resolveFieldData(n,this.dataKey))]=1)}else this._selection=null,this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:n,type:"radiobutton"});this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}toggleRowWithCheckbox(e,n){this.selection=this.selection||[];let r=this.isSelected(n),o=this.dataKey?String(Pn.resolveFieldData(n,this.dataKey)):null;if(this.preventSelectionSetterPropagation=!0,r){let c=this.findIndexInSelection(n);this._selection=this.selection.filter((u,m)=>m!=c),this.selectionChange.emit(this.selection),this.onRowUnselect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:n,type:"checkbox"}),o&&delete this.selectionKeys[o]}else{if(!this.isRowSelectable(n,e.rowIndex))return;this._selection=this.selection?[...this.selection,n]:[n],this.selectionChange.emit(this.selection),this.onRowSelect.emit({originalEvent:e.originalEvent,index:e.rowIndex,data:n,type:"checkbox"}),o&&(this.selectionKeys[o]=1)}this.tableService.onSelectionChange(),this.isStateful()&&this.saveState()}toggleRowsWithCheckbox(e,n){if(null!==this._selectAll)this.selectAllChange.emit({originalEvent:e,checked:n});else{const r=this.selectionPageOnly?this.dataToRender:this.filteredValue||this.value||[];let o=this.selectionPageOnly&&this._selection?this._selection.filter(c=>!r.some(u=>this.equals(c,u))):[];n&&(o=this.frozenValue?[...o,...this.frozenValue,...r]:[...o,...r],o=this.rowSelectable?o.filter((c,u)=>this.rowSelectable({data:c,index:u})):o),this._selection=o,this.preventSelectionSetterPropagation=!0,this.updateSelectionKeys(),this.selectionChange.emit(this._selection),this.tableService.onSelectionChange(),this.onHeaderCheckboxToggle.emit({originalEvent:e,checked:n}),this.isStateful()&&this.saveState()}}equals(e,n){return"equals"===this.compareSelectionBy?e===n:Pn.equals(e,n,this.dataKey)}filter(e,n,r){this.filterTimeout&&clearTimeout(this.filterTimeout),this.isFilterBlank(e)?this.filters[n]&&delete this.filters[n]:this.filters[n]={value:e,matchMode:r},this.filterTimeout=setTimeout(()=>{this._filter(),this.filterTimeout=null},this.filterDelay),this.anchorRowIndex=null}filterGlobal(e,n){this.filter(e,"global",n)}isFilterBlank(e){return null==e||"string"==typeof e&&0==e.trim().length||e instanceof Array&&0==e.length}_filter(){if(this.restoringFilter||(this.first=0,this.firstChange.emit(this.first)),this.lazy)this.onLazyLoad.emit(this.createLazyLoadMetadata());else{if(!this.value)return;if(this.hasFilter()){let e;if(this.filters.global){if(!this.columns&&!this.globalFilterFields)throw new Error("Global filtering requires dynamic columns or globalFilterFields to be defined.");e=this.globalFilterFields||this.columns}this.filteredValue=[];for(let n=0;n<this.value.length;n++){let u,r=!0,o=!1,c=!1;for(let m in this.filters)if(this.filters.hasOwnProperty(m)&&"global"!==m){c=!0;let g=m,x=this.filters[g];if(Array.isArray(x)){for(let S of x)if(r=this.executeLocalFilter(g,this.value[n],S),S.operator===xL.OR&&r||S.operator===xL.AND&&!r)break}else r=this.executeLocalFilter(g,this.value[n],x);if(!r)break}if(this.filters.global&&!o&&e)for(let m=0;m<e.length&&(o=this.filterService.filters[this.filters.global.matchMode](Pn.resolveFieldData(this.value[n],e[m].field||e[m]),this.filters.global.value,this.filterLocale),!o);m++);u=this.filters.global?c?c&&r&&o:o:c&&r,u&&this.filteredValue.push(this.value[n])}this.filteredValue.length===this.value.length&&(this.filteredValue=null),this.paginator&&(this.totalRecords=this.filteredValue?this.filteredValue.length:this.value?this.value.length:0)}else this.filteredValue=null,this.paginator&&(this.totalRecords=this.value?this.value.length:0)}this.onFilter.emit({filters:this.filters,filteredValue:this.filteredValue||this.value}),this.tableService.onValueChange(this.value),this.isStateful()&&!this.restoringFilter&&this.saveState(),this.restoringFilter&&(this.restoringFilter=!1),this.cd.markForCheck(),this.scrollable&&this.resetScrollTop()}executeLocalFilter(e,n,r){let o=r.value,c=r.matchMode||Ea.STARTS_WITH,u=Pn.resolveFieldData(n,e);return this.filterService.filters[c](u,o,this.filterLocale)}hasFilter(){let e=!0;for(let n in this.filters)if(this.filters.hasOwnProperty(n)){e=!1;break}return!e}createLazyLoadMetadata(){return{first:this.first,rows:this.rows,sortField:this.sortField,sortOrder:this.sortOrder,filters:this.filters,globalFilter:this.filters&&this.filters.global?this.filters.global.value:null,multiSortMeta:this.multiSortMeta}}clear(){this._sortField=null,this._sortOrder=this.defaultSortOrder,this._multiSortMeta=null,this.tableService.onSort(null),this.filters.global&&(this.filters.global.value=null),this.filteredValue=null,this.tableService.onResetChange(),this.first=0,this.firstChange.emit(this.first),this.lazy?this.onLazyLoad.emit(this.createLazyLoadMetadata()):this.totalRecords=this._value?this._value.length:0}reset(){this.clear()}getExportHeader(e){return e[this.exportHeader]||e.header||e.field}exportCSV(e){let n,r="",o=this.columns;e&&e.selectionOnly?n=this.selection||[]:(n=this.filteredValue||this.value,this.frozenValue&&(n=n?[...this.frozenValue,...n]:this.frozenValue));for(let m=0;m<o.length;m++){let g=o[m];!1!==g.exportable&&g.field&&(r+='"'+this.getExportHeader(g)+'"',m<o.length-1&&(r+=this.csvSeparator))}n.forEach((m,g)=>{r+="\n";for(let x=0;x<o.length;x++){let S=o[x];if(!1!==S.exportable&&S.field){let M=Pn.resolveFieldData(m,S.field);M=null!=M?this.exportFunction?this.exportFunction({data:M,field:S.field}):String(M).replace(/"/g,'""'):"",r+='"'+M+'"',x<o.length-1&&(r+=this.csvSeparator)}}});let c=new Blob([r],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a");u.style.display="none",document.body.appendChild(u),void 0!==u.download?(u.setAttribute("href",URL.createObjectURL(c)),u.setAttribute("download",this.exportFilename+".csv"),u.click()):(r="data:text/csv;charset=utf-8,"+r,window.open(encodeURI(r))),document.body.removeChild(u)}resetScrollTop(){this.virtualScroll?this.scrollToVirtualIndex(0):this.scrollTo({top:0})}scrollToVirtualIndex(e){this.virtualScrollBody&&this.virtualScrollBody.scrollToIndex(e)}onScrollIndexChange(e){this.lazy&&(this.virtualScrollTimeout&&clearTimeout(this.virtualScrollTimeout),this.virtualScrollTimeout=setTimeout(()=>{let n=Math.floor(e/this.rows),r=0===n?0:(n-1)*this.rows,o=0===n?2*this.rows:3*this.rows;n!==this.virtualPage&&(this.virtualPage=n,this.lazyLoadOnInit||this.virtualScrollInitialized?this.onLazyLoad.emit({first:r,rows:o,sortField:this.sortField,sortOrder:this.sortOrder,filters:this.filters,globalFilter:this.filters&&this.filters.global?this.filters.global.value:null,multiSortMeta:this.multiSortMeta}):this.virtualScrollInitialized=!0)},this.virtualScrollDelay))}scrollTo(e){this.virtualScrollBody?this.virtualScrollBody.scrollTo(e):this.wrapperViewChild&&this.wrapperViewChild.nativeElement&&(this.wrapperViewChild.nativeElement.scrollTo?this.wrapperViewChild.nativeElement.scrollTo(e):(this.wrapperViewChild.nativeElement.scrollLeft=e.left,this.wrapperViewChild.nativeElement.scrollTop=e.top))}updateEditingCell(e,n,r,o){this.editingCell=e,this.editingCellData=n,this.editingCellField=r,this.editingCellRowIndex=o,this.bindDocumentEditListener()}isEditingCellValid(){return this.editingCell&&0===We.find(this.editingCell,".ng-invalid.ng-dirty").length}bindDocumentEditListener(){this.documentEditListener||(this.documentEditListener=e=>{this.editingCell&&!this.selfClick&&this.isEditingCellValid()&&(We.removeClass(this.editingCell,"p-cell-editing"),this.editingCell=null,this.onEditComplete.emit({field:this.editingCellField,data:this.editingCellData,originalEvent:e,index:this.editingCellRowIndex}),this.editingCellField=null,this.editingCellData=null,this.editingCellRowIndex=null,this.unbindDocumentEditListener(),this.cd.markForCheck(),this.overlaySubscription&&this.overlaySubscription.unsubscribe()),this.selfClick=!1},document.addEventListener("click",this.documentEditListener))}unbindDocumentEditListener(){this.documentEditListener&&(document.removeEventListener("click",this.documentEditListener),this.documentEditListener=null)}initRowEdit(e){let n=String(Pn.resolveFieldData(e,this.dataKey));this.editingRowKeys[n]=!0}saveRowEdit(e,n){if(0===We.find(n,".ng-invalid.ng-dirty").length){let r=String(Pn.resolveFieldData(e,this.dataKey));delete this.editingRowKeys[r]}}cancelRowEdit(e){let n=String(Pn.resolveFieldData(e,this.dataKey));delete this.editingRowKeys[n]}toggleRow(e,n){if(!this.dataKey)throw new Error("dataKey must be defined to use row expansion");let r=String(Pn.resolveFieldData(e,this.dataKey));null!=this.expandedRowKeys[r]?(delete this.expandedRowKeys[r],this.onRowCollapse.emit({originalEvent:n,data:e})):("single"===this.rowExpandMode&&(this.expandedRowKeys={}),this.expandedRowKeys[r]=!0,this.onRowExpand.emit({originalEvent:n,data:e})),n&&n.preventDefault(),this.isStateful()&&this.saveState()}isRowExpanded(e){return!0===this.expandedRowKeys[String(Pn.resolveFieldData(e,this.dataKey))]}isRowEditing(e){return!0===this.editingRowKeys[String(Pn.resolveFieldData(e,this.dataKey))]}isSingleSelectionMode(){return"single"===this.selectionMode}isMultipleSelectionMode(){return"multiple"===this.selectionMode}onColumnResizeBegin(e){let n=We.getOffset(this.containerViewChild.nativeElement).left;this.resizeColumnElement=e.target.parentElement,this.columnResizing=!0,this.lastResizerHelperX=e.pageX-n+this.containerViewChild.nativeElement.scrollLeft,this.onColumnResize(e),e.preventDefault()}onColumnResize(e){let n=We.getOffset(this.containerViewChild.nativeElement).left;We.addClass(this.containerViewChild.nativeElement,"p-unselectable-text"),this.resizeHelperViewChild.nativeElement.style.height=this.containerViewChild.nativeElement.offsetHeight+"px",this.resizeHelperViewChild.nativeElement.style.top="0px",this.resizeHelperViewChild.nativeElement.style.left=e.pageX-n+this.containerViewChild.nativeElement.scrollLeft+"px",this.resizeHelperViewChild.nativeElement.style.display="block"}onColumnResizeEnd(){let e=this.resizeHelperViewChild.nativeElement.offsetLeft-this.lastResizerHelperX,r=this.resizeColumnElement.offsetWidth+e;if(r>=(this.resizeColumnElement.style.minWidth||15)){if("fit"===this.columnResizeMode){let u=this.resizeColumnElement.nextElementSibling.offsetWidth-e;r>15&&u>15&&this.resizeTableCells(r,u)}else if("expand"===this.columnResizeMode){let c=this.tableViewChild.nativeElement.offsetWidth+e;this.tableViewChild.nativeElement.style.width=c+"px",this.tableViewChild.nativeElement.style.minWidth=c+"px",this.resizeTableCells(r,null)}this.onColResize.emit({element:this.resizeColumnElement,delta:e}),this.isStateful()&&this.saveState()}this.resizeHelperViewChild.nativeElement.style.display="none",We.removeClass(this.containerViewChild.nativeElement,"p-unselectable-text")}resizeTableCells(e,n){let r=We.index(this.resizeColumnElement),o=[];const c=We.findSingle(this.containerViewChild.nativeElement,".p-datatable-thead");We.find(c,"tr > th").forEach(g=>o.push(We.getOuterWidth(g))),this.destroyStyleElement(),this.createStyleElement();let m="";o.forEach((g,x)=>{let S=x===r?e:n&&x===r+1?n:g;m+=`\n                #${this.id} .p-datatable-thead > tr > th:nth-child(${x+1}),\n                #${this.id} .p-datatable-tbody > tr > td:nth-child(${x+1}),\n                #${this.id} .p-datatable-tfoot > tr > td:nth-child(${x+1}) {\n                    ${this.scrollable?`flex: 1 1 ${S}px !important`:`width: ${S}px !important`}\n                }\n            `}),this.styleElement.innerHTML=m}onColumnDragStart(e,n){this.reorderIconWidth=We.getHiddenElementOuterWidth(this.reorderIndicatorUpViewChild.nativeElement),this.reorderIconHeight=We.getHiddenElementOuterHeight(this.reorderIndicatorDownViewChild.nativeElement),this.draggedColumn=n,e.dataTransfer.setData("text","b")}onColumnDragEnter(e,n){if(this.reorderableColumns&&this.draggedColumn&&n){e.preventDefault();let r=We.getOffset(this.containerViewChild.nativeElement),o=We.getOffset(n);if(this.draggedColumn!=n){let c=We.indexWithinGroup(this.draggedColumn,"preorderablecolumn"),u=We.indexWithinGroup(n,"preorderablecolumn"),m=o.left-r.left,x=o.left+n.offsetWidth/2;this.reorderIndicatorUpViewChild.nativeElement.style.top=o.top-r.top-(this.reorderIconHeight-1)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.top=o.top-r.top+n.offsetHeight+"px",e.pageX>x?(this.reorderIndicatorUpViewChild.nativeElement.style.left=m+n.offsetWidth-Math.ceil(this.reorderIconWidth/2)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.left=m+n.offsetWidth-Math.ceil(this.reorderIconWidth/2)+"px",this.dropPosition=1):(this.reorderIndicatorUpViewChild.nativeElement.style.left=m-Math.ceil(this.reorderIconWidth/2)+"px",this.reorderIndicatorDownViewChild.nativeElement.style.left=m-Math.ceil(this.reorderIconWidth/2)+"px",this.dropPosition=-1),u-c==1&&-1===this.dropPosition||u-c==-1&&1===this.dropPosition?(this.reorderIndicatorUpViewChild.nativeElement.style.display="none",this.reorderIndicatorDownViewChild.nativeElement.style.display="none"):(this.reorderIndicatorUpViewChild.nativeElement.style.display="block",this.reorderIndicatorDownViewChild.nativeElement.style.display="block")}else e.dataTransfer.dropEffect="none"}}onColumnDragLeave(e){this.reorderableColumns&&this.draggedColumn&&(e.preventDefault(),this.reorderIndicatorUpViewChild.nativeElement.style.display="none",this.reorderIndicatorDownViewChild.nativeElement.style.display="none")}onColumnDrop(e,n){if(e.preventDefault(),this.draggedColumn){let r=We.indexWithinGroup(this.draggedColumn,"preorderablecolumn"),o=We.indexWithinGroup(n,"preorderablecolumn"),c=r!=o;c&&(o-r==1&&-1===this.dropPosition||r-o==1&&1===this.dropPosition)&&(c=!1),c&&o<r&&1===this.dropPosition&&(o+=1),c&&o>r&&-1===this.dropPosition&&(o-=1),c&&(Pn.reorderArray(this.columns,r,o),this.onColReorder.emit({dragIndex:r,dropIndex:o,columns:this.columns}),this.isStateful()&&this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.saveState()})})),this.reorderIndicatorUpViewChild.nativeElement.style.display="none",this.reorderIndicatorDownViewChild.nativeElement.style.display="none",this.draggedColumn.draggable=!1,this.draggedColumn=null,this.dropPosition=null}}onRowDragStart(e,n){this.rowDragging=!0,this.draggedRowIndex=n,e.dataTransfer.setData("text","b")}onRowDragOver(e,n,r){if(this.rowDragging&&this.draggedRowIndex!==n){let o=We.getOffset(r).top+We.getWindowScrollTop(),c=e.pageY,u=o+We.getOuterHeight(r)/2,m=r.previousElementSibling;c<u?(We.removeClass(r,"p-datatable-dragpoint-bottom"),this.droppedRowIndex=n,m?We.addClass(m,"p-datatable-dragpoint-bottom"):We.addClass(r,"p-datatable-dragpoint-top")):(m?We.removeClass(m,"p-datatable-dragpoint-bottom"):We.addClass(r,"p-datatable-dragpoint-top"),this.droppedRowIndex=n+1,We.addClass(r,"p-datatable-dragpoint-bottom"))}}onRowDragLeave(e,n){let r=n.previousElementSibling;r&&We.removeClass(r,"p-datatable-dragpoint-bottom"),We.removeClass(n,"p-datatable-dragpoint-bottom"),We.removeClass(n,"p-datatable-dragpoint-top")}onRowDragEnd(e){this.rowDragging=!1,this.draggedRowIndex=null,this.droppedRowIndex=null}onRowDrop(e,n){if(null!=this.droppedRowIndex){let r=this.draggedRowIndex>this.droppedRowIndex?this.droppedRowIndex:0===this.droppedRowIndex?0:this.droppedRowIndex-1;Pn.reorderArray(this.value,this.draggedRowIndex,r),this.virtualScroll&&(this._value=[...this._value]),this.onRowReorder.emit({dragIndex:this.draggedRowIndex,dropIndex:r})}this.onRowDragLeave(e,n),this.onRowDragEnd(e)}isEmpty(){let e=this.filteredValue||this.value;return null==e||0==e.length}getBlockableElement(){return this.el.nativeElement.children[0]}getStorage(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}}isStateful(){return null!=this.stateKey}saveState(){const e=this.getStorage();let n={};this.paginator&&(n.first=this.first,n.rows=this.rows),this.sortField&&(n.sortField=this.sortField,n.sortOrder=this.sortOrder),this.multiSortMeta&&(n.multiSortMeta=this.multiSortMeta),this.hasFilter()&&(n.filters=this.filters),this.resizableColumns&&this.saveColumnWidths(n),this.reorderableColumns&&this.saveColumnOrder(n),this.selection&&(n.selection=this.selection),Object.keys(this.expandedRowKeys).length&&(n.expandedRowKeys=this.expandedRowKeys),e.setItem(this.stateKey,JSON.stringify(n)),this.onStateSave.emit(n)}clearState(){const e=this.getStorage();this.stateKey&&e.removeItem(this.stateKey)}restoreState(){const n=this.getStorage().getItem(this.stateKey),r=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/;if(n){let c=JSON.parse(n,function(c,u){return"string"==typeof u&&r.test(u)?new Date(u):u});this.paginator&&(void 0!==this.first&&(this.first=c.first,this.firstChange.emit(this.first)),void 0!==this.rows&&(this.rows=c.rows,this.rowsChange.emit(this.rows))),c.sortField&&(this.restoringSort=!0,this._sortField=c.sortField,this._sortOrder=c.sortOrder),c.multiSortMeta&&(this.restoringSort=!0,this._multiSortMeta=c.multiSortMeta),c.filters&&(this.restoringFilter=!0,this.filters=c.filters),this.resizableColumns&&(this.columnWidthsState=c.columnWidths,this.tableWidthState=c.tableWidth),c.expandedRowKeys&&(this.expandedRowKeys=c.expandedRowKeys),c.selection&&Promise.resolve(null).then(()=>this.selectionChange.emit(c.selection)),this.stateRestored=!0,this.onStateRestore.emit(c)}}saveColumnWidths(e){let n=[];We.find(this.containerViewChild.nativeElement,".p-datatable-thead > tr > th").forEach(o=>n.push(We.getOuterWidth(o))),e.columnWidths=n.join(","),"expand"===this.columnResizeMode&&(e.tableWidth=We.getOuterWidth(this.tableViewChild.nativeElement)+"px")}restoreColumnWidths(){if(this.columnWidthsState){let e=this.columnWidthsState.split(",");if("expand"===this.columnResizeMode&&this.tableWidthState&&(this.tableViewChild.nativeElement.style.width=this.tableWidthState,this.tableViewChild.nativeElement.style.minWidth=this.tableWidthState,this.containerViewChild.nativeElement.style.width=this.tableWidthState),Pn.isNotEmpty(e)){this.createStyleElement();let n="";e.forEach((r,o)=>{n+=`\n                        #${this.id} .p-datatable-thead > tr > th:nth-child(${o+1}),\n                        #${this.id} .p-datatable-tbody > tr > td:nth-child(${o+1}),\n                        #${this.id} .p-datatable-tfoot > tr > td:nth-child(${o+1}) {\n                            ${this.scrollable?`flex: 1 1 ${r}px !important`:`width: ${r}px !important`}\n                        }\n                    `}),this.styleElement.innerHTML=n}}}saveColumnOrder(e){if(this.columns){let n=[];this.columns.map(r=>{n.push(r.field||r.key)}),e.columnOrder=n}}restoreColumnOrder(){const n=this.getStorage().getItem(this.stateKey);if(n){let o=JSON.parse(n).columnOrder;if(o){let c=[];o.map(u=>{let m=this.findColumnByKey(u);m&&c.push(m)}),this.columnOrderStateRestored=!0,this.columns=c}}}findColumnByKey(e){if(!this.columns)return null;for(let n of this.columns)if(n.key===e||n.field===e)return n}createStyleElement(){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement)}getGroupRowsMeta(){return{field:this.groupRowsBy,order:this.groupRowsByOrder}}createResponsiveStyle(){this.responsiveStyleElement||(this.responsiveStyleElement=document.createElement("style"),this.responsiveStyleElement.type="text/css",document.head.appendChild(this.responsiveStyleElement),this.responsiveStyleElement.innerHTML=`\n@media screen and (max-width: ${this.breakpoint}) {\n    #${this.id} .p-datatable-thead > tr > th,\n    #${this.id} .p-datatable-tfoot > tr > td {\n        display: none !important;\n    }\n\n    #${this.id} .p-datatable-tbody > tr > td {\n        display: flex;\n        width: 100% !important;\n        align-items: center;\n        justify-content: space-between;\n    }\n\n    #${this.id} .p-datatable-tbody > tr > td:not(:last-child) {\n        border: 0 none;\n    }\n\n    #${this.id}.p-datatable-gridlines .p-datatable-tbody > tr > td:last-child {\n        border-top: 0;\n        border-right: 0;\n        border-left: 0;\n    }\n\n    #${this.id} .p-datatable-tbody > tr > td > .p-column-title {\n        display: block;\n    }\n}\n`)}destroyResponsiveStyle(){this.responsiveStyleElement&&(document.head.removeChild(this.responsiveStyleElement),this.responsiveStyleElement=null)}destroyStyleElement(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.unbindDocumentEditListener(),this.editingCell=null,this.initialized=null,this.virtualScrollInitialized=null,this.virtualScrollSubscription&&this.virtualScrollSubscription.unsubscribe(),this.destroyStyleElement(),this.destroyResponsiveStyle()}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(gr),te(kA),te(Wo),te(bL),te(pA))},t.\u0275cmp=dn({type:t,selectors:[["p-table"]],contentQueries:function(e,n,r){if(1&e&&ol(r,zn,4),2&e){let o;xt(o=wt())&&(n.templates=o)}},viewQuery:function(e,n){if(1&e&&(Mt(DY,5),Mt(IY,5),Mt(AY,5),Mt(MY,5),Mt(FY,5),Mt(PY,5),Mt(OY,5),Mt(Wy,5)),2&e){let r;xt(r=wt())&&(n.containerViewChild=r.first),xt(r=wt())&&(n.resizeHelperViewChild=r.first),xt(r=wt())&&(n.reorderIndicatorUpViewChild=r.first),xt(r=wt())&&(n.reorderIndicatorDownViewChild=r.first),xt(r=wt())&&(n.wrapperViewChild=r.first),xt(r=wt())&&(n.tableViewChild=r.first),xt(r=wt())&&(n.tableHeaderViewChild=r.first),xt(r=wt())&&(n.virtualScrollBody=r.first)}},hostAttrs:[1,"p-element"],inputs:{frozenColumns:"frozenColumns",frozenValue:"frozenValue",style:"style",styleClass:"styleClass",tableStyle:"tableStyle",tableStyleClass:"tableStyleClass",paginator:"paginator",pageLinks:"pageLinks",rowsPerPageOptions:"rowsPerPageOptions",alwaysShowPaginator:"alwaysShowPaginator",paginatorPosition:"paginatorPosition",paginatorDropdownAppendTo:"paginatorDropdownAppendTo",paginatorDropdownScrollHeight:"paginatorDropdownScrollHeight",currentPageReportTemplate:"currentPageReportTemplate",showCurrentPageReport:"showCurrentPageReport",showJumpToPageDropdown:"showJumpToPageDropdown",showJumpToPageInput:"showJumpToPageInput",showFirstLastIcon:"showFirstLastIcon",showPageLinks:"showPageLinks",defaultSortOrder:"defaultSortOrder",sortMode:"sortMode",resetPageOnSort:"resetPageOnSort",selectionMode:"selectionMode",selectionPageOnly:"selectionPageOnly",contextMenuSelection:"contextMenuSelection",contextMenuSelectionMode:"contextMenuSelectionMode",dataKey:"dataKey",metaKeySelection:"metaKeySelection",rowSelectable:"rowSelectable",rowTrackBy:"rowTrackBy",lazy:"lazy",lazyLoadOnInit:"lazyLoadOnInit",compareSelectionBy:"compareSelectionBy",csvSeparator:"csvSeparator",exportFilename:"exportFilename",filters:"filters",globalFilterFields:"globalFilterFields",filterDelay:"filterDelay",filterLocale:"filterLocale",expandedRowKeys:"expandedRowKeys",editingRowKeys:"editingRowKeys",rowExpandMode:"rowExpandMode",scrollable:"scrollable",scrollDirection:"scrollDirection",rowGroupMode:"rowGroupMode",scrollHeight:"scrollHeight",virtualScroll:"virtualScroll",virtualScrollDelay:"virtualScrollDelay",virtualRowHeight:"virtualRowHeight",frozenWidth:"frozenWidth",responsive:"responsive",contextMenu:"contextMenu",resizableColumns:"resizableColumns",columnResizeMode:"columnResizeMode",reorderableColumns:"reorderableColumns",loading:"loading",loadingIcon:"loadingIcon",showLoader:"showLoader",rowHover:"rowHover",customSort:"customSort",showInitialSortBadge:"showInitialSortBadge",autoLayout:"autoLayout",exportFunction:"exportFunction",exportHeader:"exportHeader",stateKey:"stateKey",stateStorage:"stateStorage",editMode:"editMode",groupRowsBy:"groupRowsBy",groupRowsByOrder:"groupRowsByOrder",minBufferPx:"minBufferPx",maxBufferPx:"maxBufferPx",responsiveLayout:"responsiveLayout",breakpoint:"breakpoint",value:"value",columns:"columns",first:"first",rows:"rows",totalRecords:"totalRecords",sortField:"sortField",sortOrder:"sortOrder",multiSortMeta:"multiSortMeta",selection:"selection",selectAll:"selectAll"},outputs:{selectAllChange:"selectAllChange",selectionChange:"selectionChange",contextMenuSelectionChange:"contextMenuSelectionChange",onRowSelect:"onRowSelect",onRowUnselect:"onRowUnselect",onPage:"onPage",onSort:"onSort",onFilter:"onFilter",onLazyLoad:"onLazyLoad",onRowExpand:"onRowExpand",onRowCollapse:"onRowCollapse",onContextMenuSelect:"onContextMenuSelect",onColResize:"onColResize",onColReorder:"onColReorder",onRowReorder:"onRowReorder",onEditInit:"onEditInit",onEditComplete:"onEditComplete",onEditCancel:"onEditCancel",onHeaderCheckboxToggle:"onHeaderCheckboxToggle",sortFunction:"sortFunction",firstChange:"firstChange",rowsChange:"rowsChange",onStateSave:"onStateSave",onStateRestore:"onStateRestore"},features:[Nn([kA]),Vs],decls:14,vars:33,consts:[[3,"ngStyle","ngClass"],["container",""],["class","p-datatable-loading-overlay p-component-overlay",4,"ngIf"],["class","p-datatable-header",4,"ngIf"],["styleClass","p-paginator-top",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange",4,"ngIf"],[1,"p-datatable-wrapper",3,"ngStyle"],["wrapper",""],["role","table","class","p-datatable-table",3,"ngClass","ngStyle",4,"ngIf"],["tabindex","0","class","p-datatable-virtual-scrollable-body",3,"itemSize","height","minBufferPx","maxBufferPx","scrolledIndexChange",4,"ngIf"],["styleClass","p-paginator-bottom",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange",4,"ngIf"],["class","p-datatable-footer",4,"ngIf"],["class","p-column-resizer-helper","style","display:none",4,"ngIf"],["class","pi pi-arrow-down p-datatable-reorder-indicator-up","style","display:none",4,"ngIf"],["class","pi pi-arrow-up p-datatable-reorder-indicator-down","style","display:none",4,"ngIf"],[1,"p-datatable-loading-overlay","p-component-overlay"],[1,"p-datatable-header"],[4,"ngTemplateOutlet"],["styleClass","p-paginator-top",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange"],["role","table",1,"p-datatable-table",3,"ngClass","ngStyle"],["table",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-datatable-thead"],["class","p-datatable-tbody p-datatable-frozen-tbody",3,"value","frozenRows","pTableBody","pTableBodyTemplate","frozen",4,"ngIf"],[1,"p-datatable-tbody",3,"value","pTableBody","pTableBodyTemplate"],["class","p-datatable-tfoot",4,"ngIf"],[1,"p-datatable-tbody","p-datatable-frozen-tbody",3,"value","frozenRows","pTableBody","pTableBodyTemplate","frozen"],[1,"p-datatable-tfoot"],["tabindex","0",1,"p-datatable-virtual-scrollable-body",3,"itemSize","minBufferPx","maxBufferPx","scrolledIndexChange"],["tableHeader",""],["styleClass","p-paginator-bottom",3,"rows","first","totalRecords","pageLinkSize","alwaysShow","rowsPerPageOptions","templateLeft","templateRight","dropdownAppendTo","dropdownScrollHeight","currentPageReportTemplate","showFirstLastIcon","dropdownItemTemplate","showCurrentPageReport","showJumpToPageDropdown","showJumpToPageInput","showPageLinks","onPageChange"],[1,"p-datatable-footer"],[1,"p-column-resizer-helper",2,"display","none"],["resizeHelper",""],[1,"pi","pi-arrow-down","p-datatable-reorder-indicator-up",2,"display","none"],["reorderIndicatorUp",""],[1,"pi","pi-arrow-up","p-datatable-reorder-indicator-down",2,"display","none"],["reorderIndicatorDown",""]],template:function(e,n){1&e&&(f(0,"div",0,1),D(2,NY,2,2,"div",2),D(3,RY,2,1,"div",3),D(4,BY,1,17,"p-paginator",4),f(5,"div",5,6),D(7,$Y,8,16,"table",7),D(8,XY,10,21,"cdk-virtual-scroll-viewport",8),p(),D(9,QY,1,17,"p-paginator",9),D(10,ZY,2,1,"div",10),D(11,eX,2,0,"div",11),D(12,tX,2,0,"span",12),D(13,nX,2,0,"span",13),p()),2&e&&(Ji(n.styleClass),T("ngStyle",n.style)("ngClass",wD(16,iX,[n.rowHover||n.selectionMode,n.autoLayout,n.resizableColumns,n.resizableColumns&&"fit"===n.columnResizeMode,n.scrollable,n.scrollable&&"vertical"===n.scrollDirection,n.scrollable&&"horizontal"===n.scrollDirection,n.scrollable&&"both"===n.scrollDirection,n.scrollable&&"flex"===n.scrollHeight,"stack"===n.responsiveLayout,"scroll"===n.responsiveLayout,n.responsive,null!=n.headerGroupedTemplate,null!=n.footerGroupedTemplate])),Ai("id",n.id),v(2),T("ngIf",n.loading&&n.showLoader),v(1),T("ngIf",n.captionTemplate),v(1),T("ngIf",n.paginator&&("top"===n.paginatorPosition||"both"==n.paginatorPosition)),v(1),T("ngStyle",Ei(31,rX,n.scrollHeight)),v(2),T("ngIf",!n.virtualScroll),v(1),T("ngIf",n.virtualScroll),v(1),T("ngIf",n.paginator&&("bottom"===n.paginatorPosition||"both"==n.paginatorPosition)),v(1),T("ngIf",n.summaryTemplate),v(1),T("ngIf",n.resizableColumns),v(1),T("ngIf",n.reorderableColumns),v(1),T("ngIf",n.reorderableColumns))},directives:function(){return[_K,cQ,Wy,La,Na,Sn,ic,VL]},styles:[".p-datatable{position:relative}.p-datatable table{border-collapse:collapse;min-width:100%;table-layout:fixed}.p-datatable .p-sortable-column{cursor:pointer;-webkit-user-select:none;user-select:none}.p-datatable .p-sortable-column .p-column-title,.p-datatable .p-sortable-column .p-sortable-column-icon,.p-datatable .p-sortable-column .p-sortable-column-badge{vertical-align:middle}.p-datatable .p-sortable-column .p-sortable-column-badge{display:inline-flex;align-items:center;justify-content:center}.p-datatable-auto-layout>.p-datatable-wrapper{overflow-x:auto}.p-datatable-auto-layout>.p-datatable-wrapper>table{table-layout:auto}.p-datatable-responsive-scroll>.p-datatable-wrapper{overflow-x:auto}.p-datatable-responsive-scroll>.p-datatable-wrapper>table,.p-datatable-auto-layout>.p-datatable-wrapper>table{table-layout:auto}.p-datatable-hoverable-rows .p-selectable-row{cursor:pointer}.p-datatable-scrollable .p-datatable-wrapper{position:relative;overflow:auto}.p-datatable-scrollable .p-datatable-thead,.p-datatable-scrollable .p-datatable-tbody,.p-datatable-scrollable .p-datatable-tfoot{display:block}.p-datatable-scrollable .p-datatable-thead>tr,.p-datatable-scrollable .p-datatable-tbody>tr,.p-datatable-scrollable .p-datatable-tfoot>tr{display:flex;flex-wrap:nowrap;width:100%}.p-datatable-scrollable .p-datatable-thead>tr>th,.p-datatable-scrollable .p-datatable-tbody>tr>td,.p-datatable-scrollable .p-datatable-tfoot>tr>td{display:flex;flex:1 1 0;align-items:center}.p-datatable-scrollable>.p-datatable-wrapper>.p-datatable-table>.p-datatable-thead,.p-datatable-scrollable>.p-datatable-wrapper>.p-datatable-virtual-scrollable-body>.cdk-virtual-scroll-content-wrapper>.p-datatable-table>.p-datatable-thead{position:sticky;top:0;z-index:1}.p-datatable-scrollable>.p-datatable-wrapper>.p-datatable-table>.p-datatable-frozen-tbody{position:sticky;z-index:1}.p-datatable-scrollable>.p-datatable-wrapper>.p-datatable-table>.p-datatable-tfoot{position:sticky;bottom:0;z-index:1}.p-datatable-scrollable .p-frozen-column{position:sticky;background:inherit}.p-datatable-scrollable th.p-frozen-column{z-index:1}.p-datatable-scrollable-both .p-datatable-thead>tr>th,.p-datatable-scrollable-both .p-datatable-tbody>tr>td,.p-datatable-scrollable-both .p-datatable-tfoot>tr>td,.p-datatable-scrollable-horizontal .p-datatable-thead>tr>th .p-datatable-scrollable-horizontal .p-datatable-tbody>tr>td,.p-datatable-scrollable-horizontal .p-datatable-tfoot>tr>td{flex:0 0 auto}.p-datatable-flex-scrollable{display:flex;flex-direction:column;height:100%}.p-datatable-flex-scrollable .p-datatable-wrapper{display:flex;flex-direction:column;flex:1;height:100%}.p-datatable-scrollable .p-rowgroup-header{position:sticky;z-index:1}.p-datatable-scrollable.p-datatable-grouped-header .p-datatable-thead,.p-datatable-scrollable.p-datatable-grouped-footer .p-datatable-tfoot{display:table;border-collapse:collapse;width:100%;table-layout:fixed}.p-datatable-scrollable.p-datatable-grouped-header .p-datatable-thead>tr,.p-datatable-scrollable.p-datatable-grouped-footer .p-datatable-tfoot>tr{display:table-row}.p-datatable-scrollable.p-datatable-grouped-header .p-datatable-thead>tr>th,.p-datatable-scrollable.p-datatable-grouped-footer .p-datatable-tfoot>tr>td{display:table-cell}.p-datatable-flex-scrollable{display:flex;flex-direction:column;flex:1;height:100%}.p-datatable-flex-scrollable .p-datatable-virtual-scrollable-body{flex:1}.p-datatable-resizable>.p-datatable-wrapper{overflow-x:auto}.p-datatable-resizable .p-datatable-thead>tr>th,.p-datatable-resizable .p-datatable-tfoot>tr>td,.p-datatable-resizable .p-datatable-tbody>tr>td{overflow:hidden;white-space:nowrap}.p-datatable-resizable .p-resizable-column:not(.p-frozen-column){background-clip:padding-box;position:relative}.p-datatable-resizable-fit .p-resizable-column:last-child .p-column-resizer{display:none}.p-datatable .p-column-resizer{display:block;position:absolute!important;top:0;right:0;margin:0;width:.5rem;height:100%;padding:0;cursor:col-resize;border:1px solid transparent}.p-datatable .p-column-resizer-helper{width:1px;position:absolute;z-index:10;display:none}.p-datatable .p-row-editor-init,.p-datatable .p-row-editor-save,.p-datatable .p-row-editor-cancel,.p-datatable .p-row-toggler{display:inline-flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-datatable-reorder-indicator-up,.p-datatable-reorder-indicator-down{position:absolute;display:none}.p-datatable-reorderablerow-handle,[pReorderableColumn]{cursor:move}.p-datatable .p-datatable-loading-overlay{position:absolute;display:flex;align-items:center;justify-content:center;z-index:2}.p-column-filter-row{display:flex;align-items:center;width:100%}.p-column-filter-menu{display:inline-flex}.p-column-filter-row p-columnfilterformelement{flex:1 1 auto;width:1%}.p-column-filter-menu-button,.p-column-filter-clear-button{display:inline-flex;justify-content:center;align-items:center;cursor:pointer;text-decoration:none;overflow:hidden;position:relative}.p-column-filter-overlay{position:absolute;top:0;left:0}.p-column-filter-row-items{margin:0;padding:0;list-style:none}.p-column-filter-row-item{cursor:pointer}.p-column-filter-add-button,.p-column-filter-remove-button{justify-content:center}.p-column-filter-add-button .p-button-label,.p-column-filter-remove-button .p-button-label{flex-grow:0}.p-column-filter-buttonbar{display:flex;align-items:center;justify-content:space-between}.p-column-filter-buttonbar .p-button{width:auto}.p-datatable .p-datatable-tbody>tr>td>.p-column-title{display:none}cdk-virtual-scroll-viewport{outline:0 none}\n"],encapsulation:2}),t})(),cQ=(()=>{class t{constructor(e,n,r,o){this.dt=e,this.tableService=n,this.cd=r,this.el=o,this.subscription=this.dt.tableService.valueSource$.subscribe(()=>{this.dt.virtualScroll&&this.cd.detectChanges()})}get value(){return this._value}set value(e){this._value=e,this.frozenRows&&this.updateFrozenRowStickyPosition(),this.dt.scrollable&&"subheader"===this.dt.rowGroupMode&&this.updateFrozenRowGroupHeaderStickyPosition()}ngAfterViewInit(){this.frozenRows&&this.updateFrozenRowStickyPosition(),this.dt.scrollable&&"subheader"===this.dt.rowGroupMode&&this.updateFrozenRowGroupHeaderStickyPosition()}shouldRenderRowGroupHeader(e,n,r){let o=Pn.resolveFieldData(n,this.dt.groupRowsBy),c=e[r-1];return!c||o!==Pn.resolveFieldData(c,this.dt.groupRowsBy)}shouldRenderRowGroupFooter(e,n,r){let o=Pn.resolveFieldData(n,this.dt.groupRowsBy),c=e[r+1];return!c||o!==Pn.resolveFieldData(c,this.dt.groupRowsBy)}shouldRenderRowspan(e,n,r){let o=Pn.resolveFieldData(n,this.dt.groupRowsBy),c=e[r-1];return!c||o!==Pn.resolveFieldData(c,this.dt.groupRowsBy)}calculateRowGroupSize(e,n,r){let o=Pn.resolveFieldData(n,this.dt.groupRowsBy),c=o,u=0;for(;o===c;){u++;let m=e[++r];if(!m)break;c=Pn.resolveFieldData(m,this.dt.groupRowsBy)}return 1===u?null:u}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}updateFrozenRowStickyPosition(){this.el.nativeElement.style.top=We.getOuterHeight(this.el.nativeElement.previousElementSibling)+"px"}updateFrozenRowGroupHeaderStickyPosition(){if(this.el.nativeElement.previousElementSibling){let e=We.getOuterHeight(this.el.nativeElement.previousElementSibling);this.dt.rowGroupHeaderStyleObject.top=e+"px"}}}return t.\u0275fac=function(e){return new(e||t)(te(ki),te(kA),te(Wo),te(mr))},t.\u0275cmp=dn({type:t,selectors:[["","pTableBody",""]],hostAttrs:[1,"p-element"],inputs:{columns:["pTableBody","columns"],template:["pTableBodyTemplate","template"],value:"value",frozen:"frozen",frozenRows:"frozenRows"},attrs:oX,decls:6,vars:6,consts:[[4,"ngIf"],["ngFor","",3,"ngForOf","ngForTrackBy"],["role","row",4,"ngIf"],["role","row"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["cdkVirtualFor","",3,"cdkVirtualForOf","cdkVirtualForTrackBy","cdkVirtualForTemplateCacheSize"]],template:function(e,n){1&e&&(D(0,gX,2,2,"ng-container",0),D(1,yX,2,3,"ng-container",0),D(2,IX,2,2,"ng-container",0),D(3,OX,2,2,"ng-container",0),D(4,LX,2,5,"ng-container",0),D(5,BX,2,5,"ng-container",0)),2&e&&(T("ngIf",!n.dt.expandedRowTemplate&&!n.dt.virtualScroll),v(1),T("ngIf",!n.dt.expandedRowTemplate&&n.dt.virtualScroll),v(1),T("ngIf",n.dt.expandedRowTemplate&&!(n.frozen&&n.dt.frozenExpandedRowTemplate)),v(1),T("ngIf",n.dt.frozenExpandedRowTemplate&&n.frozen),v(1),T("ngIf",n.dt.loading),v(1),T("ngIf",n.dt.isEmpty()&&!n.dt.loading))},directives:[Sn,nc,ic,$L],encapsulation:2}),t})(),DA=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro,ZL,qy,Im,bT,O0,Up,kK,wT,j0,OK],Uc,bT]}),t})();const uQ=["cb"],dQ=function(t,i,e){return{"p-checkbox-label":!0,"p-checkbox-label-active":t,"p-disabled":i,"p-checkbox-label-focus":e}};function fQ(t,i){if(1&t){const e=Ie();f(0,"label",7),L("click",function(r){z(e);const o=A(),c=Fa(3);return o.onClick(r,c,!0)}),_(1),p()}if(2&t){const e=A();Ji(e.labelStyleClass),T("ngClass",kp(5,dQ,e.checked(),e.disabled,e.focused)),Ai("for",e.inputId),v(1),U(e.label)}}const pQ=function(t,i,e){return{"p-checkbox p-component":!0,"p-checkbox-checked":t,"p-checkbox-disabled":i,"p-checkbox-focused":e}},hQ=function(t,i,e){return{"p-highlight":t,"p-disabled":i,"p-focus":e}},mQ={provide:Ra,useExisting:tr(()=>ST),multi:!0};let ST=(()=>{class t{constructor(e){this.cd=e,this.checkboxIcon="pi pi-check",this.trueValue=!0,this.falseValue=!1,this.onChange=new Et,this.onModelChange=()=>{},this.onModelTouched=()=>{},this.focused=!1}onClick(e,n,r){e.preventDefault(),!this.disabled&&!this.readonly&&(this.updateModel(e),r&&n.focus())}updateModel(e){let n;this.binary?(n=this.checked()?this.falseValue:this.trueValue,this.model=n,this.onModelChange(n)):(n=this.checked()?this.model.filter(r=>!Pn.equals(r,this.value)):this.model?[...this.model,this.value]:[this.value],this.onModelChange(n),this.model=n,this.formControl&&this.formControl.setValue(n)),this.onChange.emit({checked:n,originalEvent:e})}handleChange(e){this.readonly||this.updateModel(e)}onFocus(){this.focused=!0}onBlur(){this.focused=!1,this.onModelTouched()}focus(){this.inputViewChild.nativeElement.focus()}writeValue(e){this.model=e,this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}checked(){return this.binary?this.model===this.trueValue:Pn.contains(this.value,this.model)}}return t.\u0275fac=function(e){return new(e||t)(te(Wo))},t.\u0275cmp=dn({type:t,selectors:[["p-checkbox"]],viewQuery:function(e,n){if(1&e&&Mt(uQ,5),2&e){let r;xt(r=wt())&&(n.inputViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{value:"value",name:"name",disabled:"disabled",binary:"binary",label:"label",ariaLabelledBy:"ariaLabelledBy",ariaLabel:"ariaLabel",tabindex:"tabindex",inputId:"inputId",style:"style",styleClass:"styleClass",labelStyleClass:"labelStyleClass",formControl:"formControl",checkboxIcon:"checkboxIcon",readonly:"readonly",required:"required",trueValue:"trueValue",falseValue:"falseValue"},outputs:{onChange:"onChange"},features:[Nn([mQ])],decls:7,vars:26,consts:[[3,"ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","checkbox",3,"readonly","value","checked","disabled","focus","blur","change"],["cb",""],[1,"p-checkbox-box",3,"ngClass","click"],[1,"p-checkbox-icon",3,"ngClass"],[3,"class","ngClass","click",4,"ngIf"],[3,"ngClass","click"]],template:function(e,n){if(1&e){const r=Ie();f(0,"div",0)(1,"div",1)(2,"input",2,3),L("focus",function(){return n.onFocus()})("blur",function(){return n.onBlur()})("change",function(c){return n.handleChange(c)}),p()(),f(4,"div",4),L("click",function(c){z(r);const u=Fa(3);return n.onClick(c,u,!0)}),ee(5,"span",5),p()(),D(6,fQ,2,9,"label",6)}2&e&&(Ji(n.styleClass),T("ngStyle",n.style)("ngClass",kp(18,pQ,n.checked(),n.disabled,n.focused)),v(2),T("readonly",n.readonly)("value",n.value)("checked",n.checked())("disabled",n.disabled),Ai("id",n.inputId)("name",n.name)("tabindex",n.tabindex)("aria-labelledby",n.ariaLabelledBy)("aria-label",n.ariaLabel)("aria-checked",n.checked())("required",n.required),v(2),T("ngClass",kp(22,hQ,n.checked(),n.disabled,n.focused)),v(1),T("ngClass",n.checked()?n.checkboxIcon:null),v(1),T("ngIf",n.label))},directives:[La,Na,Sn],styles:[".p-checkbox{display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;vertical-align:bottom;position:relative}.p-checkbox-disabled{cursor:default!important;pointer-events:none}.p-checkbox-box{display:flex;justify-content:center;align-items:center}p-checkbox{display:inline-flex;vertical-align:bottom;align-items:center}.p-checkbox-label{line-height:1}\n"],encapsulation:2,changeDetection:0}),t})(),gQ=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro]]}),t})();const _Q=["dtbranches"];function vQ(t,i){if(1&t){const e=Ie();f(0,"div",13)(1,"span",14),ee(2,"i",15),f(3,"input",16),L("input",function(r){return z(e),A().applyFilterGlobalBranches(r,"contains")}),p()()()}}function yQ(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function bQ(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,yQ,2,0,"th",17),f(4,"th"),_(5,"Branches"),p(),f(6,"th"),_(7,"Assignment"),p()()),2&t&&(v(3),T("ngIf",!1))}function xQ(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function wQ(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,xQ,2,1,"td",17),f(4,"td"),_(5),p(),f(6,"td")(7,"p-checkbox",18,19),L("ngModelChange",function(r){return z(e).$implicit.selected=r})("onChange",function(r){const c=z(e).$implicit;return A().checkboxChanged(r,c)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.branch),v(2),T("ngModel",e.selected)("binary",!0)}}const CQ=function(){return{width:"200px"}},TQ=function(){return["branch"]};let SQ=(()=>{class t{constructor(e,n){this._invtr=e,this._ms=n,this.selectedUser=1}ngOnInit(){this.getBranches(),this.loadUsers()}getBranches(){this._invtr.getBranches().subscribe({next:e=>{this.branches=e},error:e=>{console.error(e)}})}loadUsers(){this._invtr.getUsers().subscribe({next:e=>{this.users=e,this.selectedUser=this.users[0].id,this.loadUserBranches()},error:e=>{console.error(e)}})}onUserDropdownChange(e){this.selectedUser=e.value,this.branches.forEach(n=>{n.selected=!1}),this.loadUserBranches()}loadUserBranches(){this._invtr.getUsersBranches(this.selectedUser).subscribe({next:e=>{this.userbranches=e,this.branches.forEach(n=>{this.userbranches.forEach(r=>{r.branchid==n.id&&(n.selected=!0)})})},error:e=>{console.error(e)}})}selectAll(e){if(null!=this.selectedUser&&0!=this.selectedUser)if(e){let n=[];if(this.branches.forEach(r=>{r.selected||n.push(r.id)}),0==n.length)return void this._ms.add({severity:"error",summary:"Error",detail:"All branches are already assigned to user.",life:3e3});this._invtr.assignBranchtoUsers(this.selectedUser,n,0).subscribe({next:r=>{this._ms.add({severity:"success",summary:"Successful",detail:"Branches are assigned to user successfully.",life:3e3}),this.branches.forEach(o=>o.selected=e)},error:r=>{this._ms.add({severity:"error",summary:"Error",detail:"Error in branches assignment to user.",life:3e3})}})}else{let n=[];if(this.branches.forEach(r=>{r.selected&&n.push(r.id)}),0==n.length)return void this._ms.add({severity:"error",summary:"Error",detail:"All branches are already removed from user access.",life:3e3});this._invtr.assignBranchtoUsers(this.selectedUser,n,1).subscribe({next:r=>{this._ms.add({severity:"success",summary:"Successful",detail:"Branches are removed from user access.",life:3e3}),this.branches.forEach(o=>o.selected=e)},error:r=>{this._ms.add({severity:"error",summary:"Error",detail:"Error in removing branches from user access.",life:3e3})}})}else this._ms.add({severity:"error",summary:"Error",detail:"User is not selected.",life:3e3})}checkboxChanged(e,n){if(null==this.selectedUser||0==this.selectedUser)return this._ms.add({severity:"error",summary:"Error",detail:"User is not selected.",life:3e3}),void(n.selected=!1);let r=[];if(r.push(n.id),e.checked)this._invtr.assignBranchtoUsers(this.selectedUser,r,0).subscribe({next:o=>{this._ms.add({severity:"success",summary:"Successful",detail:"Branch is assigned to user successfully.",life:3e3})},error:o=>{this._ms.add({severity:"error",summary:"Error",detail:"Error in branch assignment to user.",life:3e3})}});else{let o=[];o.push(n.id),this._invtr.assignBranchtoUsers(this.selectedUser,o,1).subscribe({next:c=>{this._ms.add({severity:"success",summary:"Successful",detail:"Branch is removed from user access.",life:3e3})},error:c=>{this._ms.add({severity:"error",summary:"Error",detail:"Error in removing branch from user access.",life:3e3})}})}}applyFilterGlobalBranches(e,n){this.dtbranches.filterGlobal(e.target.value,n)}}return t.\u0275fac=function(e){return new(e||t)(te(Su),te(kn))},t.\u0275cmp=dn({type:t,selectors:[["app-assignbranches"]],viewQuery:function(e,n){if(1&e&&Mt(_Q,5),2&e){let r;xt(r=wt())&&(n.dtbranches=r.first)}},decls:20,vars:10,consts:[[1,"text-muted"],[2,"display","flex","align-items","center"],["for","status",2,"margin-right","5px"],["optionLabel","name","optionValue","id","filterBy","name","placeholder","Select User","appendTo","body",3,"options","ngModel","onChange","ngModelChange"],[1,"project-btn-group","project-btn-group--right","project-btn-group--spaced"],[1,"btn-project",3,"click"],["tableContainer",""],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dtbranches",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["position","bottom-right"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[4,"ngIf"],["inputId","binary",3,"ngModel","binary","ngModelChange","onChange"],["myCheckbox",""]],template:function(e,n){1&e&&(f(0,"h2",0),_(1,"Assign Branches to Users"),p(),ee(2,"hr"),f(3,"div",1)(4,"label",2),_(5,"Select User"),p(),f(6,"p-dropdown",3),L("onChange",function(o){return n.onUserDropdownChange(o)})("ngModelChange",function(o){return n.selectedUser=o}),p()(),f(7,"div",4)(8,"button",5),L("click",function(){return n.selectAll(!0)}),_(9,"Select All"),p(),f(10,"button",5),L("click",function(){return n.selectAll(!1)}),_(11,"Deselect All"),p()(),f(12,"div",null,6)(14,"p-table",7,8),D(16,vQ,4,0,"ng-template",9),D(17,bQ,8,1,"ng-template",10),D(18,wQ,9,5,"ng-template",11),p()(),ee(19,"p-toast",12)),2&e&&(v(6),Ft(rt(8,CQ)),T("options",n.users)("ngModel",n.selectedUser),v(8),T("value",n.branches)("paginator",!0)("rows",10)("globalFilterFields",rt(9,TQ)))},directives:[us,Er,md,ki,zn,li,Sn,ST,fr],styles:[""]}),t})();const EQ=["dt"];function kQ(t,i){if(1&t){const e=Ie();f(0,"div",16)(1,"span",17),ee(2,"i",18),f(3,"input",19),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function DQ(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function IQ(t,i){1&t&&(f(0,"th"),_(1,"LocID"),p())}function AQ(t,i){1&t&&(f(0,"th"),_(1,"Location"),p())}function MQ(t,i){1&t&&(f(0,"th"),_(1,"Land Cost"),p())}function FQ(t,i){1&t&&(f(0,"th"),_(1,"Comm"),p())}function PQ(t,i){1&t&&(f(0,"th"),_(1,"Taxes"),p())}function OQ(t,i){1&t&&(f(0,"th"),_(1,"Area(SqrFt) "),p())}function NQ(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,DQ,2,0,"th",20),f(4,"th"),_(5,"Name"),p(),D(6,IQ,2,0,"th",20),D(7,AQ,2,0,"th",20),f(8,"th"),_(9,"Start Date"),p(),f(10,"th"),_(11,"Status"),p(),f(12,"th"),_(13,"Project Cost"),p(),f(14,"th"),_(15,"Remarks"),p(),f(16,"th"),_(17,"Description"),p(),D(18,MQ,2,0,"th",20),D(19,FQ,2,0,"th",20),D(20,PQ,2,0,"th",20),D(21,OQ,2,0,"th",20),f(22,"th"),_(23,"Assignment"),p()()),2&t&&(v(3),T("ngIf",!1),v(3),T("ngIf",!1),v(1),T("ngIf",!1),v(11),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1))}function LQ(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function RQ(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.loc_id)}}function BQ(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.location)}}function jQ(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.budget," ","symbol","1.0-0"))}}function VQ(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.landcost," ","symbol","1.0-0"))}}function UQ(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.commission," ","symbol","1.0-0"))}}function HQ(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.taxes," ","symbol","1.0-0"))}}function zQ(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.coveredarea)}}function $Q(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,LQ,2,1,"td",20),f(4,"td",21),_(5),p(),D(6,RQ,2,1,"td",20),D(7,BQ,2,1,"td",20),f(8,"td"),_(9),Ne(10,"date"),p(),f(11,"td"),_(12),p(),f(13,"td"),_(14),Ne(15,"currency"),p(),f(16,"td"),_(17),p(),f(18,"td"),_(19),p(),D(20,jQ,3,6,"td",20),D(21,VQ,3,6,"td",20),D(22,UQ,3,6,"td",20),D(23,HQ,3,6,"td",20),D(24,zQ,2,1,"td",20),f(25,"td")(26,"p-checkbox",22,23),L("ngModelChange",function(r){return z(e).$implicit.selected=r})("onChange",function(r){const c=z(e).$implicit;return A().checkboxChanged(r,c)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.project_name),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(2),U(Oa(10,17,e.startdate,"dd-MM-yyyy")),v(3),U(e.status),v(2),U(He(15,20,e.totalcost," ","symbol","1.0-0")),v(3),U(e.notes),v(2),U(e.description),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(2),T("ngModel",e.selected)("binary",!0)}}function WQ(t,i){1&t&&(f(0,"tr"),ee(1,"td")(2,"td")(3,"td")(4,"td")(5,"td")(6,"td")(7,"td")(8,"td"),p())}const sR=function(){return{width:"200px"}},qQ=function(){return["project_name","client","location","status"]};let GQ=(()=>{class t{constructor(e,n){this.proj_Service=e,this._ms=n,this.selectedType=1,this.selectedUser=0,this.projects=[],this.types=[{name:"Residential",code:"1"},{name:"Commercial",code:"2"}]}ngOnInit(){this.loadUsers(),this.getProjects(this.selectedType),this.loadUserProjects()}loadUsers(){this.proj_Service.getUsers().subscribe({next:e=>{this.users=e,this.selectedUser=this.users[0].id,this.loadUserProjects()},error:e=>{console.error(e)}})}getProjects(e){this.proj_Service.getProjectsList().subscribe({next:n=>{this.projects=n},error:n=>{console.error(n)}})}isProjectsEmpty(){return 0===this.projects.length}onDropdownChange(e){this.selectedType=e.value,this.getProjects(this.selectedType),this.loadUserProjects()}loadUserProjects(){this.projects.forEach(e=>{e.selected=!1}),this.proj_Service.getUserAllProjects(this.selectedUser).subscribe({next:e=>{this.userprojects=e,this.projects.forEach(n=>{this.userprojects.forEach(r=>{r.projectid==n.id&&(n.selected=!0)})})},error:e=>{console.error(e)}})}onUserDropdownChange(e){this.selectedUser=e.value,this.projects.forEach(n=>{n.selected=!1}),this.proj_Service.getUserAllProjects(this.selectedUser).subscribe({next:n=>{this.userprojects=n,this.projects.forEach(r=>{this.userprojects.forEach(o=>{o.projectid==r.id&&(r.selected=!0)})})},error:n=>{console.error(n)}})}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}selectAll(e){if(null!=this.selectedUser&&0!=this.selectedUser)if(e){let n=[];if(this.projects.forEach(r=>{r.selected||n.push(r.id)}),0==n.length)return void this._ms.add({severity:"error",summary:"Error",detail:"All projects are already assigned to user.",life:3e3});console.log("Checkbox is checked"),this.proj_Service.assignProjecttoUsers(this.selectedUser,n,0).subscribe({next:r=>{this._ms.add({severity:"success",summary:"Successful",detail:"Projects are assigned to user successfully.",life:3e3}),this.projects.forEach(o=>o.selected=e)},error:r=>{this._ms.add({severity:"error",summary:"Error",detail:"Error in projects assignment to user.",life:3e3})}})}else{console.log("Checkbox is unchecked");let n=[];if(this.projects.forEach(r=>{r.selected&&n.push(r.id)}),0==n.length)return void this._ms.add({severity:"error",summary:"Error",detail:"All projects are already removed from user access.",life:3e3});this.proj_Service.assignProjecttoUsers(this.selectedUser,n,1).subscribe({next:r=>{this._ms.add({severity:"success",summary:"Successful",detail:"Projects are removed from user access.",life:3e3}),this.projects.forEach(o=>o.selected=e)},error:r=>{this._ms.add({severity:"error",summary:"Error",detail:"Error in removing projects from user access.",life:3e3})}})}else this._ms.add({severity:"error",summary:"Error",detail:"User is not selected.",life:3e3})}checkboxChanged(e,n){if(null==this.selectedUser||0==this.selectedUser)return this._ms.add({severity:"error",summary:"Error",detail:"User is not selected.",life:3e3}),void(n.selected=!1);let r=[];if(r.push(n.id),e.checked)console.log("Checkbox is checked"),this.proj_Service.assignProjecttoUsers(this.selectedUser,r,0).subscribe({next:o=>{this._ms.add({severity:"success",summary:"Successful",detail:"Project is assigned to user successfully.",life:3e3})},error:o=>{this._ms.add({severity:"error",summary:"Error",detail:"Error in project assignment to user.",life:3e3})}});else{console.log("Checkbox is unchecked");let o=[];o.push(n.id),this.proj_Service.assignProjecttoUsers(this.selectedUser,o,1).subscribe({next:c=>{this._ms.add({severity:"success",summary:"Successful",detail:"Project is removed from user access.",life:3e3})},error:c=>{this._ms.add({severity:"error",summary:"Error",detail:"Error in removing project from user access.",life:3e3})}})}}}return t.\u0275fac=function(e){return new(e||t)(te(ll),te(kn))},t.\u0275cmp=dn({type:t,selectors:[["app-assignprojects"]],viewQuery:function(e,n){if(1&e&&Mt(EQ,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},decls:24,vars:14,consts:[[1,"text-muted"],[2,"display","flex","align-items","center"],["for","status",2,"margin-right","5px"],["optionLabel","name","optionValue","id","filterBy","name","placeholder","Select User","appendTo","body",3,"options","ngModel","onChange","ngModelChange"],["for","status",2,"margin-right","5px","margin-left","5px","display","none"],["optionLabel","name","optionValue","code",2,"display","none",3,"options","onChange"],[1,"project-btn-group","project-btn-group--right","project-btn-group--spaced"],[1,"btn-project",3,"click"],["tableContainer",""],["id","projectstable","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["position","bottom-right"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[4,"ngIf"],[1,"list-item"],["inputId","binary",3,"ngModel","binary","ngModelChange","onChange"],["myCheckbox",""]],template:function(e,n){1&e&&(f(0,"h2",0),_(1,"Assign Projects to Users"),p(),ee(2,"hr"),f(3,"div",1)(4,"label",2),_(5,"Select User"),p(),f(6,"p-dropdown",3),L("onChange",function(o){return n.onUserDropdownChange(o)})("ngModelChange",function(o){return n.selectedUser=o}),p(),f(7,"label",4),_(8,"Project Type"),p(),f(9,"p-dropdown",5),L("onChange",function(o){return n.onDropdownChange(o)}),p()(),f(10,"div",6)(11,"button",7),L("click",function(){return n.selectAll(!0)}),_(12,"Select All"),p(),f(13,"button",7),L("click",function(){return n.selectAll(!1)}),_(14,"Deselect All"),p()(),f(15,"div",null,8)(17,"p-table",9,10),D(19,kQ,4,0,"ng-template",11),D(20,NQ,24,7,"ng-template",12),D(21,$Q,28,25,"ng-template",13),D(22,WQ,9,0,"ng-template",14),p()(),ee(23,"p-toast",15)),2&e&&(v(6),Ft(rt(11,sR)),T("options",n.users)("ngModel",n.selectedUser),v(3),Ft(rt(12,sR)),T("options",n.types),v(8),T("value",n.projects)("paginator",!0)("rows",10)("globalFilterFields",rt(13,qQ)))},directives:[us,Er,md,ki,zn,li,Sn,ST,fr],pipes:[al,dr],styles:[""]}),t})();function Qr(t){const i=new Date(t);return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`}function ui(){const t=new Date;return`${String(t.getDate()).padStart(2,"0")}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getFullYear())}`}const zp=Ws_apiUrl,ET={headers:new io({"Content-Type":"application/json"})};let IA=(()=>{class t{constructor(e){this._http=e}getBankingRecord(e){return this._http.get(zp+"getBankingRecord",{params:{accountID:e.toString()}})}getAccounts(){return this._http.get(zp+"getAccounts",{})}addBankingRecord(e){const{accountid:n,description:r,selectedType:o,credit:c,instrumentbank:u,instrumentno:m,transactiontype:g}=e.value,x=new Date(e.value.transactiondate),S=this.formatDate(x);return this._http.post(zp+"addBankingRecord",{transactiondate:S,accountid:n,description:r,selectedType:o,credit:c,instrumentbank:u,instrumentno:m,transactiontype:g},ET)}addAccount(e){const{bank:n,title:r,iban:o,currency:c}=e.value;return this._http.post(zp+"addAccount",{bank:n,title:r,iban:o,currency:c},ET)}updateBankingRecord(e){const{id:n,accountid:r,description:o,debit:c,credit:u,instrumentbank:m,instrumentnumber:g,transactiontype:x}=e.value,S=new Date(e.value.transactiondate),M=this.formatDate(S);return this._http.post(zp+"updateBankingRecord",{id:n,transactiondate:M,accountid:r,description:o,debit:c,credit:u,instrumentbank:m,instrumentnumber:g,transactiontype:x},ET)}updateAccount(e){const{id:n,bank:r,title:o,iban:c,currency:u}=e.value;return this._http.post(zp+"updateAccount",{id:n,bank:r,title:o,iban:c,currency:u},ET)}deleteBankingRecord(e){return this._http.delete(`${zp}deleteBankingRecord`,{body:{id:e}})}deleteAccount(e){return this._http.delete(`${zp}deleteAccount`,{body:{id:e}})}formatDate(e){return`${e.getFullYear().toString().slice(-2)}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function $r(t){return($r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(t)}var Jr=Uint8Array,oa=Uint16Array,$p=Uint32Array,V0=new Jr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),U0=new Jr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Gy=new Jr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),lR=function(t,i){for(var e=new oa(31),n=0;n<31;++n)e[n]=i+=1<<t[n-1];var r=new $p(e[30]);for(n=1;n<30;++n)for(var o=e[n];o<e[n+1];++o)r[o]=o-e[n]<<5|n;return[e,r]},cR=lR(V0,2),AA=cR[0],kT=cR[1];AA[28]=258,kT[258]=28;for(var uR=lR(U0,0),dR=uR[0],MA=uR[1],Ky=new oa(32768),Co=0;Co<32768;++Co){var Wp=(43690&Co)>>>1|(21845&Co)<<1;Ky[Co]=((65280&(Wp=(61680&(Wp=(52428&Wp)>>>2|(13107&Wp)<<2))>>>4|(3855&Wp)<<4))>>>8|(255&Wp)<<8)>>>1}var Hc=function(t,i,e){for(var n=t.length,r=0,o=new oa(i);r<n;++r)++o[t[r]-1];var u,c=new oa(i);for(r=0;r<i;++r)c[r]=c[r-1]+o[r-1]<<1;if(e){u=new oa(1<<i);var m=15-i;for(r=0;r<n;++r)if(t[r])for(var g=r<<4|t[r],x=i-t[r],S=c[t[r]-1]++<<x,M=S|(1<<x)-1;S<=M;++S)u[Ky[S]>>>m]=g}else for(u=new oa(n),r=0;r<n;++r)u[r]=Ky[c[t[r]-1]++]>>>15-t[r];return u},yf=new Jr(288);for(Co=0;Co<144;++Co)yf[Co]=8;for(Co=144;Co<256;++Co)yf[Co]=9;for(Co=256;Co<280;++Co)yf[Co]=7;for(Co=280;Co<288;++Co)yf[Co]=8;var H0=new Jr(32);for(Co=0;Co<32;++Co)H0[Co]=5;var fR=Hc(yf,9,0),pR=Hc(yf,9,1),hR=Hc(H0,5,0),mR=Hc(H0,5,1),DT=function(t){for(var i=t[0],e=1;e<t.length;++e)t[e]>i&&(i=t[e]);return i},zc=function(t,i,e){var n=i/8>>0;return(t[n]|t[n+1]<<8)>>>(7&i)&e},IT=function(t,i){var e=i/8>>0;return(t[e]|t[e+1]<<8|t[e+2]<<16)>>>(7&i)},Yy=function(t){return(t/8>>0)+(7&t&&1)},Am=function(t,i,e){(null==i||i<0)&&(i=0),(null==e||e>t.length)&&(e=t.length);var n=new(t instanceof oa?oa:t instanceof $p?$p:Jr)(e-i);return n.set(t.subarray(i,e)),n},gd=function(t,i,e){var n=i/8>>0;t[n]|=e<<=7&i,t[n+1]|=e>>>8},z0=function(t,i,e){var n=i/8>>0;t[n]|=e<<=7&i,t[n+1]|=e>>>8,t[n+2]|=e>>>16},MT=function(t,i){for(var e=[],n=0;n<t.length;++n)t[n]&&e.push({s:n,f:t[n]});var r=e.length,o=e.slice();if(!r)return[new Jr(0),0];if(1==r){var c=new Jr(e[0].s+1);return c[e[0].s]=1,[c,1]}e.sort(function(Ye,yt){return Ye.f-yt.f}),e.push({s:-1,f:25001});var u=e[0],m=e[1],g=0,x=1,S=2;for(e[0]={s:-1,f:u.f+m.f,l:u,r:m};x!=r-1;)u=e[e[g].f<e[S].f?g++:S++],m=e[g!=x&&e[g].f<e[S].f?g++:S++],e[x++]={s:-1,f:u.f+m.f,l:u,r:m};var M=o[0].s;for(n=1;n<r;++n)o[n].s>M&&(M=o[n].s);var E=new oa(M+1),R=FT(e[x-1],E,0);if(R>i){n=0;var B=0,K=R-i,q=1<<K;for(o.sort(function(yt,Ge){return E[Ge.s]-E[yt.s]||yt.f-Ge.f});n<r;++n){var Y=o[n].s;if(!(E[Y]>i))break;B+=q-(1<<R-E[Y]),E[Y]=i}for(B>>>=K;B>0;){var ce=o[n].s;E[ce]<i?B-=1<<i-E[ce]++-1:++n}for(;n>=0&&B;--n){var De=o[n].s;E[De]==i&&(--E[De],++B)}R=i}return[new Jr(E),R]},FT=function(t,i,e){return-1==t.s?Math.max(FT(t.l,i,e+1),FT(t.r,i,e+1)):i[t.s]=e},FA=function(t){for(var i=t.length;i&&!t[--i];);for(var e=new oa(++i),n=0,r=t[0],o=1,c=function(m){e[n++]=m},u=1;u<=i;++u)if(t[u]==r&&u!=i)++o;else{if(!r&&o>2){for(;o>138;o-=138)c(32754);o>2&&(c(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(c(r),--o;o>6;o-=6)c(8304);o>2&&(c(o-3<<5|8208),o=0)}for(;o--;)c(r);o=1,r=t[u]}return[e.subarray(0,n),i]},$0=function(t,i){for(var e=0,n=0;n<i.length;++n)e+=t[n]*i[n];return e},Xy=function(t,i,e){var n=e.length,r=Yy(i+2);t[r]=255&n,t[r+1]=n>>>8,t[r+2]=255^t[r],t[r+3]=255^t[r+1];for(var o=0;o<n;++o)t[r+o+4]=e[o];return 8*(r+4+n)},PA=function(t,i,e,n,r,o,c,u,m,g,x){gd(i,x++,e),++r[256];for(var S=MT(r,15),M=S[0],E=S[1],R=MT(o,15),B=R[0],K=R[1],q=FA(M),Y=q[0],ce=q[1],De=FA(B),Ye=De[0],yt=De[1],Ge=new oa(19),Te=0;Te<Y.length;++Te)Ge[31&Y[Te]]++;for(Te=0;Te<Ye.length;++Te)Ge[31&Ye[Te]]++;for(var mt=MT(Ge,7),vt=mt[0],fe=mt[1],de=19;de>4&&!vt[Gy[de-1]];--de);var Re,Je,Ue,lt,Oe=g+5<<3,Ae=$0(r,yf)+$0(o,H0)+c,Ct=$0(r,M)+$0(o,B)+c+14+3*de+$0(Ge,vt)+(2*Ge[16]+3*Ge[17]+7*Ge[18]);if(Oe<=Ae&&Oe<=Ct)return Xy(i,x,t.subarray(m,m+g));if(gd(i,x,1+(Ct<Ae)),x+=2,Ct<Ae){Re=Hc(M,E,0),Je=M,Ue=Hc(B,K,0),lt=B;var _t=Hc(vt,fe,0);for(gd(i,x,ce-257),gd(i,x+5,yt-1),gd(i,x+10,de-4),x+=14,Te=0;Te<de;++Te)gd(i,x+3*Te,vt[Gy[Te]]);x+=3*de;for(var on=[Y,Ye],ne=0;ne<2;++ne){var ve=on[ne];for(Te=0;Te<ve.length;++Te)gd(i,x,_t[we=31&ve[Te]]),x+=vt[we],we>15&&(gd(i,x,ve[Te]>>>5&127),x+=ve[Te]>>>12)}}else Re=fR,Je=yf,Ue=hR,lt=H0;for(Te=0;Te<u;++Te)if(n[Te]>255){var we;z0(i,x,Re[257+(we=n[Te]>>>18&31)]),x+=Je[we+257],we>7&&(gd(i,x,n[Te]>>>23&31),x+=V0[we]);var je=31&n[Te];z0(i,x,Ue[je]),x+=lt[je],je>3&&(z0(i,x,n[Te]>>>5&8191),x+=U0[je])}else z0(i,x,Re[n[Te]]),x+=Je[n[Te]];return z0(i,x,Re[256]),x+Je[256]},gR=new $p([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),_R=new Jr(0),OT=function(t,i,e,n,r){return function(t,i,e,n,r,o){var c=t.length,u=new Jr(n+c+5*(1+Math.floor(c/7e3))+r),m=u.subarray(n,u.length-r),g=0;if(!i||c<8)for(var x=0;x<=c;x+=65535){var S=x+65535;S<c?g=Xy(m,g,t.subarray(x,S)):(m[x]=o,g=Xy(m,g,t.subarray(x,c)))}else{for(var M=gR[i-1],E=M>>>13,R=8191&M,B=(1<<e)-1,K=new oa(32768),q=new oa(B+1),Y=Math.ceil(e/3),ce=2*Y,De=function(oi){return(t[oi]^t[oi+1]<<Y^t[oi+2]<<ce)&B},Ye=new $p(25e3),yt=new oa(288),Ge=new oa(32),Te=0,mt=0,vt=(x=0,0),fe=0,de=0;x<c;++x){var Oe=De(x),Ae=32767&x,Ct=q[Oe];if(K[Ae]=Ct,q[Oe]=Ae,fe<=x){var Re=c-x;if((Te>7e3||vt>24576)&&Re>423){g=PA(t,m,0,Ye,yt,Ge,mt,vt,de,x-de,g),vt=Te=mt=0,de=x;for(var Je=0;Je<286;++Je)yt[Je]=0;for(Je=0;Je<30;++Je)Ge[Je]=0}var Ue=2,lt=0,_t=R,on=Ae-Ct&32767;if(Re>2&&Oe==De(x-on))for(var ne=Math.min(E,Re)-1,ve=Math.min(32767,x),we=Math.min(258,Re);on<=ve&&--_t&&Ae!=Ct;){if(t[x+Ue]==t[x+Ue-on]){for(var je=0;je<we&&t[x+je]==t[x+je-on];++je);if(je>Ue){if(Ue=je,lt=on,je>ne)break;var Ze=Math.min(on,je-2),it=0;for(Je=0;Je<Ze;++Je){var ct=x-on+Je+32768&32767,qt=ct-K[ct]+32768&32767;qt>it&&(it=qt,Ct=ct)}}}on+=(Ae=Ct)-(Ct=K[Ae])+32768&32767}if(lt){Ye[vt++]=268435456|kT[Ue]<<18|MA[lt];var Gt=31&kT[Ue],xn=31&MA[lt];mt+=V0[Gt]+U0[xn],++yt[257+Gt],++Ge[xn],fe=x+Ue,++Te}else Ye[vt++]=t[x],++yt[t[x]]}}g=PA(t,m,o,Ye,yt,Ge,mt,vt,de,x-de,g),o||(g=Xy(m,g,_R))}return Am(u,0,n+Yy(g)+r)}(t,null==i.level?6:i.level,null==i.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+i.mem,e,n,!r)};function Jy(t,i){void 0===i&&(i={});var e=function(){var t=1,i=0;return{p:function(e){for(var n=t,r=i,o=e.length,c=0;c!=o;){for(var u=Math.min(c+5552,o);c<u;++c)r+=n+=e[c];n%=65521,r%=65521}t=n,i=r},d:function(){return(t>>>8<<16|(255&i)<<8|i>>>8)+2*((255&t)<<23)}}}();e.p(t);var n=OT(t,i,2,4);return function(t,i){var e=i.level,n=0==e?0:e<6?1:9==e?3:2;t[0]=120,t[1]=n<<6|(n?32-2*n:1)}(n,i),function(t,i,e){for(;e;++i)t[i]=e,e>>>=8}(n,n.length-4,e.d()),n}function RT(t,i){return function(t,i,e){var n=t.length,r=!i||e,o=!e||e.i;e||(e={}),i||(i=new Jr(3*n));var c=function(Ze){var it=i.length;if(Ze>it){var ct=new Jr(Math.max(2*it,Ze));ct.set(i),i=ct}},u=e.f||0,m=e.p||0,g=e.b||0,x=e.l,S=e.d,M=e.m,E=e.n,R=8*n;do{if(!x){e.f=u=zc(t,m,1);var B=zc(t,m+1,3);if(m+=3,!B){var q=t[(K=Yy(m)+4)-4]|t[K-3]<<8,Y=K+q;if(Y>n){if(o)throw"unexpected EOF";break}r&&c(g+q),i.set(t.subarray(K,Y),g),e.b=g+=q,e.p=m=8*Y;continue}if(1==B)x=pR,S=mR,M=9,E=5;else{if(2!=B)throw"invalid block type";var ce=zc(t,m,31)+257,De=zc(t,m+10,15)+4,Ye=ce+zc(t,m+5,31)+1;m+=14;for(var yt=new Jr(Ye),Ge=new Jr(19),Te=0;Te<De;++Te)Ge[Gy[Te]]=zc(t,m+3*Te,7);m+=3*De;var mt=DT(Ge),vt=(1<<mt)-1;if(!o&&m+Ye*(mt+7)>R)break;var fe=Hc(Ge,mt,1);for(Te=0;Te<Ye;){var K,de=fe[zc(t,m,vt)];if(m+=15&de,(K=de>>>4)<16)yt[Te++]=K;else{var Oe=0,Ae=0;for(16==K?(Ae=3+zc(t,m,3),m+=2,Oe=yt[Te-1]):17==K?(Ae=3+zc(t,m,7),m+=3):18==K&&(Ae=11+zc(t,m,127),m+=7);Ae--;)yt[Te++]=Oe}}var Ct=yt.subarray(0,ce),Re=yt.subarray(ce);M=DT(Ct),E=DT(Re),x=Hc(Ct,M,1),S=Hc(Re,E,1)}if(m>R)throw"unexpected EOF"}r&&c(g+131072);for(var Je=(1<<M)-1,Ue=(1<<E)-1,lt=M+E+18;o||m+lt<R;){var _t=(Oe=x[IT(t,m)&Je])>>>4;if((m+=15&Oe)>R)throw"unexpected EOF";if(!Oe)throw"invalid length/literal";if(_t<256)i[g++]=_t;else{if(256==_t){x=null;break}var on=_t-254;_t>264&&(on=zc(t,m,(1<<(ne=V0[Te=_t-257]))-1)+AA[Te],m+=ne);var ve=S[IT(t,m)&Ue],we=ve>>>4;if(!ve)throw"invalid distance";if(m+=15&ve,Re=dR[we],we>3){var ne=U0[we];Re+=IT(t,m)&(1<<ne)-1,m+=ne}if(m>R)throw"unexpected EOF";r&&c(g+131072);for(var je=g+on;g<je;g+=4)i[g]=i[g-Re],i[g+1]=i[g+1-Re],i[g+2]=i[g+2-Re],i[g+3]=i[g+3-Re];g=je}}e.l=x,e.p=m,e.b=g,x&&(u=1,e.m=M,e.d=S,e.n=E)}while(!u);return g==i.length?i:Am(i,0,g)}((function(t){if(8!=(15&t[0])||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(32&t[1])throw"invalid zlib data: preset dictionaries not supported"}(t),t.subarray(2,-4)),i)}var ri=function(){return"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this}();function jA(){ri.console&&"function"==typeof ri.console.log&&ri.console.log.apply(ri.console,arguments)}var ro={log:jA,warn:function(t){ri.console&&("function"==typeof ri.console.warn?ri.console.warn.apply(ri.console,arguments):jA.call(null,arguments))},error:function(t){ri.console&&("function"==typeof ri.console.error?ri.console.error.apply(ri.console,arguments):jA(t))}};function VA(t,i,e){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){Mm(n.response,i,e)},n.onerror=function(){ro.error("could not download file")},n.send()}function LR(t){var i=new XMLHttpRequest;i.open("HEAD",t,!1);try{i.send()}catch(e){}return i.status>=200&&i.status<=299}function jT(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(e){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(i)}}var Zy,UA,Mm=ri.saveAs||("object"!==("undefined"==typeof window?"undefined":$r(window))||window!==ri?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(t,i,e){var n=ri.URL||ri.webkitURL,r=document.createElement("a");r.download=i=i||t.name||"download",r.rel="noopener","string"==typeof t?(r.href=t,r.origin!==location.origin?LR(r.href)?VA(t,i,e):jT(r,r.target="_blank"):jT(r)):(r.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(r.href)},4e4),setTimeout(function(){jT(r)},0))}:"msSaveOrOpenBlob"in navigator?function(t,i,e){if(i=i||t.name||"download","string"==typeof t)if(LR(t))VA(t,i,e);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){jT(n)})}else navigator.msSaveOrOpenBlob((r=t,void 0===(o=e)?o={autoBom:!1}:"object"!==$r(o)&&(ro.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob([String.fromCharCode(65279),r],{type:r.type}):r),i);var r,o}:function(t,i,e,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof t)return VA(t,i,e);var r="application/octet-stream"===t.type,o=/constructor/i.test(ri.HTMLElement)||ri.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||r&&o)&&"object"===("undefined"==typeof FileReader?"undefined":$r(FileReader))){var u=new FileReader;u.onloadend=function(){var x=u.result;x=c?x:x.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=x:location=x,n=null},u.readAsDataURL(t)}else{var m=ri.URL||ri.webkitURL,g=m.createObjectURL(t);n?n.location=g:location.href=g,n=null,setTimeout(function(){m.revokeObjectURL(g)},4e4)}});function RR(t){var i;t=t||"",this.ok=!1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(u){return[parseInt(u[1]),parseInt(u[2]),parseInt(u[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(u){return[parseInt(u[1],16),parseInt(u[2],16),parseInt(u[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(u){return[parseInt(u[1]+u[1],16),parseInt(u[2]+u[2],16),parseInt(u[3]+u[3],16)]}}],n=0;n<e.length;n++){var o=e[n].process,c=e[n].re.exec(t);c&&(i=o(c),this.r=i[0],this.g=i[1],this.b=i[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var u=this.r.toString(16),m=this.g.toString(16),g=this.b.toString(16);return 1==u.length&&(u="0"+u),1==m.length&&(m="0"+m),1==g.length&&(g="0"+g),"#"+u+m+g}}function HA(t,i){var e=t[0],n=t[1],r=t[2],o=t[3];e=Va(e,n,r,o,i[0],7,-680876936),o=Va(o,e,n,r,i[1],12,-389564586),r=Va(r,o,e,n,i[2],17,606105819),n=Va(n,r,o,e,i[3],22,-1044525330),e=Va(e,n,r,o,i[4],7,-176418897),o=Va(o,e,n,r,i[5],12,1200080426),r=Va(r,o,e,n,i[6],17,-1473231341),n=Va(n,r,o,e,i[7],22,-45705983),e=Va(e,n,r,o,i[8],7,1770035416),o=Va(o,e,n,r,i[9],12,-1958414417),r=Va(r,o,e,n,i[10],17,-42063),n=Va(n,r,o,e,i[11],22,-1990404162),e=Va(e,n,r,o,i[12],7,1804603682),o=Va(o,e,n,r,i[13],12,-40341101),r=Va(r,o,e,n,i[14],17,-1502002290),e=Ua(e,n=Va(n,r,o,e,i[15],22,1236535329),r,o,i[1],5,-165796510),o=Ua(o,e,n,r,i[6],9,-1069501632),r=Ua(r,o,e,n,i[11],14,643717713),n=Ua(n,r,o,e,i[0],20,-373897302),e=Ua(e,n,r,o,i[5],5,-701558691),o=Ua(o,e,n,r,i[10],9,38016083),r=Ua(r,o,e,n,i[15],14,-660478335),n=Ua(n,r,o,e,i[4],20,-405537848),e=Ua(e,n,r,o,i[9],5,568446438),o=Ua(o,e,n,r,i[14],9,-1019803690),r=Ua(r,o,e,n,i[3],14,-187363961),n=Ua(n,r,o,e,i[8],20,1163531501),e=Ua(e,n,r,o,i[13],5,-1444681467),o=Ua(o,e,n,r,i[2],9,-51403784),r=Ua(r,o,e,n,i[7],14,1735328473),e=Ha(e,n=Ua(n,r,o,e,i[12],20,-1926607734),r,o,i[5],4,-378558),o=Ha(o,e,n,r,i[8],11,-2022574463),r=Ha(r,o,e,n,i[11],16,1839030562),n=Ha(n,r,o,e,i[14],23,-35309556),e=Ha(e,n,r,o,i[1],4,-1530992060),o=Ha(o,e,n,r,i[4],11,1272893353),r=Ha(r,o,e,n,i[7],16,-155497632),n=Ha(n,r,o,e,i[10],23,-1094730640),e=Ha(e,n,r,o,i[13],4,681279174),o=Ha(o,e,n,r,i[0],11,-358537222),r=Ha(r,o,e,n,i[3],16,-722521979),n=Ha(n,r,o,e,i[6],23,76029189),e=Ha(e,n,r,o,i[9],4,-640364487),o=Ha(o,e,n,r,i[12],11,-421815835),r=Ha(r,o,e,n,i[15],16,530742520),e=za(e,n=Ha(n,r,o,e,i[2],23,-995338651),r,o,i[0],6,-198630844),o=za(o,e,n,r,i[7],10,1126891415),r=za(r,o,e,n,i[14],15,-1416354905),n=za(n,r,o,e,i[5],21,-57434055),e=za(e,n,r,o,i[12],6,1700485571),o=za(o,e,n,r,i[3],10,-1894986606),r=za(r,o,e,n,i[10],15,-1051523),n=za(n,r,o,e,i[1],21,-2054922799),e=za(e,n,r,o,i[8],6,1873313359),o=za(o,e,n,r,i[15],10,-30611744),r=za(r,o,e,n,i[6],15,-1560198380),n=za(n,r,o,e,i[13],21,1309151649),e=za(e,n,r,o,i[4],6,-145523070),o=za(o,e,n,r,i[11],10,-1120210379),r=za(r,o,e,n,i[2],15,718787259),n=za(n,r,o,e,i[9],21,-343485551),t[0]=Gp(e,t[0]),t[1]=Gp(n,t[1]),t[2]=Gp(r,t[2]),t[3]=Gp(o,t[3])}function VT(t,i,e,n,r,o){return i=Gp(Gp(i,t),Gp(n,o)),Gp(i<<r|i>>>32-r,e)}function Va(t,i,e,n,r,o,c){return VT(i&e|~i&n,t,i,r,o,c)}function Ua(t,i,e,n,r,o,c){return VT(i&n|e&~n,t,i,r,o,c)}function Ha(t,i,e,n,r,o,c){return VT(i^e^n,t,i,r,o,c)}function za(t,i,e,n,r,o,c){return VT(e^(i|~n),t,i,r,o,c)}function BR(t){var i,e=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(i=64;i<=t.length;i+=64)HA(n,oJ(t.substring(i-64,i)));t=t.substring(i-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<t.length;i++)r[i>>2]|=t.charCodeAt(i)<<(i%4<<3);if(r[i>>2]|=128<<(i%4<<3),i>55)for(HA(n,r),i=0;i<16;i++)r[i]=0;return r[14]=8*e,HA(n,r),n}function oJ(t){var i,e=[];for(i=0;i<64;i+=4)e[i>>2]=t.charCodeAt(i)+(t.charCodeAt(i+1)<<8)+(t.charCodeAt(i+2)<<16)+(t.charCodeAt(i+3)<<24);return e}Zy=ri.atob.bind(ri),UA=ri.btoa.bind(ri);var jR="0123456789abcdef".split("");function sJ(t){for(var i="",e=0;e<4;e++)i+=jR[t>>8*e+4&15]+jR[t>>8*e&15];return i}function aJ(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function zA(t){return BR(t).map(aJ).join("")}var lJ="5d41402abc4b2a76b9719d911017c592"!=function(t){for(var i=0;i<t.length;i++)t[i]=sJ(t[i]);return t.join("")}(BR("hello"));function Gp(t,i){if(lJ){var e=(65535&t)+(65535&i);return(t>>16)+(i>>16)+(e>>16)<<16|65535&e}return t+i&4294967295}function $A(t,i){var e,n,r;if(t!==e){for(var c=(r=t,new Array(1+(256/t.length>>0)+1).join(r)),u=[],m=0;m<256;m++)u[m]=m;var g=0;for(m=0;m<256;m++){var x=u[m];g=(g+x+c.charCodeAt(m))%256,u[m]=u[g],u[g]=x}e=t,n=u}else u=n;var S=i.length,M=0,E=0,R="";for(m=0;m<S;m++)E=(E+(x=u[M=(M+1)%256]))%256,u[M]=u[E],u[E]=x,c=u[(u[M]+u[E])%256],R+=String.fromCharCode(i.charCodeAt(m)^c);return R}var VR={print:4,modify:8,copy:16,"annot-forms":32};function q0(t,i,e,n){this.v=1,this.r=2;var r=192;t.forEach(function(u){if(void 0!==VR.perm)throw new Error("Invalid permission: "+u);r+=VR[u]}),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var o=(i+this.padding).substr(0,32),c=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,c),this.P=-(1+(255^r)),this.encryptionKey=zA(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=$A(this.encryptionKey,this.padding)}function G0(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var i="",e=t.length,n=0;n<e;n++){var r=t.charCodeAt(n);i+=r<33||35===r||37===r||40===r||41===r||47===r||60===r||62===r||91===r||93===r||123===r||125===r||r>126?"#"+("0"+r.toString(16)).slice(-2):t[n]}return i}function UR(t){if("object"!==$r(t))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var i={};this.subscribe=function(e,n,r){if(r=r||!1,"string"!=typeof e||"function"!=typeof n||"boolean"!=typeof r)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");i.hasOwnProperty(e)||(i[e]={});var o=Math.random().toString(35);return i[e][o]=[n,!!r],o},this.unsubscribe=function(e){for(var n in i)if(i[n][e])return delete i[n][e],0===Object.keys(i[n]).length&&delete i[n],!0;return!1},this.publish=function(e){if(i.hasOwnProperty(e)){var n=Array.prototype.slice.call(arguments,1),r=[];for(var o in i[e]){var c=i[e][o];try{c[0].apply(t,n)}catch(u){ri.console&&ro.error("jsPDF PubSub Error",u.message,u)}c[1]&&r.push(o)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return i}}function UT(t){if(!(this instanceof UT))return new UT(t);var i="opacity,stroke-opacity".split(",");for(var e in t)t.hasOwnProperty(e)&&i.indexOf(e)>=0&&(this[e]=t[e]);this.id="",this.objectNumber=-1}function HR(t,i){this.gState=t,this.matrix=i,this.id="",this.objectNumber=-1}function Fm(t,i,e,n,r){if(!(this instanceof Fm))return new Fm(t,i,e,n,r);this.type="axial"===t?2:3,this.coords=i,this.colors=e,HR.call(this,n,r)}function K0(t,i,e,n,r){if(!(this instanceof K0))return new K0(t,i,e,n,r);this.boundingBox=t,this.xStep=i,this.yStep=e,this.stream="",this.cloneIndex=0,HR.call(this,n,r)}function ei(t){var i,e="string"==typeof arguments[0]?arguments[0]:"p",n=arguments[1],r=arguments[2],o=arguments[3],c=[],u=1,m=16,g="S",x=null;"object"===$r(t=t||{})&&(e=t.orientation,n=t.unit||n,r=t.format||r,o=t.compress||t.compressPdf||o,null!==(x=t.encryption||null)&&(x.userPassword=x.userPassword||"",x.ownerPassword=x.ownerPassword||"",x.userPermissions=x.userPermissions||[]),u="number"==typeof t.userUnit?Math.abs(t.userUnit):1,void 0!==t.precision&&(i=t.precision),void 0!==t.floatPrecision&&(m=t.floatPrecision),g=t.defaultPathOperation||"S"),c=t.filters||(!0===o?["FlateEncode"]:c),n=n||"mm",e=(""+(e||"P")).toLowerCase();var S=t.putOnlyUsedFonts||!1,M={},E={internal:{},__private__:{}};E.__private__.PubSub=UR;var R="1.3",B=E.__private__.getPdfVersion=function(){return R};E.__private__.setPdfVersion=function(P){R=P};var K={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};E.__private__.getPageFormats=function(){return K};var q=E.__private__.getPageFormat=function(P){return K[P]};r=r||"a4";var Y={COMPAT:"compat",ADVANCED:"advanced"},ce=Y.COMPAT;function De(){this.saveGraphicsState(),ke(new ti(bn,0,0,-bn,0,th()*bn).toString()+" cm"),this.setFontSize(this.getFontSize()/bn),g="n",ce=Y.ADVANCED}function Ye(){this.restoreGraphicsState(),g="S",ce=Y.COMPAT}var yt=E.__private__.combineFontStyleAndFontWeight=function(P,J){if("bold"==P&&"normal"==J||"bold"==P&&400==J||"normal"==P&&"italic"==J||"bold"==P&&"italic"==J)throw new Error("Invalid Combination of fontweight and fontstyle");return J&&(P=400==J||"normal"===J?"italic"===P?"italic":"normal":700!=J&&"bold"!==J||"normal"!==P?(700==J?"bold":J)+""+P:"bold"),P};E.advancedAPI=function(P){var J=ce===Y.COMPAT;return J&&De.call(this),"function"!=typeof P||(P(this),J&&Ye.call(this)),this},E.compatAPI=function(P){var J=ce===Y.ADVANCED;return J&&Ye.call(this),"function"!=typeof P||(P(this),J&&De.call(this)),this},E.isAdvancedAPI=function(){return ce===Y.ADVANCED};var Ge,Te=function(P){if(ce!==Y.ADVANCED)throw new Error(P+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},mt=E.roundToPrecision=E.__private__.roundToPrecision=function(P,J){var Ce=i||J;if(isNaN(P)||isNaN(Ce))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return P.toFixed(Ce).replace(/0+$/,"")};Ge=E.hpf=E.__private__.hpf="number"==typeof m?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return mt(P,m)}:"smart"===m?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return mt(P,P>-1&&P<1?16:5)}:function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return mt(P,16)};var vt=E.f2=E.__private__.f2=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f2");return mt(P,2)},fe=E.__private__.f3=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f3");return mt(P,3)},de=E.scale=E.__private__.scale=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.scale");return ce===Y.COMPAT?P*bn:ce===Y.ADVANCED?P:void 0},Oe=function(P){return ce===Y.COMPAT?th()-P:ce===Y.ADVANCED?P:void 0},Ae=function(P){return de(Oe(P))};E.__private__.setPrecision=E.setPrecision=function(P){"number"==typeof parseInt(P,10)&&(i=parseInt(P,10))};var Ct,Re="00000000000000000000000000000000",Je=E.__private__.getFileId=function(){return Re},Ue=E.__private__.setFileId=function(P){return Re=void 0!==P&&/^[a-fA-F0-9]{32}$/.test(P)?P.toUpperCase():Re.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),null!==x&&(Wa=new q0(x.userPermissions,x.userPassword,x.ownerPassword,Re)),Re};E.setFileId=function(P){return Ue(P),this},E.getFileId=function(){return Je()};var lt=E.__private__.convertDateToPDFDate=function(P){var J=P.getTimezoneOffset(),Ce=J<0?"+":"-",Le=Math.floor(Math.abs(J/60)),nt=Math.abs(J%60),Dt=[Ce,we(Le),"'",we(nt),"'"].join("");return["D:",P.getFullYear(),we(P.getMonth()+1),we(P.getDate()),we(P.getHours()),we(P.getMinutes()),we(P.getSeconds()),Dt].join("")},_t=E.__private__.convertPDFDateToDate=function(P){var J=parseInt(P.substr(2,4),10),Ce=parseInt(P.substr(6,2),10)-1,Le=parseInt(P.substr(8,2),10),nt=parseInt(P.substr(10,2),10),Dt=parseInt(P.substr(12,2),10),$t=parseInt(P.substr(14,2),10);return new Date(J,Ce,Le,nt,Dt,$t,0)},on=E.__private__.setCreationDate=function(P){var J;if(void 0===P&&(P=new Date),P instanceof Date)J=lt(P);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(P))throw new Error("Invalid argument passed to jsPDF.setCreationDate");J=P}return Ct=J},ne=E.__private__.getCreationDate=function(P){var J=Ct;return"jsDate"===P&&(J=_t(Ct)),J};E.setCreationDate=function(P){return on(P),this},E.getCreationDate=function(P){return ne(P)};var ve,we=E.__private__.padd2=function(P){return("0"+parseInt(P)).slice(-2)},je=E.__private__.padd2Hex=function(P){return("00"+(P=P.toString())).substr(P.length)},Ze=0,it=[],ct=[],pt=0,qt=[],Gt=[],xn=!1,En=ct,oi=function(){Ze=0,pt=0,ct=[],it=[],qt=[],Sf=As(),Ou=As()};E.__private__.setCustomOutputDestination=function(P){xn=!0,En=P};var At=function(P){xn||(En=P)};E.__private__.resetCustomOutputDestination=function(){xn=!1,En=ct};var ke=E.__private__.out=function(P){return P=P.toString(),pt+=P.length+1,En.push(P),En},Di=E.__private__.write=function(P){return ke(1===arguments.length?P.toString():Array.prototype.join.call(arguments," "))},Rn=E.__private__.getArrayBuffer=function(P){for(var J=P.length,Ce=new ArrayBuffer(J),Le=new Uint8Array(Ce);J--;)Le[J]=P.charCodeAt(J);return Ce},Kt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];E.__private__.getStandardFonts=function(){return Kt};var cn=t.fontSize||16;E.__private__.setFontSize=E.setFontSize=function(P){return cn=ce===Y.ADVANCED?P/bn:P,this};var yn,gn=E.__private__.getFontSize=E.getFontSize=function(){return ce===Y.COMPAT?cn:cn*bn},$n=t.R2L||!1;E.__private__.setR2L=E.setR2L=function(P){return $n=P,this},E.__private__.getR2L=E.getR2L=function(){return $n};var xi,Bi=E.__private__.setZoomMode=function(P){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(P))yn=P;else if(isNaN(P)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(P))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+P+'" is not recognized.');yn=P}else yn=parseInt(P,10)};E.__private__.getZoomMode=function(){return yn};var Ki,vr=E.__private__.setPageMode=function(P){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(P))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+P+'" is not recognized.');xi=P};E.__private__.getPageMode=function(){return xi};var Zr=E.__private__.setLayoutMode=function(P){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(P))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+P+'" is not recognized.');Ki=P};E.__private__.getLayoutMode=function(){return Ki},E.__private__.setDisplayMode=E.setDisplayMode=function(P,J,Ce){return Bi(P),Zr(J),vr(Ce),this};var di={title:"",subject:"",author:"",keywords:"",creator:""};E.__private__.getDocumentProperty=function(P){if(-1===Object.keys(di).indexOf(P))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return di[P]},E.__private__.getDocumentProperties=function(){return di},E.__private__.setDocumentProperties=E.setProperties=E.setDocumentProperties=function(P){for(var J in di)di.hasOwnProperty(J)&&P[J]&&(di[J]=P[J]);return this},E.__private__.setDocumentProperty=function(P,J){if(-1===Object.keys(di).indexOf(P))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return di[P]=J};var er,bn,$a,kr,Mu,so={},ko={},Td=[],Or={},zm={},Yo={},Fu={},Tf=null,Xo=0,wi=[],Nr=new UR(E),$m=t.hotfixes||[],ka={},Sd={},Ed=[],ti=function P(J,Ce,Le,nt,Dt,$t){if(!(this instanceof P))return new P(J,Ce,Le,nt,Dt,$t);isNaN(J)&&(J=1),isNaN(Ce)&&(Ce=0),isNaN(Le)&&(Le=0),isNaN(nt)&&(nt=1),isNaN(Dt)&&(Dt=0),isNaN($t)&&($t=0),this._matrix=[J,Ce,Le,nt,Dt,$t]};Object.defineProperty(ti.prototype,"sx",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(ti.prototype,"shy",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(ti.prototype,"shx",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(ti.prototype,"sy",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(ti.prototype,"tx",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(ti.prototype,"ty",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(ti.prototype,"a",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(ti.prototype,"b",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(ti.prototype,"c",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(ti.prototype,"d",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(ti.prototype,"e",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(ti.prototype,"f",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(ti.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ti.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ti.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ti.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),ti.prototype.join=function(P){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Ge).join(P)},ti.prototype.multiply=function(P){return new ti(P.sx*this.sx+P.shy*this.shx,P.sx*this.shy+P.shy*this.sy,P.shx*this.sx+P.sy*this.shx,P.shx*this.shy+P.sy*this.sy,P.tx*this.sx+P.ty*this.shx+this.tx,P.tx*this.shy+P.ty*this.sy+this.ty)},ti.prototype.decompose=function(){var P=this.sx,J=this.shy,Ce=this.shx,Le=this.sy,nt=this.tx,Dt=this.ty,$t=Math.sqrt(P*P+J*J),wn=(P/=$t)*Ce+(J/=$t)*Le;Ce-=P*wn,Le-=J*wn;var Gn=Math.sqrt(Ce*Ce+Le*Le);return wn/=Gn,P*(Le/=Gn)<J*(Ce/=Gn)&&(P=-P,J=-J,wn=-wn,$t=-$t),{scale:new ti($t,0,0,Gn,0,0),translate:new ti(1,0,0,1,nt,Dt),rotate:new ti(P,J,-J,P,0,0),skew:new ti(1,0,wn,1,0,0)}},ti.prototype.toString=function(P){return this.join(" ")},ti.prototype.inversed=function(){var P=this.sx,J=this.shy,Ce=this.shx,Le=this.sy,nt=this.tx,Dt=this.ty,$t=1/(P*Le-J*Ce),wn=Le*$t,Gn=-J*$t,Ii=-Ce*$t,Ui=P*$t;return new ti(wn,Gn,Ii,Ui,-wn*nt-Ii*Dt,-Gn*nt-Ui*Dt)},ti.prototype.applyToPoint=function(P){return new b_(P.x*this.sx+P.y*this.shx+this.tx,P.x*this.shy+P.y*this.sy+this.ty)},ti.prototype.applyToRectangle=function(P){var J=this.applyToPoint(P),Ce=this.applyToPoint(new b_(P.x+P.w,P.y+P.h));return new _b(J.x,J.y,Ce.x-J.x,Ce.y-J.y)},ti.prototype.clone=function(){return new ti(this.sx,this.shy,this.shx,this.sy,this.tx,this.ty)},E.Matrix=ti;var Pu=E.matrixMult=function(P,J){return J.multiply(P)},kd=new ti(1,0,0,1,0,0);E.unitMatrix=E.identityMatrix=kd;var Nl=function(P,J){if(!zm[P]){var Ce=(J instanceof Fm?"Sh":"P")+(Object.keys(Or).length+1).toString(10);J.id=Ce,zm[P]=Ce,Or[Ce]=J,Nr.publish("addPattern",J)}};E.ShadingPattern=Fm,E.TilingPattern=K0,E.addShadingPattern=function(P,J){return Te("addShadingPattern()"),Nl(P,J),this},E.beginTilingPattern=function(P){Te("beginTilingPattern()"),GS(P.boundingBox[0],P.boundingBox[1],P.boundingBox[2]-P.boundingBox[0],P.boundingBox[3]-P.boundingBox[1],P.matrix)},E.endTilingPattern=function(P,J){Te("endTilingPattern()"),J.stream=Gt[ve].join("\n"),Nl(P,J),Nr.publish("endTilingPattern",J),Ed.pop().restore()};var qs=E.__private__.newObject=function(){var P=As();return cc(P,!0),P},As=E.__private__.newObjectDeferred=function(){return Ze++,it[Ze]=function(){return pt},Ze},cc=function(P,J){return J="boolean"==typeof J&&J,it[P]=pt,J&&ke(P+" 0 obj"),P},a_=E.__private__.newAdditionalObject=function(){var P={objId:As(),content:""};return qt.push(P),P},Sf=As(),Ou=As(),Nu=E.__private__.decodeColorString=function(P){var J=P.split(" ");if(2!==J.length||"g"!==J[1]&&"G"!==J[1])5===J.length&&("k"===J[4]||"K"===J[4])&&(J=[(1-J[0])*(1-J[3]),(1-J[1])*(1-J[3]),(1-J[2])*(1-J[3]),"r"]);else{var Ce=parseFloat(J[0]);J=[Ce,Ce,Ce,"r"]}for(var Le="#",nt=0;nt<3;nt++)Le+=("0"+Math.floor(255*parseFloat(J[nt])).toString(16)).slice(-2);return Le},Lu=E.__private__.encodeColorString=function(P){var J;"string"==typeof P&&(P={ch1:P});var Ce=P.ch1,Le=P.ch2,nt=P.ch3,Dt=P.ch4,$t="draw"===P.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof Ce&&"#"!==Ce.charAt(0)){var wn=new RR(Ce);if(wn.ok)Ce=wn.toHex();else if(!/^\d*\.?\d*$/.test(Ce))throw new Error('Invalid color "'+Ce+'" passed to jsPDF.encodeColorString.')}if("string"==typeof Ce&&/^#[0-9A-Fa-f]{3}$/.test(Ce)&&(Ce="#"+Ce[1]+Ce[1]+Ce[2]+Ce[2]+Ce[3]+Ce[3]),"string"==typeof Ce&&/^#[0-9A-Fa-f]{6}$/.test(Ce)){var Gn=parseInt(Ce.substr(1),16);Ce=Gn>>16&255,Le=Gn>>8&255,nt=255&Gn}if(void 0===Le||void 0===Dt&&Ce===Le&&Le===nt)J="string"==typeof Ce?Ce+" "+$t[0]:2===P.precision?vt(Ce/255)+" "+$t[0]:fe(Ce/255)+" "+$t[0];else if(void 0===Dt||"object"===$r(Dt)){if(Dt&&!isNaN(Dt.a)&&0===Dt.a)return["1.","1.","1.",$t[1]].join(" ");J="string"==typeof Ce?[Ce,Le,nt,$t[1]].join(" "):2===P.precision?[vt(Ce/255),vt(Le/255),vt(nt/255),$t[1]].join(" "):[fe(Ce/255),fe(Le/255),fe(nt/255),$t[1]].join(" ")}else J="string"==typeof Ce?[Ce,Le,nt,Dt,$t[2]].join(" "):2===P.precision?[vt(Ce),vt(Le),vt(nt),vt(Dt),$t[2]].join(" "):[fe(Ce),fe(Le),fe(nt),fe(Dt),$t[2]].join(" ");return J},Dd=E.__private__.getFilters=function(){return c},qc=E.__private__.putStream=function(P){var J=(P=P||{}).data||"",Ce=P.filters||Dd(),Le=P.alreadyAppliedFilters||[],nt=P.addLength1||!1,Dt=J.length,$t=P.objectId,wn=function(qa){return qa};if(null!==x&&void 0===$t)throw new Error("ObjectId must be passed to putStream for file encryption");null!==x&&(wn=Wa.encryptor($t,0));var Gn={};!0===Ce&&(Ce=["FlateEncode"]);var Ii=P.additionalKeyValues||[],Ui=(Gn=void 0!==ei.API.processDataByFilters?ei.API.processDataByFilters(J,Ce):{data:J,reverseChain:[]}).reverseChain+(Array.isArray(Le)?Le.join(" "):Le.toString());if(0!==Gn.data.length&&(Ii.push({key:"Length",value:Gn.data.length}),!0===nt&&Ii.push({key:"Length1",value:Dt})),0!=Ui.length)if(Ui.split("/").length-1==1)Ii.push({key:"Filter",value:Ui});else{Ii.push({key:"Filter",value:"["+Ui+"]"});for(var pr=0;pr<Ii.length;pr+=1)if("DecodeParms"===Ii[pr].key){for(var Bo=[],Qo=0;Qo<Gn.reverseChain.split("/").length-1;Qo+=1)Bo.push("null");Bo.push(Ii[pr].value),Ii[pr].value="["+Bo.join(" ")+"]"}}ke("<<");for(var Ms=0;Ms<Ii.length;Ms++)ke("/"+Ii[Ms].key+" "+Ii[Ms].value);ke(">>"),0!==Gn.data.length&&(ke("stream"),ke(wn(Gn.data)),ke("endstream"))},Id=E.__private__.putPage=function(P){var J=P.number,Ce=P.data,Le=P.objId,nt=P.contentsObjId;cc(Le,!0),ke("<</Type /Page"),ke("/Parent "+P.rootDictionaryObjId+" 0 R"),ke("/Resources "+P.resourceDictionaryObjId+" 0 R"),ke("/MediaBox ["+parseFloat(Ge(P.mediaBox.bottomLeftX))+" "+parseFloat(Ge(P.mediaBox.bottomLeftY))+" "+Ge(P.mediaBox.topRightX)+" "+Ge(P.mediaBox.topRightY)+"]"),null!==P.cropBox&&ke("/CropBox ["+Ge(P.cropBox.bottomLeftX)+" "+Ge(P.cropBox.bottomLeftY)+" "+Ge(P.cropBox.topRightX)+" "+Ge(P.cropBox.topRightY)+"]"),null!==P.bleedBox&&ke("/BleedBox ["+Ge(P.bleedBox.bottomLeftX)+" "+Ge(P.bleedBox.bottomLeftY)+" "+Ge(P.bleedBox.topRightX)+" "+Ge(P.bleedBox.topRightY)+"]"),null!==P.trimBox&&ke("/TrimBox ["+Ge(P.trimBox.bottomLeftX)+" "+Ge(P.trimBox.bottomLeftY)+" "+Ge(P.trimBox.topRightX)+" "+Ge(P.trimBox.topRightY)+"]"),null!==P.artBox&&ke("/ArtBox ["+Ge(P.artBox.bottomLeftX)+" "+Ge(P.artBox.bottomLeftY)+" "+Ge(P.artBox.topRightX)+" "+Ge(P.artBox.topRightY)+"]"),"number"==typeof P.userUnit&&1!==P.userUnit&&ke("/UserUnit "+P.userUnit),Nr.publish("putPage",{objId:Le,pageContext:wi[J],pageNumber:J,page:Ce}),ke("/Contents "+nt+" 0 R"),ke(">>"),ke("endobj");var Dt=Ce.join("\n");return ce===Y.ADVANCED&&(Dt+="\nQ"),cc(nt,!0),qc({data:Dt,filters:Dd(),objectId:nt}),ke("endobj"),Le},Wm=E.__private__.putPages=function(){var P,J,Ce=[];for(P=1;P<=Xo;P++)wi[P].objId=As(),wi[P].contentsObjId=As();for(P=1;P<=Xo;P++)Ce.push(Id({number:P,data:Gt[P],objId:wi[P].objId,contentsObjId:wi[P].contentsObjId,mediaBox:wi[P].mediaBox,cropBox:wi[P].cropBox,bleedBox:wi[P].bleedBox,trimBox:wi[P].trimBox,artBox:wi[P].artBox,userUnit:wi[P].userUnit,rootDictionaryObjId:Sf,resourceDictionaryObjId:Ou}));cc(Sf,!0),ke("<</Type /Pages");var Le="/Kids [";for(J=0;J<Xo;J++)Le+=Ce[J]+" 0 R ";ke(Le+"]"),ke("/Count "+Xo),ke(">>"),ke("endobj"),Nr.publish("postPutPages")},l_=function(P){Nr.publish("putFont",{font:P,out:ke,newObject:qs,putStream:qc}),!0!==P.isAlreadyPutted&&(P.objectNumber=qs(),ke("<<"),ke("/Type /Font"),ke("/BaseFont /"+G0(P.postScriptName)),ke("/Subtype /Type1"),"string"==typeof P.encoding&&ke("/Encoding /"+P.encoding),ke("/FirstChar 32"),ke("/LastChar 255"),ke(">>"),ke("endobj"))},c_=function(){for(var P in so)so.hasOwnProperty(P)&&(!1===S||!0===S&&M.hasOwnProperty(P))&&l_(so[P])},u_=function(P){P.objectNumber=qs();var J=[];J.push({key:"Type",value:"/XObject"}),J.push({key:"Subtype",value:"/Form"}),J.push({key:"BBox",value:"["+[Ge(P.x),Ge(P.y),Ge(P.x+P.width),Ge(P.y+P.height)].join(" ")+"]"}),J.push({key:"Matrix",value:"["+P.matrix.toString()+"]"});var Ce=P.pages[1].join("\n");qc({data:Ce,additionalKeyValues:J,objectId:P.objectNumber}),ke("endobj")},d_=function(){for(var P in ka)ka.hasOwnProperty(P)&&u_(ka[P])},IS=function(P,J){var Ce,Le=[],nt=1/(J-1);for(Ce=0;Ce<1;Ce+=nt)Le.push(Ce);Le.push(1),0!=P[0].offset&&P.unshift({offset:0,color:P[0].color}),1!=P[P.length-1].offset&&P.push({offset:1,color:P[P.length-1].color});for(var wn="",Gn=0,Ii=0;Ii<Le.length;Ii++){for(Ce=Le[Ii];Ce>P[Gn+1].offset;)Gn++;var Ui=P[Gn].offset,pr=(Ce-Ui)/(P[Gn+1].offset-Ui),Bo=P[Gn].color,Qo=P[Gn+1].color;wn+=je(Math.round((1-pr)*Bo[0]+pr*Qo[0]).toString(16))+je(Math.round((1-pr)*Bo[1]+pr*Qo[1]).toString(16))+je(Math.round((1-pr)*Bo[2]+pr*Qo[2]).toString(16))}return wn.trim()},$M=function(P,J){J||(J=21);var Ce=qs(),Le=IS(P.colors,J),nt=[];nt.push({key:"FunctionType",value:"0"}),nt.push({key:"Domain",value:"[0.0 1.0]"}),nt.push({key:"Size",value:"["+J+"]"}),nt.push({key:"BitsPerSample",value:"8"}),nt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),nt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qc({data:Le,additionalKeyValues:nt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ce}),ke("endobj"),P.objectNumber=qs(),ke("<< /ShadingType "+P.type),ke("/ColorSpace /DeviceRGB");var Dt="/Coords ["+Ge(parseFloat(P.coords[0]))+" "+Ge(parseFloat(P.coords[1]))+" ";Dt+=2===P.type?Ge(parseFloat(P.coords[2]))+" "+Ge(parseFloat(P.coords[3])):Ge(parseFloat(P.coords[2]))+" "+Ge(parseFloat(P.coords[3]))+" "+Ge(parseFloat(P.coords[4]))+" "+Ge(parseFloat(P.coords[5])),ke(Dt+="]"),P.matrix&&ke("/Matrix ["+P.matrix.toString()+"]"),ke("/Function "+Ce+" 0 R"),ke("/Extend [true true]"),ke(">>"),ke("endobj")},WM=function(P,J){var Ce=As(),Le=qs();J.push({resourcesOid:Ce,objectOid:Le}),P.objectNumber=Le;var nt=[];nt.push({key:"Type",value:"/Pattern"}),nt.push({key:"PatternType",value:"1"}),nt.push({key:"PaintType",value:"1"}),nt.push({key:"TilingType",value:"1"}),nt.push({key:"BBox",value:"["+P.boundingBox.map(Ge).join(" ")+"]"}),nt.push({key:"XStep",value:Ge(P.xStep)}),nt.push({key:"YStep",value:Ge(P.yStep)}),nt.push({key:"Resources",value:Ce+" 0 R"}),P.matrix&&nt.push({key:"Matrix",value:"["+P.matrix.toString()+"]"}),qc({data:P.stream,additionalKeyValues:nt,objectId:P.objectNumber}),ke("endobj")},f_=function(P){var J;for(J in Or)Or.hasOwnProperty(J)&&(Or[J]instanceof Fm?$M(Or[J]):Or[J]instanceof K0&&WM(Or[J],P))},AS=function(P){for(var J in P.objectNumber=qs(),ke("<<"),P)switch(J){case"opacity":ke("/ca "+vt(P[J]));break;case"stroke-opacity":ke("/CA "+vt(P[J]))}ke(">>"),ke("endobj")},qM=function(){var P;for(P in Yo)Yo.hasOwnProperty(P)&&AS(Yo[P])},ab=function(){for(var P in ke("/XObject <<"),ka)ka.hasOwnProperty(P)&&ka[P].objectNumber>=0&&ke("/"+P+" "+ka[P].objectNumber+" 0 R");Nr.publish("putXobjectDict"),ke(">>")},GM=function(){Wa.oid=qs(),ke("<<"),ke("/Filter /Standard"),ke("/V "+Wa.v),ke("/R "+Wa.r),ke("/U <"+Wa.toHexString(Wa.U)+">"),ke("/O <"+Wa.toHexString(Wa.O)+">"),ke("/P "+Wa.P),ke(">>"),ke("endobj")},MS=function(){for(var P in ke("/Font <<"),so)so.hasOwnProperty(P)&&(!1===S||!0===S&&M.hasOwnProperty(P))&&ke("/"+P+" "+so[P].objectNumber+" 0 R");ke(">>")},KM=function(){if(Object.keys(Or).length>0){for(var P in ke("/Shading <<"),Or)Or.hasOwnProperty(P)&&Or[P]instanceof Fm&&Or[P].objectNumber>=0&&ke("/"+P+" "+Or[P].objectNumber+" 0 R");Nr.publish("putShadingPatternDict"),ke(">>")}},p_=function(P){if(Object.keys(Or).length>0){for(var J in ke("/Pattern <<"),Or)Or.hasOwnProperty(J)&&Or[J]instanceof E.TilingPattern&&Or[J].objectNumber>=0&&Or[J].objectNumber<P&&ke("/"+J+" "+Or[J].objectNumber+" 0 R");Nr.publish("putTilingPatternDict"),ke(">>")}},YM=function(){if(Object.keys(Yo).length>0){var P;for(P in ke("/ExtGState <<"),Yo)Yo.hasOwnProperty(P)&&Yo[P].objectNumber>=0&&ke("/"+P+" "+Yo[P].objectNumber+" 0 R");Nr.publish("putGStateDict"),ke(">>")}},gs=function(P){cc(P.resourcesOid,!0),ke("<<"),ke("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),MS(),KM(),p_(P.objectOid),YM(),ab(),ke(">>"),ke("endobj")},FS=function(){var P=[];c_(),qM(),d_(),f_(P),Nr.publish("putResources"),P.forEach(gs),gs({resourcesOid:Ou,objectOid:Number.MAX_SAFE_INTEGER}),Nr.publish("postPutResources")},PS=function(){Nr.publish("putAdditionalObjects");for(var P=0;P<qt.length;P++){var J=qt[P];cc(J.objId,!0),ke(J.content),ke("endobj")}Nr.publish("postPutAdditionalObjects")},OS=function(P){ko[P.fontName]=ko[P.fontName]||{},ko[P.fontName][P.fontStyle]=P.id},lb=function(P,J,Ce,Le,nt){var Dt={id:"F"+(Object.keys(so).length+1).toString(10),postScriptName:P,fontName:J,fontStyle:Ce,encoding:Le,isStandardFont:nt||!1,metadata:{}};return Nr.publish("addFont",{font:Dt,instance:this}),so[Dt.id]=Dt,OS(Dt),Dt.id},XM=function(P){for(var J=0,Ce=Kt.length;J<Ce;J++){var Le=lb.call(this,P[J][0],P[J][1],P[J][2],Kt[J][3],!0);!1===S&&(M[Le]=!0);var nt=P[J][0].split("-");OS({id:Le,fontName:nt[0],fontStyle:nt[1]||""})}Nr.publish("addFonts",{fonts:so,dictionary:ko})},Ru=function(P){return P.foo=function(){try{return P.apply(this,arguments)}catch(Le){var J=Le.stack||"";~J.indexOf(" at ")&&(J=J.split(" at ")[1]);var Ce="Error in function "+J.split("\n")[0].split("<")[0]+": "+Le.message;if(!ri.console)throw new Error(Ce);ri.console.error(Ce,Le),ri.alert&&alert(Ce)}},P.foo.bar=P,P.foo},h_=function(P,J){var Ce,Le,nt,Dt,$t,wn,Gn,Ii,Ui;if(nt=(J=J||{}).sourceEncoding||"Unicode",$t=J.outputEncoding,(J.autoencode||$t)&&so[er].metadata&&so[er].metadata[nt]&&so[er].metadata[nt].encoding&&(Dt=so[er].metadata[nt].encoding,!$t&&so[er].encoding&&($t=so[er].encoding),!$t&&Dt.codePages&&($t=Dt.codePages[0]),"string"==typeof $t&&($t=Dt[$t]),$t)){for(Gn=!1,wn=[],Ce=0,Le=P.length;Ce<Le;Ce++)(Ii=$t[P.charCodeAt(Ce)])?wn.push(String.fromCharCode(Ii)):wn.push(P[Ce]),wn[Ce].charCodeAt(0)>>8&&(Gn=!0);P=wn.join("")}for(Ce=P.length;void 0===Gn&&0!==Ce;)P.charCodeAt(Ce-1)>>8&&(Gn=!0),Ce--;if(!Gn)return P;for(wn=J.noBOM?[]:[254,255],Ce=0,Le=P.length;Ce<Le;Ce++){if((Ui=(Ii=P.charCodeAt(Ce))>>8)>>8)throw new Error("Character at position "+Ce+" of string '"+P+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");wn.push(Ui),wn.push(Ii-(Ui<<8))}return String.fromCharCode.apply(void 0,wn)},Ll=E.__private__.pdfEscape=E.pdfEscape=function(P,J){return h_(P,J).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},cb=E.__private__.beginPage=function(P){Gt[++Xo]=[],wi[Xo]={objId:0,contentsObjId:0,userUnit:Number(u),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(P[0]),topRightY:Number(P[1])}},LS(Xo),At(Gt[ve])},NS=function(P,J){var Ce,Le,nt;switch(e=J||e,"string"==typeof P&&(Ce=q(P.toLowerCase()),Array.isArray(Ce)&&(Le=Ce[0],nt=Ce[1])),Array.isArray(P)&&(Le=P[0]*bn,nt=P[1]*bn),isNaN(Le)&&(Le=r[0],nt=r[1]),(Le>14400||nt>14400)&&(ro.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Le=Math.min(14400,Le),nt=Math.min(14400,nt)),r=[Le,nt],e.substr(0,1)){case"l":nt>Le&&(r=[nt,Le]);break;case"p":Le>nt&&(r=[nt,Le])}cb(r),HS(pb),ke(Bu),0!==mb&&ke(mb+" J"),0!==gb&&ke(gb+" j"),Nr.publish("addPage",{pageNumber:Xo})},QM=function(P){P>0&&P<=Xo&&(Gt.splice(P,1),wi.splice(P,1),Xo--,ve>Xo&&(ve=Xo),this.setPage(ve))},LS=function(P){P>0&&P<=Xo&&(ve=P)},JM=E.__private__.getNumberOfPages=E.getNumberOfPages=function(){return Gt.length-1},RS=function(P,J,Ce){var Le,nt=void 0;return Ce=Ce||{},J=void 0!==J?J:so[er].fontStyle,Le=(P=void 0!==P?P:so[er].fontName).toLowerCase(),void 0!==ko[Le]&&void 0!==ko[Le][J]?nt=ko[Le][J]:void 0!==ko[P]&&void 0!==ko[P][J]?nt=ko[P][J]:!1===Ce.disableWarning&&ro.warn("Unable to look up font label for font '"+P+"', '"+J+"'. Refer to getFontList() for available fonts."),nt||Ce.noFallback||null==(nt=ko.times[J])&&(nt=ko.times.normal),nt},ZM=E.__private__.putInfo=function(){var P=qs(),J=function(Le){return Le};for(var Ce in null!==x&&(J=Wa.encryptor(P,0)),ke("<<"),ke("/Producer ("+Ll(J("jsPDF "+ei.version))+")"),di)di.hasOwnProperty(Ce)&&di[Ce]&&ke("/"+Ce.substr(0,1).toUpperCase()+Ce.substr(1)+" ("+Ll(J(di[Ce]))+")");ke("/CreationDate ("+Ll(J(Ct))+")"),ke(">>"),ke("endobj")},ub=E.__private__.putCatalog=function(P){var J=(P=P||{}).rootDictionaryObjId||Sf;switch(qs(),ke("<<"),ke("/Type /Catalog"),ke("/Pages "+J+" 0 R"),yn||(yn="fullwidth"),yn){case"fullwidth":ke("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ke("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ke("/OpenAction [3 0 R /Fit]");break;case"original":ke("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ce=""+yn;"%"===Ce.substr(Ce.length-1)&&(yn=parseInt(yn)/100),"number"==typeof yn&&ke("/OpenAction [3 0 R /XYZ null null "+vt(yn)+"]")}switch(Ki||(Ki="continuous"),Ki){case"continuous":ke("/PageLayout /OneColumn");break;case"single":ke("/PageLayout /SinglePage");break;case"two":case"twoleft":ke("/PageLayout /TwoColumnLeft");break;case"tworight":ke("/PageLayout /TwoColumnRight")}xi&&ke("/PageMode /"+xi),Nr.publish("putCatalog"),ke(">>"),ke("endobj")},eF=E.__private__.putTrailer=function(){ke("trailer"),ke("<<"),ke("/Size "+(Ze+1)),ke("/Root "+Ze+" 0 R"),ke("/Info "+(Ze-1)+" 0 R"),null!==x&&ke("/Encrypt "+Wa.oid+" 0 R"),ke("/ID [ <"+Re+"> <"+Re+"> ]"),ke(">>")},tF=E.__private__.putHeader=function(){ke("%PDF-"+R),ke("%\xba\xdf\xac\xe0")},nF=E.__private__.putXRef=function(){var P="0000000000";ke("xref"),ke("0 "+(Ze+1)),ke("0000000000 65535 f ");for(var J=1;J<=Ze;J++)ke("function"==typeof it[J]?(P+it[J]()).slice(-10)+" 00000 n ":void 0!==it[J]?(P+it[J]).slice(-10)+" 00000 n ":"0000000000 00000 n ")},Ef=E.__private__.buildDocument=function(){oi(),At(ct),Nr.publish("buildDocument"),tF(),Wm(),PS(),FS(),null!==x&&GM(),ZM(),ub();var P=pt;return nF(),eF(),ke("startxref"),ke(""+P),ke("%%EOF"),At(Gt[ve]),ct.join("\n")},m_=E.__private__.getBlob=function(P){return new Blob([Rn(P)],{type:"application/pdf"})},g_=E.output=E.__private__.output=Ru(function(P,J){switch("string"==typeof(J=J||{})?J={filename:J}:J.filename=J.filename||"generated.pdf",P){case void 0:return Ef();case"save":E.save(J.filename);break;case"arraybuffer":return Rn(Ef());case"blob":return m_(Ef());case"bloburi":case"bloburl":if(void 0!==ri.URL&&"function"==typeof ri.URL.createObjectURL)return ri.URL&&ri.URL.createObjectURL(m_(Ef()))||void 0;ro.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ce="",Le=Ef();try{Ce=UA(Le)}catch(Qo){Ce=UA(unescape(encodeURIComponent(Le)))}return"data:application/pdf;filename="+J.filename+";base64,"+Ce;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(ri)){var nt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Dt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';J.pdfObjectUrl&&(nt=J.pdfObjectUrl,Dt="");var $t='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+nt+'"'+Dt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(J)+");<\/script></body></html>",wn=ri.open();return null!==wn&&wn.document.write($t),wn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(ri)){var Gn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(J.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+J.filename+'" width="500px" height="400px" /></body></html>',Ii=ri.open();if(null!==Ii){Ii.document.write(Gn);var Ui=this;Ii.document.documentElement.querySelector("#pdfViewer").onload=function(){Ii.document.title=J.filename,Ii.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ui.output("bloburl"))}}return Ii}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(ri))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var pr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",J)+'"></iframe></body></html>',Bo=ri.open();if(null!==Bo&&(Bo.document.write(pr),Bo.document.title=J.filename),Bo||"undefined"==typeof safari)return Bo;break;case"datauri":case"dataurl":return ri.document.location.href=this.output("datauristring",J);default:return null}}),BS=function(P){return!0===Array.isArray($m)&&$m.indexOf(P)>-1};switch(n){case"pt":bn=1;break;case"mm":bn=72/25.4;break;case"cm":bn=72/2.54;break;case"in":bn=72;break;case"px":bn=1==BS("px_scaling")?.75:96/72;break;case"pc":case"em":bn=12;break;case"ex":bn=6;break;default:if("number"!=typeof n)throw new Error("Invalid unit: "+n);bn=n}var Wa=null;on(),Ue();var iF=function(P){return null!==x?Wa.encryptor(P,0):function(J){return J}},jS=E.__private__.getPageInfo=E.getPageInfo=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:wi[P].objId,pageNumber:P,pageContext:wi[P]}},vi=E.__private__.getPageInfoByObjId=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var J in wi)if(wi[J].objId===P)break;return jS(J)},rF=E.__private__.getCurrentPageInfo=E.getCurrentPageInfo=function(){return{objId:wi[ve].objId,pageNumber:ve,pageContext:wi[ve]}};E.addPage=function(){return NS.apply(this,arguments),this},E.setPage=function(){return LS.apply(this,arguments),At.call(this,Gt[ve]),this},E.insertPage=function(P){return this.addPage(),this.movePage(ve,P),this},E.movePage=function(P,J){var Ce,Le;if(P>J){Ce=Gt[P],Le=wi[P];for(var nt=P;nt>J;nt--)Gt[nt]=Gt[nt-1],wi[nt]=wi[nt-1];Gt[J]=Ce,wi[J]=Le,this.setPage(J)}else if(P<J){Ce=Gt[P],Le=wi[P];for(var Dt=P;Dt<J;Dt++)Gt[Dt]=Gt[Dt+1],wi[Dt]=wi[Dt+1];Gt[J]=Ce,wi[J]=Le,this.setPage(J)}return this},E.deletePage=function(){return QM.apply(this,arguments),this},E.__private__.text=E.text=function(P,J,Ce,Le,nt){var Dt,$t,wn,Gn,Ii,Ui,pr,Bo,Qo,Ms=(Le=Le||{}).scope||this;if("number"==typeof P&&"number"==typeof J&&("string"==typeof Ce||Array.isArray(Ce))){var qa=Ce;Ce=J,J=P,P=qa}if(arguments[3]instanceof ti?(Te("The transform parameter of text() with a Matrix value"),Qo=nt):(wn=arguments[4],Gn=arguments[5],"object"===$r(pr=arguments[3])&&null!==pr||("string"==typeof wn&&(Gn=wn,wn=null),"string"==typeof pr&&(Gn=pr,pr=null),"number"==typeof pr&&(wn=pr,pr=null),Le={flags:pr,angle:wn,align:Gn})),isNaN(J)||isNaN(Ce)||null==P)throw new Error("Invalid arguments passed to jsPDF.text");if(0===P.length)return Ms;var ca="",ju=!1,uc="number"==typeof Le.lineHeightFactor?Le.lineHeightFactor:Gm,Df=Ms.internal.scaleFactor;function KS(go){return go=go.split("\t").join(Array(Le.TabLen||9).join(" ")),Ll(go,pr)}function xb(go){for(var _o,_s=go.concat(),Gs=[],Ff=_s.length;Ff--;)"string"==typeof(_o=_s.shift())?Gs.push(_o):Array.isArray(go)&&(1===_o.length||void 0===_o[1]&&void 0===_o[2])?Gs.push(_o[0]):Gs.push([_o[0],_o[1],_o[2]]);return Gs}function wb(go,_o){var _s;if("string"==typeof go)_s=_o(go)[0];else if(Array.isArray(go)){for(var Gs,Ff,sh=go.concat(),A_=[],XS=sh.length;XS--;)"string"==typeof(Gs=sh.shift())?A_.push(_o(Gs)[0]):Array.isArray(Gs)&&"string"==typeof Gs[0]&&(Ff=_o(Gs[0],Gs[1],Gs[2]),A_.push([Ff[0],Ff[1],Ff[2]]));_s=A_}return _s}var w_=!1,Cb=!0;if("string"==typeof P)w_=!0;else if(Array.isArray(P)){var Tb=P.concat();$t=[];for(var C_,Rl=Tb.length;Rl--;)("string"!=typeof(C_=Tb.shift())||Array.isArray(C_)&&"string"!=typeof C_[0])&&(Cb=!1);w_=Cb}if(!1===w_)throw new Error('Type of text must be string or Array. "'+P+'" is not recognized.');"string"==typeof P&&(P=P.match(/[\r?\n]/)?P.split(/\r\n|\r|\n/g):[P]);var T_=cn/Ms.internal.scaleFactor,S_=T_*(uc-1);switch(Le.baseline){case"bottom":Ce-=S_;break;case"top":Ce+=T_-S_;break;case"hanging":Ce+=T_-2*S_;break;case"middle":Ce+=T_/2-S_}if((Ui=Le.maxWidth||0)>0&&("string"==typeof P?P=Ms.splitTextToSize(P,Ui):"[object Array]"===Object.prototype.toString.call(P)&&(P=P.reduce(function(go,_o){return go.concat(Ms.splitTextToSize(_o,Ui))},[]))),Nr.publish("preProcessText",Dt={text:P,x:J,y:Ce,options:Le,mutex:{pdfEscape:Ll,activeFontKey:er,fonts:so,activeFontSize:cn}}),P=Dt.text,wn=(Le=Dt.options).angle,Qo instanceof ti||!wn||"number"!=typeof wn)wn&&wn instanceof ti&&(Qo=wn);else{wn*=Math.PI/180,0===Le.rotationDirection&&(wn=-wn),ce===Y.ADVANCED&&(wn=-wn);var E_=Math.cos(wn),Sb=Math.sin(wn);Qo=new ti(E_,Sb,-Sb,E_,0,0)}ce!==Y.ADVANCED||Qo||(Qo=kd),void 0!==(Ii=Le.charSpace||y_)&&(ca+=Ge(de(Ii))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(Bo=Le.horizontalScale)&&(ca+=Ge(100*Bo)+" Tz\n");var Bl=-1,hF=void 0!==Le.renderingMode?Le.renderingMode:Le.stroke,Eb=Ms.internal.getCurrentPageInfo().pageContext;switch(hF){case 0:case!1:case"fill":Bl=0;break;case 1:case!0:case"stroke":Bl=1;break;case 2:case"fillThenStroke":Bl=2;break;case 3:case"invisible":Bl=3;break;case 4:case"fillAndAddForClipping":Bl=4;break;case 5:case"strokeAndAddPathForClipping":Bl=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Bl=6;break;case 7:case"addToPathForClipping":Bl=7}var YS=void 0!==Eb.usedRenderingMode?Eb.usedRenderingMode:-1;-1!==Bl?ca+=Bl+" Tr\n":-1!==YS&&(ca+="0 Tr\n"),-1!==Bl&&(Eb.usedRenderingMode=Bl),Gn=Le.align||"left";var Vu,kb=cn*uc,mF=Ms.internal.pageSize.getWidth(),gF=so[er];Ii=Le.charSpace||y_,Ui=Le.maxWidth||0,pr=Object.assign({autoencode:!0,noBOM:!0},Le.flags);var nh=[];if("[object Array]"===Object.prototype.toString.call(P)){var Gc;$t=xb(P),"left"!==Gn&&(Vu=$t.map(function(go){return Ms.getStringUnitWidth(go,{font:gF,charSpace:Ii,fontSize:cn,doKerning:!1})*cn/Df}));var Uu,ih=0;if("right"===Gn){J-=Vu[0],P=[],Rl=$t.length;for(var Md=0;Md<Rl;Md++)0===Md?(Uu=kf(J),Gc=Zp(Ce)):(Uu=de(ih-Vu[Md]),Gc=-kb),P.push([$t[Md],Uu,Gc]),ih=Vu[Md]}else if("center"===Gn){J-=Vu[0]/2,P=[],Rl=$t.length;for(var If=0;If<Rl;If++)0===If?(Uu=kf(J),Gc=Zp(Ce)):(Uu=de((ih-Vu[If])/2),Gc=-kb),P.push([$t[If],Uu,Gc]),ih=Vu[If]}else if("left"===Gn){P=[],Rl=$t.length;for(var k_=0;k_<Rl;k_++)P.push($t[k_])}else{if("justify"!==Gn)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');P=[],Rl=$t.length,Ui=0!==Ui?Ui:mF;for(var Hu=0;Hu<Rl;Hu++)Gc=0===Hu?Zp(Ce):-kb,Uu=0===Hu?kf(J):0,nh.push(Hu<Rl-1?Ge(de((Ui-Vu[Hu])/($t[Hu].split(" ").length-1))):0),P.push([$t[Hu],Uu,Gc])}}var D_="boolean"==typeof Le.R2L?Le.R2L:$n;!0===D_&&(P=wb(P,function(go,_o,_s){return[go.split("").reverse().join(""),_o,_s]})),Nr.publish("postProcessText",Dt={text:P,x:J,y:Ce,options:Le,mutex:{pdfEscape:Ll,activeFontKey:er,fonts:so,activeFontSize:cn}}),P=Dt.text,ju=Dt.mutex.isHex||!1;var Db=so[er].encoding;"WinAnsiEncoding"!==Db&&"StandardEncoding"!==Db||(P=wb(P,function(go,_o,_s){return[KS(go),_o,_s]})),$t=xb(P),P=[];for(var rh,zu,Af,Xm=0,I_=1,Qm=Array.isArray($t[0])?I_:Xm,oh="",Ib=function(go,_o,_s){var Gs="";return _s instanceof ti?(_s="number"==typeof Le.angle?Pu(_s,new ti(1,0,0,1,go,_o)):Pu(new ti(1,0,0,1,go,_o),_s),ce===Y.ADVANCED&&(_s=Pu(new ti(1,0,0,-1,0,0),_s)),Gs=_s.join(" ")+" Tm\n"):Gs=Ge(go)+" "+Ge(_o)+" Td\n",Gs},Kc=0;Kc<$t.length;Kc++){switch(oh="",Qm){case I_:Af=(ju?"<":"(")+$t[Kc][0]+(ju?">":")"),rh=parseFloat($t[Kc][1]),zu=parseFloat($t[Kc][2]);break;case Xm:Af=(ju?"<":"(")+$t[Kc]+(ju?">":")"),rh=kf(J),zu=Zp(Ce)}void 0!==nh&&void 0!==nh[Kc]&&(oh=nh[Kc]+" Tw\n"),0===Kc?P.push(oh+Ib(rh,zu,Qo)+Af):Qm===Xm?P.push(oh+Af):Qm===I_&&P.push(oh+Ib(rh,zu,Qo)+Af)}P=P.join(Qm===Xm?" Tj\nT* ":" Tj\n"),P+=" Tj\n";var Mf="BT\n/";return Mf+=er+" "+cn+" Tf\n",Mf+=Ge(cn*uc)+" TL\n",Mf+=Km+"\n",Mf+=ca,Mf+=P,ke(Mf+="ET"),M[er]=!0,Ms};var oF=E.__private__.clip=E.clip=function(P){return ke("evenodd"===P?"W*":"W"),this};E.clipEvenOdd=function(){return oF("evenodd")},E.__private__.discardPath=E.discardPath=function(){return ke("n"),this};var Ad=E.__private__.isValidStyle=function(P){var J=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(P)&&(J=!0),J};E.__private__.setDefaultPathOperation=E.setDefaultPathOperation=function(P){return Ad(P)&&(g=P),this};var VS=E.__private__.getStyle=E.getStyle=function(P){var J=g;switch(P){case"D":case"S":J="S";break;case"F":J="f";break;case"FD":case"DF":J="B";break;case"f":case"f*":case"B":case"B*":J=P}return J},US=E.close=function(){return ke("h"),this};E.stroke=function(){return ke("S"),this},E.fill=function(P){return __("f",P),this},E.fillEvenOdd=function(P){return __("f*",P),this},E.fillStroke=function(P){return __("B",P),this},E.fillStrokeEvenOdd=function(P){return __("B*",P),this};var __=function(P,J){"object"===$r(J)?aF(J,P):ke(P)},db=function(P){null===P||ce===Y.ADVANCED&&void 0===P||(P=VS(P),ke(P))};function sF(P,J,Ce,Le,nt){var Dt=new K0(J||this.boundingBox,Ce||this.xStep,Le||this.yStep,this.gState,nt||this.matrix);Dt.stream=this.stream;var $t=P+"$$"+this.cloneIndex+++"$$";return Nl($t,Dt),Dt}var aF=function(P,J){var Ce=zm[P.key],Le=Or[Ce];if(Le instanceof Fm)ke("q"),ke(lF(J)),Le.gState&&E.setGState(Le.gState),ke(P.matrix.toString()+" cm"),ke("/"+Ce+" sh"),ke("Q");else if(Le instanceof K0){var nt=new ti(1,0,0,-1,0,th());P.matrix&&(nt=nt.multiply(P.matrix||kd),Ce=sF.call(Le,P.key,P.boundingBox,P.xStep,P.yStep,nt).id),ke("q"),ke("/Pattern cs"),ke("/"+Ce+" scn"),Le.gState&&E.setGState(Le.gState),ke(J),ke("Q")}},lF=function(P){switch(P){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},fb=E.moveTo=function(P,J){return ke(Ge(de(P))+" "+Ge(Ae(J))+" m"),this},qm=E.lineTo=function(P,J){return ke(Ge(de(P))+" "+Ge(Ae(J))+" l"),this},Jp=E.curveTo=function(P,J,Ce,Le,nt,Dt){return ke([Ge(de(P)),Ge(Ae(J)),Ge(de(Ce)),Ge(Ae(Le)),Ge(de(nt)),Ge(Ae(Dt)),"c"].join(" ")),this};E.__private__.line=E.line=function(P,J,Ce,Le,nt){if(isNaN(P)||isNaN(J)||isNaN(Ce)||isNaN(Le)||!Ad(nt))throw new Error("Invalid arguments passed to jsPDF.line");return ce===Y.COMPAT?this.lines([[Ce-P,Le-J]],P,J,[1,1],nt||"S"):this.lines([[Ce-P,Le-J]],P,J,[1,1]).stroke()},E.__private__.lines=E.lines=function(P,J,Ce,Le,nt,Dt){var $t,wn,Gn,Ii,Ui,qa,ca,ju;if("number"==typeof P&&(ju=Ce,Ce=J,J=P,P=ju),Le=Le||[1,1],Dt=Dt||!1,isNaN(J)||isNaN(Ce)||!Array.isArray(P)||!Array.isArray(Le)||!Ad(nt)||"boolean"!=typeof Dt)throw new Error("Invalid arguments passed to jsPDF.lines");for(fb(J,Ce),$t=Le[0],wn=Le[1],Ii=P.length,qa=J,ca=Ce,Gn=0;Gn<Ii;Gn++)2===(Ui=P[Gn]).length?qm(qa=Ui[0]*$t+qa,ca=Ui[1]*wn+ca):Jp(Ui[0]*$t+qa,Ui[1]*wn+ca,Ui[2]*$t+qa,Ui[3]*wn+ca,qa=Ui[4]*$t+qa,ca=Ui[5]*wn+ca);return Dt&&US(),db(nt),this},E.path=function(P){for(var J=0;J<P.length;J++){var Ce=P[J],Le=Ce.c;switch(Ce.op){case"m":fb(Le[0],Le[1]);break;case"l":qm(Le[0],Le[1]);break;case"c":Jp.apply(this,Le);break;case"h":US()}}return this},E.__private__.rect=E.rect=function(P,J,Ce,Le,nt){if(isNaN(P)||isNaN(J)||isNaN(Ce)||isNaN(Le)||!Ad(nt))throw new Error("Invalid arguments passed to jsPDF.rect");return ce===Y.COMPAT&&(Le=-Le),ke([Ge(de(P)),Ge(Ae(J)),Ge(de(Ce)),Ge(de(Le)),"re"].join(" ")),db(nt),this},E.__private__.triangle=E.triangle=function(P,J,Ce,Le,nt,Dt,$t){if(isNaN(P)||isNaN(J)||isNaN(Ce)||isNaN(Le)||isNaN(nt)||isNaN(Dt)||!Ad($t))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ce-P,Le-J],[nt-Ce,Dt-Le],[P-nt,J-Dt]],P,J,[1,1],$t,!0),this},E.__private__.roundedRect=E.roundedRect=function(P,J,Ce,Le,nt,Dt,$t){if(isNaN(P)||isNaN(J)||isNaN(Ce)||isNaN(Le)||isNaN(nt)||isNaN(Dt)||!Ad($t))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var wn=4/3*(Math.SQRT2-1);return nt=Math.min(nt,.5*Ce),Dt=Math.min(Dt,.5*Le),this.lines([[Ce-2*nt,0],[nt*wn,0,nt,Dt-Dt*wn,nt,Dt],[0,Le-2*Dt],[0,Dt*wn,-nt*wn,Dt,-nt,Dt],[2*nt-Ce,0],[-nt*wn,0,-nt,-Dt*wn,-nt,-Dt],[0,2*Dt-Le],[0,-Dt*wn,nt*wn,-Dt,nt,-Dt]],P+nt,J,[1,1],$t,!0),this},E.__private__.ellipse=E.ellipse=function(P,J,Ce,Le,nt){if(isNaN(P)||isNaN(J)||isNaN(Ce)||isNaN(Le)||!Ad(nt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Dt=4/3*(Math.SQRT2-1)*Ce,$t=4/3*(Math.SQRT2-1)*Le;return fb(P+Ce,J),Jp(P+Ce,J-$t,P+Dt,J-Le,P,J-Le),Jp(P-Dt,J-Le,P-Ce,J-$t,P-Ce,J),Jp(P-Ce,J+$t,P-Dt,J+Le,P,J+Le),Jp(P+Dt,J+Le,P+Ce,J+$t,P+Ce,J),db(nt),this},E.__private__.circle=E.circle=function(P,J,Ce,Le){if(isNaN(P)||isNaN(J)||isNaN(Ce)||!Ad(Le))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(P,J,Ce,Ce,Le)},E.setFont=function(P,J,Ce){return Ce&&(J=yt(J,Ce)),er=RS(P,J,{disableWarning:!1}),this};var cF=E.__private__.getFont=E.getFont=function(){return so[RS.apply(E,arguments)]};E.__private__.getFontList=E.getFontList=function(){var P,J,Ce={};for(P in ko)if(ko.hasOwnProperty(P))for(J in Ce[P]=[],ko[P])ko[P].hasOwnProperty(J)&&Ce[P].push(J);return Ce},E.addFont=function(P,J,Ce,Le,nt){var Dt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==Dt.indexOf(arguments[3])?nt=arguments[3]:arguments[3]&&-1==Dt.indexOf(arguments[3])&&(Ce=yt(Ce,Le)),lb.call(this,P,J,Ce,nt=nt||"Identity-H")};var Gm,pb=t.lineWidth||.200025,v_=E.__private__.getLineWidth=E.getLineWidth=function(){return pb},HS=E.__private__.setLineWidth=E.setLineWidth=function(P){return pb=P,ke(Ge(de(P))+" w"),this};E.__private__.setLineDash=ei.API.setLineDash=ei.API.setLineDashPattern=function(P,J){if(P=P||[],J=J||0,isNaN(J)||!Array.isArray(P))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return P=P.map(function(Ce){return Ge(de(Ce))}).join(" "),J=Ge(de(J)),ke("["+P+"] "+J+" d"),this};var zS=E.__private__.getLineHeight=E.getLineHeight=function(){return cn*Gm};E.__private__.getLineHeight=E.getLineHeight=function(){return cn*Gm};var $S=E.__private__.setLineHeightFactor=E.setLineHeightFactor=function(P){return"number"==typeof(P=P||1.15)&&(Gm=P),this},WS=E.__private__.getLineHeightFactor=E.getLineHeightFactor=function(){return Gm};$S(t.lineHeight);var kf=E.__private__.getHorizontalCoordinate=function(P){return de(P)},Zp=E.__private__.getVerticalCoordinate=function(P){return ce===Y.ADVANCED?P:wi[ve].mediaBox.topRightY-wi[ve].mediaBox.bottomLeftY-de(P)},uF=E.__private__.getHorizontalCoordinateString=E.getHorizontalCoordinateString=function(P){return Ge(kf(P))},eh=E.__private__.getVerticalCoordinateString=E.getVerticalCoordinateString=function(P){return Ge(Zp(P))},Bu=t.strokeColor||"0 G";E.__private__.getStrokeColor=E.getDrawColor=function(){return Nu(Bu)},E.__private__.setStrokeColor=E.setDrawColor=function(P,J,Ce,Le){return Bu=Lu({ch1:P,ch2:J,ch3:Ce,ch4:Le,pdfColorType:"draw",precision:2}),ke(Bu),this};var hb=t.fillColor||"0 g";E.__private__.getFillColor=E.getFillColor=function(){return Nu(hb)},E.__private__.setFillColor=E.setFillColor=function(P,J,Ce,Le){return hb=Lu({ch1:P,ch2:J,ch3:Ce,ch4:Le,pdfColorType:"fill",precision:2}),ke(hb),this};var Km=t.textColor||"0 g",dF=E.__private__.getTextColor=E.getTextColor=function(){return Nu(Km)};E.__private__.setTextColor=E.setTextColor=function(P,J,Ce,Le){return Km=Lu({ch1:P,ch2:J,ch3:Ce,ch4:Le,pdfColorType:"text",precision:3}),this};var y_=t.charSpace,fF=E.__private__.getCharSpace=E.getCharSpace=function(){return parseFloat(y_||0)};E.__private__.setCharSpace=E.setCharSpace=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return y_=P,this};var mb=0;E.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},E.__private__.setLineCap=E.setLineCap=function(P){var J=E.CapJoinStyles[P];if(void 0===J)throw new Error("Line cap style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return mb=J,ke(J+" J"),this};var gb=0;E.__private__.setLineJoin=E.setLineJoin=function(P){var J=E.CapJoinStyles[P];if(void 0===J)throw new Error("Line join style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return gb=J,ke(J+" j"),this},E.__private__.setLineMiterLimit=E.__private__.setMiterLimit=E.setLineMiterLimit=E.setMiterLimit=function(P){if(P=P||0,isNaN(P))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ke(Ge(de(P))+" M"),this},E.GState=UT,E.setGState=function(P){(P="string"==typeof P?Yo[Fu[P]]:qS(null,P)).equals(Tf)||(ke("/"+P.id+" gs"),Tf=P)};var qS=function(P,J){if(!P||!Fu[P]){var Ce=!1;for(var Le in Yo)if(Yo.hasOwnProperty(Le)&&Yo[Le].equals(J)){Ce=!0;break}if(Ce)J=Yo[Le];else{var nt="GS"+(Object.keys(Yo).length+1).toString(10);Yo[nt]=J,J.id=nt}return P&&(Fu[P]=J.id),Nr.publish("addGState",J),J}};E.addGState=function(P,J){return qS(P,J),this},E.saveGraphicsState=function(){return ke("q"),Td.push({key:er,size:cn,color:Km}),this},E.restoreGraphicsState=function(){ke("Q");var P=Td.pop();return er=P.key,cn=P.size,Km=P.color,Tf=null,this},E.setCurrentTransformationMatrix=function(P){return ke(P.toString()+" cm"),this},E.comment=function(P){return ke("#"+P),this};var b_=function(P,J){var Ce=P||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ce},set:function(Dt){isNaN(Dt)||(Ce=parseFloat(Dt))}});var Le=J||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Le},set:function(Dt){isNaN(Dt)||(Le=parseFloat(Dt))}});var nt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return nt},set:function(Dt){nt=Dt.toString()}}),this},_b=function(P,J,Ce,Le){b_.call(this,P,J),this.type="rect";var nt=Ce||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return nt},set:function($t){isNaN($t)||(nt=parseFloat($t))}});var Dt=Le||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Dt},set:function($t){isNaN($t)||(Dt=parseFloat($t))}}),this},vb=function(){this.page=Xo,this.currentPage=ve,this.pages=Gt.slice(0),this.pagesContext=wi.slice(0),this.x=$a,this.y=kr,this.matrix=Mu,this.width=Ym(ve),this.height=th(ve),this.outputDestination=En,this.id="",this.objectNumber=-1};vb.prototype.restore=function(){Xo=this.page,wi=this.pagesContext,Gt=this.pages,$a=this.x,kr=this.y,Mu=this.matrix,yb(ve=this.currentPage,this.width),bb(ve,this.height),En=this.outputDestination};var GS=function(P,J,Ce,Le,nt){Ed.push(new vb),Xo=ve=0,Gt=[],$a=P,kr=J,Mu=nt,cb([Ce,Le])},pF=function(P){if(Sd[P])Ed.pop().restore();else{var J=new vb,Ce="Xo"+(Object.keys(ka).length+1).toString(10);J.id=Ce,Sd[P]=Ce,ka[Ce]=J,Nr.publish("addFormObject",J),Ed.pop().restore()}};for(var x_ in E.beginFormObject=function(P,J,Ce,Le,nt){return GS(P,J,Ce,Le,nt),this},E.endFormObject=function(P){return pF(P),this},E.doFormObject=function(P,J){var Ce=ka[Sd[P]];return ke("q"),ke(J.toString()+" cm"),ke("/"+Ce.id+" Do"),ke("Q"),this},E.getFormObject=function(P){var J=ka[Sd[P]];return{x:J.x,y:J.y,width:J.width,height:J.height,matrix:J.matrix}},E.save=function(P,J){return P=P||"generated.pdf",(J=J||{}).returnPromise=J.returnPromise||!1,!1===J.returnPromise?(Mm(m_(Ef()),P),"function"==typeof Mm.unload&&ri.setTimeout&&setTimeout(Mm.unload,911),this):new Promise(function(Ce,Le){try{var nt=Mm(m_(Ef()),P);"function"==typeof Mm.unload&&ri.setTimeout&&setTimeout(Mm.unload,911),Ce(nt)}catch(Dt){Le(Dt.message)}})},ei.API)ei.API.hasOwnProperty(x_)&&("events"===x_&&ei.API.events.length?function(P,J){var Le,nt;for(nt=J.length-1;-1!==nt;nt--)P.subscribe.apply(P,[J[nt][0]].concat("function"==typeof(Le=J[nt][1])?[Le]:Le))}(Nr,ei.API.events):E[x_]=ei.API[x_]);var Ym=E.getPageWidth=function(P){return(wi[P=P||ve].mediaBox.topRightX-wi[P].mediaBox.bottomLeftX)/bn},yb=E.setPageWidth=function(P,J){wi[P].mediaBox.topRightX=J*bn+wi[P].mediaBox.bottomLeftX},th=E.getPageHeight=function(P){return(wi[P=P||ve].mediaBox.topRightY-wi[P].mediaBox.bottomLeftY)/bn},bb=E.setPageHeight=function(P,J){wi[P].mediaBox.topRightY=J*bn+wi[P].mediaBox.bottomLeftY};return E.internal={pdfEscape:Ll,getStyle:VS,getFont:cF,getFontSize:gn,getCharSpace:fF,getTextColor:dF,getLineHeight:zS,getLineHeightFactor:WS,getLineWidth:v_,write:Di,getHorizontalCoordinate:kf,getVerticalCoordinate:Zp,getCoordinateString:uF,getVerticalCoordinateString:eh,collections:{},newObject:qs,newAdditionalObject:a_,newObjectDeferred:As,newObjectDeferredBegin:cc,getFilters:Dd,putStream:qc,events:Nr,scaleFactor:bn,pageSize:{getWidth:function(){return Ym(ve)},setWidth:function(P){yb(ve,P)},getHeight:function(){return th(ve)},setHeight:function(P){bb(ve,P)}},encryptionOptions:x,encryption:Wa,getEncryptor:iF,output:g_,getNumberOfPages:JM,pages:Gt,out:ke,f2:vt,f3:fe,getPageInfo:jS,getPageInfoByObjId:vi,getCurrentPageInfo:rF,getPDFVersion:B,Point:b_,Rectangle:_b,Matrix:ti,hasHotfix:BS},Object.defineProperty(E.internal.pageSize,"width",{get:function(){return Ym(ve)},set:function(P){yb(ve,P)},enumerable:!0,configurable:!0}),Object.defineProperty(E.internal.pageSize,"height",{get:function(){return th(ve)},set:function(P){bb(ve,P)},enumerable:!0,configurable:!0}),XM.call(E,Kt),er="F1",NS(r,e),Nr.publish("initialized"),E}q0.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},q0.prototype.toHexString=function(t){return t.split("").map(function(i){return("0"+(255&i.charCodeAt(0)).toString(16)).slice(-2)}).join("")},q0.prototype.hexToBytes=function(t){for(var i=[],e=0;e<t.length;e+=2)i.push(String.fromCharCode(parseInt(t.substr(e,2),16)));return i.join("")},q0.prototype.processOwnerPassword=function(t,i){return $A(zA(i).substr(0,5),t)},q0.prototype.encryptor=function(t,i){var e=zA(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&i,i>>8&255)).substr(0,10);return function(n){return $A(e,n)}},UT.prototype.equals=function(t){var i,e="id,objectNumber,equals";if(!t||$r(t)!==$r(this))return!1;var n=0;for(i in this)if(!(e.indexOf(i)>=0)){if(this.hasOwnProperty(i)&&!t.hasOwnProperty(i)||this[i]!==t[i])return!1;n++}for(i in t)t.hasOwnProperty(i)&&e.indexOf(i)<0&&n--;return 0===n},ei.API={events:[]},ei.version="2.5.1";var Go=ei.API,WA=1,Pm=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Y0=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},bi=function(t){return t.toFixed(2)},Kp=function(t){return t.toFixed(5)};Go.__acroform__={};var Ol=function(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t},zR=function(t){return t*WA},_d=function(t){var i=new WR,e=On.internal.getHeight(t)||0,n=On.internal.getWidth(t)||0;return i.BBox=[0,0,Number(bi(n)),Number(bi(e))],i},cJ=Go.__acroform__.setBit=function(t,i){if(t=t||0,i=i||0,isNaN(t)||isNaN(i))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<i},uJ=Go.__acroform__.clearBit=function(t,i){if(t=t||0,i=i||0,isNaN(t)||isNaN(i))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<i)},dJ=Go.__acroform__.getBit=function(t,i){if(isNaN(t)||isNaN(i))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return 0==(t&1<<i)?0:1},ds=Go.__acroform__.getBitForPdf=function(t,i){if(isNaN(t)||isNaN(i))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return dJ(t,i-1)},fs=Go.__acroform__.setBitForPdf=function(t,i){if(isNaN(t)||isNaN(i))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return cJ(t,i-1)},ps=Go.__acroform__.clearBitForPdf=function(t,i){if(isNaN(t)||isNaN(i))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return uJ(t,i-1)},fJ=Go.__acroform__.calculateCoordinates=function(t,i){var e=i.internal.getHorizontalCoordinate,n=i.internal.getVerticalCoordinate,r=t[0],o=t[1],c=t[2],u=t[3],m={};return m.lowerLeft_X=e(r)||0,m.lowerLeft_Y=n(o+u)||0,m.upperRight_X=e(r+c)||0,m.upperRight_Y=n(o)||0,[Number(bi(m.lowerLeft_X)),Number(bi(m.lowerLeft_Y)),Number(bi(m.upperRight_X)),Number(bi(m.upperRight_Y))]},pJ=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var i=[],n=qA(t,t._V||t.DV),r=t.scope.internal.getFont(t.fontName,t.fontStyle).id;i.push("/Tx BMC"),i.push("q"),i.push("BT"),i.push(t.scope.__private__.encodeColorString(t.color)),i.push("/"+r+" "+bi(n.fontSize)+" Tf"),i.push("1 0 0 1 0 0 Tm"),i.push(n.text),i.push("ET"),i.push("Q"),i.push("EMC");var o=_d(t);return o.scope=t.scope,o.stream=i.join("\n"),o}},qA=function(t,i){var e=0===t.fontSize?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},r=(i=")"==(i="("==i.substr(0,1)?i.substr(1):i).substr(i.length-1)?i.substr(0,i.length-1):i).split(" ");r=r.map(t.multiline?function(fe){return fe.split("\n")}:function(fe){return[fe]});var o=e,c=On.internal.getHeight(t)||0;c=c<0?-c:c;var fe,u=On.internal.getWidth(t)||0;u=u<0?-u:u,o++;e:for(;o>0;){i="",o--;var g,x,S=HT("3",t,o).height,M=t.multiline?c-o:(c-S)/2,E=M+=2,R=0,B=0,K=0;if(o<=0){i="(...) Tj\n",i+="% Width of Text: "+HT(i,t,o=12).width+", FieldWidth:"+u+"\n";break}for(var q="",Y=0,ce=0;ce<r.length;ce++)if(r.hasOwnProperty(ce)){var De=!1;if(1!==r[ce].length&&K!==r[ce].length-1){if((S+2)*(Y+2)+2>c)continue e;q+=r[ce][K],De=!0,B=ce,ce--}else{q=" "==(q+=r[ce][K]+" ").substr(q.length-1)?q.substr(0,q.length-1):q;var Ye=parseInt(ce),yt=(fe=Ye)+1<r.length&&HT(q+" "+r[fe+1][0],t,o).width<=u-4,Ge=ce>=r.length-1;if(yt&&!Ge){q+=" ",K=0;continue}if(yt||Ge){if(Ge)B=Ye;else if(t.multiline&&(S+2)*(Y+2)+2>c)continue e}else{if(!t.multiline||(S+2)*(Y+2)+2>c)continue e;B=Ye}}for(var Te="",mt=R;mt<=B;mt++){var vt=r[mt];if(t.multiline){if(mt===B){Te+=vt[K]+" ",K=(K+1)%vt.length;continue}if(mt===R){Te+=vt[vt.length-1]+" ";continue}}Te+=vt[0]+" "}switch(Te=" "==Te.substr(Te.length-1)?Te.substr(0,Te.length-1):Te,x=HT(Te,t,o).width,t.textAlign){case"right":g=u-x-2;break;case"center":g=(u-x)/2;break;default:g=2}i+=bi(g)+" "+bi(E)+" Td\n",i+="("+Pm(Te)+") Tj\n",i+=-bi(g)+" 0 Td\n",E=-(o+2),x=0,R=De?B:B+1,Y++,q=""}break}return n.text=i,n.fontSize=o,n},HT=function(t,i,e){var n=i.scope.internal.getFont(i.fontName,i.fontStyle),r=i.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:i.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:r}},hJ={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},mJ=function(t,i){var e={type:"reference",object:t};void 0===i.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===e.type&&n.object===e.object})&&i.internal.getPageInfo(t.page).pageContext.annotations.push(e)},$R=Go.__acroform__.arrayToPdfArray=function(t,i,e){var n=function(c){return c};if(Array.isArray(t)){for(var r="[",o=0;o<t.length;o++)switch(0!==o&&(r+=" "),$r(t[o])){case"boolean":case"number":case"object":r+=t[o].toString();break;case"string":"/"!==t[o].substr(0,1)?(void 0!==i&&e&&(n=e.internal.getEncryptor(i)),r+="("+Pm(n(t[o].toString()))+")"):r+=t[o].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},GA=function(t,i,e){var n=function(r){return r};return void 0!==i&&e&&(n=e.internal.getEncryptor(i)),(t=t||"").toString(),"("+Pm(n(t))+")"},vd=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};vd.prototype.toString=function(){return this.objId+" 0 R"},vd.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},vd.prototype.getKeyValueListForStream=function(){var t=[],i=Object.getOwnPropertyNames(this).filter(function(o){return"content"!=o&&"appearanceStreamContent"!=o&&"scope"!=o&&"objId"!=o&&"_"!=o.substring(0,1)});for(var e in i)if(!1===Object.getOwnPropertyDescriptor(this,i[e]).configurable){var n=i[e],r=this[n];r&&(Array.isArray(r)?t.push({key:n,value:$R(r,this.objId,this.scope)}):r instanceof vd?(r.scope=this.scope,t.push({key:n,value:r.objId+" 0 R"})):"function"!=typeof r&&t.push({key:n,value:r}))}return t};var WR=function(){vd.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,i=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){t=e.trim()},get:function(){return t||null}})};Ol(WR,vd);var qR=function(){vd.call(this);var t,i=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return i.length>0?i:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return i}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var e=function(n){return n};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+Pm(e(t))+")"}},set:function(e){t=e}})};Ol(qR,vd);var ku=function t(){vd.call(this);var i=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return i},set:function(q){if(isNaN(q))throw new Error('Invalid value "'+q+'" for attribute F supplied.');i=q}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(i,3))},set:function(q){this.F=!0===Boolean(q)?fs(i,3):ps(i,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(q){if(isNaN(q))throw new Error('Invalid value "'+q+'" for attribute Ff supplied.');e=q}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==n.length)return n},set:function(q){n=void 0!==q?q:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(q){n[0]=q}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(q){n[1]=q}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(q){n[2]=q}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(q){n[3]=q}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(q){switch(q){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=q;break;default:throw new Error('Invalid value "'+q+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof WT)return;o="FieldObject"+t.FieldNum++}var q=function(Y){return Y};return this.scope&&(q=this.scope.internal.getEncryptor(this.objId)),"("+Pm(q(o))+")"},set:function(q){o=q.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(q){o=q}});var c="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return c},set:function(q){c=q}});var u="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return u},set:function(q){u=q}});var m=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return m},set:function(q){m=q}});var g=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===g?50/WA:g},set:function(q){g=q}});var x="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return x},set:function(q){x=q}});var S="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!S||this instanceof WT||this instanceof Om))return GA(S,this.objId,this.scope)},set:function(q){q=q.toString(),S=q}});var M=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(M)return this instanceof la?M:GA(M,this.objId,this.scope)},set:function(q){q=q.toString(),M=this instanceof la?q:"("===q.substr(0,1)?Y0(q.substr(1,q.length-2)):Y0(q)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof la?Y0(M.substr(1,M.length-1)):M},set:function(q){q=q.toString(),M=this instanceof la?"/"+q:q}});var E=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(E)return E},set:function(q){this.V=q}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(E)return this instanceof la?E:GA(E,this.objId,this.scope)},set:function(q){q=q.toString(),E=this instanceof la?q:"("===q.substr(0,1)?Y0(q.substr(1,q.length-2)):Y0(q)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof la?Y0(E.substr(1,E.length-1)):E},set:function(q){q=q.toString(),E=this instanceof la?"/"+q:q}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var R,B=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return B},set:function(q){q=Boolean(q),B=q}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(R)return R},set:function(q){R=q}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,1))},set:function(q){this.Ff=!0===Boolean(q)?fs(this.Ff,1):ps(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,2))},set:function(q){this.Ff=!0===Boolean(q)?fs(this.Ff,2):ps(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,3))},set:function(q){this.Ff=!0===Boolean(q)?fs(this.Ff,3):ps(this.Ff,3)}});var K=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==K)return K},set:function(q){if(-1===[0,1,2].indexOf(q))throw new Error('Invalid value "'+q+'" for attribute Q supplied.');K=q}}),Object.defineProperty(this,"textAlign",{get:function(){var q;switch(K){case 0:default:q="left";break;case 1:q="center";break;case 2:q="right"}return q},configurable:!0,enumerable:!0,set:function(q){switch(q){case"right":case 2:K=2;break;case"center":case 1:K=1;break;default:K=0}}})};Ol(ku,vd);var X0=function(){ku.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){t=e}});var i=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return $R(i,this.objId,this.scope)},set:function(e){var n,r;r=[],"string"==typeof(n=e)&&(r=function(o,c,u){u||(u=1);for(var m,g=[];m=c.exec(o);)g.push(m[u]);return g}(n,/\((.*?)\)/g)),i=r}}),this.getOptions=function(){return i},this.setOptions=function(e){i=e,this.sort&&i.sort()},this.addOption=function(e){e=(e=e||"").toString(),i.push(e),this.sort&&i.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();-1!==i.indexOf(e)&&(i.splice(i.indexOf(e),1),!1!==n););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,18))},set:function(e){this.Ff=!0===Boolean(e)?fs(this.Ff,18):ps(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,19))},set:function(e){!0===this.combo&&(this.Ff=!0===Boolean(e)?fs(this.Ff,19):ps(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,20))},set:function(e){!0===Boolean(e)?(this.Ff=fs(this.Ff,20),i.sort()):this.Ff=ps(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,22))},set:function(e){this.Ff=!0===Boolean(e)?fs(this.Ff,22):ps(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,23))},set:function(e){this.Ff=!0===Boolean(e)?fs(this.Ff,23):ps(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,27))},set:function(e){this.Ff=!0===Boolean(e)?fs(this.Ff,27):ps(this.Ff,27)}}),this.hasAppearanceStream=!1};Ol(X0,ku);var Q0=function(){X0.call(this),this.fontName="helvetica",this.combo=!1};Ol(Q0,X0);var J0=function(){Q0.call(this),this.combo=!0};Ol(J0,Q0);var zT=function(){J0.call(this),this.edit=!0};Ol(zT,J0);var la=function(){ku.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,15))},set:function(e){this.Ff=!0===Boolean(e)?fs(this.Ff,15):ps(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,16))},set:function(e){this.Ff=!0===Boolean(e)?fs(this.Ff,16):ps(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,17))},set:function(e){this.Ff=!0===Boolean(e)?fs(this.Ff,17):ps(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,26))},set:function(e){this.Ff=!0===Boolean(e)?fs(this.Ff,26):ps(this.Ff,26)}});var t,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(o){return o};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(i).length){var n,r=[];for(n in r.push("<<"),i)r.push("/"+n+" ("+Pm(e(i[n]))+")");return r.push(">>"),r.join("\n")}},set:function(e){"object"===$r(e)&&(i=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(e){"string"==typeof e&&(i.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(e){t="/"+e}})};Ol(la,ku);var $T=function(){la.call(this),this.pushButton=!0};Ol($T,la);var Z0=function(){la.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(i){t=void 0!==i?i:[]}})};Ol(Z0,la);var WT=function(){var t,i;ku.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return i},set:function(r){i=r}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(u){return u};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var o,c=[];for(o in c.push("<<"),n)c.push("/"+o+" ("+Pm(r(n[o]))+")");return c.push(">>"),c.join("\n")},set:function(r){"object"===$r(r)&&(n=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(r){"string"==typeof r&&(n.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=On.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ol(WT,ku),Z0.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var i in this.Kids)if(this.Kids.hasOwnProperty(i)){var e=this.Kids[i];e.appearanceStreamContent=t.createAppearanceStream(e.optionName),e.caption=t.getCA()}},Z0.prototype.createOption=function(t){var i=new WT;return i.Parent=this,i.optionName=t,this.Kids.push(i),vJ.call(this.scope,i),i};var qT=function(){la.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=On.CheckBox.createAppearanceStream()};Ol(qT,la);var Om=function(){ku.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,13))},set:function(i){this.Ff=!0===Boolean(i)?fs(this.Ff,13):ps(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,21))},set:function(i){this.Ff=!0===Boolean(i)?fs(this.Ff,21):ps(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,23))},set:function(i){this.Ff=!0===Boolean(i)?fs(this.Ff,23):ps(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,24))},set:function(i){this.Ff=!0===Boolean(i)?fs(this.Ff,24):ps(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,25))},set:function(i){this.Ff=!0===Boolean(i)?fs(this.Ff,25):ps(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,26))},set:function(i){this.Ff=!0===Boolean(i)?fs(this.Ff,26):ps(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(i){Number.isInteger(i)&&(t=i)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ol(Om,ku);var GT=function(){Om.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(ds(this.Ff,14))},set:function(t){this.Ff=!0===Boolean(t)?fs(this.Ff,14):ps(this.Ff,14)}}),this.password=!0};Ol(GT,Om);var On={CheckBox:{createAppearanceStream:function(){return{N:{On:On.CheckBox.YesNormal},D:{On:On.CheckBox.YesPushDown,Off:On.CheckBox.OffPushDown}}},YesPushDown:function(t){var i=_d(t);i.scope=t.scope;var e=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),o=qA(t,t.caption);return e.push("0.749023 g"),e.push("0 0 "+bi(On.internal.getWidth(t))+" "+bi(On.internal.getHeight(t))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+n+" "+bi(o.fontSize)+" Tf "+r),e.push("BT"),e.push(o.text),e.push("ET"),e.push("Q"),e.push("EMC"),i.stream=e.join("\n"),i},YesNormal:function(t){var i=_d(t);i.scope=t.scope;var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),r=[],o=On.internal.getHeight(t),c=On.internal.getWidth(t),u=qA(t,t.caption);return r.push("1 g"),r.push("0 0 "+bi(c)+" "+bi(o)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+bi(c-1)+" "+bi(o-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+e+" "+bi(u.fontSize)+" Tf "+n),r.push(u.text),r.push("ET"),r.push("Q"),i.stream=r.join("\n"),i},OffPushDown:function(t){var i=_d(t);i.scope=t.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+bi(On.internal.getWidth(t))+" "+bi(On.internal.getHeight(t))+" re"),e.push("f"),i.stream=e.join("\n"),i}},RadioButton:{Circle:{createAppearanceStream:function(t){var i={D:{Off:On.RadioButton.Circle.OffPushDown},N:{}};return i.N[t]=On.RadioButton.Circle.YesNormal,i.D[t]=On.RadioButton.Circle.YesPushDown,i},getCA:function(){return"l"},YesNormal:function(t){var i=_d(t);i.scope=t.scope;var e=[],n=On.internal.getWidth(t)<=On.internal.getHeight(t)?On.internal.getWidth(t)/4:On.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var o=Number((n*On.internal.Bezier_C).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+Kp(On.internal.getWidth(t)/2)+" "+Kp(On.internal.getHeight(t)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),e.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),e.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),e.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),e.push("f"),e.push("Q"),i.stream=e.join("\n"),i},YesPushDown:function(t){var i=_d(t);i.scope=t.scope;var e=[],n=On.internal.getWidth(t)<=On.internal.getHeight(t)?On.internal.getWidth(t)/4:On.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),o=Number((r*On.internal.Bezier_C).toFixed(5)),c=Number((n*On.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Kp(On.internal.getWidth(t)/2)+" "+Kp(On.internal.getHeight(t)/2)+" cm"),e.push(r+" 0 m"),e.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),e.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),e.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),e.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+Kp(On.internal.getWidth(t)/2)+" "+Kp(On.internal.getHeight(t)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+c+" "+c+" "+n+" 0 "+n+" c"),e.push("-"+c+" "+n+" -"+n+" "+c+" -"+n+" 0 c"),e.push("-"+n+" -"+c+" -"+c+" -"+n+" 0 -"+n+" c"),e.push(c+" -"+n+" "+n+" -"+c+" "+n+" 0 c"),e.push("f"),e.push("Q"),i.stream=e.join("\n"),i},OffPushDown:function(t){var i=_d(t);i.scope=t.scope;var e=[],n=On.internal.getWidth(t)<=On.internal.getHeight(t)?On.internal.getWidth(t)/4:On.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),o=Number((r*On.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Kp(On.internal.getWidth(t)/2)+" "+Kp(On.internal.getHeight(t)/2)+" cm"),e.push(r+" 0 m"),e.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),e.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),e.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),e.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),e.push("f"),e.push("Q"),i.stream=e.join("\n"),i}},Cross:{createAppearanceStream:function(t){var i={D:{Off:On.RadioButton.Cross.OffPushDown},N:{}};return i.N[t]=On.RadioButton.Cross.YesNormal,i.D[t]=On.RadioButton.Cross.YesPushDown,i},getCA:function(){return"8"},YesNormal:function(t){var i=_d(t);i.scope=t.scope;var e=[],n=On.internal.calculateCross(t);return e.push("q"),e.push("1 1 "+bi(On.internal.getWidth(t)-2)+" "+bi(On.internal.getHeight(t)-2)+" re"),e.push("W"),e.push("n"),e.push(bi(n.x1.x)+" "+bi(n.x1.y)+" m"),e.push(bi(n.x2.x)+" "+bi(n.x2.y)+" l"),e.push(bi(n.x4.x)+" "+bi(n.x4.y)+" m"),e.push(bi(n.x3.x)+" "+bi(n.x3.y)+" l"),e.push("s"),e.push("Q"),i.stream=e.join("\n"),i},YesPushDown:function(t){var i=_d(t);i.scope=t.scope;var e=On.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+bi(On.internal.getWidth(t))+" "+bi(On.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+bi(On.internal.getWidth(t)-2)+" "+bi(On.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(bi(e.x1.x)+" "+bi(e.x1.y)+" m"),n.push(bi(e.x2.x)+" "+bi(e.x2.y)+" l"),n.push(bi(e.x4.x)+" "+bi(e.x4.y)+" m"),n.push(bi(e.x3.x)+" "+bi(e.x3.y)+" l"),n.push("s"),n.push("Q"),i.stream=n.join("\n"),i},OffPushDown:function(t){var i=_d(t);i.scope=t.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+bi(On.internal.getWidth(t))+" "+bi(On.internal.getHeight(t))+" re"),e.push("f"),i.stream=e.join("\n"),i}}},createDefaultAppearanceStream:function(t){var i=t.scope.internal.getFont(t.fontName,t.fontStyle).id,e=t.scope.__private__.encodeColorString(t.color);return"/"+i+" "+t.fontSize+" Tf "+e}};On.internal={Bezier_C:.551915024494,calculateCross:function(t){var i=On.internal.getWidth(t),e=On.internal.getHeight(t),n=Math.min(i,e);return{x1:{x:(i-n)/2,y:(e-n)/2+n},x2:{x:(i-n)/2+n,y:(e-n)/2},x3:{x:(i-n)/2,y:(e-n)/2},x4:{x:(i-n)/2+n,y:(e-n)/2+n}}}},On.internal.getWidth=function(t){var i=0;return"object"===$r(t)&&(i=zR(t.Rect[2])),i},On.internal.getHeight=function(t){var i=0;return"object"===$r(t)&&(i=zR(t.Rect[3])),i};var t,i,vJ=Go.addField=function(t){if(function(t,i){if(i.scope=t,void 0!==t.internal&&(void 0===t.internal.acroformPlugin||!1===t.internal.acroformPlugin.isInitialized)){if(ku.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(hJ)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");WA=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new qR,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){var e;(e=t).internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0}),t.internal.events.subscribe("buildDocument",function(){!function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];o.objId=void 0,o.hasAnnotation&&mJ(o,e)}}(t)}),t.internal.events.subscribe("putCatalog",function(){!function(e){if(void 0===e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(t)}),t.internal.events.subscribe("postPutPages",function(e){!function(n,r){var o=!n;for(var c in n||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(c)){var u=n[c],m=[],g=u.Rect;if(u.Rect&&(u.Rect=fJ(u.Rect,r)),r.internal.newObjectDeferredBegin(u.objId,!0),u.DA=On.createDefaultAppearanceStream(u),"object"===$r(u)&&"function"==typeof u.getKeyValueListForStream&&(m=u.getKeyValueListForStream()),u.Rect=g,u.hasAppearanceStream&&!u.appearanceStreamContent){var x=pJ(u);m.push({key:"AP",value:"<</N "+x+">>"}),r.internal.acroformPlugin.xForms.push(x)}if(u.appearanceStreamContent){var S="";for(var M in u.appearanceStreamContent)if(u.appearanceStreamContent.hasOwnProperty(M)){var E=u.appearanceStreamContent[M];if(S+="/"+M+" ",S+="<<",Object.keys(E).length>=1||Array.isArray(E)){for(var c in E)if(E.hasOwnProperty(c)){var R=E[c];"function"==typeof R&&(R=R.call(r,u)),S+="/"+c+" "+R+" ",r.internal.acroformPlugin.xForms.indexOf(R)>=0||r.internal.acroformPlugin.xForms.push(R)}}else"function"==typeof(R=E)&&(R=R.call(r,u)),S+="/"+c+" "+R,r.internal.acroformPlugin.xForms.indexOf(R)>=0||r.internal.acroformPlugin.xForms.push(R);S+=">>"}m.push({key:"AP",value:"<<\n"+S+">>"})}r.internal.putStream({additionalKeyValues:m,objectId:u.objId}),r.internal.out("endobj")}o&&function(t,i){for(var e in t)if(t.hasOwnProperty(e)){var n=e,r=t[e];i.internal.newObjectDeferredBegin(r.objId,!0),"object"===$r(r)&&"function"==typeof r.putStream&&r.putStream(),delete t[n]}}(r.internal.acroformPlugin.xForms,r)}(e,t)}),t.internal.acroformPlugin.isInitialized=!0}}(this,t),!(t instanceof ku))throw new Error("Invalid argument passed to jsPDF.addField.");var i;return(i=t).scope.internal.acroformPlugin.printedOut&&(i.scope.internal.acroformPlugin.printedOut=!1,i.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),i.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(i),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};function GR(t){return t.reduce(function(i,e,n){return i[e]=n,i},{})}Go.AcroFormChoiceField=X0,Go.AcroFormListBox=Q0,Go.AcroFormComboBox=J0,Go.AcroFormEditBox=zT,Go.AcroFormButton=la,Go.AcroFormPushButton=$T,Go.AcroFormRadioButton=Z0,Go.AcroFormCheckBox=qT,Go.AcroFormTextField=Om,Go.AcroFormPasswordField=GT,Go.AcroFormAppearance=On,Go.AcroForm={ChoiceField:X0,ListBox:Q0,ComboBox:J0,EditBox:zT,Button:la,PushButton:$T,RadioButton:Z0,CheckBox:qT,TextField:Om,PasswordField:GT,Appearance:On},ei.AcroForm={ChoiceField:X0,ListBox:Q0,ComboBox:J0,EditBox:zT,Button:la,PushButton:$T,RadioButton:Z0,CheckBox:qT,TextField:Om,PasswordField:GT,Appearance:On},function(t){t.__addimage__={};var i="UNKNOWN",e={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(fe,de){var Oe,Ae,Ct,Re,Je,Ue=i;if("RGBA"===(de=de||i)||void 0!==fe.data&&fe.data instanceof Uint8ClampedArray&&"height"in fe&&"width"in fe)return"RGBA";if(yt(fe))for(Je in e)for(Ct=e[Je],Oe=0;Oe<Ct.length;Oe+=1){for(Re=!0,Ae=0;Ae<Ct[Oe].length;Ae+=1)if(void 0!==Ct[Oe][Ae]&&Ct[Oe][Ae]!==fe[Ae]){Re=!1;break}if(!0===Re){Ue=Je;break}}else for(Je in e)for(Ct=e[Je],Oe=0;Oe<Ct.length;Oe+=1){for(Re=!0,Ae=0;Ae<Ct[Oe].length;Ae+=1)if(void 0!==Ct[Oe][Ae]&&Ct[Oe][Ae]!==fe.charCodeAt(Ae)){Re=!1;break}if(!0===Re){Ue=Je;break}}return Ue===i&&de!==i&&(Ue=de),Ue},r=function fe(de){for(var Oe=this.internal.write,Ae=this.internal.putStream,Ct=(0,this.internal.getFilters)();-1!==Ct.indexOf("FlateEncode");)Ct.splice(Ct.indexOf("FlateEncode"),1);de.objectId=this.internal.newObject();var Re=[];if(Re.push({key:"Type",value:"/XObject"}),Re.push({key:"Subtype",value:"/Image"}),Re.push({key:"Width",value:de.width}),Re.push({key:"Height",value:de.height}),de.colorSpace===K.INDEXED?Re.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(de.palette.length/3-1)+" "+("sMask"in de&&void 0!==de.sMask?de.objectId+2:de.objectId+1)+" 0 R]"}):(Re.push({key:"ColorSpace",value:"/"+de.colorSpace}),de.colorSpace===K.DEVICE_CMYK&&Re.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Re.push({key:"BitsPerComponent",value:de.bitsPerComponent}),"decodeParameters"in de&&void 0!==de.decodeParameters&&Re.push({key:"DecodeParms",value:"<<"+de.decodeParameters+">>"}),"transparency"in de&&Array.isArray(de.transparency)){for(var Je="",Ue=0,lt=de.transparency.length;Ue<lt;Ue++)Je+=de.transparency[Ue]+" "+de.transparency[Ue]+" ";Re.push({key:"Mask",value:"["+Je+"]"})}if(void 0!==de.sMask&&Re.push({key:"SMask",value:de.objectId+1+" 0 R"}),Ae({data:de.data,additionalKeyValues:Re,alreadyAppliedFilters:void 0!==de.filter?["/"+de.filter]:void 0,objectId:de.objectId}),Oe("endobj"),"sMask"in de&&void 0!==de.sMask){var ne={width:de.width,height:de.height,colorSpace:"DeviceGray",bitsPerComponent:de.bitsPerComponent,decodeParameters:"/Predictor "+de.predictor+" /Colors 1 /BitsPerComponent "+de.bitsPerComponent+" /Columns "+de.width,data:de.sMask};"filter"in de&&(ne.filter=de.filter),fe.call(this,ne)}if(de.colorSpace===K.INDEXED){var ve=this.internal.newObject();Ae({data:Te(new Uint8Array(de.palette)),objectId:ve}),Oe("endobj")}},o=function(){var fe=this.internal.collections.addImage_images;for(var de in fe)r.call(this,fe[de])},c=function(){var fe,de=this.internal.collections.addImage_images,Oe=this.internal.write;for(var Ae in de)Oe("/I"+(fe=de[Ae]).index,fe.objectId,"0","R")},u=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",c))},m=function(){var fe=this.internal.collections.addImage_images;return u.call(this),fe},g=function(){return Object.keys(this.internal.collections.addImage_images).length},x=function(fe){return"function"==typeof t["process"+fe.toUpperCase()]},S=function(fe){return"object"===$r(fe)&&1===fe.nodeType},M=function(fe,de){if("IMG"===fe.nodeName&&fe.hasAttribute("src")){var Oe=""+fe.getAttribute("src");if(0===Oe.indexOf("data:image/"))return Zy(unescape(Oe).split("base64,").pop());var Ae=t.loadFile(Oe,!0);if(void 0!==Ae)return Ae}if("CANVAS"===fe.nodeName){if(0===fe.width||0===fe.height)throw new Error("Given canvas must have data. Canvas width: "+fe.width+", height: "+fe.height);var Ct;switch(de){case"PNG":Ct="image/png";break;case"WEBP":Ct="image/webp";break;default:Ct="image/jpeg"}return Zy(fe.toDataURL(Ct,1).split("base64,").pop())}},E=function(fe){var de=this.internal.collections.addImage_images;if(de)for(var Oe in de)if(fe===de[Oe].alias)return de[Oe]},R=function(fe,de,Oe){return fe||de||(fe=-96,de=-96),fe<0&&(fe=-1*Oe.width*72/fe/this.internal.scaleFactor),de<0&&(de=-1*Oe.height*72/de/this.internal.scaleFactor),0===fe&&(fe=de*Oe.width/Oe.height),0===de&&(de=fe*Oe.height/Oe.width),[fe,de]},B=function(fe,de,Oe,Ae,Ct,Re){var Je=R.call(this,Oe,Ae,Ct),Ue=this.internal.getCoordinateString,lt=this.internal.getVerticalCoordinateString,_t=m.call(this);if(Oe=Je[0],Ae=Je[1],_t[Ct.index]=Ct,Re){Re*=Math.PI/180;var on=Math.cos(Re),ne=Math.sin(Re),ve=function(je){return je.toFixed(4)},we=[ve(on),ve(ne),ve(-1*ne),ve(on),0,0,"cm"]}this.internal.write("q"),Re?(this.internal.write([1,"0","0",1,Ue(fe),lt(de+Ae),"cm"].join(" ")),this.internal.write(we.join(" ")),this.internal.write([Ue(Oe),"0","0",Ue(Ae),"0","0","cm"].join(" "))):this.internal.write([Ue(Oe),"0","0",Ue(Ae),Ue(fe),lt(de+Ae),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Ct.index+" Do"),this.internal.write("Q")},K=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var q=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},Y=t.__addimage__.sHashCode=function(fe){var de,Oe,Ae=0;if("string"==typeof fe)for(Oe=fe.length,de=0;de<Oe;de++)Ae=(Ae<<5)-Ae+fe.charCodeAt(de),Ae|=0;else if(yt(fe))for(Oe=fe.byteLength/2,de=0;de<Oe;de++)Ae=(Ae<<5)-Ae+fe[de],Ae|=0;return Ae},ce=t.__addimage__.validateStringAsBase64=function(fe){(fe=fe||"").toString().trim();var de=!0;return 0===fe.length&&(de=!1),fe.length%4!=0&&(de=!1),!1===/^[A-Za-z0-9+/]+$/.test(fe.substr(0,fe.length-2))&&(de=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(fe.substr(-2))&&(de=!1),de},De=t.__addimage__.extractImageFromDataUrl=function(fe){var de=(fe=fe||"").split("base64,"),Oe=null;if(2===de.length){var Ae=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(de[0]);Array.isArray(Ae)&&(Oe={mimeType:Ae[1],charset:Ae[2],data:de[1]})}return Oe},Ye=t.__addimage__.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array};t.__addimage__.isArrayBuffer=function(fe){return Ye()&&fe instanceof ArrayBuffer};var yt=t.__addimage__.isArrayBufferView=function(fe){return Ye()&&"undefined"!=typeof Uint32Array&&(fe instanceof Int8Array||fe instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&fe instanceof Uint8ClampedArray||fe instanceof Int16Array||fe instanceof Uint16Array||fe instanceof Int32Array||fe instanceof Uint32Array||fe instanceof Float32Array||fe instanceof Float64Array)},Ge=t.__addimage__.binaryStringToUint8Array=function(fe){for(var de=fe.length,Oe=new Uint8Array(de),Ae=0;Ae<de;Ae++)Oe[Ae]=fe.charCodeAt(Ae);return Oe},Te=t.__addimage__.arrayBufferToBinaryString=function(fe){for(var de="",Oe=yt(fe)?fe:new Uint8Array(fe),Ae=0;Ae<Oe.length;Ae+=8192)de+=String.fromCharCode.apply(null,Oe.subarray(Ae,Ae+8192));return de};t.addImage=function(){var fe,de,Oe,Ae,Ct,Re,Je,Ue,lt;if("number"==typeof arguments[1]?(de=i,Oe=arguments[1],Ae=arguments[2],Ct=arguments[3],Re=arguments[4],Je=arguments[5],Ue=arguments[6],lt=arguments[7]):(de=arguments[1],Oe=arguments[2],Ae=arguments[3],Ct=arguments[4],Re=arguments[5],Je=arguments[6],Ue=arguments[7],lt=arguments[8]),"object"===$r(fe=arguments[0])&&!S(fe)&&"imageData"in fe){var _t=fe;fe=_t.imageData,de=_t.format||de||i,Oe=_t.x||Oe||0,Ae=_t.y||Ae||0,Ct=_t.w||_t.width||Ct,Re=_t.h||_t.height||Re,Je=_t.alias||Je,Ue=_t.compression||Ue,lt=_t.rotation||_t.angle||lt}var on=this.internal.getFilters();if(void 0===Ue&&-1!==on.indexOf("FlateEncode")&&(Ue="SLOW"),isNaN(Oe)||isNaN(Ae))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var ne=mt.call(this,fe,de,Je,Ue);return B.call(this,Oe,Ae,Ct,Re,ne,lt),this};var mt=function(fe,de,Oe,Ae){var Ct,Re,Je,lt;if("string"==typeof fe&&n(fe)===i){fe=unescape(fe);var Ue=vt(fe,!1);(""!==Ue||void 0!==(Ue=t.loadFile(fe,!0)))&&(fe=Ue)}if(S(fe)&&(fe=M(fe,de)),de=n(fe,de),!x(de))throw new Error("addImage does not support files of type '"+de+"', please ensure that a plugin for '"+de+"' support is added.");if((null==(Je=Oe)||0===Je.length)&&(Oe="string"==typeof(lt=fe)||yt(lt)?Y(lt):yt(lt.data)?Y(lt.data):null),(Ct=E.call(this,Oe))||(Ye()&&(fe instanceof Uint8Array||"RGBA"===de||(Re=fe,fe=Ge(fe))),Ct=this["process"+de.toUpperCase()](fe,g.call(this),Oe,function(lt){return lt&&"string"==typeof lt&&(lt=lt.toUpperCase()),lt in t.image_compression?lt:q.NONE}(Ae),Re)),!Ct)throw new Error("An unknown error occurred whilst processing the image.");return Ct},vt=t.__addimage__.convertBase64ToBinaryString=function(fe,de){var Oe;de="boolean"!=typeof de||de;var Ae,Ct="";if("string"==typeof fe){Ae=null!==(Oe=De(fe))?Oe.data:fe;try{Ct=Zy(Ae)}catch(Re){if(de)throw ce(Ae)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Re.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Ct};t.getImageProperties=function(fe){var de,Oe,Ae="";if(S(fe)&&(fe=M(fe)),"string"==typeof fe&&n(fe)===i&&(""===(Ae=vt(fe,!1))&&(Ae=t.loadFile(fe)||""),fe=Ae),Oe=n(fe),!x(Oe))throw new Error("addImage does not support files of type '"+Oe+"', please ensure that a plugin for '"+Oe+"' support is added.");if(!Ye()||fe instanceof Uint8Array||(fe=Ge(fe)),!(de=this["process"+Oe.toUpperCase()](fe)))throw new Error("An unknown error occurred whilst processing the image");return de.fileType=Oe,de}}(ei.API),t=ei.API,i=function(e){if(void 0!==e&&""!=e)return!0},ei.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(e){for(var n,r,o,c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString,m=this.internal.getPageInfoByObjId(e.objId),g=e.pageContext.annotations,x=!1,S=0;S<g.length&&!x;S++)switch((n=g[S]).type){case"link":(i(n.options.url)||i(n.options.pageNumber))&&(x=!0);break;case"reference":case"text":case"freetext":x=!0}if(0!=x){this.internal.write("/Annots [");for(var M=0;M<g.length;M++){n=g[M];var E=this.internal.pdfEscape,R=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var B=this.internal.newAdditionalObject(),K=this.internal.newAdditionalObject(),q=this.internal.getEncryptor(B.objId),Y=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(r="/Rect ["+c(n.bounds.x)+" "+u(n.bounds.y+n.bounds.h)+" "+c(n.bounds.x+n.bounds.w)+" "+u(n.bounds.y)+"] ")+"/Contents ("+E(q(n.contents))+")",o+=" /Popup "+K.objId+" 0 R",o+=" /P "+m.objId+" 0 R",o+=" /T ("+E(q(Y))+") >>",B.content=o;var ce=B.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+c(n.bounds.x+30)+" "+u(n.bounds.y+n.bounds.h)+" "+c(n.bounds.x+n.bounds.w+30)+" "+u(n.bounds.y)+"] ")+" /Parent "+ce,n.open&&(o+=" /Open true"),K.content=o+=" >>",this.internal.write(B.objId,"0 R",K.objId,"0 R");break;case"freetext":r="/Rect ["+c(n.bounds.x)+" "+u(n.bounds.y)+" "+c(n.bounds.x+n.bounds.w)+" "+u(n.bounds.y+n.bounds.h)+"] ";var De=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+E(R(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+De+")",o+=" /Border [0 0 0]",this.internal.write(o+=" >>");break;case"link":if(n.options.name){var Ye=this.annotations._nameMap[n.options.name];n.options.pageNumber=Ye.page,n.options.top=Ye.y}else n.options.top||(n.options.top=0);if(r="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+E(R(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;default:var yt=u(n.options.top);n.options.left=n.options.left||0,void 0===n.options.zoom&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+yt+" "+n.options.zoom+"]"}""!=o&&this.internal.write(o+=" >>")}}this.internal.write("]")}}]),t.createAnnotation=function(e){var n=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":n.pageContext.annotations.push(e)}},t.link=function(e,n,r,o,c){var u=this.internal.getCurrentPageInfo(),m=this.internal.getCoordinateString,g=this.internal.getVerticalCoordinateString;u.pageContext.annotations.push({finalBounds:{x:m(e),y:g(n),w:m(e+r),h:g(n+o)},options:c,type:"link"})},t.textWithLink=function(e,n,r,o){var c,u,m=this.getTextWidth(e),g=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==o.maxWidth){var x=this.splitTextToSize(e,u=o.maxWidth).length;c=Math.ceil(g*x)}else u=m,c=g;return this.text(e,n,r,o),"center"===o.align&&(n-=m/2),"right"===o.align&&(n-=m),this.link(n,(r+=.2*g)-g,u,c,o),m},t.getTextWidth=function(e){var n=this.internal.getFontSize();return this.getStringUnitWidth(e)*n/this.internal.scaleFactor},function(t){var i={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];t.__arabicParser__={};var o=t.__arabicParser__.isInArabicSubstitutionA=function(B){return void 0!==i[B.charCodeAt(0)]},c=t.__arabicParser__.isArabicLetter=function(B){return"string"==typeof B&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(B)},u=t.__arabicParser__.isArabicEndLetter=function(B){return c(B)&&o(B)&&i[B.charCodeAt(0)].length<=2},m=t.__arabicParser__.isArabicAlfLetter=function(B){return c(B)&&r.indexOf(B.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(B){return c(B)&&o(B)&&i[B.charCodeAt(0)].length>=1};var g=t.__arabicParser__.arabicLetterHasFinalForm=function(B){return c(B)&&o(B)&&i[B.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(B){return c(B)&&o(B)&&i[B.charCodeAt(0)].length>=3};var x=t.__arabicParser__.arabicLetterHasMedialForm=function(B){return c(B)&&o(B)&&4==i[B.charCodeAt(0)].length},S=t.__arabicParser__.resolveLigatures=function(B){var K=0,q=e,Y="",ce=0;for(K=0;K<B.length;K+=1)void 0!==q[B.charCodeAt(K)]?(ce++,"number"==typeof(q=q[B.charCodeAt(K)])&&(Y+=String.fromCharCode(q),q=e,ce=0),K===B.length-1&&(q=e,Y+=B.charAt(K-(ce-1)),K-=ce-1,ce=0)):(q=e,Y+=B.charAt(K-ce),K-=ce,ce=0);return Y};t.__arabicParser__.isArabicDiacritic=function(B){return void 0!==B&&void 0!==n[B.charCodeAt(0)]};var M=t.__arabicParser__.getCorrectForm=function(B,K,q){return c(B)?!1===o(B)?-1:!g(B)||!c(K)&&!c(q)||!c(q)&&u(K)||u(B)&&!c(K)||u(B)&&m(K)||u(B)&&u(K)?0:x(B)&&c(K)&&!u(K)&&c(q)&&g(q)?3:u(B)||!c(q)?1:2:-1},E=function(B){var K=0,q=0,Y=0,ce="",De="",Ye="",yt=(B=B||"").split("\\s+"),Ge=[];for(K=0;K<yt.length;K+=1){for(Ge.push(""),q=0;q<yt[K].length;q+=1)De=yt[K][q-1],Ye=yt[K][q+1],c(ce=yt[K][q])?(Y=M(ce,De,Ye),Ge[K]+=-1!==Y?String.fromCharCode(i[ce.charCodeAt(0)][Y]):ce):Ge[K]+=ce;Ge[K]=S(Ge[K])}return Ge.join(" ")},R=t.__arabicParser__.processArabic=t.processArabic=function(){var B,K="string"==typeof arguments[0]?arguments[0]:arguments[0].text,q=[];if(Array.isArray(K)){var Y=0;for(q=[],Y=0;Y<K.length;Y+=1)Array.isArray(K[Y])?q.push([E(K[Y][0]),K[Y][1],K[Y][2]]):q.push([E(K[Y])]);B=q}else B=E(K);return"string"==typeof arguments[0]?B:(arguments[0].text=B,arguments[0])};t.events.push(["preProcessText",R])}(ei.API),ei.API.autoPrint=function(t){var i;return"javascript"===((t=t||{}).variant=t.variant||"non-conform",t.variant)?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){i=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+i+" 0 R")})),this},function(t){var i=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(u){e=u}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(u){n=isNaN(u)||!1===Number.isInteger(u)||u<0?150:u,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(u){r=isNaN(u)||!1===Number.isInteger(u)||u<0?300:u,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(u){o=u}});var c={};Object.defineProperty(this,"style",{get:function(){return c},set:function(u){c=u}}),Object.defineProperty(this,"parentNode",{})};i.prototype.getContext=function(e,n){var r;if("2d"!==(e=e||"2d"))return null;for(r in n)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=n[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},i.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new i,this.canvas.pdf=this}])}(ei.API),function(t){var i={left:0,top:0,bottom:0,right:0},e=!1,n=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},i),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var m=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return m},set:function(B){m=B}});var g=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return g},set:function(B){g=B}});var x=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return x},set:function(B){x=B}});var S=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return S},set:function(B){S=B}});var M=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return M},set:function(B){M=B}});var E=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return E},set:function(B){E=B}});var R=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return R},set:function(B){R=B}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(m){return n.call(this),this.internal.__cell__.headerFunction="function"==typeof m?m:void 0,this},t.getTextDimensions=function(m,g){n.call(this);var x=(g=g||{}).fontSize||this.getFontSize(),S=g.font||this.getFont(),M=g.scaleFactor||this.internal.scaleFactor,E=0,R=0,B=0,K=this;if(!Array.isArray(m)&&"string"!=typeof m){if("number"!=typeof m)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");m=String(m)}var q=g.maxWidth;q>0?"string"==typeof m?m=this.splitTextToSize(m,q):"[object Array]"===Object.prototype.toString.call(m)&&(m=m.reduce(function(ce,De){return ce.concat(K.splitTextToSize(De,q))},[])):m=Array.isArray(m)?m:[m];for(var Y=0;Y<m.length;Y++)E<(B=this.getStringUnitWidth(m[Y],{font:S})*x)&&(E=B);return 0!==E&&(R=m.length),{w:E/=M,h:Math.max((R*x*this.getLineHeightFactor()-x*(this.getLineHeightFactor()-1))/M,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var m=this.internal.__cell__.margins||i;return this.internal.__cell__.lastCell=new o(m.left,m.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var c=t.cell=function(){var m;m=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var g=this.internal.__cell__.lastCell,x=this.internal.__cell__.padding,S=this.internal.__cell__.margins||i,M=this.internal.__cell__.tableHeaderRow,E=this.internal.__cell__.printHeaders;return void 0!==g.lineNumber&&(g.lineNumber===m.lineNumber?(m.x=(g.x||0)+(g.width||0),m.y=g.y||0):g.y+g.height+m.height+S.bottom>this.getPageHeight()?(this.cellAddPage(),m.y=S.top,E&&M&&(this.printHeaderRow(m.lineNumber,!0),m.y+=M[0].height)):m.y=g.y+g.height||m.y),void 0!==m.text[0]&&(this.rect(m.x,m.y,m.width,m.height,!0===e?"FD":void 0),"right"===m.align?this.text(m.text,m.x+m.width-x,m.y+x,{align:"right",baseline:"top"}):"center"===m.align?this.text(m.text,m.x+m.width/2,m.y+x,{align:"center",baseline:"top",maxWidth:m.width-x-x}):this.text(m.text,m.x+x,m.y+x,{align:"left",baseline:"top",maxWidth:m.width-x-x})),this.internal.__cell__.lastCell=m,this};t.table=function(m,g,x,S,M){if(n.call(this),!x)throw new Error("No data for PDF table.");var E,R,B,K,q=[],Y=[],ce=[],De={},Ye={},yt=[],Ge=[],Te=(M=M||{}).autoSize||!1,mt=!1!==M.printHeaders,vt=M.css&&void 0!==M.css["font-size"]?16*M.css["font-size"]:M.fontSize||12,fe=M.margins||Object.assign({width:this.getPageWidth()},i),de="number"==typeof M.padding?M.padding:3,Oe=M.headerBackgroundColor||"#c8c8c8",Ae=M.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=mt,this.internal.__cell__.margins=fe,this.internal.__cell__.table_font_size=vt,this.internal.__cell__.padding=de,this.internal.__cell__.headerBackgroundColor=Oe,this.internal.__cell__.headerTextColor=Ae,this.setFontSize(vt),null==S)Y=q=Object.keys(x[0]),ce=q.map(function(){return"left"});else if(Array.isArray(S)&&"object"===$r(S[0]))for(q=S.map(function(_t){return _t.name}),Y=S.map(function(_t){return _t.prompt||_t.name||""}),ce=S.map(function(_t){return _t.align||"left"}),E=0;E<S.length;E+=1)Ye[S[E].name]=S[E].width*(19.049976/25.4);else Array.isArray(S)&&"string"==typeof S[0]&&(Y=q=S,ce=q.map(function(){return"left"}));if(Te||Array.isArray(S)&&"string"==typeof S[0])for(E=0;E<q.length;E+=1){for(De[K=q[E]]=x.map(function(_t){return _t[K]}),this.setFont(void 0,"bold"),yt.push(this.getTextDimensions(Y[E],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),R=De[K],this.setFont(void 0,"normal"),B=0;B<R.length;B+=1)yt.push(this.getTextDimensions(R[B],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Ye[K]=Math.max.apply(null,yt)+de+de,yt=[]}if(mt){var Ct={};for(E=0;E<q.length;E+=1)Ct[q[E]]={},Ct[q[E]].text=Y[E],Ct[q[E]].align=ce[E];var Re=u.call(this,Ct,Ye);Ge=q.map(function(_t){return new o(m,g,Ye[_t],Re,Ct[_t].text,void 0,Ct[_t].align)}),this.setTableHeaderRow(Ge),this.printHeaderRow(1,!1)}var Je=S.reduce(function(_t,on){return _t[on.name]=on.align,_t},{});for(E=0;E<x.length;E+=1){"rowStart"in M&&M.rowStart instanceof Function&&M.rowStart({row:E,data:x[E]},this);var Ue=u.call(this,x[E],Ye);for(B=0;B<q.length;B+=1){var lt=x[E][q[B]];"cellStart"in M&&M.cellStart instanceof Function&&M.cellStart({row:E,col:B,data:lt},this),c.call(this,new o(m,g,Ye[q[B]],Ue,lt,E+2,Je[q[B]]))}}return this.internal.__cell__.table_x=m,this.internal.__cell__.table_y=g,this};var u=function(m,g){var x=this.internal.__cell__.padding,S=this.internal.__cell__.table_font_size,M=this.internal.scaleFactor;return Object.keys(m).map(function(E){var R=m[E];return this.splitTextToSize(R.hasOwnProperty("text")?R.text:R,g[E]-x-x)},this).map(function(E){return this.getLineHeightFactor()*E.length*S/M+x+x},this).reduce(function(E,R){return Math.max(E,R)},0)};t.setTableHeaderRow=function(m){n.call(this),this.internal.__cell__.tableHeaderRow=m},t.printHeaderRow=function(m,g){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var x;if(e=!0,"function"==typeof this.internal.__cell__.headerFunction){var S=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(S[0],S[1],S[2],S[3],void 0,-1)}this.setFont(void 0,"bold");for(var M=[],E=0;E<this.internal.__cell__.tableHeaderRow.length;E+=1){x=this.internal.__cell__.tableHeaderRow[E].clone(),g&&(x.y=this.internal.__cell__.margins.top||0,M.push(x)),x.lineNumber=m;var R=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),c.call(this,x),this.setTextColor(R)}M.length>0&&this.setTableHeaderRow(M),this.setFont(void 0,"normal"),e=!1}}(ei.API);var KR={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},YR=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],KA=GR(YR),XR=[100,200,300,400,500,600,700,800,900],yJ=GR(XR);function YA(t){var o,i=t.family.replace(/"|'/g,"").toLowerCase(),e=KR[o=(o=t.style)||"normal"]?o:"normal",n=function(o){return o?"number"==typeof o?o>=100&&o<=900&&o%100==0?o:400:/^\d00$/.test(o)?parseInt(o):"bold"===o?700:400:400}(t.weight),r=function(o){return"number"==typeof KA[o=o||"normal"]?o:"normal"}(t.stretch);return{family:i,style:e,weight:n,stretch:r,src:t.src||[],ref:t.ref||{name:i,style:[r,e,n].join(" ")}}}function QR(t,i,e,n){var r;for(r=e;r>=0&&r<i.length;r+=n)if(t[i[r]])return t[i[r]];for(r=e;r>=0&&r<i.length;r-=n)if(t[i[r]])return t[i[r]]}var bJ={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},JR={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function ZR(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function e7(t){return t.trimLeft()}function wJ(t,i){for(var e=0;e<t.length;){if(t.charAt(e)===i)return[t.substring(0,e),t.substring(e+1)];e+=1}return null}function CJ(t){var i=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===i?null:[i[0],t.substring(i[0].length)]}var KT,t7,n7,XA=["times"];(function(t){var i,e,n,r,o,c,u,m,g,x=function(ne){return this.isStrokeTransparent=(ne=ne||{}).isStrokeTransparent||!1,this.strokeOpacity=ne.strokeOpacity||1,this.strokeStyle=ne.strokeStyle||"#000000",this.fillStyle=ne.fillStyle||"#000000",this.isFillTransparent=ne.isFillTransparent||!1,this.fillOpacity=ne.fillOpacity||1,this.font=ne.font||"10px sans-serif",this.textBaseline=ne.textBaseline||"alphabetic",this.textAlign=ne.textAlign||"left",this.lineWidth=ne.lineWidth||1,this.lineJoin=ne.lineJoin||"miter",this.lineCap=ne.lineCap||"butt",this.path=ne.path||[],this.transform=void 0!==ne.transform?ne.transform.clone():new m,this.globalCompositeOperation=ne.globalCompositeOperation||"normal",this.globalAlpha=ne.globalAlpha||1,this.clip_path=ne.clip_path||[],this.currentPoint=ne.currentPoint||new c,this.miterLimit=ne.miterLimit||10,this.lastPoint=ne.lastPoint||new c,this.lineDashOffset=ne.lineDashOffset||0,this.lineDash=ne.lineDash||[],this.margin=ne.margin||[0,0,0,0],this.prevPageLastElemOffset=ne.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof ne.ignoreClearRect||ne.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new S(this),i=this.internal.f2,e=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,c=this.internal.Point,u=this.internal.Rectangle,m=this.internal.Matrix,g=new x}]);var S=function(ne){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var ve=ne;Object.defineProperty(this,"pdf",{get:function(){return ve}});var we=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return we},set:function(At){we=Boolean(At)}});var je=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return je},set:function(At){je=Boolean(At)}});var Ze=0;Object.defineProperty(this,"posX",{get:function(){return Ze},set:function(At){isNaN(At)||(Ze=At)}});var it=0;Object.defineProperty(this,"posY",{get:function(){return it},set:function(At){isNaN(At)||(it=At)}}),Object.defineProperty(this,"margin",{get:function(){return g.margin},set:function(At){var ke;"number"==typeof At?ke=[At,At,At,At]:((ke=new Array(4))[0]=At[0],ke[1]=At.length>=2?At[1]:ke[0],ke[2]=At.length>=3?At[2]:ke[0],ke[3]=At.length>=4?At[3]:ke[1]),g.margin=ke}});var ct=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ct},set:function(At){ct=At}});var pt=0;Object.defineProperty(this,"lastBreak",{get:function(){return pt},set:function(At){pt=At}});var qt=[];Object.defineProperty(this,"pageBreaks",{get:function(){return qt},set:function(At){qt=At}}),Object.defineProperty(this,"ctx",{get:function(){return g},set:function(At){At instanceof x&&(g=At)}}),Object.defineProperty(this,"path",{get:function(){return g.path},set:function(At){g.path=At}});var Gt=[];Object.defineProperty(this,"ctxStack",{get:function(){return Gt},set:function(At){Gt=At}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(At){var ke;ke=M(At),this.ctx.fillStyle=ke.style,this.ctx.isFillTransparent=0===ke.a,this.ctx.fillOpacity=ke.a,this.pdf.setFillColor(ke.r,ke.g,ke.b,{a:ke.a}),this.pdf.setTextColor(ke.r,ke.g,ke.b,{a:ke.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(At){var ke=M(At);this.ctx.strokeStyle=ke.style,this.ctx.isStrokeTransparent=0===ke.a,this.ctx.strokeOpacity=ke.a,0===ke.a?this.pdf.setDrawColor(255,255,255):this.pdf.setDrawColor(ke.r,ke.g,ke.b)}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(At){-1!==["butt","round","square"].indexOf(At)&&(this.ctx.lineCap=At,this.pdf.setLineCap(At))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(At){isNaN(At)||(this.ctx.lineWidth=At,this.pdf.setLineWidth(At))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(At){-1!==["bevel","round","miter"].indexOf(At)&&(this.ctx.lineJoin=At,this.pdf.setLineJoin(At))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(At){isNaN(At)||(this.ctx.miterLimit=At,this.pdf.setMiterLimit(At))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(At){this.ctx.textBaseline=At}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(At){-1!==["right","end","center","left","start"].indexOf(At)&&(this.ctx.textAlign=At)}});var xn=null,oi=null;Object.defineProperty(this,"fontFaces",{get:function(){return oi},set:function(At){xn=null,oi=At}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(At){var ke;if(this.ctx.font=At,null!==(ke=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(At))){var Di=ke[1],Rn=ke[3],Kt=ke[4],cn=ke[6],yn=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Kt)[2];Kt=Math.floor("px"===yn?parseFloat(Kt)*this.pdf.internal.scaleFactor:"em"===yn?parseFloat(Kt)*this.pdf.getFontSize():parseFloat(Kt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Kt);var gn=function(di){var er,bn,$a=[],kr=di.trim();if(""===kr)return XA;if(kr in JR)return[JR[kr]];for(;""!==kr;){switch(bn=null,er=(kr=e7(kr)).charAt(0)){case'"':case"'":bn=wJ(kr.substring(1),er);break;default:bn=CJ(kr)}if(null===bn||($a.push(bn[0]),""!==(kr=e7(bn[1]))&&","!==kr.charAt(0)))return XA;kr=kr.replace(/^,/,"")}return $a}(cn);if(this.fontFaces){var $n=function xJ(t,i,e){for(var n=(e=e||{}).defaultFontFamily||"times",r=Object.assign({},bJ,e.genericFontFamilies||{}),o=null,c=null,u=0;u<i.length;++u)if(r[(o=YA(i[u])).family]&&(o.family=r[o.family]),t.hasOwnProperty(o.family)){c=t[o.family];break}if(!(c=c||t[n]))throw new Error("Could not find a font-family for the rule '"+ZR(o)+"' and default family '"+n+"'.");if(c=function(m,g){if(g[m])return g[m];var x=KA[m],M=QR(g,YR,x,x<=KA.normal?-1:1);if(!M)throw new Error("Could not find a matching font-stretch value for "+m);return M}(o.stretch,c),c=function(m,g){if(g[m])return g[m];for(var x=KR[m],S=0;S<x.length;++S)if(g[x[S]])return g[x[S]];throw new Error("Could not find a matching font-style for "+m)}(o.style,c),!(c=function(m,g){if(g[m])return g[m];if(400===m&&g[500])return g[500];if(500===m&&g[400])return g[400];var S=QR(g,XR,yJ[m],m<400?-1:1);if(!S)throw new Error("Could not find a matching font-weight for value "+m);return S}(o.weight,c)))throw new Error("Failed to resolve a font for the rule '"+ZR(o)+"'.");return c}(function En(At,ke){if(null===xn){var Di=(Rn=At.getFontList(),Kt=[],Object.keys(Rn).forEach(function(cn){Rn[cn].forEach(function(yn){var gn=null;switch(yn){case"bold":gn={family:cn,weight:"bold"};break;case"italic":gn={family:cn,style:"italic"};break;case"bolditalic":gn={family:cn,weight:"bold",style:"italic"};break;case"":case"normal":gn={family:cn}}null!==gn&&(gn.ref={name:cn,style:yn},Kt.push(gn))})}),Kt);xn=function(Rn){for(var Kt={},cn=0;cn<Rn.length;++cn){var yn=YA(Rn[cn]),gn=yn.family,$n=yn.stretch,xi=yn.style,Bi=yn.weight;Kt[gn]=Kt[gn]||{},Kt[gn][$n]=Kt[gn][$n]||{},Kt[gn][$n][xi]=Kt[gn][$n][xi]||{},Kt[gn][$n][xi][Bi]=yn}return Kt}(Di.concat(ke))}var Rn,Kt;return xn}(this.pdf,this.fontFaces),gn.map(function(di){return{family:di,stretch:"normal",weight:Rn,style:Di}}));this.pdf.setFont($n.ref.name,$n.ref.style)}else{var xi="";("bold"===Rn||parseInt(Rn,10)>=700||"bold"===Di)&&(xi="bold"),"italic"===Di&&(xi+="italic"),0===xi.length&&(xi="normal");for(var Bi="",Ki={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},vr=0;vr<gn.length;vr++){if(void 0!==this.pdf.internal.getFont(gn[vr],xi,{noFallback:!0,disableWarning:!0})){Bi=gn[vr];break}if("bolditalic"===xi&&void 0!==this.pdf.internal.getFont(gn[vr],"bold",{noFallback:!0,disableWarning:!0}))Bi=gn[vr],xi="bold";else if(void 0!==this.pdf.internal.getFont(gn[vr],"normal",{noFallback:!0,disableWarning:!0})){Bi=gn[vr],xi="normal";break}}if(""===Bi)for(var Zr=0;Zr<gn.length;Zr++)if(Ki[gn[Zr]]){Bi=Ki[gn[Zr]];break}this.pdf.setFont(Bi=""===Bi?"Times":Bi,xi)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(At){this.ctx.globalCompositeOperation=At}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(At){this.ctx.globalAlpha=At}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(At){this.ctx.lineDashOffset=At,on.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(At){this.ctx.lineDash=At,on.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(At){this.ctx.ignoreClearRect=Boolean(At)}})};S.prototype.setLineDash=function(ne){this.lineDash=ne},S.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},S.prototype.fill=function(){De.call(this,"fill",!1)},S.prototype.stroke=function(){De.call(this,"stroke",!1)},S.prototype.beginPath=function(){this.path=[{type:"begin"}]},S.prototype.moveTo=function(ne,ve){if(isNaN(ne)||isNaN(ve))throw ro.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var we=this.ctx.transform.applyToPoint(new c(ne,ve));this.path.push({type:"mt",x:we.x,y:we.y}),this.ctx.lastPoint=new c(ne,ve)},S.prototype.closePath=function(){var ne=new c(0,0),ve=0;for(ve=this.path.length-1;-1!==ve;ve--)if("begin"===this.path[ve].type&&"object"===$r(this.path[ve+1])&&"number"==typeof this.path[ve+1].x){ne=new c(this.path[ve+1].x,this.path[ve+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new c(ne.x,ne.y)},S.prototype.lineTo=function(ne,ve){if(isNaN(ne)||isNaN(ve))throw ro.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var we=this.ctx.transform.applyToPoint(new c(ne,ve));this.path.push({type:"lt",x:we.x,y:we.y}),this.ctx.lastPoint=new c(we.x,we.y)},S.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),De.call(this,null,!0)},S.prototype.quadraticCurveTo=function(ne,ve,we,je){if(isNaN(we)||isNaN(je)||isNaN(ne)||isNaN(ve))throw ro.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Ze=this.ctx.transform.applyToPoint(new c(we,je)),it=this.ctx.transform.applyToPoint(new c(ne,ve));this.path.push({type:"qct",x1:it.x,y1:it.y,x:Ze.x,y:Ze.y}),this.ctx.lastPoint=new c(Ze.x,Ze.y)},S.prototype.bezierCurveTo=function(ne,ve,we,je,Ze,it){if(isNaN(Ze)||isNaN(it)||isNaN(ne)||isNaN(ve)||isNaN(we)||isNaN(je))throw ro.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ct=this.ctx.transform.applyToPoint(new c(Ze,it)),pt=this.ctx.transform.applyToPoint(new c(ne,ve)),qt=this.ctx.transform.applyToPoint(new c(we,je));this.path.push({type:"bct",x1:pt.x,y1:pt.y,x2:qt.x,y2:qt.y,x:ct.x,y:ct.y}),this.ctx.lastPoint=new c(ct.x,ct.y)},S.prototype.arc=function(ne,ve,we,je,Ze,it){if(isNaN(ne)||isNaN(ve)||isNaN(we)||isNaN(je)||isNaN(Ze))throw ro.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(it=Boolean(it),!this.ctx.transform.isIdentity){var ct=this.ctx.transform.applyToPoint(new c(ne,ve));ne=ct.x,ve=ct.y;var pt=this.ctx.transform.applyToPoint(new c(0,we)),qt=this.ctx.transform.applyToPoint(new c(0,0));we=Math.sqrt(Math.pow(pt.x-qt.x,2)+Math.pow(pt.y-qt.y,2))}Math.abs(Ze-je)>=2*Math.PI&&(je=0,Ze=2*Math.PI),this.path.push({type:"arc",x:ne,y:ve,radius:we,startAngle:je,endAngle:Ze,counterclockwise:it})},S.prototype.arcTo=function(ne,ve,we,je,Ze){throw new Error("arcTo not implemented.")},S.prototype.rect=function(ne,ve,we,je){if(isNaN(ne)||isNaN(ve)||isNaN(we)||isNaN(je))throw ro.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(ne,ve),this.lineTo(ne+we,ve),this.lineTo(ne+we,ve+je),this.lineTo(ne,ve+je),this.lineTo(ne,ve),this.lineTo(ne+we,ve),this.lineTo(ne,ve)},S.prototype.fillRect=function(ne,ve,we,je){if(isNaN(ne)||isNaN(ve)||isNaN(we)||isNaN(je))throw ro.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!E.call(this)){var Ze={};"butt"!==this.lineCap&&(Ze.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(Ze.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(ne,ve,we,je),this.fill(),Ze.hasOwnProperty("lineCap")&&(this.lineCap=Ze.lineCap),Ze.hasOwnProperty("lineJoin")&&(this.lineJoin=Ze.lineJoin)}},S.prototype.strokeRect=function(ne,ve,we,je){if(isNaN(ne)||isNaN(ve)||isNaN(we)||isNaN(je))throw ro.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");R.call(this)||(this.beginPath(),this.rect(ne,ve,we,je),this.stroke())},S.prototype.clearRect=function(ne,ve,we,je){if(isNaN(ne)||isNaN(ve)||isNaN(we)||isNaN(je))throw ro.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(ne,ve,we,je))},S.prototype.save=function(ne){ne="boolean"!=typeof ne||ne;for(var ve=this.pdf.internal.getCurrentPageInfo().pageNumber,we=0;we<this.pdf.internal.getNumberOfPages();we++)this.pdf.setPage(we+1),this.pdf.internal.out("q");if(this.pdf.setPage(ve),ne){this.ctx.fontSize=this.pdf.internal.getFontSize();var je=new x(this.ctx);this.ctxStack.push(this.ctx),this.ctx=je}},S.prototype.restore=function(ne){ne="boolean"!=typeof ne||ne;for(var ve=this.pdf.internal.getCurrentPageInfo().pageNumber,we=0;we<this.pdf.internal.getNumberOfPages();we++)this.pdf.setPage(we+1),this.pdf.internal.out("Q");this.pdf.setPage(ve),ne&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},S.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var M=function(ne){var ve,we,je,Ze;if(!0===ne.isCanvasGradient&&(ne=ne.getColor()),!ne)return{r:0,g:0,b:0,a:0,style:ne};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(ne))ve=0,we=0,je=0,Ze=0;else{var it=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(ne);if(null!==it)ve=parseInt(it[1]),we=parseInt(it[2]),je=parseInt(it[3]),Ze=1;else if(null!==(it=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(ne)))ve=parseInt(it[1]),we=parseInt(it[2]),je=parseInt(it[3]),Ze=parseFloat(it[4]);else{if(Ze=1,"string"==typeof ne&&"#"!==ne.charAt(0)){var ct=new RR(ne);ne=ct.ok?ct.toHex():"#000000"}4===ne.length?(ve=ne.substring(1,2),ve+=ve,we=ne.substring(2,3),we+=we,je=ne.substring(3,4),je+=je):(ve=ne.substring(1,3),we=ne.substring(3,5),je=ne.substring(5,7)),ve=parseInt(ve,16),we=parseInt(we,16),je=parseInt(je,16)}}return{r:ve,g:we,b:je,a:Ze,style:ne}},E=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},R=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};S.prototype.fillText=function(ne,ve,we,je){if(isNaN(ve)||isNaN(we)||"string"!=typeof ne)throw ro.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(je=isNaN(je)?void 0:je,!E.call(this)){var Ze=Ue(this.ctx.transform.rotation),it=this.ctx.transform.scaleX;de.call(this,{text:ne,x:ve,y:we,scale:it,angle:Ze,align:this.textAlign,maxWidth:je})}},S.prototype.strokeText=function(ne,ve,we,je){if(isNaN(ve)||isNaN(we)||"string"!=typeof ne)throw ro.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!R.call(this)){je=isNaN(je)?void 0:je;var Ze=Ue(this.ctx.transform.rotation),it=this.ctx.transform.scaleX;de.call(this,{text:ne,x:ve,y:we,scale:it,renderingMode:"stroke",angle:Ze,align:this.textAlign,maxWidth:je})}},S.prototype.measureText=function(ne){if("string"!=typeof ne)throw ro.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var ve=this.pdf,we=this.pdf.internal.scaleFactor,je=ve.internal.getFontSize(),Ze=ve.getStringUnitWidth(ne)*je/ve.internal.scaleFactor,it=function(ct){var pt=(ct=ct||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return pt}}),this};return new it({width:Ze*=Math.round(96*we/72*1e4)/1e4})},S.prototype.scale=function(ne,ve){if(isNaN(ne)||isNaN(ve))throw ro.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var we=new m(ne,0,0,ve,0,0);this.ctx.transform=this.ctx.transform.multiply(we)},S.prototype.rotate=function(ne){if(isNaN(ne))throw ro.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var ve=new m(Math.cos(ne),Math.sin(ne),-Math.sin(ne),Math.cos(ne),0,0);this.ctx.transform=this.ctx.transform.multiply(ve)},S.prototype.translate=function(ne,ve){if(isNaN(ne)||isNaN(ve))throw ro.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var we=new m(1,0,0,1,ne,ve);this.ctx.transform=this.ctx.transform.multiply(we)},S.prototype.transform=function(ne,ve,we,je,Ze,it){if(isNaN(ne)||isNaN(ve)||isNaN(we)||isNaN(je)||isNaN(Ze)||isNaN(it))throw ro.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ct=new m(ne,ve,we,je,Ze,it);this.ctx.transform=this.ctx.transform.multiply(ct)},S.prototype.setTransform=function(ne,ve,we,je,Ze,it){ne=isNaN(ne)?1:ne,ve=isNaN(ve)?0:ve,we=isNaN(we)?0:we,je=isNaN(je)?1:je,Ze=isNaN(Ze)?0:Ze,it=isNaN(it)?0:it,this.ctx.transform=new m(ne,ve,we,je,Ze,it)};var B=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};S.prototype.drawImage=function(ne,ve,we,je,Ze,it,ct,pt,qt){var Gt=this.pdf.getImageProperties(ne),xn=1,En=1,oi=1,At=1;void 0!==je&&void 0!==pt&&(oi=pt/je,At=qt/Ze,xn=Gt.width/je*pt/je,En=Gt.height/Ze*qt/Ze),void 0===it&&(it=ve,ct=we,ve=0,we=0),void 0!==je&&void 0===pt&&(pt=je,qt=Ze),void 0===je&&void 0===pt&&(pt=Gt.width,qt=Gt.height);for(var ke,Di=this.ctx.transform.decompose(),Rn=Ue(Di.rotate.shx),Kt=new m,cn=(Kt=(Kt=(Kt=Kt.multiply(Di.translate)).multiply(Di.skew)).multiply(Di.scale)).applyToRectangle(new u(it-ve*oi,ct-we*At,je*xn,Ze*En)),yn=K.call(this,cn),gn=[],$n=0;$n<yn.length;$n+=1)-1===gn.indexOf(yn[$n])&&gn.push(yn[$n]);if(ce(gn),this.autoPaging)for(var xi=gn[0],Bi=gn[gn.length-1],Ki=xi;Ki<Bi+1;Ki++){this.pdf.setPage(Ki);var vr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Zr=1===Ki?this.posY+this.margin[0]:this.margin[0],er=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],bn=1===Ki?0:this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2]+(Ki-2)*er;if(0!==this.ctx.clip_path.length){var $a=this.path;ke=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Y(ke,this.posX+this.margin[3],-bn+Zr+this.ctx.prevPageLastElemOffset),Ye.call(this,"fill",!0),this.path=$a}var kr=JSON.parse(JSON.stringify(cn));kr=Y([kr],this.posX+this.margin[3],-bn+Zr+this.ctx.prevPageLastElemOffset)[0];var Mu=(Ki>xi||Ki<Bi)&&B.call(this);Mu&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],vr,er,null).clip().discardPath()),this.pdf.addImage(ne,"JPEG",kr.x,kr.y,kr.w,kr.h,null,null,Rn),Mu&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(ne,"JPEG",cn.x,cn.y,cn.w,cn.h,null,null,Rn)};var K=function(ne,ve,we){var je=[];ve=ve||this.pdf.internal.pageSize.width,we=we||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Ze=this.posY+this.ctx.prevPageLastElemOffset;switch(ne.type){default:case"mt":case"lt":je.push(Math.floor((ne.y+Ze)/we)+1);break;case"arc":je.push(Math.floor((ne.y+Ze-ne.radius)/we)+1),je.push(Math.floor((ne.y+Ze+ne.radius)/we)+1);break;case"qct":var it=lt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,ne.x1,ne.y1,ne.x,ne.y);je.push(Math.floor((it.y+Ze)/we)+1),je.push(Math.floor((it.y+it.h+Ze)/we)+1);break;case"bct":var ct=_t(this.ctx.lastPoint.x,this.ctx.lastPoint.y,ne.x1,ne.y1,ne.x2,ne.y2,ne.x,ne.y);je.push(Math.floor((ct.y+Ze)/we)+1),je.push(Math.floor((ct.y+ct.h+Ze)/we)+1);break;case"rect":je.push(Math.floor((ne.y+Ze)/we)+1),je.push(Math.floor((ne.y+ne.h+Ze)/we)+1)}for(var pt=0;pt<je.length;pt+=1)for(;this.pdf.internal.getNumberOfPages()<je[pt];)q.call(this);return je},q=function(){var ne=this.fillStyle,ve=this.strokeStyle,we=this.font,je=this.lineCap,Ze=this.lineWidth,it=this.lineJoin;this.pdf.addPage(),this.fillStyle=ne,this.strokeStyle=ve,this.font=we,this.lineCap=je,this.lineWidth=Ze,this.lineJoin=it},Y=function(ne,ve,we){for(var je=0;je<ne.length;je++)switch(ne[je].type){case"bct":ne[je].x2+=ve,ne[je].y2+=we;case"qct":ne[je].x1+=ve,ne[je].y1+=we;default:ne[je].x+=ve,ne[je].y+=we}return ne},ce=function(ne){return ne.sort(function(ve,we){return ve-we})},De=function(ne,ve){for(var we,je,Ze=this.fillStyle,it=this.strokeStyle,ct=this.lineCap,pt=this.lineWidth,qt=Math.abs(pt*this.ctx.transform.scaleX),Gt=this.lineJoin,xn=JSON.parse(JSON.stringify(this.path)),En=JSON.parse(JSON.stringify(this.path)),oi=[],At=0;At<En.length;At++)if(void 0!==En[At].x)for(var ke=K.call(this,En[At]),Di=0;Di<ke.length;Di+=1)-1===oi.indexOf(ke[Di])&&oi.push(ke[Di]);for(var Rn=0;Rn<oi.length;Rn++)for(;this.pdf.internal.getNumberOfPages()<oi[Rn];)q.call(this);if(ce(oi),this.autoPaging)for(var Kt=oi[0],cn=oi[oi.length-1],yn=Kt;yn<cn+1;yn++){this.pdf.setPage(yn),this.fillStyle=Ze,this.strokeStyle=it,this.lineCap=ct,this.lineWidth=qt,this.lineJoin=Gt;var gn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],$n=1===yn?this.posY+this.margin[0]:this.margin[0],Bi=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ki=1===yn?0:this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2]+(yn-2)*Bi;if(0!==this.ctx.clip_path.length){var vr=this.path;we=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Y(we,this.posX+this.margin[3],-Ki+$n+this.ctx.prevPageLastElemOffset),Ye.call(this,ne,!0),this.path=vr}if(je=JSON.parse(JSON.stringify(xn)),this.path=Y(je,this.posX+this.margin[3],-Ki+$n+this.ctx.prevPageLastElemOffset),!1===ve||0===yn){var Zr=(yn>Kt||yn<cn)&&B.call(this);Zr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],gn,Bi,null).clip().discardPath()),Ye.call(this,ne,ve),Zr&&this.pdf.restoreGraphicsState()}this.lineWidth=pt}else this.lineWidth=qt,Ye.call(this,ne,ve),this.lineWidth=pt;this.path=xn},Ye=function(ne,ve){if(("stroke"!==ne||ve||!R.call(this))&&("stroke"===ne||ve||!E.call(this))){for(var we,je,Ze=[],it=this.path,ct=0;ct<it.length;ct++){var pt=it[ct];switch(pt.type){case"begin":Ze.push({begin:!0});break;case"close":Ze.push({close:!0});break;case"mt":Ze.push({start:pt,deltas:[],abs:[]});break;case"lt":var qt=Ze.length;if(it[ct-1]&&!isNaN(it[ct-1].x)&&(we=[pt.x-it[ct-1].x,pt.y-it[ct-1].y],qt>0))for(;qt>=0;qt--)if(!0!==Ze[qt-1].close&&!0!==Ze[qt-1].begin){Ze[qt-1].deltas.push(we),Ze[qt-1].abs.push(pt);break}break;case"bct":Ze[Ze.length-1].deltas.push(we=[pt.x1-it[ct-1].x,pt.y1-it[ct-1].y,pt.x2-it[ct-1].x,pt.y2-it[ct-1].y,pt.x-it[ct-1].x,pt.y-it[ct-1].y]);break;case"qct":Ze[Ze.length-1].deltas.push(we=[it[ct-1].x+2/3*(pt.x1-it[ct-1].x)-it[ct-1].x,it[ct-1].y+2/3*(pt.y1-it[ct-1].y)-it[ct-1].y,pt.x+2/3*(pt.x1-pt.x)-it[ct-1].x,pt.y+2/3*(pt.y1-pt.y)-it[ct-1].y,pt.x-it[ct-1].x,pt.y-it[ct-1].y]);break;case"arc":Ze.push({deltas:[],abs:[],arc:!0}),Array.isArray(Ze[Ze.length-1].abs)&&Ze[Ze.length-1].abs.push(pt)}}je=ve?null:"stroke"===ne?"stroke":"fill";for(var Di=!1,Rn=0;Rn<Ze.length;Rn++)if(Ze[Rn].arc)for(var Kt=Ze[Rn].abs,cn=0;cn<Kt.length;cn++){var yn=Kt[cn];"arc"===yn.type?Te.call(this,yn.x,yn.y,yn.radius,yn.startAngle,yn.endAngle,yn.counterclockwise,void 0,ve,!Di):Oe.call(this,yn.x,yn.y),Di=!0}else!0===Ze[Rn].close?(this.pdf.internal.out("h"),Di=!1):!0!==Ze[Rn].begin&&(Ae.call(this,Ze[Rn].deltas,Ze[Rn].start.x,Ze[Rn].start.y),Di=!0);je&&mt.call(this,je),ve&&vt.call(this)}},yt=function(ne){var ve=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,we=ve*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return ne-we;case"top":return ne+ve-we;case"hanging":return ne+ve-2*we;case"middle":return ne+ve/2-we;default:return ne}},Ge=function(ne){return ne+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};S.prototype.createLinearGradient=function(){var ne=function(){};return ne.colorStops=[],ne.addColorStop=function(ve,we){this.colorStops.push([ve,we])},ne.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},ne.isCanvasGradient=!0,ne},S.prototype.createPattern=function(){return this.createLinearGradient()},S.prototype.createRadialGradient=function(){return this.createLinearGradient()};var Te=function(ne,ve,we,je,Ze,it,ct,pt,qt){for(var Gt=Re.call(this,we,je,Ze,it),xn=0;xn<Gt.length;xn++){var En=Gt[xn];0===xn&&(qt?fe.call(this,En.x1+ne,En.y1+ve):Oe.call(this,En.x1+ne,En.y1+ve)),Ct.call(this,ne,ve,En.x2,En.y2,En.x3,En.y3,En.x4,En.y4)}pt?vt.call(this):mt.call(this,ct)},mt=function(ne){switch(ne){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},vt=function(){this.pdf.clip(),this.pdf.discardPath()},fe=function(ne,ve){this.pdf.internal.out(e(ne)+" "+n(ve)+" m")},de=function(ne){var ve;switch(ne.align){case"right":case"end":ve="right";break;case"center":ve="center";break;default:ve="left"}var we=this.pdf.getTextDimensions(ne.text),je=yt.call(this,ne.y),Ze=Ge.call(this,je)-we.h,it=this.ctx.transform.applyToPoint(new c(ne.x,je)),ct=this.ctx.transform.decompose(),pt=new m;pt=(pt=(pt=pt.multiply(ct.translate)).multiply(ct.skew)).multiply(ct.scale);for(var qt,Gt,xn,En=this.ctx.transform.applyToRectangle(new u(ne.x,je,we.w,we.h)),oi=pt.applyToRectangle(new u(ne.x,Ze,we.w,we.h)),At=K.call(this,oi),ke=[],Di=0;Di<At.length;Di+=1)-1===ke.indexOf(At[Di])&&ke.push(At[Di]);if(ce(ke),this.autoPaging)for(var Rn=ke[0],Kt=ke[ke.length-1],cn=Rn;cn<Kt+1;cn++){this.pdf.setPage(cn);var yn=1===cn?this.posY+this.margin[0]:this.margin[0],$n=this.pdf.internal.pageSize.height-this.margin[2],xi=$n-this.margin[0],Bi=this.pdf.internal.pageSize.width-this.margin[1],Ki=Bi-this.margin[3],vr=1===cn?0:this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2]+(cn-2)*xi;if(0!==this.ctx.clip_path.length){var Zr=this.path;qt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Y(qt,this.posX+this.margin[3],-1*vr+yn),Ye.call(this,"fill",!0),this.path=Zr}var di=Y([JSON.parse(JSON.stringify(oi))],this.posX+this.margin[3],-vr+yn+this.ctx.prevPageLastElemOffset)[0];ne.scale>=.01&&(Gt=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Gt*ne.scale),this.lineWidth=(xn=this.lineWidth)*ne.scale);var er="text"!==this.autoPaging;if(er||di.y+di.h<=$n){if(er||di.y>=yn&&di.x<=Bi){var bn=er?ne.text:this.pdf.splitTextToSize(ne.text,ne.maxWidth||Bi-di.x)[0],$a=Y([JSON.parse(JSON.stringify(En))],this.posX+this.margin[3],-vr+yn+this.ctx.prevPageLastElemOffset)[0],kr=er&&(cn>Rn||cn<Kt)&&B.call(this);kr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ki,xi,null).clip().discardPath()),this.pdf.text(bn,$a.x,$a.y,{angle:ne.angle,align:ve,renderingMode:ne.renderingMode}),kr&&this.pdf.restoreGraphicsState()}}else di.y<$n&&(this.ctx.prevPageLastElemOffset+=$n-di.y);ne.scale>=.01&&(this.pdf.setFontSize(Gt),this.lineWidth=xn)}else ne.scale>=.01&&(Gt=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Gt*ne.scale),this.lineWidth=(xn=this.lineWidth)*ne.scale),this.pdf.text(ne.text,it.x+this.posX,it.y+this.posY,{angle:ne.angle,align:ve,renderingMode:ne.renderingMode,maxWidth:ne.maxWidth}),ne.scale>=.01&&(this.pdf.setFontSize(Gt),this.lineWidth=xn)},Oe=function(ne,ve,we,je){je=je||0,this.pdf.internal.out(e(ne+(we=we||0))+" "+n(ve+je)+" l")},Ae=function(ne,ve,we){return this.pdf.lines(ne,ve,we,null,null)},Ct=function(ne,ve,we,je,Ze,it,ct,pt){this.pdf.internal.out([i(r(we+ne)),i(o(je+ve)),i(r(Ze+ne)),i(o(it+ve)),i(r(ct+ne)),i(o(pt+ve)),"c"].join(" "))},Re=function(ne,ve,we,je){for(var Ze=2*Math.PI,it=Math.PI/2;ve>we;)ve-=Ze;var ct=Math.abs(we-ve);ct<Ze&&je&&(ct=Ze-ct);for(var pt=[],qt=je?-1:1,Gt=ve;ct>1e-5;){var xn=Gt+qt*Math.min(ct,it);pt.push(Je.call(this,ne,Gt,xn)),ct-=Math.abs(xn-Gt),Gt=xn}return pt},Je=function(ne,ve,we){var je=(we-ve)/2,Ze=ne*Math.cos(je),it=ne*Math.sin(je),ct=Ze,pt=-it,qt=ct*ct+pt*pt,Gt=qt+ct*Ze+pt*it,xn=4/3*(Math.sqrt(2*qt*Gt)-Gt)/(ct*it-pt*Ze),En=ct-xn*pt,oi=pt+xn*ct,At=En,ke=-oi,Di=je+ve,Rn=Math.cos(Di),Kt=Math.sin(Di);return{x1:ne*Math.cos(ve),y1:ne*Math.sin(ve),x2:En*Rn-oi*Kt,y2:En*Kt+oi*Rn,x3:At*Rn-ke*Kt,y3:At*Kt+ke*Rn,x4:ne*Math.cos(we),y4:ne*Math.sin(we)}},Ue=function(ne){return 180*ne/Math.PI},lt=function(ne,ve,we,je,Ze,it){var ct=ne+.5*(we-ne),pt=ve+.5*(je-ve),qt=Ze+.5*(we-Ze),Gt=it+.5*(je-it),xn=Math.min(ne,Ze,ct,qt),En=Math.max(ne,Ze,ct,qt),oi=Math.min(ve,it,pt,Gt),At=Math.max(ve,it,pt,Gt);return new u(xn,oi,En-xn,At-oi)},_t=function(ne,ve,we,je,Ze,it,ct,pt){var qt,Gt,xn,En,oi,At,ke,Di,Rn,Kt,cn,yn,gn,$n,xi=we-ne,Bi=je-ve,Ki=Ze-we,vr=it-je,Zr=ct-Ze,di=pt-it;for(Gt=0;Gt<41;Gt++)Rn=(ke=(xn=ne+(qt=Gt/40)*xi)+qt*((oi=we+qt*Ki)-xn))+qt*(oi+qt*(Ze+qt*Zr-oi)-ke),Kt=(Di=(En=ve+qt*Bi)+qt*((At=je+qt*vr)-En))+qt*(At+qt*(it+qt*di-At)-Di),0==Gt?(cn=Rn,yn=Kt,gn=Rn,$n=Kt):(cn=Math.min(cn,Rn),yn=Math.min(yn,Kt),gn=Math.max(gn,Rn),$n=Math.max($n,Kt));return new u(Math.round(cn),Math.round(yn),Math.round(gn-cn),Math.round($n-yn))},on=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var we=JSON.stringify({lineDash:this.ctx.lineDash,lineDashOffset:this.ctx.lineDashOffset});this.prevLineDash!==we&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=we)}}})(ei.API),function(t){var i=function(o){var c,u,m,g,x,S,M,E,R,B;for(/[^\x00-\xFF]/.test(o),u=[],m=0,g=(o+=c="\0\0\0\0".slice(o.length%4||4)).length;g>m;m+=4)0!==(x=(o.charCodeAt(m)<<24)+(o.charCodeAt(m+1)<<16)+(o.charCodeAt(m+2)<<8)+o.charCodeAt(m+3))?(S=(x=((x=((x=((x=(x-(B=x%85))/85)-(R=x%85))/85)-(E=x%85))/85)-(M=x%85))/85)%85,u.push(S+33,M+33,E+33,R+33,B+33)):u.push(122);return function(K,q){for(var Y=q;Y>0;Y--)K.pop()}(u,c.length),String.fromCharCode.apply(String,u)+"~>"},e=function(o){var c,u,m,g,x,S=String,M="length",E=255,R="charCodeAt",B="slice",K="replace";for(o[B](-2),o=o[B](0,-2)[K](/\s/g,"")[K]("z","!!!!!"),m=[],g=0,x=(o+=c="uuuuu"[B](o[M]%5||5))[M];x>g;g+=5)u=52200625*(o[R](g)-33)+614125*(o[R](g+1)-33)+7225*(o[R](g+2)-33)+85*(o[R](g+3)-33)+(o[R](g+4)-33),m.push(E&u>>24,E&u>>16,E&u>>8,E&u);return function(q,Y){for(var ce=Y;ce>0;ce--)q.pop()}(m,c[M]),S.fromCharCode.apply(S,m)},n=function(o){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(o=o.replace(/\s/g,"")).indexOf(">")&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),!1===c.test(o))return"";for(var u="",m=0;m<o.length;m+=2)u+=String.fromCharCode("0x"+(o[m]+o[m+1]));return u},r=function(o){for(var c=new Uint8Array(o.length),u=o.length;u--;)c[u]=o.charCodeAt(u);return(c=Jy(c)).reduce(function(m,g){return m+String.fromCharCode(g)},"")};t.processDataByFilters=function(o,c){var u=0,m=o||"",g=[];for("string"==typeof(c=c||[])&&(c=[c]),u=0;u<c.length;u+=1)switch(c[u]){case"ASCII85Decode":case"/ASCII85Decode":m=e(m),g.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":m=i(m),g.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":m=n(m),g.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":m=m.split("").map(function(x){return("0"+x.charCodeAt().toString(16)).slice(-2)}).join("")+">",g.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":m=r(m),g.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[u]+'" is not implemented')}return{data:m,reverseChain:g.reverse().join(" ")}}}(ei.API),function(t){t.loadFile=function(i,e,n){return function(r,o,c){o=!1!==o,c="function"==typeof c?c:function(){};var u=void 0;try{u=function(m,g,x){var S=new XMLHttpRequest,M=0,E=function(R){var B=R.length,K=[],q=String.fromCharCode;for(M=0;M<B;M+=1)K.push(q(255&R.charCodeAt(M)));return K.join("")};if(S.open("GET",m,!g),S.overrideMimeType("text/plain; charset=x-user-defined"),!1===g&&(S.onload=function(){x(200===S.status?E(this.responseText):void 0)}),S.send(null),g&&200===S.status)return E(S.responseText)}(r,o,c)}catch(m){}return u}(i,e,n)},t.loadImageFile=t.loadFile}(ei.API),function(t){function i(){return(ri.html2canvas?Promise.resolve(ri.html2canvas):vo.e(159).then(vo.t.bind(vo,4159,23))).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function e(){return(ri.DOMPurify?Promise.resolve(ri.DOMPurify):vo.e(735).then(vo.t.bind(vo,2735,23))).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var n=function(c){var u=$r(c);return"undefined"===u?"undefined":"string"===u||c instanceof String?"string":"number"===u||c instanceof Number?"number":"function"===u||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&1===c.nodeType?"element":"object"===u?"object":"unknown"},r=function(c,u){var m=document.createElement(c);for(var g in u.className&&(m.className=u.className),u.innerHTML&&u.dompurify&&(m.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)m.style[g]=u.style[g];return m},o=function c(u){var m=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),g=c.convert(Promise.resolve(),m);return(g=g.setProgress(1,c,1,[c])).set(u)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(c,u){return c.__proto__=u||o.prototype,c},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(c,u){return this.then(function(){switch(u=u||function(m){switch(n(m)){case"string":return"string";case"element":return"canvas"===m.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(c)){case"string":return this.then(e).then(function(m){return this.set({src:r("div",{innerHTML:c,dompurify:m})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},o.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=function m(g,x){for(var S=3===g.nodeType?document.createTextNode(g.nodeValue):g.cloneNode(!1),M=g.firstChild;M;M=M.nextSibling)!0!==x&&1===M.nodeType&&"SCRIPT"===M.nodeName||S.appendChild(m(M,x));return 1===g.nodeType&&("CANVAS"===g.nodeName?(S.width=g.width,S.height=g.height,S.getContext("2d").drawImage(g,0,0)):"TEXTAREA"!==g.nodeName&&"SELECT"!==g.nodeName||(S.value=g.value),S.addEventListener("load",function(){S.scrollTop=g.scrollTop,S.scrollLeft=g.scrollLeft},!0)),S}(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===u.tagName&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){return this.thenList([function(){return document.body.contains(this.prop.container)||this.toContainer()}]).then(i).then(function(u){var m=Object.assign({},this.opt.html2canvas);return delete m.onrendered,u(this.prop.container,m)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){return this.thenList([function(){return document.body.contains(this.prop.container)||this.toContainer()}]).then(i).then(function(u){var m=this.opt.jsPDF,g=this.opt.fontFaces,x="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,S=Object.assign({async:!0,allowTaint:!0,scale:x,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete S.onrendered,m.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,m.context2d.posX=this.opt.x,m.context2d.posY=this.opt.y,m.context2d.margin=this.opt.margin,m.context2d.fontFaces=g,g)for(var M=0;M<g.length;++M){var E=g[M],R=E.src.find(function(B){return"truetype"===B.format});R&&m.addFont(R.url,E.ref.name,E.ref.style)}return S.windowHeight=S.windowHeight||0,S.windowHeight=0==S.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):S.windowHeight,m.context2d.save(!0),u(this.prop.container,S)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(c,u,m){return"img"===(m=m||"pdf").toLowerCase()||"image"===m.toLowerCase()?this.outputImg(c,u):this.outputPdf(c,u)},o.prototype.outputPdf=function(c,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,u)})},o.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},o.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(c){if("object"!==n(c))return this;var u=Object.keys(c||{}).map(function(m){if(m in o.template.prop)return function(){this.prop[m]=c[m]};switch(m){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[m]=c[m]}}},this);return this.then(function(){return this.thenList(u)})},o.prototype.get=function(c,u){return this.then(function(){var m=c in o.template.prop?this.prop[c]:this.opt[c];return u?u(m):m})},o.prototype.setMargin=function(c){return this.then(function(){switch(n(c)){case"number":c=[c,c,c,c];case"array":if(2===c.length&&(c=[c[0],c[1],c[0],c[1]]),4===c.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},o.prototype.setPageSize=function(c){function u(m,g){return Math.floor(m*g/72*96)}return this.then(function(){(c=c||ei.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:u(c.inner.width,c.k),height:u(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},o.prototype.setProgress=function(c,u,m,g){return null!=c&&(this.progress.val=c),null!=u&&(this.progress.state=u),null!=m&&(this.progress.n=m),null!=g&&(this.progress.stack=g),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(c,u,m,g){return this.setProgress(c?this.progress.val+c:null,u||null,m?this.progress.n+m:null,g?this.progress.stack.concat(g):null)},o.prototype.then=function(c,u){var m=this;return this.thenCore(c,u,function(g,x){return m.updateProgress(null,null,1,[g]),Promise.prototype.then.call(this,function(S){return m.updateProgress(null,g),S}).then(g,x).then(function(S){return m.updateProgress(1),S})})},o.prototype.thenCore=function(c,u,m){m=m||Promise.prototype.then,c&&(c=c.bind(this)),u&&(u=u.bind(this));var g=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?this:o.convert(Object.assign({},this),Promise.prototype),x=m.call(g,c,u);return o.convert(x,this.__proto__)},o.prototype.thenExternal=function(c,u){return Promise.prototype.then.call(this,c,u)},o.prototype.thenList=function(c){var u=this;return c.forEach(function(m){u=u.thenCore(m)}),u},o.prototype.catch=function(c){c&&(c=c.bind(this));var u=Promise.prototype.catch.call(this,c);return o.convert(u,this)},o.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},o.prototype.error=function(c){return this.then(function(){throw new Error(c)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,ei.getPageSize=function(c,u,m){if("object"===$r(c)){var g=c;c=g.orientation,u=g.unit||u,m=g.format||m}u=u||"mm",m=m||"a4",c=(""+(c||"P")).toLowerCase();var x,S=(""+m).toLowerCase(),M={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":x=1;break;case"mm":x=72/25.4;break;case"cm":x=72/2.54;break;case"in":x=72;break;case"px":x=.75;break;case"pc":case"em":x=12;break;case"ex":x=6;break;default:throw"Invalid unit: "+u}var E,R=0,B=0;if(M.hasOwnProperty(S))R=M[S][1]/x,B=M[S][0]/x;else try{R=m[1],B=m[0]}catch(K){throw new Error("Invalid format: "+m)}if("p"===c||"portrait"===c)c="p",B>R&&(E=B,B=R,R=E);else{if("l"!==c&&"landscape"!==c)throw"Invalid orientation: "+c;c="l",R>B&&(E=B,B=R,R=E)}return{width:B,height:R,unit:u,k:x,orientation:c}},t.html=function(c,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(YA):null;var m=new o(u);return u.worker?m:m.from(c).doCallback()}}(ei.API),ei.API.addJS=function(t){return n7=t,this.internal.events.subscribe("postPutResources",function(){KT=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(KT+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),t7=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+n7+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==KT&&void 0!==t7&&this.internal.out("/Names <</JavaScript "+KT+" 0 R>>")}),this},function(t){var i;t.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=e.outline.render().split(/\r\n/),o=0;o<r.length;o++){var c=r[o],u=n.exec(c);null!=u&&e.internal.newObjectDeferredBegin(u[1],!1),e.internal.write(c)}if(this.outline.createNamedDestinations){var g=this.internal.pages.length,x=[];for(o=0;o<g;o++){var S=e.internal.newObject();x.push(S);var M=e.internal.getPageInfo(o+1);e.internal.write("<< /D["+M.objId+" 0 R /XYZ null null null]>> endobj")}var E=e.internal.newObject();for(e.internal.write("<< /Names [ "),o=0;o<x.length;o++)e.internal.write("(page_"+(o+1)+")"+x[o]+" 0 R");e.internal.write(" ] >>","endobj"),i=e.internal.newObject(),e.internal.write("<< /Dests "+E+" 0 R"),e.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+i+" 0 R"))}]),t.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(n,r,o){var c={title:r,options:o,children:[]};return null==n&&(n=this.root),n.children.push(c),c},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(n){n.id=e.internal.newObjectDeferred();for(var r=0;r<n.children.length;r++)this.genIds_r(n.children[r])},e.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},e.outline.renderItems=function(n){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var c=n.children[o];this.objStart(c),this.line("/Title "+this.makeString(c.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),c.children.length>0&&(this.line("/First "+this.makeRef(c.children[0])),this.line("/Last "+this.makeRef(c.children[c.children.length-1])));var u=this.count=this.count_r({count:0},c);if(u>0&&this.line("/Count "+u),c.options&&c.options.pageNumber){var m=e.internal.getPageInfo(c.options.pageNumber);this.line("/Dest ["+m.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var g=0;g<n.children.length;g++)this.renderItems(n.children[g])},e.outline.line=function(n){this.ctx.val+=n+"\r\n"},e.outline.makeRef=function(n){return n.id+" 0 R"},e.outline.makeString=function(n){return"("+e.internal.pdfEscape(n)+")"},e.outline.objStart=function(n){this.ctx.val+="\r\n"+n.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(n,r){for(var o=0;o<r.children.length;o++)n.count++,this.count_r(n,r.children[o]);return n.count}}])}(ei.API),function(t){var i=[192,193,194,195,196,197,198,199];t.processJPEG=function(e,n,r,o,c,u){var m,g=this.decode.DCT_DECODE,x=null;if("string"==typeof e||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=this.__addimage__.isArrayBuffer(e=c||e)?new Uint8Array(e):e,(m=function(S){for(var M,E=256*S.charCodeAt(4)+S.charCodeAt(5),R=S.length,B={width:0,height:0,numcomponents:1},K=4;K<R;K+=2){if(-1!==i.indexOf(S.charCodeAt((K+=E)+1))){M=256*S.charCodeAt(K+5)+S.charCodeAt(K+6),B={width:256*S.charCodeAt(K+7)+S.charCodeAt(K+8),height:M,numcomponents:S.charCodeAt(K+9)};break}E=256*S.charCodeAt(K+2)+S.charCodeAt(K+3)}return B}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:u=this.color_spaces.DEVICE_GRAY;break;case 4:u=this.color_spaces.DEVICE_CMYK;break;case 3:u=this.color_spaces.DEVICE_RGB}x={data:e,width:m.width,height:m.height,colorSpace:u,bitsPerComponent:8,filter:g,index:n,alias:r}}return x}}(ei.API);var e_,YT,r7,o7,s7,TJ=function(){var t,i,e;function n(o){var c,m,g,x,S,M,E,R,B,K,q,Y,ce;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},S=null;;){switch(c=this.readUInt32(),R=function(){var De,Ye;for(Ye=[],De=0;De<4;++De)Ye.push(String.fromCharCode(this.data[this.pos++]));return Ye}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(c);break;case"fcTL":S&&this.animation.frames.push(S),this.pos+=4,S={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},x=this.readUInt16(),g=this.readUInt16()||100,S.delay=1e3*x/g,S.disposeOp=this.data[this.pos++],S.blendOp=this.data[this.pos++],S.data=[];break;case"IDAT":case"fdAT":for("fdAT"===R&&(this.pos+=4,c-=4),o=(null!=S?S.data:void 0)||this.imgData,q=0;0<=c?q<c:q>c;0<=c?++q:--q)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(m=this.palette.length/3,this.transparency.indexed=this.read(c),this.transparency.indexed.length>m)throw new Error("More transparent colors than palette size");if((B=m-this.transparency.indexed.length)>0)for(Y=0;0<=B?Y<B:Y>B;0<=B?++Y:--Y)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(c)[0];break;case 2:this.transparency.rgb=this.read(c)}break;case"tEXt":M=(K=this.read(c)).indexOf(0),E=String.fromCharCode.apply(String,K.slice(0,M)),this.text[E]=String.fromCharCode.apply(String,K.slice(M+1));break;case"IEND":return S&&this.animation.frames.push(S),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(ce=this.colorType)||6===ce,this.pixelBitlength=this.bits*(this.colors+(this.hasAlphaChannel?1:0)),this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=c}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(o){var c,u;for(u=[],c=0;0<=o?c<o:c>o;0<=o?++c:--c)u.push(this.data[this.pos++]);return u},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(o){var c=this.pixelBitlength/8,u=new Uint8Array(this.width*this.height*c),m=0,g=this;if(null==o&&(o=this.imgData),0===o.length)return new Uint8Array(0);function x(S,M,E,R){var B,K,q,Y,ce,De,Ye,yt,Te,mt,vt,fe,de,Oe,Ae,Ct,Re,Je,Ue,lt,_t=Math.ceil((g.width-S)/E),on=Math.ceil((g.height-M)/R),ne=g.width==_t&&g.height==on;for(de=c*_t,vt=ne?u:new Uint8Array(de*on),De=o.length,fe=0,K=0;fe<on&&m<De;){switch(o[m++]){case 0:for(Y=Ct=0;Ct<de;Y=Ct+=1)vt[K++]=o[m++];break;case 1:for(Y=Re=0;Re<de;Y=Re+=1)B=o[m++],ce=Y<c?0:vt[K-c],vt[K++]=(B+ce)%256;break;case 2:for(Y=Je=0;Je<de;Y=Je+=1)B=o[m++],q=(Y-Y%c)/c,vt[K++]=((Oe=fe&&vt[(fe-1)*de+q*c+Y%c])+B)%256;break;case 3:for(Y=Ue=0;Ue<de;Y=Ue+=1)B=o[m++],q=(Y-Y%c)/c,ce=Y<c?0:vt[K-c],Oe=fe&&vt[(fe-1)*de+q*c+Y%c],vt[K++]=(B+Math.floor((ce+Oe)/2))%256;break;case 4:for(Y=lt=0;lt<de;Y=lt+=1)B=o[m++],q=(Y-Y%c)/c,0===fe?Oe=Ae=0:(Oe=vt[(fe-1)*de+q*c+Y%c],Ae=q&&vt[(fe-1)*de+(q-1)*c+Y%c]),Ye=(ce=Y<c?0:vt[K-c])+Oe-Ae,yt=Math.abs(Ye-ce),Te=Math.abs(Ye-Oe),mt=Math.abs(Ye-Ae),vt[K++]=(B+(yt<=Te&&yt<=mt?ce:Te<=mt?Oe:Ae))%256;break;default:throw new Error("Invalid filter algorithm: "+o[m-1])}if(!ne){var ve=((M+fe*R)*g.width+S)*c,we=fe*de;for(Y=0;Y<_t;Y+=1){for(var je=0;je<c;je+=1)u[ve++]=vt[we++];ve+=(E-1)*c}}fe++}}return o=RT(o),1==g.interlaceMethod?(x(0,0,8,8),x(4,0,8,8),x(0,4,4,8),x(2,0,4,4),x(0,2,2,4),x(1,0,2,2),x(0,1,1,2)):x(0,0,1,1),u},n.prototype.decodePalette=function(){var o,c,u,m,g,x,S,M,E;for(u=this.palette,x=this.transparency.indexed||[],g=new Uint8Array((x.length||0)+u.length),m=0,o=0,c=S=0,M=u.length;S<M;c=S+=3)g[m++]=u[c],g[m++]=u[c+1],g[m++]=u[c+2],g[m++]=null!=(E=x[o++])?E:255;return g},n.prototype.copyToImageData=function(o,c){var u,m,g,x,S,M,E,R,B,K,q;if(m=this.colors,B=null,u=this.hasAlphaChannel,this.palette.length&&(B=null!=(q=this._decodedPalette)?q:this._decodedPalette=this.decodePalette(),m=4,u=!0),R=(g=o.data||o).length,S=B||c,x=M=0,1===m)for(;x<R;)E=B?4*c[x/4]:M,K=S[E++],g[x++]=K,g[x++]=K,g[x++]=K,g[x++]=u?S[E++]:255,M=E;else for(;x<R;)E=B?4*c[x/4]:M,g[x++]=S[E++],g[x++]=S[E++],g[x++]=S[E++],g[x++]=u?S[E++]:255,M=E},n.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var r=function(){if("[object Window]"===Object.prototype.toString.call(ri)){try{i=ri.document.createElement("canvas"),e=i.getContext("2d")}catch(o){return!1}return!0}return!1};return r(),t=function(o){var c;if(!0===r())return e.width=o.width,e.height=o.height,e.clearRect(0,0,o.width,o.height),e.putImageData(o,0,0),(c=new Image).src=i.toDataURL(),c;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(o){var c,u,m,g,x,S,M,E;if(this.animation){for(E=[],u=x=0,S=(M=this.animation.frames).length;x<S;u=++x)m=o.createImageData((c=M[u]).width,c.height),g=this.decodePixels(new Uint8Array(c.data)),this.copyToImageData(m,g),c.imageData=m,E.push(c.image=t(m));return E}},n.prototype.renderFrame=function(o,c){var u,m,g;return u=(m=this.animation.frames)[c],g=m[c-1],0===c&&o.clearRect(0,0,this.width,this.height),1===(null!=g?g.disposeOp:void 0)?o.clearRect(g.xOffset,g.yOffset,g.width,g.height):2===(null!=g?g.disposeOp:void 0)&&o.putImageData(g.imageData,g.xOffset,g.yOffset),0===u.blendOp&&o.clearRect(u.xOffset,u.yOffset,u.width,u.height),o.drawImage(u.image,u.xOffset,u.yOffset)},n.prototype.animate=function(o){var c,u,m,g,x,S,M=this;return u=0,g=(S=this.animation).numFrames,m=S.frames,x=S.numPlays,(c=function(){var E,R;if(E=u++%g,R=m[E],M.renderFrame(o,E),g>1&&u/g<x)return M.animation._timeout=setTimeout(c,R.delay)})()},n.prototype.stopAnimation=function(){var o;return clearTimeout(null!=(o=this.animation)?o._timeout:void 0)},n.prototype.render=function(o){var c,u;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,c=o.getContext("2d"),this.animation?(this.decodeFrames(c),this.animate(c)):(u=c.createImageData(this.width,this.height),this.copyToImageData(u,this.decodePixels()),c.putImageData(u,0,0))},n}();function SJ(t){var i=0;if(71!==t[i++]||73!==t[i++]||70!==t[i++]||56!==t[i++]||56!=(t[i++]+1&253)||97!==t[i++])throw new Error("Invalid GIF 87a/89a header.");var e=t[i++]|t[i++]<<8,n=t[i++]|t[i++]<<8,r=t[i++],c=1<<1+(7&r);i++,i++;var u=null,m=null;r>>7&&(u=i,m=c,i+=3*c);var g=!0,x=[],S=0,M=null,E=0,R=null;for(this.width=e,this.height=n;g&&i<t.length;)switch(t[i++]){case 33:switch(t[i++]){case 255:if(11!==t[i]||78==t[i+1]&&69==t[i+2]&&84==t[i+3]&&83==t[i+4]&&67==t[i+5]&&65==t[i+6]&&80==t[i+7]&&69==t[i+8]&&50==t[i+9]&&46==t[i+10]&&48==t[i+11]&&3==t[i+12]&&1==t[i+13]&&0==t[i+16])i+=14,R=t[i++]|t[i++]<<8,i++;else for(i+=12;;){if(!((fe=t[i++])>=0))throw Error("Invalid block size");if(0===fe)break;i+=fe}break;case 249:if(4!==t[i++]||0!==t[i+4])throw new Error("Invalid graphics extension block.");var B=t[i++];S=t[i++]|t[i++]<<8,M=t[i++],0==(1&B)&&(M=null),E=B>>2&7,i++;break;case 254:for(;;){if(!((fe=t[i++])>=0))throw Error("Invalid block size");if(0===fe)break;i+=fe}break;default:throw new Error("Unknown graphic control label: 0x"+t[i-1].toString(16))}break;case 44:var K=t[i++]|t[i++]<<8,q=t[i++]|t[i++]<<8,Y=t[i++]|t[i++]<<8,ce=t[i++]|t[i++]<<8,De=t[i++],Ye=De>>6&1,yt=1<<1+(7&De),Ge=u,Te=m,mt=!1;De>>7&&(mt=!0,Ge=i,Te=yt,i+=3*yt);var vt=i;for(i++;;){var fe;if(!((fe=t[i++])>=0))throw Error("Invalid block size");if(0===fe)break;i+=fe}x.push({x:K,y:q,width:Y,height:ce,has_local_palette:mt,palette_offset:Ge,palette_size:Te,data_offset:vt,data_length:i-vt,transparent_index:M,interlaced:!!Ye,delay:S,disposal:E});break;case 59:g=!1;break;default:throw new Error("Unknown gif block: 0x"+t[i-1].toString(16))}this.numFrames=function(){return x.length},this.loopCount=function(){return R},this.frameInfo=function(de){if(de<0||de>=x.length)throw new Error("Frame index out of range.");return x[de]},this.decodeAndBlitFrameBGRA=function(de,Oe){var Ae=this.frameInfo(de),Ct=Ae.width*Ae.height,Re=new Uint8Array(Ct);a7(t,Ae.data_offset,Re,Ct);var Je=Ae.palette_offset,Ue=Ae.transparent_index;null===Ue&&(Ue=256);var lt=Ae.width,_t=e-lt,on=lt,ne=4*(Ae.y*e+Ae.x),ve=4*((Ae.y+Ae.height)*e+Ae.x),we=ne,je=4*_t;!0===Ae.interlaced&&(je+=4*e*7);for(var Ze=8,it=0,ct=Re.length;it<ct;++it){var pt=Re[it];if(0===on&&(on=lt,(we+=je)>=ve&&(je=4*_t+4*e*(Ze-1),we=ne+(lt+_t)*(Ze<<1),Ze>>=1)),pt===Ue)we+=4;else{var qt=t[Je+3*pt],Gt=t[Je+3*pt+1];Oe[we++]=t[Je+3*pt+2],Oe[we++]=Gt,Oe[we++]=qt,Oe[we++]=255}--on}},this.decodeAndBlitFrameRGBA=function(de,Oe){var Ae=this.frameInfo(de),Ct=Ae.width*Ae.height,Re=new Uint8Array(Ct);a7(t,Ae.data_offset,Re,Ct);var Je=Ae.palette_offset,Ue=Ae.transparent_index;null===Ue&&(Ue=256);var lt=Ae.width,_t=e-lt,on=lt,ne=4*(Ae.y*e+Ae.x),ve=4*((Ae.y+Ae.height)*e+Ae.x),we=ne,je=4*_t;!0===Ae.interlaced&&(je+=4*e*7);for(var Ze=8,it=0,ct=Re.length;it<ct;++it){var pt=Re[it];if(0===on&&(on=lt,(we+=je)>=ve&&(je=4*_t+4*e*(Ze-1),we=ne+(lt+_t)*(Ze<<1),Ze>>=1)),pt===Ue)we+=4;else{var Gt=t[Je+3*pt+1],xn=t[Je+3*pt+2];Oe[we++]=t[Je+3*pt],Oe[we++]=Gt,Oe[we++]=xn,Oe[we++]=255}--on}}}function a7(t,i,e,n){for(var r=t[i++],o=1<<r,c=o+1,u=c+1,m=r+1,g=(1<<m)-1,x=0,S=0,M=0,E=t[i++],R=new Int32Array(4096),B=null;;){for(;x<16&&0!==E;)S|=t[i++]<<x,x+=8,1===E?E=t[i++]:--E;if(x<m)break;var K=S&g;if(S>>=m,x-=m,K!==o){if(K===c)break;for(var q=K<u?K:B,Y=0,ce=q;ce>o;)ce=R[ce]>>8,++Y;var De=ce;if(M+Y+(q!==K?1:0)>n)return void ro.log("Warning, gif stream longer than expected.");e[M++]=De;var Ye=M+=Y;for(q!==K&&(e[M++]=De),ce=q;Y--;)e[--Ye]=255&(ce=R[ce]),ce>>=8;null!==B&&u<4096&&(R[u++]=B<<8|De,u>=g+1&&m<12&&(++m,g=g<<1|1)),B=K}else u=c+1,g=(1<<(m=r+1))-1,B=null}return M!==n&&ro.log("Warning, gif stream shorter than expected."),e}function QA(t){var i,e,n,r,o,c=Math.floor,u=new Array(64),m=new Array(64),g=new Array(64),x=new Array(64),S=new Array(65535),M=new Array(65535),E=new Array(64),R=new Array(64),B=[],K=0,q=7,Y=new Array(64),ce=new Array(64),De=new Array(64),Ye=new Array(256),yt=new Array(2048),Ge=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Te=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],mt=[0,1,2,3,4,5,6,7,8,9,10,11],vt=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],fe=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],de=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Oe=[0,1,2,3,4,5,6,7,8,9,10,11],Ae=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Ct=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Re(ne,ve){for(var we=0,je=0,Ze=new Array,it=1;it<=16;it++){for(var ct=1;ct<=ne[it];ct++)Ze[ve[je]]=[],Ze[ve[je]][0]=we,Ze[ve[je]][1]=it,je++,we++;we*=2}return Ze}function Je(ne){for(var ve=ne[0],we=ne[1]-1;we>=0;)ve&1<<we&&(K|=1<<q),we--,--q<0&&(255==K?(Ue(255),Ue(0)):Ue(K),q=7,K=0)}function Ue(ne){B.push(ne)}function lt(ne){Ue(ne>>8&255),Ue(255&ne)}function _t(ne,ve,we,je,Ze){for(var it,ct=Ze[0],pt=Ze[240],qt=function(Kt,cn){var yn,gn,$n,xi,Bi,Ki,vr,Zr,di,er,bn=0;for(di=0;di<8;++di){var $a=(yn=Kt[bn])+(Zr=Kt[bn+7]),kr=yn-Zr,Mu=(gn=Kt[bn+1])+(vr=Kt[bn+6]),so=gn-vr,ko=($n=Kt[bn+2])+(Ki=Kt[bn+5]),Td=$n-Ki,Or=(xi=Kt[bn+3])+(Bi=Kt[bn+4]),zm=xi-Bi,Yo=$a+Or,Fu=$a-Or,Tf=Mu+ko,Xo=Mu-ko;Kt[bn]=Yo+Tf,Kt[bn+4]=Yo-Tf;var wi=.707106781*(Xo+Fu);Kt[bn+2]=Fu+wi,Kt[bn+6]=Fu-wi;var Nr=.382683433*((Yo=zm+Td)-(Xo=so+kr)),$m=.5411961*Yo+Nr,ka=1.306562965*Xo+Nr,Sd=.707106781*(Tf=Td+so),Ed=kr+Sd,ti=kr-Sd;Kt[bn+5]=ti+$m,Kt[bn+3]=ti-$m,Kt[bn+1]=Ed+ka,Kt[bn+7]=Ed-ka,bn+=8}for(bn=0,di=0;di<8;++di){var Pu=(yn=Kt[bn])+(Zr=Kt[bn+56]),kd=yn-Zr,Nl=(gn=Kt[bn+8])+(vr=Kt[bn+48]),qs=gn-vr,As=($n=Kt[bn+16])+(Ki=Kt[bn+40]),cc=$n-Ki,a_=(xi=Kt[bn+24])+(Bi=Kt[bn+32]),Sf=xi-Bi,Ou=Pu+a_,Nu=Pu-a_,Lu=Nl+As,Dd=Nl-As;Kt[bn]=Ou+Lu,Kt[bn+32]=Ou-Lu;var qc=.707106781*(Dd+Nu);Kt[bn+16]=Nu+qc,Kt[bn+48]=Nu-qc;var Id=.382683433*((Ou=Sf+cc)-(Dd=qs+kd)),Wm=.5411961*Ou+Id,l_=1.306562965*Dd+Id,c_=.707106781*(Lu=cc+qs),u_=kd+c_,d_=kd-c_;Kt[bn+40]=d_+Wm,Kt[bn+24]=d_-Wm,Kt[bn+8]=u_+l_,Kt[bn+56]=u_-l_,bn++}for(di=0;di<64;++di)E[di]=(er=Kt[di]*cn[di])>0?er+.5|0:er-.5|0;return E}(ne,ve),Gt=0;Gt<64;++Gt)R[Ge[Gt]]=qt[Gt];var xn=R[0]-we;we=R[0],0==xn?Je(je[0]):(Je(je[M[it=32767+xn]]),Je(S[it]));for(var En=63;En>0&&0==R[En];)En--;if(0==En)return Je(ct),we;for(var oi,At=1;At<=En;){for(var ke=At;0==R[At]&&At<=En;)++At;var Di=At-ke;if(Di>=16){oi=Di>>4;for(var Rn=1;Rn<=oi;++Rn)Je(pt);Di&=15}Je(Ze[(Di<<4)+M[it=32767+R[At]]]),Je(S[it]),At++}return 63!=En&&Je(ct),we}function on(ne){ne=Math.min(Math.max(ne,1),100),o!=ne&&(function(ve){for(var we=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],je=0;je<64;je++){var Ze=c((we[je]*ve+50)/100);Ze=Math.min(Math.max(Ze,1),255),u[Ge[je]]=Ze}for(var it=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ct=0;ct<64;ct++){var pt=c((it[ct]*ve+50)/100);pt=Math.min(Math.max(pt,1),255),m[Ge[ct]]=pt}for(var qt=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Gt=0,xn=0;xn<8;xn++)for(var En=0;En<8;En++)g[Gt]=1/(u[Ge[Gt]]*qt[xn]*qt[En]*8),x[Gt]=1/(m[Ge[Gt]]*qt[xn]*qt[En]*8),Gt++}(ne<50?Math.floor(5e3/ne):Math.floor(200-2*ne)),o=ne)}this.encode=function(ne,ve){var gn,$n;ve&&on(ve),B=new Array,K=0,q=7,lt(65496),lt(65504),lt(16),Ue(74),Ue(70),Ue(73),Ue(70),Ue(0),Ue(1),Ue(1),Ue(0),lt(1),lt(1),Ue(0),Ue(0),function(){lt(65499),lt(132),Ue(0);for(var gn=0;gn<64;gn++)Ue(u[gn]);Ue(1);for(var $n=0;$n<64;$n++)Ue(m[$n])}(),gn=ne.width,$n=ne.height,lt(65472),lt(17),Ue(8),lt($n),lt(gn),Ue(3),Ue(1),Ue(17),Ue(0),Ue(2),Ue(17),Ue(1),Ue(3),Ue(17),Ue(1),function(){lt(65476),lt(418),Ue(0);for(var gn=0;gn<16;gn++)Ue(Te[gn+1]);for(var $n=0;$n<=11;$n++)Ue(mt[$n]);Ue(16);for(var xi=0;xi<16;xi++)Ue(vt[xi+1]);for(var Bi=0;Bi<=161;Bi++)Ue(fe[Bi]);Ue(1);for(var Ki=0;Ki<16;Ki++)Ue(de[Ki+1]);for(var vr=0;vr<=11;vr++)Ue(Oe[vr]);Ue(17);for(var Zr=0;Zr<16;Zr++)Ue(Ae[Zr+1]);for(var di=0;di<=161;di++)Ue(Ct[di])}(),lt(65498),lt(12),Ue(3),Ue(1),Ue(0),Ue(2),Ue(17),Ue(3),Ue(17),Ue(0),Ue(63),Ue(0);var we=0,je=0,Ze=0;K=0,q=7,this.encode.displayName="_encode_";for(var it,ct,pt,qt,Gt,xn,En,oi,At,ke=ne.data,Rn=ne.height,Kt=4*ne.width,cn=0;cn<Rn;){for(it=0;it<Kt;){for(Gt=Kt*cn+it,En=-1,oi=0,At=0;At<64;At++)xn=Gt+(oi=At>>3)*Kt+(En=4*(7&At)),cn+oi>=Rn&&(xn-=Kt*(cn+1+oi-Rn)),it+En>=Kt&&(xn-=it+En-Kt+4),ct=ke[xn++],pt=ke[xn++],qt=ke[xn++],Y[At]=(yt[ct]+yt[pt+256>>0]+yt[qt+512>>0]>>16)-128,ce[At]=(yt[ct+768>>0]+yt[pt+1024>>0]+yt[qt+1280>>0]>>16)-128,De[At]=(yt[ct+1280>>0]+yt[pt+1536>>0]+yt[qt+1792>>0]>>16)-128;we=_t(Y,g,we,i,n),je=_t(ce,x,je,e,r),Ze=_t(De,x,Ze,e,r),it+=32}cn+=8}if(q>=0){var yn=[];yn[1]=q+1,yn[0]=(1<<q+1)-1,Je(yn)}return lt(65497),new Uint8Array(B)},t=t||50,function(){for(var ne=String.fromCharCode,ve=0;ve<256;ve++)Ye[ve]=ne(ve)}(),i=Re(Te,mt),e=Re(de,Oe),n=Re(vt,fe),r=Re(Ae,Ct),function(){for(var ne=1,ve=2,we=1;we<=15;we++){for(var je=ne;je<ve;je++)M[32767+je]=we,S[32767+je]=[],S[32767+je][1]=we,S[32767+je][0]=je;for(var Ze=-(ve-1);Ze<=-ne;Ze++)M[32767+Ze]=we,S[32767+Ze]=[],S[32767+Ze][1]=we,S[32767+Ze][0]=ve-1+Ze;ne<<=1,ve<<=1}}(),function(){for(var ne=0;ne<256;ne++)yt[ne]=19595*ne,yt[ne+256>>0]=38470*ne,yt[ne+512>>0]=7471*ne+32768,yt[ne+768>>0]=-11059*ne,yt[ne+1024>>0]=-21709*ne,yt[ne+1280>>0]=32768*ne+8421375,yt[ne+1536>>0]=-27439*ne,yt[ne+1792>>0]=-5329*ne}(),on(t)}function Du(t,i){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!i,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function l7(t){function i(Te){if(!Te)throw Error("assert :P")}function e(Te,mt,vt){for(var fe=0;4>fe;fe++)if(Te[mt+fe]!=vt.charCodeAt(fe))return!0;return!1}function n(Te,mt,vt,fe,de){for(var Oe=0;Oe<de;Oe++)Te[mt+Oe]=vt[fe+Oe]}function r(Te,mt,vt,fe){for(var de=0;de<fe;de++)Te[mt+de]=vt}function o(Te){return new Int32Array(Te)}function c(Te,mt){for(var vt=[],fe=0;fe<Te;fe++)vt.push(new mt);return vt}function u(Te,mt){var vt=[];return function fe(de,Oe,Ae){for(var Ct=Ae[Oe],Re=0;Re<Ct&&(de.push(Ae.length>Oe+1?[]:new mt),!(Ae.length<Oe+1));Re++)fe(de[Re],Oe+1,Ae)}(vt,0,Te),vt}var m=function(){var Te=this;function mt(w,k){for(var N=1<<k-1>>>0;w&N;)N>>>=1;return N?(w&N-1)+N:w}function vt(w,k,N,j,Q){i(!(j%N));do{w[k+(j-=N)]=Q}while(0<j)}function fe(w,k,N,j,Q){if(i(2328>=Q),512>=Q)var ie=o(512);else if(null==(ie=o(Q)))return 0;return function(re,se,ae,me,Be,ot){var st,Xe,Bt=se,St=1<<ae,Ve=o(16),$e=o(16);for(i(0!=Be),i(null!=me),i(null!=re),i(0<ae),Xe=0;Xe<Be;++Xe){if(15<me[Xe])return 0;++Ve[me[Xe]]}if(Ve[0]==Be)return 0;for($e[1]=0,st=1;15>st;++st){if(Ve[st]>1<<st)return 0;$e[st+1]=$e[st]+Ve[st]}for(Xe=0;Xe<Be;++Xe)st=me[Xe],0<me[Xe]&&(ot[$e[st]++]=Xe);if(1==$e[15])return(me=new de).g=0,me.value=ot[0],vt(re,Bt,1,St,me),St;var Ot,Ht=-1,Lt=St-1,Cn=0,un=1,Yn=1,pn=1<<ae;for(Xe=0,st=1,Be=2;st<=ae;++st,Be<<=1){if(un+=Yn<<=1,0>(Yn-=Ve[st]))return 0;for(;0<Ve[st];--Ve[st])(me=new de).g=st,me.value=ot[Xe++],vt(re,Bt+Cn,Be,pn,me),Cn=mt(Cn,st)}for(st=ae+1,Be=2;15>=st;++st,Be<<=1){if(un+=Yn<<=1,0>(Yn-=Ve[st]))return 0;for(;0<Ve[st];--Ve[st]){if(me=new de,(Cn&Lt)!=Ht){for(Bt+=pn,Ot=1<<(Ht=st)-ae;15>Ht&&!(0>=(Ot-=Ve[Ht]));)++Ht,Ot<<=1;St+=pn=1<<(Ot=Ht-ae),re[se+(Ht=Cn&Lt)].g=Ot+ae,re[se+Ht].value=Bt-se-Ht}me.g=st-ae,me.value=ot[Xe++],vt(re,Bt+(Cn>>ae),Be,pn,me),Cn=mt(Cn,st)}}return un!=2*$e[15]-1?0:St}(w,k,N,j,Q,ie)}function de(){this.value=this.g=0}function Oe(){this.value=this.g=0}function Ae(){this.G=c(5,de),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=c(Rl,Oe)}function Ct(w,k,N,j){i(null!=w),i(null!=k),i(2147483648>j),w.Ca=254,w.I=0,w.b=-8,w.Ka=0,w.oa=k,w.pa=N,w.Jd=k,w.Yc=N+j,w.Zc=4<=j?N+j-4+1:N,it(w)}function Re(w,k){for(var N=0;0<k--;)N|=pt(w,128)<<k;return N}function Je(w,k){var N=Re(w,k);return ct(w)?-N:N}function Ue(w,k,N,j){var Q,ie=0;for(i(null!=w),i(null!=k),i(4294967288>j),w.Sb=j,w.Ra=0,w.u=0,w.h=0,4<j&&(j=4),Q=0;Q<j;++Q)ie+=k[N+Q]<<8*Q;w.Ra=ie,w.bb=j,w.oa=k,w.pa=N}function lt(w){for(;8<=w.u&&w.bb<w.Sb;)w.Ra>>>=8,w.Ra+=w.oa[w.pa+w.bb]<<E_-8>>>0,++w.bb,w.u-=8;we(w)&&(w.h=1,w.u=0)}function _t(w,k){if(i(0<=k),!w.h&&k<=S_){var N=ve(w)&T_[k];return w.u+=k,lt(w),N}return w.h=1,w.u=0}function on(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function ne(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function ve(w){return w.Ra>>>(w.u&E_-1)>>>0}function we(w){return i(w.bb<=w.Sb),w.h||w.bb==w.Sb&&w.u>E_}function je(w,k){w.u=k,w.h=we(w)}function Ze(w){w.u>=Sb&&(i(w.u>=Sb),lt(w))}function it(w){i(null!=w&&null!=w.oa),w.pa<w.Zc?(w.I=(w.oa[w.pa++]|w.I<<8)>>>0,w.b+=8):(i(null!=w&&null!=w.oa),w.pa<w.Yc?(w.b+=8,w.I=w.oa[w.pa++]|w.I<<8):w.Ka?w.b=0:(w.I<<=8,w.b+=8,w.Ka=1))}function ct(w){return Re(w,1)}function pt(w,k){var N=w.Ca;0>w.b&&it(w);var j=w.b,Q=N*k>>>8,ie=(w.I>>>j>Q)+0;for(ie?(N-=Q,w.I-=Q+1<<j>>>0):N=Q+1,j=N,Q=0;256<=j;)Q+=8,j>>=8;return w.b-=j=7^Q+Bl[j],w.Ca=(N<<j)-1,ie}function qt(w,k,N){w[k+0]=N>>24&255,w[k+1]=N>>16&255,w[k+2]=N>>8&255,w[k+3]=N>>0&255}function Gt(w,k){return w[k+0]<<0|w[k+1]<<8}function xn(w,k){return Gt(w,k)|w[k+2]<<16}function En(w,k){return Gt(w,k)|Gt(w,k+2)<<16}function oi(w,k){var N=1<<k;return i(null!=w),i(0<k),w.X=o(N),null==w.X?0:(w.Mb=32-k,w.Xa=k,1)}function At(w,k){i(null!=w),i(null!=k),i(w.Xa==k.Xa),n(k.X,0,w.X,0,1<<k.Xa)}function ke(){this.X=[],this.Xa=this.Mb=0}function Di(w,k,N,j){i(null!=N),i(null!=j);var Q=N[0],ie=j[0];return 0==Q&&(Q=(w*ie+k/2)/k),0==ie&&(ie=(k*Q+w/2)/w),0>=Q||0>=ie?0:(N[0]=Q,j[0]=ie,1)}function Rn(w,k){return w+(1<<k)-1>>>k}function Kt(w,k){return((4278255360&w)+(4278255360&k)>>>0&4278255360)+((16711935&w)+(16711935&k)>>>0&16711935)>>>0}function cn(w,k){Te[k]=function(N,j,Q,ie,re,se,ae){var me;for(me=0;me<re;++me){var Be=Te[w](se[ae+me-1],Q,ie+me);se[ae+me]=Kt(N[j+me],Be)}}}function yn(){this.ud=this.hd=this.jd=0}function gn(w,k){return((4278124286&(w^k))>>>1)+(w&k)>>>0}function $n(w){return 0<=w&&256>w?w:0>w?0:255<w?255:void 0}function xi(w,k){return $n(w+(w-k+.5>>1))}function Bi(w,k,N){return Math.abs(k-N)-Math.abs(w-N)}function Ki(w,k,N,j,Q,ie,re){for(j=ie[re-1],N=0;N<Q;++N)ie[re+N]=j=Kt(w[k+N],j)}function vr(w,k,N,j,Q){var ie;for(ie=0;ie<N;++ie){var re=w[k+ie],se=re>>8&255,ae=16711935&(ae=(ae=16711935&re)+((se<<16)+se));j[Q+ie]=(4278255360&re)+ae>>>0}}function Zr(w,k){k.jd=w>>0&255,k.hd=w>>8&255,k.ud=w>>16&255}function di(w,k,N,j,Q,ie){var re;for(re=0;re<j;++re){var se=k[N+re],ae=se>>>8,me=se,Be=255&(Be=(Be=se>>>16)+((w.jd<<24>>24)*(ae<<24>>24)>>>5));me=255&(me=(me+=(w.hd<<24>>24)*(ae<<24>>24)>>>5)+((w.ud<<24>>24)*(Be<<24>>24)>>>5)),Q[ie+re]=(4278255360&se)+(Be<<16)+me}}function er(w,k,N,j,Q){Te[k]=function(ie,re,se,ae,me,Be,ot,st,Xe){for(ae=ot;ae<st;++ae)for(ot=0;ot<Xe;++ot)me[Be++]=Q(se[j(ie[re++])])},Te[w]=function(ie,re,se,ae,me,Be,ot){var st=8>>ie.b,Xe=ie.Ea,Bt=ie.K[0],St=ie.w;if(8>st)for(ie=(1<<ie.b)-1,St=(1<<st)-1;re<se;++re){var Ve,$e=0;for(Ve=0;Ve<Xe;++Ve)Ve&ie||($e=j(ae[me++])),Be[ot++]=Q(Bt[$e&St]),$e>>=st}else Te["VP8LMapColor"+N](ae,me,Bt,St,Be,ot,re,se,Xe)}}function bn(w,k,N,j,Q){for(N=k+N;k<N;){var ie=w[k++];j[Q++]=ie>>16&255,j[Q++]=ie>>8&255,j[Q++]=ie>>0&255}}function $a(w,k,N,j,Q){for(N=k+N;k<N;){var ie=w[k++];j[Q++]=ie>>16&255,j[Q++]=ie>>8&255,j[Q++]=ie>>0&255,j[Q++]=ie>>24&255}}function kr(w,k,N,j,Q){for(N=k+N;k<N;){var ie=(re=w[k++])>>16&240|re>>12&15,re=re>>0&240|re>>28&15;j[Q++]=ie,j[Q++]=re}}function Mu(w,k,N,j,Q){for(N=k+N;k<N;){var ie=(re=w[k++])>>16&248|re>>13&7,re=re>>5&224|re>>3&31;j[Q++]=ie,j[Q++]=re}}function so(w,k,N,j,Q){for(N=k+N;k<N;){var ie=w[k++];j[Q++]=ie>>0&255,j[Q++]=ie>>8&255,j[Q++]=ie>>16&255}}function ko(w,k,N,j,Q,ie){if(0==ie)for(N=k+N;k<N;)qt(j,((ie=w[k++])[0]>>24|ie[1]>>8&65280|ie[2]<<8&16711680|ie[3]<<24)>>>0),Q+=32;else n(j,Q,w,k,N)}function Td(w,k){Te[k][0]=Te[w+"0"],Te[k][1]=Te[w+"1"],Te[k][2]=Te[w+"2"],Te[k][3]=Te[w+"3"],Te[k][4]=Te[w+"4"],Te[k][5]=Te[w+"5"],Te[k][6]=Te[w+"6"],Te[k][7]=Te[w+"7"],Te[k][8]=Te[w+"8"],Te[k][9]=Te[w+"9"],Te[k][10]=Te[w+"10"],Te[k][11]=Te[w+"11"],Te[k][12]=Te[w+"12"],Te[k][13]=Te[w+"13"],Te[k][14]=Te[w+"0"],Te[k][15]=Te[w+"0"]}function Or(w){return w==yF||w==bF||w==n5||w==xF}function zm(){this.eb=[],this.size=this.A=this.fb=0}function Yo(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Fu(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new zm,this.f.kb=new Yo,this.sd=null}function Tf(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Xo(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function wi(w){return alert("todo:WebPSamplerProcessPlane"),w.T}function Nr(w,k){var N=w.T,j=k.ba.f.RGBA,Q=j.eb,ie=j.fb+w.ka*j.A,re=Xc[k.ba.S],se=w.y,ae=w.O,me=w.f,Be=w.N,ot=w.ea,st=w.W,Xe=k.cc,Bt=k.dc,St=k.Mc,Ve=k.Nc,$e=w.ka,Ot=w.ka+w.T,Ht=w.U,Lt=Ht+1>>1;for(0==$e?re(se,ae,null,null,me,Be,ot,st,me,Be,ot,st,Q,ie,null,null,Ht):(re(k.ec,k.fc,se,ae,Xe,Bt,St,Ve,me,Be,ot,st,Q,ie-j.A,Q,ie,Ht),++N);$e+2<Ot;$e+=2)re(se,(ae+=2*w.fa)-w.fa,se,ae,Xe=me,Bt=Be,St=ot,Ve=st,me,Be+=w.Rc,ot,st+=w.Rc,Q,(ie+=2*j.A)-j.A,Q,ie,Ht);return ae+=w.fa,w.j+Ot<w.o?(n(k.ec,k.fc,se,ae,Ht),n(k.cc,k.dc,me,Be,Lt),n(k.Mc,k.Nc,ot,st,Lt),N--):1&Ot||re(se,ae,null,null,me,Be,ot,st,me,Be,ot,st,Q,ie+j.A,null,null,Ht),N}function $m(w,k,N){var j=w.F,Q=[w.J];if(null!=j){var ie=w.U,re=k.ba.S,se=re==t5||re==n5;k=k.ba.f.RGBA;var ae=[0],me=w.ka;ae[0]=w.T,w.Kb&&(0==me?--ae[0]:(--me,Q[0]-=w.width),w.j+w.ka+w.T==w.o&&(ae[0]=w.o-w.j-me));var Be=k.eb;w=XS(j,Q[0],w.width,ie,ae,Be,(me=k.fb+me*k.A)+(se?0:3),k.A),i(N==ae),w&&Or(re)&&sh(Be,me,se,ie,ae,k.A)}return 0}function ka(w){var k=w.ma,N=k.ba.S,j=11>N,Q=N==ZS||N==e5||N==t5||N==vF||12==N||Or(N);if(k.memory=null,k.Ib=null,k.Jb=null,k.Nd=null,!Cb(k.Oa,w,Q?11:12))return 0;if(Q&&Or(N)&&$t(),w.da)alert("todo:use_scaling");else{if(j){if(k.Ib=wi,w.Kb){if(k.memory=o(w.U+2*(N=w.U+1>>1)),null==k.memory)return 0;k.ec=k.memory,k.fc=0,k.cc=k.ec,k.dc=k.fc+w.U,k.Mc=k.cc,k.Nc=k.dc+N,k.Ib=Nr,$t()}}else alert("todo:EmitYUV");Q&&(k.Jb=$m,j&&nt())}if(j&&!pB){for(w=0;256>w;++w)cve[w]=89858*(w-128)+o5>>r5,fve[w]=-22014*(w-128)+o5,dve[w]=-45773*(w-128),uve[w]=113618*(w-128)+o5>>r5;for(w=Mb;w<TF;++w)pve[w-Mb]=uc(k=76283*(w-16)+o5>>r5,255),hve[w-Mb]=uc(k+8>>4,15);pB=1}return 1}function Sd(w){var k=w.ma,N=w.U,j=w.T;return i(!(1&w.ka)),0>=N||0>=j?0:(N=k.Ib(w,k),null!=k.Jb&&k.Jb(w,k,N),k.Dc+=N,1)}function Ed(w){w.ma.memory=null}function ti(w,k,N,j){return 47!=_t(w,8)?0:(k[0]=_t(w,14)+1,N[0]=_t(w,14)+1,j[0]=_t(w,1),0!=_t(w,3)?0:!w.h)}function Pu(w,k){if(4>w)return w+1;var N=w-2>>1;return(2+(1&w)<<N)+_t(k,N)+1}function kd(w,k){return 120<k?k-120:1<=(N=((N=Y1e[k-1])>>4)*w+(8-(15&N)))?N:1;var N}function Nl(w,k,N){var j=ve(N),Q=w[k+=255&j].g-8;return 0<Q&&(je(N,N.u+8),j=ve(N),k+=w[k].value,k+=j&(1<<Q)-1),je(N,N.u+w[k].g),w[k].value}function qs(w,k,N){return N.g+=w.g,N.value+=w.value<<k>>>0,i(8>=N.g),w.g}function As(w,k,N){var j=w.xc;return i((k=0==j?0:w.vc[w.md*(N>>j)+(k>>j)])<w.Wb),w.Ya[k]}function cc(w,k,N,j){var Q=w.ab,ie=w.c*k,re=w.C;k=re+k;var se=N,ae=j;for(j=w.Ta,N=w.Ua;0<Q--;){var me=w.gc[Q],Be=re,ot=k,st=se,Xe=ae,Bt=(ae=j,se=N,me.Ea);switch(i(Be<ot),i(ot<=me.nc),me.hc){case 2:YS(st,Xe,(ot-Be)*Bt,ae,se);break;case 0:var St=Be,Ve=ot,$e=ae,Ot=se,Ht=(pn=me).Ea;0==St&&(hF(st,Xe,null,null,1,$e,Ot),Ki(st,Xe+1,0,0,Ht-1,$e,Ot+1),Xe+=Ht,Ot+=Ht,++St);for(var Lt=1<<pn.b,Cn=Lt-1,un=Rn(Ht,pn.b),Yn=pn.K,pn=pn.w+(St>>pn.b)*un;St<Ve;){var Ar=Yn,Wr=pn,yr=1;for(Eb(st,Xe,$e,Ot-Ht,1,$e,Ot);yr<Ht;){var rr=(yr&~Cn)+Lt;rr>Ht&&(rr=Ht),(0,nh[Ar[Wr++]>>8&15])(st,Xe+ +yr,$e,Ot+yr-Ht,rr-yr,$e,Ot+yr),yr=rr}Xe+=Ht,Ot+=Ht,++St&Cn||(pn+=un)}ot!=me.nc&&n(ae,se-Bt,ae,se+(ot-Be-1)*Bt,Bt);break;case 1:for(Bt=st,Ve=Xe,Ht=(st=me.Ea)-(Ot=st&~($e=(Xe=1<<me.b)-1)),St=Rn(st,me.b),Lt=me.K,me=me.w+(Be>>me.b)*St;Be<ot;){for(Cn=Lt,un=me,Yn=new yn,pn=Ve+Ot,Ar=Ve+st;Ve<pn;)Zr(Cn[un++],Yn),Gc(Yn,Bt,Ve,Xe,ae,se),Ve+=Xe,se+=Xe;Ve<Ar&&(Zr(Cn[un++],Yn),Gc(Yn,Bt,Ve,Ht,ae,se),Ve+=Ht,se+=Ht),++Be&$e||(me+=St)}break;case 3:if(st==ae&&Xe==se&&0<me.b){for(Ve=ae,st=Bt=se+(ot-Be)*Bt-(Ot=(ot-Be)*Rn(me.Ea,me.b)),Xe=ae,$e=se,St=[],Ot=(Ht=Ot)-1;0<=Ot;--Ot)St[Ot]=Xe[$e+Ot];for(Ot=Ht-1;0<=Ot;--Ot)Ve[st+Ot]=St[Ot];Vu(me,Be,ot,ae,Bt,ae,se)}else Vu(me,Be,ot,st,Xe,ae,se)}se=j,ae=N}ae!=N&&n(j,N,se,ae,ie)}function a_(w,k){var N=w.V,j=w.Ba+w.c*w.C,Q=k-w.C;if(i(k<=w.l.o),i(16>=Q),0<Q){var ie=w.l,re=w.Ta,se=w.Ua,ae=ie.width;if(cc(w,Q,N,j),Q=se=[se],i((N=w.C)<(j=k)),i(ie.v<ie.va),j>ie.o&&(j=ie.o),N<ie.j){var me=ie.j-N;N=ie.j,Q[0]+=me*ae}if(N>=j?N=0:(Q[0]+=4*ie.v,ie.ka=N-ie.j,ie.U=ie.va-ie.v,ie.T=j-N,N=1),N){if(se=se[0],11>(N=w.ca).S){var Be=N.f.RGBA,ot=(j=N.S,Q=ie.U,ie=ie.T,me=Be.eb,Be.A),st=ie;for(Be=Be.fb+w.Ma*Be.A;0<st--;){var Xe=re,Bt=se,St=Q,Ve=me,$e=Be;switch(j){case JS:Uu(Xe,Bt,St,Ve,$e);break;case ZS:ih(Xe,Bt,St,Ve,$e);break;case yF:ih(Xe,Bt,St,Ve,$e),sh(Ve,$e,0,St,1,0);break;case iB:k_(Xe,Bt,St,Ve,$e);break;case e5:ko(Xe,Bt,St,Ve,$e,1);break;case bF:ko(Xe,Bt,St,Ve,$e,1),sh(Ve,$e,0,St,1,0);break;case t5:ko(Xe,Bt,St,Ve,$e,0);break;case n5:ko(Xe,Bt,St,Ve,$e,0),sh(Ve,$e,1,St,1,0);break;case vF:Md(Xe,Bt,St,Ve,$e);break;case xF:Md(Xe,Bt,St,Ve,$e),A_(Ve,$e,St,1,0);break;case rB:If(Xe,Bt,St,Ve,$e);break;default:i(0)}se+=ae,Be+=ot}w.Ma+=ie}else alert("todo:EmitRescaledRowsYUVA");i(w.Ma<=N.height)}}w.C=k,i(w.C<=w.i)}function Sf(w){var k;if(0<w.ua)return 0;for(k=0;k<w.Wb;++k){var N=w.Ya[k].G,j=w.Ya[k].H;if(0<N[1][j[1]+0].g||0<N[2][j[2]+0].g||0<N[3][j[3]+0].g)return 0}return 1}function Ou(w,k,N,j,Q,ie){if(0!=w.Z){var re=w.qd,se=w.rd;for(i(null!=lh[w.Z]);k<N;++k)lh[w.Z](re,se,j,Q,j,Q,ie),re=j,se=Q,Q+=ie;w.qd=re,w.rd=se}}function Nu(w,k){var N=w.l.ma,j=0==N.Z||1==N.Z?w.l.j:w.C;if(j=w.C<j?j:w.C,i(k<=w.l.o),k>j){var Q=w.l.width,ie=N.ca,re=N.tb+Q*j,se=w.V,ae=w.Ba+w.c*j,me=w.gc;i(1==w.ab),i(3==me[0].hc),mF(me[0],j,k,se,ae,ie,re),Ou(N,j,k,ie,re,Q)}w.C=w.Ma=k}function Lu(w,k,N,j,Q,ie,re){var se=w.$/j,ae=w.$%j,me=w.m,Be=w.s,ot=N+w.$,st=ot;Q=N+j*Q;var Xe=N+j*ie,Bt=280+Be.ua,St=w.Pb?se:16777216,Ve=0<Be.ua?Be.Wa:null,$e=Be.wc,Ot=ot<Xe?As(Be,ae,se):null;i(w.C<ie),i(Xe<=Q);var Ht=!1;e:for(;;){for(;Ht||ot<Xe;){var Lt=0;if(se>=St){var Cn=ot-N;i((St=w).Pb),St.wd=St.m,St.xd=Cn,0<St.s.ua&&At(St.s.Wa,St.s.vb),St=se+Q1e}if(ae&$e||(Ot=As(Be,ae,se)),i(null!=Ot),Ot.Qb&&(k[ot]=Ot.qb,Ht=!0),!Ht)if(Ze(me),Ot.jc){Cn=k;var un=ot,Yn=Ot.pd[ve(Lt=me)&Rl-1];i(Ot.jc),256>Yn.g?(je(Lt,Lt.u+Yn.g),Cn[un]=Yn.value,Lt=0):(je(Lt,Lt.u+Yn.g-256),i(256<=Yn.value),Lt=Yn.value),0==Lt&&(Ht=!0)}else Lt=Nl(Ot.G[0],Ot.H[0],me);if(me.h)break;if(Ht||256>Lt){if(!Ht)if(Ot.nd)k[ot]=(Ot.qb|Lt<<8)>>>0;else{if(Ze(me),Ht=Nl(Ot.G[1],Ot.H[1],me),Ze(me),Cn=Nl(Ot.G[2],Ot.H[2],me),un=Nl(Ot.G[3],Ot.H[3],me),me.h)break;k[ot]=(un<<24|Ht<<16|Lt<<8|Cn)>>>0}if(Ht=!1,++ot,++ae>=j&&(ae=0,++se,null!=re&&se<=ie&&!(se%16)&&re(w,se),null!=Ve))for(;st<ot;)Lt=k[st++],Ve.X[(506832829*Lt&4294967295)>>>Ve.Mb]=Lt}else if(280>Lt){if(Lt=Pu(Lt-256,me),Cn=Nl(Ot.G[4],Ot.H[4],me),Ze(me),Cn=kd(j,Cn=Pu(Cn,me)),me.h)break;if(ot-N<Cn||Q-ot<Lt)break e;for(un=0;un<Lt;++un)k[ot+un]=k[ot+un-Cn];for(ot+=Lt,ae+=Lt;ae>=j;)ae-=j,++se,null!=re&&se<=ie&&!(se%16)&&re(w,se);if(i(ot<=Q),ae&$e&&(Ot=As(Be,ae,se)),null!=Ve)for(;st<ot;)Lt=k[st++],Ve.X[(506832829*Lt&4294967295)>>>Ve.Mb]=Lt}else{if(!(Lt<Bt))break e;for(Ht=Lt-280,i(null!=Ve);st<ot;)Lt=k[st++],Ve.X[(506832829*Lt&4294967295)>>>Ve.Mb]=Lt;Lt=ot,i(!(Ht>>>(Cn=Ve).Xa)),k[Lt]=Cn.X[Ht],Ht=!0}Ht||i(me.h==we(me))}if(w.Pb&&me.h&&ot<Q)i(w.m.h),w.a=5,w.m=w.wd,w.$=w.xd,0<w.s.ua&&At(w.s.vb,w.s.Wa);else{if(me.h)break e;null!=re&&re(w,se>ie?ie:se),w.a=0,w.$=ot-N}return 1}return w.a=3,0}function Dd(w){i(null!=w),w.vc=null,w.yc=null,w.Ya=null;var k=w.Wa;null!=k&&(k.X=null),w.vb=null,i(null!=w)}function qc(){var w=new pF;return null==w?null:(w.a=0,w.xb=aB,Td("Predictor","VP8LPredictors"),Td("Predictor","VP8LPredictors_C"),Td("PredictorAdd","VP8LPredictorsAdd"),Td("PredictorAdd","VP8LPredictorsAdd_C"),YS=vr,Gc=di,Uu=bn,ih=$a,Md=kr,If=Mu,k_=so,Te.VP8LMapColor32b=kb,Te.VP8LMapColor8b=gF,w)}function Id(w,k,N,j,Q){var ie=1,re=[w],se=[k],ae=j.m,me=j.s,Be=null,ot=0;e:for(;;){if(N)for(;ie&&_t(ae,1);){var st=re,Xe=se,Bt=j,St=1,Ve=Bt.m,$e=Bt.gc[Bt.ab],Ot=_t(Ve,2);if(Bt.Oc&1<<Ot)ie=0;else{switch(Bt.Oc|=1<<Ot,$e.hc=Ot,$e.Ea=st[0],$e.nc=Xe[0],$e.K=[null],++Bt.ab,i(4>=Bt.ab),Ot){case 0:case 1:$e.b=_t(Ve,3)+2,St=Id(Rn($e.Ea,$e.b),Rn($e.nc,$e.b),0,Bt,$e.K),$e.K=$e.K[0];break;case 3:var Ht,Lt=_t(Ve,8)+1,Cn=16<Lt?0:4<Lt?1:2<Lt?2:3;if(st[0]=Rn($e.Ea,Cn),$e.b=Cn,Ht=St=Id(Lt,1,0,Bt,$e.K)){var un,Yn=Lt,pn=$e,Ar=1<<(8>>pn.b),Wr=o(Ar);if(null==Wr)Ht=0;else{var yr=pn.K[0],rr=pn.w;for(Wr[0]=pn.K[0][0],un=1;un<1*Yn;++un)Wr[un]=Kt(yr[rr+un],Wr[un-1]);for(;un<4*Ar;++un)Wr[un]=0;pn.K[0]=null,pn.K[0]=Wr,Ht=1}}St=Ht;break;case 2:break;default:i(0)}ie=St}}if(re=re[0],se=se[0],ie&&_t(ae,1)&&!(ie=1<=(ot=_t(ae,4))&&11>=ot)){j.a=3;break e}var ao;if(ao=ie)t:{var eo,Fi,Fs,jl=j,Ps=re,Vl=se,qr=ot,fc=N,pc=jl.m,ua=jl.s,Da=[null],fl=1,Qc=0,Fd=X1e[qr];n:for(;;){if(fc&&_t(pc,1)){var da=_t(pc,3)+2,Of=Rn(Ps,da),Jm=Rn(Vl,da),M_=Of*Jm;if(!Id(Of,Jm,0,jl,Da))break n;for(Da=Da[0],ua.xc=da,eo=0;eo<M_;++eo){var ch=Da[eo]>>8&65535;Da[eo]=ch,ch>=fl&&(fl=ch+1)}}if(pc.h)break n;for(Fi=0;5>Fi;++Fi){var Jo=oB[Fi];!Fi&&0<qr&&(Jo+=1<<qr),Qc<Jo&&(Qc=Jo)}var SF=c(fl*Fd,de),gB=fl,_B=c(gB,Ae);if(null==_B)var a5=null;else i(65536>=gB),a5=_B;var Fb=o(Qc);if(null==a5||null==Fb||null==SF){jl.a=1;break n}var l5=SF;for(eo=Fs=0;eo<fl;++eo){var Wu=a5[eo],F_=Wu.G,P_=Wu.H,vB=0,c5=1,yB=0;for(Fi=0;5>Fi;++Fi){Jo=oB[Fi],F_[Fi]=l5,P_[Fi]=Fs,!Fi&&0<qr&&(Jo+=1<<qr);r:{var u5,EF=Jo,d5=jl,Pb=Fb,_ve=l5,vve=Fs,kF=0,uh=d5.m,yve=_t(uh,1);if(r(Pb,0,0,EF),yve){var bve=_t(uh,1)+1,xve=_t(uh,1),bB=_t(uh,0==xve?1:8);Pb[bB]=1,2==bve&&(Pb[bB=_t(uh,8)]=1);var f5=1}else{var xB=o(19),wB=_t(uh,4)+4;if(19<wB){d5.a=3;var p5=0;break r}for(u5=0;u5<wB;++u5)xB[K1e[u5]]=_t(uh,3);var DF=void 0,Ob=void 0,CB=d5,wve=xB,h5=EF,TB=Pb,IF=0,dh=CB.m,SB=8,EB=c(128,de);i:for(;fe(EB,0,7,wve,19);){if(_t(dh,1)){var Cve=2+2*_t(dh,3);if((DF=2+_t(dh,Cve))>h5)break i}else DF=h5;for(Ob=0;Ob<h5&&DF--;){Ze(dh);var kB=EB[0+(127&ve(dh))];je(dh,dh.u+kB.g);var O_=kB.value;if(16>O_)TB[Ob++]=O_,0!=O_&&(SB=O_);else{var Tve=16==O_,DB=O_-16,Sve=q1e[DB],IB=_t(dh,W1e[DB])+Sve;if(Ob+IB>h5)break i;for(var Eve=Tve?SB:0;0<IB--;)TB[Ob++]=Eve}}IF=1;break i}IF||(CB.a=3),f5=IF}(f5=f5&&!uh.h)&&(kF=fe(_ve,vve,8,Pb,EF)),f5&&0!=kF?p5=kF:(d5.a=3,p5=0)}if(0==p5)break n;if(c5&&1==G1e[Fi]&&(c5=0==l5[Fs].g),vB+=l5[Fs].g,Fs+=p5,3>=Fi){var Nb,AF=Fb[0];for(Nb=1;Nb<Jo;++Nb)Fb[Nb]>AF&&(AF=Fb[Nb]);yB+=AF}}if(Wu.nd=c5,Wu.Qb=0,c5&&(Wu.qb=(F_[3][P_[3]+0].value<<24|F_[1][P_[1]+0].value<<16|F_[2][P_[2]+0].value)>>>0,0==vB&&256>F_[0][P_[0]+0].value&&(Wu.Qb=1,Wu.qb+=F_[0][P_[0]+0].value<<8)),Wu.jc=!Wu.Qb&&6>yB,Wu.jc){var m5,Nf=Wu;for(m5=0;m5<Rl;++m5){var fh=m5,ph=Nf.pd[fh],g5=Nf.G[0][Nf.H[0]+fh];256<=g5.value?(ph.g=g5.g+256,ph.value=g5.value):(ph.g=0,ph.value=0,fh>>=qs(g5,8,ph),fh>>=qs(Nf.G[1][Nf.H[1]+fh],16,ph),fh>>=qs(Nf.G[2][Nf.H[2]+fh],0,ph),qs(Nf.G[3][Nf.H[3]+fh],24,ph))}}}ua.vc=Da,ua.Wb=fl,ua.Ya=a5,ua.yc=SF,ao=1;break t}ao=0}if(!(ie=ao)){j.a=3;break e}if(0<ot){if(me.ua=1<<ot,!oi(me.Wa,ot)){j.a=1,ie=0;break e}}else me.ua=0;var MF=j,AB=re,kve=se,FF=MF.s,PF=FF.xc;if(MF.c=AB,MF.i=kve,FF.md=Rn(AB,PF),FF.wc=0==PF?-1:(1<<PF)-1,N){j.xb=rve;break e}if(null==(Be=o(re*se))){j.a=1,ie=0;break e}ie=(ie=Lu(j,Be,0,re,se,se,null))&&!ae.h;break e}return ie?(null!=Q?Q[0]=Be:(i(null==Be),i(N)),j.$=0,N||Dd(me)):Dd(me),ie}function Wm(w,k){var N=w.c*w.i,j=N+k+16*k;return i(w.c<=k),w.V=o(j),null==w.V?(w.Ta=null,w.Ua=0,w.a=1,0):(w.Ta=w.V,w.Ua=w.Ba+N+k,1)}function l_(w,k){var N=w.C,j=k-N,Q=w.V,ie=w.Ba+w.c*N;for(i(k<=w.l.o);0<j;){var re=16<j?16:j,se=w.l.ma,ae=w.l.width,me=ae*re,Be=se.ca,ot=se.tb+ae*N,st=w.Ta,Xe=w.Ua;cc(w,re,Q,ie),Q9(st,Xe,Be,ot,me),Ou(se,N,N+re,Be,ot,ae),j-=re,Q+=re*w.c,N+=re}i(N==k),w.C=w.Ma=k}function c_(){this.ub=this.yd=this.td=this.Rb=0}function u_(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function d_(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function IS(){var w;this.Yb=(function k(N,j,Q){for(var ie=Q[j],re=0;re<ie&&(N.push(Q.length>j+1?[]:0),!(Q.length<j+1));re++)k(N[re],j+1,Q)}(w=[],0,[3,11]),w)}function $M(){this.jb=o(3),this.Wc=u([4,8],IS),this.Xc=u([4,17],IS)}function WM(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function f_(){this.ld=this.La=this.dd=this.tc=0}function AS(){this.Na=this.la=0}function qM(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ab(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function GM(){this.uc=this.M=this.Nb=0,this.wa=Array(new f_),this.Y=0,this.ya=Array(new ab),this.aa=0,this.l=new p_}function MS(){this.y=o(16),this.f=o(8),this.ea=o(8)}function KM(){this.cb=this.a=0,this.sc="",this.m=new on,this.Od=new c_,this.Kc=new u_,this.ed=new WM,this.Qa=new d_,this.Ic=this.$c=this.Aa=0,this.D=new GM,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=c(8,on),this.ia=0,this.pb=c(4,qM),this.Pa=new $M,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new MS),this.Hd=0,this.rb=Array(new AS),this.sb=0,this.wa=Array(new f_),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ab),this.L=this.aa=0,this.gd=u([4,2],f_),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function p_(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function YM(){var w=new KM;return null!=w&&(w.a=0,w.sc="OK",w.cb=0,w.Xb=0,Ab||(Ab=OS)),w}function gs(w,k,N){return 0==w.a&&(w.a=k,w.sc=N,w.cb=0),0}function FS(w,k,N){return 3<=N&&157==w[k+0]&&1==w[k+1]&&42==w[k+2]}function PS(w,k){if(null==w)return 0;if(w.a=0,w.sc="OK",null==k)return gs(w,2,"null VP8Io passed to VP8GetHeaders()");var N=k.data,j=k.w,Q=k.ha;if(4>Q)return gs(w,7,"Truncated header.");var ie=N[j+0]|N[j+1]<<8|N[j+2]<<16,re=w.Od;if(re.Rb=!(1&ie),re.td=ie>>1&7,re.yd=ie>>4&1,re.ub=ie>>5,3<re.td)return gs(w,3,"Incorrect keyframe parameters.");if(!re.yd)return gs(w,4,"Frame not displayable.");j+=3,Q-=3;var se=w.Kc;if(re.Rb){if(7>Q)return gs(w,7,"cannot parse picture header");if(!FS(N,j,Q))return gs(w,3,"Bad code word");se.c=16383&(N[j+4]<<8|N[j+3]),se.Td=N[j+4]>>6,se.i=16383&(N[j+6]<<8|N[j+5]),se.Ud=N[j+6]>>6,j+=7,Q-=7,w.za=se.c+15>>4,w.Ub=se.i+15>>4,k.width=se.c,k.height=se.i,k.Da=0,k.j=0,k.v=0,k.va=k.width,k.o=k.height,k.da=0,k.ib=k.width,k.hb=k.height,k.U=k.width,k.T=k.height,r((ie=w.Pa).jb,0,255,ie.jb.length),i(null!=(ie=w.Qa)),ie.Cb=0,ie.Bb=0,ie.Fb=1,r(ie.Zb,0,0,ie.Zb.length),r(ie.Lb,0,0,ie.Lb)}if(re.ub>Q)return gs(w,7,"bad partition length");Ct(ie=w.m,N,j,re.ub),j+=re.ub,Q-=re.ub,re.Rb&&(se.Ld=ct(ie),se.Kd=ct(ie)),se=w.Qa;var ae,me=w.Pa;if(i(null!=ie),i(null!=se),se.Cb=ct(ie),se.Cb){if(se.Bb=ct(ie),ct(ie)){for(se.Fb=ct(ie),ae=0;4>ae;++ae)se.Zb[ae]=ct(ie)?Je(ie,7):0;for(ae=0;4>ae;++ae)se.Lb[ae]=ct(ie)?Je(ie,6):0}if(se.Bb)for(ae=0;3>ae;++ae)me.jb[ae]=ct(ie)?Re(ie,8):255}else se.Bb=0;if(ie.Ka)return gs(w,3,"cannot parse segment header");if((se=w.ed).zd=ct(ie),se.Tb=Re(ie,6),se.wb=Re(ie,3),se.Pc=ct(ie),se.Pc&&ct(ie)){for(me=0;4>me;++me)ct(ie)&&(se.vd[me]=Je(ie,6));for(me=0;4>me;++me)ct(ie)&&(se.od[me]=Je(ie,6))}if(w.L=0==se.Tb?0:se.zd?1:2,ie.Ka)return gs(w,3,"cannot parse filter header");var Be=Q;if(Q=ae=j,j=ae+Be,se=Be,w.Xb=(1<<Re(w.m,2))-1,Be<3*(me=w.Xb))N=7;else{for(ae+=3*me,se-=3*me,Be=0;Be<me;++Be){var ot=N[Q+0]|N[Q+1]<<8|N[Q+2]<<16;ot>se&&(ot=se),Ct(w.Jc[+Be],N,ae,ot),ae+=ot,se-=ot,Q+=3}Ct(w.Jc[+me],N,ae,se),N=ae<j?0:5}if(0!=N)return gs(w,N,"cannot parse partitions");for(N=Re(ae=w.m,7),Q=ct(ae)?Je(ae,4):0,j=ct(ae)?Je(ae,4):0,se=ct(ae)?Je(ae,4):0,me=ct(ae)?Je(ae,4):0,ae=ct(ae)?Je(ae,4):0,Be=w.Qa,ot=0;4>ot;++ot){if(Be.Cb){var st=Be.Zb[ot];Be.Fb||(st+=N)}else{if(0<ot){w.pb[ot]=w.pb[0];continue}st=N}var Xe=w.pb[ot];Xe.Sc[0]=wF[uc(st+Q,127)],Xe.Sc[1]=CF[uc(st+0,127)],Xe.Eb[0]=2*wF[uc(st+j,127)],Xe.Eb[1]=101581*CF[uc(st+se,127)]>>16,8>Xe.Eb[1]&&(Xe.Eb[1]=8),Xe.Qc[0]=wF[uc(st+me,117)],Xe.Qc[1]=CF[uc(st+ae,127)],Xe.lc=st+ae}if(!re.Rb)return gs(w,4,"Not a key frame.");for(ct(ie),re=w.Pa,N=0;4>N;++N){for(Q=0;8>Q;++Q)for(j=0;3>j;++j)for(se=0;11>se;++se)me=pt(ie,nve[N][Q][j][se])?Re(ie,8):eve[N][Q][j][se],re.Wc[N][Q].Yb[j][se]=me;for(Q=0;17>Q;++Q)re.Xc[N][Q]=re.Wc[N][ive[Q]]}return w.kc=ct(ie),w.kc&&(w.Bd=Re(ie,8)),w.cb=1}function OS(w,k,N,j,Q,ie,re){var se=k[Q].Yb[N];for(N=0;16>Q;++Q){if(!pt(w,se[N+0]))return Q;for(;!pt(w,se[N+1]);)if(se=k[++Q].Yb[0],N=0,16==Q)return 16;var ae=k[Q+1].Yb;if(pt(w,se[N+2])){var me=w,Be=0;if(pt(me,(st=se)[(ot=N)+3]))if(pt(me,st[ot+6])){for(se=0,ot=2*(Be=pt(me,st[ot+8]))+(st=pt(me,st[ot+9+Be])),Be=0,st=J1e[ot];st[se];++se)Be+=Be+pt(me,st[se]);Be+=3+(8<<ot)}else pt(me,st[ot+7])?(Be=7+2*pt(me,165),Be+=pt(me,145)):Be=5+pt(me,159);else Be=pt(me,st[ot+4])?3+pt(me,st[ot+5]):2;se=ae[2]}else Be=1,se=ae[1];ae=re+Z1e[Q],0>(me=w).b&&it(me);var ot,st=me.b,Xe=(ot=me.Ca>>1)-(me.I>>st)>>31;--me.b,me.Ca+=Xe,me.Ca|=1,me.I-=(ot+1&Xe)<<st,ie[ae]=((Be^Xe)-Xe)*j[(0<Q)+0]}return 16}function lb(w){var k=w.rb[w.sb-1];k.la=0,k.Na=0,r(w.zc,0,0,w.zc.length),w.ja=0}function Ru(w,k,N,j,Q){w[k+N+32*j]=-256&(Q=w[k+N+32*j]+(Q>>3))?0>Q?0:255:Q}function h_(w,k,N,j,Q,ie){Ru(w,k,0,N,j+Q),Ru(w,k,1,N,j+ie),Ru(w,k,2,N,j-ie),Ru(w,k,3,N,j-Q)}function Ll(w){return(20091*w>>16)+w}function cb(w,k,N,j){var Q,ie=0,re=o(16);for(Q=0;4>Q;++Q){var se=w[k+0]+w[k+8],ae=w[k+0]-w[k+8],me=(35468*w[k+4]>>16)-Ll(w[k+12]),Be=Ll(w[k+4])+(35468*w[k+12]>>16);re[ie+0]=se+Be,re[ie+1]=ae+me,re[ie+2]=ae-me,re[ie+3]=se-Be,ie+=4,k++}for(Q=ie=0;4>Q;++Q)se=(w=re[ie+0]+4)+re[ie+8],ae=w-re[ie+8],me=(35468*re[ie+4]>>16)-Ll(re[ie+12]),Ru(N,j,0,0,se+(Be=Ll(re[ie+4])+(35468*re[ie+12]>>16))),Ru(N,j,1,0,ae+me),Ru(N,j,2,0,ae-me),Ru(N,j,3,0,se-Be),ie++,j+=32}function NS(w,k,N,j){var Q=w[k+0]+4,ie=35468*w[k+4]>>16,re=Ll(w[k+4]),se=35468*w[k+1]>>16;h_(N,j,0,Q+re,w=Ll(w[k+1]),se),h_(N,j,1,Q+ie,w,se),h_(N,j,2,Q-ie,w,se),h_(N,j,3,Q-re,w,se)}function QM(w,k,N,j,Q){cb(w,k,N,j),Q&&cb(w,k+16,N,j+4)}function LS(w,k,N,j){D_(w,k+0,N,j,1),D_(w,k+32,N,j+128,1)}function JM(w,k,N,j){var Q;for(w=w[k+0]+4,Q=0;4>Q;++Q)for(k=0;4>k;++k)Ru(N,j,k,Q,w)}function RS(w,k,N,j){w[k+0]&&zu(w,k+0,N,j),w[k+16]&&zu(w,k+16,N,j+4),w[k+32]&&zu(w,k+32,N,j+128),w[k+48]&&zu(w,k+48,N,j+128+4)}function ZM(w,k,N,j){var Q,ie=o(16);for(Q=0;4>Q;++Q){var re=w[k+0+Q]+w[k+12+Q],se=w[k+4+Q]+w[k+8+Q],ae=w[k+4+Q]-w[k+8+Q],me=w[k+0+Q]-w[k+12+Q];ie[0+Q]=re+se,ie[8+Q]=re-se,ie[4+Q]=me+ae,ie[12+Q]=me-ae}for(Q=0;4>Q;++Q)re=(w=ie[0+4*Q]+3)+ie[3+4*Q],ae=ie[1+4*Q]-ie[2+4*Q],me=w-ie[3+4*Q],N[j+0]=re+(se=ie[1+4*Q]+ie[2+4*Q])>>3,N[j+16]=me+ae>>3,N[j+32]=re-se>>3,N[j+48]=me-ae>>3,j+=64}function ub(w,k,N){var j,Q=k-32,ie=dc,re=255-w[Q-1];for(j=0;j<N;++j){var se,ae=ie,me=re+w[k-1];for(se=0;se<N;++se)w[k+se]=ae[me+w[Q+se]];k+=32}}function eF(w,k){ub(w,k,4)}function tF(w,k){ub(w,k,8)}function nF(w,k){ub(w,k,16)}function Ef(w,k){var N;for(N=0;16>N;++N)n(w,k+32*N,w,k-32,16)}function m_(w,k){var N;for(N=16;0<N;--N)r(w,k,w[k-1],16),k+=32}function g_(w,k,N){var j;for(j=0;16>j;++j)r(k,N+32*j,w,16)}function BS(w,k){var N,j=16;for(N=0;16>N;++N)j+=w[k-1+32*N]+w[k+N-32];g_(j>>5,w,k)}function Wa(w,k){var N,j=8;for(N=0;16>N;++N)j+=w[k-1+32*N];g_(j>>4,w,k)}function iF(w,k){var N,j=8;for(N=0;16>N;++N)j+=w[k+N-32];g_(j>>4,w,k)}function jS(w,k){g_(128,w,k)}function vi(w,k,N){return w+2*k+N+2>>2}function rF(w,k){var N,j=k-32;for(j=new Uint8Array([vi(w[j-1],w[j+0],w[j+1]),vi(w[j+0],w[j+1],w[j+2]),vi(w[j+1],w[j+2],w[j+3]),vi(w[j+2],w[j+3],w[j+4])]),N=0;4>N;++N)n(w,k+32*N,j,0,j.length)}function oF(w,k){var N=w[k-1],j=w[k-1+32],Q=w[k-1+64],ie=w[k-1+96];qt(w,k+0,16843009*vi(w[k-1-32],N,j)),qt(w,k+32,16843009*vi(N,j,Q)),qt(w,k+64,16843009*vi(j,Q,ie)),qt(w,k+96,16843009*vi(Q,ie,ie))}function Ad(w,k){var N,j=4;for(N=0;4>N;++N)j+=w[k+N-32]+w[k-1+32*N];for(j>>=3,N=0;4>N;++N)r(w,k+32*N,j,4)}function VS(w,k){var N=w[k-1+0],j=w[k-1+32],Q=w[k-1+64],ie=w[k-1-32],re=w[k+0-32],se=w[k+1-32],ae=w[k+2-32],me=w[k+3-32];w[k+0+96]=vi(j,Q,w[k-1+96]),w[k+1+96]=w[k+0+64]=vi(N,j,Q),w[k+2+96]=w[k+1+64]=w[k+0+32]=vi(ie,N,j),w[k+3+96]=w[k+2+64]=w[k+1+32]=w[k+0+0]=vi(re,ie,N),w[k+3+64]=w[k+2+32]=w[k+1+0]=vi(se,re,ie),w[k+3+32]=w[k+2+0]=vi(ae,se,re),w[k+3+0]=vi(me,ae,se)}function US(w,k){var N=w[k+1-32],j=w[k+2-32],Q=w[k+3-32],ie=w[k+4-32],re=w[k+5-32],se=w[k+6-32],ae=w[k+7-32];w[k+0+0]=vi(w[k+0-32],N,j),w[k+1+0]=w[k+0+32]=vi(N,j,Q),w[k+2+0]=w[k+1+32]=w[k+0+64]=vi(j,Q,ie),w[k+3+0]=w[k+2+32]=w[k+1+64]=w[k+0+96]=vi(Q,ie,re),w[k+3+32]=w[k+2+64]=w[k+1+96]=vi(ie,re,se),w[k+3+64]=w[k+2+96]=vi(re,se,ae),w[k+3+96]=vi(se,ae,ae)}function __(w,k){var N=w[k-1+0],j=w[k-1+32],Q=w[k-1+64],ie=w[k-1-32],re=w[k+0-32],se=w[k+1-32],ae=w[k+2-32],me=w[k+3-32];w[k+0+0]=w[k+1+64]=ie+re+1>>1,w[k+1+0]=w[k+2+64]=re+se+1>>1,w[k+2+0]=w[k+3+64]=se+ae+1>>1,w[k+3+0]=ae+me+1>>1,w[k+0+96]=vi(Q,j,N),w[k+0+64]=vi(j,N,ie),w[k+0+32]=w[k+1+96]=vi(N,ie,re),w[k+1+32]=w[k+2+96]=vi(ie,re,se),w[k+2+32]=w[k+3+96]=vi(re,se,ae),w[k+3+32]=vi(se,ae,me)}function db(w,k){var N=w[k+0-32],j=w[k+1-32],Q=w[k+2-32],ie=w[k+3-32],re=w[k+4-32],se=w[k+5-32],ae=w[k+6-32],me=w[k+7-32];w[k+0+0]=N+j+1>>1,w[k+1+0]=w[k+0+64]=j+Q+1>>1,w[k+2+0]=w[k+1+64]=Q+ie+1>>1,w[k+3+0]=w[k+2+64]=ie+re+1>>1,w[k+0+32]=vi(N,j,Q),w[k+1+32]=w[k+0+96]=vi(j,Q,ie),w[k+2+32]=w[k+1+96]=vi(Q,ie,re),w[k+3+32]=w[k+2+96]=vi(ie,re,se),w[k+3+64]=vi(re,se,ae),w[k+3+96]=vi(se,ae,me)}function sF(w,k){var N=w[k-1+0],j=w[k-1+32],Q=w[k-1+64],ie=w[k-1+96];w[k+0+0]=N+j+1>>1,w[k+2+0]=w[k+0+32]=j+Q+1>>1,w[k+2+32]=w[k+0+64]=Q+ie+1>>1,w[k+1+0]=vi(N,j,Q),w[k+3+0]=w[k+1+32]=vi(j,Q,ie),w[k+3+32]=w[k+1+64]=vi(Q,ie,ie),w[k+3+64]=w[k+2+64]=w[k+0+96]=w[k+1+96]=w[k+2+96]=w[k+3+96]=ie}function aF(w,k){var N=w[k-1+0],j=w[k-1+32],Q=w[k-1+64],ie=w[k-1+96],re=w[k-1-32],se=w[k+0-32],ae=w[k+1-32],me=w[k+2-32];w[k+0+0]=w[k+2+32]=N+re+1>>1,w[k+0+32]=w[k+2+64]=j+N+1>>1,w[k+0+64]=w[k+2+96]=Q+j+1>>1,w[k+0+96]=ie+Q+1>>1,w[k+3+0]=vi(se,ae,me),w[k+2+0]=vi(re,se,ae),w[k+1+0]=w[k+3+32]=vi(N,re,se),w[k+1+32]=w[k+3+64]=vi(j,N,re),w[k+1+64]=w[k+3+96]=vi(Q,j,N),w[k+1+96]=vi(ie,Q,j)}function lF(w,k){var N;for(N=0;8>N;++N)n(w,k+32*N,w,k-32,8)}function fb(w,k){var N;for(N=0;8>N;++N)r(w,k,w[k-1],8),k+=32}function qm(w,k,N){var j;for(j=0;8>j;++j)r(k,N+32*j,w,8)}function Jp(w,k){var N,j=8;for(N=0;8>N;++N)j+=w[k+N-32]+w[k-1+32*N];qm(j>>4,w,k)}function cF(w,k){var N,j=4;for(N=0;8>N;++N)j+=w[k+N-32];qm(j>>3,w,k)}function Gm(w,k){var N,j=4;for(N=0;8>N;++N)j+=w[k-1+32*N];qm(j>>3,w,k)}function pb(w,k){qm(128,w,k)}function v_(w,k,N){var j=w[k-N],Q=w[k+0],ie=3*(Q-j)+_F[1020+w[k-2*N]-w[k+N]],re=QS[112+(ie+4>>3)];w[k-N]=dc[255+j+QS[112+(ie+3>>3)]],w[k+0]=dc[255+Q-re]}function HS(w,k,N,j){return Yc[255+w[k-2*N]-w[k-N]]>j||Yc[255+w[k+N]-w[k+0]]>j}function zS(w,k,N,j){return 4*Yc[255+w[k-N]-w[k+0]]+Yc[255+w[k-2*N]-w[k+N]]<=j}function $S(w,k,N,j,Q){var ie=w[k-3*N],re=w[k-2*N],se=w[k-N],ae=w[k+0],me=w[k+N],Be=w[k+2*N];return 4*Yc[255+se-ae]+Yc[255+re-me]>j?0:Yc[255+w[k-4*N]-ie]<=Q&&Yc[255+ie-re]<=Q&&Yc[255+re-se]<=Q&&Yc[255+w[k+3*N]-Be]<=Q&&Yc[255+Be-me]<=Q&&Yc[255+me-ae]<=Q}function WS(w,k,N,j){var Q=2*j+1;for(j=0;16>j;++j)zS(w,k+j,N,Q)&&v_(w,k+j,N)}function kf(w,k,N,j){var Q=2*j+1;for(j=0;16>j;++j)zS(w,k+j*N,1,Q)&&v_(w,k+j*N,1)}function Zp(w,k,N,j){var Q;for(Q=3;0<Q;--Q)WS(w,k+=4*N,N,j)}function uF(w,k,N,j){var Q;for(Q=3;0<Q;--Q)kf(w,k+=4,N,j)}function eh(w,k,N,j,Q,ie,re,se){for(ie=2*ie+1;0<Q--;){if($S(w,k,N,ie,re))if(HS(w,k,N,se))v_(w,k,N);else{var ae=w,me=k,Be=N,ot=ae[me-2*Be],st=ae[me-Be],Xe=ae[me+0],Bt=ae[me+Be],St=ae[me+2*Be],Ve=27*(Ot=_F[1020+3*(Xe-st)+_F[1020+ot-Bt]])+63>>7,$e=18*Ot+63>>7,Ot=9*Ot+63>>7;ae[me-3*Be]=dc[255+ae[me-3*Be]+Ot],ae[me-2*Be]=dc[255+ot+$e],ae[me-Be]=dc[255+st+Ve],ae[me+0]=dc[255+Xe-Ve],ae[me+Be]=dc[255+Bt-$e],ae[me+2*Be]=dc[255+St-Ot]}k+=j}}function Bu(w,k,N,j,Q,ie,re,se){for(ie=2*ie+1;0<Q--;){if($S(w,k,N,ie,re))if(HS(w,k,N,se))v_(w,k,N);else{var ae=w,me=k,Be=N,ot=ae[me-Be],st=ae[me+0],Xe=ae[me+Be],Bt=QS[112+(4+(St=3*(st-ot))>>3)],St=QS[112+(St+3>>3)],Ve=Bt+1>>1;ae[me-2*Be]=dc[255+ae[me-2*Be]+Ve],ae[me-Be]=dc[255+ot+St],ae[me+0]=dc[255+st-Bt],ae[me+Be]=dc[255+Xe-Ve]}k+=j}}function hb(w,k,N,j,Q,ie){eh(w,k,N,1,16,j,Q,ie)}function Km(w,k,N,j,Q,ie){eh(w,k,1,N,16,j,Q,ie)}function dF(w,k,N,j,Q,ie){var re;for(re=3;0<re;--re)Bu(w,k+=4*N,N,1,16,j,Q,ie)}function y_(w,k,N,j,Q,ie){var re;for(re=3;0<re;--re)Bu(w,k+=4,1,N,16,j,Q,ie)}function fF(w,k,N,j,Q,ie,re,se){eh(w,k,Q,1,8,ie,re,se),eh(N,j,Q,1,8,ie,re,se)}function mb(w,k,N,j,Q,ie,re,se){eh(w,k,1,Q,8,ie,re,se),eh(N,j,1,Q,8,ie,re,se)}function gb(w,k,N,j,Q,ie,re,se){Bu(w,k+4*Q,Q,1,8,ie,re,se),Bu(N,j+4*Q,Q,1,8,ie,re,se)}function qS(w,k,N,j,Q,ie,re,se){Bu(w,k+4,1,Q,8,ie,re,se),Bu(N,j+4,1,Q,8,ie,re,se)}function b_(){this.ba=new Fu,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Xo,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function _b(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function vb(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function GS(){this.ua=0,this.Wa=new ke,this.vb=new ke,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Ae,this.yc=new de}function pF(){this.xb=this.a=0,this.l=new p_,this.ca=new Fu,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new ne,this.Pb=0,this.wd=new ne,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new GS,this.ab=0,this.gc=c(4,vb),this.Oc=0}function x_(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new p_,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ym(w,k,N,j,Q,ie,re){for(w=null==w?0:w[k+0],k=0;k<re;++k)Q[ie+k]=w+N[j+k]&255,w=Q[ie+k]}function yb(w,k,N,j,Q,ie,re){var se;if(null==w)Ym(null,null,N,j,Q,ie,re);else for(se=0;se<re;++se)Q[ie+se]=w[k+se]+N[j+se]&255}function th(w,k,N,j,Q,ie,re){if(null==w)Ym(null,null,N,j,Q,ie,re);else{var se,ae=w[k+0],me=ae,Be=ae;for(se=0;se<re;++se)me=Be+(ae=w[k+se])-me,Be=N[j+se]+(-256&me?0>me?0:255:me)&255,me=ae,Q[ie+se]=Be}}function bb(w,k,N,j){var Q=k.width,ie=k.o;if(i(null!=w&&null!=k),0>N||0>=j||N+j>ie)return null;if(!w.Cc){if(null==w.ga){var re;if(w.ga=new x_,(re=null==w.ga)||(re=k.width*k.o,i(0==w.Gb.length),w.Gb=o(re),w.Uc=0,null==w.Gb?re=0:(w.mb=w.Gb,w.nb=w.Uc,w.rc=null,re=1),re=!re),!re){var se=w.Fa,ae=w.P,me=w.qc,Be=w.mb,ot=w.nb,st=ae+1,Xe=me-1,Bt=(re=w.ga).l;if(i(null!=se&&null!=Be&&null!=k),lh[0]=null,lh[1]=Ym,lh[2]=yb,lh[3]=th,re.ca=Be,re.tb=ot,re.c=k.width,re.i=k.height,i(0<re.c&&0<re.i),1>=me)k=0;else if(re.$a=se[ae+0]>>0&3,re.Z=se[ae+0]>>2&3,re.Lc=se[ae+0]>>4&3,ae=se[ae+0]>>6&3,0>re.$a||1<re.$a||4<=re.Z||1<re.Lc||ae)k=0;else if(Bt.put=Sd,Bt.ac=ka,Bt.bc=Ed,Bt.ma=re,Bt.width=k.width,Bt.height=k.height,Bt.Da=k.Da,Bt.v=k.v,Bt.va=k.va,Bt.j=k.j,Bt.o=k.o,re.$a)e:{i(1==re.$a),k=qc();t:for(;;){if(null==k){k=0;break e}if(i(null!=re),re.mc=k,k.c=re.c,k.i=re.i,k.l=re.l,k.l.ma=re,k.l.width=re.c,k.l.height=re.i,k.a=0,Ue(k.m,se,st,Xe),!Id(re.c,re.i,1,k,null)||(1==k.ab&&3==k.gc[0].hc&&Sf(k.s)?(re.ic=1,se=k.c*k.i,k.Ta=null,k.Ua=0,k.V=o(se),k.Ba=0,null==k.V?(k.a=1,k=0):k=1):(re.ic=0,k=Wm(k,re.c)),!k))break t;k=1;break e}re.mc=null,k=0}else k=Xe>=re.c*re.i;re=!k}if(re)return null;1!=w.ga.Lc?w.Ga=0:j=ie-N}i(null!=w.ga),i(N+j<=ie);e:{if(k=(se=w.ga).c,ie=se.l.o,0==se.$a){if(st=w.rc,Xe=w.Vc,Bt=w.Fa,me=w.mb,Be=w.nb+N*k,i((ae=w.P+1+N*k)<=w.P+w.qc),0!=se.Z)for(i(null!=lh[se.Z]),re=0;re<j;++re)lh[se.Z](st,Xe,Bt,ae,me,Be,k),st=me,Xe=Be,Be+=k,ae+=k;else for(re=0;re<j;++re)n(me,Be,Bt,ae,k),st=me,Xe=Be,Be+=k,ae+=k;w.rc=st,w.Vc=Xe}else{if(i(null!=se.mc),k=N+j,i(null!=(re=se.mc)),i(k<=re.i),re.C>=k)k=1;else if(se.ic||nt(),se.ic){se=re.V,st=re.Ba;var St=re.i,Ve=(Bt=1,ae=re.$/(Xe=re.c),me=re.$%Xe,Be=re.m,ot=re.s,re.$),$e=Xe*St,Ot=Xe*k,Ht=ot.wc,Lt=Ve<Ot?As(ot,me,ae):null;i(Ve<=$e),i(k<=St),i(Sf(ot));t:for(;;){for(;!Be.h&&Ve<Ot;){if(me&Ht||(Lt=As(ot,me,ae)),i(null!=Lt),Ze(Be),256>(St=Nl(Lt.G[0],Lt.H[0],Be)))se[st+Ve]=St,++Ve,++me>=Xe&&(me=0,++ae<=k&&!(ae%16)&&Nu(re,ae));else{if(!(280>St)){Bt=0;break t}St=Pu(St-256,Be);var Cn,un=Nl(Lt.G[4],Lt.H[4],Be);if(Ze(Be),!(Ve>=(un=kd(Xe,un=Pu(un,Be)))&&$e-Ve>=St)){Bt=0;break t}for(Cn=0;Cn<St;++Cn)se[st+Ve+Cn]=se[st+Ve+Cn-un];for(Ve+=St,me+=St;me>=Xe;)me-=Xe,++ae<=k&&!(ae%16)&&Nu(re,ae);Ve<Ot&&me&Ht&&(Lt=As(ot,me,ae))}i(Be.h==we(Be))}Nu(re,ae>k?k:ae);break t}!Bt||Be.h&&Ve<$e?(Bt=0,re.a=Be.h?5:3):re.$=Ve,k=Bt}else k=Lu(re,re.V,re.Ba,re.c,re.i,k,l_);if(!k){j=0;break e}}N+j>=ie&&(w.Cc=1),j=1}if(!j)return null;if(w.Cc&&(null!=(j=w.ga)&&(j.mc=null),w.ga=null,0<w.Ga))return alert("todo:WebPDequantizeLevels"),null}return w.nb+N*Q}function P(w,k,N,j,Q,ie){for(;0<Q--;){var re,se=w,ae=k+(N?1:0),me=w,Be=k+(N?0:3);for(re=0;re<j;++re){var ot=me[Be+4*re];255!=ot&&(se[ae+4*re+0]=se[ae+4*re+0]*(ot*=32897)>>23,se[ae+4*re+1]=se[ae+4*re+1]*ot>>23,se[ae+4*re+2]=se[ae+4*re+2]*ot>>23)}k+=ie}}function J(w,k,N,j,Q){for(;0<j--;){var ie;for(ie=0;ie<N;++ie){var re=w[k+2*ie+0],se=15&(me=w[k+2*ie+1]),ae=4369*se,me=(240&me|me>>4)*ae>>16;w[k+2*ie+0]=(240&re|re>>4)*ae>>16&240|(15&re|re<<4)*ae>>16>>4&15,w[k+2*ie+1]=240&me|se}k+=Q}}function Ce(w,k,N,j,Q,ie,re,se){var ae,me,Be=255;for(me=0;me<Q;++me){for(ae=0;ae<j;++ae){var ot=w[k+ae];ie[re+4*ae]=ot,Be&=ot}k+=N,re+=se}return 255!=Be}function Le(w,k,N,j,Q){var ie;for(ie=0;ie<Q;++ie)N[j+ie]=w[k+ie]>>8}function nt(){sh=P,A_=J,XS=Ce,Q9=Le}function Dt(w,k,N){Te[w]=function(j,Q,ie,re,se,ae,me,Be,ot,st,Xe,Bt,St,Ve,$e,Ot,Ht){var Lt,Cn=Ht-1>>1,un=se[ae+0]|me[Be+0]<<16,Yn=ot[st+0]|Xe[Bt+0]<<16;i(null!=j);var pn=3*un+Yn+131074>>2;for(k(j[Q+0],255&pn,pn>>16,St,Ve),null!=ie&&k(ie[re+0],255&(pn=3*Yn+un+131074>>2),pn>>16,$e,Ot),Lt=1;Lt<=Cn;++Lt){var Ar=se[ae+Lt]|me[Be+Lt]<<16,Wr=ot[st+Lt]|Xe[Bt+Lt]<<16,yr=un+Ar+Yn+Wr+524296,rr=yr+2*(Ar+Yn)>>3;pn=rr+un>>1,un=(yr=yr+2*(un+Wr)>>3)+Ar>>1,k(j[Q+2*Lt-1],255&pn,pn>>16,St,Ve+(2*Lt-1)*N),k(j[Q+2*Lt-0],255&un,un>>16,St,Ve+(2*Lt-0)*N),null!=ie&&(un=rr+Wr>>1,k(ie[re+2*Lt-1],255&(pn=yr+Yn>>1),pn>>16,$e,Ot+(2*Lt-1)*N),k(ie[re+2*Lt+0],255&un,un>>16,$e,Ot+(2*Lt+0)*N)),un=Ar,Yn=Wr}1&Ht||(k(j[Q+Ht-1],255&(pn=3*un+Yn+131074>>2),pn>>16,St,Ve+(Ht-1)*N),null!=ie&&k(ie[re+Ht-1],255&(pn=3*Yn+un+131074>>2),pn>>16,$e,Ot+(Ht-1)*N))}}function $t(){Xc[JS]=ove,Xc[ZS]=lB,Xc[iB]=sve,Xc[e5]=cB,Xc[t5]=uB,Xc[vF]=dB,Xc[rB]=ave,Xc[yF]=lB,Xc[bF]=cB,Xc[n5]=uB,Xc[xF]=dB}function wn(w){return w&~lve?0>w?0:255:w>>fB}function Gn(w,k){return wn((19077*w>>8)+(26149*k>>8)-14234)}function Ii(w,k,N){return wn((19077*w>>8)-(6419*k>>8)-(13320*N>>8)+8708)}function Ui(w,k){return wn((19077*w>>8)+(33050*k>>8)-17685)}function pr(w,k,N,j,Q){j[Q+0]=Gn(w,N),j[Q+1]=Ii(w,k,N),j[Q+2]=Ui(w,k)}function Bo(w,k,N,j,Q){j[Q+0]=Ui(w,k),j[Q+1]=Ii(w,k,N),j[Q+2]=Gn(w,N)}function Qo(w,k,N,j,Q){var ie=Ii(w,k,N);k=ie<<3&224|Ui(w,k)>>3,j[Q+0]=248&Gn(w,N)|ie>>5,j[Q+1]=k}function Ms(w,k,N,j,Q){var ie=240&Ui(w,k)|15;j[Q+0]=240&Gn(w,N)|Ii(w,k,N)>>4,j[Q+1]=ie}function qa(w,k,N,j,Q){j[Q+0]=255,pr(w,k,N,j,Q+1)}function ca(w,k,N,j,Q){Bo(w,k,N,j,Q),j[Q+3]=255}function ju(w,k,N,j,Q){pr(w,k,N,j,Q),j[Q+3]=255}function uc(w,k){return 0>w?0:w>k?k:w}function Df(w,k,N){Te[w]=function(j,Q,ie,re,se,ae,me,Be,ot){for(var st=Be+(-2&ot)*N;Be!=st;)k(j[Q+0],ie[re+0],se[ae+0],me,Be),k(j[Q+1],ie[re+0],se[ae+0],me,Be+N),Q+=2,++re,++ae,Be+=2*N;1&ot&&k(j[Q+0],ie[re+0],se[ae+0],me,Be)}}function KS(w,k,N){return 0==N?0==w?0==k?6:5:0==k?4:0:N}function xb(w,k,N,j,Q){switch(w>>>30){case 3:D_(k,N,j,Q,0);break;case 2:Db(k,N,j,Q);break;case 1:zu(k,N,j,Q)}}function wb(w,k){var N,j,Q=k.M,ie=k.Nb,re=w.oc,se=w.pc+40,ae=w.oc,me=w.pc+584,Be=w.oc,ot=w.pc+600;for(N=0;16>N;++N)re[se+32*N-1]=129;for(N=0;8>N;++N)ae[me+32*N-1]=129,Be[ot+32*N-1]=129;for(0<Q?re[se-1-32]=ae[me-1-32]=Be[ot-1-32]=129:(r(re,se-32-1,127,21),r(ae,me-32-1,127,9),r(Be,ot-32-1,127,9)),j=0;j<w.za;++j){var st=k.ya[k.aa+j];if(0<j){for(N=-1;16>N;++N)n(re,se+32*N-4,re,se+32*N+12,4);for(N=-1;8>N;++N)n(ae,me+32*N-4,ae,me+32*N+4,4),n(Be,ot+32*N-4,Be,ot+32*N+4,4)}var Xe=w.Gd,Bt=w.Hd+j,St=st.ad,Ve=st.Hc;if(0<Q&&(n(re,se-32,Xe[Bt].y,0,16),n(ae,me-32,Xe[Bt].f,0,8),n(Be,ot-32,Xe[Bt].ea,0,8)),st.Za){var $e=re,Ot=se-32+16;for(0<Q&&(j>=w.za-1?r($e,Ot,Xe[Bt].y[15],4):n($e,Ot,Xe[Bt+1].y,0,4)),N=0;4>N;N++)$e[Ot+128+N]=$e[Ot+256+N]=$e[Ot+384+N]=$e[Ot+0+N];for(N=0;16>N;++N,Ve<<=2)$u[st.Ob[N]]($e=re,Ot=se+hB[N]),xb(Ve,St,16*+N,$e,Ot)}else if($e=KS(j,Q,st.Ob[0]),ah[$e](re,se),0!=Ve)for(N=0;16>N;++N,Ve<<=2)xb(Ve,St,16*+N,re,se+hB[N]);for(N=st.Gc,$e=KS(j,Q,st.Dd),Pf[$e](ae,me),Pf[$e](Be,ot),Ve=St,$e=ae,Ot=me,255&(st=N>>0)&&(170&st?rh(Ve,256,$e,Ot):Af(Ve,256,$e,Ot)),st=Be,Ve=ot,255&(N>>=8)&&(170&N?rh(St,320,st,Ve):Af(St,320,st,Ve)),Q<w.Ub-1&&(n(Xe[Bt].y,0,re,se+480,16),n(Xe[Bt].f,0,ae,me+224,8),n(Xe[Bt].ea,0,Be,ot+224,8)),Xe=w.sa,Bt=w.ta+16*j+16*ie*w.R,St=w.qa,st=w.ra+8*j+(N=8*ie*w.B),Ve=w.Ha,$e=w.Ia+8*j+N,N=0;16>N;++N)n(Xe,Bt+N*w.R,re,se+32*N,16);for(N=0;8>N;++N)n(St,st+N*w.B,ae,me+32*N,8),n(Ve,$e+N*w.B,Be,ot+32*N,8)}}function w_(w,k,N,j,Q,ie,re,se,ae){var me=[0],Be=[0],ot=0,st=null!=ae?ae.kd:0,Xe=null!=ae?ae:new _b;if(null==w||12>N)return 7;Xe.data=w,Xe.w=k,Xe.ha=N,k=[k],N=[N],Xe.gb=[Xe.gb];e:{var Bt=k,St=N,Ve=Xe.gb;if(i(null!=w),i(null!=St),i(null!=Ve),Ve[0]=0,12<=St[0]&&!e(w,Bt[0],"RIFF")){if(e(w,Bt[0]+8,"WEBP")){Ve=3;break e}var $e=En(w,Bt[0]+4);if(12>$e||4294967286<$e){Ve=3;break e}if(st&&$e>St[0]-8){Ve=7;break e}Ve[0]=$e,Bt[0]+=12,St[0]-=12}Ve=0}if(0!=Ve)return Ve;for($e=0<Xe.gb[0],N=N[0];;){e:{var Ot=w;St=k,Ve=N;var Ht=me,Lt=Be,Cn=Bt=[0];if((pn=ot=[ot])[0]=0,8>Ve[0])Ve=7;else{if(!e(Ot,St[0],"VP8X")){if(10!=En(Ot,St[0]+4)){Ve=3;break e}if(18>Ve[0]){Ve=7;break e}var un=En(Ot,St[0]+8),Yn=1+xn(Ot,St[0]+12);if(2147483648<=Yn*(Ot=1+xn(Ot,St[0]+15))){Ve=3;break e}null!=Cn&&(Cn[0]=un),null!=Ht&&(Ht[0]=Yn),null!=Lt&&(Lt[0]=Ot),St[0]+=18,Ve[0]-=18,pn[0]=1}Ve=0}}if(ot=ot[0],0!=Ve)return Ve;if(St=!!(2&(Bt=Bt[0])),!$e&&ot)return 3;if(null!=ie&&(ie[0]=!!(16&Bt)),null!=re&&(re[0]=St),null!=se&&(se[0]=0),re=me[0],Bt=Be[0],ot&&St&&null==ae){Ve=0;break}if(4>N){Ve=7;break}if($e&&ot||!$e&&!ot&&!e(w,k[0],"ALPH")){N=[N],Xe.na=[Xe.na],Xe.P=[Xe.P],Xe.Sa=[Xe.Sa];e:{Ve=k,$e=N;var pn=Xe.gb;Ht=Xe.na,Lt=Xe.P,Cn=Xe.Sa,Yn=22,i(null!=(un=w)),i(null!=$e),Ot=Ve[0];var Ar=$e[0];for(i(null!=Ht),i(null!=Cn),Ht[0]=null,Lt[0]=null,Cn[0]=0;;){if(Ve[0]=Ot,$e[0]=Ar,8>Ar){Ve=7;break e}var Wr=En(un,Ot+4);if(4294967286<Wr){Ve=3;break e}var yr=8+Wr+1&-2;if(Yn+=yr,0<pn&&Yn>pn){Ve=3;break e}if(!e(un,Ot,"VP8 ")||!e(un,Ot,"VP8L")){Ve=0;break e}if(Ar[0]<yr){Ve=7;break e}e(un,Ot,"ALPH")||(Ht[0]=un,Lt[0]=Ot+8,Cn[0]=Wr),Ot+=yr,Ar-=yr}}if(N=N[0],Xe.na=Xe.na[0],Xe.P=Xe.P[0],Xe.Sa=Xe.Sa[0],0!=Ve)break}N=[N],Xe.Ja=[Xe.Ja],Xe.xa=[Xe.xa];e:if(pn=w,Ve=k,$e=N,Ht=Xe.gb[0],Lt=Xe.Ja,Cn=Xe.xa,un=Ve[0],Ot=!e(pn,un,"VP8 "),Yn=!e(pn,un,"VP8L"),i(null!=pn),i(null!=$e),i(null!=Lt),i(null!=Cn),8>$e[0])Ve=7;else{if(Ot||Yn){if(pn=En(pn,un+4),12<=Ht&&pn>Ht-12){Ve=3;break e}if(st&&pn>$e[0]-8){Ve=7;break e}Lt[0]=pn,Ve[0]+=8,$e[0]-=8,Cn[0]=Yn}else Cn[0]=5<=$e[0]&&47==pn[un+0]&&!(pn[un+4]>>5),Lt[0]=$e[0];Ve=0}if(N=N[0],Xe.Ja=Xe.Ja[0],Xe.xa=Xe.xa[0],k=k[0],0!=Ve)break;if(4294967286<Xe.Ja)return 3;if(null==se||St||(se[0]=Xe.xa?2:1),re=[re],Bt=[Bt],Xe.xa){if(5>N){Ve=7;break}se=re,st=Bt,St=ie,null==w||5>N?w=0:5<=N&&47==w[k+0]&&!(w[k+4]>>5)?($e=[0],pn=[0],Ht=[0],Ue(Lt=new ne,w,k,N),ti(Lt,$e,pn,Ht)?(null!=se&&(se[0]=$e[0]),null!=st&&(st[0]=pn[0]),null!=St&&(St[0]=Ht[0]),w=1):w=0):w=0}else{if(10>N){Ve=7;break}se=Bt,null==w||10>N||!FS(w,k+3,N-3)?w=0:(st=w[k+0]|w[k+1]<<8|w[k+2]<<16,St=16383&(w[k+7]<<8|w[k+6]),w=16383&(w[k+9]<<8|w[k+8]),1&st||3<(st>>1&7)||!(st>>4&1)||st>>5>=Xe.Ja||!St||!w?w=0:(re&&(re[0]=St),se&&(se[0]=w),w=1))}if(!w||(re=re[0],Bt=Bt[0],ot&&(me[0]!=re||Be[0]!=Bt)))return 3;null!=ae&&(ae[0]=Xe,ae.offset=k-ae.w,i(4294967286>k-ae.w),i(ae.offset==ae.ha-N));break}return 0==Ve||7==Ve&&ot&&null==ae?(null!=ie&&(ie[0]|=null!=Xe.na&&0<Xe.na.length),null!=j&&(j[0]=re),null!=Q&&(Q[0]=Bt),0):Ve}function Cb(w,k,N){var j=k.width,Q=k.height,ie=0,re=0,se=j,ae=Q;if(k.Da=null!=w&&0<w.Da,k.Da&&(se=w.cd,ae=w.bd,ie=w.v,re=w.j,11>N||(ie&=-2,re&=-2),0>ie||0>re||0>=se||0>=ae||ie+se>j||re+ae>Q))return 0;if(k.v=ie,k.j=re,k.va=ie+se,k.o=re+ae,k.U=se,k.T=ae,k.da=null!=w&&0<w.da,k.da){if(!Di(se,ae,N=[w.ib],ie=[w.hb]))return 0;k.ib=N[0],k.hb=ie[0]}return k.ob=null!=w&&w.ob,k.Kb=null==w||!w.Sd,k.da&&(k.ob=k.ib<3*j/4&&k.hb<3*Q/4,k.Kb=0),1}function Tb(w){if(null==w)return 2;if(11>w.S){var k=w.f.RGBA;k.fb+=(w.height-1)*k.A,k.A=-k.A}else(k=w.f.kb).O+=((w=w.height)-1)*k.fa,k.fa=-k.fa,k.N+=(w-1>>1)*k.Ab,k.Ab=-k.Ab,k.W+=(w-1>>1)*k.Db,k.Db=-k.Db,null!=k.F&&(k.J+=(w-1)*k.lb,k.lb=-k.lb);return 0}function C_(w,k,N,j){if(null==j||0>=w||0>=k)return 2;if(null!=N){if(N.Da){var Q=N.cd,ie=N.bd,re=-2&N.v,se=-2&N.j;if(0>re||0>se||0>=Q||0>=ie||re+Q>w||se+ie>k)return 2;w=Q,k=ie}if(N.da){if(!Di(w,k,Q=[N.ib],ie=[N.hb]))return 2;w=Q[0],k=ie[0]}}j.width=w,j.height=k;e:{var ae=j.width,me=j.height;if(w=j.S,0>=ae||0>=me||!(w>=JS&&13>w))w=2;else{if(0>=j.Rd&&null==j.sd){re=ie=Q=k=0;var Be=(se=ae*mB[w])*me;if(11>w||(ie=(me+1)/2*(k=(ae+1)/2),12==w&&(re=(Q=ae)*me)),null==(me=o(Be+2*ie+re))){w=1;break e}j.sd=me,11>w?((ae=j.f.RGBA).eb=me,ae.fb=0,ae.A=se,ae.size=Be):((ae=j.f.kb).y=me,ae.O=0,ae.fa=se,ae.Fd=Be,ae.f=me,ae.N=0+Be,ae.Ab=k,ae.Cd=ie,ae.ea=me,ae.W=0+Be+ie,ae.Db=k,ae.Ed=ie,12==w&&(ae.F=me,ae.J=0+Be+2*ie),ae.Tc=re,ae.lb=Q)}if(k=1,ie=j.width,re=j.height,(Q=j.S)>=JS&&13>Q)if(11>Q)w=j.f.RGBA,k&=(se=Math.abs(w.A))*(re-1)+ie<=w.size,k&=se>=ie*mB[Q],k&=null!=w.eb;else{w=j.f.kb,se=(ie+1)/2,Be=(re+1)/2,ae=Math.abs(w.fa),me=Math.abs(w.Ab);var ot=Math.abs(w.Db),st=Math.abs(w.lb);k&=ae*(re-1)+ie<=w.Fd,k&=me*(Be-1)+se<=w.Cd,k=(k&=ot*(Be-1)+se<=w.Ed)&ae>=ie&me>=se&ot>=se,k&=null!=w.y,k&=null!=w.f,k&=null!=w.ea,12==Q&&(k&=st>=ie,k&=st*(re-1)+ie<=w.Tc,k&=null!=w.F)}else k=0;w=k?0:2}}return 0!=w||null!=N&&N.fd&&(w=Tb(j)),w}var Rl=64,T_=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],S_=24,E_=32,Sb=8,Bl=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];cn("Predictor0","PredictorAdd0"),Te.Predictor0=function(){return 4278190080},Te.Predictor1=function(w){return w},Te.Predictor2=function(w,k,N){return k[N+0]},Te.Predictor3=function(w,k,N){return k[N+1]},Te.Predictor4=function(w,k,N){return k[N-1]},Te.Predictor5=function(w,k,N){return gn(gn(w,k[N+1]),k[N+0])},Te.Predictor6=function(w,k,N){return gn(w,k[N-1])},Te.Predictor7=function(w,k,N){return gn(w,k[N+0])},Te.Predictor8=function(w,k,N){return gn(k[N-1],k[N+0])},Te.Predictor9=function(w,k,N){return gn(k[N+0],k[N+1])},Te.Predictor10=function(w,k,N){return gn(gn(w,k[N-1]),gn(k[N+0],k[N+1]))},Te.Predictor11=function(w,k,N){var j=k[N+0];return 0>=Bi(j>>24&255,w>>24&255,(k=k[N-1])>>24&255)+Bi(j>>16&255,w>>16&255,k>>16&255)+Bi(j>>8&255,w>>8&255,k>>8&255)+Bi(255&j,255&w,255&k)?j:w},Te.Predictor12=function(w,k,N){var j=k[N+0];return($n((w>>24&255)+(j>>24&255)-((k=k[N-1])>>24&255))<<24|$n((w>>16&255)+(j>>16&255)-(k>>16&255))<<16|$n((w>>8&255)+(j>>8&255)-(k>>8&255))<<8|$n((255&w)+(255&j)-(255&k)))>>>0},Te.Predictor13=function(w,k,N){var j=k[N-1];return(xi((w=gn(w,k[N+0]))>>24&255,j>>24&255)<<24|xi(w>>16&255,j>>16&255)<<16|xi(w>>8&255,j>>8&255)<<8|xi(w>>0&255,j>>0&255))>>>0};var hF=Te.PredictorAdd0;Te.PredictorAdd1=Ki,cn("Predictor2","PredictorAdd2"),cn("Predictor3","PredictorAdd3"),cn("Predictor4","PredictorAdd4"),cn("Predictor5","PredictorAdd5"),cn("Predictor6","PredictorAdd6"),cn("Predictor7","PredictorAdd7"),cn("Predictor8","PredictorAdd8"),cn("Predictor9","PredictorAdd9"),cn("Predictor10","PredictorAdd10"),cn("Predictor11","PredictorAdd11"),cn("Predictor12","PredictorAdd12"),cn("Predictor13","PredictorAdd13");var Eb=Te.PredictorAdd2;er("ColorIndexInverseTransform","MapARGB","32b",function(w){return w>>8&255},function(w){return w}),er("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(w){return w},function(w){return w>>8&255});var YS,Vu=Te.ColorIndexInverseTransform,kb=Te.MapARGB,mF=Te.VP8LColorIndexInverseTransformAlpha,gF=Te.MapAlpha,nh=Te.VP8LPredictorsAdd=[];nh.length=16,(Te.VP8LPredictors=[]).length=16,(Te.VP8LPredictorsAdd_C=[]).length=16,(Te.VP8LPredictors_C=[]).length=16;var Gc,Uu,ih,Md,If,k_,Hu,D_,Db,rh,zu,Af,Xm,I_,Qm,oh,Ib,Kc,Mf,go,_o,_s,Gs,Ff,sh,A_,XS,Q9,J9=o(511),Z9=o(2041),eB=o(225),tB=o(767),nB=0,_F=Z9,QS=eB,dc=tB,Yc=J9,JS=0,ZS=1,iB=2,e5=3,t5=4,vF=5,rB=6,yF=7,bF=8,n5=9,xF=10,W1e=[2,3,7],q1e=[3,3,11],oB=[280,256,256,256,40],G1e=[0,1,1,1,0],K1e=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Y1e=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],X1e=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Q1e=8,wF=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],CF=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ab=null,J1e=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Z1e=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],sB=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],eve=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],tve=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],nve=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ive=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ah=[],$u=[],Pf=[],rve=1,aB=2,lh=[],Xc=[];Dt("UpsampleRgbLinePair",pr,3),Dt("UpsampleBgrLinePair",Bo,3),Dt("UpsampleRgbaLinePair",ju,4),Dt("UpsampleBgraLinePair",ca,4),Dt("UpsampleArgbLinePair",qa,4),Dt("UpsampleRgba4444LinePair",Ms,2),Dt("UpsampleRgb565LinePair",Qo,2);var ove=Te.UpsampleRgbLinePair,sve=Te.UpsampleBgrLinePair,lB=Te.UpsampleRgbaLinePair,cB=Te.UpsampleBgraLinePair,uB=Te.UpsampleArgbLinePair,dB=Te.UpsampleRgba4444LinePair,ave=Te.UpsampleRgb565LinePair,r5=16,o5=1<<r5-1,Mb=-227,TF=482,fB=6,lve=(256<<fB)-1,pB=0,cve=o(256),uve=o(256),dve=o(256),fve=o(256),pve=o(TF-Mb),hve=o(TF-Mb);Df("YuvToRgbRow",pr,3),Df("YuvToBgrRow",Bo,3),Df("YuvToRgbaRow",ju,4),Df("YuvToBgraRow",ca,4),Df("YuvToArgbRow",qa,4),Df("YuvToRgba4444Row",Ms,2),Df("YuvToRgb565Row",Qo,2);var hB=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],s5=[0,2,8],mve=[8,7,6,4,4,2,2,2,1,1,1,1];this.WebPDecodeRGBA=function(w,k,N,j,Q){var ie=ZS,re=new b_,se=new Fu;re.ba=se,se.S=ie,se.width=[se.width],se.height=[se.height];var ae=se.width,me=se.height,Be=new Tf;if(null==Be||null==w)var ot=2;else i(null!=Be),ot=w_(w,k,N,Be.width,Be.height,Be.Pd,Be.Qd,Be.format,null);if(0!=ot?ae=0:(null!=ae&&(ae[0]=Be.width[0]),null!=me&&(me[0]=Be.height[0]),ae=1),ae){se.width=se.width[0],se.height=se.height[0],null!=j&&(j[0]=se.width),null!=Q&&(Q[0]=se.height);e:{if(j=new p_,(Q=new _b).data=w,Q.w=k,Q.ha=N,Q.kd=1,k=[0],i(null!=Q),(0==(w=w_(Q.data,Q.w,Q.ha,null,null,null,k,null,Q))||7==w)&&k[0]&&(w=4),0==(k=w)){if(i(null!=re),j.data=Q.data,j.w=Q.w+Q.offset,j.ha=Q.ha-Q.offset,j.put=Sd,j.ac=ka,j.bc=Ed,j.ma=re,Q.xa){if(null==(w=qc())){re=1;break e}if(function(st,Xe){var Bt=[0],St=[0],Ve=[0];t:for(;;){if(null==st)return 0;if(null==Xe)return st.a=2,0;if(st.l=Xe,st.a=0,Ue(st.m,Xe.data,Xe.w,Xe.ha),!ti(st.m,Bt,St,Ve)){st.a=3;break t}if(st.xb=aB,Xe.width=Bt[0],Xe.height=St[0],!Id(Bt[0],St[0],1,st,null))break t;return 1}return i(0!=st.a),0}(w,j)){if(j=0==(k=C_(j.width,j.height,re.Oa,re.ba))){t:{j=w;n:for(;;){if(null==j){j=0;break t}if(i(null!=j.s.yc),i(null!=j.s.Ya),i(0<j.s.Wb),i(null!=(N=j.l)),i(null!=(Q=N.ma)),0!=j.xb){if(j.ca=Q.ba,j.tb=Q.tb,i(null!=j.ca),!Cb(Q.Oa,N,e5)){j.a=2;break n}if(!Wm(j,N.width)||N.da)break n;if((N.da||Or(j.ca.S))&&nt(),11>j.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=j.ca.f.kb.F&&nt()),j.Pb&&0<j.s.ua&&null==j.s.vb.X&&!oi(j.s.vb,j.s.Wa.Xa)){j.a=1;break n}j.xb=0}if(!Lu(j,j.V,j.Ba,j.c,j.i,N.o,a_))break n;Q.Dc=j.Ma,j=1;break t}i(0!=j.a),j=0}j=!j}j&&(k=w.a)}else k=w.a}else{if(null==(w=new YM)){re=1;break e}if(w.Fa=Q.na,w.P=Q.P,w.qc=Q.Sa,PS(w,j)){if(0==(k=C_(j.width,j.height,re.Oa,re.ba))){if(w.Aa=0,N=re.Oa,i(null!=(Q=w)),null!=N){if(0<(ae=0>(ae=N.Md)?0:100<ae?255:255*ae/100)){for(me=Be=0;4>me;++me)12>(ot=Q.pb[me]).lc&&(ot.ia=ae*mve[0>ot.lc?0:ot.lc]>>3),Be|=ot.ia;Be&&(alert("todo:VP8InitRandom"),Q.ia=1)}Q.Ga=N.Id,100<Q.Ga?Q.Ga=100:0>Q.Ga&&(Q.Ga=0)}(function XM(w,k){if(null==w)return 0;if(null==k)return gs(w,2,"NULL VP8Io parameter in VP8Decode().");if(!w.cb&&!PS(w,k))return 0;if(i(w.cb),null==k.ac||k.ac(k)){k.ob&&(w.L=0);var N=s5[w.L];if(2==w.L?(w.yb=0,w.zb=0):(w.yb=k.v-N>>4,w.zb=k.j-N>>4,0>w.yb&&(w.yb=0),0>w.zb&&(w.zb=0)),w.Va=k.o+15+N>>4,w.Hb=k.va+15+N>>4,w.Hb>w.za&&(w.Hb=w.za),w.Va>w.Ub&&(w.Va=w.Ub),0<w.L){var j=w.ed;for(N=0;4>N;++N){var Q;if(w.Qa.Cb){var ie=w.Qa.Lb[N];w.Qa.Fb||(ie+=j.Tb)}else ie=j.Tb;for(Q=0;1>=Q;++Q){var re=w.gd[N][Q],se=ie;if(j.Pc&&(se+=j.vd[0],Q&&(se+=j.od[0])),0<(se=0>se?0:63<se?63:se)){var ae=se;0<j.wb&&(ae=4<j.wb?ae>>2:ae>>1)>9-j.wb&&(ae=9-j.wb),1>ae&&(ae=1),re.dd=ae,re.tc=2*se+ae,re.ld=40<=se?2:15<=se?1:0}else re.tc=0;re.La=Q}}}N=0}else gs(w,6,"Frame setup failed"),N=w.a;if(N=0==N){if(N){w.$c=0,0<w.Aa||(w.Ic=1);e:{j=4*(ae=w.za);var me=32*ae,Be=ae+1,ot=0<w.L?ae*(0<w.Aa?2:1):0,st=(2==w.Aa?2:1)*ae;if((re=j+832+(Q=3*(16*(N=w.Ic)+s5[w.L])/2*me)+(ie=null!=w.Fa&&0<w.Fa.length?w.Kc.c*w.Kc.i:0))!=re)N=0;else{if(re>w.Vb){if(w.Vb=0,w.Ec=o(re),w.Fc=0,null==w.Ec){N=gs(w,1,"no memory during frame initialization.");break e}w.Vb=re}se=w.Fc,w.Ac=re=w.Ec,w.Bc=se,se+=j,w.Gd=c(me,MS),w.Hd=0,w.rb=c(Be+1,AS),w.sb=1,w.wa=ot?c(ot,f_):null,w.Y=0,w.D.Nb=0,w.D.wa=w.wa,w.D.Y=w.Y,0<w.Aa&&(w.D.Y+=ae),i(!0),w.oc=re,w.pc=se,se+=832,w.ya=c(st,ab),w.aa=0,w.D.ya=w.ya,w.D.aa=w.aa,2==w.Aa&&(w.D.aa+=ae),w.R=16*ae,w.B=8*ae,ae=(me=s5[w.L])*w.R,me=me/2*w.B,w.sa=re,w.ta=se+ae,w.qa=w.sa,w.ra=w.ta+16*N*w.R+me,w.Ha=w.qa,w.Ia=w.ra+8*N*w.B+me,w.$c=0,se+=Q,w.mb=ie?re:null,w.nb=ie?se:null,i(se+ie<=w.Fc+w.Vb),lb(w),r(w.Ac,w.Bc,0,j),N=1}}if(N){if(k.ka=0,k.y=w.sa,k.O=w.ta,k.f=w.qa,k.N=w.ra,k.ea=w.Ha,k.Vd=w.Ia,k.fa=w.R,k.Rc=w.B,k.F=null,k.J=0,!nB){for(N=-255;255>=N;++N)J9[255+N]=0>N?-N:N;for(N=-1020;1020>=N;++N)Z9[1020+N]=-128>N?-128:127<N?127:N;for(N=-112;112>=N;++N)eB[112+N]=-16>N?-16:15<N?15:N;for(N=-255;510>=N;++N)tB[255+N]=0>N?0:255<N?255:N;nB=1}Hu=ZM,D_=QM,rh=LS,zu=JM,Af=RS,Db=NS,Xm=hb,I_=Km,Qm=fF,oh=mb,Ib=dF,Kc=y_,Mf=gb,go=qS,_o=WS,_s=kf,Gs=Zp,Ff=uF,$u[0]=Ad,$u[1]=eF,$u[2]=rF,$u[3]=oF,$u[4]=VS,$u[5]=__,$u[6]=US,$u[7]=db,$u[8]=aF,$u[9]=sF,ah[0]=BS,ah[1]=nF,ah[2]=Ef,ah[3]=m_,ah[4]=Wa,ah[5]=iF,ah[6]=jS,Pf[0]=Jp,Pf[1]=tF,Pf[2]=lF,Pf[3]=fb,Pf[4]=Gm,Pf[5]=cF,Pf[6]=pb,N=1}else N=0}N&&(N=function(Xe,Bt){for(Xe.M=0;Xe.M<Xe.Va;++Xe.M){var St,Ve=Xe.Jc[Xe.M&Xe.Xb],$e=Xe.m,Ot=Xe;for(St=0;St<Ot.za;++St){var Ht=$e,Lt=Ot,Cn=Lt.Ac,un=Lt.Bc+4*St,Yn=Lt.zc,pn=Lt.ya[Lt.aa+St];if(pn.$b=Lt.Qa.Bb?pt(Ht,Lt.Pa.jb[0])?2+pt(Ht,Lt.Pa.jb[2]):pt(Ht,Lt.Pa.jb[1]):0,Lt.kc&&(pn.Ad=pt(Ht,Lt.Bd)),pn.Za=!pt(Ht,145)+0,pn.Za){var Ar=pn.Ob,Wr=0;for(Lt=0;4>Lt;++Lt){var yr,rr=Yn[0+Lt];for(yr=0;4>yr;++yr){for(var ao=sB[pt(Ht,(rr=tve[Cn[un+yr]][rr])[0])];0<ao;)ao=sB[2*ao+pt(Ht,rr[ao])];Cn[un+yr]=rr=-ao}n(Ar,Wr,Cn,un,4),Wr+=4,Yn[0+Lt]=rr}}else rr=pt(Ht,156)?pt(Ht,128)?1:3:pt(Ht,163)?2:0,pn.Ob[0]=rr,r(Cn,un,rr,4),r(Yn,0,rr,4);pn.Dd=pt(Ht,142)?pt(Ht,114)?pt(Ht,183)?1:3:2:0}if(Ot.m.Ka)return gs(Xe,7,"Premature end-of-partition0 encountered.");for(;Xe.ja<Xe.za;++Xe.ja){if(Ot=Ve,Ht=($e=Xe).rb[$e.sb-1],Cn=$e.rb[$e.sb+$e.ja],St=$e.ya[$e.aa+$e.ja],un=$e.kc?St.Ad:0)Ht.la=Cn.la=0,St.Za||(Ht.Na=Cn.Na=0),St.Hc=0,St.Gc=0,St.ia=0;else{var eo,Fi;if(Ht=Cn,Cn=Ot,un=$e.Pa.Xc,pn=$e.pb[(Yn=$e.ya[$e.aa+$e.ja]).$b],Wr=$e.rb[$e.sb-1],rr=yr=0,r(Lt=Yn.ad,Ar=0,0,384),Yn.Za)var Fs=0,jl=un[3];else{ao=o(16);var Ps=Ht.Na+Wr.Na;if(Ps=Ab(Cn,un[1],Ps,pn.Eb,0,ao,0),Ht.Na=Wr.Na=(0<Ps)+0,1<Ps)Hu(ao,0,Lt,Ar);else{var Vl=ao[0]+3>>3;for(ao=0;256>ao;ao+=16)Lt[Ar+ao]=Vl}Fs=1,jl=un[0]}var qr=15&Ht.la,fc=15&Wr.la;for(ao=0;4>ao;++ao){var pc=1&fc;for(Vl=Fi=0;4>Vl;++Vl)qr=qr>>1|(pc=(Ps=Ab(Cn,jl,Ps=pc+(1&qr),pn.Sc,Fs,Lt,Ar))>Fs)<<7,Fi=Fi<<2|(3<Ps?3:1<Ps?2:0!=Lt[Ar+0]),Ar+=16;qr>>=4,fc=fc>>1|pc<<7,yr=(yr<<8|Fi)>>>0}for(jl=qr,Fs=fc>>4,eo=0;4>eo;eo+=2){for(Fi=0,qr=Ht.la>>4+eo,fc=Wr.la>>4+eo,ao=0;2>ao;++ao){for(pc=1&fc,Vl=0;2>Vl;++Vl)qr=qr>>1|(pc=0<(Ps=Ab(Cn,un[2],Ps=pc+(1&qr),pn.Qc,0,Lt,Ar)))<<3,Fi=Fi<<2|(3<Ps?3:1<Ps?2:0!=Lt[Ar+0]),Ar+=16;qr>>=2,fc=fc>>1|pc<<5}rr|=Fi<<4*eo,jl|=qr<<4<<eo,Fs|=(240&fc)<<eo}Ht.la=jl,Wr.la=Fs,Yn.Hc=yr,Yn.Gc=rr,Yn.ia=43690&rr?0:pn.ia,un=!(yr|rr)}if(0<$e.L&&($e.wa[$e.Y+$e.ja]=$e.gd[St.$b][St.Za],$e.wa[$e.Y+$e.ja].La|=!un),Ot.Ka)return gs(Xe,7,"Premature end-of-file encountered.")}if(lb(Xe),$e=Bt,Ot=1,St=(Ve=Xe).D,Ht=0<Ve.L&&Ve.M>=Ve.zb&&Ve.M<=Ve.Va,0==Ve.Aa)e:{if(St.M=Ve.M,St.uc=Ht,wb(Ve,St),Ot=1,St=(Fi=Ve.D).Nb,Ht=(rr=s5[Ve.L])*Ve.R,un=Ve.sa,Yn=Ve.ta-Ht+(ao=16*St*Ve.R),pn=Ve.qa,Lt=Ve.ra-(Cn=rr/2*Ve.B)+(Vl=8*St*Ve.B),Ar=Ve.Ha,Wr=Ve.Ia-Cn+Vl,fc=0==(qr=Fi.M),yr=qr>=Ve.Va-1,2==Ve.Aa&&wb(Ve,Fi),Fi.uc)for(pc=(Ps=Ve).D.M,i(Ps.D.uc),Fi=Ps.yb;Fi<Ps.Hb;++Fi){jl=pc;var ua=(Da=(Jo=Ps).D).Nb,Da=Da.wa[Da.Y+(Fs=Fi)],fl=Jo.sa,Qc=Jo.ta+16*ua*(eo=Jo.R)+16*Fs,Fd=Da.dd,da=Da.tc;if(0!=da)if(i(3<=da),1==Jo.L)0<Fs&&_s(fl,Qc,eo,da+4),Da.La&&Ff(fl,Qc,eo,da),0<jl&&_o(fl,Qc,eo,da+4),Da.La&&Gs(fl,Qc,eo,da);else{var Of=Jo.B,Jm=Jo.qa,M_=Jo.ra+8*ua*Of+8*Fs,ch=Jo.Ha,Jo=Jo.Ia+8*ua*Of+8*Fs;ua=Da.ld,0<Fs&&(I_(fl,Qc,eo,da+4,Fd,ua),oh(Jm,M_,ch,Jo,Of,da+4,Fd,ua)),Da.La&&(Kc(fl,Qc,eo,da,Fd,ua),go(Jm,M_,ch,Jo,Of,da,Fd,ua)),0<jl&&(Xm(fl,Qc,eo,da+4,Fd,ua),Qm(Jm,M_,ch,Jo,Of,da+4,Fd,ua)),Da.La&&(Ib(fl,Qc,eo,da,Fd,ua),Mf(Jm,M_,ch,Jo,Of,da,Fd,ua))}}if(Ve.ia&&alert("todo:DitherRow"),null!=$e.put){if(Fi=16*qr,qr=16*(qr+1),fc?($e.y=Ve.sa,$e.O=Ve.ta+ao,$e.f=Ve.qa,$e.N=Ve.ra+Vl,$e.ea=Ve.Ha,$e.W=Ve.Ia+Vl):(Fi-=rr,$e.y=un,$e.O=Yn,$e.f=pn,$e.N=Lt,$e.ea=Ar,$e.W=Wr),yr||(qr-=rr),qr>$e.o&&(qr=$e.o),$e.F=null,$e.J=null,null!=Ve.Fa&&0<Ve.Fa.length&&Fi<qr&&($e.J=bb(Ve,$e,Fi,qr-Fi),$e.F=Ve.mb,null==$e.F&&0==$e.F.length)){Ot=gs(Ve,3,"Could not decode alpha data.");break e}Fi<$e.j&&(rr=$e.j-Fi,Fi=$e.j,i(!(1&rr)),$e.O+=Ve.R*rr,$e.N+=Ve.B*(rr>>1),$e.W+=Ve.B*(rr>>1),null!=$e.F&&($e.J+=$e.width*rr)),Fi<qr&&($e.O+=$e.v,$e.N+=$e.v>>1,$e.W+=$e.v>>1,null!=$e.F&&($e.J+=$e.v),$e.ka=Fi-$e.j,$e.U=$e.va-$e.v,$e.T=qr-Fi,Ot=$e.put($e))}St+1!=Ve.Ic||yr||(n(Ve.sa,Ve.ta-Ht,un,Yn+16*Ve.R,Ht),n(Ve.qa,Ve.ra-Cn,pn,Lt+8*Ve.B,Cn),n(Ve.Ha,Ve.Ia-Cn,Ar,Wr+8*Ve.B,Cn))}if(!Ot)return gs(Xe,6,"Output aborted.")}return 1}(w,k)),null!=k.bc&&k.bc(k),N&=1}return N?(w.cb=0,N):0})(w,j)||(k=w.a)}}else k=w.a}0==k&&null!=re.Oa&&re.Oa.fd&&(k=Tb(re.ba))}re=k}ie=0!=re?null:11>ie?se.f.RGBA.eb:se.f.kb.y}else ie=null;return ie};var mB=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function g(Te,mt){for(var vt="",fe=0;fe<4;fe++)vt+=String.fromCharCode(Te[mt++]);return vt}function x(Te,mt){return(Te[mt+0]<<0|Te[mt+1]<<8|Te[mt+2]<<16)>>>0}function S(Te,mt){return(Te[mt+0]<<0|Te[mt+1]<<8|Te[mt+2]<<16|Te[mt+3]<<24)>>>0}new m;var M=[0],E=[0],R=[],B=new m,K=t,q=function(Te,mt){var vt={},fe=0,de=!1,Oe=0,Ae=0;if(vt.frames=[],!function(ve,we,je,Ze){for(var it=0;it<4;it++)if(ve[we+it]!="RIFF".charCodeAt(it))return!0;return!1}(Te,mt)){var Ct,Re;for(S(Te,mt+=4),mt+=8;mt<Te.length;){var Je=g(Te,mt),Ue=S(Te,mt+=4);mt+=4;var lt=Ue+(1&Ue);switch(Je){case"VP8 ":case"VP8L":void 0===vt.frames[fe]&&(vt.frames[fe]={}),(ne=vt.frames[fe]).src_off=de?Ae:mt-8,ne.src_size=Oe+Ue+8,fe++,de&&(de=!1,Oe=0,Ae=0);break;case"VP8X":(ne=vt.header={}).feature_flags=Te[mt];var _t=mt+4;ne.canvas_width=1+x(Te,_t),ne.canvas_height=1+x(Te,_t+=3),_t+=3;break;case"ALPH":de=!0,Oe=lt+8,Ae=mt-8;break;case"ANIM":(ne=vt.header).bgcolor=S(Te,mt),ne.loop_count=(Ct=Te)[(Re=_t=mt+4)+0]<<0|Ct[Re+1]<<8,_t+=2;break;case"ANMF":var on,ne;(ne=vt.frames[fe]={}).offset_x=2*x(Te,mt),ne.offset_y=2*x(Te,mt+=3),ne.width=1+x(Te,mt+=3),ne.height=1+x(Te,mt+=3),ne.duration=x(Te,mt+=3),mt+=3,on=Te[mt++],ne.dispose=1&on,ne.blend=on>>1&1}"ANMF"!=Je&&(mt+=lt)}return vt}}(K,0);q.response=K,q.rgbaoutput=!0,q.dataurl=!1;var Y=q.header?q.header:null,ce=q.frames?q.frames:null;if(Y){Y.loop_counter=Y.loop_count,M=[Y.canvas_height],E=[Y.canvas_width];for(var De=0;De<ce.length&&0!=ce[De].blend;De++);}var Ye=ce[0],yt=B.WebPDecodeRGBA(K,Ye.src_off,Ye.src_size,E,M);Ye.rgba=yt,Ye.imgwidth=E[0],Ye.imgheight=M[0];for(var Ge=0;Ge<E[0]*M[0]*4;Ge++)R[Ge]=yt[Ge];return this.width=E,this.height=M,this.data=R,this}(function(t){var e=function(M,E,R,B){var K=4,q=c;switch(B){case t.image_compression.FAST:K=1,q=o;break;case t.image_compression.MEDIUM:K=6,q=u;break;case t.image_compression.SLOW:K=9,q=m}var Y=Jy(M=n(M,E,R,q),{level:K});return t.__addimage__.arrayBufferToBinaryString(Y)},n=function(M,E,R,B){for(var K,q,Y,ce=M.length/E,De=new Uint8Array(M.length+ce),Ye=x(),yt=0;yt<ce;yt+=1){if(K=M.subarray(Y=yt*E,Y+E),B)De.set(B(K,R,q),Y+yt);else{for(var Ge,Te=Ye.length,mt=[];Ge<Te;Ge+=1)mt[Ge]=Ye[Ge](K,R,q);var vt=S(mt.concat());De.set(mt[vt],Y+yt)}q=K}return De},r=function(M){var E=Array.apply([],M);return E.unshift(0),E},o=function(M,E){var B=[],K=M.length;B[0]=1;for(var q=0;q<K;q+=1)B[q+1]=M[q]-(M[q-E]||0)+256&255;return B},c=function(M,E,R){var K=[],q=M.length;K[0]=2;for(var Y=0;Y<q;Y+=1)K[Y+1]=M[Y]-(R&&R[Y]||0)+256&255;return K},u=function(M,E,R){var q=[],Y=M.length;q[0]=3;for(var ce=0;ce<Y;ce+=1)q[ce+1]=M[ce]+256-((M[ce-E]||0)+(R&&R[ce]||0)>>>1)&255;return q},m=function(M,E,R){var Y,ce=[],De=M.length;ce[0]=4;for(var Ye=0;Ye<De;Ye+=1)Y=g(M[Ye-E]||0,R&&R[Ye]||0,R&&R[Ye-E]||0),ce[Ye+1]=M[Ye]-Y+256&255;return ce},g=function(M,E,R){if(M===E&&E===R)return M;var B=Math.abs(E-R),K=Math.abs(M-R),q=Math.abs(M+E-R-R);return B<=K&&B<=q?M:K<=q?E:R},x=function(){return[r,o,c,u,m]},S=function(M){var E=M.map(function(R){return R.reduce(function(B,K){return B+Math.abs(K)},0)});return E.indexOf(Math.min.apply(null,E))};t.processPNG=function(M,E,R,B){var K,q,Y,ce,De,Ye,yt,Ge,Te,mt,vt,fe,de,Oe,Ae,Ct=this.decode.FLATE_DECODE,Re="";if(this.__addimage__.isArrayBuffer(M)&&(M=new Uint8Array(M)),this.__addimage__.isArrayBufferView(M)){if(M=(Y=new TJ(M)).imgData,q=Y.bits,K=Y.colorSpace,De=Y.colors,-1!==[4,6].indexOf(Y.colorType)){if(8===Y.bits){Te=(Ge=32==Y.pixelBitlength?new Uint32Array(Y.decodePixels().buffer):16==Y.pixelBitlength?new Uint16Array(Y.decodePixels().buffer):new Uint8Array(Y.decodePixels().buffer)).length,vt=new Uint8Array(Te*Y.colors),mt=new Uint8Array(Te);var Je,Ue=Y.pixelBitlength-Y.bits;for(Oe=0,Ae=0;Oe<Te;Oe++){for(de=Ge[Oe],Je=0;Je<Ue;)vt[Ae++]=de>>>Je&255,Je+=Y.bits;mt[Oe]=de>>>Je&255}}if(16===Y.bits){Te=(Ge=new Uint32Array(Y.decodePixels().buffer)).length,vt=new Uint8Array(Te*(32/Y.pixelBitlength)*Y.colors),mt=new Uint8Array(Te*(32/Y.pixelBitlength)),fe=Y.colors>1,Oe=0,Ae=0;for(var lt=0;Oe<Te;)de=Ge[Oe++],vt[Ae++]=de>>>0&255,fe&&(vt[Ae++]=de>>>16&255,de=Ge[Oe++],vt[Ae++]=de>>>0&255),mt[lt++]=de>>>16&255;q=8}B!==t.image_compression.NONE?(M=e(vt,Y.width*Y.colors,Y.colors,B),yt=e(mt,Y.width,1,B)):(M=vt,yt=mt,Ct=void 0)}if(3===Y.colorType&&(K=this.color_spaces.INDEXED,Ye=Y.palette,Y.transparency.indexed)){var _t=Y.transparency.indexed,on=0;for(Oe=0,Te=_t.length;Oe<Te;++Oe)on+=_t[Oe];if((on/=255)==Te-1&&-1!==_t.indexOf(0))ce=[_t.indexOf(0)];else if(on!==Te){for(Ge=Y.decodePixels(),mt=new Uint8Array(Ge.length),Oe=0,Te=Ge.length;Oe<Te;Oe++)mt[Oe]=_t[Ge[Oe]];yt=e(mt,Y.width,1)}}var ne=function(ve){var we;switch(ve){case t.image_compression.FAST:we=11;break;case t.image_compression.MEDIUM:we=13;break;case t.image_compression.SLOW:we=14;break;default:we=12}return we}(B);return Ct===this.decode.FLATE_DECODE&&(Re="/Predictor "+ne+" "),Re+="/Colors "+De+" /BitsPerComponent "+q+" /Columns "+Y.width,(this.__addimage__.isArrayBuffer(M)||this.__addimage__.isArrayBufferView(M))&&(M=this.__addimage__.arrayBufferToBinaryString(M)),(yt&&this.__addimage__.isArrayBuffer(yt)||this.__addimage__.isArrayBufferView(yt))&&(yt=this.__addimage__.arrayBufferToBinaryString(yt)),{alias:R,data:M,index:E,filter:Ct,decodeParameters:Re,transparency:ce,palette:Ye,sMask:yt,predictor:ne,width:Y.width,height:Y.height,bitsPerComponent:q,colorSpace:K}}}})(ei.API),function(t){t.processGIF89A=function(i,e,n,r){var o=new SJ(i),c=o.width,u=o.height,m=[];o.decodeAndBlitFrameRGBA(0,m);var g={data:m,width:c,height:u},x=new QA(100).encode(g,100);return t.processJPEG.call(this,x,e,n,r)},t.processGIF87A=t.processGIF89A}(ei.API),Du.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var i=0;i<t;i++){var e=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[i]={red:r,green:n,blue:e,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Du.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP;this.data=new Uint8Array(this.width*this.height*4),this[t]()}catch(e){ro.log("bit decode error:"+e)}},Du.prototype.bit1=function(){var t,i=Math.ceil(this.width/8),e=i%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<i;r++)for(var o=this.datav.getUint8(this.pos++,!0),c=n*this.width*4+8*r*4,u=0;u<8&&8*r+u<this.width;u++){var m=this.palette[o>>7-u&1];this.data[c+4*u]=m.blue,this.data[c+4*u+1]=m.green,this.data[c+4*u+2]=m.red,this.data[c+4*u+3]=255}0!==e&&(this.pos+=4-e)}},Du.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),i=t%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<t;r++){var o=this.datav.getUint8(this.pos++,!0),c=n*this.width*4+2*r*4,m=15&o,g=this.palette[o>>4];if(this.data[c]=g.blue,this.data[c+1]=g.green,this.data[c+2]=g.red,this.data[c+3]=255,2*r+1>=this.width)break;this.data[c+4]=(g=this.palette[m]).blue,this.data[c+4+1]=g.green,this.data[c+4+2]=g.red,this.data[c+4+3]=255}0!==i&&(this.pos+=4-i)}},Du.prototype.bit8=function(){for(var t=this.width%4,i=this.height-1;i>=0;i--){for(var e=this.bottom_up?i:this.height-1-i,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;if(r<this.palette.length){var c=this.palette[r];this.data[o]=c.red,this.data[o+1]=c.green,this.data[o+2]=c.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}0!==t&&(this.pos+=4-t)}},Du.prototype.bit15=function(){for(var t=this.width%3,i=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(o&i)/i*255|0,u=(o>>5&i)/i*255|0,g=o>>15?255:0,x=n*this.width*4+4*r;this.data[x]=(o>>10&i)/i*255|0,this.data[x+1]=u,this.data[x+2]=c,this.data[x+3]=g}this.pos+=t}},Du.prototype.bit16=function(){for(var t=this.width%3,i=parseInt("11111",2),e=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var c=this.datav.getUint16(this.pos,!0);this.pos+=2;var u=(c&i)/i*255|0,m=(c>>5&e)/e*255|0,x=r*this.width*4+4*o;this.data[x]=(c>>11)/i*255|0,this.data[x+1]=m,this.data[x+2]=u,this.data[x+3]=255}this.pos+=t}},Du.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),c=i*this.width*4+4*e;this.data[c]=o,this.data[c+1]=r,this.data[c+2]=n,this.data[c+3]=255}this.pos+=this.width%4}},Du.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var i=this.bottom_up?t:this.height-1-t,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),u=i*this.width*4+4*e;this.data[u]=o,this.data[u+1]=r,this.data[u+2]=n,this.data[u+3]=c}},Du.prototype.getData=function(){return this.data},function(t){t.processBMP=function(i,e,n,r){var o=new Du(i,!1),c=o.width,u=o.height,m={data:o.getData(),width:c,height:u},g=new QA(100).encode(m,100);return t.processJPEG.call(this,g,e,n,r)}}(ei.API),l7.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(i,e,n,r){var o=new l7(i,!1),c=o.width,u=o.height,m={data:o.getData(),width:c,height:u},g=new QA(100).encode(m,100);return t.processJPEG.call(this,g,e,n,r)}}(ei.API),ei.API.processRGBA=function(t,i,e){for(var n=t.data,r=n.length,o=new Uint8Array(r/4*3),c=new Uint8Array(r/4),u=0,m=0,g=0;g<r;g+=4){var S=n[g+1],M=n[g+2],E=n[g+3];o[u++]=n[g],o[u++]=S,o[u++]=M,c[m++]=E}var R=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(c),data:R,index:i,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},ei.API.setLanguage=function(t){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]&&(this.internal.languageSettings.languageCode=t,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},YT=(e_=ei.API).getCharWidthsArray=function(t,i){var e,n,r=(i=i||{}).font||this.internal.getFont(),o=i.fontSize||this.internal.getFontSize(),c=i.charSpace||this.internal.getCharSpace(),u=i.widths?i.widths:r.metadata.Unicode.widths,m=u.fof?u.fof:1,g=i.kerning?i.kerning:r.metadata.Unicode.kerning,x=g.fof?g.fof:1,S=!1!==i.doKerning,M=0,E=t.length,R=0,B=u[0]||m,K=[];for(e=0;e<E;e++)n=t.charCodeAt(e),"function"==typeof r.metadata.widthOfString?K.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(n))+c*(1e3/o)||0)/1e3):(M=S&&"object"===$r(g[n])&&!isNaN(parseInt(g[n][R],10))?g[n][R]/x:0,K.push((u[n]||B)/m+M)),R=n;return K},r7=e_.getStringUnitWidth=function(t,i){var e=(i=i||{}).fontSize||this.internal.getFontSize(),n=i.font||this.internal.getFont(),r=i.charSpace||this.internal.getCharSpace();return e_.processArabic&&(t=e_.processArabic(t)),"function"==typeof n.metadata.widthOfString?n.metadata.widthOfString(t,e,r)/e:YT.apply(this,arguments).reduce(function(o,c){return o+c},0)},o7=function(t,i,e,n){for(var r=[],o=0,c=t.length,u=0;o!==c&&u+i[o]<e;)u+=i[o],o++;r.push(t.slice(0,o));var m=o;for(u=0;o!==c;)u+i[o]>n&&(r.push(t.slice(m,o)),u=0,m=o),u+=i[o],o++;return m!==o&&r.push(t.slice(m,o)),r},s7=function(t,i,e){e||(e={});var n,r,o,c,u,m,x=[],S=[x],M=e.textIndent||0,E=0,R=0,B=t.split(" "),K=YT.apply(this,[" ",e])[0];if(m=-1===e.lineIndent?B[0].length+2:e.lineIndent||0){var q=Array(m).join(" "),Y=[];B.map(function(De){(De=De.split(/\s*\n/)).length>1?Y=Y.concat(De.map(function(Ye,yt){return(yt&&Ye.length?"\n":"")+Ye})):Y.push(De[0])}),B=Y,m=r7.apply(this,[q,e])}for(o=0,c=B.length;o<c;o++){var ce=0;if(n=B[o],m&&"\n"==n[0]&&(n=n.substr(1),ce=1),M+E+(R=(r=YT.apply(this,[n,e])).reduce(function(De,Ye){return De+Ye},0))>i||ce){if(R>i){for(u=o7.apply(this,[n,r,i-(M+E),i]),x.push(u.shift()),x=[u.pop()];u.length;)S.push([u.shift()]);R=r.slice(n.length-(x[0]?x[0].length:0)).reduce(function(De,Ye){return De+Ye},0)}else x=[n];S.push(x),M=R+m,E=K}else x.push(n),M+=E+R,E=K}return S.map(m?function(De,Ye){return(Ye?q:"")+De.join(" ")}:function(De){return De.join(" ")})},e_.splitTextToSize=function(t,i,e){var n,r=(e=e||{}).fontSize||this.internal.getFontSize(),o=function(x){if(x.widths&&x.kerning)return{widths:x.widths,kerning:x.kerning};var S=this.internal.getFont(x.fontName,x.fontStyle);return S.metadata.Unicode?{widths:S.metadata.Unicode.widths||{0:1},kerning:S.metadata.Unicode.kerning||{}}:{font:S.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,e);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var c=1*this.internal.scaleFactor*i/r;o.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/r:0,o.lineIndent=e.lineIndent;var u,m,g=[];for(u=0,m=n.length;u<m;u++)g=g.concat(s7.apply(this,[n[u],c,o]));return g},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var i="klmnopqrstuvwxyz",e={},n={},r=0;r<i.length;r++)e[i[r]]="0123456789abcdef"[r],n["0123456789abcdef"[r]]=i[r];var o=function(S){return"0x"+parseInt(S,10).toString(16)},c=t.__fontmetrics__.compress=function(S){var M,E,R,B,K=["{"];for(var q in S){if(M=S[q],isNaN(parseInt(q,10))?E="'"+q+"'":(q=parseInt(q,10),E=(E=o(q).slice(2)).slice(0,-1)+n[E.slice(-1)]),"number"==typeof M)M<0?(R=o(M).slice(3),B="-"):(R=o(M).slice(2),B=""),R=B+R.slice(0,-1)+n[R.slice(-1)];else{if("object"!==$r(M))throw new Error("Don't know what to do with value type "+$r(M)+".");R=c(M)}K.push(E+R)}return K.push("}"),K.join("")},u=t.__fontmetrics__.uncompress=function(S){if("string"!=typeof S)throw new Error("Invalid argument passed to uncompress.");for(var M,E,R,B,K={},q=1,Y=K,ce=[],De="",Ye="",yt=S.length-1,Ge=1;Ge<yt;Ge+=1)"'"==(B=S[Ge])?M?(R=M.join(""),M=void 0):M=[]:M?M.push(B):"{"==B?(ce.push([Y,R]),Y={},R=void 0):"}"==B?((E=ce.pop())[0][E[1]]=Y,R=void 0,Y=E[0]):"-"==B?q=-1:void 0===R?e.hasOwnProperty(B)?(De+=e[B],R=parseInt(De,16)*q,q=1,De=""):De+=B:e.hasOwnProperty(B)?(Ye+=e[B],Y[R]=parseInt(Ye,16)*q,q=1,R=void 0,Ye=""):Ye+=B;return K},m={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},g={Unicode:{Courier:m,"Courier-Bold":m,"Courier-BoldOblique":m,"Courier-Oblique":m,Helvetica:m,"Helvetica-Bold":m,"Helvetica-BoldOblique":m,"Helvetica-Oblique":m,"Times-Roman":m,"Times-Bold":m,"Times-BoldItalic":m,"Times-Italic":m}},x={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(S){var M=S.font,E=x.Unicode[M.postScriptName];E&&(M.metadata.Unicode={},M.metadata.Unicode.widths=E.widths,M.metadata.Unicode.kerning=E.kerning);var R=g.Unicode[M.postScriptName];R&&(M.metadata.Unicode.encoding=R,M.encoding=R.codePages[0])}])}(ei.API),function(t){var i=function(e){for(var n=e.length,r=new Uint8Array(n),o=0;o<n;o++)r[o]=e.charCodeAt(o);return r};t.API.events.push(["addFont",function(e){var c,u,n=void 0,r=e.font,o=e.instance;if(!r.isStandardFont){if(void 0===o)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if("string"!=typeof(n=!1===o.existsFileInVFS(r.postScriptName)?o.loadFile(r.postScriptName):o.getFileFromVFS(r.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");c=r,u=/^\x00\x01\x00\x00/.test(u=n)?i(u):i(Zy(u)),c.metadata=t.API.TTFFont.open(u),c.metadata.Unicode=c.metadata.Unicode||{encoding:{},kerning:{},widths:[]},c.metadata.glyIdsUsed=[0]}}])}(ei),function(t){function i(){return(ri.canvg?Promise.resolve(ri.canvg):vo.e(489).then(vo.bind(vo,6489))).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e})}ei.API.addSvgAsImage=function(e,n,r,o,c,u,m,g){if(isNaN(n)||isNaN(r))throw ro.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(c))throw ro.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var x=document.createElement("canvas");x.width=o,x.height=c;var S=x.getContext("2d");S.fillStyle="#fff",S.fillRect(0,0,x.width,x.height);var M={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},E=this;return i().then(function(R){return R.fromString(S,e,M)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(R){return R.render(M)}).then(function(){E.addImage(x.toDataURL("image/jpeg",1),n,r,o,c,m,g)})}}(),ei.API.putTotalPages=function(t){var i,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(i=new RegExp(t,"g"),e=this.internal.getNumberOfPages()):(i=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var r=0;r<this.internal.pages[n].length;r++)this.internal.pages[n][r]=this.internal.pages[n][r].replace(i,e);return this},ei.API.viewerPreferences=function(t,i){var e;t=t||{},i=i||!1;var n,r,o,c={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},u=Object.keys(c),m=[],g=0,x=0,S=0;function M(R,B){var K,q=!1;for(K=0;K<R.length;K+=1)R[K]===B&&(q=!0);return q}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(c)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,"reset"===t||!0===i){var E=u.length;for(S=0;S<E;S+=1)e[u[S]].value=e[u[S]].defaultValue,e[u[S]].explicitSet=!1}if("object"===$r(t))for(r in t)if(o=t[r],M(u,r)&&void 0!==o){if("boolean"===e[r].type&&"boolean"==typeof o)e[r].value=o;else if("name"===e[r].type&&M(e[r].valueSet,o))e[r].value=o;else if("integer"===e[r].type&&Number.isInteger(o))e[r].value=o;else if("array"===e[r].type){for(g=0;g<o.length;g+=1)if(n=!0,1===o[g].length&&"number"==typeof o[g][0])m.push(String(o[g]-1));else if(o[g].length>1){for(x=0;x<o[g].length;x+=1)"number"!=typeof o[g][x]&&(n=!1);!0===n&&m.push([o[g][0]-1,o[g][1]-1].join(" "))}e[r].value="["+m.join(" ")+"]"}else e[r].value=e[r].defaultValue;e[r].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var R,B=[];for(R in e)!0===e[R].explicitSet&&B.push("name"===e[R].type?"/"+R+" /"+e[R].value:"/"+R+" "+e[R].value);0!==B.length&&this.internal.write("/ViewerPreferences\n<<\n"+B.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},function(t){var i=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),c=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),u=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),m=unescape(encodeURIComponent("</x:xmpmeta>")),g=o.length+c.length+u.length+r.length+m.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+g+" >>"),this.internal.write("stream"),this.internal.write(r+o+c+u+m),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,r){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:n,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",i)),this}}(ei.API),function(t){var i=t.API,e=i.pdfEscape16=function(o,c){for(var u,m=c.metadata.Unicode.widths,g=["","0","00","000","0000"],x=[""],S=0,M=o.length;S<M;++S){if(u=c.metadata.characterToGlyph(o.charCodeAt(S)),c.metadata.glyIdsUsed.push(u),c.metadata.toUnicode[u]=o.charCodeAt(S),-1==m.indexOf(u)&&(m.push(u),m.push([parseInt(c.metadata.widthOfGlyph(u),10)])),"0"==u)return x.join("");u=u.toString(16),x.push(g[4-u.length],u)}return x.join("")},n=function(o){var c,u,m,g,x,S,M;for(x="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",m=[],S=0,M=(u=Object.keys(o).sort(function(E,R){return E-R})).length;S<M;S++)c=u[S],m.length>=100&&(x+="\n"+m.length+" beginbfchar\n"+m.join("\n")+"\nendbfchar",m=[]),null!=o[c]&&"function"==typeof o[c].toString&&(g=("0000"+o[c].toString(16)).slice(-4),c=("0000"+(+c).toString(16)).slice(-4),m.push("<"+c+"><"+g+">"));return m.length&&(x+="\n"+m.length+" beginbfchar\n"+m.join("\n")+"\nendbfchar\n"),x+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};i.events.push(["putFont",function(o){!function(c){var u=c.font,m=c.out,g=c.newObject,x=c.putStream;if(u.metadata instanceof t.API.TTFFont&&"Identity-H"===u.encoding){for(var S=u.metadata.Unicode.widths,M=u.metadata.subset.encode(u.metadata.glyIdsUsed,1),E="",R=0;R<M.length;R++)E+=String.fromCharCode(M[R]);var B=g();x({data:E,addLength1:!0,objectId:B}),m("endobj");var K=g();x({data:n(u.metadata.toUnicode),addLength1:!0,objectId:K}),m("endobj");var q=g();m("<<"),m("/Type /FontDescriptor"),m("/FontName /"+G0(u.fontName)),m("/FontFile2 "+B+" 0 R"),m("/FontBBox "+t.API.PDFObject.convert(u.metadata.bbox)),m("/Flags "+u.metadata.flags),m("/StemV "+u.metadata.stemV),m("/ItalicAngle "+u.metadata.italicAngle),m("/Ascent "+u.metadata.ascender),m("/Descent "+u.metadata.decender),m("/CapHeight "+u.metadata.capHeight),m(">>"),m("endobj");var Y=g();m("<<"),m("/Type /Font"),m("/BaseFont /"+G0(u.fontName)),m("/FontDescriptor "+q+" 0 R"),m("/W "+t.API.PDFObject.convert(S)),m("/CIDToGIDMap /Identity"),m("/DW 1000"),m("/Subtype /CIDFontType2"),m("/CIDSystemInfo"),m("<<"),m("/Supplement 0"),m("/Registry (Adobe)"),m("/Ordering ("+u.encoding+")"),m(">>"),m(">>"),m("endobj"),u.objectNumber=g(),m("<<"),m("/Type /Font"),m("/Subtype /Type0"),m("/ToUnicode "+K+" 0 R"),m("/BaseFont /"+G0(u.fontName)),m("/Encoding /"+u.encoding),m("/DescendantFonts ["+Y+" 0 R]"),m(">>"),m("endobj"),u.isAlreadyPutted=!0}}(o)}]),i.events.push(["putFont",function(o){!function(c){var u=c.font,m=c.out,g=c.newObject,x=c.putStream;if(u.metadata instanceof t.API.TTFFont&&"WinAnsiEncoding"===u.encoding){for(var S=u.metadata.rawData,M="",E=0;E<S.length;E++)M+=String.fromCharCode(S[E]);var R=g();x({data:M,addLength1:!0,objectId:R}),m("endobj");var B=g();x({data:n(u.metadata.toUnicode),addLength1:!0,objectId:B}),m("endobj");var K=g();m("<<"),m("/Descent "+u.metadata.decender),m("/CapHeight "+u.metadata.capHeight),m("/StemV "+u.metadata.stemV),m("/Type /FontDescriptor"),m("/FontFile2 "+R+" 0 R"),m("/Flags 96"),m("/FontBBox "+t.API.PDFObject.convert(u.metadata.bbox)),m("/FontName /"+G0(u.fontName)),m("/ItalicAngle "+u.metadata.italicAngle),m("/Ascent "+u.metadata.ascender),m(">>"),m("endobj"),u.objectNumber=g();for(var q=0;q<u.metadata.hmtx.widths.length;q++)u.metadata.hmtx.widths[q]=parseInt(u.metadata.hmtx.widths[q]*(1e3/u.metadata.head.unitsPerEm));m("<</Subtype/TrueType/Type/Font/ToUnicode "+B+" 0 R/BaseFont/"+G0(u.fontName)+"/FontDescriptor "+K+" 0 R/Encoding/"+u.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(u.metadata.hmtx.widths)+">>"),m("endobj"),u.isAlreadyPutted=!0}}(o)}]);var r=function(o){var c,u=o.text||"",m=o.x,g=o.y,x=o.options||{},S=o.mutex||{},M=S.pdfEscape,E=S.activeFontKey,R=S.fonts,B=E,K="",q=0,Y="",ce=R[B].encoding;if("Identity-H"!==R[B].encoding)return{text:u,x:m,y:g,options:x,mutex:S};for(Y=u,B=E,Array.isArray(u)&&(Y=u[0]),q=0;q<Y.length;q+=1)R[B].metadata.hasOwnProperty("cmap")&&(c=R[B].metadata.cmap.unicode.codeMap[Y[q].charCodeAt(0)]),c||Y[q].charCodeAt(0)<256&&R[B].metadata.hasOwnProperty("Unicode")?K+=Y[q]:K+="";var De="";return parseInt(B.slice(1))<14||"WinAnsiEncoding"===ce?De=M(K,B).split("").map(function(Ye){return Ye.charCodeAt(0).toString(16)}).join(""):"Identity-H"===ce&&(De=e(K,R[B])),S.isHex=!0,{text:De,x:m,y:g,options:x,mutex:S}};i.events.push(["postProcessText",function(o){var c=o.text||"",u=[],m={text:c,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(c)){var g=0;for(g=0;g<c.length;g+=1)Array.isArray(c[g])&&3===c[g].length?u.push([r(Object.assign({},m,{text:c[g][0]})).text,c[g][1],c[g][2]]):u.push(r(Object.assign({},m,{text:c[g]})).text);o.text=u}else o.text=r(Object.assign({},m,{text:c})).text}])}(ei),function(t){var i=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(e){return i.call(this),void 0!==this.internal.vFS[e]},t.addFileToVFS=function(e,n){return i.call(this),this.internal.vFS[e]=n,this},t.getFileFromVFS=function(e){return i.call(this),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null}}(ei.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var r,o,c,u,m,g,x,S=i,M=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],E=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],R={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},B={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},K=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],q=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),Y=!1,ce=0;this.__bidiEngine__={};var De=function(fe){var de=fe.charCodeAt(),Oe=de>>8,Ae=B[Oe];return void 0!==Ae?S[256*Ae+(255&de)]:252===Oe||253===Oe?"AL":q.test(Oe)?"L":8===Oe?"R":"N"},Ye=function(fe){for(var de,Oe=0;Oe<fe.length;Oe++){if("L"===(de=De(fe.charAt(Oe))))return!1;if("R"===de)return!0}return!1},yt=function(fe,de,Oe,Ae){var Ct,Re,Je,Ue,lt=de[Ae];switch(lt){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":Y=!1;break;case"N":case"AN":break;case"EN":Y&&(lt="AN");break;case"AL":Y=!0,lt="R";break;case"WS":case"BN":lt="N";break;case"CS":Ae<1||Ae+1>=de.length||"EN"!==(Ct=Oe[Ae-1])&&"AN"!==Ct||"EN"!==(Re=de[Ae+1])&&"AN"!==Re?lt="N":Y&&(Re="AN"),lt=Re===Ct?Re:"N";break;case"ES":lt="EN"===(Ct=Ae>0?Oe[Ae-1]:"B")&&Ae+1<de.length&&"EN"===de[Ae+1]?"EN":"N";break;case"ET":if(Ae>0&&"EN"===Oe[Ae-1]){lt="EN";break}if(Y){lt="N";break}for(Je=Ae+1,Ue=de.length;Je<Ue&&"ET"===de[Je];)Je++;lt=Je<Ue&&"EN"===de[Je]?"EN":"N";break;case"NSM":if(c&&!u){for(Ue=de.length,Je=Ae+1;Je<Ue&&"NSM"===de[Je];)Je++;if(Je<Ue){var _t=fe[Ae];if(Ct=de[Je],(_t>=1425&&_t<=2303||64286===_t)&&("R"===Ct||"AL"===Ct)){lt="R";break}}}lt=Ae<1||"B"===(Ct=de[Ae-1])?"N":Oe[Ae-1];break;case"B":Y=!1,r=!0,lt=ce;break;case"S":o=!0,lt="N"}return lt},Ge=function(fe,de,Oe){var Ae=fe.split("");return Oe&&Te(Ae,Oe,{hiLevel:ce}),Ae.reverse(),de&&de.reverse(),Ae.join("")},Te=function(fe,de,Oe){var Ae,Ct,Re,Je,Ue,lt=-1,_t=fe.length,on=0,ne=[],ve=ce?E:M,we=[];for(Y=!1,r=!1,o=!1,Ct=0;Ct<_t;Ct++)we[Ct]=De(fe[Ct]);for(Re=0;Re<_t;Re++){if(Ue=on,ne[Re]=yt(fe,we,ne,Re),Ae=240&(on=ve[Ue][R[ne[Re]]]),de[Re]=Je=ve[on&=15][5],Ae>0)if(16===Ae){for(Ct=lt;Ct<Re;Ct++)de[Ct]=1;lt=-1}else lt=-1;if(ve[on][6])-1===lt&&(lt=Re);else if(lt>-1){for(Ct=lt;Ct<Re;Ct++)de[Ct]=Je;lt=-1}"B"===we[Re]&&(de[Re]=0),Oe.hiLevel|=Je}o&&function(je,Ze,it){for(var ct=0;ct<it;ct++)if("S"===je[ct]){Ze[ct]=ce;for(var pt=ct-1;pt>=0&&"WS"===je[pt];pt--)Ze[pt]=ce}}(we,de,_t)},mt=function(fe,de,Oe,Ae,Ct){if(!(Ct.hiLevel<fe)){if(1===fe&&1===ce&&!r)return de.reverse(),void(Oe&&Oe.reverse());for(var Re,Je,Ue,lt,_t=de.length,on=0;on<_t;){if(Ae[on]>=fe){for(Ue=on+1;Ue<_t&&Ae[Ue]>=fe;)Ue++;for(lt=on,Je=Ue-1;lt<Je;lt++,Je--)Re=de[lt],de[lt]=de[Je],de[Je]=Re,Oe&&(Re=Oe[lt],Oe[lt]=Oe[Je],Oe[Je]=Re);on=Ue}on++}}},vt=function(fe,de,Oe){var Ae=fe.split(""),Ct={hiLevel:ce};return Oe||(Oe=[]),Te(Ae,Oe,Ct),function(Re,Je,Ue){if(0!==Ue.hiLevel&&x)for(var lt,_t=0;_t<Re.length;_t++)1===Je[_t]&&(lt=K.indexOf(Re[_t]))>=0&&(Re[_t]=K[lt+1])}(Ae,Oe,Ct),mt(2,Ae,de,Oe,Ct),mt(1,Ae,de,Oe,Ct),Ae.join("")};return this.__bidiEngine__.doBidiReorder=function(fe,de,Oe){if(function(Ct,Re){if(Re)for(var Je=0;Je<Ct.length;Je++)Re[Je]=Je;void 0===u&&(u=Ye(Ct)),void 0===g&&(g=Ye(Ct))}(fe,de),c||!m||g)if(c&&m&&u^g)ce=u?1:0,fe=Ge(fe,de,Oe);else if(!c&&m&&g)ce=u?1:0,fe=vt(fe,de,Oe),fe=Ge(fe,de);else if(!c||u||m||g){if(c&&!m&&u^g)fe=Ge(fe,de),u?(ce=0,fe=vt(fe,de,Oe)):(ce=1,fe=vt(fe,de,Oe),fe=Ge(fe,de));else if(c&&u&&!m&&g)ce=1,fe=vt(fe,de,Oe),fe=Ge(fe,de);else if(!c&&!m&&u^g){var Ae=x;u?(ce=1,fe=vt(fe,de,Oe),ce=0,x=!1,fe=vt(fe,de,Oe),x=Ae):(ce=0,fe=vt(fe,de,Oe),fe=Ge(fe,de),ce=1,x=!1,fe=vt(fe,de,Oe),x=Ae,fe=Ge(fe,de))}}else ce=0,fe=vt(fe,de,Oe);else ce=u?1:0,fe=vt(fe,de,Oe);return fe},this.__bidiEngine__.setOptions=function(fe){fe&&(c=fe.isInputVisual,m=fe.isOutputVisual,u=fe.isInputRtl,g=fe.isOutputRtl,x=fe.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var i=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var r=n.text,o=n.options||{},c=[];if(o.isInputVisual="boolean"!=typeof o.isInputVisual||o.isInputVisual,e.setOptions(o),"[object Array]"===Object.prototype.toString.call(r)){var u=0;for(c=[],u=0;u<r.length;u+=1)"[object Array]"===Object.prototype.toString.call(r[u])?c.push([e.doBidiReorder(r[u][0]),r[u][1],r[u][2]]):c.push([e.doBidiReorder(r[u])]);n.text=c}else n.text=e.doBidiReorder(r);e.setOptions({isInputVisual:!0})}])}(ei),ei.API.TTFFont=function(){function t(i){var e;if(this.rawData=i,e=this.contents=new Yp(i),this.contents.pos=4,"ttcf"===e.readString(4))throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new VJ(this),this.registerTTF()}return t.open=function(i){return new t(i)},t.prototype.parse=function(){return this.directory=new EJ(this.contents),this.head=new DJ(this),this.name=new PJ(this),this.cmap=new u7(this),this.toUnicode={},this.hhea=new IJ(this),this.maxp=new OJ(this),this.hmtx=new NJ(this),this.post=new MJ(this),this.os2=new AJ(this),this.loca=new jJ(this),this.glyf=new LJ(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,n,r,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var c,u,m,g;for(g=[],c=0,u=(m=this.bbox).length;c<u;c++)g.push(Math.round(m[c]*this.scaleFactor));return g}.call(this),this.stemV=0,this.post.exists?(n=255&(r=this.post.italic_angle),0!=(32768&(e=r>>16))&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(o=this.familyClass)||2===o||3===o||4===o||5===o||7===o,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(i){var e;return(null!=(e=this.cmap.unicode)?e.codeMap[i]:void 0)||0},t.prototype.widthOfGlyph=function(i){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(i).advance*e},t.prototype.widthOfString=function(i,e,n){var r,o,c,u;for(c=0,o=0,u=(i=""+i).length;0<=u?o<u:o>u;o=0<=u?++o:--o)r=i.charCodeAt(o),c+=this.widthOfGlyph(this.characterToGlyph(r))+n*(1e3/e)||0;return c*(e/1e3)},t.prototype.lineHeight=function(i,e){return null==e&&(e=!1),(this.ascender+(e?this.lineGap:0)-this.decender)/1e3*i},t}();var Iu,Yp=function(){function t(i){this.data=null!=i?i:[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(i){return this.data[this.pos++]=i},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(i){return this.writeByte(i>>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},t.prototype.readInt32=function(){var i;return(i=this.readUInt32())>=2147483648?i-4294967296:i},t.prototype.writeInt32=function(i){return i<0&&(i+=4294967296),this.writeUInt32(i)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(i){return this.writeByte(i>>8&255),this.writeByte(255&i)},t.prototype.readInt16=function(){var i;return(i=this.readUInt16())>=32768?i-65536:i},t.prototype.writeInt16=function(i){return i<0&&(i+=65536),this.writeUInt16(i)},t.prototype.readString=function(i){var e,n;for(n=[],e=0;0<=i?e<i:e>i;e=0<=i?++e:--e)n[e]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(i){var e,n,r;for(r=[],e=0,n=i.length;0<=n?e<n:e>n;e=0<=n?++e:--e)r.push(this.writeByte(i.charCodeAt(e)));return r},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(i){return this.writeInt16(i)},t.prototype.readLongLong=function(){var i,e,n,r,o,c,u,m;return i=this.readByte(),e=this.readByte(),n=this.readByte(),r=this.readByte(),o=this.readByte(),c=this.readByte(),u=this.readByte(),m=this.readByte(),128&i?-1*(72057594037927940*(255^i)+281474976710656*(255^e)+1099511627776*(255^n)+4294967296*(255^r)+16777216*(255^o)+65536*(255^c)+256*(255^u)+(255^m)+1):72057594037927940*i+281474976710656*e+1099511627776*n+4294967296*r+16777216*o+65536*c+256*u+m},t.prototype.writeLongLong=function(i){var e,n;return e=Math.floor(i/4294967296),n=4294967295&i,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(i){return this.writeInt32(i)},t.prototype.read=function(i){var e,n;for(e=[],n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)e.push(this.readByte());return e},t.prototype.write=function(i){var n,r,o;for(o=[],n=0,r=i.length;n<r;n++)o.push(this.writeByte(i[n]));return o},t}(),EJ=function(){var t;function i(e){var n,r,o;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},r=0,o=this.tableCount;0<=o?r<o:r>o;r=0<=o?++r:--r)n={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[n.tag]=n}return i.prototype.encode=function(e){var n,r,c,u,m,g,x,S,M,E,R,B;for(B in E=Object.keys(e).length,m=Math.log(2),S=16*Math.floor(Math.log(E)/m),c=Math.floor(S/m),x=16*E-S,(r=new Yp).writeInt(this.scalarType),r.writeShort(E),r.writeShort(S),r.writeShort(c),r.writeShort(x),g=r.pos+16*E,u=null,R=[],e)for(M=e[B],r.writeString(B),r.writeInt(t(M)),r.writeInt(g),r.writeInt(M.length),R=R.concat(M),"head"===B&&(u=g),g+=M.length;g%4;)R.push(0),g++;return r.write(R),n=2981146554-t(r.data),r.pos=u+8,r.writeUInt32(n),r.data},t=function(e){var n,r,o,c;for(e=d7.call(e);e.length%4;)e.push(0);for(o=new Yp(e),r=0,n=0,c=e.length;n<c;n=n+=4)r+=o.readUInt32();return 4294967295&r},i}(),kJ={}.hasOwnProperty,yd=function(t,i){for(var e in i)kJ.call(i,e)&&(t[e]=i[e]);function n(){this.constructor=t}return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};Iu=function(){function t(i){var e;this.file=i,this.exists=!!(e=this.file.directory.tables[this.tag]),e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var DJ=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return yd(i,Iu),i.prototype.tag="head",i.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},i.prototype.encode=function(e){var n;return(n=new Yp).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},i}(),c7=function(){function t(i,e){var n,r,o,c,u,m,g,x,S,M,E,R,B,K,q,Y,ce;switch(this.platformID=i.readUInt16(),this.encodingID=i.readShort(),this.offset=e+i.readInt(),S=i.pos,i.pos=this.offset,this.format=i.readUInt16(),this.length=i.readUInt16(),this.language=i.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(m=0;m<256;++m)this.codeMap[m]=i.readByte();break;case 4:for(E=i.readUInt16(),M=E/2,i.pos+=6,o=function(){var De,Ye;for(Ye=[],m=De=0;0<=M?De<M:De>M;m=0<=M?++De:--De)Ye.push(i.readUInt16());return Ye}(),i.pos+=2,B=function(){var De,Ye;for(Ye=[],m=De=0;0<=M?De<M:De>M;m=0<=M?++De:--De)Ye.push(i.readUInt16());return Ye}(),g=function(){var De,Ye;for(Ye=[],m=De=0;0<=M?De<M:De>M;m=0<=M?++De:--De)Ye.push(i.readUInt16());return Ye}(),x=function(){var De,Ye;for(Ye=[],m=De=0;0<=M?De<M:De>M;m=0<=M?++De:--De)Ye.push(i.readUInt16());return Ye}(),r=(this.length-i.pos+this.offset)/2,u=function(){var De,Ye;for(Ye=[],m=De=0;0<=r?De<r:De>r;m=0<=r?++De:--De)Ye.push(i.readUInt16());return Ye}(),m=q=0,ce=o.length;q<ce;m=++q)for(K=o[m],n=Y=R=B[m];R<=K?Y<=K:Y>=K;n=R<=K?++Y:--Y)0===x[m]?c=n+g[m]:0!==(c=u[x[m]/2+(n-R)-(M-m)]||0)&&(c+=g[m]),this.codeMap[n]=65535&c}i.pos=S}return t.encode=function(i,e){var n,r,o,c,u,m,g,x,S,M,E,R,B,K,q,Y,ce,Ye,yt,Ge,Te,mt,vt,fe,de,Oe,Ae,Ct,Re,Je,Ue,lt,_t,on,ne,ve,we,je,Ze,it,ct,pt,qt,Gt,xn;switch(Ae=new Yp,c=Object.keys(i).sort(function(En,oi){return En-oi}),e){case"macroman":for(B=0,K=function(){var En=[];for(R=0;R<256;++R)En.push(0);return En}(),Y={0:0},o={},Ct=0,lt=c.length;Ct<lt;Ct++)null==Y[pt=i[r=c[Ct]]]&&(Y[pt]=++B),o[r]={old:i[r],new:Y[i[r]]},K[r]=Y[i[r]];return Ae.writeUInt16(1),Ae.writeUInt16(0),Ae.writeUInt32(12),Ae.writeUInt16(0),Ae.writeUInt16(262),Ae.writeUInt16(0),Ae.write(K),{charMap:o,subtable:Ae.data,maxGlyphID:B+1};case"unicode":for(de=[],S=[],ce=0,Y={},n={},q=g=null,Re=0,_t=c.length;Re<_t;Re++)null==Y[Ye=i[r=c[Re]]]&&(Y[Ye]=++ce),n[r]={old:Ye,new:Y[Ye]},u=Y[Ye]-r,null!=q&&u===g||(q&&S.push(q),de.push(r),g=u),q=r;for(q&&S.push(q),S.push(65535),de.push(65535),vt=2*(mt=de.length),Te=2*Math.pow(Math.log(mt)/Math.LN2,2),M=Math.log(Te/2)/Math.LN2,Ge=2*mt-Te,m=[],yt=[],E=[],R=Je=0,on=de.length;Je<on;R=++Je){if(x=S[R],65535===(fe=de[R])){m.push(0),yt.push(0);break}if(fe-(Oe=n[fe].new)>=32768)for(m.push(0),yt.push(2*(E.length+mt-R)),r=Ue=fe;fe<=x?Ue<=x:Ue>=x;r=fe<=x?++Ue:--Ue)E.push(n[r].new);else m.push(Oe-fe),yt.push(0)}for(Ae.writeUInt16(3),Ae.writeUInt16(1),Ae.writeUInt32(12),Ae.writeUInt16(4),Ae.writeUInt16(16+8*mt+2*E.length),Ae.writeUInt16(0),Ae.writeUInt16(vt),Ae.writeUInt16(Te),Ae.writeUInt16(M),Ae.writeUInt16(Ge),it=0,ne=S.length;it<ne;it++)Ae.writeUInt16(r=S[it]);for(Ae.writeUInt16(0),ct=0,ve=de.length;ct<ve;ct++)Ae.writeUInt16(r=de[ct]);for(qt=0,we=m.length;qt<we;qt++)Ae.writeUInt16(u=m[qt]);for(Gt=0,je=yt.length;Gt<je;Gt++)Ae.writeUInt16(yt[Gt]);for(xn=0,Ze=E.length;xn<Ze;xn++)Ae.writeUInt16(B=E[xn]);return{charMap:n,subtable:Ae.data,maxGlyphID:ce+1}}},t}(),u7=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return yd(i,Iu),i.prototype.tag="cmap",i.prototype.parse=function(e){var n,r,o;for(e.pos=this.offset,this.version=e.readUInt16(),o=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=o?r<o:r>o;r=0<=o?++r:--r)n=new c7(e,this.offset),this.tables.push(n),n.isUnicode&&null==this.unicode&&(this.unicode=n);return!0},i.encode=function(e,n){var r,o;return null==n&&(n="macroman"),r=c7.encode(e,n),(o=new Yp).writeUInt16(0),o.writeUInt16(1),r.table=o.data.concat(r.subtable),r},i}(),IJ=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return yd(i,Iu),i.prototype.tag="hhea",i.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},i}(),AJ=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return yd(i,Iu),i.prototype.tag="OS/2",i.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var n,r;for(r=[],n=0;n<10;++n)r.push(e.readByte());return r}(),this.charRange=function(){var n,r;for(r=[],n=0;n<4;++n)r.push(e.readInt());return r}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(e.readInt());return r}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},i}(),MJ=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return yd(i,Iu),i.prototype.tag="post",i.prototype.parse=function(e){var n,r,o;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var c;for(r=e.readUInt16(),this.glyphNameIndex=[],c=0;0<=r?c<r:c>r;c=0<=r?++c:--c)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],o=[];e.pos<this.offset+this.length;)n=e.readByte(),o.push(this.names.push(e.readString(n)));return o;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=function(){var u,m,g;for(g=[],c=u=0,m=this.file.maxp.numGlyphs;0<=m?u<m:u>m;c=0<=m?++u:--u)g.push(e.readUInt32());return g}.call(this)}},i}(),FJ=function(t,i){this.raw=t,this.length=t.length,this.platformID=i.platformID,this.encodingID=i.encodingID,this.languageID=i.languageID},PJ=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return yd(i,Iu),i.prototype.tag="name",i.prototype.parse=function(e){var n,r,o,c,u,m,g,x,S,M,E;for(e.pos=this.offset,e.readShort(),n=e.readShort(),m=e.readShort(),r=[],c=0;0<=n?c<n:c>n;c=0<=n?++c:--c)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+m+e.readShort()});for(g={},c=S=0,M=r.length;S<M;c=++S)e.pos=(o=r[c]).offset,x=e.readString(o.length),u=new FJ(x,o),null==g[E=o.nameID]&&(g[E]=[]),g[o.nameID].push(u);this.strings=g,this.copyright=g[0],this.fontFamily=g[1],this.fontSubfamily=g[2],this.uniqueSubfamily=g[3],this.fontName=g[4],this.version=g[5];try{this.postscriptName=g[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(R){this.postscriptName=g[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=g[7],this.manufacturer=g[8],this.designer=g[9],this.description=g[10],this.vendorUrl=g[11],this.designerUrl=g[12],this.license=g[13],this.licenseUrl=g[14],this.preferredFamily=g[15],this.preferredSubfamily=g[17],this.compatibleFull=g[18],this.sampleText=g[19]},i}(),OJ=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return yd(i,Iu),i.prototype.tag="maxp",i.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},i}(),NJ=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return yd(i,Iu),i.prototype.tag="hmtx",i.prototype.parse=function(e){var n,r,o,u,m,g;for(e.pos=this.offset,this.metrics=[],n=0,m=this.file.hhea.numberOfMetrics;0<=m?n<m:n>m;n=0<=m?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var x,S;for(S=[],n=x=0;0<=o?x<o:x>o;n=0<=o?++x:--x)S.push(e.readInt16());return S}(),this.widths=function(){var x,S,M,E;for(E=[],x=0,S=(M=this.metrics).length;x<S;x++)E.push(M[x].advance);return E}.call(this),r=this.widths[this.widths.length-1],g=[],n=u=0;0<=o?u<o:u>o;n=0<=o?++u:--u)g.push(this.widths.push(r));return g},i.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},i}(),d7=[].slice,LJ=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return yd(i,Iu),i.prototype.tag="glyf",i.prototype.parse=function(){return this.cache={}},i.prototype.glyphFor=function(e){var n,r,o,c,u,m,g,x,S,M;return e in this.cache?this.cache[e]:(n=this.file.contents,r=(c=this.file.loca).indexOf(e),0===(o=c.lengthOf(e))?this.cache[e]=null:(n.pos=this.offset+r,u=(m=new Yp(n.read(o))).readShort(),x=m.readShort(),M=m.readShort(),g=m.readShort(),S=m.readShort(),this.cache[e]=-1===u?new BJ(m,x,M,g,S):new RJ(m,u,x,M,g,S),this.cache[e]))},i.prototype.encode=function(e,n,r){var o,c,u,m,g;for(u=[],c=[],m=0,g=n.length;m<g;m++)o=e[n[m]],c.push(u.length),o&&(u=u.concat(o.encode(r)));return c.push(u.length),{table:u,offsets:c}},i}(),RJ=function(){function t(i,e,n,r,o,c){this.raw=i,this.numberOfContours=e,this.xMin=n,this.yMin=r,this.xMax=o,this.yMax=c,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),BJ=function(){function t(i,e,n,r,o){var c,u;for(this.raw=i,this.xMin=e,this.yMin=n,this.xMax=r,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],c=this.raw;u=c.readShort(),this.glyphOffsets.push(c.pos),this.glyphIDs.push(c.readUInt16()),32&u;)c.pos+=1&u?4:2,128&u?c.pos+=8:64&u?c.pos+=4:8&u&&(c.pos+=2)}return t.prototype.encode=function(){var i,e,n;for(e=new Yp(d7.call(this.raw.data)),i=0,n=this.glyphIDs.length;i<n;++i)e.pos=this.glyphOffsets[i];return e.data},t}(),jJ=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return yd(i,Iu),i.prototype.tag="loca",i.prototype.parse=function(e){var r;return e.pos=this.offset,this.offsets=0===this.file.head.indexToLocFormat?function(){var o,c;for(c=[],r=0,o=this.length;r<o;r+=2)c.push(2*e.readUInt16());return c}.call(this):function(){var o,c;for(c=[],r=0,o=this.length;r<o;r+=4)c.push(e.readUInt32());return c}.call(this)},i.prototype.indexOf=function(e){return this.offsets[e]},i.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},i.prototype.encode=function(e,n){for(var r=new Uint32Array(this.offsets.length),o=0,c=0,u=0;u<r.length;++u)if(r[u]=o,c<n.length&&n[c]==u){++c,r[u]=o;var g=this.offsets[u+1]-this.offsets[u];g>0&&(o+=g)}for(var x=new Array(4*r.length),S=0;S<r.length;++S)x[4*S+3]=255&r[S],x[4*S+2]=(65280&r[S])>>8,x[4*S+1]=(16711680&r[S])>>16,x[4*S]=(4278190080&r[S])>>24;return x},i}(),VJ=function(){function t(i){this.font=i,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var i,e,r,o;for(e in r=this.font.cmap.tables[0].codeMap,i={},o=this.subset)i[e]=r[o[e]];return i},t.prototype.glyphsFor=function(i){var e,n,r,o,c,u,m;for(r={},c=0,u=i.length;c<u;c++)r[o=i[c]]=this.font.glyf.glyphFor(o);for(o in e=[],r)(null!=(n=r[o])?n.compound:void 0)&&e.push.apply(e,n.glyphIDs);if(e.length>0)for(o in m=this.glyphsFor(e))r[o]=n=m[o];return r},t.prototype.encode=function(i,e){var n,r,o,c,m,g,x,S,M,E,R,B,K,q;for(r in n=u7.encode(this.generateCmap(),"unicode"),c=this.glyphsFor(i),E={0:0},q=n.charMap)E[(m=q[r]).old]=m.new;for(R in M=n.maxGlyphID,c)R in E||(E[R]=M++);return x=function(Y){var ce,De;for(ce in De={},Y)De[Y[ce]]=ce;return De}(E),S=Object.keys(x).sort(function(Y,ce){return Y-ce}),B=function(){var Y,ce,De;for(De=[],Y=0,ce=S.length;Y<ce;Y++)De.push(x[S[Y]]);return De}(),o=this.font.glyf.encode(c,B,E),g=this.font.loca.encode(o.offsets,B),K={cmap:this.font.cmap.raw(),glyf:o.table,loca:g,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(K["OS/2"]=this.font.os2.raw()),this.font.directory.encode(K)},t}();ei.API.PDFObject=function(){var t;function i(){}return t=function(e,n){return(Array(n+1).join("0")+e).slice(-n)},i.convert=function(e){var r,o;if(Array.isArray(e))return"["+function(){var u,m,g;for(g=[],u=0,m=e.length;u<m;u++)g.push(i.convert(e[u]));return g}().join(" ")+"]";if("string"==typeof e)return"/"+e;if(null!=e?e.isString:void 0)return"("+e+")";if(e instanceof Date)return"(D:"+t(e.getUTCFullYear(),4)+t(e.getUTCMonth(),2)+t(e.getUTCDate(),2)+t(e.getUTCHours(),2)+t(e.getUTCMinutes(),2)+t(e.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(e)){for(r in o=["<<"],e)o.push("/"+r+" "+i.convert(e[r]));return o.push(">>"),o.join("\n")}return""+e},i}();const UJ=ei;function f7(t,i,e,n,r){n=n||{};var c=r.internal.scaleFactor,u=r.internal.getFontSize()/c,g=u*(r.getLineHeightFactor?r.getLineHeightFactor():1.15),S="",M=1;if(("middle"===n.valign||"bottom"===n.valign||"center"===n.halign||"right"===n.halign)&&(M=(S="string"==typeof t?t.split(/\r\n|\r|\n/g):t).length||1),e+=u*(2-1.15),"middle"===n.valign?e-=M/2*g:"bottom"===n.valign&&(e-=M*g),"center"===n.halign||"right"===n.halign){var E=u;if("center"===n.halign&&(E*=.5),S&&M>=1){for(var R=0;R<S.length;R++)r.text(S[R],i-r.getStringUnitWidth(S[R])*E,e),e+=g;return r}i-=r.getStringUnitWidth(t)*E}return"justify"===n.halign?r.text(t,i,e,{maxWidth:n.maxWidth||100,align:"justify"}):r.text(t,i,e),r}var p7={},t_=function(){function t(i){this.jsPDFDocument=i,this.userStyles={textColor:i.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:i.internal.getFontSize(),fontStyle:i.internal.getFont().fontStyle,font:i.internal.getFont().fontName,lineWidth:i.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:i.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(i,e){void 0===e&&(e=null),e?e.__autoTableDocumentDefaults=i:p7=i},t.unifyColor=function(i){return Array.isArray(i)?i:"number"==typeof i?[i,i,i]:"string"==typeof i?[i]:null},t.prototype.applyStyles=function(i,e){var n,r,o;void 0===e&&(e=!1),i.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(i.fontStyle);var c=this.jsPDFDocument.internal.getFont(),u=c.fontStyle,m=c.fontName;if(i.font&&(m=i.font),i.fontStyle){u=i.fontStyle;var g=this.getFontList()[m];g&&-1===g.indexOf(u)&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(g[0]),u=g[0])}if(this.jsPDFDocument.setFont(m,u),i.fontSize&&this.jsPDFDocument.setFontSize(i.fontSize),!e){var x=t.unifyColor(i.fillColor);x&&(n=this.jsPDFDocument).setFillColor.apply(n,x),(x=t.unifyColor(i.textColor))&&(r=this.jsPDFDocument).setTextColor.apply(r,x),(x=t.unifyColor(i.lineColor))&&(o=this.jsPDFDocument).setDrawColor.apply(o,x),"number"==typeof i.lineWidth&&this.jsPDFDocument.setLineWidth(i.lineWidth)}},t.prototype.splitTextToSize=function(i,e,n){return this.jsPDFDocument.splitTextToSize(i,e,n)},t.prototype.rect=function(i,e,n,r,o){return this.jsPDFDocument.rect(i,e,n,r,o)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(i){return this.jsPDFDocument.getTextWidth(i)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(i){this.jsPDFDocument.setPage(i)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return p7||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var i=this.jsPDFDocument.internal.pageSize;return null==i.width&&(i={width:i.getWidth(),height:i.getHeight()}),i},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var i=this.jsPDFDocument;return i.getLineHeightFactor?i.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(i){return i/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var i=this.jsPDFDocument.internal.getCurrentPageInfo();return i?i.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),JA=function(t,i){return(JA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])})(t,i)};function h7(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function e(){this.constructor=t}JA(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}"function"==typeof SuppressedError&&SuppressedError;var m7=function(t){function i(e){var n=t.call(this)||this;return n._element=e,n}return h7(i,t),i}(Array);function XT(t,i,e){return e.applyStyles(i,!0),(Array.isArray(t)?t:[t]).map(function(o){return e.getTextWidth(o)}).reduce(function(o,c){return Math.max(o,c)},0)}function g7(t,i,e,n){var r=i.settings.tableLineWidth;t.applyStyles({lineWidth:r,lineColor:i.settings.tableLineColor});var c=_7(r,!1);c&&t.rect(e.x,e.y,i.getWidth(t.pageSize().width),n.y-e.y,c)}function _7(t,i){var e=t>0,n=i||0===i;return e&&n?"DF":e?"S":n?"F":null}function QT(t,i){var e,n,r,o;if(t=t||i,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(3===t.length)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(2===t.length)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t=1===t.length?t[0]:i}return"object"==typeof t?("number"==typeof t.vertical&&(t.top=t.vertical,t.bottom=t.vertical),"number"==typeof t.horizontal&&(t.right=t.horizontal,t.left=t.horizontal),{left:null!==(e=t.left)&&void 0!==e?e:i,top:null!==(n=t.top)&&void 0!==n?n:i,right:null!==(r=t.right)&&void 0!==r?r:i,bottom:null!==(o=t.bottom)&&void 0!==o?o:i}):("number"!=typeof t&&(t=i),{top:t,right:t,bottom:t,left:t})}function v7(t,i){var e=QT(i.settings.margin,0);return t.pageSize().width-(e.left+e.right)}function $J(t,i,e,n,r){var o={},c=1.3333333333333333,u=ZA(i,function(ce){return r.getComputedStyle(ce).backgroundColor});null!=u&&(o.fillColor=u);var m=ZA(i,function(ce){return r.getComputedStyle(ce).color});null!=m&&(o.textColor=m);var g=function qJ(t,i){var e=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/i),r=(parseInt(t.lineHeight)-parseInt(t.fontSize))/i/2,o=e.map(function(u){return parseInt(u||"0")/n}),c=QT(o,0);return r>c.top&&(c.top=r),r>c.bottom&&(c.bottom=r),c}(n,e);g&&(o.cellPadding=g);var x="borderTopColor",S=c*e,M=n.borderTopWidth;if(n.borderBottomWidth===M&&n.borderRightWidth===M&&n.borderLeftWidth===M){var E=(parseFloat(M)||0)/S;E&&(o.lineWidth=E)}else o.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/S,right:(parseFloat(n.borderRightWidth)||0)/S,bottom:(parseFloat(n.borderBottomWidth)||0)/S,left:(parseFloat(n.borderLeftWidth)||0)/S},o.lineWidth.top||(o.lineWidth.right?x="borderRightColor":o.lineWidth.bottom?x="borderBottomColor":o.lineWidth.left&&(x="borderLeftColor"));var R=ZA(i,function(ce){return r.getComputedStyle(ce)[x]});null!=R&&(o.lineColor=R);var B=["left","right","center","justify"];-1!==B.indexOf(n.textAlign)&&(o.halign=n.textAlign),-1!==(B=["middle","bottom","top"]).indexOf(n.verticalAlign)&&(o.valign=n.verticalAlign);var K=parseInt(n.fontSize||"");isNaN(K)||(o.fontSize=K/c);var q=function WJ(t){var i="";return("bold"===t.fontWeight||"bolder"===t.fontWeight||parseInt(t.fontWeight)>=700)&&(i="bold"),("italic"===t.fontStyle||"oblique"===t.fontStyle)&&(i+="italic"),i}(n);q&&(o.fontStyle=q);var Y=(n.fontFamily||"").toLowerCase();return-1!==t.indexOf(Y)&&(o.font=Y),o}function ZA(t,i){var e=y7(t,i);if(!e)return null;var n=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var r=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])];return 0===parseInt(n[4])||isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function y7(t,i){var e=i(t);return"rgba(0, 0, 0, 0)"===e||"transparent"===e||"initial"===e||"inherit"===e?null==t.parentElement?null:y7(t.parentElement,i):e}function b7(t,i,e,n,r){var o,c,u;void 0===n&&(n=!1),void 0===r&&(r=!1),u="string"==typeof i?e.document.querySelector(i):i;var m=Object.keys(t.getFontList()),g=t.scaleFactor(),x=[],S=[],M=[];if(!u)return console.error("Html table could not be found with input: ",i),{head:x,body:S,foot:M};for(var E=0;E<u.rows.length;E++){var R=u.rows[E],B=null===(c=null===(o=null==R?void 0:R.parentElement)||void 0===o?void 0:o.tagName)||void 0===c?void 0:c.toLowerCase(),K=GJ(m,g,e,R,n,r);!K||("thead"===B?x.push(K):"tfoot"===B?M.push(K):S.push(K))}return{head:x,body:S,foot:M}}function GJ(t,i,e,n,r,o){for(var c=new m7(n),u=0;u<n.cells.length;u++){var m=n.cells[u],g=e.getComputedStyle(m);if(r||"none"!==g.display){var x=void 0;o&&(x=$J(t,m,i,g,e)),c.push({rowSpan:m.rowSpan,colSpan:m.colSpan,styles:x,_element:m,content:KJ(m)})}}var S=e.getComputedStyle(n);if(c.length>0&&(r||"none"!==S.display))return c}function KJ(t){var i=t.cloneNode(!0);return i.innerHTML=i.innerHTML.replace(/\n/g,"").replace(/ +/g," "),i.innerHTML=i.innerHTML.split(/<br.*?>/).map(function(e){return e.trim()}).join("\n"),i.innerText||i.textContent||""}function bf(t,i,e,n,r){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),c=1;c<arguments.length;c++){var u=arguments[c];if(null!=u)for(var m in u)Object.prototype.hasOwnProperty.call(u,m)&&(o[m]=u[m])}return o}function eM(t,i){var e=new t_(t),n=e.getDocumentOptions(),r=e.getGlobalOptions();!function YJ(t,i,e){for(var n=0,r=[t,i,e];n<r.length;n++){var o=r[n];o&&"object"!=typeof o&&console.error("The options parameter should be of type object, is: "+typeof o),o.startY&&"number"!=typeof o.startY&&(console.error("Invalid value for startY option",o.startY),delete o.startY)}}(r,n,i);var c,o=bf({},r,n,i);"undefined"!=typeof window&&(c=window);var u=function XJ(t,i,e){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},r=function(m){if("columnStyles"===m)n.columnStyles=bf({},t[m],i[m],e[m]);else{var E=[t,i,e].map(function(R){return R[m]||{}});n[m]=bf({},E[0],E[1],E[2])}},o=0,c=Object.keys(n);o<c.length;o++)r(c[o]);return n}(r,n,i),m=function QJ(t,i,e){for(var r={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},o=0,c=[t,i,e];o<c.length;o++){var u=c[o];u.didParseCell&&r.didParseCell.push(u.didParseCell),u.willDrawCell&&r.willDrawCell.push(u.willDrawCell),u.didDrawCell&&r.didDrawCell.push(u.didDrawCell),u.willDrawPage&&r.willDrawPage.push(u.willDrawPage),u.didDrawPage&&r.didDrawPage.push(u.didDrawPage)}return r}(r,n,i),g=function JJ(t,i){var e,n,r,o,c,u,m,g,x,S,M,E,K,q,R=QT(i.margin,40/t.scaleFactor()),B=null!==(e=function ZJ(t,i){var e=t.getLastAutoTable(),n=t.scaleFactor(),r=t.pageNumber(),o=!1;return e&&e.startPageNumber&&(o=e.startPageNumber+e.pageNumber-1===r),"number"==typeof i?i:null!=i&&!1!==i||!o||null==(null==e?void 0:e.finalY)?null:e.finalY+20/n}(t,i.startY))&&void 0!==e?e:R.top;K=!0===i.showFoot?"everyPage":!1===i.showFoot?"never":null!==(n=i.showFoot)&&void 0!==n?n:"everyPage",q=!0===i.showHead?"everyPage":!1===i.showHead?"never":null!==(r=i.showHead)&&void 0!==r?r:"everyPage";var Y=null!==(o=i.useCss)&&void 0!==o&&o,Ye=null!==(c=i.horizontalPageBreakRepeat)&&void 0!==c?c:null;return{includeHiddenHtml:null!==(u=i.includeHiddenHtml)&&void 0!==u&&u,useCss:Y,theme:i.theme||(Y?"plain":"striped"),startY:B,margin:R,pageBreak:null!==(m=i.pageBreak)&&void 0!==m?m:"auto",rowPageBreak:null!==(g=i.rowPageBreak)&&void 0!==g?g:"auto",tableWidth:null!==(x=i.tableWidth)&&void 0!==x?x:"auto",showHead:q,showFoot:K,tableLineWidth:null!==(S=i.tableLineWidth)&&void 0!==S?S:0,tableLineColor:null!==(M=i.tableLineColor)&&void 0!==M?M:200,horizontalPageBreak:!!i.horizontalPageBreak,horizontalPageBreakRepeat:Ye,horizontalPageBreakBehaviour:null!==(E=i.horizontalPageBreakBehaviour)&&void 0!==E?E:"afterAllRows"}}(e,o),x=function eZ(t,i,e){var n=i.head||[],r=i.body||[],o=i.foot||[];if(i.html)if(e){var u=b7(t,i.html,e,i.includeHiddenHtml,i.useCss)||{};n=u.head||n,r=u.body||n,o=u.foot||n}else console.error("Cannot parse html in non browser environment");return{columns:i.columns||tZ(n,r,o),head:n,body:r,foot:o}}(e,o,c);return{id:i.tableId,content:x,hooks:m,styles:u,settings:g}}function tZ(t,i,e){var n=t[0]||i[0]||e[0]||[],r=[];return Object.keys(n).filter(function(o){return"_element"!==o}).forEach(function(o){var u,c=1;"object"==typeof(u=Array.isArray(n)?n[parseInt(o)]:n[o])&&!Array.isArray(u)&&(c=(null==u?void 0:u.colSpan)||1);for(var m=0;m<c;m++){var g;g=Array.isArray(n)?r.length:o+(m>0?"_".concat(m):""),r.push({dataKey:g})}}),r}var aM,tM=function t(i,e,n){this.table=e,this.pageNumber=e.pageNumber,this.settings=e.settings,this.cursor=n,this.doc=i.getDocument()},nZ=function(t){function i(e,n,r,o,c,u){var m=t.call(this,e,n,u)||this;return m.cell=r,m.row=o,m.column=c,m.section=o.section,m}return h7(i,t),i}(tM),iZ=function(){function t(i,e){this.pageNumber=1,this.id=i.id,this.settings=i.settings,this.styles=i.styles,this.hooks=i.hooks,this.columns=e.columns,this.head=e.head,this.body=e.body,this.foot=e.foot}return t.prototype.getHeadHeight=function(i){return this.head.reduce(function(e,n){return e+n.getMaxCellHeight(i)},0)},t.prototype.getFootHeight=function(i){return this.foot.reduce(function(e,n){return e+n.getMaxCellHeight(i)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(i,e,n,r,o,c){for(var u=0,m=e;u<m.length;u++){var S=!1===(0,m[u])(new nZ(i,this,n,r,o,c));if(n.text=Array.isArray(n.text)?n.text:[n.text],S)return!1}return!0},t.prototype.callEndPageHooks=function(i,e){i.applyStyles(i.userStyles);for(var n=0,r=this.hooks.didDrawPage;n<r.length;n++)(0,r[n])(new tM(i,this,e))},t.prototype.callWillDrawPageHooks=function(i,e){for(var n=0,r=this.hooks.willDrawPage;n<r.length;n++)(0,r[n])(new tM(i,this,e))},t.prototype.getWidth=function(i){if("number"==typeof this.settings.tableWidth)return this.settings.tableWidth;if("wrap"===this.settings.tableWidth)return this.columns.reduce(function(r,o){return r+o.wrappedWidth},0);var n=this.settings.margin;return i-n.left-n.right},t}(),x7=function(){function t(i,e,n,r,o){void 0===o&&(o=!1),this.height=0,this.raw=i,i instanceof m7&&(this.raw=i._element,this.element=i._element),this.index=e,this.section=n,this.cells=r,this.spansMultiplePages=o}return t.prototype.getMaxCellHeight=function(i){var e=this;return i.reduce(function(n,r){var o;return Math.max(n,(null===(o=e.cells[r.index])||void 0===o?void 0:o.height)||0)},0)},t.prototype.hasRowSpan=function(i){var e=this;return i.filter(function(n){var r=e.cells[n.index];return!!r&&r.rowSpan>1}).length>0},t.prototype.canEntireRowFit=function(i,e){return this.getMaxCellHeight(e)<=i},t.prototype.getMinimumRowHeight=function(i,e){var n=this;return i.reduce(function(r,o){var c=n.cells[o.index];if(!c)return 0;var u=e.getLineHeight(c.styles.fontSize),g=c.padding("vertical")+u;return g>r?g:r},0)},t}(),w7=function(){function t(i,e,n){var r;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=e,this.section=n,this.raw=i;var o=i;null==i||"object"!=typeof i||Array.isArray(i)?(this.rowSpan=1,this.colSpan=1):(this.rowSpan=i.rowSpan||1,this.colSpan=i.colSpan||1,o=null!==(r=i.content)&&void 0!==r?r:i,i._element&&(this.raw=i._element)),this.text=(null!=o?""+o:"").split(/\r\n|\r|\n/g)}return t.prototype.getTextPos=function(){var i,n;if("top"===this.styles.valign)i=this.y+this.padding("top");else if("bottom"===this.styles.valign)i=this.y+this.height-this.padding("bottom");else{var e=this.height-this.padding("vertical");i=this.y+e/2+this.padding("top")}if("right"===this.styles.halign)n=this.x+this.width-this.padding("right");else if("center"===this.styles.halign){var r=this.width-this.padding("horizontal");n=this.x+r/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:i}},t.prototype.getContentHeight=function(i,e){void 0===e&&(e=1.15);var o=(Array.isArray(this.text)?this.text.length:1)*(this.styles.fontSize/i*e)+this.padding("vertical");return Math.max(o,this.styles.minCellHeight)},t.prototype.padding=function(i){var e=QT(this.styles.cellPadding,0);return"vertical"===i?e.top+e.bottom:"horizontal"===i?e.left+e.right:e[i]},t}(),rZ=function(){function t(i,e,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=i,this.raw=e,this.index=n}return t.prototype.getMaxCustomCellWidth=function(i){for(var e=0,n=0,r=i.allRows();n<r.length;n++){var c=r[n].cells[this.index];c&&"number"==typeof c.styles.cellWidth&&(e=Math.max(e,c.styles.cellWidth))}return e},t}();function nM(t,i,e){for(var n=i,r=t.reduce(function(E,R){return E+R.wrappedWidth},0),o=0;o<t.length;o++){var c=t[o],g=c.width+n*(c.wrappedWidth/r),x=e(c),S=g<x?x:g;i-=S-c.width,c.width=S}if(i=Math.round(1e10*i)/1e10){var M=t.filter(function(E){return!(i<0)||E.width>e(E)});M.length&&(i=nM(M,i,e))}return i}function C7(t,i,e,n,r){return t.map(function(o){return function uZ(t,i,e,n,r){var o=1e4*n.scaleFactor();if((i=Math.ceil(i*o)/o)>=XT(t,e,n))return t;for(;i<XT(t+r,e,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+r}(o,i,e,n,r)})}function iM(t,i){var e=new t_(t),n=function dZ(t,i){var r,e=t.content,n=function pZ(t){return t.map(function(i,e){var n,r;return r="object"==typeof i&&null!==(n=i.dataKey)&&void 0!==n?n:e,new rZ(r,i,e)})}(e.columns);(0===e.head.length&&(r=T7(n,"head"))&&e.head.push(r),0===e.foot.length)&&((r=T7(n,"foot"))&&e.foot.push(r));var o=t.settings.theme,c=t.styles;return{columns:n,head:rM("head",e.head,n,c,o,i),body:rM("body",e.body,n,c,o,i),foot:rM("foot",e.foot,n,c,o,i)}}(i,e.scaleFactor()),r=new iZ(i,n);return function oZ(t,i){!function sZ(t,i){var e=t.scaleFactor(),n=i.settings.horizontalPageBreak,r=v7(t,i);i.allRows().forEach(function(o){for(var c=0,u=i.columns;c<u.length;c++){var m=u[c],g=o.cells[m.index];if(g){i.callCellHooks(t,i.hooks.didParseCell,g,o,m,null);var S=g.padding("horizontal");g.contentWidth=XT(g.text,g.styles,t)+S;var M=XT(g.text.join(" ").split(/[^\S\u00A0]+/),g.styles,t);g.minReadableWidth=M+g.padding("horizontal"),"number"==typeof g.styles.cellWidth?(g.minWidth=g.styles.cellWidth,g.wrappedWidth=g.styles.cellWidth):"wrap"===g.styles.cellWidth||!0===n?g.contentWidth>r?(g.minWidth=r,g.wrappedWidth=r):(g.minWidth=g.contentWidth,g.wrappedWidth=g.contentWidth):(g.minWidth=g.styles.minCellWidth||10/e,g.wrappedWidth=g.contentWidth,g.minWidth>g.wrappedWidth&&(g.wrappedWidth=g.minWidth))}}}),i.allRows().forEach(function(o){for(var c=0,u=i.columns;c<u.length;c++){var m=u[c],g=o.cells[m.index];if(g&&1===g.colSpan)m.wrappedWidth=Math.max(m.wrappedWidth,g.wrappedWidth),m.minWidth=Math.max(m.minWidth,g.minWidth),m.minReadableWidth=Math.max(m.minReadableWidth,g.minReadableWidth);else{var x=i.styles.columnStyles[m.dataKey]||i.styles.columnStyles[m.index]||{},S=x.cellWidth||x.minCellWidth;S&&"number"==typeof S&&(m.minWidth=S,m.wrappedWidth=S)}g&&(g.colSpan>1&&!m.minWidth&&(m.minWidth=g.minWidth),g.colSpan>1&&!m.wrappedWidth&&(m.wrappedWidth=g.minWidth))}})}(t,i);var e=[],n=0;i.columns.forEach(function(o){var c=o.getMaxCustomCellWidth(i);c?o.width=c:(o.width=o.wrappedWidth,e.push(o)),n+=o.width});var r=i.getWidth(t.pageSize().width)-n;r&&(r=nM(e,r,function(o){return Math.max(o.minReadableWidth,o.minWidth)})),r&&(r=nM(e,r,function(o){return o.minWidth})),r=Math.abs(r),!i.settings.horizontalPageBreak&&r>.1/t.scaleFactor()&&(r=r<1?r:Math.round(r),console.warn("Of the table content, ".concat(r," units width could not fit page"))),function lZ(t){for(var i=t.allRows(),e=0;e<i.length;e++)for(var n=i[e],r=null,o=0,c=0,u=0;u<t.columns.length;u++){var m=t.columns[u];if((c-=1)>1&&t.columns[u+1])o+=m.width,delete n.cells[m.index];else if(r){var g=r;delete n.cells[m.index],r=null,g.width=m.width+o}else{if(!(g=n.cells[m.index]))continue;if(c=g.colSpan,o=0,g.colSpan>1){r=g,o+=m.width;continue}g.width=m.width+o}}}(i),function cZ(t,i){for(var e={count:0,height:0},n=0,r=t.allRows();n<r.length;n++){for(var o=r[n],c=0,u=t.columns;c<u.length;c++){var g=o.cells[u[c].index];if(g){i.applyStyles(g.styles,!0);var x=g.width-g.padding("horizontal");if("linebreak"===g.styles.overflow)g.text=i.splitTextToSize(g.text,x+1/i.scaleFactor(),{fontSize:g.styles.fontSize});else if("ellipsize"===g.styles.overflow)g.text=C7(g.text,x,g.styles,i,"...");else if("hidden"===g.styles.overflow)g.text=C7(g.text,x,g.styles,i,"");else if("function"==typeof g.styles.overflow){var S=g.styles.overflow(g.text,x);g.text="string"==typeof S?[S]:S}g.contentHeight=g.getContentHeight(i.scaleFactor(),i.getLineHeightFactor());var M=g.contentHeight/g.rowSpan;g.rowSpan>1&&e.count*e.height<M*g.rowSpan?e={height:M,count:g.rowSpan}:e&&e.count>0&&e.height>M&&(M=e.height),M>o.height&&(o.height=M)}}e.count--}}(i,t),function aZ(t){for(var i={},e=1,n=t.allRows(),r=0;r<n.length;r++)for(var o=n[r],c=0,u=t.columns;c<u.length;c++){var m=u[c],g=i[m.index];if(e>1)e--,delete o.cells[m.index];else if(g)g.cell.height+=o.height,e=g.cell.colSpan,delete o.cells[m.index],g.left--,g.left<=1&&delete i[m.index];else{var x=o.cells[m.index];if(!x)continue;if(x.height=o.height,x.rowSpan>1){var S=n.length-r;i[m.index]={cell:x,left:x.rowSpan>S?S:x.rowSpan,row:o}}}}}(i)}(e,r),e.applyStyles(e.userStyles),r}function rM(t,i,e,n,r,o){var c={};return i.map(function(m,g){for(var x=0,S={},M=0,E=0,R=0,B=e;R<B.length;R++){var K=B[R];if(null==c[K.index]||0===c[K.index].left)if(0===E){var q,Y={};"object"==typeof(q=Array.isArray(m)?m[K.index-M-x]:m[K.dataKey])&&!Array.isArray(q)&&(Y=(null==q?void 0:q.styles)||{});var ce=hZ(t,K,g,r,n,o,Y),De=new w7(q,ce,t);S[K.dataKey]=De,S[K.index]=De,c[K.index]={left:De.rowSpan-1,times:E=De.colSpan-1}}else E--,M++;else c[K.index].left--,E=c[K.index].times,x++}return new x7(m,g,t,S)})}function T7(t,i){var e={};return t.forEach(function(n){if(null!=n.raw){var r=function fZ(t,i){if("head"===t){if("object"==typeof i)return i.header||null;if("string"==typeof i||"number"==typeof i)return i}else if("foot"===t&&"object"==typeof i)return i.footer;return null}(i,n.raw);null!=r&&(e[n.dataKey]=r)}}),Object.keys(e).length>0?e:null}function hZ(t,i,e,n,r,o,c){var m,u=function zJ(t){return{striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}}[t]}(n);"head"===t?m=r.headStyles:"body"===t?m=r.bodyStyles:"foot"===t&&(m=r.footStyles);var g=bf({},u.table,u[t],r.styles,m),S="body"===t&&(r.columnStyles[i.dataKey]||r.columnStyles[i.index])||{},M="body"===t&&e%2==0?bf({},u.alternateRow,r.alternateRowStyles):{},E=function HJ(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}(o),R=bf({},E,g,M,S);return bf(R,c)}function mZ(t,i,e){var n;void 0===e&&(e={});var r=v7(t,i),o=new Map,c=[],u=[],m=[];Array.isArray(i.settings.horizontalPageBreakRepeat)?m=i.settings.horizontalPageBreakRepeat:("string"==typeof i.settings.horizontalPageBreakRepeat||"number"==typeof i.settings.horizontalPageBreakRepeat)&&(m=[i.settings.horizontalPageBreakRepeat]),m.forEach(function(M){var E=i.columns.find(function(R){return R.dataKey===M||R.index===M});E&&!o.has(E.index)&&(o.set(E.index,!0),c.push(E.index),u.push(i.columns[E.index]),r-=E.wrappedWidth)});for(var g=!0,x=null!==(n=null==e?void 0:e.start)&&void 0!==n?n:0;x<i.columns.length;)if(o.has(x))x++;else{var S=i.columns[x].wrappedWidth;if(!(g||r>=S))break;g=!1,c.push(x),u.push(i.columns[x]),r-=S,x++}return{colIndexes:c,columns:u,lastIndex:x-1}}function oM(t,i){var e=i.settings,n=e.startY,r=e.margin,o={x:r.left,y:n},c=i.getHeadHeight(i.columns)+i.getFootHeight(i.columns),u=n+r.bottom+c;"avoid"===e.pageBreak&&(u+=i.body.reduce(function(M,E){return M+E.height},0));var x=new t_(t);("always"===e.pageBreak||null!=e.startY&&u>x.pageSize().height)&&(D7(x),o.y=r.top),i.callWillDrawPageHooks(x,o);var S=bf({},o);i.startPageNumber=x.pageNumber(),e.horizontalPageBreak?function _Z(t,i,e,n){var r=function gZ(t,i){for(var e=[],n=0;n<i.columns.length;n++){var r=mZ(t,i,{start:n});r.columns.length&&(e.push(r),n=r.lastIndex)}return e}(t,i);if("afterAllRows"===i.settings.horizontalPageBreakBehaviour)r.forEach(function(g,x){t.applyStyles(t.userStyles),x>0?eb(t,i,e,n,g.columns,!0):S7(t,i,n,g.columns),function vZ(t,i,e,n,r){t.applyStyles(t.userStyles),i.body.forEach(function(o,c){JT(t,i,o,c===i.body.length-1,e,n,r)})}(t,i,e,n,g.columns),sM(t,i,n,g.columns)});else for(var c=-1,u=r[0],m=function(){var g=c;if(u){t.applyStyles(t.userStyles);var x=u.columns;c>=0?eb(t,i,e,n,x,!0):S7(t,i,n,x),g=E7(t,i,c+1,n,x),sM(t,i,n,x)}var S=g-c;r.slice(1).forEach(function(M){t.applyStyles(t.userStyles),eb(t,i,e,n,M.columns,!0),E7(t,i,c+1,n,M.columns,S),sM(t,i,n,M.columns)}),c=g};c<i.body.length-1;)m()}(x,i,S,o):(x.applyStyles(x.userStyles),("firstPage"===e.showHead||"everyPage"===e.showHead)&&i.head.forEach(function(M){return xf(x,i,M,o,i.columns)}),x.applyStyles(x.userStyles),i.body.forEach(function(M,E){JT(x,i,M,E===i.body.length-1,S,o,i.columns)}),x.applyStyles(x.userStyles),("lastPage"===e.showFoot||"everyPage"===e.showFoot)&&i.foot.forEach(function(M){return xf(x,i,M,o,i.columns)})),g7(x,i,S,o),i.callEndPageHooks(x,o),i.finalY=o.y,t.lastAutoTable=i,x.applyStyles(x.userStyles)}function S7(t,i,e,n){var r=i.settings;t.applyStyles(t.userStyles),("firstPage"===r.showHead||"everyPage"===r.showHead)&&i.head.forEach(function(o){return xf(t,i,o,e,n)})}function E7(t,i,e,n,r,o){t.applyStyles(t.userStyles),o=null!=o?o:i.body.length;var c=Math.min(e+o,i.body.length),u=-1;return i.body.slice(e,c).forEach(function(m,g){var S=k7(t,i,e+g===i.body.length-1,n);m.canEntireRowFit(S,r)&&(xf(t,i,m,n,r),u=e+g)}),u}function sM(t,i,e,n){var r=i.settings;t.applyStyles(t.userStyles),("lastPage"===r.showFoot||"everyPage"===r.showFoot)&&i.foot.forEach(function(o){return xf(t,i,o,e,n)})}function yZ(t,i,e){var n=e.getLineHeight(t.styles.fontSize),r=t.padding("vertical"),o=Math.floor((i-r)/n);return Math.max(0,o)}function JT(t,i,e,n,r,o,c){var u=k7(t,i,n,o);if(e.canEntireRowFit(u,c))xf(t,i,e,o,c);else if(function xZ(t,i,e,n){var r=t.pageSize().height,o=n.settings.margin,u=r-(o.top+o.bottom);"body"===i.section&&(u-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var m=i.getMinimumRowHeight(n.columns,t),g=m<e;if(m>u)return console.error("Will not be able to print row ".concat(i.index," correctly since it's minimum height is larger than page height")),!0;if(!g)return!1;var x=i.hasRowSpan(n.columns);return i.getMaxCellHeight(n.columns)>u?(x&&console.error("The content of row ".concat(i.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(x||"avoid"===n.settings.rowPageBreak)}(t,e,u,i)){var m=function bZ(t,i,e,n){var r={};t.spansMultiplePages=!0,t.height=0;for(var o=0,c=0,u=e.columns;c<u.length;c++)if(g=t.cells[(m=u[c]).index]){Array.isArray(g.text)||(g.text=[g.text]),(x=bf(x=new w7(g.raw,g.styles,g.section),g)).text=[];var S=yZ(g,i,n);g.text.length>S&&(x.text=g.text.splice(S,g.text.length));var M=n.scaleFactor(),E=n.getLineHeightFactor();g.contentHeight=g.getContentHeight(M,E),g.contentHeight>=i&&(g.contentHeight=i,x.styles.minCellHeight-=i),g.contentHeight>t.height&&(t.height=g.contentHeight),x.contentHeight=x.getContentHeight(M,E),x.contentHeight>o&&(o=x.contentHeight),r[m.index]=x}var R=new x7(t.raw,-1,t.section,r,!0);R.height=o;for(var B=0,K=e.columns;B<K.length;B++){var m,x,g;(x=R.cells[(m=K[B]).index])&&(x.height=R.height),(g=t.cells[m.index])&&(g.height=t.height)}return R}(e,u,i,t);xf(t,i,e,o,c),eb(t,i,r,o,c),JT(t,i,m,n,r,o,c)}else eb(t,i,r,o,c),JT(t,i,e,n,r,o,c)}function xf(t,i,e,n,r){n.x=i.settings.margin.left;for(var o=0,c=r;o<c.length;o++){var u=c[o],m=e.cells[u.index];if(m)if(t.applyStyles(m.styles),m.x=n.x,m.y=n.y,!1!==i.callCellHooks(t,i.hooks.willDrawCell,m,e,u,n)){wZ(t,m,n);var x=m.getTextPos();f7(m.text,x.x,x.y,{halign:m.styles.halign,valign:m.styles.valign,maxWidth:Math.ceil(m.width-m.padding("left")-m.padding("right"))},t.getDocument()),i.callCellHooks(t,i.hooks.didDrawCell,m,e,u,n),n.x+=u.width}else n.x+=u.width;else n.x+=u.width}n.y+=e.height}function wZ(t,i,e){var n=i.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),"number"==typeof n.lineWidth){var r=_7(n.lineWidth,n.fillColor);r&&t.rect(i.x,e.y,i.width,i.height,r)}else"object"==typeof n.lineWidth&&(n.fillColor&&t.rect(i.x,e.y,i.width,i.height,"F"),function CZ(t,i,e,n){var r,o,c,u;function m(g,x,S,M,E){t.getDocument().setLineWidth(g),t.getDocument().line(x,S,M,E,"S")}n.top&&(r=e.x,c=e.x+i.width,n.right&&(c+=.5*n.right),n.left&&(r-=.5*n.left),m(n.top,r,o=e.y,c,u=e.y)),n.bottom&&(r=e.x,c=e.x+i.width,n.right&&(c+=.5*n.right),n.left&&(r-=.5*n.left),m(n.bottom,r,o=e.y+i.height,c,u=e.y+i.height)),n.left&&(o=e.y,u=e.y+i.height,n.top&&(o-=.5*n.top),n.bottom&&(u+=.5*n.bottom),m(n.left,r=e.x,o,c=e.x,u)),n.right&&(o=e.y,u=e.y+i.height,n.top&&(o-=.5*n.top),n.bottom&&(u+=.5*n.bottom),m(n.right,r=e.x+i.width,o,c=e.x+i.width,u))}(t,i,e,n.lineWidth))}function k7(t,i,e,n){var r=i.settings.margin.bottom,o=i.settings.showFoot;return("everyPage"===o||"lastPage"===o&&e)&&(r+=i.getFootHeight(i.columns)),t.pageSize().height-n.y-r}function eb(t,i,e,n,r,o){void 0===r&&(r=[]),void 0===o&&(o=!1),t.applyStyles(t.userStyles),"everyPage"===i.settings.showFoot&&!o&&i.foot.forEach(function(u){return xf(t,i,u,n,r)}),i.callEndPageHooks(t,n);var c=i.settings.margin;g7(t,i,e,n),D7(t),i.pageNumber++,n.x=c.left,n.y=c.top,e.y=c.top,i.callWillDrawPageHooks(t,n),"everyPage"===i.settings.showHead&&(i.head.forEach(function(u){return xf(t,i,u,n,r)}),t.applyStyles(t.userStyles))}function D7(t){var i=t.pageNumber();return t.setPage(i+1),t.pageNumber()===i&&(t.addPage(),!0)}try{if("undefined"!=typeof window&&window){var I7=window,A7=I7.jsPDF||(null===(aM=I7.jspdf)||void 0===aM?void 0:aM.jsPDF);A7&&function TZ(t){t.API.autoTable=function(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];return oM(this,iM(this,eM(this,i[0]))),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(i,e,n,r){f7(i,e,n,r,this)},t.API.autoTableSetDefaults=function(i){return t_.setDefaults(i,this),this},t.autoTableSetDefaults=function(i,e){t_.setDefaults(i,e)},t.API.autoTableHtmlToJson=function(i,e){var n;if(void 0===e&&(e=!1),"undefined"==typeof window)return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var o=b7(new t_(this),i,window,e,!1),u=o.body;return{columns:(null===(n=o.head[0])||void 0===n?void 0:n.map(function(g){return g.content}))||[],rows:u,data:u}}}(A7)}}catch(t){console.error("Could not apply autoTable plugin",t)}let hs=(()=>{class t{constructor(){}generatePdf(e,n,r,o){const c=new UJ("l","mm","a4");(function SZ(t,i){oM(t,iM(t,eM(t,i)))})(c,{head:[e],body:n,foot:r,didDrawCell:u=>{}}),c.save(o+".pdf")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var EZ=vo(4327),n_=vo(574);let Ko=(()=>{class t{constructor(){}exportExcel(e,n,r,o){const c=[...e,...r];Array.isArray(c)&&c.length>0?Promise.resolve().then(vo.bind(vo,574)).then(u=>{const m=n_.utils.json_to_sheet(c);if(m["!ref"]){const S=n_.utils.decode_range(m["!ref"]);for(let M=S.s.c;M<=S.e.c;++M){const R=m[n_.utils.encode_cell({r:0,c:M})];R&&"s"===R.t&&(R.v=void 0,R.t=void 0)}}const x=u.write({Sheets:{data:m},SheetNames:["data"]},{bookType:"xlsx",type:"array"});this.saveAsExcelFile(x,o)}):console.error("Invalid data: The data is either not an array or empty.")}prepareDataForExport(e){return e.length>0&&"object"==typeof e[0]?e.map(n=>{const r={};for(const o in n)/^\d+$/.test(o)||(r[o]=n[o]);return r}):[]}saveAsExcelFile(e,n){const c=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});EZ.saveAs(c,n+".xlsx")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function kZ(t,i){1&t&&Jn(0)}function DZ(t,i){if(1&t&&(ni(0),D(1,kZ,1,0,"ng-container",3),Si()),2&t){const e=A(2);v(1),T("ngTemplateOutlet",e.contentTemplate)}}function IZ(t,i){if(1&t&&(f(0,"div",1),Sl(1),D(2,DZ,2,1,"ng-container",2),p()),2&t){const e=A();T("hidden",!e.selected),Ai("id",e.id)("aria-hidden",!e.selected)("aria-labelledby",e.id+"-label"),v(2),T("ngIf",e.contentTemplate&&(e.cache?e.loaded:e.selected))}}const M7=["*"],AZ=["content"],MZ=["navbar"],FZ=["prevBtn"],PZ=["nextBtn"],OZ=["inkbar"];function NZ(t,i){if(1&t){const e=Ie();f(0,"button",12,13),L("click",function(){return z(e),A().navBackward()}),ee(2,"span",14),p()}}function LZ(t,i){1&t&&ee(0,"span",24),2&t&&T("ngClass",A(3).$implicit.leftIcon)}function RZ(t,i){1&t&&ee(0,"span",25),2&t&&T("ngClass",A(3).$implicit.rightIcon)}function BZ(t,i){if(1&t&&(ni(0),D(1,LZ,1,1,"span",21),f(2,"span",22),_(3),p(),D(4,RZ,1,1,"span",23),Si()),2&t){const e=A(2).$implicit;v(1),T("ngIf",e.leftIcon),v(2),U(e.header),v(1),T("ngIf",e.rightIcon)}}function jZ(t,i){1&t&&Jn(0)}function VZ(t,i){if(1&t){const e=Ie();f(0,"span",26),L("click",function(r){z(e);const o=A(2).$implicit;return A().close(r,o)}),p()}}const UZ=function(t,i){return{"p-highlight":t,"p-disabled":i}};function HZ(t,i){if(1&t){const e=Ie();f(0,"li",16)(1,"a",17),L("click",function(r){z(e);const o=A().$implicit;return A().open(r,o)})("keydown.enter",function(r){z(e);const o=A().$implicit;return A().open(r,o)}),D(2,BZ,5,3,"ng-container",18),D(3,jZ,1,0,"ng-container",19),D(4,VZ,1,0,"span",20),p()()}if(2&t){const e=A().$implicit;Ji(e.headerStyleClass),T("ngClass",ia(16,UZ,e.selected,e.disabled))("ngStyle",e.headerStyle),v(1),T("pTooltip",e.tooltip)("tooltipPosition",e.tooltipPosition)("positionStyle",e.tooltipPositionStyle)("tooltipStyleClass",e.tooltipStyleClass),Ai("id",e.id+"-label")("aria-selected",e.selected)("aria-controls",e.id)("aria-selected",e.selected)("tabindex",e.disabled?null:"0"),v(1),T("ngIf",!e.headerTemplate),v(1),T("ngTemplateOutlet",e.headerTemplate),v(1),T("ngIf",e.closable)}}function zZ(t,i){1&t&&D(0,HZ,5,19,"li",15),2&t&&T("ngIf",!i.$implicit.closed)}function $Z(t,i){if(1&t){const e=Ie();f(0,"button",27,28),L("click",function(){return z(e),A().navForward()}),ee(2,"span",29),p()}}const WZ=function(t){return{"p-tabview p-component":!0,"p-tabview-scrollable":t}};let qZ=0,wf=(()=>{class t{constructor(e,n,r){this.viewContainer=n,this.cd=r,this.cache=!0,this.tooltipPosition="top",this.tooltipPositionStyle="absolute",this.id="p-tabpanel-"+qZ++,this.tabView=e}ngAfterContentInit(){this.templates.forEach(e=>{"header"===e.getType()?this.headerTemplate=e.template:this.contentTemplate=e.template})}get selected(){return this._selected}set selected(e){this._selected=e,this.loaded||this.cd.detectChanges(),e&&(this.loaded=!0)}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this.tabView.cd.markForCheck()}get header(){return this._header}set header(e){this._header=e,this.tabView.updateInkBar(),this.tabView.cd.markForCheck()}get leftIcon(){return this._leftIcon}set leftIcon(e){this._leftIcon=e,this.tabView.cd.markForCheck()}get rightIcon(){return this._rightIcon}set rightIcon(e){this._rightIcon=e,this.tabView.cd.markForCheck()}ngOnDestroy(){this.view=null}}return t.\u0275fac=function(e){return new(e||t)(te(tr(()=>Cf)),te(Al),te(Wo))},t.\u0275cmp=dn({type:t,selectors:[["p-tabPanel"]],contentQueries:function(e,n,r){if(1&e&&ol(r,zn,4),2&e){let o;xt(o=wt())&&(n.templates=o)}},hostAttrs:[1,"p-element"],inputs:{closable:"closable",headerStyle:"headerStyle",headerStyleClass:"headerStyleClass",cache:"cache",tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",selected:"selected",disabled:"disabled",header:"header",leftIcon:"leftIcon",rightIcon:"rightIcon"},ngContentSelectors:M7,decls:1,vars:1,consts:[["class","p-tabview-panel","role","tabpanel",3,"hidden",4,"ngIf"],["role","tabpanel",1,"p-tabview-panel",3,"hidden"],[4,"ngIf"],[4,"ngTemplateOutlet"]],template:function(e,n){1&e&&(mu(),D(0,IZ,3,5,"div",0)),2&e&&T("ngIf",!n.closed)},directives:[Sn,ic],encapsulation:2}),t})(),Cf=(()=>{class t{constructor(e,n){this.el=e,this.cd=n,this.orientation="top",this.onChange=new Et,this.onClose=new Et,this.activeIndexChange=new Et,this.backwardIsDisabled=!0,this.forwardIsDisabled=!1}ngAfterContentInit(){this.initTabs(),this.tabPanels.changes.subscribe(e=>{this.initTabs()})}ngAfterViewChecked(){this.tabChanged&&(this.updateInkBar(),this.tabChanged=!1)}initTabs(){this.tabs=this.tabPanels.toArray(),!this.findSelectedTab()&&this.tabs.length&&(null!=this.activeIndex&&this.tabs.length>this.activeIndex?this.tabs[this.activeIndex].selected=!0:this.tabs[0].selected=!0,this.tabChanged=!0),this.cd.markForCheck()}open(e,n){if(n.disabled)e&&e.preventDefault();else{if(!n.selected){let r=this.findSelectedTab();r&&(r.selected=!1),this.tabChanged=!0,n.selected=!0;let o=this.findTabIndex(n);this.preventActiveIndexPropagation=!0,this.activeIndexChange.emit(o),this.onChange.emit({originalEvent:e,index:o}),this.updateScrollBar(o)}e&&e.preventDefault()}}close(e,n){this.controlClose?this.onClose.emit({originalEvent:e,index:this.findTabIndex(n),close:()=>{this.closeTab(n)}}):(this.closeTab(n),this.onClose.emit({originalEvent:e,index:this.findTabIndex(n)})),e.stopPropagation()}closeTab(e){if(!e.disabled){if(e.selected){this.tabChanged=!0,e.selected=!1;for(let n=0;n<this.tabs.length;n++){let r=this.tabs[n];if(!r.closed&&!e.disabled){r.selected=!0;break}}}e.closed=!0}}findSelectedTab(){for(let e=0;e<this.tabs.length;e++)if(this.tabs[e].selected)return this.tabs[e];return null}findTabIndex(e){let n=-1;for(let r=0;r<this.tabs.length;r++)if(this.tabs[r]==e){n=r;break}return n}getBlockableElement(){return this.el.nativeElement.children[0]}get activeIndex(){return this._activeIndex}set activeIndex(e){this._activeIndex=e,this.preventActiveIndexPropagation?this.preventActiveIndexPropagation=!1:this.tabs&&this.tabs.length&&null!=this._activeIndex&&this.tabs.length>this._activeIndex&&(this.findSelectedTab().selected=!1,this.tabs[this._activeIndex].selected=!0,this.tabChanged=!0,this.updateScrollBar(e))}updateInkBar(){if(this.navbar){let e=We.findSingle(this.navbar.nativeElement,"li.p-highlight");this.inkbar.nativeElement.style.width=We.getWidth(e)+"px",this.inkbar.nativeElement.style.left=We.getOffset(e).left-We.getOffset(this.navbar.nativeElement).left+"px"}}updateScrollBar(e){this.navbar.nativeElement.children[e].scrollIntoView({block:"nearest"})}updateButtonState(){const e=this.content.nativeElement,{scrollLeft:n,scrollWidth:r}=e,o=We.getWidth(e);this.backwardIsDisabled=0===n,this.forwardIsDisabled=parseInt(n)===r-o}onScroll(e){this.scrollable&&this.updateButtonState(),e.preventDefault()}getVisibleButtonWidths(){var e,n;return[null===(e=this.prevBtn)||void 0===e?void 0:e.nativeElement,null===(n=this.nextBtn)||void 0===n?void 0:n.nativeElement].reduce((r,o)=>o?r+We.getWidth(o):r,0)}navBackward(){const e=this.content.nativeElement,n=We.getWidth(e)-this.getVisibleButtonWidths(),r=e.scrollLeft-n;e.scrollLeft=r<=0?0:r}navForward(){const e=this.content.nativeElement,n=We.getWidth(e)-this.getVisibleButtonWidths(),r=e.scrollLeft+n,o=e.scrollWidth-n;e.scrollLeft=r>=o?o:r}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(Wo))},t.\u0275cmp=dn({type:t,selectors:[["p-tabView"]],contentQueries:function(e,n,r){if(1&e&&ol(r,wf,4),2&e){let o;xt(o=wt())&&(n.tabPanels=o)}},viewQuery:function(e,n){if(1&e&&(Mt(AZ,5),Mt(MZ,5),Mt(FZ,5),Mt(PZ,5),Mt(OZ,5)),2&e){let r;xt(r=wt())&&(n.content=r.first),xt(r=wt())&&(n.navbar=r.first),xt(r=wt())&&(n.prevBtn=r.first),xt(r=wt())&&(n.nextBtn=r.first),xt(r=wt())&&(n.inkbar=r.first)}},hostAttrs:[1,"p-element"],inputs:{orientation:"orientation",style:"style",styleClass:"styleClass",controlClose:"controlClose",scrollable:"scrollable",activeIndex:"activeIndex"},outputs:{onChange:"onChange",onClose:"onClose",activeIndexChange:"activeIndexChange"},ngContentSelectors:M7,decls:13,vars:9,consts:[[3,"ngClass","ngStyle"],[1,"p-tabview-nav-container"],["class","p-tabview-nav-prev p-tabview-nav-btn p-link","type","button","pRipple","",3,"click",4,"ngIf"],[1,"p-tabview-nav-content",3,"scroll"],["content",""],["role","tablist",1,"p-tabview-nav"],["navbar",""],["ngFor","",3,"ngForOf"],[1,"p-tabview-ink-bar"],["inkbar",""],["class","p-tabview-nav-next p-tabview-nav-btn p-link","type","button","pRipple","",3,"click",4,"ngIf"],[1,"p-tabview-panels"],["type","button","pRipple","",1,"p-tabview-nav-prev","p-tabview-nav-btn","p-link",3,"click"],["prevBtn",""],[1,"pi","pi-chevron-left"],["role","presentation",3,"ngClass","ngStyle","class",4,"ngIf"],["role","presentation",3,"ngClass","ngStyle"],["role","tab","pRipple","",1,"p-tabview-nav-link",3,"pTooltip","tooltipPosition","positionStyle","tooltipStyleClass","click","keydown.enter"],[4,"ngIf"],[4,"ngTemplateOutlet"],["class","p-tabview-close pi pi-times",3,"click",4,"ngIf"],["class","p-tabview-left-icon",3,"ngClass",4,"ngIf"],[1,"p-tabview-title"],["class","p-tabview-right-icon",3,"ngClass",4,"ngIf"],[1,"p-tabview-left-icon",3,"ngClass"],[1,"p-tabview-right-icon",3,"ngClass"],[1,"p-tabview-close","pi","pi-times",3,"click"],["type","button","pRipple","",1,"p-tabview-nav-next","p-tabview-nav-btn","p-link",3,"click"],["nextBtn",""],[1,"pi","pi-chevron-right"]],template:function(e,n){1&e&&(mu(),f(0,"div",0)(1,"div",1),D(2,NZ,3,0,"button",2),f(3,"div",3,4),L("scroll",function(o){return n.onScroll(o)}),f(5,"ul",5,6),D(7,zZ,1,1,"ng-template",7),ee(8,"li",8,9),p()(),D(10,$Z,3,0,"button",10),p(),f(11,"div",11),Sl(12),p()()),2&e&&(Ji(n.styleClass),T("ngClass",Ei(7,WZ,n.scrollable))("ngStyle",n.style),v(2),T("ngIf",n.scrollable&&!n.backwardIsDisabled),v(5),T("ngForOf",n.tabs),v(3),T("ngIf",n.scrollable&&!n.forwardIsDisabled))},directives:[Na,La,Sn,Vp,nc,qL,ic],styles:[".p-tabview-nav-container{position:relative}.p-tabview-scrollable .p-tabview-nav-container{overflow:hidden}.p-tabview-nav-content{overflow-x:auto;overflow-y:hidden;scroll-behavior:smooth;scrollbar-width:none;overscroll-behavior:contain auto}.p-tabview-nav{display:flex;margin:0;padding:0;list-style-type:none;flex:1 1 auto}.p-tabview-nav-link{cursor:pointer;-webkit-user-select:none;user-select:none;display:flex;align-items:center;position:relative;text-decoration:none;overflow:hidden}.p-tabview-ink-bar{display:none;z-index:1}.p-tabview-nav-link:focus{z-index:1}.p-tabview-title{line-height:1;white-space:nowrap}.p-tabview-nav-btn{position:absolute;top:0;z-index:2;height:100%;display:flex;align-items:center;justify-content:center}.p-tabview-nav-prev{left:0}.p-tabview-nav-next{right:0}.p-tabview-nav-content::-webkit-scrollbar{display:none}.p-tabview-close{z-index:1}\n"],encapsulation:2,changeDetection:0}),t})(),F7=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro,Uc,GL,_f],Uc]}),t})(),GZ=(()=>{class t{constructor(e){this.el=e}onkeydown(e){if(!0!==this.pFocusTrapDisabled){e.preventDefault();let n=We.getFocusableElements(this.el.nativeElement);if(n&&n.length>0)if(n[0].ownerDocument.activeElement){let r=n.indexOf(n[0].ownerDocument.activeElement);e.shiftKey?-1==r||0===r?n[n.length-1].focus():n[r-1].focus():-1==r||r===n.length-1?n[0].focus():n[r+1].focus()}else n[0].focus()}}}return t.\u0275fac=function(e){return new(e||t)(te(mr))},t.\u0275dir=Ln({type:t,selectors:[["","pFocusTrap",""]],hostAttrs:[1,"p-element"],hostBindings:function(e,n){1&e&&L("keydown.tab",function(o){return n.onkeydown(o)})("keydown.shift.tab",function(o){return n.onkeydown(o)})},inputs:{pFocusTrapDisabled:"pFocusTrapDisabled"}}),t})(),KZ=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro]]}),t})();const YZ=["titlebar"],XZ=["content"],QZ=["footer"];function JZ(t,i){if(1&t&&(f(0,"span",17),_(1),p()),2&t){const e=A(4);Ai("id",e.id+"-label"),v(1),U(e.header)}}function ZZ(t,i){1&t&&(f(0,"span",17),Sl(1,1),p()),2&t&&Ai("id",A(4).id+"-label")}function eee(t,i){1&t&&Jn(0)}const tee=function(){return{"p-dialog-header-icon p-dialog-header-maximize p-link":!0}};function nee(t,i){if(1&t){const e=Ie();f(0,"button",18),L("click",function(){return z(e),A(4).maximize()})("keydown.enter",function(){return z(e),A(4).maximize()}),ee(1,"span",19),p()}if(2&t){const e=A(4);T("ngClass",rt(2,tee)),v(1),T("ngClass",e.maximized?e.minimizeIcon:e.maximizeIcon)}}const iee=function(){return{"p-dialog-header-icon p-dialog-header-close p-link":!0}};function ree(t,i){if(1&t){const e=Ie();f(0,"button",20),L("click",function(r){return z(e),A(4).close(r)})("keydown.enter",function(r){return z(e),A(4).close(r)}),ee(1,"span",21),p()}if(2&t){const e=A(4);T("ngClass",rt(4,iee)),Ai("aria-label",e.closeAriaLabel)("tabindex",e.closeTabindex),v(1),T("ngClass",e.closeIcon)}}function oee(t,i){if(1&t){const e=Ie();f(0,"div",11,12),L("mousedown",function(r){return z(e),A(3).initDrag(r)}),D(2,JZ,2,2,"span",13),D(3,ZZ,2,1,"span",13),D(4,eee,1,0,"ng-container",8),f(5,"div",14),D(6,nee,2,3,"button",15),D(7,ree,2,5,"button",16),p()()}if(2&t){const e=A(3);v(2),T("ngIf",!e.headerFacet&&!e.headerTemplate),v(1),T("ngIf",e.headerFacet),v(1),T("ngTemplateOutlet",e.headerTemplate),v(2),T("ngIf",e.maximizable),v(1),T("ngIf",e.closable)}}function see(t,i){1&t&&Jn(0)}function aee(t,i){1&t&&Jn(0)}function lee(t,i){if(1&t&&(f(0,"div",22,23),Sl(2,2),D(3,aee,1,0,"ng-container",8),p()),2&t){const e=A(3);v(3),T("ngTemplateOutlet",e.footerTemplate)}}function cee(t,i){if(1&t){const e=Ie();f(0,"div",24),L("mousedown",function(r){return z(e),A(3).initResize(r)}),p()}}const uee=function(t,i,e,n){return{"p-dialog p-component":!0,"p-dialog-rtl":t,"p-dialog-draggable":i,"p-dialog-resizable":e,"p-dialog-maximized":n}},dee=function(t,i){return{transform:t,transition:i}},fee=function(t){return{value:"visible",params:t}};function pee(t,i){if(1&t){const e=Ie();f(0,"div",3,4),L("@animation.start",function(r){return z(e),A(2).onAnimationStart(r)})("@animation.done",function(r){return z(e),A(2).onAnimationEnd(r)}),D(2,oee,8,5,"div",5),f(3,"div",6,7),Sl(5),D(6,see,1,0,"ng-container",8),p(),D(7,lee,4,1,"div",9),D(8,cee,1,0,"div",10),p()}if(2&t){const e=A(2);Ji(e.styleClass),T("ngClass",Dp(15,uee,e.rtl,e.draggable,e.resizable,e.maximized))("ngStyle",e.style)("pFocusTrapDisabled",!1===e.focusTrap)("@animation",Ei(23,fee,ia(20,dee,e.transformOptions,e.transitionOptions))),Ai("aria-labelledby",e.id+"-label"),v(2),T("ngIf",e.showHeader),v(1),Ji(e.contentStyleClass),T("ngClass","p-dialog-content")("ngStyle",e.contentStyle),v(3),T("ngTemplateOutlet",e.contentTemplate),v(1),T("ngIf",e.footerFacet||e.footerTemplate),v(1),T("ngIf",e.resizable)}}const hee=function(t,i,e,n,r,o,c,u,m,g){return{"p-dialog-mask":!0,"p-component-overlay p-component-overlay-enter":t,"p-dialog-mask-scrollblocker":i,"p-dialog-left":e,"p-dialog-right":n,"p-dialog-top":r,"p-dialog-top-left":o,"p-dialog-top-right":c,"p-dialog-bottom":u,"p-dialog-bottom-left":m,"p-dialog-bottom-right":g}};function mee(t,i){if(1&t&&(f(0,"div",1),D(1,pee,9,25,"div",2),p()),2&t){const e=A();Ji(e.maskStyleClass),T("ngClass",wD(4,hee,[e.modal,e.modal||e.blockScroll,"left"===e.position,"right"===e.position,"top"===e.position,"topleft"===e.position||"top-left"===e.position,"topright"===e.position||"top-right"===e.position,"bottom"===e.position,"bottomleft"===e.position||"bottom-left"===e.position,"bottomright"===e.position||"bottom-right"===e.position])),v(1),T("ngIf",e.visible)}}const gee=["*",[["p-header"]],[["p-footer"]]],_ee=["*","p-header","p-footer"],vee=L0([cs({transform:"{{transform}}",opacity:0}),Pl("{{transition}}")]),yee=L0([Pl("{{transition}}",cs({transform:"{{transform}}",opacity:0}))]);let ms=(()=>{class t{constructor(e,n,r,o,c){this.el=e,this.renderer=n,this.zone=r,this.cd=o,this.config=c,this.draggable=!0,this.resizable=!0,this.closeOnEscape=!0,this.closable=!0,this.showHeader=!0,this.blockScroll=!1,this.autoZIndex=!0,this.baseZIndex=0,this.minX=0,this.minY=0,this.focusOnShow=!0,this.keepInViewport=!0,this.focusTrap=!0,this.transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)",this.closeIcon="pi pi-times",this.closeTabindex="-1",this.minimizeIcon="pi pi-window-minimize",this.maximizeIcon="pi pi-window-maximize",this.onShow=new Et,this.onHide=new Et,this.visibleChange=new Et,this.onResizeInit=new Et,this.onResizeEnd=new Et,this.onDragEnd=new Et,this.onMaximize=new Et,this.id=N0(),this._style={},this._position="center",this.transformOptions="scale(0.7)"}get positionLeft(){return 0}set positionLeft(e){console.log("positionLeft property is deprecated.")}get positionTop(){return 0}set positionTop(e){console.log("positionTop property is deprecated.")}get responsive(){return!1}set responsive(e){console.log("Responsive property is deprecated.")}get breakpoint(){return 649}set breakpoint(e){console.log("Breakpoint property is not utilized and deprecated, use breakpoints or CSS media queries instead.")}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"header":this.headerTemplate=e.template;break;case"content":default:this.contentTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngOnInit(){this.breakpoints&&this.createStyle()}get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.maskVisible&&(this.maskVisible=!0)}get style(){return this._style}set style(e){e&&(this._style=Object.assign({},e),this.originalStyle=e)}get position(){return this._position}set position(e){switch(this._position=e,e){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}focus(){let e=We.findSingle(this.container,"[autofocus]");e&&this.zone.runOutsideAngular(()=>{setTimeout(()=>e.focus(),5)})}close(e){this.visibleChange.emit(!1),e.preventDefault()}enableModality(){this.closable&&this.dismissableMask&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",e=>{this.wrapper&&this.wrapper.isSameNode(e.target)&&this.close(e)})),this.modal&&We.addClass(document.body,"p-overflow-hidden")}disableModality(){this.wrapper&&(this.dismissableMask&&this.unbindMaskClickListener(),this.modal&&We.removeClass(document.body,"p-overflow-hidden"),this.cd.destroyed||this.cd.detectChanges())}maximize(){this.maximized=!this.maximized,!this.modal&&!this.blockScroll&&(this.maximized?We.addClass(document.body,"p-overflow-hidden"):We.removeClass(document.body,"p-overflow-hidden")),this.onMaximize.emit({maximized:this.maximized})}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}moveOnTop(){this.autoZIndex&&(ls.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}createStyle(){if(!this.styleElement){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement);let e="";for(let n in this.breakpoints)e+=`\n                    @media screen and (max-width: ${n}) {\n                        .p-dialog[${this.id}] {\n                            width: ${this.breakpoints[n]} !important;\n                        }\n                    }\n                `;this.styleElement.innerHTML=e}}initDrag(e){We.hasClass(e.target,"p-dialog-header-icon")||We.hasClass(e.target.parentElement,"p-dialog-header-icon")||this.draggable&&(this.dragging=!0,this.lastPageX=e.pageX,this.lastPageY=e.pageY,this.container.style.margin="0",We.addClass(document.body,"p-unselectable-text"))}onKeydown(e){if(this.focusTrap&&9===e.which){e.preventDefault();let n=We.getFocusableElements(this.container);if(n&&n.length>0)if(n[0].ownerDocument.activeElement){let r=n.indexOf(n[0].ownerDocument.activeElement);e.shiftKey?-1==r||0===r?n[n.length-1].focus():n[r-1].focus():-1==r||r===n.length-1?n[0].focus():n[r+1].focus()}else n[0].focus()}}onDrag(e){if(this.dragging){let n=We.getOuterWidth(this.container),r=We.getOuterHeight(this.container),o=e.pageX-this.lastPageX,c=e.pageY-this.lastPageY,u=this.container.getBoundingClientRect(),m=u.left+o,g=u.top+c,x=We.getViewport();this.container.style.position="fixed",this.keepInViewport?(m>=this.minX&&m+n<x.width&&(this._style.left=m+"px",this.lastPageX=e.pageX,this.container.style.left=m+"px"),g>=this.minY&&g+r<x.height&&(this._style.top=g+"px",this.lastPageY=e.pageY,this.container.style.top=g+"px")):(this.lastPageX=e.pageX,this.container.style.left=m+"px",this.lastPageY=e.pageY,this.container.style.top=g+"px")}}endDrag(e){this.dragging&&(this.dragging=!1,We.removeClass(document.body,"p-unselectable-text"),this.cd.detectChanges(),this.onDragEnd.emit(e))}resetPosition(){this.container.style.position="",this.container.style.left="",this.container.style.top="",this.container.style.margin=""}center(){this.resetPosition()}initResize(e){this.resizable&&(this.resizing=!0,this.lastPageX=e.pageX,this.lastPageY=e.pageY,We.addClass(document.body,"p-unselectable-text"),this.onResizeInit.emit(e))}onResize(e){if(this.resizing){let n=e.pageX-this.lastPageX,r=e.pageY-this.lastPageY,o=We.getOuterWidth(this.container),c=We.getOuterHeight(this.container),u=We.getOuterHeight(this.contentViewChild.nativeElement),m=o+n,g=c+r,x=this.container.style.minWidth,S=this.container.style.minHeight,M=this.container.getBoundingClientRect(),E=We.getViewport();(!parseInt(this.container.style.top)||!parseInt(this.container.style.left))&&(m+=n,g+=r),(!x||m>parseInt(x))&&M.left+m<E.width&&(this._style.width=m+"px",this.container.style.width=this._style.width),(!S||g>parseInt(S))&&M.top+g<E.height&&(this.contentViewChild.nativeElement.style.height=u+g-c+"px",this._style.height&&(this._style.height=g+"px",this.container.style.height=this._style.height)),this.lastPageX=e.pageX,this.lastPageY=e.pageY}}resizeEnd(e){this.resizing&&(this.resizing=!1,We.removeClass(document.body,"p-unselectable-text"),this.onResizeEnd.emit(e))}bindGlobalListeners(){this.draggable&&(this.bindDocumentDragListener(),this.bindDocumentDragEndListener()),this.resizable&&this.bindDocumentResizeListeners(),this.closeOnEscape&&this.closable&&this.bindDocumentEscapeListener()}unbindGlobalListeners(){this.unbindDocumentDragListener(),this.unbindDocumentDragEndListener(),this.unbindDocumentResizeListeners(),this.unbindDocumentEscapeListener()}bindDocumentDragListener(){this.zone.runOutsideAngular(()=>{this.documentDragListener=this.onDrag.bind(this),window.document.addEventListener("mousemove",this.documentDragListener)})}unbindDocumentDragListener(){this.documentDragListener&&(window.document.removeEventListener("mousemove",this.documentDragListener),this.documentDragListener=null)}bindDocumentDragEndListener(){this.zone.runOutsideAngular(()=>{this.documentDragEndListener=this.endDrag.bind(this),window.document.addEventListener("mouseup",this.documentDragEndListener)})}unbindDocumentDragEndListener(){this.documentDragEndListener&&(window.document.removeEventListener("mouseup",this.documentDragEndListener),this.documentDragEndListener=null)}bindDocumentResizeListeners(){this.zone.runOutsideAngular(()=>{this.documentResizeListener=this.onResize.bind(this),this.documentResizeEndListener=this.resizeEnd.bind(this),window.document.addEventListener("mousemove",this.documentResizeListener),window.document.addEventListener("mouseup",this.documentResizeEndListener)})}unbindDocumentResizeListeners(){this.documentResizeListener&&this.documentResizeEndListener&&(window.document.removeEventListener("mousemove",this.documentResizeListener),window.document.removeEventListener("mouseup",this.documentResizeEndListener),this.documentResizeListener=null,this.documentResizeEndListener=null)}bindDocumentEscapeListener(){this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",n=>{27==n.which&&this.close(n)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.wrapper):We.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.container&&this.appendTo&&this.el.nativeElement.appendChild(this.wrapper)}onAnimationStart(e){switch(e.toState){case"visible":this.container=e.element,this.wrapper=this.container.parentElement,this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.container.setAttribute(this.id,""),this.modal&&this.enableModality(),!this.modal&&this.blockScroll&&We.addClass(document.body,"p-overflow-hidden"),this.focusOnShow&&this.focus();break;case"void":this.wrapper&&this.modal&&We.addClass(this.wrapper,"p-component-overlay-leave")}}onAnimationEnd(e){switch(e.toState){case"void":this.onContainerDestroy(),this.onHide.emit({});break;case"visible":this.onShow.emit({})}}onContainerDestroy(){this.unbindGlobalListeners(),this.dragging=!1,this.maskVisible=!1,this.maximized&&(We.removeClass(document.body,"p-overflow-hidden"),this.maximized=!1),this.modal&&this.disableModality(),this.blockScroll&&We.removeClass(document.body,"p-overflow-hidden"),this.container&&this.autoZIndex&&ls.clear(this.container),this.container=null,this.wrapper=null,this._style=this.originalStyle?Object.assign({},this.originalStyle):{}}destroyStyle(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.container&&(this.restoreAppend(),this.onContainerDestroy()),this.destroyStyle()}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(Ss),te(gr),te(Wo),te(Bp))},t.\u0275cmp=dn({type:t,selectors:[["p-dialog"]],contentQueries:function(e,n,r){if(1&e&&(ol(r,HW,5),ol(r,wL,5),ol(r,zn,4)),2&e){let o;xt(o=wt())&&(n.headerFacet=o.first),xt(o=wt())&&(n.footerFacet=o.first),xt(o=wt())&&(n.templates=o)}},viewQuery:function(e,n){if(1&e&&(Mt(YZ,5),Mt(XZ,5),Mt(QZ,5)),2&e){let r;xt(r=wt())&&(n.headerViewChild=r.first),xt(r=wt())&&(n.contentViewChild=r.first),xt(r=wt())&&(n.footerViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",draggable:"draggable",resizable:"resizable",positionLeft:"positionLeft",positionTop:"positionTop",contentStyle:"contentStyle",contentStyleClass:"contentStyleClass",modal:"modal",closeOnEscape:"closeOnEscape",dismissableMask:"dismissableMask",rtl:"rtl",closable:"closable",responsive:"responsive",appendTo:"appendTo",breakpoints:"breakpoints",styleClass:"styleClass",maskStyleClass:"maskStyleClass",showHeader:"showHeader",breakpoint:"breakpoint",blockScroll:"blockScroll",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",minX:"minX",minY:"minY",focusOnShow:"focusOnShow",maximizable:"maximizable",keepInViewport:"keepInViewport",focusTrap:"focusTrap",transitionOptions:"transitionOptions",closeIcon:"closeIcon",closeAriaLabel:"closeAriaLabel",closeTabindex:"closeTabindex",minimizeIcon:"minimizeIcon",maximizeIcon:"maximizeIcon",visible:"visible",style:"style",position:"position"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange",onResizeInit:"onResizeInit",onResizeEnd:"onResizeEnd",onDragEnd:"onDragEnd",onMaximize:"onMaximize"},ngContentSelectors:_ee,decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","class","pFocusTrapDisabled",4,"ngIf"],["pFocusTrap","","role","dialog",3,"ngClass","ngStyle","pFocusTrapDisabled"],["container",""],["class","p-dialog-header",3,"mousedown",4,"ngIf"],[3,"ngClass","ngStyle"],["content",""],[4,"ngTemplateOutlet"],["class","p-dialog-footer",4,"ngIf"],["class","p-resizable-handle","style","z-index: 90;",3,"mousedown",4,"ngIf"],[1,"p-dialog-header",3,"mousedown"],["titlebar",""],["class","p-dialog-title",4,"ngIf"],[1,"p-dialog-header-icons"],["type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],["type","button","pRipple","",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title"],["type","button","tabindex","-1","pRipple","",3,"ngClass","click","keydown.enter"],[1,"p-dialog-header-maximize-icon",3,"ngClass"],["type","button","pRipple","",3,"ngClass","click","keydown.enter"],[1,"p-dialog-header-close-icon",3,"ngClass"],[1,"p-dialog-footer"],["footer",""],[1,"p-resizable-handle",2,"z-index","90",3,"mousedown"]],template:function(e,n){1&e&&(mu(gee),D(0,mee,2,15,"div",0)),2&e&&T("ngIf",n.maskVisible)},directives:[Sn,Na,GZ,La,ic,Vp],styles:[".p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translate(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0px!important;left:0px!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}\n"],encapsulation:2,data:{animation:[km("animation",[ul("void => visible",[R0(vee)]),ul("visible => void",[R0(yee)])])]},changeDetection:0}),t})(),lM=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro,KZ,_f],Uc]}),t})();const bee=["dt"];function xee(t,i){1&t&&(f(0,"small",15),_(1," Bank name is required. "),p())}function wee(t,i){1&t&&(f(0,"small",15),_(1," Title is required. "),p())}function Cee(t,i){1&t&&(f(0,"small",15),_(1," IBAN is required. "),p())}function Tee(t,i){1&t&&(f(0,"small",15),_(1," Currency is required. "),p())}function See(t,i){if(1&t){const e=Ie();f(0,"div",16)(1,"button",17),L("click",function(){z(e);const r=A();return r.addBankAccount(r.accountForm)}),ee(2,"i",18),_(3," Save "),p(),f(4,"button",19),L("click",function(){return z(e),A().closeModal()}),ee(5,"i",20),_(6," Cancel "),p()()}if(2&t){const e=A();v(1),T("disabled",e.accountForm.invalid)}}const Eee=function(){return{width:"20vw"}};let kee=(()=>{class t{constructor(e,n){this._ms=e,this._br=n,this.displayAddAccountModal=!1,this.clickClose=new Et,this.clickAdd=new Et}ngOnInit(){null==this.bankingaccount&&(this.bankingaccount={id:"",bank:"",title:"",iban:"",currency:""}),this.accountForm=new Zn({id:new Me(""),bank:new Me("",jt.required),title:new Me("",jt.required),iban:new Me("",jt.required),currency:new Me("",jt.required)})}closeModal(){this.clickClose.emit(!0)}hideAddAccountModal(e){this.displayAddAccountModal=!e}addBankAccount(e){this.bankingaccount.id?(e.value.id=this.bankingaccount.id,this._br.updateAccount(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Bank account updated successfully."}),this.clickAdd.emit(n),this.accountForm.reset(),this.closeModal()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while updating banking account."})}})):this._br.addAccount(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Bank account added successfully."}),this.clickAdd.emit(n),this.accountForm.reset(),this.closeModal()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while saving bank account."})}})}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(IA))},t.\u0275cmp=dn({type:t,selectors:[["app-addeditbankaccount"]],viewQuery:function(e,n){if(1&e&&Mt(bee,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{displayAddAccountModal:"displayAddAccountModal",bankingaccount:"bankingaccount",obj_transactiondate:"obj_transactiondate"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd"},decls:25,vars:17,consts:[["header","Bank Account",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[3,"formGroup"],[1,"p-fluid","grid","formgrid"],[1,"field","col-12","md:col-4"],["for","bank"],["pInputText","","type","text","id","bank","name","bank","formControlName","bank",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],["for","title"],["pInputText","","type","text","id","title","name","title","formControlName","title",3,"ngModel","ngModelChange"],["for","iban"],["pInputText","","type","text","id","iban","name","iban","formControlName","iban",3,"ngModel","ngModelChange"],["for","currency"],["pInputText","","type","text","id","currency","name","currency","formControlName","currency",3,"ngModel","ngModelChange"],["pTemplate","footer"],["position","bottom-right"],[1,"p-error","block"],[1,"project-btn-group","--center"],["icon","pi pi-check","type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["icon","pi pi-times","type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-circle"]],template:function(e,n){1&e&&(f(0,"p-dialog",0),L("visibleChange",function(o){return n.displayAddAccountModal=o})("onHide",function(){return n.closeModal()}),f(1,"form",1)(2,"div",2)(3,"div",3)(4,"label",4),_(5,"Bank"),p(),f(6,"input",5),L("ngModelChange",function(o){return n.bankingaccount.bank=o}),p(),D(7,xee,2,0,"small",6),p(),f(8,"div",3)(9,"label",7),_(10,"Account Title"),p(),f(11,"input",8),L("ngModelChange",function(o){return n.bankingaccount.title=o}),p(),D(12,wee,2,0,"small",6),p(),f(13,"div",3)(14,"label",9),_(15,"IBAN"),p(),f(16,"input",10),L("ngModelChange",function(o){return n.bankingaccount.iban=o}),p(),D(17,Cee,2,0,"small",6),p(),f(18,"div",3)(19,"label",11),_(20,"Currency"),p(),f(21,"input",12),L("ngModelChange",function(o){return n.bankingaccount.currency=o}),p(),D(22,Tee,2,0,"small",6),p()()(),D(23,See,7,1,"ng-template",13),p(),ee(24,"p-toast",14)),2&e&&(Ft(rt(16,Eee)),T("visible",n.displayAddAccountModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("formGroup",n.accountForm),v(5),T("ngModel",n.bankingaccount.bank),v(1),T("ngIf",n.accountForm.controls.bank.invalid&&n.accountForm.controls.bank.dirty),v(4),T("ngModel",n.bankingaccount.title),v(1),T("ngIf",n.accountForm.controls.title.invalid&&n.accountForm.controls.title.dirty),v(4),T("ngModel",n.bankingaccount.iban),v(1),T("ngIf",n.accountForm.controls.iban.invalid&&n.accountForm.controls.iban.dirty),v(4),T("ngModel",n.bankingaccount.currency),v(1),T("ngIf",n.accountForm.controls.currency.invalid&&n.accountForm.controls.currency.dirty))},directives:[ms,Hr,Ur,Pr,Ir,li,Er,zr,Sn,zn,fr],styles:[""]}),t})();const Dee=["dt"];function Iee(t,i){1&t&&(f(0,"small",17),_(1," Amount is required. "),p())}function Aee(t,i){if(1&t){const e=Ie();f(0,"div",18)(1,"button",19),L("click",function(){z(e);const r=A();return r.addBankingRecord(r.transactionForm)}),ee(2,"i",20),_(3," Save "),p(),f(4,"button",21),L("click",function(){return z(e),A().closeModal()}),ee(5,"i",22),_(6," Cancel "),p()()}if(2&t){const e=A();v(1),T("disabled",e.transactionForm.invalid)}}const Mee=function(){return{width:"35vw"}},Nm=function(){return{width:"200px"}};let Fee=(()=>{class t{constructor(e,n){this._ms=e,this._br=n,this.displayAddModal=!1,this.clickClose=new Et,this.clickAdd=new Et,this.accountID=0,this.types=[{name:"Credit",code:"CR"},{name:"Debit",code:"DB"}]}ngOnInit(){null==this.bankingrecord&&(this.bankingrecord={id:"",accountid:"",selectedType:"",transactiondate:"",description:"",credit:"",banlance:"",instrumentbank:"",instrumentno:"",transactiontype:""}),this.transactionForm=new Zn({id:new Me(""),accountid:new Me(""),transactiondate:new Me("",jt.required),selectedType:new Me(""),description:new Me(""),credit:new Me("",jt.required),instrumentbank:new Me(""),instrumentno:new Me(""),transactiontype:new Me("")})}closeModal(){this.clickClose.emit(!0)}hideAddModal(e){this.displayAddModal=!e}addBankingRecord(e){this.bankingrecord.id?(e.value.id=this.bankingrecord.id,e.value.accountid=this.accountID,this._br.updateBankingRecord(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Banking record updated successfully."}),this.clickAdd.emit(n),this.closeModal()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while updating banking record."})}})):(e.value.accountid=this.accountID,this._br.addBankingRecord(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Banking record added successfully."}),this.clickAdd.emit(n),this.transactionForm.reset()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while saving banking record."})}}))}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(IA))},t.\u0275cmp=dn({type:t,selectors:[["app-addeditbanking"]],viewQuery:function(e,n){if(1&e&&Mt(Dee,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{displayAddModal:"displayAddModal",bankingrecord:"bankingrecord",accountID:"accountID",obj_transactiondate:"obj_transactiondate"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd"},decls:41,vars:38,consts:[["header","Add Transaction",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[3,"formGroup"],[1,"p-fluid","grid","formgrid"],[1,"field","col-6","md:col-4",2,"display","flex"],[2,"flex","1"],[2,"margin-right","10px"],["id","transactiondate","name","transactiondate","formControlName","transactiondate","classs","form-control","dateFormat","dd-mm-yy","appendTo","body",3,"ngModel","inputStyle","ngModelChange"],[2,"flex","1","margin-left","5px"],["pInputText","","type","text","id","description","name","description","formControlName","description",3,"ngModel","ngModelChange"],["optionLabel","name","optionValue","code","formControlName","selectedType",3,"options","ngModel","ngModelChange"],["pInputText","","type","number","id","credit","name","credit","formControlName","credit",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],["pInputText","","type","text","id","instrumentbank","name","instrumentbank","formControlName","instrumentbank",3,"ngModel","ngModelChange"],["pInputText","","type","text","id","instrumentno","name","instrumentno","formControlName","instrumentno",3,"ngModel","ngModelChange"],["pInputText","","type","text","id","transactiontype","name","transactiontype","formControlName","transactiontype",3,"ngModel","ngModelChange"],["pTemplate","footer"],["position","bottom-right"],[1,"p-error","block"],[1,"project-btn-group","--center"],["icon","pi pi-check","type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["icon","pi pi-times","type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-circle"]],template:function(e,n){1&e&&(f(0,"p-dialog",0),L("visibleChange",function(o){return n.displayAddModal=o})("onHide",function(){return n.closeModal()}),f(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),_(6,"Transaction Date"),p(),f(7,"p-calendar",6),L("ngModelChange",function(o){return n.obj_transactiondate=o}),p()(),f(8,"div",7)(9,"label"),_(10,"Description"),p(),f(11,"input",8),L("ngModelChange",function(o){return n.bankingrecord.description=o}),p()()()(),f(12,"div",2)(13,"div",3)(14,"div",4)(15,"label"),_(16,"Select Transaction"),p(),f(17,"p-dropdown",9),L("ngModelChange",function(o){return n.bankingrecord.selectedType=o}),p()(),f(18,"div",7)(19,"label"),_(20,"Amount"),p(),f(21,"input",10),L("ngModelChange",function(o){return n.bankingrecord.credit=o}),p(),D(22,Iee,2,0,"small",11),p()()(),f(23,"div",2)(24,"div",3)(25,"div",4)(26,"label"),_(27,"Bank Instrument"),p(),f(28,"input",12),L("ngModelChange",function(o){return n.bankingrecord.instrumentbank=o}),p()(),f(29,"div",7)(30,"label"),_(31,"Instrument No"),p(),f(32,"input",13),L("ngModelChange",function(o){return n.bankingrecord.instrumentno=o}),p()()()(),f(33,"div",2)(34,"div",3)(35,"div",4)(36,"label"),_(37,"Transaction Type"),p(),f(38,"input",14),L("ngModelChange",function(o){return n.bankingrecord.transactiontype=o}),p()()()()(),D(39,Aee,7,1,"ng-template",15),p(),ee(40,"p-toast",16)),2&e&&(Ft(rt(30,Mee)),T("visible",n.displayAddModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("formGroup",n.transactionForm),v(6),T("ngModel",n.obj_transactiondate)("inputStyle",rt(31,Nm)),v(4),Ft(rt(32,Nm)),T("ngModel",n.bankingrecord.description),v(6),Ft(rt(33,Nm)),T("options",n.types)("ngModel",n.bankingrecord.selectedType),v(4),Ft(rt(34,Nm)),T("ngModel",n.bankingrecord.credit),v(1),T("ngIf",n.transactionForm.controls.credit.invalid&&n.transactionForm.controls.credit.dirty),v(6),Ft(rt(35,Nm)),T("ngModel",n.bankingrecord.instrumentbank),v(4),Ft(rt(36,Nm)),T("ngModel",n.bankingrecord.instrumentno),v(6),Ft(rt(37,Nm)),T("ngModel",n.bankingrecord.transactiontype))},directives:[ms,Hr,Ur,Pr,oc,Er,zr,Ir,li,us,qo,Sn,zn,fr],styles:[""]}),t})();const Pee=["content"];function Oee(t,i){1&t&&Jn(0)}function Nee(t,i){if(1&t&&(f(0,"div",10),D(1,Oee,1,0,"ng-container",11),p()),2&t){const e=A(3);v(1),T("ngTemplateOutlet",e.headerTemplate)}}function Lee(t,i){if(1&t&&(f(0,"span",15),_(1),p()),2&t){const e=A(4);v(1),U(e.option("header"))}}const Ree=function(){return{"p-dialog-header-icon p-dialog-header-close p-link":!0}};function Bee(t,i){if(1&t){const e=Ie();f(0,"button",16),L("click",function(r){return z(e),A(4).close(r)})("keydown.enter",function(r){return z(e),A(4).close(r)}),ee(1,"span",17),p()}2&t&&T("ngClass",rt(1,Ree))}function jee(t,i){if(1&t&&(f(0,"div",10),D(1,Lee,2,1,"span",12),f(2,"div",13),D(3,Bee,2,2,"button",14),p()()),2&t){const e=A(3);v(1),T("ngIf",e.option("header")),v(2),T("ngIf",e.closable)}}function Vee(t,i){1&t&&ee(0,"i",1),2&t&&(Ji(A(3).option("icon")),T("ngClass","p-confirm-dialog-icon"))}function Uee(t,i){1&t&&Jn(0)}function Hee(t,i){if(1&t&&(f(0,"div",18),Sl(1),D(2,Uee,1,0,"ng-container",11),p()),2&t){const e=A(3);v(2),T("ngTemplateOutlet",e.footerTemplate)}}function zee(t,i){if(1&t){const e=Ie();f(0,"button",20),L("click",function(){return z(e),A(4).reject()}),p()}if(2&t){const e=A(4);Ji(e.option("rejectButtonStyleClass")),T("icon",e.option("rejectIcon"))("label",e.rejectButtonLabel)("ngClass","p-confirm-dialog-reject"),Ai("aria-label",e.rejectAriaLabel)}}function $ee(t,i){if(1&t){const e=Ie();f(0,"button",20),L("click",function(){return z(e),A(4).accept()}),p()}if(2&t){const e=A(4);Ji(e.option("acceptButtonStyleClass")),T("icon",e.option("acceptIcon"))("label",e.acceptButtonLabel)("ngClass","p-confirm-dialog-accept"),Ai("aria-label",e.acceptAriaLabel)}}function Wee(t,i){if(1&t&&(f(0,"div",18),D(1,zee,1,6,"button",19),D(2,$ee,1,6,"button",19),p()),2&t){const e=A(3);v(1),T("ngIf",e.option("rejectVisible")),v(1),T("ngIf",e.option("acceptVisible"))}}const qee=function(t){return{"p-dialog p-confirm-dialog p-component":!0,"p-dialog-rtl":t}},Gee=function(t,i){return{transform:t,transition:i}},Kee=function(t){return{value:"visible",params:t}};function Yee(t,i){if(1&t){const e=Ie();f(0,"div",3),L("mousedown",function(){return z(e),A(2).moveOnTop()})("@animation.start",function(r){return z(e),A(2).onAnimationStart(r)})("@animation.done",function(r){return z(e),A(2).onAnimationEnd(r)}),D(1,Nee,2,1,"div",4),D(2,jee,4,2,"div",4),f(3,"div",5,6),D(5,Vee,1,3,"i",7),ee(6,"span",8),p(),D(7,Hee,3,1,"div",9),D(8,Wee,3,2,"div",9),p()}if(2&t){const e=A(2);Ji(e.styleClass),T("ngClass",Ei(11,qee,e.rtl))("ngStyle",e.style)("@animation",Ei(16,Kee,ia(13,Gee,e.transformOptions,e.transitionOptions))),v(1),T("ngIf",e.headerTemplate),v(1),T("ngIf",!e.headerTemplate),v(3),T("ngIf",e.option("icon")),v(1),T("innerHTML",e.option("message"),Us),v(1),T("ngIf",e.footer||e.footerTemplate),v(1),T("ngIf",!e.footer&&!e.footerTemplate)}}function Xee(t,i){if(1&t&&(f(0,"div",1),D(1,Yee,9,18,"div",2),p()),2&t){const e=A();Ji(e.maskStyleClass),T("ngClass",e.getMaskClass()),v(1),T("ngIf",e.visible)}}const Qee=[[["p-footer"]]],Jee=["p-footer"],Zee=L0([cs({transform:"{{transform}}",opacity:0}),Pl("{{transition}}",cs({transform:"none",opacity:1}))]),ete=L0([Pl("{{transition}}",cs({transform:"{{transform}}",opacity:0}))]);let mo=(()=>{class t{constructor(e,n,r,o,c,u){this.el=e,this.renderer=n,this.confirmationService=r,this.zone=o,this.cd=c,this.config=u,this.acceptIcon="pi pi-check",this.acceptVisible=!0,this.rejectIcon="pi pi-times",this.rejectVisible=!0,this.closeOnEscape=!0,this.blockScroll=!0,this.closable=!0,this.autoZIndex=!0,this.baseZIndex=0,this.transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)",this.focusTrap=!0,this.defaultFocus="accept",this.onHide=new Et,this._position="center",this.transformOptions="scale(0.7)",this.id=N0(),this.subscription=this.confirmationService.requireConfirmation$.subscribe(m=>{m?m.key===this.key&&(this.confirmation=m,this.confirmationOptions={message:this.confirmation.message||this.message,icon:this.confirmation.icon||this.icon,header:this.confirmation.header||this.header,rejectVisible:null==this.confirmation.rejectVisible?this.rejectVisible:this.confirmation.rejectVisible,acceptVisible:null==this.confirmation.acceptVisible?this.acceptVisible:this.confirmation.acceptVisible,acceptLabel:this.confirmation.acceptLabel||this.acceptLabel,rejectLabel:this.confirmation.rejectLabel||this.rejectLabel,acceptIcon:this.confirmation.acceptIcon||this.acceptIcon,rejectIcon:this.confirmation.rejectIcon||this.rejectIcon,acceptButtonStyleClass:this.confirmation.acceptButtonStyleClass||this.acceptButtonStyleClass,rejectButtonStyleClass:this.confirmation.rejectButtonStyleClass||this.rejectButtonStyleClass,defaultFocus:this.confirmation.defaultFocus||this.defaultFocus,blockScroll:!1===this.confirmation.blockScroll||!0===this.confirmation.blockScroll?this.confirmation.blockScroll:this.blockScroll,closeOnEscape:!1===this.confirmation.closeOnEscape||!0===this.confirmation.closeOnEscape?this.confirmation.closeOnEscape:this.closeOnEscape,dismissableMask:!1===this.confirmation.dismissableMask||!0===this.confirmation.dismissableMask?this.confirmation.dismissableMask:this.dismissableMask},this.confirmation.accept&&(this.confirmation.acceptEvent=new Et,this.confirmation.acceptEvent.subscribe(this.confirmation.accept)),this.confirmation.reject&&(this.confirmation.rejectEvent=new Et,this.confirmation.rejectEvent.subscribe(this.confirmation.reject)),this.visible=!0):this.hide()})}get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.maskVisible&&(this.maskVisible=!0),this.cd.markForCheck()}get position(){return this._position}set position(e){switch(this._position=e,e){case"top-left":case"bottom-left":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"top-right":case"bottom-right":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)"}}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template}})}ngOnInit(){this.breakpoints&&this.createStyle(),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.visible&&this.cd.markForCheck()})}option(e){const n=this.confirmationOptions||this;if(n.hasOwnProperty(e))return n[e]}onAnimationStart(e){if("visible"===e.toState){this.container=e.element,this.wrapper=this.container.parentElement,this.contentContainer=We.findSingle(this.container,".p-dialog-content"),this.container.setAttribute(this.id,""),this.appendContainer(),this.moveOnTop(),this.bindGlobalListeners(),this.enableModality();const n=this.getElementToFocus();n&&n.focus()}}onAnimationEnd(e){"void"===e.toState&&this.onOverlayHide()}getElementToFocus(){switch(this.option("defaultFocus")){case"accept":default:return We.findSingle(this.container,".p-confirm-dialog-accept");case"reject":return We.findSingle(this.container,".p-confirm-dialog-reject");case"close":return We.findSingle(this.container,".p-dialog-header-close");case"none":return null}}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.wrapper):We.appendChild(this.wrapper,this.appendTo))}restoreAppend(){this.wrapper&&this.appendTo&&this.el.nativeElement.appendChild(this.wrapper)}enableModality(){this.option("blockScroll")&&We.addClass(document.body,"p-overflow-hidden"),this.option("dismissableMask")&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",e=>{this.wrapper&&this.wrapper.isSameNode(e.target)&&this.close(e)}))}disableModality(){this.maskVisible=!1,this.option("blockScroll")&&We.removeClass(document.body,"p-overflow-hidden"),this.dismissableMask&&this.unbindMaskClickListener(),this.container&&!this.cd.destroyed&&this.cd.detectChanges()}createStyle(){if(!this.styleElement){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement);let e="";for(let n in this.breakpoints)e+=`\n                    @media screen and (max-width: ${n}) {\n                        .p-dialog[${this.id}] {\n                            width: ${this.breakpoints[n]} !important;\n                        }\n                    }\n                `;this.styleElement.innerHTML=e}}close(e){this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(jp.CANCEL),this.hide(jp.CANCEL),e.preventDefault()}hide(e){this.onHide.emit(e),this.visible=!1,this.confirmation=null,this.confirmationOptions=null}moveOnTop(){this.autoZIndex&&(ls.set("modal",this.container,this.baseZIndex+this.config.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}getMaskClass(){let e={"p-dialog-mask p-component-overlay":!0,"p-dialog-mask-scrollblocker":this.blockScroll};return e[this.getPositionClass().toString()]=!0,e}getPositionClass(){const n=["left","right","top","top-left","top-right","bottom","bottom-left","bottom-right"].find(r=>r===this.position);return n?`p-dialog-${n}`:""}bindGlobalListeners(){(this.option("closeOnEscape")&&this.closable||this.focusTrap&&!this.documentEscapeListener)&&(this.documentEscapeListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","keydown",n=>{if(27==n.which&&this.option("closeOnEscape")&&this.closable&&parseInt(this.container.style.zIndex)===ls.get(this.container)&&this.visible&&this.close(n),9===n.which&&this.focusTrap){n.preventDefault();let r=We.getFocusableElements(this.container);if(r&&r.length>0)if(r[0].ownerDocument.activeElement){let o=r.indexOf(r[0].ownerDocument.activeElement);n.shiftKey?-1==o||0===o?r[r.length-1].focus():r[o-1].focus():-1==o||o===r.length-1?r[0].focus():r[o+1].focus()}else r[0].focus()}}))}unbindGlobalListeners(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}onOverlayHide(){this.container&&this.autoZIndex&&ls.clear(this.container),this.disableModality(),this.unbindGlobalListeners(),this.container=null}destroyStyle(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}ngOnDestroy(){this.restoreAppend(),this.onOverlayHide(),this.subscription.unsubscribe(),this.translationSubscription&&this.translationSubscription.unsubscribe(),this.destroyStyle()}accept(){this.confirmation&&this.confirmation.acceptEvent&&this.confirmation.acceptEvent.emit(),this.hide(jp.ACCEPT)}reject(){this.confirmation&&this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(jp.REJECT),this.hide(jp.REJECT)}get acceptButtonLabel(){return this.option("acceptLabel")||this.config.getTranslation(Fl.ACCEPT)}get rejectButtonLabel(){return this.option("rejectLabel")||this.config.getTranslation(Fl.REJECT)}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(Ss),te(Un),te(gr),te(Wo),te(Bp))},t.\u0275cmp=dn({type:t,selectors:[["p-confirmDialog"]],contentQueries:function(e,n,r){if(1&e&&(ol(r,wL,5),ol(r,zn,4)),2&e){let o;xt(o=wt())&&(n.footer=o.first),xt(o=wt())&&(n.templates=o)}},viewQuery:function(e,n){if(1&e&&Mt(Pee,5),2&e){let r;xt(r=wt())&&(n.contentViewChild=r.first)}},hostAttrs:[1,"p-element"],inputs:{header:"header",icon:"icon",message:"message",style:"style",styleClass:"styleClass",maskStyleClass:"maskStyleClass",acceptIcon:"acceptIcon",acceptLabel:"acceptLabel",acceptAriaLabel:"acceptAriaLabel",acceptVisible:"acceptVisible",rejectIcon:"rejectIcon",rejectLabel:"rejectLabel",rejectAriaLabel:"rejectAriaLabel",rejectVisible:"rejectVisible",acceptButtonStyleClass:"acceptButtonStyleClass",rejectButtonStyleClass:"rejectButtonStyleClass",closeOnEscape:"closeOnEscape",dismissableMask:"dismissableMask",blockScroll:"blockScroll",rtl:"rtl",closable:"closable",appendTo:"appendTo",key:"key",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",transitionOptions:"transitionOptions",focusTrap:"focusTrap",defaultFocus:"defaultFocus",breakpoints:"breakpoints",visible:"visible",position:"position"},outputs:{onHide:"onHide"},ngContentSelectors:Jee,decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],[3,"ngClass","ngStyle","class","mousedown",4,"ngIf"],[3,"ngClass","ngStyle","mousedown"],["class","p-dialog-header",4,"ngIf"],[1,"p-dialog-content"],["content",""],[3,"ngClass","class",4,"ngIf"],[1,"p-confirm-dialog-message",3,"innerHTML"],["class","p-dialog-footer",4,"ngIf"],[1,"p-dialog-header"],[4,"ngTemplateOutlet"],["class","p-dialog-title",4,"ngIf"],[1,"p-dialog-header-icons"],["type","button",3,"ngClass","click","keydown.enter",4,"ngIf"],[1,"p-dialog-title"],["type","button",3,"ngClass","click","keydown.enter"],[1,"pi","pi-times"],[1,"p-dialog-footer"],["type","button","pRipple","","pButton","",3,"icon","label","ngClass","class","click",4,"ngIf"],["type","button","pRipple","","pButton","",3,"icon","label","ngClass","click"]],template:function(e,n){1&e&&(mu(Qee),D(0,Xee,2,4,"div",0)),2&e&&T("ngIf",n.maskVisible)},directives:[Sn,Na,La,ic,Vp,_r],styles:[".p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translate(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0px!important;left:0px!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}\n"],encapsulation:2,data:{animation:[km("animation",[ul("void => visible",[R0(Zee)]),ul("visible => void",[R0(ete)])])]},changeDetection:0}),t})(),cM=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro,Up,_f],Up,Uc]}),t})();const tte=["dt"],nte=["dtaccount"],ite=["tabView"],rte=["menustab"];function ote(t,i){if(1&t){const e=Ie();f(0,"div",23),ee(1,"i",24),f(2,"input",25),L("input",function(r){return z(e),A().applyFilterAccount(r,"contains")}),p()()}}function ste(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function ate(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,ste,2,0,"th",26),f(4,"th"),_(5,"Title"),p(),f(6,"th"),_(7,"Bank"),p(),f(8,"th"),_(9,"IBAN"),p(),f(10,"th"),_(11,"Currency"),p(),f(12,"th"),_(13,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function lte(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function cte(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,lte,2,1,"td",26),f(4,"td",27),L("click",function(){const o=z(e).$implicit;return A().toggle(o)}),_(5),p(),f(6,"td"),_(7),p(),f(8,"td"),_(9),p(),f(10,"td"),_(11),p(),f(12,"td")(13,"button",28),L("click",function(){const o=z(e).$implicit;return A().updateAccount(o)}),p(),_(14," \xa0"),f(15,"button",29),L("click",function(){const o=z(e).$implicit;return A().deleteAccount(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.title),v(2),U(e.bank),v(2),U(e.iban),v(2),U(e.currency)}}function ute(t,i){1&t&&(f(0,"div",30),_(1,"No data found"),p())}function dte(t,i){if(1&t){const e=Ie();f(0,"div",23),ee(1,"i",24),f(2,"input",25),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()}}function fte(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function pte(t,i){1&t&&(f(0,"th"),_(1,"Title"),p())}function hte(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,fte,2,0,"th",26),D(4,pte,2,0,"th",26),f(5,"th"),_(6,"Description"),p(),f(7,"th"),_(8,"Date"),p(),f(9,"th"),_(10,"Debit"),p(),f(11,"th"),_(12,"Credit"),p(),f(13,"th"),_(14,"Balance"),p(),f(15,"th"),_(16,"Bank"),p(),f(17,"th"),_(18,"Instrument No"),p(),f(19,"th"),_(20,"Transaction"),p(),f(21,"th"),_(22,"Action"),p()()),2&t&&(v(3),T("ngIf",!1),v(1),T("ngIf",!1))}function mte(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function gte(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.title)}}function _te(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.debit," ","symbol","1.0-0"))}}function vte(t,i){1&t&&(f(0,"td"),_(1,"'"),p())}function yte(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.credit," ","symbol","1.0-0"))}}function bte(t,i){1&t&&ee(0,"td")}function xte(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.balance," ","symbol","1.0-0"))}}function wte(t,i){1&t&&ee(0,"td")}function Cte(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,mte,2,1,"td",26),D(4,gte,2,1,"td",26),f(5,"td"),_(6),p(),f(7,"td"),_(8),Ne(9,"date"),p(),D(10,_te,3,6,"td",26),D(11,vte,2,0,"td",26),D(12,yte,3,6,"td",26),D(13,bte,1,0,"td",26),D(14,xte,3,6,"td",26),D(15,wte,1,0,"td",26),f(16,"td"),_(17),p(),f(18,"td"),_(19),p(),f(20,"td"),_(21),p(),f(22,"td"),_(23," \xa0"),f(24,"button",29),L("click",function(){const o=z(e).$implicit;return A().deleteBanking(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(2),U(e.description),v(2),U(Oa(9,14,e.transactiondate,"dd-MM-yyyy")),v(2),T("ngIf",0!==e.debit),v(1),T("ngIf",0===e.debit),v(1),T("ngIf",0!==e.credit),v(1),T("ngIf",0===e.credit),v(1),T("ngIf",0!==e.balance),v(1),T("ngIf",0===e.balance),v(2),U(e.instrumentbank),v(2),U(e.instrumentno),v(2),U(e.transactiontype)}}function Tte(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td")(2,"td")(3,"td")(4,"td")(5,"td")(6,"td")(7,"td")(8,"td"),f(9,"td")(10,"button",31),L("click",function(){return z(e),A().exportTableToExcel()}),_(11,"Excel"),p(),f(12,"button",32),L("click",function(){return z(e),A().exportTableToPdf()}),_(13,"Pdf"),p()()()}}function Ste(t,i){1&t&&(f(0,"div",30),_(1,"No data found"),p())}const Ete=function(){return["title","iban"]},kte=function(){return["transactiondate","description"]},Dte=function(){return{width:"450px"}};let Ite=(()=>{class t{constructor(e,n,r,o,c){this.messageService=e,this._br=n,this.confirmationService=r,this.pdfserv=o,this.exptoexcel=c,this.bankingrecords=[],this.bankingaccounts=[],this.title="",this.currency="",this.iban="",this.displayDialog=!1,this.displayAddModal=!1,this.displayAccountDialog=!1,this.displayAddAccountModal=!1,this.accountID=0,this.activeIndex=0,this.headerData=["Date","Description","Debit","Credit","Balance","Bank","Instrument No","Transaction"]}ngOnInit(){this.getAccounts()}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}applyFilterAccount(e,n){this.dtaccount.filterGlobal(e.target.value,n)}showAddAccountDialog(){this.bankingaccount={id:"",title:"",iban:"",currency:""},this.displayAddAccountModal=!0}toggle(e){this.menustab.disabled=!1,this.accountID=e.id,this.getBankingRecords(),this.title=e.title,this.iban=e.iban,this.currency=e.currency,this.activeIndex=1}isAccountEmpty(){return 0===this.bankingaccounts.length}updateBankingAccount(e){this.getAccounts()}updateAccount(e){this.bankingaccount=Object.assign({},e),this.displayAddAccountModal=!0}deleteAccount(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._br.deleteAccount(e.id.toString()).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Banking account deleted successfully.",life:3e3}),this.getAccounts()},error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:n.error.message,life:3e3})}})}})}getBankingRecords(){this._br.getBankingRecord(this.accountID).subscribe({next:e=>{this.bankingrecords=e},error:e=>{console.error(e)}})}getAccounts(){this._br.getAccounts().subscribe({next:e=>{this.bankingaccounts=e},error:e=>{console.error(e)}})}showTransactionDialog(){this.bankingrecord={id:"",accountid:"",description:"",transactiondate:"",debit:"",credit:"",balance:"",instrumentbank:"",instrumentno:"",transactiontype:""},this.displayAddModal=!0}updateBankingRecord(e){this.getBankingRecords()}updateBanking(e){this.bankingrecord=Object.assign({},e),this.obj_transactiondate=new Date(this.bankingrecord.transactiondate),this.displayAddModal=!0}deleteBanking(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._br.deleteBankingRecord(e.id.toString()).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Banking record deleted successfully.",life:3e3}),this.getBankingRecords()},error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error occurred while deleting banking record.",life:3e3})}})}})}isBankingRecordEmpty(){return 0===this.bankingrecords.length}hideAddModal(e){this.displayAddModal=!e}hideAddAccountModal(e){this.displayAddAccountModal=!e}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],"Bank-Transactions_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"Bank-Transactions"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.bankingrecords.length;n++)e.push([Qr(this.bankingrecords[n].transactiondate),this.bankingrecords[n].description,this.bankingrecords[n].debit.toLocaleString(),this.bankingrecords[n].credit.toLocaleString(),this.bankingrecords[n].balance.toLocaleString(),this.bankingrecords[n].instrumentbank,this.bankingrecords[n].instrumentno,this.bankingrecords[n].transactiontype]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.bankingrecords.length;n++)e.push([Qr(this.bankingrecords[n].transactiondate),this.bankingrecords[n].description,this.bankingrecords[n].debit.toLocaleString(),this.bankingrecords[n].credit.toLocaleString(),this.bankingrecords[n].balance.toLocaleString(),this.bankingrecords[n].instrumentbank,this.bankingrecords[n].instrumentno,this.bankingrecords[n].transactiontype]);return e}toPdfFooterFormat(){let e=[];return e.push(["","","",""]),e}toExcelFooterFormat(e){return e.push(["","","","","",""]),e}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(IA),te(Un),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-bankingrecord"]],viewQuery:function(e,n){if(1&e&&(Mt(tte,5),Mt(nte,5),Mt(ite,5),Mt(rte,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.dtaccount=r.first),xt(r=wt())&&(n.tabView=r.first),xt(r=wt())&&(n.menustab=r.first)}},features:[Nn([kn,Un])],decls:50,vars:27,consts:[[1,"text-muted"],[3,"activeIndex","activeIndexChange"],["tabView",""],["header","Accounts"],[1,"btn-project",2,"margin-right","700px",3,"click"],[1,"bi","bi-plus-lg"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dtaccount",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],[3,"displayAddAccountModal","bankingaccount","obj_transactiondate","clickClose","clickAdd"],["header","Transaction",3,"disabled"],["menustab",""],[1,"row",2,"font-size","medium"],[1,"col-lg-3","col-md-3","col-sm-3"],[1,"form-group"],[2,"margin-right","10px"],[1,"btn-project",2,"margin-right","695px",3,"click"],["dt",""],["pTemplate","footer"],[3,"displayAddModal","accountID","bankingrecord","obj_transactiondate","clickClose","clickAdd"],[2,"text-align","right"],[1,"fas","fa-search",2,"margin","4px 4px 0 0"],["type","text","pInputText","","size","50","placeholder","Search..",2,"width","200px",3,"input"],[4,"ngIf"],[1,"list-item",3,"click"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"],[1,"btn-project","btn-sm",3,"click"],[1,"btn-project","btn-sm",2,"margin-left","5px",3,"click"]],template:function(e,n){1&e&&(f(0,"h2",0),_(1,"Account Statement"),p(),ee(2,"hr"),f(3,"p-tabView",1,2),L("activeIndexChange",function(o){return n.activeIndex=o}),f(5,"p-tabPanel",3)(6,"button",4),L("click",function(){return n.showAddAccountDialog()}),ee(7,"i",5),_(8," Add New "),p(),f(9,"p-table",6,7),D(11,ote,3,0,"ng-template",8),D(12,ate,14,1,"ng-template",9),D(13,cte,16,6,"ng-template",10),p(),D(14,ute,2,0,"div",11),f(15,"app-addeditbankaccount",12),L("clickClose",function(o){return n.hideAddAccountModal(o)})("clickAdd",function(o){return n.updateBankingAccount(o)}),p()(),f(16,"p-tabPanel",13,14)(18,"div",15)(19,"div",16)(20,"div",17)(21,"label",18)(22,"b"),_(23,"Account Title:"),p(),_(24),p()()(),f(25,"div",16)(26,"div",17)(27,"label",18)(28,"b"),_(29,"IBAN:"),p(),_(30),p()()(),f(31,"div",16)(32,"div",17)(33,"label",18)(34,"b"),_(35,"Currency:"),p(),_(36),p()()()(),ee(37,"br"),f(38,"button",19),L("click",function(){return n.showTransactionDialog()}),ee(39,"i",5),_(40," Add New "),p(),f(41,"p-table",6,20),D(43,dte,3,0,"ng-template",8),D(44,hte,23,2,"ng-template",9),D(45,Cte,25,17,"ng-template",10),D(46,Tte,14,0,"ng-template",21),p(),D(47,Ste,2,0,"div",11),p()(),f(48,"app-addeditbanking",22),L("clickClose",function(o){return n.hideAddModal(o)})("clickAdd",function(o){return n.updateBankingRecord(o)}),p(),ee(49,"p-confirmDialog")),2&e&&(v(3),T("activeIndex",n.activeIndex),v(6),T("value",n.bankingaccounts)("paginator",!0)("rows",10)("globalFilterFields",rt(24,Ete)),v(5),T("ngIf",n.isAccountEmpty()),v(1),T("displayAddAccountModal",n.displayAddAccountModal)("bankingaccount",n.bankingaccount)("obj_transactiondate",n.obj_transactiondate),v(1),T("disabled",!0),v(8),hn(" ",n.title,""),v(6),hn(" ",n.iban,""),v(6),hn(" ",n.currency,""),v(5),T("value",n.bankingrecords)("paginator",!0)("rows",10)("globalFilterFields",rt(25,kte)),v(6),T("ngIf",n.isBankingRecordEmpty()),v(1),T("displayAddModal",n.displayAddModal)("accountID",n.accountID)("bankingrecord",n.bankingrecord)("obj_transactiondate",n.obj_transactiondate),v(1),Ft(rt(26,Dte)))},directives:[Cf,wf,ki,zn,li,Sn,_r,kee,Fee,mo],pipes:[al,dr],styles:[".list-item[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),t})();function P7(t,i){if(i.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+i.length+" present")}function ZT(t){return(ZT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function O7(t){P7(1,arguments);var i=Object.prototype.toString.call(t);return t instanceof Date||"object"===ZT(t)&&"[object Date]"===i?new Date(t.getTime()):"number"==typeof t||"[object Number]"===i?new Date(t):(("string"==typeof t||"[object String]"===i)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}function Lm(t,i){P7(2,arguments);var e=O7(t),n=O7(i),r=e.getFullYear()-n.getFullYear(),o=e.getMonth()-n.getMonth();return 12*r+o}const oo=Ws_apiUrl,sc={headers:new io({"Content-Type":"application/json"})};let eS=(()=>{class t{constructor(e){this._http=e}addInventory(e){const{floor:n,unit:r,unitno:o,project:c,area:u,costpersqft:m,downpayment:g,installment:x,possessionAmount:S,cost:M,status:E}=e.value;return this._http.post(oo+"addInventory",{floor:n,unit:r,unitno:o,project:c,area:u,costpersqft:m,downpayment:g,installment:x,possessionAmount:S,cost:M,status:E},sc)}updateInventory(e){const{id:n,floor:r,unit:o,unitno:c,project:u,area:m,costpersqft:g,downpayment:x,installment:S,possessionAmount:M,cost:E,status:R}=e.value;return this._http.post(oo+"updateInventory",{id:n,floor:r,unit:o,unitno:c,project:u,area:m,costpersqft:g,downpayment:x,installment:S,possessionAmount:M,cost:E,status:R},sc)}getCommercialUnits(){return this._http.get(oo+"getCommerialUnits",{})}getFloors(){return this._http.get(oo+"getFloors",{})}getPaymentTypes(){return this._http.get(oo+"getPaymentTypes",{})}getPlazaInventory(e){return this._http.get(oo+"getPlazaInventory",{params:{project:e.toString()}})}deleteInventory(e){return this._http.delete(`${oo}deleteInventory`,{body:{id:e}})}addStatusType(e){return this._http.post(oo+"addStatusType",{statustype:e},sc)}updateStatusType(e,n){return this._http.post(oo+"updateStatusType",{id:e,statustype:n},sc)}getStatusTypes(){return this._http.get(oo+"getStatusTypes",{})}deleteStatusType(e){return this._http.delete(`${oo}deleteStatusType`,{body:{id:e}})}addFloorType(e){return this._http.post(oo+"addFloorType",{floor:e},sc)}updateFloorType(e,n){return this._http.post(oo+"updateFloorType",{id:e,floor:n},sc)}deleteFloorType(e){return this._http.delete(`${oo}deleteFloorType`,{body:{id:e}})}addUnitType(e){return this._http.post(oo+"addUnitType",{unit:e},sc)}updateUnitType(e,n){return this._http.post(oo+"updateUnitType",{id:e,unit:n},sc)}deleteUnitType(e){return this._http.delete(`${oo}deleteUnitType`,{body:{id:e}})}updateClient(e){const{id:n,name:r,cnic:o,contact:c,address:u}=e.value;return this._http.post(oo+"updateClient",{id:n,name:r,cnic:o,contact:c,address:u},sc)}addClient(e){const{name:n,cnic:r,contact:o,address:c}=e.value;return this._http.post(oo+"addClient",{name:n,cnic:r,contact:o,address:c},sc)}getClients(){return this._http.get(oo+"getClients",{})}getClientInfo(e){return this._http.get(oo+"getClientInfo",{params:{id:e.toString()}})}deleteClient(e){return this._http.delete(`${oo}deleteClient`,{body:{id:e}})}loadInstallmentData(e){return this._http.get(oo+"loadInstallments",{params:{shopid:e.toString()}})}updateInstallment(e){const{id:n,shop:r,client:o,discount:c,paymenttype:u,amount:m,source:g,receipt:x}=e.value,S=new Date(e.value.paymentdate),M=this.formatDate(S);return this._http.post(oo+"updateInstallment",{id:n,shop:r,client:o,discount:c,paymenttype:u,amount:m,source:g,receipt:x,paymentdate:M},sc)}addInstallment(e){const{shop:n,client:r,discount:o,paymenttype:c,amount:u,source:m,receipt:g}=e.value;console.log(o);const x=new Date(e.value.paymentdate),S=this.formatDate(x);return this._http.post(oo+"addInstallment",{shop:n,client:r,discount:o,paymenttype:c,amount:u,source:m,receipt:g,paymentdate:S},sc)}changeOwnership(e,n){return this._http.post(oo+"changeOwnership",{client:e,shop:n},sc)}deleteInstallment(e){return console.log("in delete"),this._http.delete(`${oo}deleteInstallment`,{body:{id:e}})}formatDate(e){return`${e.getFullYear().toString().slice(-2)}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Ate=["dttransactions"],Mte=["dtfloortypes"],Fte=["dtunittypes"],Pte=["dtstatustypes"];function Ote(t,i){if(1&t){const e=Ie();f(0,"div",36),ee(1,"i",37),f(2,"input",38),L("input",function(r){return z(e),A().applyFilterAccount(r,"contains")}),p()()}}function Nte(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Lte(t,i){1&t&&(f(0,"tr",39)(1,"th"),_(2,"Sr#"),p(),D(3,Nte,2,0,"th",40),f(4,"th"),_(5,"Unit#"),p(),f(6,"th"),_(7,"Unit"),p(),f(8,"th"),_(9,"Area (SqrFt)"),p(),f(10,"th"),_(11,"Downpayment"),p(),f(12,"th"),_(13,"Installment"),p(),f(14,"th"),_(15,"Possession"),p(),f(16,"th"),_(17,"Cost"),p(),f(18,"th"),_(19,"Status"),p(),f(20,"th"),_(21,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Rte(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Bte(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.unitid)}}function jte(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.floorid)}}function Vte(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.statusid)}}const Ute=function(t,i){return{"background-color":t,color:i}};function Hte(t,i){if(1&t){const e=Ie();f(0,"tr",41)(1,"td"),_(2),p(),D(3,Rte,2,1,"td",40),f(4,"td",42),L("click",function(){const o=z(e).$implicit;return A().toggle(o)}),_(5),p(),D(6,Bte,2,1,"td",40),f(7,"td"),_(8),p(),D(9,jte,2,1,"td",40),f(10,"td"),_(11),p(),f(12,"td"),_(13),Ne(14,"currency"),p(),f(15,"td"),_(16),Ne(17,"currency"),p(),f(18,"td"),_(19),Ne(20,"currency"),p(),f(21,"td"),_(22),Ne(23,"currency"),p(),D(24,Vte,2,1,"td",40),f(25,"td"),_(26),p(),f(27,"td")(28,"button",43),L("click",function(){const o=z(e).$implicit;return A().updatePlazaInventory(o)}),p(),_(29," \xa0"),f(30,"button",44),L("click",function(){const o=z(e).$implicit;return A().deletePlazaInventory(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex,r=A();T("ngStyle",ia(34,Ute,r.isHighlighted(e)?"red":"white",r.isHighlighted(e)?"white":"black")),v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.unitno),v(1),T("ngIf",!1),v(2),U(e.unit),v(1),T("ngIf",!1),v(2),U(e.area),v(2),U(He(14,14,e.downpayment," ","symbol","1.0-0")),v(3),U(He(17,19,e.installment," ","symbol","1.0-0")),v(3),U(He(20,24,e.possessionAmount," ","symbol","1.0-0")),v(3),U(He(23,29,e.cost," ","symbol","1.0-0")),v(2),T("ngIf",!1),v(2),U(e.status)}}function zte(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td")(2,"td")(3,"td")(4,"td")(5,"td")(6,"td")(7,"td")(8,"td"),f(9,"td")(10,"button",3),L("click",function(){return z(e),A().exportTableToExcel()}),_(11,"Excel"),p()(),f(12,"td")(13,"button",3),L("click",function(){return z(e),A().exportTableToPdf()}),_(14,"Pdf"),p()()()}}function $te(t,i){1&t&&(f(0,"div",45),_(1,"No data found"),p())}function Wte(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedFloortype)}}function qte(t,i){1&t&&D(0,Wte,3,1,"div",40),2&t&&T("ngIf",A().selectedFloortype)}function Gte(t,i){if(1&t&&(f(0,"div",46)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.floor)}}function Kte(t,i){1&t&&(f(0,"small",47),_(1," Floor is required."),p())}function Yte(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedUnittype)}}function Xte(t,i){1&t&&D(0,Yte,3,1,"div",40),2&t&&T("ngIf",A().selectedUnittype)}function Qte(t,i){if(1&t&&(f(0,"div",46)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.unit)}}function Jte(t,i){1&t&&(f(0,"small",47),_(1," Unit is required."),p())}function Zte(t,i){1&t&&(f(0,"small",47),_(1," Unit number is required."),p())}function ene(t,i){1&t&&(f(0,"small",47),_(1," Area is required."),p())}function tne(t,i){1&t&&(f(0,"small",47),_(1," No of installments is required."),p())}function nne(t,i){1&t&&(f(0,"small",47),_(1," Cost Per Sqr Ft is required."),p())}function ine(t,i){1&t&&(f(0,"small",47),_(1," Down payment is required."),p())}function rne(t,i){1&t&&(f(0,"small",47),_(1," Possession amount is required."),p())}function one(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedStatustype)}}function sne(t,i){1&t&&D(0,one,3,1,"div",40),2&t&&T("ngIf",A().selectedStatustype)}function ane(t,i){if(1&t&&(f(0,"div",46)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.type)}}function lne(t,i){1&t&&(f(0,"small",47),_(1," Status is required."),p())}function cne(t,i){if(1&t){const e=Ie();f(0,"div",48)(1,"div")(2,"button",49),L("click",function(){z(e);const r=A();return r.savePlazaInventory(r.inventoryForm)}),_(3,"Save"),p(),f(4,"button",50),L("click",function(){return z(e),A().closeModal()}),_(5,"Cancel"),p()()()}if(2&t){const e=A();v(2),T("disabled",e.inventoryForm.invalid)}}function une(t,i){1&t&&(f(0,"small",47),_(1," Status is required."),p())}function dne(t,i){if(1&t){const e=Ie();f(0,"div",36)(1,"span",57),ee(2,"i",58),f(3,"input",59),L("input",function(r){return z(e),A(2).applyFilterGlobalStatustype(r,"contains")}),p()()()}}function fne(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function pne(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,fne,2,0,"th",40),f(4,"th"),_(5,"Status"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function hne(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function mne(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,hne,2,1,"td",40),f(4,"td"),_(5),p(),f(6,"td")(7,"button",43),L("click",function(){const o=z(e).$implicit;return A(2).updateStatustype(o)}),p(),_(8," \xa0"),f(9,"button",44),L("click",function(){const o=z(e).$implicit;return A(2).deleteStatustype(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.type)}}function gne(t,i){1&t&&(f(0,"div",45),_(1,"No data found"),p())}const _ne=function(){return["type"]};function vne(t,i){if(1&t){const e=Ie();f(0,"form",14)(1,"div",1)(2,"label",51),_(3,"Status"),p(),f(4,"input",52),L("ngModelChange",function(r){return z(e),A().status.type=r}),p(),D(5,une,2,0,"small",22),p()(),f(6,"div",53)(7,"button",54),L("click",function(){z(e);const r=A();return r.saveStatus(r.statusForm)}),_(8,"Save"),p(),f(9,"button",55),L("click",function(){return z(e),A().hideDialog()}),_(10,"Cancel"),p()(),ee(11,"hr"),f(12,"p-table",6,56),D(14,dne,4,0,"ng-template",8),D(15,pne,8,1,"ng-template",9),D(16,mne,10,3,"ng-template",10),p(),D(17,gne,2,0,"div",12)}if(2&t){const e=A();T("formGroup",e.statusForm),v(4),T("ngModel",e.status.type),v(1),T("ngIf",e.statusForm.controls.type.invalid&&e.statusForm.controls.type.dirty),v(2),T("disabled",e.statusForm.invalid),v(5),T("value",e.statustypes)("paginator",!0)("rows",10)("globalFilterFields",rt(9,_ne)),v(5),T("ngIf",e.isStatustypeEmpty())}}function yne(t,i){1&t&&(f(0,"small",47),_(1," Floor is required."),p())}function bne(t,i){if(1&t){const e=Ie();f(0,"div",36)(1,"span",57),ee(2,"i",58),f(3,"input",59),L("input",function(r){return z(e),A(2).applyFilterGlobalFloortype(r,"contains")}),p()()()}}function xne(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function wne(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,xne,2,0,"th",40),f(4,"th"),_(5,"Floor"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Cne(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Tne(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Cne,2,1,"td",40),f(4,"td"),_(5),p(),f(6,"td")(7,"button",43),L("click",function(){const o=z(e).$implicit;return A(2).updateFloortype(o)}),p(),_(8," \xa0"),f(9,"button",44),L("click",function(){const o=z(e).$implicit;return A(2).deleteFloortype(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.floor)}}function Sne(t,i){1&t&&(f(0,"div",45),_(1,"No data found"),p())}const Ene=function(){return["floor"]};function kne(t,i){if(1&t){const e=Ie();f(0,"form",14)(1,"div",1)(2,"label",60),_(3,"Floor"),p(),f(4,"input",61),L("ngModelChange",function(r){return z(e),A().floors.floor=r}),p(),D(5,yne,2,0,"small",22),p()(),f(6,"div",53)(7,"button",54),L("click",function(){z(e);const r=A();return r.saveFloor(r.floorForm)}),_(8,"Save"),p(),f(9,"button",55),L("click",function(){return z(e),A().hideFloorDialog()}),_(10,"Cancel"),p()(),ee(11,"hr"),f(12,"p-table",6,62),D(14,bne,4,0,"ng-template",8),D(15,wne,8,1,"ng-template",9),D(16,Tne,10,3,"ng-template",10),p(),D(17,Sne,2,0,"div",12)}if(2&t){const e=A();T("formGroup",e.floorForm),v(4),T("ngModel",e.floors.floor),v(1),T("ngIf",e.floorForm.controls.floor.invalid&&e.floorForm.controls.floor.dirty),v(2),T("disabled",e.floorForm.invalid),v(5),T("value",e.floortypes)("paginator",!0)("rows",10)("globalFilterFields",rt(9,Ene)),v(5),T("ngIf",e.isFloortypeEmpty())}}function Dne(t,i){1&t&&(f(0,"small",47),_(1," Unit is required."),p())}function Ine(t,i){if(1&t){const e=Ie();f(0,"div",36)(1,"span",57),ee(2,"i",58),f(3,"input",59),L("input",function(r){return z(e),A(2).applyFilterGlobalUnittype(r,"contains")}),p()()()}}function Ane(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Mne(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Ane,2,0,"th",40),f(4,"th"),_(5,"Unit"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Fne(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Pne(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Fne,2,1,"td",40),f(4,"td"),_(5),p(),f(6,"td")(7,"button",43),L("click",function(){const o=z(e).$implicit;return A(2).updateUnittype(o)}),p(),_(8," \xa0"),f(9,"button",44),L("click",function(){const o=z(e).$implicit;return A(2).deleteUnittype(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.unit)}}function One(t,i){1&t&&(f(0,"div",45),_(1,"No data found"),p())}const Nne=function(){return["unit"]};function Lne(t,i){if(1&t){const e=Ie();f(0,"form",14)(1,"div",1)(2,"label",60),_(3,"Units"),p(),f(4,"input",63),L("ngModelChange",function(r){return z(e),A().units.unit=r}),p(),D(5,Dne,2,0,"small",22),p()(),f(6,"div",53)(7,"button",54),L("click",function(){z(e);const r=A();return r.saveUnit(r.unitForm)}),_(8,"Save"),p(),f(9,"button",55),L("click",function(){return z(e),A().hideUnitDialog()}),_(10,"Cancel"),p()(),ee(11,"hr"),f(12,"p-table",6,64),D(14,Ine,4,0,"ng-template",8),D(15,Mne,8,1,"ng-template",9),D(16,Pne,10,3,"ng-template",10),p(),D(17,One,2,0,"div",12)}if(2&t){const e=A();T("formGroup",e.unitForm),v(4),T("ngModel",e.units.unit),v(1),T("ngIf",e.unitForm.controls.unit.invalid&&e.unitForm.controls.unit.dirty),v(2),T("disabled",e.unitForm.invalid),v(5),T("value",e.unittypes)("paginator",!0)("rows",10)("globalFilterFields",rt(9,Nne)),v(5),T("ngIf",e.isUnittypeEmpty())}}const Rne=function(){return["unitno"]},Bne=function(){return{width:"40vw"}},uM=function(){return{width:"180px"}},dM=function(){return{width:"30vw"}},jne=function(){return{width:"450px"}};let N7=(()=>{class t{constructor(e,n,r,o,c){this._ms=e,this._is=n,this.confirmationService=r,this.pdfserv=o,this.exptoexcel=c,this.displayAddAccountModal=!1,this.clickClose=new Et,this.clickAdd=new Et,this.transactions=[],this.ptabIndexChanged=new Et,this.makeTrRed=!0,this._color=!1,this.highlightedRows=[],this._totaldue=0,this.disablestatus=!1,this.totalamountsummary=0,this.totalpaidsummary=0,this.totalduesummary=0,this.totalrebatesummary=0,this.headerData=["Unit No","Unit","Area (SqrFt)","Downpayment","Installment","Possession","Cost","Status"]}formatDate(e){const n=new Date(e);return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`}changeRowColor(e){let n=0,r=0,o=0,c=0,u=0;this.transactions=e,this.transactions.forEach(g=>{"Sold"==g.status&&this._is.loadInstallmentData(g.id).subscribe({next:x=>{if(console.log(x),0==x.length)return;u=Number(x[0].agreedamount),console.log("_agreedamount "+u),u-=Number(u*Number(x[0].possessionamount)/100),console.log("_agreedamount "+u);let S,R,M=[],E=0;n=0,E=0,x.forEach(ce=>{M.push(new Date(Qr(ce.paymentdate))),"Installment"==ce.payment_type&&(n+=ce.amount),"Downpayment"==ce.payment_type&&(E+=ce.amount,S=new Date(Qr(ce.paymentdate)))}),o=Lm(new Date,S);const B=this.findLargestDate(M);R=B?Lm(new Date,B):0,c=o/3,u-=E,u-=Number((u+E)*Number(x[0].possessionamount)/100),r=0==Math.round(c)?Number(u/x[0].installment):Number(u/x[0].installment)*Math.round(c);let K=Number(x[0].agreedamount),Y=0;Y=n+E===K?0:r-n,Y>0&&this.highlightedRows.push(g)},error:x=>{console.error(x)}})})}findLargestDate(e){if(0===e.length)return null;let n=e[0];for(let r=1;r<e.length;r++)e[r]>n&&(n=e[r]);return n}isHighlighted(e){return this.highlightedRows.includes(e)}ngOnInit(){this.inventoryForm=new Zn({id:new Me(""),project_name:new Me(""),floor:new Me("",jt.required),unit:new Me("",jt.required),unitno:new Me("",jt.required),area:new Me("",jt.required),costpersqft:new Me("",jt.required),downpayment:new Me("",jt.required),installment:new Me("",jt.required),possessionAmount:new Me("",jt.required),cost:new Me(""),status:new Me("",jt.required)}),this.transaction={id:"",project_name:"",floor:"",unit:"",unitno:"",area:"",costpersqft:"",downpayment:"",installment:"",possessionAmount:"",cost:"",status:""},this.getFloorTypes(),this.getUnitTypes(),this.getStatusTypes(),this.statusForm=new Zn({id:new Me(""),type:new Me("",jt.required)}),this.floorForm=new Zn({id:new Me(""),floor:new Me("",jt.required)}),this.unitForm=new Zn({id:new Me(""),unit:new Me("",jt.required)})}changeTab(e){this.ptabIndexChanged.emit(e)}toggle(e){this.inventoryID=e.id,this.changeTab(e)}getFloorTypes(){this._is.getFloors().subscribe({next:e=>{this.floortypes=e},error:e=>{console.error(e)}})}getUnitTypes(){this._is.getCommercialUnits().subscribe({next:e=>{this.unittypes=e},error:e=>{console.error(e)}})}getStatusTypes(){this._is.getStatusTypes().subscribe({next:e=>{this.statustypes=e},error:e=>{console.error(e)}})}getPlazaInvetory(){this._is.getPlazaInventory(this.projectID).subscribe({next:e=>{e.forEach(n=>{n.downpayment=Number(n.cost)*(Number(n.downpayment)/100),n.possessionAmount=Number(n.cost)*(Number(n.possessionAmount)/100),n.installment=(Number(n.cost)-(Number(n.downpayment)+Number(n.possessionAmount)))/Number(n.installment)}),this.transactions=e},error:e=>{console.error(e)}})}applyFilterAccount(e,n){this.dtaccount.filterGlobal(e.target.value,n)}isInventoryEmpty(){return 0===this.transactions.length}deletePlazaInventory(e){"3"!=e.statusid?this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._is.deleteInventory(e.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Inventory unit is deleted successfully.",life:3e3}),this.getPlazaInvetory()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting inventory unit.",life:3e3})}})}}):this._ms.add({severity:"error",summary:"Error",detail:"Sold unit cant be deleted."})}addPlazaInventory(){this.transaction={id:"",project:"",floor:"",unit:"",area:"",costpersqft:"",downpayment:"",installment:"",possessionAmount:"",cost:"",status:""},this.displayAddAccountModal=!0}updatePlazaInventory(e){if(this.transaction=Object.assign({},e),"3"==this.transaction.statusid)return this.displayAddAccountModal=!1,void this._ms.add({severity:"error",summary:"Error",detail:"Sold unit cant be edited."});this.selectedFloortype=this.transaction.id,this.selectedUnittype=this.transaction.unitid,this.selectedStatustype=this.transaction.statusid,this.transaction.installment=(Number(this.transaction.cost)-Number(this.transaction.downpayment)-Number(this.transaction.possessionAmount))/Number(this.transaction.installment),this.transaction.downpayment=Number(this.transaction.downpayment)/Number(this.transaction.cost)*100,this.transaction.possessionAmount=Number(this.transaction.possessionAmount)/Number(this.transaction.cost)*100,this.displayAddAccountModal=!0}closeModal(){this.displayAddAccountModal=!1,this.clickClose.emit(!0),this.changeRowColor(this.transactions)}hideAddAccountModal(e){this.displayAddAccountModal=!e}savePlazaInventory(e){this.transaction.id?(e.value.id=this.transaction.id,e.value.project=this.projectID,e.value.floor=this.selectedFloortype,e.value.cost=Number(e.value.costpersqft)*Number(e.value.area),this._is.updateInventory(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Inventory unit is updated successfully."}),this.clickAdd.emit(n),this.inventoryForm.reset(),this.getPlazaInvetory(),this.displayAddAccountModal=!1,this.clickClose.emit(!0)},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while updating inventory unit."})}})):(e.value.project=this.projectID,e.value.floor=this.selectedFloortype,e.value.cost=Number(e.value.costpersqft)*Number(e.value.area),this._is.addInventory(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Inventory unit is added successfully."}),this.clickAdd.emit(n),this.inventoryForm.reset(),this.getPlazaInvetory()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while saving inventory unit."})}}))}deleteStatustype(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._is.deleteStatusType(e.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Status deleted successfully.",life:3e3}),this.getStatusTypes()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting status.",life:3e3})}})}})}updateStatustype(e){this.status=Object.assign({},e)}saveStatus(e){this.status.id?(this.statusForm.value.id=this.status.id,this.statusForm.value.type=this.status.type,this._is.updateStatusType(this.statusForm.value.id,this.statusForm.value.type).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Status type is updated succesfully.",life:3e3}),this.status.id="",this.statusForm.reset(),this.getStatusTypes()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating status."})}})):this._is.addStatusType(this.statusForm.value.type).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Status type is saved succesfully.",life:3e3}),this.statusForm.reset(),this.getStatusTypes()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while saving status type.",life:3e3})}})}isStatustypeEmpty(){return 0===this.statustypes.length}applyFilterGlobalStatustype(e,n){this.dtstatustypes.filterGlobal(e.target.value,n)}hideDialog(){this.statusDialog=!1,this.getStatusTypes()}newStatus(){this.status={},this.statusDialog=!0}deleteFloortype(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._is.deleteFloorType(e.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Floor deleted successfully.",life:3e3}),this.floorForm.reset(),this.getFloorTypes()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting floor.",life:3e3})}})}})}updateFloortype(e){this.floors=Object.assign({},e)}saveFloor(e){this.floors.id?(this.floorForm.value.id=this.floors.id,this.floorForm.value.floor=this.floors.floor,this._is.updateFloorType(this.floorForm.value.id,this.floorForm.value.floor).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Floor type is updated succesfully.",life:3e3}),this.floors.id="",this.floorForm.reset(),this.getFloorTypes()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating floor."})}})):this._is.addFloorType(this.floorForm.value.floor).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Floor type is saved succesfully.",life:3e3}),this.floorForm.reset(),this.getFloorTypes()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while saving floor type.",life:3e3})}})}isFloortypeEmpty(){return 0===this.floortypes.length}applyFilterGlobalFloortype(e,n){this.dtfloortypes.filterGlobal(e.target.value,n)}hideFloorDialog(){this.floorDialog=!1,this.getFloorTypes()}newFloor(){this.floors={},this.floorDialog=!0}deleteUnittype(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._is.deleteUnitType(e.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Unit deleted successfully.",life:3e3}),this.unitForm.reset(),this.getUnitTypes()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting unit.",life:3e3})}})}})}updateUnittype(e){this.units=Object.assign({},e)}saveUnit(e){this.units.id?(this.unitForm.value.id=this.units.id,this.unitForm.value.unit=this.units.unit,this._is.updateUnitType(e.value.id,e.value.unit).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Unit type is updated succesfully.",life:3e3}),this.units.id="",this.unitForm.reset(),this.getUnitTypes()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating unit."})}})):this._is.addUnitType(e.value.unit).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Unit type is saved succesfully.",life:3e3}),this.unitForm.reset(),this.getUnitTypes()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while saving unit type.",life:3e3})}})}isUnittypeEmpty(){return 0===this.unittypes.length}applyFilterGlobalUnittype(e,n){this.dtunittypes.filterGlobal(e.target.value,n)}hideUnitDialog(){this.unitDialog=!1,this.getUnitTypes()}newUnit(){this.units={},this.unitDialog=!0}exportTableToExcel(){const e=this.toExcelFormat();this.exptoexcel.exportExcel(e,this.headerData,[],"Commercial_Inventory_"+ui())}exportTableToPdf(){const e=this.toPdfFormat();this.pdfserv.generatePdf(this.headerData,e,[],"Commercial_Inventory_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.transactions.length;n++)e.push([this.transactions[n].unitno,this.transactions[n].unit,this.transactions[n].area,this.transactions[n].downpayment.toLocaleString(),this.transactions[n].installment.toLocaleString(),this.transactions[n].possessionAmount.toLocaleString(),this.transactions[n].cost.toLocaleString(),this.transactions[n].status]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.transactions.length;n++)e.push([this.transactions[n].unitno,this.transactions[n].unit,this.transactions[n].area,this.transactions[n].downpayment.toLocaleString(),this.transactions[n].installment.toLocaleString(),this.transactions[n].possessionAmount.toLocaleString(),this.transactions[n].cost.toLocaleString(),this.transactions[n].status]);return e}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(eS),te(Un),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-plazainventory"]],viewQuery:function(e,n){if(1&e&&(Mt(Ate,5),Mt(Mte,5),Mt(Fte,5),Mt(Pte,5)),2&e){let r;xt(r=wt())&&(n.dtaccount=r.first),xt(r=wt())&&(n.dtfloortypes=r.first),xt(r=wt())&&(n.dtunittypes=r.first),xt(r=wt())&&(n.dtstatustypes=r.first)}},inputs:{displayAddAccountModal:"displayAddAccountModal",transactions:"transactions",transaction:"transaction",projectID:"projectID",selectedFloortype:"selectedFloortype",selectedUnittype:"selectedUnittype",selectedStatustype:"selectedStatustype",activeIndex:"activeIndex",makeTrRed:"makeTrRed",totalamountsummary:"totalamountsummary",totalpaidsummary:"totalpaidsummary",totalduesummary:"totalduesummary",totalrebatesummary:"totalrebatesummary"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd",ptabIndexChanged:"ptabIndexChanged"},features:[Nn([kn,Un])],decls:114,vars:94,consts:[[1,"container"],[1,"row"],[1,"col-lg-2"],[1,"btn","btn-primary",3,"click"],[1,"col-lg-10"],[2,"display","flex","align-items","left"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dttransactions",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],["header","Add Inventory",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[3,"formGroup"],[1,"p-fluid","formgrid"],[1,"field","col-12","col-md-6"],["for","title"],[2,"display","flex","align-items","center"],["id","floor","name","floor","optionValue","id","optionLabel","floor","filterBy","floor","placeholder","Select Floor","appendTo","body","formControlName","floor","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange"],["class","custom-dropdown"],["type","button",1,"btn","btn-primary",2,"margin-right","5px","width","fit-content",3,"click"],["class","p-error block",4,"ngIf"],["id","unit","name","unit","optionValue","id","optionLabel","unit","filterBy","unit","placeholder","Select Unit","appendTo","body","formControlName","unit","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange"],["pInputText","","type","text","id","unitno","name","unitno","formControlName","unitno",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","area","name","area","formControlName","area",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","installment","name","installment","formControlName","installment",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","costpersqft","name","costpersqft","formControlName","costpersqft",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","downpayment","name","downpayment","formControlName","downpayment",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","possessionAmount","name","possessionAmount","formControlName","possessionAmount",3,"ngModel","ngModelChange"],["id","status","name","status","optionValue","id","optionLabel","type","filterBy","type","placeholder","Select Status","appendTo","body","formControlName","status","autoWidth","false",3,"disabled","options","filter","showClear","ngModel","ngModelChange"],["header","Manage Inventory Status",3,"visible","modal","visibleChange"],["pTemplate","content"],["header","Manage Floors",3,"visible","modal","visibleChange"],["header","Manage Commercial Units",3,"visible","modal","visibleChange"],["position","bottom-right"],[2,"text-align","right"],[1,"fas","fa-search",2,"margin","4px 4px 0 0"],["type","text","pInputText","","size","50","placeholder","Search..",2,"width","200px",3,"input"],[2,"font-size","medium"],[4,"ngIf"],[3,"ngStyle"],[1,"list-item",3,"click"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"],[1,"flex","align-items-center","gap-2"],[1,"p-error","block"],[2,"display","flex","justify-content","center"],["icon","pi pi-check","type","button",1,"btn","btn-success",3,"disabled","click"],["icon","pi pi-times","type","button",1,"btn","btn-primary",3,"click"],["for","type"],["pInputText","","type","text","id","type","name","type","formControlName","type",3,"ngModel","ngModelChange"],[2,"display","flex","justify-content","center","margin-top","5px","margin-bottom","5px"],["type","button",1,"btn","btn-success",3,"disabled","click"],["type","button",1,"btn","btn-primary",2,"margin-left","5px",3,"click"],["dtstatustypes",""],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["for","floor"],["pInputText","","type","text","id","floor","name","floor","formControlName","floor",3,"ngModel","ngModelChange"],["dtfloortypes",""],["pInputText","","type","text","id","unit","name","unit","formControlName","unit",3,"ngModel","ngModelChange"],["dtunittypes",""]],template:function(e,n){1&e&&(f(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),L("click",function(){return n.addPlazaInventory()}),_(4,"Add New"),p()(),f(5,"div",4)(6,"div",5)(7,"label")(8,"b"),_(9,"Total Amount:"),p(),_(10),Ne(11,"currency"),p(),_(12," \xa0\xa0"),f(13,"label")(14,"b"),_(15,"Total Received:"),p(),_(16),Ne(17,"currency"),p(),_(18," \xa0\xa0"),f(19,"label")(20,"b"),_(21,"Total Installments Due:"),p(),_(22),Ne(23,"currency"),p(),_(24," \xa0\xa0"),f(25,"label")(26,"b"),_(27,"Total Remaining:"),p(),_(28),Ne(29,"currency"),p()()()()(),f(30,"p-table",6,7),D(32,Ote,3,0,"ng-template",8),D(33,Lte,22,1,"ng-template",9),D(34,Hte,31,37,"ng-template",10),D(35,zte,15,0,"ng-template",11),p(),D(36,$te,2,0,"div",12),f(37,"p-dialog",13),L("visibleChange",function(o){return n.displayAddAccountModal=o})("onHide",function(){return n.closeModal()}),f(38,"form",14)(39,"div",15)(40,"div",1)(41,"div",16)(42,"label",17),_(43,"Floor"),p(),f(44,"div",18)(45,"p-dropdown",19),L("ngModelChange",function(o){return n.selectedFloortype=o}),D(46,qte,1,1,"ng-template",20),D(47,Gte,3,1,"ng-template",20),p(),f(48,"button",21),L("click",function(){return n.newFloor()}),_(49,"+ "),p()(),D(50,Kte,2,0,"small",22),p(),f(51,"div",16)(52,"label",17),_(53,"Unit"),p(),f(54,"div",18)(55,"p-dropdown",23),L("ngModelChange",function(o){return n.selectedUnittype=o}),D(56,Xte,1,1,"ng-template",20),D(57,Qte,3,1,"ng-template",20),p(),f(58,"button",21),L("click",function(){return n.newUnit()}),_(59,"+ "),p()(),D(60,Jte,2,0,"small",22),p()(),f(61,"div",1)(62,"div",16)(63,"label",17),_(64,"Unit Number"),p(),f(65,"input",24),L("ngModelChange",function(o){return n.transaction.unitno=o}),p(),D(66,Zte,2,0,"small",22),p(),f(67,"div",16)(68,"label",17),_(69,"Area (SqrFt)"),p(),f(70,"input",25),L("ngModelChange",function(o){return n.transaction.area=o}),p(),D(71,ene,2,0,"small",22),p()(),f(72,"div",1)(73,"div",16)(74,"label",17),_(75,"No. of Quarterly Installments"),p(),f(76,"input",26),L("ngModelChange",function(o){return n.transaction.installment=o}),p(),D(77,tne,2,0,"small",22),p(),f(78,"div",16)(79,"label",17),_(80,"Cost Per SqrFt"),p(),f(81,"input",27),L("ngModelChange",function(o){return n.transaction.costpersqft=o}),p(),D(82,nne,2,0,"small",22),p()(),f(83,"div",1)(84,"div",16)(85,"label",17),_(86,"Down Payment (%)"),p(),f(87,"input",28),L("ngModelChange",function(o){return n.transaction.downpayment=o}),p(),D(88,ine,2,0,"small",22),p(),f(89,"div",16)(90,"label",17),_(91,"On Physical Possession %"),p(),f(92,"input",29),L("ngModelChange",function(o){return n.transaction.possessionAmount=o}),p(),D(93,rne,2,0,"small",22),p()(),f(94,"div",1)(95,"div",16)(96,"label",17),_(97,"Status"),p(),f(98,"div",18)(99,"p-dropdown",30),L("ngModelChange",function(o){return n.selectedStatustype=o}),D(100,sne,1,1,"ng-template",20),D(101,ane,3,1,"ng-template",20),p(),f(102,"button",21),L("click",function(){return n.newStatus()}),_(103,"+ "),p()(),D(104,lne,2,0,"small",22),p()()()(),D(105,cne,6,1,"ng-template",11),p(),f(106,"p-dialog",31),L("visibleChange",function(o){return n.statusDialog=o}),D(107,vne,18,10,"ng-template",32),p(),f(108,"p-dialog",33),L("visibleChange",function(o){return n.floorDialog=o}),D(109,kne,18,10,"ng-template",32),p(),f(110,"p-dialog",34),L("visibleChange",function(o){return n.unitDialog=o}),D(111,Lne,18,10,"ng-template",32),p(),ee(112,"p-toast",35)(113,"p-confirmDialog")),2&e&&(v(10),hn("\xa0\xa0",He(11,65,n.totalamountsummary," ","symbol","1.0-0"),""),v(6),hn("\xa0\xa0",He(17,70,n.totalpaidsummary," ","symbol","1.0-0"),""),v(6),hn("\xa0\xa0",He(23,75,n.totalduesummary," ","symbol","1.0-0"),""),v(6),hn("\xa0\xa0",He(29,80,n.totalamountsummary-n.totalpaidsummary," ","symbol","1.0-0"),""),v(2),T("value",n.transactions)("paginator",!0)("rows",10)("globalFilterFields",rt(85,Rne)),v(6),T("ngIf",n.isInventoryEmpty()),v(1),Ft(rt(86,Bne)),T("visible",n.displayAddAccountModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("formGroup",n.inventoryForm),v(7),Ft(rt(87,uM)),T("options",n.floortypes)("filter",!0)("showClear",!0)("ngModel",n.selectedFloortype),v(5),T("ngIf",n.inventoryForm.controls.floor.invalid&&n.inventoryForm.controls.floor.dirty),v(5),Ft(rt(88,uM)),T("options",n.unittypes)("filter",!0)("showClear",!0)("ngModel",n.selectedUnittype),v(5),T("ngIf",n.inventoryForm.controls.unit.invalid&&n.inventoryForm.controls.unit.dirty),v(5),T("ngModel",n.transaction.unitno),v(1),T("ngIf",n.inventoryForm.controls.unitno.invalid&&n.inventoryForm.controls.unitno.dirty),v(4),T("ngModel",n.transaction.area),v(1),T("ngIf",n.inventoryForm.controls.area.invalid&&n.inventoryForm.controls.area.dirty),v(5),T("ngModel",n.transaction.installment),v(1),T("ngIf",n.inventoryForm.controls.installment.invalid&&n.inventoryForm.controls.installment.dirty),v(4),T("ngModel",n.transaction.costpersqft),v(1),T("ngIf",n.inventoryForm.controls.costpersqft.invalid&&n.inventoryForm.controls.costpersqft.dirty),v(5),T("ngModel",n.transaction.downpayment),v(1),T("ngIf",n.inventoryForm.controls.downpayment.invalid&&n.inventoryForm.controls.downpayment.dirty),v(4),T("ngModel",n.transaction.possessionAmount),v(1),T("ngIf",n.inventoryForm.controls.possessionAmount.invalid&&n.inventoryForm.controls.possessionAmount.dirty),v(6),Ft(rt(89,uM)),T("disabled",n.disablestatus)("options",n.statustypes)("filter",!0)("showClear",!0)("ngModel",n.selectedStatustype),v(5),T("ngIf",n.inventoryForm.controls.status.invalid&&n.inventoryForm.controls.status.dirty),v(2),Ft(rt(90,dM)),T("visible",n.statusDialog)("modal",!0),v(2),Ft(rt(91,dM)),T("visible",n.floorDialog)("modal",!0),v(2),Ft(rt(92,dM)),T("visible",n.unitDialog)("modal",!0),v(3),Ft(rt(93,jne)))},directives:[ki,zn,li,Sn,La,_r,ms,Hr,Ur,Pr,us,Er,zr,Ir,qo,fr,mo],pipes:[dr],styles:[".list-item[_ngcontent-%COMP%]:hover{cursor:pointer}.red-row[_ngcontent-%COMP%]{background-color:red}.white-row[_ngcontent-%COMP%]{background-color:#fff}"]}),t})();const Vne=["dtclients"],Une=["dtInstallments"];function Hne(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(3);v(2),U(e.selectedClient)}}function zne(t,i){1&t&&D(0,Hne,3,1,"div",33),2&t&&T("ngIf",A(2).selectedClient)}function $ne(t,i){if(1&t&&(f(0,"div",34)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.name)}}const L7=function(){return{width:"180px"}};function Wne(t,i){if(1&t){const e=Ie();f(0,"p-dropdown",31),L("ngModelChange",function(r){return z(e),A().selectedClient=r})("onChange",function(r){return z(e),A().onDropdownChange(r)}),D(1,zne,1,1,"ng-template",32),D(2,$ne,3,1,"ng-template",32),p()}if(2&t){const e=A();Ft(rt(6,L7)),T("options",e.clients)("filter",!0)("showClear",!0)("ngModel",e.selectedClient)}}function qne(t,i){if(1&t){const e=Ie();f(0,"button",35),L("click",function(){return z(e),A().newClient()}),_(1,"+ "),p()}}function Gne(t,i){if(1&t){const e=Ie();f(0,"button",36),L("click",function(){return z(e),A().allotUnit()}),_(1,"Allot "),p()}2&t&&T("disabled",!A().selectedClient)}function Kne(t,i){if(1&t){const e=Ie();f(0,"div",3)(1,"button",37),L("click",function(){return z(e),A().allotUnit()}),_(2,"Add Installment"),p(),f(3,"button",38),L("click",function(){return z(e),A().changeOwner()}),_(4,"Change Ownership"),p()()}}function Yne(t,i){}function Xne(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Qne(t,i){1&t&&(f(0,"tr",39)(1,"th"),_(2,"Sr#"),p(),D(3,Xne,2,0,"th",33),f(4,"th"),_(5,"No."),p(),f(6,"th"),_(7,"Amount"),p(),f(8,"th"),_(9,"Rebate"),p(),f(10,"th"),_(11,"Type"),p(),f(12,"th"),_(13,"Payment"),p(),f(14,"th"),_(15,"Source"),p(),f(16,"th"),_(17,"Receipt"),p(),f(18,"th"),_(19,"Date"),p(),f(20,"th"),_(21,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Jne(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.agreedamount+e.rebate," ","symbol","1.0-0"))}}function Zne(t,i){1&t&&ee(0,"td")}function eie(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.rebate," ","symbol","1.0-0"))}}function tie(t,i){1&t&&ee(0,"td")}function nie(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.paymentid)}}function iie(t,i){if(1&t){const e=Ie();f(0,"tr",39)(1,"td"),_(2),p(),f(3,"td"),_(4),p(),D(5,Jne,3,6,"td",33),D(6,Zne,1,0,"td",33),D(7,eie,3,6,"td",33),D(8,tie,1,0,"td",33),D(9,nie,2,1,"td",33),f(10,"td"),_(11),p(),f(12,"td"),_(13),Ne(14,"currency"),p(),f(15,"td"),_(16),p(),f(17,"td"),_(18),p(),f(19,"td"),_(20),Ne(21,"date"),p(),f(22,"td")(23,"button",40),L("click",function(){const o=z(e).$implicit;return A().updateInstallment(o)}),p(),_(24," \xa0"),f(25,"button",41),L("click",function(){const r=z(e),o=r.$implicit,c=r.rowIndex;return A().deleteInstallment(o,c)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(2),U(e.installmentno),v(1),T("ngIf",0!==e.agreedamount),v(1),T("ngIf",0===e.agreedamount),v(1),T("ngIf",0!==e.rebate),v(1),T("ngIf",0===e.rebate),v(1),T("ngIf",!1),v(2),U(e.payment_type),v(2),U(He(14,12,e.amount," ","symbol","1.0-0")),v(3),U(e.source),v(2),U(e.receiptno),v(2),U(Oa(21,17,e.paymentdate,"dd-MM-yyyy"))}}function rie(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td")(2,"td")(3,"td")(4,"td"),f(5,"td"),_(6,"Total Received:"),p(),f(7,"td"),_(8),Ne(9,"currency"),p(),ee(10,"td")(11,"td")(12,"td")(13,"td"),p(),f(14,"tr"),ee(15,"td")(16,"td")(17,"td")(18,"td"),f(19,"td"),_(20,"Inst. Due:"),p(),f(21,"td"),_(22),Ne(23,"currency"),p(),ee(24,"td")(25,"td")(26,"td")(27,"td"),p(),f(28,"tr"),ee(29,"td")(30,"td")(31,"td")(32,"td"),f(33,"td"),_(34,"Rem. Payment:"),p(),f(35,"td"),_(36),Ne(37,"currency"),p(),f(38,"td"),_(39,"Possession Amount:"),p(),f(40,"td"),_(41),Ne(42,"currency"),p(),ee(43,"td")(44,"td"),p(),f(45,"tr"),ee(46,"td")(47,"td")(48,"td")(49,"td")(50,"td")(51,"td")(52,"td")(53,"td")(54,"td"),f(55,"td")(56,"button",37),L("click",function(){return z(e),A().exportTableToExcel()}),_(57,"Excel"),p(),f(58,"button",38),L("click",function(){return z(e),A().exportTableToPdf()}),_(59,"Pdf"),p()()()}if(2&t){const e=A();v(8),hn(" ",He(9,4,e.totalpaid," ","symbol","1.0-0"),""),v(14),hn(" ",He(23,9,e.totaldue," ","symbol","1.0-0"),""),v(14),hn(" ",He(37,14,e.remainingamount," ","symbol","1.0-0"),""),v(5),U(He(42,19,e.possessionamount," ","symbol","1.0-0"))}}function oie(t,i){1&t&&(f(0,"div",42),_(1,"No data found"),p())}function sie(t,i){1&t&&(f(0,"small",56),_(1," Name is required."),p())}function aie(t,i){1&t&&(f(0,"small",56),_(1," CNIC is required."),p())}function lie(t,i){1&t&&(f(0,"small",56),_(1," Contact is required."),p())}function cie(t,i){1&t&&(f(0,"small",56),_(1," Address is required."),p())}function uie(t,i){if(1&t){const e=Ie();f(0,"div",57)(1,"span",58),ee(2,"i",59),f(3,"input",60),L("input",function(r){return z(e),A(2).applyFilterGlobalClients(r,"contains")}),p()()()}}function die(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function fie(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,die,2,0,"th",33),f(4,"th"),_(5,"Name"),p(),f(6,"th"),_(7,"CNIC"),p(),f(8,"th"),_(9,"Contact"),p(),f(10,"th"),_(11,"Address"),p(),f(12,"th"),_(13,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function pie(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function hie(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,pie,2,1,"td",33),f(4,"td"),_(5),p(),f(6,"td"),_(7),p(),f(8,"td"),_(9),p(),f(10,"td"),_(11),p(),f(12,"td")(13,"button",40),L("click",function(){const o=z(e).$implicit;return A(2).updateClient(o)}),p(),_(14," \xa0"),f(15,"button",41),L("click",function(){const o=z(e).$implicit;return A(2).deleteClient(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.name),v(2),U(e.cnic),v(2),U(e.contact),v(2),U(e.address)}}function mie(t,i){1&t&&(f(0,"div",42),_(1,"No data found"),p())}const gie=function(){return["name"]};function _ie(t,i){if(1&t){const e=Ie();f(0,"form",43)(1,"div",0)(2,"div",44)(3,"div",1)(4,"label",45),_(5,"Name"),p(),f(6,"input",46),L("ngModelChange",function(r){return z(e),A().client.name=r}),p(),D(7,sie,2,0,"small",47),p(),f(8,"div",1)(9,"label",45),_(10,"CNIC"),p(),f(11,"input",48),L("ngModelChange",function(r){return z(e),A().client.cnic=r}),p(),D(12,aie,2,0,"small",47),p()(),f(13,"div",44)(14,"div",1)(15,"label",45),_(16,"Contact"),p(),f(17,"input",49),L("ngModelChange",function(r){return z(e),A().client.contact=r}),p(),D(18,lie,2,0,"small",47),p(),f(19,"div",1)(20,"label",45),_(21,"Address"),p(),f(22,"input",50),L("ngModelChange",function(r){return z(e),A().client.address=r}),p(),D(23,cie,2,0,"small",47),p()()()(),f(24,"div",51)(25,"button",52),L("click",function(){z(e);const r=A();return r.saveClient(r.clientForm)}),_(26,"Save"),p(),f(27,"button",53),L("click",function(){return z(e),A().hideDialog()}),_(28,"Cancel"),p()(),ee(29,"hr"),f(30,"p-table",54,55),D(32,uie,4,0,"ng-template",21),D(33,fie,14,1,"ng-template",22),D(34,hie,16,6,"ng-template",23),p(),D(35,mie,2,0,"div",25)}if(2&t){const e=A();T("formGroup",e.clientForm),v(6),T("ngModel",e.client.name),v(1),T("ngIf",e.clientForm.controls.name.invalid&&e.clientForm.controls.name.dirty),v(4),T("ngModel",e.client.cnic),v(1),T("ngIf",e.clientForm.controls.cnic.invalid&&e.clientForm.controls.cnic.dirty),v(5),T("ngModel",e.client.contact),v(1),T("ngIf",e.clientForm.controls.contact.invalid&&e.clientForm.controls.contact.dirty),v(4),T("ngModel",e.client.address),v(1),T("ngIf",e.clientForm.controls.address.invalid&&e.clientForm.controls.address.dirty),v(2),T("disabled",e.clientForm.invalid),v(5),T("value",e.clients)("paginator",!0)("rows",10)("globalFilterFields",rt(15,gie)),v(5),T("ngIf",e.isClientEmpty())}}function vie(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(3);v(2),U(e.selectedPaymenttype)}}function yie(t,i){1&t&&D(0,vie,3,1,"div",33),2&t&&T("ngIf",A(2).selectedPaymenttype)}function bie(t,i){if(1&t&&(f(0,"div",34)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.payment_type)}}function xie(t,i){1&t&&(f(0,"small",56),_(1," Payment type is required."),p())}function wie(t,i){1&t&&(f(0,"small",56),_(1," Payment amount is required."),p())}function Cie(t,i){1&t&&(f(0,"small",56),_(1," Date is required. "),p())}const Tie=function(){return{width:"265px"}},Sie=function(){return{width:"200px"}};function Eie(t,i){if(1&t){const e=Ie();f(0,"form",43)(1,"div",0)(2,"div",44)(3,"div",1)(4,"label",45),_(5,"Payment Type"),p(),f(6,"p-dropdown",61),L("ngModelChange",function(r){return z(e),A().selectedPaymenttype=r})("onChange",function(r){return z(e),A().onDropdownChangePT(r)}),D(7,yie,1,1,"ng-template",32),D(8,bie,3,1,"ng-template",32),p(),D(9,xie,2,0,"small",47),p(),f(10,"div",1)(11,"label",62),_(12,"Rebate %"),p(),f(13,"input",63),L("ngModelChange",function(r){return z(e),A().installment.discount=r}),p()()(),f(14,"div",44)(15,"div",1)(16,"label",45),_(17,"Payment"),p(),f(18,"input",64),L("ngModelChange",function(r){return z(e),A().installment.amount=r}),p(),D(19,wie,2,0,"small",47),p(),f(20,"div",1)(21,"label",45),_(22,"Payment Source"),p(),f(23,"input",65),L("ngModelChange",function(r){return z(e),A().installment.source=r}),p()()(),f(24,"div",44)(25,"div",1)(26,"label",45),_(27,"Receipt No"),p(),f(28,"input",66),L("ngModelChange",function(r){return z(e),A().installment.receiptno=r}),p()(),f(29,"div",1)(30,"label",67),_(31,"Payment Date"),p(),f(32,"p-calendar",68),L("ngModelChange",function(r){return z(e),A().obj_date=r}),p(),D(33,Cie,2,0,"small",47),p()()()(),f(34,"div",51)(35,"button",52),L("click",function(){z(e);const r=A();return r.saveInstallment(r.installmentForm)}),_(36,"Save"),p(),f(37,"button",53),L("click",function(){return z(e),A().hideInstallmentDialog()}),_(38,"Close"),p()()}if(2&t){const e=A();T("formGroup",e.installmentForm),v(6),Ft(rt(17,Tie)),T("options",e.paymenttypes)("filter",!0)("showClear",!0)("ngModel",e.selectedPaymenttype),v(3),T("ngIf",e.installmentForm.controls.paymenttype.invalid&&e.installmentForm.controls.paymenttype.dirty),v(4),T("ngModel",e.installment.discount),v(5),T("ngModel",e.installment.amount),v(1),T("ngIf",e.installmentForm.controls.amount.invalid&&e.installmentForm.controls.amount.dirty),v(4),T("ngModel",e.installment.source),v(5),T("ngModel",e.installment.receiptno),v(4),T("ngModel",e.obj_date)("inputStyle",rt(18,Sie)),v(1),T("ngIf",e.installmentForm.controls.paymentdate.invalid&&e.installmentForm.controls.paymentdate.dirty),v(2),T("disabled",e.installmentForm.invalid)}}function kie(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(3);v(2),U(e.selectedClient)}}function Die(t,i){1&t&&D(0,kie,3,1,"div",33),2&t&&T("ngIf",A(2).selectedClient)}function Iie(t,i){if(1&t&&(f(0,"div",34)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.name)}}function Aie(t,i){if(1&t){const e=Ie();f(0,"div",3)(1,"div",4)(2,"div",3)(3,"p-dropdown",31),L("ngModelChange",function(r){return z(e),A().selectedClient=r})("onChange",function(r){return z(e),A().onDropdownChange(r)}),D(4,Die,1,1,"ng-template",32),D(5,Iie,3,1,"ng-template",32),p(),f(6,"button",35),L("click",function(){return z(e),A().newClient()}),_(7,"+ "),p()()(),f(8,"div",4)(9,"label",8)(10,"b"),_(11,"Name:"),p()(),f(12,"label",9),_(13),p()(),f(14,"div",16)(15,"label",5)(16,"b"),_(17,"CNIC:"),p()(),f(18,"label",6),_(19),p()(),f(20,"div",16)(21,"label",10)(22,"b"),_(23,"Contact:"),p()(),f(24,"label",11),_(25),p()(),f(26,"div",16)(27,"label",12)(28,"b"),_(29,"Address:"),p()(),f(30,"label",13),_(31),p()()(),f(32,"div",51)(33,"button",69),L("click",function(){z(e);const r=A();return r.saveOwnership(r.selectedClient)}),_(34,"Save"),p(),f(35,"button",53),L("click",function(){return z(e),A().hideOwnershipDialog()}),_(36,"Cancel"),p()()}if(2&t){const e=A();v(3),Ft(rt(10,L7)),T("options",e.clients)("filter",!0)("showClear",!0)("ngModel",e.selectedClient),v(10),U(e.name),v(6),U(e.cnic),v(6),U(e.contact),v(6),U(e.address)}}const R7=function(){return{width:"60vw"}},Mie=function(){return{width:"600px"}},Fie=function(){return{width:"450px"}};let B7=(()=>{class t{constructor(e,n,r,o,c){this._ms=e,this._is=n,this.confirmationService=r,this.pdfserv=o,this.exptoexcel=c,this.updateInventory=new Et,this.remainingamount=0,this.isDropDownDisabled=!1,this.possessionamount=0,this.installmentDialog=!1,this.ownerDialog=!1,this.clickClose=new Et,this.clickAdd=new Et,this.headerData=["No","Amount","Rebate","Type","Payment","Source","Receipt","Date"]}ngOnInit(){this.clientForm=new Zn({id:new Me(""),name:new Me("",jt.required),contact:new Me("",jt.required),cnic:new Me("",jt.required),address:new Me("",jt.required)}),this.installmentForm=new Zn({id:new Me(""),shop:new Me(""),client:new Me(""),paymenttype:new Me("",jt.required),amount:new Me("",jt.required),source:new Me("",jt.required),receipt:new Me(""),paymentdate:new Me("",jt.required),discount:new Me("")}),this.installment={id:"",shop:"",client:"",paymenttype:"",amount:"",source:"",receipt:"",paymentdate:"",discount:""},this.getClients(),this.getPaymentTypes()}getPaymentTypes(){this._is.getPaymentTypes().subscribe({next:e=>{this.paymenttypes=e},error:e=>{console.error(e)}})}getClients(){this._is.getClients().subscribe({next:e=>{this.clients=e},error:e=>{console.error(e)}})}deleteClient(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._is.deleteClient(e.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Client deleted successfully.",life:3e3}),this.getClients(),this.clientForm.reset()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:n.error.message,life:3e3})}})}})}updateClient(e){this.client=Object.assign({},e)}saveClient(e){this.client.id?(this.clientForm.value.id=this.client.id,this._is.updateClient(this.clientForm).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Client is updated succesfully.",life:3e3}),this.clientForm.reset(),this.getClients()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating status."})}})):this._is.addClient(this.clientForm).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Client is saved succesfully.",life:3e3}),this.clientForm.reset(),this.getClients()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while saving client.",life:3e3})}})}isClientEmpty(){return 0===this.clients.length}applyFilterGlobalClients(e,n){this.dtclients.filterGlobal(e.target.value,n)}hideDialog(){this.clientDialog=!1,this.getClients()}newClient(){this.client={},this.clientDialog=!0}onDropdownChange(e){this.selectedClient=e.value,null==this.selectedClient&&(this.name="",this.cnic="",this.contact="",this.address=""),this.getClient(Number(this.selectedClient))}getClient(e){this._is.getClientInfo(e).subscribe({next:n=>{this.name=n[0].name,this.cnic=n[0].cnic,this.contact=n[0].contact,this.address=n[0].address},error:n=>{console.error(n)}})}allotUnit(){this.installment={},this.installmentForm.get("paymenttype").enable(),this.installmentDialog=!0}changeOwner(){this.ownerDialog=!0}saveOwnership(e){this._is.changeOwnership(e,this.shopData.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Ownership is changed succesfully.",life:3e3}),location.reload()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while saving installment.",life:3e3})}})}hideOwnershipDialog(){this.ownerDialog=!1}hideInstallmentDialog(){this.installmentDialog=!1,this.obj_date=null,this.installmentForm.get("paymenttype").enable()}onPaymentTypeChange(e){this.installment.rebate=0}getInstallments(){this.totalpaid=0,this._is.loadInstallmentData(this.shopData.id).subscribe({next:e=>{this.installments=e,this.installments.forEach(n=>{this.totalpaid=this.totalpaid+n.amount})},error:e=>{console.error(e)}})}deleteInstallment(e,n){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._is.deleteInstallment(e.id.toString()).subscribe({next:r=>{this._ms.add({severity:"success",summary:"Successful",detail:"Installment is deleted successfully.",life:3e3}),this.installmentForm.reset(),n<0&&(this.isDropDownDisabled=!1,this.name="",this.cnic="",this.contact="",this.address="",this.totalpaid=0,this.totaldue=0,this.remainingamount=0,this.possessionamount=0,this.selectedClient=""),this.updateInventory.emit(),this.loadInstallmentData(this.shopData.id)},error:r=>{this._ms.add({severity:"error",summary:"Error",detail:r.error.message,life:3e3})}})}})}updateInstallment(e){this.installment=Object.assign({},e),console.log(this.installment.rebate),this.installment.discount=Number(this.installment.rebate)/Number(this.cost)*100,this.obj_date=new Date(this.installment.paymentdate),this.selectedPaymenttype=this.installment.paymentid,this.installmentForm.get("paymenttype").disable();let r=this.installmentForm.get("discount");"1"==this.selectedPaymenttype?r.enable():r.disable(),this.installmentDialog=!0}saveInstallment(e){e.value.discount=this.installment.discount,this.installment.id?(e.value.id=this.installment.id,e.value.shop=this.shopData.id,e.value.client=this.selectedClient,e.value.paymenttype=this.selectedPaymenttype,this._is.updateInstallment(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Installment is updated succesfully.",life:3e3}),this.updateInventory.emit(),this.hideInstallmentDialog(),this.installmentForm.reset(),this.installmentForm.get("paymenttype").enable(),this.loadInstallmentData(this.shopData.id)},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating installment."})}})):(e.value.shop=this.shopData.id,e.value.client=this.selectedClient,this._is.addInstallment(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Installment is saved succesfully.",life:3e3}),this.updateInventory.emit(),this.installmentForm.reset(),this.isDropDownDisabled=!0,this.loadInstallmentData(this.shopData.id)},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while saving installment.",life:3e3})}}))}loadInstallmentData(e){this.totalpaid=0;let o=0;this.totaldue=0;let c=0,u=0,m=0,g=0,x=0;this.isDropDownDisabled=!0,this._is.loadInstallmentData(e).subscribe({next:M=>{if(this.installments=M,this.installments.forEach(Y=>{this.totalpaid=this.totalpaid+Y.amount}),0==M.length)return;x=Number(M[0].agreedamount);let E,B,R=[];M.forEach(Y=>{R.push(new Date(Qr(Y.paymentdate))),"Installment"==Y.payment_type&&(o+=Y.amount),"Downpayment"==Y.payment_type&&(c+=Y.amount,E=new Date(Qr(Y.paymentdate)))}),m=Lm(new Date,E),console.log("Actual Amount: "+x+" Downpayment: "+c+" Rebate: "+M[0].rebate+" Months: "+m);const K=this.findLargestDate(R);B=K?Lm(new Date,K):0,g=m/3,x-=c,x-=Number((x+c)*Number(M[0].possessionamount)/100),u=0==Math.round(g)?Number(x/M[0].installment):Number(x/M[0].installment)*Math.round(g);let q=Number(M[0].agreedamount);this.totaldue=this.totalpaid===q?0:u-o,this.possessionamount=Number(Number(Number(M[0].agreedamount)+Number(M[0].rebate))*Number(M[0].possessionamount))/100,this.remainingamount=q-this.totalpaid,this.isDropDownDisabled=!0},error:M=>{console.error(M)}})}findLargestDate(e){if(0===e.length)return null;let n=e[0];for(let r=1;r<e.length;r++)e[r]>n&&(n=e[r]);return n}isInstallmentEmpty(){return 0===this.installments.length}applyFilterGlobalInstallments(e,n){this.dtInstallments.filterGlobal(e.target.value,n)}onDropdownChangePT(e){let n=this.installmentForm.get("discount");2==e.value||3==e.value?(n.disable(),this.installment.discount=0):1==e.value&&(n.enable(),this.installment.discount=0)}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],this.name+"_Installment_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,this.name+"_Installment_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.installments.length;n++)e.push([this.installments[n].installmentno,(this.installments[n].agreedamount+this.installments[n].rebate).toLocaleString(),this.installments[n].rebate.toLocaleString(),this.installments[n].payment_type,this.installments[n].amount.toLocaleString(),this.installments[n].source,this.installments[n].receiptno,Qr(this.installments[n].paymentdate)]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.installments.length;n++)e.push([this.installments[n].installmentno,(this.installments[n].agreedamount+this.installments[n].rebate).toLocaleString(),this.installments[n].rebate.toLocaleString(),this.installments[n].payment_type,this.installments[n].amount.toLocaleString(),this.installments[n].source,this.installments[n].receiptno,Qr(this.installments[n].paymentdate)]);return e}toPdfFooterFormat(){let e=[];return e.push(["","","","Total Paid",this.totalpaid.toLocaleString()]),e.push(["","","","Total Due",this.totaldue.toLocaleString()]),e.push(["","","","Total Remaining",this.remainingamount.toLocaleString()]),e}toExcelFooterFormat(e){return e.push(["","","","","",""]),e.push(["","","","Total Paid",this.totalpaid.toLocaleString()]),e.push(["","","","Total Due",this.totaldue.toLocaleString()]),e.push(["","","","Total Remaining",this.remainingamount.toLocaleString()]),e}clearAll(e){this.isDropDownDisabled=!1,this.name="",this.cnic="",this.contact="",this.address="",this.totalpaid=0,this.totaldue=0,this.remainingamount=0,this.possessionamount=0,this.selectedClient=""}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(eS),te(Un),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-clientscombo"]],viewQuery:function(e,n){if(1&e&&(Mt(tb,5),Mt(Vne,5),Mt(Une,5)),2&e){let r;xt(r=wt())&&(n.childComponent=r.first),xt(r=wt())&&(n.dtclients=r.first),xt(r=wt())&&(n.dtInstallments=r.first)}},inputs:{clients:"clients",selectedClient:"selectedClient",shopData:"shopData",selectedPaymenttype:"selectedPaymenttype",name:"name",cnic:"cnic",contact:"contact",address:"address",unit:"unit",floor:"floor",area:"area",scheme:"scheme",status:"status",cost:"cost",totalpaid:"totalpaid",totaldue:"totaldue",remainingamount:"remainingamount",isDropDownDisabled:"isDropDownDisabled",possessionamount:"possessionamount",installmentDialog:"installmentDialog",ownerDialog:"ownerDialog",installments:"installments",installment:"installment"},outputs:{updateInventory:"updateInventory",clickClose:"clickClose",clickAdd:"clickAdd"},features:[Nn([kn,Un])],decls:90,vars:40,consts:[[1,"p-fluid","formgrid"],[1,"field","col-12","col-md-6"],["for","title"],[2,"display","flex","align-items","center"],[1,"field"],["for","control2"],["for","control2",2,"margin-left","5px"],[1,"field",2,"margin-left","20px"],["for","control1"],["for","control1",2,"margin-left","5px"],["for","control3"],["for","control3",2,"margin-left","5px"],["for","control4"],["for","control4",2,"margin-left","5px"],["id","client","name","client","optionValue","id","optionLabel","name","filterBy","name","placeholder","Select Client","appendTo","body","autoWidth","false",3,"options","filter","style","showClear","ngModel","ngModelChange","onChange",4,"ngIf"],["type","button","class","btn btn-primary","style","margin-right: 5px;width: fit-content;",3,"click",4,"ngIf"],[1,"field",2,"margin-left","15px"],["type","button","class","btn btn-success","style","margin-right: 5px;width: fit-content;",3,"disabled","click",4,"ngIf"],["style","display: flex; align-items: center;",4,"ngIf"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows"],["dtinstallments",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],["header","Manage Clients","styleClass","p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["header","Manage Installments","styleClass","p-fluid",3,"visible","modal","visibleChange"],["header","Change Unit Ownership","styleClass","p-fluid",3,"visible","modal","visibleChange"],["position","bottom-right"],["id","client","name","client","optionValue","id","optionLabel","name","filterBy","name","placeholder","Select Client","appendTo","body","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange","onChange"],["class","custom-dropdown"],[4,"ngIf"],[1,"flex","align-items-center","gap-2"],["type","button",1,"btn","btn-primary",2,"margin-right","5px","width","fit-content",3,"click"],["type","button",1,"btn","btn-success",2,"margin-right","5px","width","fit-content",3,"disabled","click"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-primary",2,"margin-left","5px",3,"click"],[2,"font-size","medium"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"],[3,"formGroup"],[1,"row"],["for","type"],["pInputText","","type","text","id","name","name","name","formControlName","name",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],["pInputText","","type","text","id","cnic","name","cnic","formControlName","cnic",3,"ngModel","ngModelChange"],["pInputText","","type","text","id","contact","name","contact","formControlName","contact",3,"ngModel","ngModelChange"],["pInputText","","type","text","id","address","name","address","formControlName","address",3,"ngModel","ngModelChange"],[2,"display","flex","justify-content","center","margin-top","5px","margin-bottom","5px"],["type","button",1,"btn","btn-success",3,"disabled","click"],["type","button",1,"btn","btn-primary",2,"margin-left","5px",3,"click"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dtclients",""],[1,"p-error","block"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["id","paymenttype","name","paymenttype","optionValue","id","optionLabel","payment_type","filterBy","payment_type","placeholder","Payment Type","appendTo","body","formControlName","paymenttype","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange","onChange"],["for","discount"],["pInputText","","type","number","id","discount","name","discount","formControlName","discount",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","amount","name","amount","formControlName","amount",3,"ngModel","ngModelChange"],["pInputText","","type","text","id","source","name","source","formControlName","source",3,"ngModel","ngModelChange"],["pInputText","","type","text","id","receipt","name","receipt","formControlName","receipt",3,"ngModel","ngModelChange"],[2,"margin-right","10px"],["id","paymentdate","name","paymentdate","formControlName","paymentdate","classs","form-control","dateFormat","dd-mm-yy","appendTo","body",3,"ngModel","inputStyle","ngModelChange"],["type","button",1,"btn","btn-success",3,"click"]],template:function(e,n){1&e&&(f(0,"div",0)(1,"div",1)(2,"label",2),_(3,"Shop Details:"),p()(),ee(4,"br"),f(5,"div",3)(6,"div",4)(7,"label",5)(8,"b"),_(9,"Floor:"),p()(),f(10,"label",6),_(11),p()(),f(12,"div",7)(13,"label",8)(14,"b"),_(15,"Unit:"),p()(),f(16,"label",9),_(17),p()(),f(18,"div",7)(19,"label",10)(20,"b"),_(21,"Area (Sqrft):"),p()(),f(22,"label",11),_(23),p()(),f(24,"div",7)(25,"label",12)(26,"b"),_(27,"Scheme:"),p()(),f(28,"label",13),_(29),p()(),f(30,"div",7)(31,"label",12)(32,"b"),_(33,"Cost:"),p()(),f(34,"label",13),_(35),Ne(36,"currency"),p()()(),ee(37,"hr"),f(38,"div",1)(39,"label",2),_(40,"Client Details:"),p()(),ee(41,"br"),f(42,"div",3)(43,"div",4)(44,"div",3),D(45,Wne,3,7,"p-dropdown",14),D(46,qne,2,0,"button",15),p()(),f(47,"div",4)(48,"label",8)(49,"b"),_(50,"Name:"),p()(),f(51,"label",9),_(52),p()(),f(53,"div",16)(54,"label",5)(55,"b"),_(56,"CNIC:"),p()(),f(57,"label",6),_(58),p()(),f(59,"div",16)(60,"label",10)(61,"b"),_(62,"Contact:"),p()(),f(63,"label",11),_(64),p()(),f(65,"div",16)(66,"label",12)(67,"b"),_(68,"Address:"),p()(),f(69,"label",13),_(70),p()()(),ee(71,"br"),f(72,"div",1),D(73,Gne,2,1,"button",17),p(),D(74,Kne,5,0,"div",18),f(75,"p-table",19,20),D(77,Yne,0,0,"ng-template",21),D(78,Qne,22,1,"ng-template",22),D(79,iie,26,20,"ng-template",23),D(80,rie,60,24,"ng-template",24),p(),D(81,oie,2,0,"div",25),f(82,"p-dialog",26),L("visibleChange",function(o){return n.clientDialog=o}),D(83,_ie,36,16,"ng-template",27),p(),f(84,"p-dialog",28),L("visibleChange",function(o){return n.installmentDialog=o}),D(85,Eie,39,19,"ng-template",27),p(),f(86,"p-dialog",29),L("visibleChange",function(o){return n.ownerDialog=o}),D(87,Aie,37,11,"ng-template",27),p(),ee(88,"p-toast",30)(89,"p-confirmDialog"),p()),2&e&&(v(11),U(n.floor),v(6),U(n.unit),v(6),U(n.area),v(6),U(n.scheme),v(6),U(He(36,31,n.cost," ","symbol","1.0-0")),v(10),T("ngIf",!n.isDropDownDisabled),v(1),T("ngIf",!n.isDropDownDisabled),v(6),U(n.name),v(6),U(n.cnic),v(6),U(n.contact),v(6),U(n.address),v(3),T("ngIf",!n.isDropDownDisabled),v(1),T("ngIf",n.isDropDownDisabled),v(1),T("value",n.installments)("paginator",!0)("rows",10),v(6),T("ngIf",n.isInstallmentEmpty()),v(1),Ft(rt(36,R7)),T("visible",n.clientDialog)("modal",!0),v(2),Ft(rt(37,Mie)),T("visible",n.installmentDialog)("modal",!0),v(2),Ft(rt(38,R7)),T("visible",n.ownerDialog)("modal",!0),v(3),Ft(rt(39,Fie)))},directives:[Sn,us,Er,md,ki,zn,_r,ms,Hr,Ur,Pr,Ir,li,zr,qo,oc,fr,mo],pipes:[dr,al],styles:[""]}),t})();const Pie=["dt"],Oie=["menustab"];function Nie(t,i){if(1&t){const e=Ie();f(0,"div",15)(1,"span",16),ee(2,"i",17),f(3,"input",18),L("input",function(r){return z(e),A(2).applyFilterGlobal(r,"contains")}),p()()()}}function Lie(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Rie(t,i){1&t&&(f(0,"th"),_(1,"LocID"),p())}function Bie(t,i){1&t&&(f(0,"th"),_(1,"Location"),p())}function jie(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Lie,2,0,"th",19),f(4,"th"),_(5,"Name"),p(),D(6,Rie,2,0,"th",19),D(7,Bie,2,0,"th",19),f(8,"th"),_(9,"Status"),p(),f(10,"th"),_(11,"Budget (Rs.)"),p(),f(12,"th"),_(13,"Land Cost (Rs.)"),p(),f(14,"th"),_(15,"Commission (Rs.)"),p(),f(16,"th"),_(17,"Taxes (Rs.)"),p(),f(18,"th"),_(19,"Area "),p()()),2&t&&(v(3),T("ngIf",!1),v(3),T("ngIf",!1),v(1),T("ngIf",!1))}function Vie(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Uie(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.loc_id)}}function Hie(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.location)}}function zie(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Vie,2,1,"td",19),f(4,"td",20),L("click",function(){const o=z(e).$implicit;return A(2).toggle(o)}),_(5),p(),D(6,Uie,2,1,"td",19),D(7,Hie,2,1,"td",19),f(8,"td"),_(9),p(),f(10,"td"),_(11),Ne(12,"currency"),p(),f(13,"td"),_(14),Ne(15,"currency"),p(),f(16,"td"),_(17),Ne(18,"currency"),p(),f(19,"td"),_(20),Ne(21,"currency"),p(),f(22,"td"),_(23),p()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.project_name),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(2),U(e.status),v(2),U(He(12,11,e.budget," ","symbol","1.0-0")),v(3),U(He(15,16,e.landcost," ","symbol","1.0-0")),v(3),U(He(18,21,e.commission," ","symbol","1.0-0")),v(3),U(He(21,26,e.taxes," ","symbol","1.0-0")),v(3),U(e.coveredarea)}}function $ie(t,i){1&t&&(f(0,"div",21),_(1,"No data found"),p())}const Wie=function(){return["project_name","client","location","status"]};function qie(t,i){if(1&t&&(f(0,"p-tabPanel",8)(1,"p-table",9,10),D(3,Nie,4,0,"ng-template",11),D(4,jie,20,3,"ng-template",12),D(5,zie,24,31,"ng-template",13),p(),D(6,$ie,2,0,"div",14),p()),2&t){const e=A();v(1),T("value",e.projects)("paginator",!0)("rows",10)("globalFilterFields",rt(5,Wie)),v(5),T("ngIf",e.isProjectsEmpty())}}let tb=(()=>{class t{constructor(e,n){this.proj_Service=e,this._is=n,this.projects=[],this.activeIndex=0,this.projectID=0,this.transactions=[],this.installments=[],this.isDropdownDisabled=!1,this.makeTrRed=!1,this.totalpaid=0,this.remainingamount=0,this.possessionamount=0,this.totaldue=0,this.totalamountsummary=0,this.totalpaidsummary=0,this.totalduesummary=0,this.totalrebatesummary=0}ngOnInit(){this.getPlazaInventory(),this.calculateTotalPaidAndDues()}formatDate(e){const n=new Date(e);return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`}calculateTotalPaidAndDues(){let e=0,n=0,r=0,o=0,c=0;this.totalamountsummary=0,this.totalpaidsummary=0,this.totalduesummary=0,this.totalrebatesummary=0;let u="",m=0;this.transactions.forEach(g=>{"Sold"==g.status&&(this.isDropdownDisabled=!1,this._is.loadInstallmentData(g.id).subscribe({next:x=>{if(0==x.length)return;c=Number(x[0].agreedamount),this.totalamountsummary=this.totalamountsummary+Number(g.cost),u=g.unitno,m=g.id;let S=[],M=0;this.totalpaid=0,x.forEach(B=>{S.push(new Date(Qr(B.paymentdate))),"Installment"==B.payment_type&&(e+=B.amount),"Downpayment"==B.payment_type&&(M+=B.amount),this.totalpaidsummary=this.totalpaidsummary+B.amount}),c-=Number(c*Number(x[0].possessionamount)/100);const E=this.findLargestDate(S);r=E?Lm(new Date,E):0,o=r/3,c-=M,n=0==Math.round(o)?Number(c/x[0].installment):Number(c/x[0].installment)*Math.round(o);let R=Number(x[0].agreedamount)+Number(x[0].rebate);this.totalpaid===R?this.totaldue=0:R-this.totalpaid<n?this.totaldue=R-this.totalpaid:this.totalduesummary=this.totalduesummary+n},error:x=>{console.error(x)}}))})}changePtabIndex(e){this.remainingamount=0,this.installments=[],this.remainingamount=0,this.possessionamount=0,this.clientid="",this.shopData=e,this.unit=e.unitno,this.floor=e.floor,this.area=e.area,this.scheme=e.project_name,this.cost=e.cost,this.name="",this.cnic="",this.contact="",this.address="",this.totaldue=e.totaldue,this.totalpaid=0,3==e.statusid?(this.totaldue=e.totaldue,this.isDropdownDisabled=!0,this.shopid=e.id,this.loadInstallmentData(e.id)):(this.clientComponent.clearAll(e.statusid),this.isDropdownDisabled=!1),this.activeIndex=1}loadInstallmentData(e){this.installments=[],this.clientid="",this.totalpaid=0;let n=0,r=0,o=0,c=0,u=0,m=0;this._is.loadInstallmentData(e).subscribe({next:g=>{if(this.installments=g,this.installments.forEach(B=>{this.totalpaid=this.totalpaid+B.amount}),0==g.length)return;this.loadClientData(g[0].clientid),this.clientid=g[0].clientid,m=Number(g[0].agreedamount);let x,M,S=[];g.forEach(B=>{S.push(new Date(Qr(B.paymentdate))),"Installment"==B.payment_type&&(n+=B.amount),"Downpayment"==B.payment_type&&(r+=B.amount,x=new Date(Qr(B.paymentdate)))}),c=Lm(new Date,x),console.log("Actual Amount: "+m+" Downpayment: "+r+" Rebate: "+g[0].rebate+" Months: "+c);const E=this.findLargestDate(S);M=E?Lm(new Date,E):0,u=c/3,this.possessionamount=Number(m*Number(g[0].possessionamount)/100),m-=r,m-=Number((m+r)*Number(g[0].possessionamount)/100),o=0==Math.round(u)?Number(m/g[0].installment):Number(m/g[0].installment)*Math.round(u);let R=Number(g[0].agreedamount);console.log("Paid: "+this.totalpaid+" Due: "+o+" Total Recievable: "+R),this.totaldue=this.totalpaid===R?0:o-n,this.remainingamount=R-this.totalpaid},error:g=>{console.error(g)}})}findLargestDate(e){if(0===e.length)return null;let n=e[0];for(let r=1;r<e.length;r++)e[r]>n&&(n=e[r]);return n}monthsBetweenDates(e,n){const r=new Date(e),o=new Date(n);return 12*(o.getFullYear()-r.getFullYear())+(o.getMonth()-r.getMonth())}loadClientData(e){this._is.getClientInfo(e).subscribe({next:n=>{this.name=n[0].name,this.cnic=n[0].cnic,this.contact=n[0].contact,this.address=n[0].address},error:n=>{console.error(n)}})}getProjects(e){this.proj_Service.getProjects(e).subscribe({next:n=>{this.projects=n,this.selectedProject=this.projects[0]},error:n=>{console.error(n)}})}toggle(e){this.menustab.disabled=!1,this.projectID=e.id,this.getPlazaInventory(),this.activeIndex=1}reloadInventory(){console.log("Inventory reloaded...."),this.getPlazaInventory()}getPlazaInventory(){this.totalpaid=0,this._is.getPlazaInventory(this.projectID).subscribe({next:e=>{e.forEach(n=>{n.downpayment=Number(n.cost)*(Number(n.downpayment)/100),n.possessionAmount=Number(n.cost)*(Number(n.possessionAmount)/100),n.installment=(Number(n.cost)-(Number(n.downpayment)+Number(n.possessionAmount)))/Number(n.installment)}),this.transactions=e,this.calculateTotalPaidAndDues(),this.childComponent.changeRowColor(this.transactions)},error:e=>{console.error(e)}})}isProjectsEmpty(){return 0===this.projects.length}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}}return t.\u0275fac=function(e){return new(e||t)(te(ll),te(eS))},t.\u0275cmp=dn({type:t,selectors:[["app-inventory"]],viewQuery:function(e,n){if(1&e&&(Mt(Pie,5),Mt(Oie,5),Mt(N7,5),Mt(B7,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.menustab=r.first),xt(r=wt())&&(n.childComponent=r.first),xt(r=wt())&&(n.clientComponent=r.first)}},inputs:{projectID:"projectID"},decls:8,vars:29,consts:[[3,"activeIndex","activeIndexChange"],["tabView",""],["header","Commercial Projects",4,"ngIf"],["header","Inventory",3,"disabled"],["menustab",""],[3,"projectID","transactions","activeIndex","makeTrRed","totalamountsummary","totalpaidsummary","totalduesummary","totalrebatesummary","ptabIndexChanged"],["header","Installment Details",3,"disabled"],[3,"shopData","unit","floor","area","scheme","cost","isDropDownDisabled","installments","name","selectedClient","cnic","contact","address","totalpaid","totaldue","remainingamount","possessionamount","updateInventory"],["header","Commercial Projects"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[4,"ngIf"],[1,"list-item",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"p-tabView",0,1),L("activeIndexChange",function(o){return n.activeIndex=o}),D(2,qie,7,6,"p-tabPanel",2),f(3,"p-tabPanel",3,4)(5,"app-plazainventory",5),L("ptabIndexChanged",function(o){return n.changePtabIndex(o)}),p()(),f(6,"p-tabPanel",6)(7,"app-clientscombo",7),L("updateInventory",function(){return n.reloadInventory()}),p()()()),2&e&&(T("activeIndex",n.activeIndex),v(2),T("ngIf",!1),v(1),T("disabled",!1),v(2),T("projectID",n.projectID)("transactions",n.transactions)("activeIndex",n.activeIndex)("makeTrRed",n.makeTrRed)("totalamountsummary",n.totalamountsummary)("totalpaidsummary",n.totalpaidsummary)("totalduesummary",n.totalduesummary)("totalrebatesummary",n.totalrebatesummary),v(1),T("disabled",!0),v(1),T("shopData",n.shopData)("unit",n.unit)("floor",n.floor)("area",n.area)("scheme",n.scheme)("cost",n.cost)("isDropDownDisabled",n.isDropdownDisabled)("installments",n.installments)("name",n.name)("selectedClient",n.clientid)("cnic",n.cnic)("contact",n.contact)("address",n.address)("totalpaid",n.totalpaid)("totaldue",n.totaldue)("remainingamount",n.remainingamount)("possessionamount",n.possessionamount))},styles:[".list-item[_ngcontent-%COMP%]:hover{cursor:pointer}.red-cell[_ngcontent-%COMP%]{background-color:red;color:#fff}"]}),t})();const Gie=["dt"];function Kie(t,i){1&t&&(f(0,"small",9),_(1," Year is required. "),p())}function Yie(t,i){if(1&t){const e=Ie();f(0,"div",10)(1,"button",11),L("click",function(){z(e);const r=A();return r.addYear(r.yearForm)}),ee(2,"i",12),_(3," Save "),p(),f(4,"button",13),L("click",function(){return z(e),A().closeModal()}),ee(5,"i",14),_(6," Cancel "),p()()}if(2&t){const e=A();v(1),T("disabled",e.yearForm.invalid)}}const Xie=function(){return{width:"20vw"}};let Qie=(()=>{class t{constructor(e,n){this._ms=e,this._nr=n,this.displayAddAccountModal=!1,this.clickClose=new Et,this.clickAdd=new Et}ngOnInit(){null==this.recordedyear&&(this.recordedyear={id:"",year:""}),this.yearForm=new Zn({id:new Me(""),year:new Me("",jt.required)})}closeModal(){this.clickClose.emit(!0)}hideAddAccountModal(e){this.displayAddAccountModal=!e}addYear(e){this.recordedyear.id&&(e.value.id=this.recordedyear.id,this._nr.updateYear(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Year is updated successfully."}),this.clickAdd.emit(n),this.yearForm.reset(),this.closeModal()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while updating year.",life:3e3})}}))}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(Su))},t.\u0275cmp=dn({type:t,selectors:[["app-edityear"]],viewQuery:function(e,n){if(1&e&&Mt(Gie,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{displayAddAccountModal:"displayAddAccountModal",recordedyear:"recordedyear"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd"},decls:10,vars:11,consts:[["header","Update Year",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[3,"formGroup"],[1,"p-fluid","grid","formgrid"],[1,"field","col-12","md:col-4"],["for","title"],["pInputText","","type","text","id","year","name","year","formControlName","year",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],["pTemplate","footer"],["position","bottom-right"],[1,"p-error","block"],[1,"project-btn-group","project-btn-group--center"],["icon","pi pi-check","type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["icon","pi pi-times","type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-circle"]],template:function(e,n){1&e&&(f(0,"p-dialog",0),L("visibleChange",function(o){return n.displayAddAccountModal=o})("onHide",function(){return n.closeModal()}),f(1,"form",1)(2,"div",2)(3,"div",3)(4,"label",4),_(5,"Title"),p(),f(6,"input",5),L("ngModelChange",function(o){return n.recordedyear.year=o}),p(),D(7,Kie,2,0,"small",6),p()()(),D(8,Yie,7,1,"ng-template",7),p(),ee(9,"p-toast",8)),2&e&&(Ft(rt(10,Xie)),T("visible",n.displayAddAccountModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("formGroup",n.yearForm),v(5),T("ngModel",n.recordedyear.year),v(1),T("ngIf",n.yearForm.controls.year.invalid&&n.yearForm.controls.year.dirty))},directives:[ms,Hr,Ur,Pr,Ir,li,Er,zr,Sn,zn,fr],styles:[""]}),t})();const Jie=["dt"];function Zie(t,i){1&t&&(f(0,"small",23),_(1," Date is required. "),p())}function ere(t,i){if(1&t){const e=Ie();f(0,"div",2)(1,"div",3)(2,"label",24),_(3,"Profit/Loss"),p(),f(4,"input",25),L("ngModelChange",function(r){return z(e),A().transaction.profit=r})("input",function(){return z(e),A().onTextBoxProfit()}),p()()()}if(2&t){const e=A();v(4),T("ngModel",e.transaction.profit)}}function tre(t,i){1&t&&(f(0,"small",23),_(1," Transaction type is required. "),p())}function nre(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function ire(t,i){1&t&&(f(0,"th"),_(1,"Profit"),p())}function rre(t,i){1&t&&(f(0,"th"),_(1,"Status"),p())}function ore(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,nre,2,0,"th",19),f(4,"th"),_(5,"Date"),p(),f(6,"th"),_(7,"Debit"),p(),f(8,"th"),_(9,"Credit"),p(),D(10,ire,2,0,"th",19),D(11,rre,2,0,"th",19),f(12,"th"),_(13,"Balance"),p(),f(14,"th"),_(15,"Remarks"),p(),f(16,"th"),_(17,"Action"),p()()),2&t&&(v(3),T("ngIf",!1),v(7),T("ngIf",!1),v(1),T("ngIf",!1))}function sre(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function are(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.totalamount," ","symbol","1.0-0"))}}function lre(t,i){1&t&&ee(0,"td")}function cre(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.totalamount," ","symbol","1.0-0"))}}function ure(t,i){1&t&&ee(0,"td")}function dre(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.profit," ","symbol","1.0-0"))}}function fre(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.status)}}function pre(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,sre,2,1,"td",19),f(4,"td"),_(5),Ne(6,"date"),p(),D(7,are,3,6,"td",19),D(8,lre,1,0,"td",19),D(9,cre,3,6,"td",19),D(10,ure,1,0,"td",19),D(11,dre,3,6,"td",19),D(12,fre,2,1,"td",19),f(13,"td"),_(14),Ne(15,"currency"),p(),f(16,"td"),_(17),p(),f(18,"td"),_(19," \xa0"),f(20,"button",31),L("click",function(){const r=z(e),o=r.$implicit,c=r.rowIndex;return A(2).deleteTransaction(o,c)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(Oa(6,11,e.transactiondate,"dd-MM-yyyy")),v(2),T("ngIf","DB"===e.status),v(1),T("ngIf","DB"!==e.status),v(1),T("ngIf","CR"===e.status),v(1),T("ngIf","CR"!==e.status),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(2),U(He(15,14,e.balance," ","symbol","1.0-0")),v(3),U(e.remarks)}}function hre(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A(3);v(1),hn(" ",He(2,1,e.total_amount," ","symbol","1.0-0"),"")}}function mre(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A(3);v(1),hn(" ",He(2,1,e.total_profit," ","symbol","1.0-0"),"")}}function gre(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td")(2,"td")(3,"td"),D(4,hre,3,6,"td",19),ee(5,"td"),D(6,mre,3,6,"td",19),ee(7,"td")(8,"td"),f(9,"td")(10,"div",32)(11,"button",33),L("click",function(){return z(e),A(2).exportTableToExcel()}),_(12,"Excel"),p(),f(13,"button",33),L("click",function(){return z(e),A(2).exportTableToPdf()}),_(14,"Pdf"),p()()()()}2&t&&(v(4),T("ngIf",!1),v(2),T("ngIf",!1))}function _re(t,i){if(1&t&&(f(0,"div")(1,"p-table",26,27),D(3,ore,18,3,"ng-template",28),D(4,pre,21,19,"ng-template",29),D(5,gre,15,2,"ng-template",30),p(),f(6,"p")(7,"b"),_(8),Ne(9,"currency"),p()()()),2&t){const e=A();v(1),T("value",e.transactions)("paginator",!0)("rows",10),v(7),hn("Balance: ",He(9,4,e.transactions[e.transactions.length-1].balance," ","symbol","1.0-0"),"")}}function vre(t,i){1&t&&(f(0,"div",34),_(1,"No data found"),p())}const yre=function(){return{width:"400px"}},bre=function(){return{width:"240px"}},xre=function(){return{width:"450px"}};let wre=(()=>{class t{constructor(e,n,r,o,c){this._ms=e,this._invtr=n,this.confirmationService=r,this.pdfserv=o,this.exptoexcel=c,this.transactions=[],this.year="",this.yearID=0,this.total_amount=0,this.total_profit=0,this.disableAmount=!1,this.disableProfit=!1,this.headerData=["Date","Debit","Credit","Balance","Remarks"],this.types=[{name:"Credit",code:"CR"},{name:"Debit",code:"DB"}]}ngOnInit(){this.transaction={id:"",totalamount:"",profit:"",remarks:"",status:""},this.transactionForm=new Zn({id:new Me(""),year:new Me(""),totalamount:new Me(""),profit:new Me(""),status:new Me(""),remarks:new Me(""),transactiondate:new Me("",jt.required)})}getNovitaTransaction(){this.total_amount=0,this.total_profit=0,this._invtr.getNovitaTransaction(this.yearID.toString()).subscribe({next:e=>{e.forEach(n=>{"CR"==n.status?(this.total_amount=Number(this.total_amount)+Number(n.totalamount),this.total_profit=Number(this.total_profit)+Number(n.profit)):"DB"==n.status&&(this.total_amount=Number(this.total_amount)-Number(n.totalamount),this.total_profit=Number(this.total_profit)-Number(n.profit))}),this.transactions=e},error:e=>{console.error(e)}})}onTextBoxAmount(){let e=this.transactionForm.get("totalamount"),n=this.transactionForm.get("profit");null==e.value?n.enable():""!==e.value&&(n.disable(),this.transactionForm.value.profit=null)}onTextBoxProfit(){let e=this.transactionForm.get("totalamount"),n=this.transactionForm.get("profit");null==n.value?e.enable():""!==n.value&&(e.disable(),this.transactionForm.value.totalamount=null)}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}isTransactionEmpty(){return 0===this.transactions.length}updateTransaction(e){this.transaction=Object.assign({},e),this.obj_date=new Date(this.transaction.transactiondate)}deleteTransaction(e,n){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._invtr.deleteNovitaTransaction(e.id).subscribe({next:r=>{this._ms.add({severity:"success",summary:"Successful",detail:"Investor transaction deleted successfully.",life:3e3}),this.getNovitaTransaction(),this.transactionForm.reset()},error:r=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting investor transaction.",life:3e3})}})}})}resetForm(){this.transactionForm.reset(),this.getNovitaTransaction()}addNovitaTransaction(e){let n=this.transactionForm.get("totalamount"),r=this.transactionForm.get("profit");if(this.transaction.id){if(""==this.transactionForm.value.totalamount||""==this.transactionForm.value.profit)return void this._ms.add({severity:"error",summary:"Error",detail:"Transaction amount missing."});if("0"==this.transactionForm.value.totalamount&&"0"==this.transactionForm.value.profit)return void this._ms.add({severity:"error",summary:"Error",detail:"Invalid transaction amount."});this.transactionForm.value.id=this.transaction.id,this._invtr.updateNovitaTransaction(this.transactionForm).subscribe({next:o=>{this._ms.add({severity:"success",summary:"Success",detail:"Transaction updated successfully."}),this.getNovitaTransaction(),this.transactionForm.reset()},error:o=>{this._ms.add(409==o.status?{severity:"error",summary:"Error",detail:o.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating transaction."})}})}else{if(""==this.transactionForm.value.totalamount&&""==this.transactionForm.value.profit)return void this._ms.add({severity:"error",summary:"Error",detail:"Transaction amount missing."});this.transactionForm.value.year=this.yearID,n.disabled?this.transactionForm.value.totalamount="":r.disabled&&(this.transactionForm.value.profit=""),this._invtr.addNovitaTransaction(this.transactionForm).subscribe({next:o=>{this._ms.add({severity:"success",summary:"Success",detail:"Transaction added successfully."}),this.getNovitaTransaction(),this.transactionForm.reset(),n.enable(),r.enable()},error:o=>{409==o.status?(this._ms.add({severity:"error",summary:"Error",detail:o.error.message}),n.enable(),r.enable()):(this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while saving transaction."}),n.enable(),r.enable())}})}}deleteNovitaTransaction(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._invtr.deleteNovitaTransaction(e.value.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Transaction deleted successfully.",life:3e3}),this.getNovitaTransaction()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting transaction.",life:3e3})}})}})}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],"Novita_Transactions_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"Novita_Transactions_"+ui())}toExcelFormat(){let e=[],n="",r="";e.push(this.headerData);for(var o=0;o<this.transactions.length;o++)"DB"==this.transactions[o].status&&(n=this.transactions[o].totalamount.toLocaleString(),r=""),"CR"==this.transactions[o].status&&(n="",r=this.transactions[o].totalamount.toLocaleString()),e.push([Qr(this.transactions[o].transactiondate),n,r,this.transactions[o].balance,this.transactions[o].remarks]);return e}toPdfFormat(){let e=[],n="",r="";for(var o=0;o<this.transactions.length;o++)"DB"==this.transactions[o].status&&(n=this.transactions[o].totalamount.toLocaleString(),r=""),"CR"==this.transactions[o].status&&(n="",r=this.transactions[o].totalamount.toLocaleString()),e.push([Qr(this.transactions[o].transactiondate),n,r,this.transactions[o].balance,this.transactions[o].remarks]);return e}toPdfFooterFormat(){let e=[],n=this.transactions[this.transactions.length-1].balance.toLocaleString();return e.push(["Balance:"+n,"","","",""]),e}toExcelFooterFormat(e){let n=this.transactions[this.transactions.length-1].balance.toLocaleString();return e.push(["","","","",""]),e.push(["Balance:",n,"","",""]),e}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(Su),te(Un),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-novitatransactions"]],viewQuery:function(e,n){if(1&e&&Mt(Jie,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{transactions:"transactions",year:"year",yearID:"yearID",total_amount:"total_amount",total_profit:"total_profit"},features:[Nn([kn,Un])],decls:39,vars:22,consts:[[3,"formGroup"],[1,"row"],[1,"col-lg-3","col-md-3","col-sm-3"],[1,"form-group"],[2,"margin-right","10px"],["id","transactiondate","name","transactiondate","formControlName","transactiondate","classs","form-control","dateFormat","dd-mm-yy",3,"ngModel","inputStyle","ngModelChange"],["class","p-error block",4,"ngIf"],["for","totalamount",2,"margin-right","10px"],["pInputText","","type","number","id","totalamount","name","totalamount","formControlName","totalamount","min","1",1,"form-control",3,"ngModel","ngModelChange","input"],["class","col-lg-3 col-md-3 col-sm-3",4,"ngIf"],["for","status",2,"margin-right","10px"],["optionLabel","name","optionValue","code","formControlName","status",3,"options","ngModel","ngModelChange"],["for","remarks",2,"margin-right","10px"],["pInputText","","type","text","id","remarks","name","remarks","formControlName","remarks",1,"form-control",3,"ngModel","ngModelChange"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["type","button",1,"btn-project",3,"click"],[1,"bi","bi-arrow-counterclockwise"],[4,"ngIf"],["style","text-align: center;",4,"ngIf"],["position","bottom-right"],["acceptButtonStyleClass","btn-project","rejectButtonStyleClass","btn-project","acceptLabel","Yes","rejectLabel","No"],[1,"p-error","block"],["for","profit",2,"margin-right","10px"],["pInputText","","type","number","id","profit","name","profit","formControlName","profit","min","1",1,"form-control",3,"ngModel","ngModelChange","input"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[1,"project-btn-group","project-btn-group--right"],[1,"btn-project","btn-sm",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),_(5,"Date"),p(),f(6,"p-calendar",5),L("ngModelChange",function(o){return n.obj_date=o})("ngModelChange",function(o){return n.obj_date=o}),p(),D(7,Zie,2,0,"small",6),p()(),f(8,"div",2)(9,"div",3)(10,"label",7),_(11,"Amount"),p(),f(12,"input",8),L("ngModelChange",function(o){return n.transaction.totalamount=o})("input",function(){return n.onTextBoxAmount()}),p()()(),D(13,ere,5,1,"div",9),f(14,"div",2)(15,"div",3)(16,"label",10),_(17,"Status"),p(),f(18,"p-dropdown",11),L("ngModelChange",function(o){return n.transaction.status=o}),p(),D(19,tre,2,0,"small",6),p()(),f(20,"div",2)(21,"div",3)(22,"label",12),_(23,"Remarks"),p(),f(24,"input",13),L("ngModelChange",function(o){return n.transaction.remarks=o}),p()()()(),f(25,"div",14)(26,"button",15),L("click",function(){return n.addNovitaTransaction(n.transactionForm)}),ee(27,"i",16),_(28," Save "),p(),f(29,"button",17),L("click",function(){return n.resetForm()}),ee(30,"i",18),_(31," Clear "),p()()(),ee(32,"hr"),f(33,"p"),_(34),p(),D(35,_re,10,9,"div",19),D(36,vre,2,0,"div",20),ee(37,"p-toast",21)(38,"p-confirmDialog",22)),2&e&&(T("formGroup",n.transactionForm),v(6),T("ngModel",n.obj_date)("inputStyle",rt(19,yre))("ngModel",n.obj_date),v(1),T("ngIf",n.transactionForm.controls.transactiondate.invalid&&n.transactionForm.controls.transactiondate.dirty),v(5),T("ngModel",n.transaction.totalamount),v(1),T("ngIf",!1),v(5),Ft(rt(20,bre)),T("options",n.types)("ngModel",n.transaction.status),v(1),T("ngIf",n.transactionForm.controls.status.invalid&&n.transactionForm.controls.status.dirty),v(5),T("ngModel",n.transaction.remarks),v(2),T("disabled",n.transactionForm.invalid),v(8),hn("Year: \xa0\xa0",n.year,""),v(1),T("ngIf",n.transactions.length>0),v(1),T("ngIf",n.isTransactionEmpty()),v(2),Ft(rt(21,xre)))},directives:[Hr,Ur,Pr,oc,Er,zr,Sn,qo,P0,Ir,li,us,ki,zn,_r,fr,mo],pipes:[al,dr],styles:[""]}),t})();const Cre=["dt"];function Tre(t,i){1&t&&(f(0,"small",23),_(1," Description is required. "),p())}function Sre(t,i){1&t&&(f(0,"small",23),_(1," Amount is required. "),p())}function Ere(t,i){if(1&t){const e=Ie();f(0,"div",24)(1,"span",25),ee(2,"i",26),f(3,"input",27),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function kre(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Dre(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,kre,2,0,"th",28),f(4,"th"),_(5,"Description"),p(),f(6,"th"),_(7,"Total Amount"),p(),f(8,"th"),_(9,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Ire(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Are(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Ire,2,1,"td",28),f(4,"td"),_(5),p(),f(6,"td"),_(7),Ne(8,"currency"),p(),f(9,"td"),_(10," \xa0"),f(11,"button",29),L("click",function(){const r=z(e),o=r.$implicit,c=r.rowIndex;return A().deleteNovitaInvestment(o,c)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.remarks),v(2),U(He(8,4,e.totalamount," ","symbol","1.0-0"))}}function Mre(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td"),f(2,"td"),_(3,"Total Invested:"),p(),f(4,"td"),_(5),Ne(6,"currency"),p()(),f(7,"tr"),ee(8,"td"),f(9,"td"),_(10,"Net:"),p(),f(11,"td"),_(12),Ne(13,"currency"),p()(),f(14,"tr"),ee(15,"td"),f(16,"td"),_(17,"Remaining:"),p(),f(18,"td"),_(19),p()(),f(20,"tr"),ee(21,"td")(22,"td"),f(23,"td")(24,"div",30)(25,"button",31),L("click",function(){return z(e),A().exportTableToExcel()}),_(26,"Excel"),p(),f(27,"button",31),L("click",function(){return z(e),A().exportTableToPdf()}),_(28,"Pdf"),p()()()()}if(2&t){const e=A();v(5),U(He(6,3,e.total_investedamount," ","symbol","1.0-0")),v(7),U(He(13,8,e.total_investment," ","symbol","1.0-0")),v(7),U(e.rem_amount)}}function Fre(t,i){1&t&&(f(0,"div",32),_(1,"No data found"),p())}const Pre=function(){return["remarks"]},Ore=function(){return{width:"450px"}};let Nre=(()=>{class t{constructor(e,n,r,o,c){this._ms=e,this._invtr=n,this.confirmationService=r,this.pdfserv=o,this.exptoexcel=c,this.investment_transactions=[],this.total_investedamount=0,this.total_amount=0,this.total_profit=0,this.rem_amount=0,this.total_investment=0,this.headerData=["Description","Total Amount"],this.transactionForm=new Zn({id:new Me(""),year:new Me(""),totalamount:new Me("",jt.required),remarks:new Me("",jt.required)}),this.transaction={id:"",totalamount:"",remarks:""}}ngOnInit(){this.getNovitaInvestment()}getNovitaTotalExpenses(){let e=0,n=0;n=this.total_amount+this.total_profit,this._invtr.getNovitaTotalExpenses(this.yearID).subscribe({next:r=>{r.forEach(o=>{e=Number(e)+Number(o.amount),n-=e})},error:r=>{console.error(r)}}),this.total_investment=n,console.log("in getNovitaTotalExpenses "+this.total_investment)}getNovitaInvestment(){this.total_investedamount=0,this._invtr.getNovitaInvestment(this.yearID).subscribe({next:e=>{e.forEach(n=>{this.total_investedamount=Number(this.total_investedamount)+Number(n.totalamount)}),this.rem_amount=Number(this.total_investment)-Number(this.total_investedamount),this.investment_transactions=e},error:e=>{console.error(e)}})}isNovitaInvestmentEmpty(){return 0===this.investment_transactions.length}getNovitaTransaction(){this.total_amount=0,this.total_profit=0,this._invtr.getNovitaTransaction(this.yearID.toString()).subscribe({next:e=>{e.forEach(n=>{"CR"==n.status?(this.total_amount=Number(this.total_amount)+Number(n.totalamount),this.total_profit=Number(this.total_profit)+Number(n.profit)):"DB"==n.status&&(this.total_amount=Number(this.total_amount)-Number(n.totalamount))}),this.investment_transactions=e,console.log("this.total_amount  "+this.total_amount+" this.total_profit "+this.total_profit),this.getNovitaTotalExpenses()},error:e=>{console.error(e)}})}addNovitaInvestment(e){this.transactionForm.value.year=this.yearID,this._invtr.addNovitaInvestment(this.transactionForm).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"NOVITA investment added successfully."}),this.getNovitaInvestment(),this.transactionForm.reset()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while saving NOVITA investment."})}})}deleteNovitaInvestment(e,n){this.confirmationService.confirm({message:"Are you sure you want to delete this record ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._invtr.deleteNovitaInvestment(e.id).subscribe({next:r=>{this._ms.add({severity:"success",summary:"Successful",detail:"NOVITA investment deleted successfully.",life:3e3}),this.getNovitaInvestment(),this.transactionForm.reset()},error:r=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting NOVITA investment.",life:3e3})}})}})}resetForm(){this.transactionForm.reset()}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}isTransactionEmpty(){return 0===this.investment_transactions.length}exportTableToExcel(){const e=this.toExcelFormat(),n=this.toExcelFooterFormat();this.exptoexcel.exportExcel(e,this.headerData,n,"NOVITA_Investment_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"NOVITA_Investment_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.investment_transactions.length;n++)e.push([this.investment_transactions[n].remarks,this.investment_transactions[n].totalamount.toLocaleString()]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.investment_transactions.length;n++)e.push([this.investment_transactions[n].remarks,this.investment_transactions[n].totalamount.toLocaleString()]);return e}toPdfFooterFormat(){let e=[];return e.push(["Total Invested",this.total_investedamount.toLocaleString()]),e.push(["Net",this.total_investment.toLocaleString()]),e.push(["Remaining",this.rem_amount.toLocaleString()]),e}toExcelFooterFormat(){let e=[];return e.push(["Total Invested",this.total_investedamount.toLocaleString()]),e.push(["Net",this.total_investment.toLocaleString()]),e.push(["Remaining",this.rem_amount.toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(Su),te(Un),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-novitabreakdown"]],viewQuery:function(e,n){if(1&e&&Mt(Cre,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{yearID:"yearID",investment_transactions:"investment_transactions",total_investedamount:"total_investedamount",rem_amount:"rem_amount",total_investment:"total_investment"},features:[Nn([kn,Un])],decls:31,vars:15,consts:[[3,"formGroup"],[1,"row"],[1,"col-lg-3","col-md-3","col-sm-3"],[1,"form-group"],["for","remarks",2,"margin-right","10px"],["pInputText","","type","text","id","remarks","name","remarks","formControlName","remarks",1,"form-control",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],["for","totalamount",2,"margin-right","10px"],["pInputText","","type","number","id","totalamount","name","totalamount","formControlName","totalamount",1,"form-control",3,"ngModel","ngModelChange"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["type","button",1,"btn-project",3,"click"],[1,"bi","bi-arrow-counterclockwise"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],["position","bottom-right"],["acceptButtonStyleClass","btn-project","rejectButtonStyleClass","btn-project","acceptLabel","Yes","rejectLabel","No"],[1,"p-error","block"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[4,"ngIf"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[1,"project-btn-group","project-btn-group--right"],[1,"btn-project","btn-sm",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),_(5,"Description"),p(),f(6,"input",5),L("ngModelChange",function(o){return n.transaction.remarks=o}),p(),D(7,Tre,2,0,"small",6),p()(),f(8,"div",2)(9,"div",3)(10,"label",7),_(11,"Amount"),p(),f(12,"input",8),L("ngModelChange",function(o){return n.transaction.totalamount=o}),p(),D(13,Sre,2,0,"small",6),p()()(),f(14,"div",9)(15,"button",10),L("click",function(){return n.addNovitaInvestment(n.transactionForm)}),ee(16,"i",11),_(17," Save "),p(),f(18,"button",12),L("click",function(){return n.resetForm()}),ee(19,"i",13),_(20," Clear "),p()()(),ee(21,"hr"),f(22,"p-table",14,15),D(24,Ere,4,0,"ng-template",16),D(25,Dre,10,1,"ng-template",17),D(26,Are,12,9,"ng-template",18),D(27,Mre,29,13,"ng-template",19),p(),D(28,Fre,2,0,"div",20),ee(29,"p-toast",21)(30,"p-confirmDialog",22)),2&e&&(T("formGroup",n.transactionForm),v(6),T("ngModel",n.transaction.remarks),v(1),T("ngIf",n.transactionForm.controls.remarks.invalid&&n.transactionForm.controls.remarks.dirty),v(5),T("ngModel",n.transaction.totalamount),v(1),T("ngIf",n.transactionForm.controls.totalamount.invalid&&n.transactionForm.controls.totalamount.dirty),v(2),T("disabled",n.transactionForm.invalid),v(7),T("value",n.investment_transactions)("paginator",!0)("rows",10)("globalFilterFields",rt(13,Pre)),v(6),T("ngIf",n.isNovitaInvestmentEmpty()),v(2),Ft(rt(14,Ore)))},directives:[Hr,Ur,Pr,Ir,li,Er,zr,Sn,qo,ki,zn,_r,fr,mo],pipes:[dr],styles:[""]}),t})();const Lre=["dt"],Rre=["dtexpensetypes"];function Bre(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedExpensetype)}}function jre(t,i){1&t&&D(0,Bre,3,1,"div",29),2&t&&T("ngIf",A().selectedExpensetype)}function Vre(t,i){if(1&t&&(f(0,"div",30)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.type)}}function Ure(t,i){1&t&&(f(0,"small",31),_(1," Expense is required."),p())}function Hre(t,i){1&t&&(f(0,"small",31),_(1," Amount is required. "),p())}function zre(t,i){1&t&&(f(0,"small",31),_(1," Date is required."),p())}function $re(t,i){if(1&t){const e=Ie();f(0,"div",32)(1,"span",33),ee(2,"i",34),f(3,"input",35),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function Wre(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function qre(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Wre,2,0,"th",29),f(4,"th"),_(5,"Date"),p(),f(6,"th"),_(7,"Description"),p(),f(8,"th"),_(9,"Amount"),p(),f(10,"th"),_(11,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Gre(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Kre(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.amount," ","symbol","1.0-0"))}}function Yre(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Gre,2,1,"td",29),f(4,"td"),_(5),Ne(6,"date"),p(),f(7,"td"),_(8),p(),D(9,Kre,3,6,"td",29),f(10,"td"),_(11," \xa0"),f(12,"button",36),L("click",function(){const r=z(e),o=r.$implicit,c=r.rowIndex;return A().deleteNovitaExpense(o,c)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex,r=A();v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(Oa(6,5,e.expdate,"dd-MM-yyyy")),v(3),U(e.expense),v(1),T("ngIf",0!==r.transaction.profit)}}function Xre(t,i){if(1&t&&(f(0,"tr"),ee(1,"td")(2,"td"),f(3,"td"),_(4,"Total:"),p(),f(5,"td"),_(6),Ne(7,"currency"),p()()),2&t){const e=A();v(6),U(He(7,1,e.total_amount," ","symbol","1.0-0"))}}function Qre(t,i){1&t&&(f(0,"div",37),_(1,"No data found"),p())}function Jre(t,i){1&t&&(f(0,"small",31),_(1," Type is required. "),p())}function Zre(t,i){if(1&t){const e=Ie();f(0,"div",32)(1,"span",33),ee(2,"i",34),f(3,"input",35),L("input",function(r){return z(e),A(2).applyFilterGlobalExpensetype(r,"contains")}),p()()()}}function eoe(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function toe(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,eoe,2,0,"th",29),f(4,"th"),_(5,"Type"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function noe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function ioe(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,noe,2,1,"td",29),f(4,"td"),_(5),p(),f(6,"td")(7,"button",44),L("click",function(){const o=z(e).$implicit;return A(2).updateExpensetype(o)}),p(),_(8," \xa0"),f(9,"button",36),L("click",function(){const o=z(e).$implicit;return A(2).deleteExpensetype(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.type)}}function roe(t,i){1&t&&(f(0,"div",37),_(1,"No data found"),p())}const ooe=function(){return["type"]};function soe(t,i){if(1&t){const e=Ie();f(0,"form",0)(1,"div",38)(2,"label",39),_(3,"Expense Type"),p(),f(4,"input",40),L("ngModelChange",function(r){return z(e),A().expense.type=r}),p(),D(5,Jre,2,0,"small",9),p()(),f(6,"div",41)(7,"button",14),L("click",function(){z(e);const r=A();return r.saveExpenseType(r.expenseForm)}),ee(8,"i",15),_(9," Save "),p(),f(10,"button",16),L("click",function(){return z(e),A().hideExpenseTypeDialog()}),ee(11,"i",42),_(12," Cancel "),p()(),ee(13,"hr"),f(14,"p-table",18,43),D(16,Zre,4,0,"ng-template",20),D(17,toe,8,1,"ng-template",21),D(18,ioe,10,3,"ng-template",22),p(),D(19,roe,2,0,"div",24)}if(2&t){const e=A();T("formGroup",e.expenseForm),v(4),T("ngModel",e.expense.type),v(1),T("ngIf",e.expenseForm.controls.type.invalid&&e.expenseForm.controls.type.dirty),v(2),T("disabled",e.expenseForm.invalid),v(7),T("value",e.expensetypes)("paginator",!0)("rows",10)("globalFilterFields",rt(9,ooe)),v(5),T("ngIf",e.isExpenseTypeEmpty())}}const aoe=function(){return{width:"180px"}},loe=function(){return["expense"]},coe=function(){return{width:"700px"}},uoe=function(){return{width:"450px"}};let doe=(()=>{class t{constructor(e,n,r){this._ms=e,this._invtr=n,this.confirmationService=r,this.expensetransactions=[],this.total_amount=0,this.categoryid=0,this.rem_amount=0,this.total_investment=0,this.yearID=0,this.addExpenseTypeDialog=!1}ngOnInit(){this.transactionForm=new Zn({id:new Me(""),year:new Me(""),category:new Me(""),expense:new Me("",jt.required),totalamount:new Me("",jt.required),transactiondate:new Me("",jt.required),branchoffice:new Me("")}),this.transaction={id:"",totalamount:"",expense:"",transactiondate:"",category:"",branchoffice:""},this.expenseForm=new Zn({id:new Me(""),type:new Me("",jt.required)}),this.expense={id:"",type:""},this.getExpenseTypes()}getExpenseTypes(){this._invtr.getExpenseTypes().subscribe(e=>{this.expensetypes=e},e=>{console.log(e)})}deleteExpensetype(e){this.expense=Object.assign({},e),this.expense.type="",this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._invtr.deleteExpenseType(this.expense.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Expense deleted successfully.",life:3e3}),this.getExpenseTypes()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting expense.",life:3e3})}})}})}updateExpensetype(e){this.expense=Object.assign({},e)}hideExpenseTypeDialog(){this.addExpenseTypeDialog=!1}applyFilterGlobalExpensetype(e,n){this.dtexpensetypes.filterGlobal(e.target.value,n)}isExpenseTypeEmpty(){return 0===this.expensetransactions.length}newExpense(){this.expense={},this.addExpenseTypeDialog=!0}saveExpenseType(e){this.expense.id?(this.expenseForm.value.id=this.expense.id,this._invtr.updateExpenseType(this.expenseForm.value.id,this.expenseForm.value.type).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Expense type is updated succesfully.",life:3e3}),this.expenseForm.reset(),this.getExpenseTypes()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating expense."})}})):this._invtr.addExpenseType(this.expenseForm.value.type).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Expense type is saved succesfully.",life:3e3}),this.expenseForm.reset(),this.getExpenseTypes()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while saving expense type.",life:3e3})}})}getNovitaExpenses(){this.total_amount=0,this.expensetransactions=[],this._invtr.getNovitaExpenses(this.yearID).subscribe({next:e=>{e.forEach(n=>{this.total_amount=Number(this.total_amount)+Number(n.amount)}),this.expensetransactions=e},error:e=>{console.error(e)}})}addNovitaExpense(e){this.transactionForm.value.year=this.yearID,this._invtr.addNovitaExpense(this.transactionForm).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"NOVITA expense added successfully."}),this.getNovitaExpenses(),this.transactionForm.reset()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while saving NOVITA expense."})}})}deleteNovitaExpense(e,n){this.confirmationService.confirm({message:"Are you sure you want to delete this record ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._invtr.deleteNovitaExpense(e.id).subscribe({next:r=>{this._ms.add({severity:"success",summary:"Successful",detail:"NOVITA expense deleted successfully.",life:3e3}),this.getNovitaExpenses(),this.transactionForm.reset()},error:r=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting NOVITA expense.",life:3e3})}})}})}resetForm(){this.transactionForm.reset()}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}isNovitaExpenseEmpty(){return 0===this.expensetransactions.length}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(Su),te(Un))},t.\u0275cmp=dn({type:t,selectors:[["app-expense"]],viewQuery:function(e,n){if(1&e&&(Mt(Lre,5),Mt(Rre,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.dtexpensetypes=r.first)}},inputs:{expensetransactions:"expensetransactions",total_amount:"total_amount",categoryid:"categoryid",selectedExpensetype:"selectedExpensetype",yearID:"yearID"},features:[Nn([kn,Un])],decls:43,vars:27,consts:[[3,"formGroup"],[1,"row"],[1,"field","col-4","col-md-4"],["for","name"],[2,"display","flex","align-items","center","gap","0.5rem"],["id","expensetype","name","expensetype","optionValue","id","optionLabel","type","filterBy","type","placeholder","Select Expense","appendTo","body","formControlName","expense","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange"],["class","custom-dropdown"],["type","button",1,"btn-project","btn-project-icon",3,"click"],[1,"bi","bi-plus-lg"],["class","p-error block",4,"ngIf"],[2,"display","flex","align-items","center"],["pInputText","","type","number","id","totalamount","name","totalamount","formControlName","totalamount",1,"form-control",2,"width","200px",3,"ngModel","ngModelChange"],["id","transactiondate","name","transactiondate","formControlName","transactiondate","classs","form-control","dateFormat","dd-mm-yy"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["type","button",1,"btn-project",3,"click"],[1,"bi","bi-arrow-counterclockwise"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],["header","Manage Expense Types","styleClass","p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["position","bottom-right"],["acceptButtonStyleClass","btn-project","rejectButtonStyleClass","btn-project","acceptLabel","Yes","rejectLabel","No"],[4,"ngIf"],[1,"flex","align-items-center","gap-2"],[1,"p-error","block"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"],[1,"p-field"],["for","type"],["pInputText","","type","text","id","type","name","type","formControlName","type",3,"ngModel","ngModelChange"],[1,"project-btn-group","project-btn-group--center",2,"margin","5px 0"],[1,"bi","bi-x-circle"],["dtexpensetypes",""],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"]],template:function(e,n){1&e&&(f(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),_(4,"Expense"),p(),f(5,"div",4)(6,"p-dropdown",5),L("ngModelChange",function(o){return n.selectedExpensetype=o}),D(7,jre,1,1,"ng-template",6),D(8,Vre,3,1,"ng-template",6),p(),f(9,"button",7),L("click",function(){return n.newExpense()}),ee(10,"i",8),p()(),D(11,Ure,2,0,"small",9),p(),f(12,"div",2)(13,"label",3),_(14,"Amount"),p(),f(15,"div",10)(16,"input",11),L("ngModelChange",function(o){return n.transaction.totalamount=o}),p()(),D(17,Hre,2,0,"small",9),p(),f(18,"div",2)(19,"label",3),_(20,"Date"),p(),f(21,"div",10),ee(22,"p-calendar",12),p(),D(23,zre,2,0,"small",9),p()(),f(24,"div",13)(25,"button",14),L("click",function(){return n.addNovitaExpense(n.transactionForm)}),ee(26,"i",15),_(27," Save "),p(),f(28,"button",16),L("click",function(){return n.resetForm()}),ee(29,"i",17),_(30," Clear "),p()()(),ee(31,"hr"),f(32,"p-table",18,19),D(34,$re,4,0,"ng-template",20),D(35,qre,12,1,"ng-template",21),D(36,Yre,13,8,"ng-template",22),D(37,Xre,8,6,"ng-template",23),p(),D(38,Qre,2,0,"div",24),f(39,"p-dialog",25),L("visibleChange",function(o){return n.addExpenseTypeDialog=o}),D(40,soe,20,10,"ng-template",26),p(),ee(41,"p-toast",27)(42,"p-confirmDialog",28)),2&e&&(T("formGroup",n.transactionForm),v(6),Ft(rt(23,aoe)),T("options",n.expensetypes)("filter",!0)("showClear",!0)("ngModel",n.selectedExpensetype),v(5),T("ngIf",n.transactionForm.controls.expense.invalid&&n.transactionForm.controls.expense.dirty),v(5),T("ngModel",n.transaction.totalamount),v(1),T("ngIf",n.transactionForm.controls.totalamount.invalid&&n.transactionForm.controls.totalamount.dirty),v(6),T("ngIf",n.transactionForm.controls.transactiondate.invalid&&n.transactionForm.controls.transactiondate.dirty),v(2),T("disabled",n.transactionForm.invalid),v(7),T("value",n.expensetransactions)("paginator",!0)("rows",10)("globalFilterFields",rt(24,loe)),v(6),T("ngIf",n.isNovitaExpenseEmpty()),v(1),Ft(rt(25,coe)),T("visible",n.addExpenseTypeDialog)("modal",!0),v(3),Ft(rt(26,uoe)))},directives:[Hr,Ur,Pr,us,Er,zr,Sn,qo,Ir,li,oc,ki,zn,_r,ms,fr,mo],pipes:[al,dr],styles:[""]}),t})();const tS=Ws_apiUrl,j7={headers:new io({"Content-Type":"application/json"})};let nS=(()=>{class t{constructor(e){this._http=e}addLocation(e){return console.log("In service "+e),this._http.post(tS+"addLocation",{location:e},j7)}updateLocation(e,n){return this._http.post(tS+"updateLocation",{id:e,location:n},j7)}getLocations(){return this._http.get(tS+"getLocations")}deleteLocation(e){return this._http.delete(`${tS}deleteLocation`,{body:{id:e}})}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const foe=["dt"],poe=["dtlocations"];function hoe(t,i){if(1&t){const e=Ie();f(0,"div",33)(1,"span",34),ee(2,"i",35),f(3,"input",36),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function moe(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function goe(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,moe,2,0,"th",37),f(4,"th"),_(5,"Date"),p(),f(6,"th"),_(7,"Location"),p(),f(8,"th"),_(9,"Ownership"),p(),f(10,"th"),_(11,"Type"),p(),f(12,"th"),_(13,"Worth"),p(),f(14,"th"),_(15,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function _oe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function voe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.locationid)}}function yoe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.typeid)}}function boe(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,_oe,2,1,"td",37),f(4,"td"),_(5),Ne(6,"date"),p(),D(7,voe,2,1,"td",37),f(8,"td"),_(9),p(),f(10,"td"),_(11),p(),D(12,yoe,2,1,"td",37),f(13,"td"),_(14),p(),f(15,"td"),_(16),Ne(17,"currency"),p(),f(18,"td")(19,"button",38),L("click",function(){const o=z(e).$implicit;return A().updateNovitaAsset(o)}),p(),_(20," \xa0"),f(21,"button",39),L("click",function(){const o=z(e).$implicit;return A().deleteNovitaAsset(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(Oa(6,9,e.date_asset,"dd-MM-yyyy")),v(2),T("ngIf",!1),v(2),U(e.location),v(2),U(e.ownership),v(1),T("ngIf",!1),v(2),U(e.type),v(2),U(He(17,12,e.worth," ","symbol","1.0-0"))}}function xoe(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td")(2,"td")(3,"td")(4,"td"),f(5,"td"),_(6,"Total:"),p(),f(7,"td"),_(8),Ne(9,"currency"),p(),f(10,"td")(11,"div",40)(12,"button",41),L("click",function(){return z(e),A().exportTableToExcel()}),_(13,"Excel"),p(),f(14,"button",41),L("click",function(){return z(e),A().exportTableToPdf()}),_(15,"Pdf"),p()()()()}if(2&t){const e=A();v(8),U(He(9,1,e.networth," ","symbol","1.0-0"))}}function woe(t,i){1&t&&(f(0,"div",42),_(1,"No data found"),p())}function Coe(t,i){1&t&&(f(0,"small",43),_(1," Asset Date is required."),p())}function Toe(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedLocation)}}function Soe(t,i){1&t&&D(0,Toe,3,1,"div",37),2&t&&T("ngIf",A().selectedLocation)}function Eoe(t,i){if(1&t&&(f(0,"div",44)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.name)}}function koe(t,i){1&t&&(f(0,"small",43),_(1," Location is required."),p())}function Doe(t,i){1&t&&(f(0,"small",43),_(1," Worth is required."),p())}function Ioe(t,i){1&t&&(f(0,"small",43),_(1," Ownership is required."),p())}function Aoe(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedType)}}function Moe(t,i){1&t&&D(0,Aoe,3,1,"div",37),2&t&&T("ngIf",A().selectedType)}function Foe(t,i){if(1&t&&(f(0,"div",44)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.type)}}function Poe(t,i){if(1&t){const e=Ie();f(0,"div",45)(1,"button",46),L("click",function(){z(e);const r=A();return r.addNovitaAsset(r.assetForm)}),ee(2,"i",47),_(3," Save "),p(),f(4,"button",48),L("click",function(){return z(e),A().closeModal()}),ee(5,"i",49),_(6," Cancel "),p()()}if(2&t){const e=A();v(1),T("disabled",e.assetForm.invalid)}}function Ooe(t,i){1&t&&(f(0,"small",43),_(1," Location name is required."),p())}function Noe(t,i){if(1&t){const e=Ie();f(0,"div",33),ee(1,"i",55),f(2,"input",56),L("input",function(r){return z(e),A(2).applyFilterLocations(r,"contains")}),p()()}}function Loe(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Roe(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Loe,2,0,"th",37),f(4,"th"),_(5,"Name"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Boe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function joe(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Boe,2,1,"td",37),f(4,"td"),_(5),p(),f(6,"td")(7,"button",38),L("click",function(){const o=z(e).$implicit;return A(2).updateLocation(o)}),p(),_(8," \xa0"),f(9,"button",39),L("click",function(){const o=z(e).$implicit;return A(2).deleteLocation(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.name)}}function Voe(t,i){1&t&&(f(0,"div",42),_(1,"No data found"),p())}const Uoe=function(){return["name"]};function Hoe(t,i){if(1&t){const e=Ie();f(0,"form",11)(1,"div",13)(2,"label",24),_(3,"Name"),p(),f(4,"input",50),L("ngModelChange",function(r){return z(e),A().location.name=r}),p(),D(5,Ooe,2,0,"small",18),p()(),f(6,"div",51)(7,"button",52),L("click",function(){z(e);const r=A();return r.saveLocations(r.locationForm)}),ee(8,"i",47),_(9," Save "),p(),f(10,"button",53),L("click",function(){return z(e),A().hideLocationDialog()}),ee(11,"i",49),_(12," Cancel "),p()(),ee(13,"hr"),f(14,"p-table",3,54),D(16,Noe,3,0,"ng-template",5),D(17,Roe,8,1,"ng-template",6),D(18,joe,10,3,"ng-template",7),p(),D(19,Voe,2,0,"div",9)}if(2&t){const e=A();T("formGroup",e.locationForm),v(4),T("ngModel",e.location.name),v(1),T("ngIf",e.locationForm.controls.name.invalid&&e.locationForm.controls.name.dirty),v(2),T("disabled",e.locationForm.invalid),v(7),T("value",e.locations)("paginator",!0)("rows",10)("globalFilterFields",rt(9,Uoe)),v(5),T("ngIf",e.isLocationEmpty())}}const zoe=function(){return["location,ownership,type"]},$oe=function(){return{width:"40vw"}},Woe=function(){return{width:"230px"}},qoe=function(){return{width:"200px"}},Goe=function(){return{width:"240px"}},Koe=function(){return{width:"30vw"}},Yoe=function(){return{width:"450px"}};let Xoe=(()=>{class t{constructor(e,n,r,o,c,u,m){this._ms=e,this._invtr=n,this.confirmationService=r,this._ls=o,this._ps=c,this.pdfserv=u,this.exptoexcel=m,this.assets=[],this.networth=0,this.displayAddModal=!1,this.clickClose=new Et,this.clickAdd=new Et,this.headerData=["Asset Date","Location","Ownership","Type","Worth"]}ngOnInit(){null==this.asset&&(this.asset={id:"",yearid:"",date_asset:"",location:"",type:"",worth:"",ownership:""}),this.assetForm=new Zn({id:new Me(""),yearid:new Me(""),date_asset:new Me("",jt.required),location:new Me("",jt.required),type:new Me("",jt.required),worth:new Me("",jt.required),ownership:new Me("",jt.required)}),this.locationForm=new Zn({id:new Me(""),name:new Me("",jt.required)}),this.location={id:"",name:""},this.getLocations(),this.getProjectTypes()}showAddAssetDialog(){this.assetForm.reset(),this.asset={id:"",date_asset:"",location:"",type:"",worth:"",ownership:""},this.selectedLocation="",this.selectedType="",this.obj_date_asset="",this.displayAddModal=!0}getProjectTypes(){this._ps.getProjectTypes().subscribe({next:e=>{this.types=e},error:e=>{console.error(e)}})}getNovitaAssets(){this.networth=0,this._invtr.getNovitaAssets(this.yearID).subscribe({next:e=>{e.forEach(n=>{this.networth=Number(this.networth)+Number(n.worth)}),this.assets=e},error:e=>{console.error(e)}})}closeModal(){this.displayAddModal=!1}addNovitaAsset(e){e.value.yearid=this.yearID,this.asset.id?(e.value.id=this.asset.id,this._invtr.updateNovitaAssets(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Asset updated successfully."}),this.getNovitaAssets(),this.closeModal()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while updating asset."})}})):this._invtr.addNovitaAssets(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Asset added successfully."}),this.assetForm.reset(),this.getNovitaAssets()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while saving asset."})}})}updateNovitaAsset(e){this.asset=Object.assign({},e),this.selectedLocation=this.asset.locationid,this.selectedType=this.asset.typeid,this.obj_date_asset=new Date(this.asset.date_asset),this.displayAddModal=!0}deleteNovitaAsset(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._invtr.deleteNovitaAsset(e.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Asset deleted successfully.",life:3e3}),this.getNovitaAssets(),this.assetForm.reset()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting asset.",life:3e3})}})}})}resetForm(){this.assetForm.reset()}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}isNovitaAssetEmpty(){return 0===this.assets.length}showLocationDialog(){this.locationDialog=!0}getLocations(){this._ls.getLocations().subscribe(e=>{this.locations=e},e=>{console.log(e)})}isLocationEmpty(){return 0===this.locations.length}applyFilterLocations(e,n){this.dtlocations.filterGlobal(e.target.value,n)}hideLocationDialog(){this.locationDialog=!1,this.getLocations()}saveLocations(e){this.location.id?this._ls.updateLocation(Number(this.location.id),this.location.name).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Location is updated successfully.",life:3e3}),this.locationForm.reset(),this.location={},this.getLocations()},error:n=>{console.error(n)}}):this._ls.addLocation(this.location.name).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Location is saved successfully.",life:3e3}),this.locationForm.reset(),this.getLocations()},error:n=>{console.error(n)}})}updateLocation(e){this.location=Object.assign({},e)}deleteLocation(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._ls.deleteLocation(e.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Location deleted successfully.",life:3e3}),this.getLocations()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:n.error.message,life:3e3})}})}})}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],"Assets_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"Assets_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.assets.length;n++)e.push([Qr(this.assets[n].date_asset),this.assets[n].location,this.assets[n].ownership,this.assets[n].type,this.assets[n].worth.toLocaleString()]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.assets.length;n++)e.push([Qr(this.assets[n].date_asset),this.assets[n].location,this.assets[n].ownership,this.assets[n].type,this.assets[n].worth.toLocaleString()]);return e}toPdfFooterFormat(){let e=[];return e.push(["","","","Total",this.networth.toLocaleString()]),e}toExcelFooterFormat(e){return e.push(["","","","","",""]),e.push(["","","","Total",this.networth.toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(Su),te(Un),te(nS),te(ll),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-assets"]],viewQuery:function(e,n){if(1&e&&(Mt(foe,5),Mt(poe,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.dtlocations=r.first)}},inputs:{asset:"asset",yearID:"yearID",assets:"assets",networth:"networth",displayAddModal:"displayAddModal",selectedType:"selectedType",obj_date_asset:"obj_date_asset",selectedLocation:"selectedLocation"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd"},features:[Nn([kn,Un])],decls:57,vars:47,consts:[[1,"project-btn-group","project-btn-group--spaced"],[1,"btn-project",3,"click"],[1,"bi","bi-plus-lg"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],["header","Add/Edit Asset",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[3,"formGroup"],[1,"p-fluid","formgrid"],[1,"row"],[1,"field","col-12","col-md-6"],["for","startdate",2,"margin-right","10px"],[2,"display","flex","align-items","center"],["appendTo","body","id","date_asset","name","date_asset","formControlName","date_asset","dateFormat","dd-mm-yy",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],["for","location"],[2,"display","flex","align-items","center","gap","0.5rem"],["id","location","name","location","optionLabel","name","optionValue","id","filterBy","name","placeholder","Select a Location","formControlName","location","autoWidth","false","appendTo","body",3,"options","filter","showClear","ngModel","ngModelChange"],["class","custom-dropdown"],["type","button",1,"btn-project","btn-project-icon",3,"click"],["for","name"],["pInputText","","type","number","id","worth","name","worth","formControlName","worth",3,"ngModel","ngModelChange"],["pInputText","","type","text","id","name","name","name","formControlName","ownership",3,"ngModel","ngModelChange"],["for","status",2,"margin-right","5px"],["id","type","name","type","optionLabel","type","optionValue","id","filterBy","type","placeholder","Select Type","formControlName","type","autoWidth","false","appendTo","body",3,"options","filter","showClear","ngModel","ngModelChange"],["header","Manage Locations",3,"visible","modal","visibleChange"],["pTemplate","content"],["position","bottom-right"],["acceptButtonStyleClass","btn-project","rejectButtonStyleClass","btn-project","acceptLabel","Yes","rejectLabel","No"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[4,"ngIf"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[1,"project-btn-group","project-btn-group--right"],[1,"btn-project","btn-sm",3,"click"],[2,"text-align","center"],[1,"p-error","block"],[1,"flex","align-items-center","gap-2"],[1,"project-btn-group","project-btn-group--center"],["icon","pi pi-check","type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["icon","pi pi-times","type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-circle"],["pInputText","","type","text","id","name","name","name","formControlName","name",3,"ngModel","ngModelChange"],[1,"project-btn-group","project-btn-group--center",2,"margin","5px 0"],["type","button",1,"btn-project",3,"disabled","click"],["type","button",1,"btn-project",3,"click"],["dtlocations",""],[1,"fas","fa-search",2,"margin","4px 4px 0 0"],["type","text","pInputText","","size","50","placeholder","Global Filter",2,"width","auto",3,"input"]],template:function(e,n){1&e&&(f(0,"div",0)(1,"button",1),L("click",function(){return n.showAddAssetDialog()}),ee(2,"i",2),_(3," Add New "),p()(),f(4,"p-table",3,4),D(6,hoe,4,0,"ng-template",5),D(7,goe,16,1,"ng-template",6),D(8,boe,22,17,"ng-template",7),D(9,xoe,16,6,"ng-template",8),p(),D(10,woe,2,0,"div",9),f(11,"p-dialog",10),L("visibleChange",function(o){return n.displayAddModal=o})("onHide",function(){return n.closeModal()}),f(12,"form",11)(13,"div",12)(14,"div",13)(15,"div",14)(16,"label",15),_(17,"Asset Date"),p(),f(18,"div",16)(19,"p-calendar",17),L("ngModelChange",function(o){return n.obj_date_asset=o}),p()(),D(20,Coe,2,0,"small",18),p(),f(21,"div",14)(22,"label",19),_(23,"Location"),p(),f(24,"div",20)(25,"p-dropdown",21),L("ngModelChange",function(o){return n.selectedLocation=o}),D(26,Soe,1,1,"ng-template",22),D(27,Eoe,3,1,"ng-template",22),p(),f(28,"button",23),L("click",function(){return n.showLocationDialog()}),ee(29,"i",2),p()(),D(30,koe,2,0,"small",18),p()(),f(31,"div",13)(32,"div",14)(33,"label",24),_(34,"Worth"),p(),f(35,"div",16)(36,"input",25),L("ngModelChange",function(o){return n.asset.worth=o}),p()(),D(37,Doe,2,0,"small",18),p(),f(38,"div",14)(39,"label",24),_(40,"Ownership"),p(),f(41,"div",16)(42,"input",26),L("ngModelChange",function(o){return n.asset.ownership=o}),p()(),D(43,Ioe,2,0,"small",18),p()(),f(44,"div",13)(45,"div",14)(46,"label",27),_(47,"Project Type"),p(),f(48,"div",16)(49,"p-dropdown",28),L("ngModelChange",function(o){return n.selectedType=o}),D(50,Moe,1,1,"ng-template"),D(51,Foe,3,1,"ng-template"),p()()()()()(),D(52,Poe,7,1,"ng-template",8),p(),f(53,"p-dialog",29),L("visibleChange",function(o){return n.locationDialog=o}),D(54,Hoe,20,10,"ng-template",30),p(),ee(55,"p-toast",31)(56,"p-confirmDialog",32)),2&e&&(v(4),T("value",n.assets)("paginator",!0)("rows",10)("globalFilterFields",rt(40,zoe)),v(6),T("ngIf",n.isNovitaAssetEmpty()),v(1),Ft(rt(41,$oe)),T("visible",n.displayAddModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("formGroup",n.assetForm),v(7),Ft(rt(42,Woe)),T("ngModel",n.obj_date_asset),v(1),T("ngIf",n.assetForm.controls.date_asset.invalid&&n.assetForm.controls.date_asset.dirty),v(5),Ft(rt(43,qoe)),T("options",n.locations)("filter",!0)("showClear",!0)("ngModel",n.selectedLocation),v(5),T("ngIf",n.assetForm.controls.location.invalid&&n.assetForm.controls.location.dirty),v(6),T("ngModel",n.asset.worth),v(1),T("ngIf",n.assetForm.controls.worth.invalid&&n.assetForm.controls.worth.dirty),v(5),T("ngModel",n.asset.ownership),v(1),T("ngIf",n.assetForm.controls.ownership.invalid&&n.assetForm.controls.ownership.dirty),v(6),Ft(rt(44,Goe)),T("options",n.types)("filter",!0)("showClear",!0)("ngModel",n.selectedType),v(4),Ft(rt(45,Koe)),T("visible",n.locationDialog)("modal",!0),v(3),Ft(rt(46,Yoe)))},directives:[ki,zn,li,Sn,_r,ms,Hr,Ur,Pr,oc,Er,zr,us,qo,Ir,fr,mo],pipes:[al,dr],styles:[""]}),t})();const Qoe=["dtaccount"],Joe=["tabView"],Zoe=["menustab"];function ese(t,i){if(1&t){const e=Ie();f(0,"div",26),ee(1,"i",27),f(2,"input",28),L("input",function(r){return z(e),A().applyFilterAccount(r,"contains")}),p()()}}function tse(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function nse(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,tse,2,0,"th",29),f(4,"th"),_(5,"Year"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function ise(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function rse(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,ise,2,1,"td",29),f(4,"td",16),L("click",function(){const o=z(e).$implicit;return A().toggle(o)}),_(5),p(),f(6,"td")(7,"button",30),L("click",function(){const o=z(e).$implicit;return A().updateYear(o)}),p(),_(8," \xa0"),f(9,"button",31),L("click",function(){const o=z(e).$implicit;return A().deleteYear(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.year)}}function ose(t,i){1&t&&(f(0,"div",32),_(1,"No data found"),p())}const sse=function(){return["year"]},ase=function(){return{width:"450px"}};let lse=(()=>{class t{constructor(e,n,r){this.messageService=e,this._nr=n,this.confirmationService=r,this.recordedyears=[],this.yearID=0,this.year="",this.activeIndex=0,this.displayAccountDialog=!1,this.displayAddAccountModal=!1,this.total_amount=0,this.total_investedamount=0,this.total_profit=0,this.transactions=[],this.investment_transactions=[],this.expensetransactions=[],this.assets=[],this.networth=0,this.rem_amount=0,this.total_investment=0,this.total_expense=0,this.types=[{name:"Credit",code:"CR"},{name:"Debit",code:"DB"}]}ngOnInit(){this.recordedyear={id:"",totalamount:"",profit:"",remarks:"",status:""},this.yearForm=new Zn({id:new Me(""),totalamount:new Me(""),profit:new Me(""),status:new Me(""),remarks:new Me(""),transactiondate:new Me("",jt.required)}),this.getYears()}getYears(){this._nr.getYears().subscribe({next:e=>{this.recordedyears=e},error:e=>{console.error(e)}})}getNovitaTransaction(){this.total_expense=0,this._nr.getNovitaTotalExpenses(this.yearID).subscribe({next:e=>{this.total_expense=e[0].amount,console.log(" Expense:"+this.total_expense)},error:e=>{console.error(e)}}),this.total_amount=0,this.total_profit=0,this._nr.getNovitaTransaction(this.yearID.toString()).subscribe({next:e=>{e.forEach(n=>{"CR"==n.status?(this.total_amount=Number(this.total_amount)+Number(n.totalamount),this.total_profit=Number(this.total_profit)+Number(n.profit)):"DB"==n.status&&(this.total_amount=Number(this.total_amount)-Number(n.totalamount),this.total_profit=Number(this.total_profit)-Number(n.profit))}),this.transactions=e,console.log("this.total_amount  "+this.total_amount+" this.total_profit "+this.total_profit),this.total_investment=this.total_amount+this.total_profit-this.total_expense,console.log("this.total_investment  "+this.total_investment)},error:e=>{console.error(e)}})}getNovitaTotalExpenses(){let e=0,n=0;n=this.total_amount+this.total_profit,this._nr.getNovitaTotalExpenses(this.yearID).subscribe({next:r=>{r.forEach(o=>{e=Number(e)+Number(o.amount),n-=e,console.log("in getNovitaTotalExpenses total_investment "+n)}),this.total_investment=n,this.expensetransactions=r},error:r=>{console.error(r)}}),this.total_investment=n}getNovitaExpenses(){this.total_amount=0,this._nr.getNovitaExpenses(this.yearID).subscribe({next:e=>{e.forEach(n=>{this.total_amount=Number(this.total_amount)+Number(n.amount)}),this.expensetransactions=e},error:e=>{console.error(e)}})}getNovitaAssets(){this.networth=0,this._nr.getNovitaAssets(this.yearID).subscribe({next:e=>{e.forEach(n=>{this.networth=Number(this.networth)+Number(n.worth)}),this.assets=e},error:e=>{console.error(e)}})}applyFilterAccount(e,n){this.dtaccount.filterGlobal(e.target.value,n)}getNovitaInvestment(){this.total_investedamount=0,this.rem_amount=0,this._nr.getNovitaInvestment(this.yearID).subscribe({next:e=>{e.forEach(n=>{this.total_investedamount=Number(this.total_investedamount)+Number(n.totalamount)}),this.investment_transactions=e,this.rem_amount=Number(this.total_investment)-Number(this.total_investedamount),console.log("rem:"+this.rem_amount+" net:"+this.total_investment)},error:e=>{console.error(e)}})}toggle(e){this.menustab.disabled=!1,this.yearID=e.id,this.activeIndex=1}toggleTransactions(){this.getNovitaTransaction(),this.activeIndex=2}toggleInvestment(){this.getNovitaTransaction(),this.getNovitaInvestment(),this.activeIndex=3}toggleExpenses(){this.getNovitaExpenses(),this.activeIndex=4}toggleAssets(){this.getNovitaAssets(),this.activeIndex=5}addNewYear(){this._nr.addYear().subscribe({next:e=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Year is added succesfully.",life:3e3}),this.yearForm.reset(),this.getYears()},error:e=>{this.messageService.add(409==e.status?{severity:"error",summary:"Error",detail:e.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while adding new year.",life:3e3})}})}updateNovitaYear(e){this.getYears()}updateYear(e){this.recordedyear=Object.assign({},e),this.displayAddAccountModal=!0}deleteYear(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._nr.deleteYear(e.id.toString()).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Year is deleted successfully.",life:3e3}),this.getYears()},error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:"Year cannot be deleted due to dependencies.",life:3e3})}})}})}hideAddAccountModal(e){this.displayAddAccountModal=!e}isYearEmpty(){return 0===this.recordedyears.length}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(Su),te(Un))},t.\u0275cmp=dn({type:t,selectors:[["app-novitarecords"]],viewQuery:function(e,n){if(1&e&&(Mt(Qoe,5),Mt(Joe,5),Mt(Zoe,5)),2&e){let r;xt(r=wt())&&(n.dtaccount=r.first),xt(r=wt())&&(n.tabView=r.first),xt(r=wt())&&(n.menustab=r.first)}},features:[Nn([kn,Un])],decls:41,vars:33,consts:[[1,"text-muted"],[3,"activeIndex","activeIndexChange"],["tabView",""],["header","Years"],[1,"project-btn-group","project-btn-group--spaced"],[1,"btn-project",3,"click"],[1,"bi","bi-plus-lg"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dtaccount",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],[3,"displayAddAccountModal","recordedyear","clickClose","clickAdd"],["header","Main Menu",3,"disabled"],["menustab",""],[1,"list-item",3,"click"],["header","Transactions",3,"disabled"],[3,"yearID","year","transactions","total_amount","total_profit"],["header","Investment",3,"disabled"],[3,"yearID","investment_transactions","total_investedamount","rem_amount","total_investment"],["header","Expenses",3,"disabled"],[3,"yearID","expensetransactions","total_amount"],["header","Assets",3,"disabled"],[3,"yearID","assets","networth"],["acceptButtonStyleClass","btn-project","rejectButtonStyleClass","btn-project","acceptLabel","Yes","rejectLabel","No"],[2,"text-align","right"],[1,"fas","fa-search",2,"margin","4px 4px 0 0"],["type","text","pInputText","","size","50","placeholder","Search..",2,"width","200px",3,"input"],[4,"ngIf"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"h2",0),_(1,"NOVITA Records"),p(),ee(2,"hr"),f(3,"p-tabView",1,2),L("activeIndexChange",function(o){return n.activeIndex=o}),f(5,"p-tabPanel",3)(6,"div",4)(7,"button",5),L("click",function(){return n.addNewYear()}),ee(8,"i",6),_(9," Add New "),p()(),f(10,"p-table",7,8),D(12,ese,3,0,"ng-template",9),D(13,nse,8,1,"ng-template",10),D(14,rse,10,3,"ng-template",11),p(),D(15,ose,2,0,"div",12),f(16,"app-edityear",13),L("clickClose",function(o){return n.hideAddAccountModal(o)})("clickAdd",function(o){return n.updateNovitaYear(o)}),p()(),f(17,"p-tabPanel",14,15)(19,"ul")(20,"li",16),L("click",function(){return n.toggleTransactions()}),f(21,"p"),_(22,"Transactions"),p()(),f(23,"li",16),L("click",function(){return n.toggleInvestment()}),f(24,"p"),_(25,"Investment"),p()(),f(26,"li",16),L("click",function(){return n.toggleExpenses()}),f(27,"p"),_(28,"Expenses"),p()(),f(29,"li",16),L("click",function(){return n.toggleAssets()}),f(30,"p"),_(31,"Assets"),p()()()(),f(32,"p-tabPanel",17),ee(33,"app-novitatransactions",18),p(),f(34,"p-tabPanel",19),ee(35,"app-novitabreakdown",20),p(),f(36,"p-tabPanel",21),ee(37,"app-expense",22),p(),f(38,"p-tabPanel",23),ee(39,"app-assets",24),p()(),ee(40,"p-confirmDialog",25)),2&e&&(v(3),T("activeIndex",n.activeIndex),v(7),T("value",n.recordedyears)("paginator",!0)("rows",10)("globalFilterFields",rt(31,sse)),v(5),T("ngIf",n.isYearEmpty()),v(1),T("displayAddAccountModal",n.displayAddAccountModal)("recordedyear",n.recordedyear),v(1),T("disabled",!0),v(15),T("disabled",!0),v(1),T("yearID",n.yearID)("year",n.year)("transactions",n.transactions)("total_amount",n.total_amount)("total_profit",n.total_profit),v(1),T("disabled",!0),v(1),T("yearID",n.yearID)("investment_transactions",n.investment_transactions)("total_investedamount",n.total_investedamount)("rem_amount",n.rem_amount)("total_investment",n.total_investment),v(1),T("disabled",!0),v(1),T("yearID",n.yearID)("expensetransactions",n.expensetransactions)("total_amount",n.total_amount),v(1),T("disabled",!0),v(1),T("yearID",n.yearID)("assets",n.assets)("networth",n.networth),v(1),Ft(rt(32,ase)))},directives:[Cf,wf,ki,zn,li,Sn,_r,Qie,wre,Nre,doe,Xoe,mo],styles:[".list-item[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),t})();const cse=["dt"],use=["dtexpensetypes"],dse=["dtbranches"];function fse(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedBranch)}}function pse(t,i){1&t&&D(0,fse,3,1,"div",30),2&t&&T("ngIf",A().selectedBranch)}function hse(t,i){if(1&t&&(f(0,"div",31)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.branch)}}function mse(t,i){1&t&&(f(0,"small",32),_(1," Branch is required. "),p())}function gse(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedExpensetype)}}function _se(t,i){1&t&&D(0,gse,3,1,"div",30),2&t&&T("ngIf",A().selectedExpensetype)}function vse(t,i){if(1&t&&(f(0,"div",31)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.type)}}function yse(t,i){1&t&&(f(0,"small",32),_(1," Expense is required. "),p())}function bse(t,i){1&t&&(f(0,"small",32),_(1," Amount is required. "),p())}function xse(t,i){1&t&&(f(0,"small",32),_(1," Date is required. "),p())}function wse(t,i){if(1&t){const e=Ie();f(0,"div",33)(1,"span",34),ee(2,"i",35),f(3,"input",36),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function Cse(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Tse(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Cse,2,0,"th",30),f(4,"th"),_(5,"Date"),p(),f(6,"th"),_(7,"Description"),p(),f(8,"th"),_(9,"Amount"),p(),f(10,"th"),_(11,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Sse(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Ese(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.amount," ","symbol","1.0-0"))}}function kse(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Sse,2,1,"td",30),f(4,"td"),_(5),Ne(6,"date"),p(),f(7,"td"),_(8),p(),D(9,Ese,3,6,"td",30),f(10,"td"),_(11," \xa0"),f(12,"button",37),L("click",function(){const o=z(e).$implicit;return A().deleteNovitaExpense(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex,r=A();v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(Oa(6,5,e.expdate,"dd-MM-yyyy")),v(3),U(e.expense),v(1),T("ngIf",0!==r.transaction.profit)}}function Dse(t,i){if(1&t&&(f(0,"tr"),ee(1,"td")(2,"td"),f(3,"td"),_(4,"Total:"),p(),f(5,"td"),_(6),Ne(7,"currency"),p()()),2&t){const e=A();v(6),U(He(7,1,e.total_amount," ","symbol","1.0-0"))}}function Ise(t,i){1&t&&(f(0,"div",38),_(1,"No data found"),p())}function Ase(t,i){1&t&&(f(0,"small",32),_(1," Branch name is required. "),p())}function Mse(t,i){if(1&t){const e=Ie();f(0,"div",33)(1,"span",34),ee(2,"i",35),f(3,"input",36),L("input",function(r){return z(e),A(2).applyFilterGlobalBranches(r,"contains")}),p()()()}}function Fse(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Pse(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Fse,2,0,"th",30),f(4,"th"),_(5,"Branches"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Ose(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Nse(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Ose,2,1,"td",30),f(4,"td"),_(5),p(),f(6,"td")(7,"button",45),L("click",function(){const o=z(e).$implicit;return A(2).updateBranch(o)}),p(),_(8," \xa0"),f(9,"button",37),L("click",function(){const o=z(e).$implicit;return A(2).deleteBranch(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.branch)}}function Lse(t,i){1&t&&(f(0,"div",38),_(1,"No data found"),p())}const Rse=function(){return["branch"]};function Bse(t,i){if(1&t){const e=Ie();f(0,"form",0)(1,"div",39)(2,"label",40),_(3,"Branch"),p(),f(4,"input",41),L("ngModelChange",function(r){return z(e),A().branch.branch=r}),p(),D(5,Ase,2,0,"small",9),p()(),f(6,"div",42)(7,"button",15),L("click",function(){z(e);const r=A();return r.saveBranch(r.branchForm)}),ee(8,"i",16),_(9," Save "),p(),f(10,"button",17),L("click",function(){return z(e),A().hideBranchDialog()}),ee(11,"i",43),_(12," Cancel "),p()(),ee(13,"hr"),f(14,"p-table",19,44),D(16,Mse,4,0,"ng-template",21),D(17,Pse,8,1,"ng-template",22),D(18,Nse,10,3,"ng-template",23),p(),D(19,Lse,2,0,"div",25)}if(2&t){const e=A();T("formGroup",e.branchForm),v(4),T("ngModel",e.branch.branch),v(1),T("ngIf",e.branchForm.controls.branch.invalid&&e.branchForm.controls.branch.dirty),v(2),T("disabled",e.branchForm.invalid),v(7),T("value",e.branches)("paginator",!0)("rows",10)("globalFilterFields",rt(9,Rse)),v(5),T("ngIf",e.isBranchEmpty())}}function jse(t,i){1&t&&(f(0,"small",32),_(1," Type is required. "),p())}function Vse(t,i){if(1&t){const e=Ie();f(0,"div",33)(1,"span",34),ee(2,"i",35),f(3,"input",36),L("input",function(r){return z(e),A(2).applyFilterGlobalExpensetype(r,"contains")}),p()()()}}function Use(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Hse(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Use,2,0,"th",30),f(4,"th"),_(5,"Type"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function zse(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function $se(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,zse,2,1,"td",30),f(4,"td"),_(5),p(),f(6,"td")(7,"button",45),L("click",function(){const o=z(e).$implicit;return A(2).updateExpensetype(o)}),p(),_(8," \xa0"),f(9,"button",37),L("click",function(){const o=z(e).$implicit;return A(2).deleteExpensetype(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.type)}}function Wse(t,i){1&t&&(f(0,"div",38),_(1,"No data found"),p())}const qse=function(){return["type"]};function Gse(t,i){if(1&t){const e=Ie();f(0,"form",0)(1,"div",39)(2,"label",46),_(3,"Expense Type"),p(),f(4,"input",47),L("ngModelChange",function(r){return z(e),A().expense.type=r}),p(),D(5,jse,2,0,"small",9),p()(),f(6,"div",42)(7,"button",15),L("click",function(){z(e);const r=A();return r.saveExpenseType(r.expenseForm)}),ee(8,"i",16),_(9," Save "),p(),f(10,"button",17),L("click",function(){return z(e),A().hideExpenseTypeDialog()}),ee(11,"i",43),_(12," Cancel "),p()(),ee(13,"hr"),f(14,"p-table",19,48),D(16,Vse,4,0,"ng-template",21),D(17,Hse,8,1,"ng-template",22),D(18,$se,10,3,"ng-template",23),p(),D(19,Wse,2,0,"div",25)}if(2&t){const e=A();T("formGroup",e.expenseForm),v(4),T("ngModel",e.expense.type),v(1),T("ngIf",e.expenseForm.controls.type.invalid&&e.expenseForm.controls.type.dirty),v(2),T("disabled",e.expenseForm.invalid),v(7),T("value",e.expensetypes)("paginator",!0)("rows",10)("globalFilterFields",rt(9,qse)),v(5),T("ngIf",e.isExpenseTypeEmpty())}}const V7=function(){return{width:"180px"}},Kse=function(){return["expense"]},U7=function(){return{width:"700px"}};let H7=(()=>{class t{constructor(e,n,r){this._ms=e,this._invtr=n,this.confirmationService=r,this.expensetransactions=[],this.total_amount=0,this.categoryid=0,this.rem_amount=0,this.total_investment=0,this.yearID=0,this.addExpenseTypeDialog=!1,this.addBranchDialog=!1}getBranches(){this._invtr.getUserAssignedBranches(sessionStorage.getItem("userid")).subscribe(e=>{this.branches=e},e=>{console.log(e)})}newBranch(){this.branch={},this.addBranchDialog=!0}saveBranch(e){this.branch.id?(this.branchForm.value.id=this.branch.id,this._invtr.updateBranch(this.branchForm).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Branch office is updated succesfully.",life:3e3}),this.branchForm.reset(),this.getBranches()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating branch office."})}})):this._invtr.addBranch(this.branchForm).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Branch office is saved succesfully.",life:3e3}),this.branchForm.reset(),this.getBranches()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while saving branch office.",life:3e3})}})}hideBranchDialog(){this.branch={},this.addBranchDialog=!1}applyFilterGlobalBranches(e,n){this.dtbranches.filterGlobal(e.target.value,n)}isBranchEmpty(){return 0===this.branches.length}deleteBranch(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._invtr.deleteBranch(e.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Branch deleted successfully.",life:3e3}),this.getBranches()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting branch.",life:3e3})}})}})}updateBranch(e){this.branch=Object.assign({},e)}ngOnInit(){this.transactionForm=new Zn({id:new Me(""),year:new Me(""),expense:new Me("",jt.required),totalamount:new Me("",jt.required),transactiondate:new Me("",jt.required),branchoffice:new Me("")}),this.transaction={id:"",totalamount:"",expense:"",transactiondate:"",branchoffice:""},this.expenseForm=new Zn({id:new Me(""),type:new Me("",jt.required)}),this.branchForm=new Zn({id:new Me(""),branch:new Me("",jt.required)}),this.expense={id:"",type:""},this.getBranches(),this.getExpenseTypes()}getExpenseTypes(){this._invtr.getExpenseTypes().subscribe(e=>{this.expensetypes=e},e=>{console.log(e)})}deleteExpensetype(e){this.expense=Object.assign({},e),this.expense.type="",this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._invtr.deleteExpenseType(this.expense.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Expense type deleted successfully.",life:3e3}),this.getExpenseTypes()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting expense type.",life:3e3})}})}})}updateExpensetype(e){this.expense=Object.assign({},e)}hideExpenseTypeDialog(){this.addExpenseTypeDialog=!1}applyFilterGlobalExpensetype(e,n){this.dtexpensetypes.filterGlobal(e.target.value,n)}isExpenseTypeEmpty(){return 0===this.expensetransactions.length}newExpense(){this.expense={},this.addExpenseTypeDialog=!0}saveExpenseType(e){this.expense.id?(this.expenseForm.value.id=this.expense.id,this._invtr.updateExpenseType(this.expenseForm.value.id,this.expenseForm.value.type).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Expense type is updated succesfully.",life:3e3}),this.expenseForm.reset(),this.getExpenseTypes()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating expense."})}})):this._invtr.addExpenseType(this.expenseForm.value.type).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Expense type is saved succesfully.",life:3e3}),this.expenseForm.reset(),this.getExpenseTypes()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while saving expense type.",life:3e3})}})}loadBranchExpenses(e){this.transaction.branch=e.value,this.getNovitaExpenses()}getNovitaExpenses(){this.total_amount=0,this.expensetransactions=[],this._invtr.getBranchExpenses(this.yearID,this.transaction.branch).subscribe({next:e=>{e.forEach(n=>{this.total_amount=Number(this.total_amount)+Number(n.amount)}),this.expensetransactions=e},error:e=>{console.error(e)}})}addNovitaExpense(e){this.transactionForm.value.year=this.yearID;const n=this.transactionForm.get("branchoffice").value;this._invtr.addBranchExpense(this.transactionForm).subscribe({next:r=>{this._ms.add({severity:"success",summary:"Success",detail:"Branch expense added successfully."}),this.getNovitaExpenses(),this.transactionForm.reset(),this.transactionForm.get("branchoffice").setValue(n)},error:r=>{this._ms.add(409==r.status?{severity:"error",summary:"Error",detail:r.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while saving branch expense."})}})}deleteNovitaExpense(e){const n=this.transactionForm.get("branchoffice").value;this.confirmationService.confirm({message:"Are you sure you want to delete this record ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._invtr.deleteBranchExpense(e.id).subscribe({next:r=>{this._ms.add({severity:"success",summary:"Successful",detail:"Branch expense deleted successfully.",life:3e3}),this.getNovitaExpenses(),this.transactionForm.reset(),this.transactionForm.get("branchoffice").setValue(n)},error:r=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting branch expense.",life:3e3})}})}})}resetForm(){this.transactionForm.reset()}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}isNovitaExpenseEmpty(){return 0===this.expensetransactions.length}resetComponentData(){var e,n;this.transaction={id:"",totalamount:"",expense:"",transactiondate:"",branchoffice:null},this.transactionForm&&(null===(e=this.transactionForm.get("branchoffice"))||void 0===e||e.setValue(null),null===(n=this.transactionForm.get("expense"))||void 0===n||n.setValue(null),this.transactionForm.reset()),this.selectedExpensetype=null,this.expensetransactions=[],this.total_amount=0,this.dt&&this.dt.reset()}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(Su),te(Un))},t.\u0275cmp=dn({type:t,selectors:[["app-officeexpenses"]],viewQuery:function(e,n){if(1&e&&(Mt(cse,5),Mt(use,5),Mt(dse,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.dtexpensetypes=r.first),xt(r=wt())&&(n.dtbranches=r.first)}},inputs:{expensetransactions:"expensetransactions",total_amount:"total_amount",categoryid:"categoryid",selectedExpensetype:"selectedExpensetype",yearID:"yearID"},decls:54,vars:37,consts:[[3,"formGroup"],[1,"row"],[1,"field","col-4","col-md-4"],["for","name"],[2,"display","flex","align-items","center","gap","0.5rem"],["id","branches","name","branches","optionValue","id","formControlName","branchoffice","optionLabel","branch","filterBy","branch","placeholder","Select Branch","appendTo","body","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange","onChange"],["class","custom-dropdown"],["type","button",1,"btn-project","btn-project-icon",3,"click"],[1,"bi","bi-plus-lg"],["class","p-error block",4,"ngIf"],["id","expensetype","name","expensetype","optionValue","id","optionLabel","type","filterBy","type","placeholder","Select Expense","appendTo","body","formControlName","expense","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange"],[2,"display","flex","align-items","center"],["pInputText","","type","number","id","totalamount","name","totalamount","formControlName","totalamount","min","1",1,"form-control",2,"width","200px",3,"ngModel","ngModelChange"],["id","transactiondate","name","transactiondate","formControlName","transactiondate","classs","form-control","dateFormat","dd-mm-yy"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["type","button",1,"btn-project",3,"click"],[1,"bi","bi-arrow-counterclockwise"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],["header","Manage Office Branches","styleClass","p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["header","Manage Expense Types","styleClass","p-fluid",3,"visible","modal","visibleChange"],["position","bottom-right"],[4,"ngIf"],[1,"flex","align-items-center","gap-2"],[1,"p-error","block"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"],[1,"p-field"],["for","branch"],["pInputText","","type","text","id","branch","name","branch","formControlName","branch",3,"ngModel","ngModelChange"],[1,"project-btn-group","project-btn-group--center",2,"margin","5px 0"],[1,"bi","bi-x-circle"],["dtbranches",""],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["for","type"],["pInputText","","type","text","id","type","name","type","formControlName","type",3,"ngModel","ngModelChange"],["dtexpensetypes",""]],template:function(e,n){1&e&&(f(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),_(4,"Branches"),p(),f(5,"div",4)(6,"p-dropdown",5),L("ngModelChange",function(o){return n.transaction.branchoffice=o})("onChange",function(o){return n.loadBranchExpenses(o)}),D(7,pse,1,1,"ng-template",6),D(8,hse,3,1,"ng-template",6),p(),f(9,"button",7),L("click",function(){return n.newBranch()}),ee(10,"i",8),p()(),D(11,mse,2,0,"small",9),p(),f(12,"div",2)(13,"label",3),_(14,"Expense"),p(),f(15,"div",4)(16,"p-dropdown",10),L("ngModelChange",function(o){return n.selectedExpensetype=o}),D(17,_se,1,1,"ng-template",6),D(18,vse,3,1,"ng-template",6),p(),f(19,"button",7),L("click",function(){return n.newExpense()}),ee(20,"i",8),p()(),D(21,yse,2,0,"small",9),p(),f(22,"div",2)(23,"label",3),_(24,"Amount"),p(),f(25,"div",11)(26,"input",12),L("ngModelChange",function(o){return n.transaction.totalamount=o}),p()(),D(27,bse,2,0,"small",9),p(),f(28,"div",2)(29,"label",3),_(30,"Date"),p(),f(31,"div",11),ee(32,"p-calendar",13),p(),D(33,xse,2,0,"small",9),p()(),f(34,"div",14)(35,"button",15),L("click",function(){return n.addNovitaExpense(n.transactionForm)}),ee(36,"i",16),_(37," Save "),p(),f(38,"button",17),L("click",function(){return n.resetForm()}),ee(39,"i",18),_(40," Clear "),p()()(),ee(41,"hr"),f(42,"p-table",19,20),D(44,wse,4,0,"ng-template",21),D(45,Tse,12,1,"ng-template",22),D(46,kse,13,8,"ng-template",23),D(47,Dse,8,6,"ng-template",24),p(),D(48,Ise,2,0,"div",25),f(49,"p-dialog",26),L("visibleChange",function(o){return n.addBranchDialog=o}),D(50,Bse,20,10,"ng-template",27),p(),f(51,"p-dialog",28),L("visibleChange",function(o){return n.addExpenseTypeDialog=o}),D(52,Gse,20,10,"ng-template",27),p(),ee(53,"p-toast",29)),2&e&&(T("formGroup",n.transactionForm),v(6),Ft(rt(32,V7)),T("options",n.branches)("filter",!0)("showClear",!0)("ngModel",n.transaction.branchoffice),v(5),T("ngIf",n.transactionForm.controls.branchoffice.invalid&&n.transactionForm.controls.branchoffice.dirty),v(5),Ft(rt(33,V7)),T("options",n.expensetypes)("filter",!0)("showClear",!0)("ngModel",n.selectedExpensetype),v(5),T("ngIf",n.transactionForm.controls.expense.invalid&&n.transactionForm.controls.expense.dirty),v(5),T("ngModel",n.transaction.totalamount),v(1),T("ngIf",n.transactionForm.controls.totalamount.invalid&&n.transactionForm.controls.totalamount.dirty),v(6),T("ngIf",n.transactionForm.controls.transactiondate.invalid&&n.transactionForm.controls.transactiondate.dirty),v(2),T("disabled",n.transactionForm.invalid),v(7),T("value",n.expensetransactions)("paginator",!0)("rows",10)("globalFilterFields",rt(34,Kse)),v(6),T("ngIf",n.isNovitaExpenseEmpty()),v(1),Ft(rt(35,U7)),T("visible",n.addBranchDialog)("modal",!0),v(2),Ft(rt(36,U7)),T("visible",n.addExpenseTypeDialog)("modal",!0))},directives:[Hr,Ur,Pr,us,Er,zr,Sn,qo,P0,Ir,li,oc,ki,zn,_r,ms,fr],pipes:[al,dr],styles:[""]}),t})();const Yse=["dt"],Xse=["dtbranches"];function Qse(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedBranch)}}function Jse(t,i){1&t&&D(0,Qse,3,1,"div",30),2&t&&T("ngIf",A().selectedBranch)}function Zse(t,i){if(1&t&&(f(0,"div",31)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.branch)}}function eae(t,i){1&t&&(f(0,"small",32),_(1," Branch is required. "),p())}function tae(t,i){1&t&&(f(0,"small",32),_(1," Description is required. "),p())}function nae(t,i){1&t&&(f(0,"small",32),_(1," Amount is required. "),p())}function iae(t,i){if(1&t){const e=Ie();f(0,"div",33)(1,"span",34),ee(2,"i",35),f(3,"input",36),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function rae(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function oae(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,rae,2,0,"th",30),f(4,"th"),_(5,"Description"),p(),f(6,"th"),_(7,"Total Amount"),p(),f(8,"th"),_(9,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function sae(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function aae(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.totalamount," ","symbol","1.0-0"))}}function lae(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,sae,2,1,"td",30),f(4,"td"),_(5),p(),D(6,aae,3,6,"td",30),f(7,"td"),_(8," \xa0"),f(9,"button",37),L("click",function(){const r=z(e),o=r.$implicit,c=r.rowIndex;return A().deleteNovitaInvestment(o,c)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.remarks),v(1),T("ngIf",0!==e.profit)}}function cae(t,i){if(1&t&&(f(0,"tr"),ee(1,"td"),f(2,"td"),_(3,"Total Invested:"),p(),f(4,"td"),_(5),Ne(6,"currency"),p()()),2&t){const e=A();v(5),U(He(6,1,e.total_amount," ","symbol","1.0-0"))}}function uae(t,i){1&t&&(f(0,"div",38),_(1,"No data found"),p())}function dae(t,i){1&t&&(f(0,"small",32),_(1," Branch name is required. "),p())}function fae(t,i){if(1&t){const e=Ie();f(0,"div",33)(1,"span",34),ee(2,"i",35),f(3,"input",36),L("input",function(r){return z(e),A(2).applyFilterGlobalBranches(r,"contains")}),p()()()}}function pae(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function hae(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,pae,2,0,"th",30),f(4,"th"),_(5,"Branches"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function mae(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function gae(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,mae,2,1,"td",30),f(4,"td"),_(5),p(),f(6,"td")(7,"button",45),L("click",function(){const o=z(e).$implicit;return A(2).updateBranch(o)}),p(),_(8," \xa0"),f(9,"button",37),L("click",function(){const o=z(e).$implicit;return A(2).deleteBranch(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.branch)}}function _ae(t,i){1&t&&(f(0,"div",38),_(1,"No data found"),p())}const vae=function(){return["branch"]};function yae(t,i){if(1&t){const e=Ie();f(0,"form",0)(1,"div",39)(2,"label",40),_(3,"Branch"),p(),f(4,"input",41),L("ngModelChange",function(r){return z(e),A().branch.branch=r}),p(),D(5,dae,2,0,"small",9),p()(),f(6,"div",42)(7,"button",16),L("click",function(){z(e);const r=A();return r.saveBranch(r.branchForm)}),ee(8,"i",17),_(9," Save "),p(),f(10,"button",18),L("click",function(){return z(e),A().hideBranchDialog()}),ee(11,"i",43),_(12," Cancel "),p()(),ee(13,"hr"),f(14,"p-table",20,44),D(16,fae,4,0,"ng-template",22),D(17,hae,8,1,"ng-template",23),D(18,gae,10,3,"ng-template",24),p(),D(19,_ae,2,0,"div",26)}if(2&t){const e=A();T("formGroup",e.branchForm),v(4),T("ngModel",e.branch.branch),v(1),T("ngIf",e.branchForm.controls.branch.invalid&&e.branchForm.controls.branch.dirty),v(2),T("disabled",e.branchForm.invalid),v(7),T("value",e.branches)("paginator",!0)("rows",10)("globalFilterFields",rt(9,vae)),v(5),T("ngIf",e.isBranchEmpty())}}const bae=function(){return{width:"180px"}},xae=function(){return["remarks"]},wae=function(){return{width:"700px"}};let z7=(()=>{class t{constructor(e,n,r){this._ms=e,this._invtr=n,this.confirmationService=r,this.transactions=[],this.total_amount=0,this.rem_amount=0,this.total_investment=0,this.addBranchDialog=!1,this.transactionForm=new Zn({id:new Me(""),year:new Me(""),totalamount:new Me("",jt.required),remarks:new Me("",jt.required),branchoffice:new Me("",jt.required)}),this.transaction={id:"",totalamount:"",remarks:"",branchoffice:""},this.branchForm=new Zn({id:new Me(""),branch:new Me("",jt.required)})}ngOnInit(){this.getNovitaInvestment(),this.getBranches()}getBranches(){this._invtr.getUserAssignedBranches(sessionStorage.getItem("userid")).subscribe(e=>{this.branches=e},e=>{console.log(e)})}newBranch(){this.branch={},this.addBranchDialog=!0}saveBranch(e){this.branch.id?(this.branchForm.value.id=this.branch.id,this._invtr.updateBranch(this.branchForm).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Branch office is updated succesfully.",life:3e3}),this.branchForm.reset(),this.getBranches()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating branch office."})}})):this._invtr.addBranch(this.branchForm).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Branch office is saved succesfully.",life:3e3}),this.branchForm.reset(),this.getBranches()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while saving branch office.",life:3e3})}})}hideBranchDialog(){this.branch={},this.addBranchDialog=!1}applyFilterGlobalBranches(e,n){this.dtbranches.filterGlobal(e.target.value,n)}isBranchEmpty(){return 0===this.branches.length}deleteBranch(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._invtr.deleteBranch(e.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Branch deleted successfully.",life:3e3}),this.getBranches()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting branch.",life:3e3})}})}})}updateBranch(e){this.branch=Object.assign({},e)}loadBranchInvestment(e){this.transaction.branch=e.value,this.getNovitaInvestment()}getNovitaInvestment(){this.total_amount=0,this.rem_amount=0,this._invtr.getBranchInvestment(this.yearID,this.transaction.branchoffice).subscribe({next:e=>{e.forEach(n=>{this.total_amount=Number(this.total_amount)+Number(n.totalamount),this.total_investment=n.netinvestment}),this.rem_amount=Number(this.total_investment)-Number(this.total_amount),this.transactions=e},error:e=>{console.error(e)}})}isNovitaInvestmentEmpty(){return 0===this.transactions.length}addNovitaInvestment(e){this.transactionForm.value.year=this.yearID;const n=this.transactionForm.get("branchoffice").value;this._invtr.addBranchInvestment(this.transactionForm).subscribe({next:r=>{this._ms.add({severity:"success",summary:"Success",detail:"Branch invetment added successfully."}),this.getNovitaInvestment(),this.transactionForm.reset(),this.transactionForm.get("branchoffice").setValue(n)},error:r=>{this._ms.add(409==r.status?{severity:"error",summary:"Error",detail:r.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while saving Branch investment."})}})}deleteNovitaInvestment(e,n){const r=this.transactionForm.get("branchoffice").value;this.confirmationService.confirm({message:"Are you sure you want to delete this record ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._invtr.deleteBranchInvestment(e.id).subscribe({next:o=>{this._ms.add({severity:"success",summary:"Successful",detail:"Branch investment deleted successfully.",life:3e3}),this.getNovitaInvestment(),this.transactionForm.reset(),this.transactionForm.get("branchoffice").setValue(r)},error:o=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting Branch investment.",life:3e3})}})}})}resetForm(){this.transactionForm.reset()}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}isTransactionEmpty(){return 0===this.transactions.length}resetComponentData(){var e;this.transaction={id:"",totalamount:"",remarks:"",branchoffice:null},this.transactionForm&&(null===(e=this.transactionForm.get("branchoffice"))||void 0===e||e.setValue(null),this.transactionForm.reset()),this.transactions=[],this.total_amount=0,this.rem_amount=0,this.dt&&this.dt.reset()}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(Su),te(Un))},t.\u0275cmp=dn({type:t,selectors:[["app-officeinvestment"]],viewQuery:function(e,n){if(1&e&&(Mt(Yse,5),Mt(Xse,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.dtbranches=r.first)}},inputs:{yearID:"yearID",transactions:"transactions",total_amount:"total_amount",rem_amount:"rem_amount",total_investment:"total_investment"},decls:42,vars:25,consts:[[3,"formGroup"],[1,"row"],[1,"field","col-4","col-md-4"],["for","name"],[2,"display","flex","align-items","center","gap","0.5rem"],["id","branches","name","branches","optionValue","id","formControlName","branchoffice","optionLabel","branch","filterBy","branch","placeholder","Select Branch","appendTo","body","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange","onChange"],["class","custom-dropdown"],["type","button",1,"btn-project","btn-project-icon",3,"click"],[1,"bi","bi-plus-lg"],["class","p-error block",4,"ngIf"],["for","remarks",2,"margin-right","10px"],[2,"display","flex","align-items","center"],["pInputText","","type","text","id","remarks","name","remarks","formControlName","remarks",1,"form-control",3,"ngModel","ngModelChange"],["for","totalamount",2,"margin-right","10px"],["pInputText","","type","number","id","totalamount","name","totalamount","formControlName","totalamount","min","1",1,"form-control",3,"ngModel","ngModelChange"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["type","button",1,"btn-project",3,"click"],[1,"bi","bi-arrow-counterclockwise"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],["header","Manage Office Branches","styleClass","p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["position","bottom-right"],[4,"ngIf"],[1,"flex","align-items-center","gap-2"],[1,"p-error","block"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"],[1,"p-field"],["for","branch"],["pInputText","","type","text","id","branch","name","branch","formControlName","branch",3,"ngModel","ngModelChange"],[1,"project-btn-group","project-btn-group--center",2,"margin","5px 0"],[1,"bi","bi-x-circle"],["dtbranches",""],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"]],template:function(e,n){1&e&&(f(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),_(4,"Branches"),p(),f(5,"div",4)(6,"p-dropdown",5),L("ngModelChange",function(o){return n.transaction.branchoffice=o})("onChange",function(o){return n.loadBranchInvestment(o)}),D(7,Jse,1,1,"ng-template",6),D(8,Zse,3,1,"ng-template",6),p(),f(9,"button",7),L("click",function(){return n.newBranch()}),ee(10,"i",8),p()(),D(11,eae,2,0,"small",9),p(),f(12,"div",2)(13,"label",10),_(14,"Description"),p(),f(15,"div",11)(16,"input",12),L("ngModelChange",function(o){return n.transaction.remarks=o}),p()(),D(17,tae,2,0,"small",9),p(),f(18,"div",2)(19,"label",13),_(20,"Amount"),p(),f(21,"div",11)(22,"input",14),L("ngModelChange",function(o){return n.transaction.totalamount=o}),p()(),D(23,nae,2,0,"small",9),p()(),f(24,"div",15)(25,"button",16),L("click",function(){return n.addNovitaInvestment(n.transactionForm)}),ee(26,"i",17),_(27," Save "),p(),f(28,"button",18),L("click",function(){return n.resetForm()}),ee(29,"i",19),_(30," Clear "),p()()(),ee(31,"hr"),f(32,"p-table",20,21),D(34,iae,4,0,"ng-template",22),D(35,oae,10,1,"ng-template",23),D(36,lae,10,4,"ng-template",24),D(37,cae,7,6,"ng-template",25),p(),D(38,uae,2,0,"div",26),f(39,"p-dialog",27),L("visibleChange",function(o){return n.addBranchDialog=o}),D(40,yae,20,10,"ng-template",28),p(),ee(41,"p-toast",29)),2&e&&(T("formGroup",n.transactionForm),v(6),Ft(rt(22,bae)),T("options",n.branches)("filter",!0)("showClear",!0)("ngModel",n.transaction.branchoffice),v(5),T("ngIf",n.transactionForm.controls.branchoffice.invalid&&n.transactionForm.controls.branchoffice.dirty),v(5),T("ngModel",n.transaction.remarks),v(1),T("ngIf",n.transactionForm.controls.remarks.invalid&&n.transactionForm.controls.remarks.dirty),v(5),T("ngModel",n.transaction.totalamount),v(1),T("ngIf",n.transactionForm.controls.totalamount.invalid&&n.transactionForm.controls.totalamount.dirty),v(2),T("disabled",n.transactionForm.invalid),v(7),T("value",n.transactions)("paginator",!0)("rows",10)("globalFilterFields",rt(23,xae)),v(6),T("ngIf",n.isNovitaInvestmentEmpty()),v(1),Ft(rt(24,wae)),T("visible",n.addBranchDialog)("modal",!0))},directives:[Hr,Ur,Pr,us,Er,zr,Sn,Ir,li,qo,P0,ki,zn,_r,ms,fr],pipes:[dr],styles:[""]}),t})();const Cae=["dt"];function Tae(t,i){1&t&&(f(0,"small",9),_(1," Year is required. "),p())}function Sae(t,i){if(1&t){const e=Ie();f(0,"div",10)(1,"button",11),L("click",function(){z(e);const r=A();return r.addYear(r.yearForm)}),ee(2,"i",12),_(3," Save "),p(),f(4,"button",13),L("click",function(){return z(e),A().closeModal()}),ee(5,"i",14),_(6," Cancel "),p()()}if(2&t){const e=A();v(1),T("disabled",e.yearForm.invalid)}}const Eae=function(){return{width:"20vw"}};let kae=(()=>{class t{constructor(e,n){this._ms=e,this._nr=n,this.displayAddAccountModal=!1,this.clickClose=new Et,this.clickAdd=new Et}ngOnInit(){null==this.recordedyear&&(this.recordedyear={id:"",year:""}),this.yearForm=new Zn({id:new Me(""),year:new Me("",jt.required)})}closeModal(){this.clickClose.emit(!0)}hideAddAccountModal(e){this.displayAddAccountModal=!e}addYear(e){this.recordedyear.id&&(e.value.id=this.recordedyear.id,this._nr.updateYear(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Year is updated successfully."}),this.clickAdd.emit(n),this.yearForm.reset(),this.closeModal()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while updating year.",life:3e3})}}))}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(Su))},t.\u0275cmp=dn({type:t,selectors:[["app-officeedityear"]],viewQuery:function(e,n){if(1&e&&Mt(Cae,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{displayAddAccountModal:"displayAddAccountModal",recordedyear:"recordedyear"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd"},decls:10,vars:11,consts:[["header","Update Year",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[3,"formGroup"],[1,"p-fluid","grid","formgrid"],[1,"field","col-12","md:col-4"],["for","title"],["pInputText","","type","text","id","year","name","year","formControlName","year",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],["pTemplate","footer"],["position","bottom-right"],[1,"p-error","block"],[1,"project-btn-group","project-btn-group--center"],["icon","pi pi-check","type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["icon","pi pi-times","type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-circle"]],template:function(e,n){1&e&&(f(0,"p-dialog",0),L("visibleChange",function(o){return n.displayAddAccountModal=o})("onHide",function(){return n.closeModal()}),f(1,"form",1)(2,"div",2)(3,"div",3)(4,"label",4),_(5,"Title"),p(),f(6,"input",5),L("ngModelChange",function(o){return n.recordedyear.year=o}),p(),D(7,Tae,2,0,"small",6),p()()(),D(8,Sae,7,1,"ng-template",7),p(),ee(9,"p-toast",8)),2&e&&(Ft(rt(10,Eae)),T("visible",n.displayAddAccountModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("formGroup",n.yearForm),v(5),T("ngModel",n.recordedyear.year),v(1),T("ngIf",n.yearForm.controls.year.invalid&&n.yearForm.controls.year.dirty))},directives:[ms,Hr,Ur,Pr,Ir,li,Er,zr,Sn,zn,fr],styles:[""]}),t})();const Dae=["dtaccount"],Iae=["dtsummary"],Aae=["tabView"],Mae=["menustab"];function Fae(t,i){if(1&t){const e=Ie();f(0,"div",25),ee(1,"i",26),f(2,"input",27),L("input",function(r){return z(e),A().applyFilterAccount(r,"contains")}),p()()}}function Pae(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Oae(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Pae,2,0,"th",28),f(4,"th"),_(5,"Year"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Nae(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Lae(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Nae,2,1,"td",28),f(4,"td",16),L("click",function(){const o=z(e).$implicit;return A().toggle(o)}),_(5),p(),f(6,"td")(7,"button",29),L("click",function(){const o=z(e).$implicit;return A().updateYear(o)}),p(),_(8," \xa0"),f(9,"button",30),L("click",function(){const o=z(e).$implicit;return A().deleteYear(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.year)}}function Rae(t,i){1&t&&(f(0,"div",31),_(1,"No data found"),p())}function Bae(t,i){if(1&t){const e=Ie();f(0,"div",25)(1,"span",32),ee(2,"i",33),f(3,"input",34),L("input",function(r){return z(e),A().applyFilterGlobalSummary(r,"contains")}),p()()()}}function jae(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),f(3,"th"),_(4,"Branch"),p(),f(5,"th"),_(6,"Income"),p(),f(7,"th"),_(8,"Expense"),p(),f(9,"th"),_(10,"Profit/Loss"),p()())}function Vae(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2),p(),f(3,"td"),_(4),p(),f(5,"td"),_(6),Ne(7,"currency"),p(),f(8,"td"),_(9),Ne(10,"currency"),p(),f(11,"td"),_(12),Ne(13,"currency"),p()()),2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(2),U(e.branch),v(2),U(He(7,5,e.income," ","symbol","1.0-0")),v(3),U(He(10,10,e.expenses," ","symbol","1.0-0")),v(3),U(He(13,15,e.profit," ","symbol","1.0-0"))}}function Uae(t,i){if(1&t&&(f(0,"tr"),ee(1,"td"),f(2,"td"),_(3,"Total:"),p(),f(4,"td"),_(5),Ne(6,"currency"),p(),f(7,"td"),_(8),Ne(9,"currency"),p(),f(10,"td"),_(11),Ne(12,"currency"),p()()),2&t){const e=A();v(5),U(He(6,3,e.total_br_income," ","symbol","1.0-0")),v(3),U(He(9,8,e.total_br_expenses," ","symbol","1.0-0")),v(3),U(He(12,13,e.total_br_profit," ","symbol","1.0-0"))}}function Hae(t,i){1&t&&(f(0,"div",31),_(1,"No data found"),p())}const zae=function(){return["year"]},$ae=function(){return["branch"]},Wae=function(){return{width:"450px"}};let qae=(()=>{class t{constructor(e,n,r){this.messageService=e,this._nr=n,this.confirmationService=r,this.recordedyears=[],this.yearID=0,this.year="",this.activeIndex=0,this.displayAccountDialog=!1,this.displayAddAccountModal=!1,this.total_amount=0,this.total_profit=0,this.transactions=[],this.summary=[],this.expensetransactions=[],this.rem_amount=0,this.total_investment=0,this.total_br_income=0,this.total_br_expenses=0,this.total_br_profit=0,this.types=[{name:"Credit",code:"CR"},{name:"Debit",code:"DB"}]}ngOnInit(){this.recordedyear={id:"",totalamount:"",profit:"",remarks:"",status:""},this.yearForm=new Zn({id:new Me(""),totalamount:new Me(""),profit:new Me(""),status:new Me(""),remarks:new Me(""),transactiondate:new Me("",jt.required)}),this.getYears()}getYears(){this._nr.getYears().subscribe({next:e=>{this.recordedyears=e},error:e=>{console.error(e)}})}getNovitaTransaction(){this.total_amount=0,this.total_profit=0,this.transactions=[],this.yearID&&0!==this.yearID&&this._nr.getNovitaTransaction(this.yearID.toString()).subscribe({next:e=>{var n;e&&e.length>0?(this.transactions=e,this.total_amount=(null===(n=e[e.length-1])||void 0===n?void 0:n.balance)||0):(this.transactions=[],this.total_amount=0)},error:e=>{console.error(e),this.transactions=[],this.total_amount=0}})}getNovitaTotalExpenses(){let e=0,n=0;this.expensetransactions=[],this.total_investment=0,this.total_amount=0,this.yearID&&0!==this.yearID&&this._nr.getTransactionBalance(this.yearID.toString()).subscribe({next:r=>{var o;n=r&&r.length>0&&(null===(o=r[r.length-1])||void 0===o?void 0:o.balance)||0,this._nr.getNovitaTotalExpenses(this.yearID).subscribe({next:c=>{c&&c.length>0?(c.forEach(u=>{e=Number(e)+Number(u.amount||0)}),n=Number(n)-Number(e),this.expensetransactions=c,this.total_investment=n,this.total_amount=e):(this.expensetransactions=[],this.total_investment=n,this.total_amount=0)},error:c=>{console.error(c),this.expensetransactions=[],this.total_investment=n,this.total_amount=0}})},error:r=>{console.error(r),this.expensetransactions=[],this.total_investment=0,this.total_amount=0}})}getNovitaExpenses(){this.total_amount=0,this.expensetransactions=[],this.yearID&&0!==this.yearID&&this._nr.getBranchExpenses(this.yearID,1).subscribe({next:e=>{e&&e.length>0?(e.forEach(n=>{this.total_amount=Number(this.total_amount)+Number(n.amount||0)}),this.expensetransactions=e):(this.expensetransactions=[],this.total_amount=0)},error:e=>{console.error(e),this.expensetransactions=[],this.total_amount=0}})}applyFilterAccount(e,n){this.dtaccount.filterGlobal(e.target.value,n)}getNovitaInvestment(){this.total_amount=0,this.rem_amount=0,this.transactions=[],this.yearID&&0!==this.yearID&&this._nr.getBranchInvestment(this.yearID,1).subscribe({next:e=>{e&&e.length>0?(e.forEach(n=>{this.total_amount=Number(this.total_amount)+Number(n.totalamount||0)}),this.transactions=e):(this.transactions=[],this.total_amount=0)},error:e=>{console.error(e),this.transactions=[],this.total_amount=0}})}toggle(e){this.menustab.disabled=!1,this.yearID=e.id,this.year=e.year||"",this.resetAllData(),this.dtaccount&&this.dtaccount.reset(),this.dtsummary&&this.dtsummary.reset(),setTimeout(()=>{this.investmentComponent&&this.investmentComponent.resetComponentData(),this.childComponent&&this.childComponent.resetComponentData()},0),this.activeIndex=1}resetAllData(){this.transactions=[],this.summary=[],this.expensetransactions=[],this.total_amount=0,this.total_profit=0,this.rem_amount=0,this.total_investment=0,this.total_br_income=0,this.total_br_expenses=0,this.total_br_profit=0}toggleInvestment(){this.getNovitaInvestment(),this.activeIndex=2}toggleExpenses(){this.getNovitaExpenses(),this.childComponent&&this.childComponent.getBranches(),this.activeIndex=3}toggleSummary(){this.total_br_income=0,this.total_br_expenses=0,this.total_br_profit=0,this.summary=[],this.yearID&&0!==this.yearID?(this._nr.getBranchesSummary(this.yearID,sessionStorage.getItem("userid")).subscribe({next:e=>{e&&e.length>0?(e.forEach(n=>{this.total_br_income=Number(this.total_br_income)+Number(n.income||0),this.total_br_expenses=Number(this.total_br_expenses)+Number(n.expenses||0),this.total_br_profit=Number(this.total_br_profit)+Number(n.profit||0)}),this.summary=e):(this.summary=[],this.total_br_income=0,this.total_br_expenses=0,this.total_br_profit=0)},error:e=>{console.error(e),this.summary=[],this.total_br_income=0,this.total_br_expenses=0,this.total_br_profit=0}}),this.activeIndex=4):this.activeIndex=4}applyFilterGlobalSummary(e,n){this.dtsummary.filterGlobal(e.target.value,n)}isSummaryEmpty(){return 0===this.summary.length}addNewYear(){this._nr.addYear().subscribe({next:e=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Year is added succesfully.",life:3e3}),this.yearForm.reset(),this.getYears(),location.reload()},error:e=>{this.messageService.add(409==e.status?{severity:"error",summary:"Error",detail:e.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while adding new year.",life:3e3})}})}updateNovitaYear(e){this.getYears()}updateYear(e){this.recordedyear=Object.assign({},e),this.displayAddAccountModal=!0}deleteYear(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._nr.deleteYear(e.id.toString()).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Year is deleted successfully.",life:3e3}),this.getYears()},error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error occurred while deleting yesr.",life:3e3})}})}})}hideAddAccountModal(e){this.displayAddAccountModal=!e}isYearEmpty(){return 0===this.recordedyears.length}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(Su),te(Un))},t.\u0275cmp=dn({type:t,selectors:[["app-officerecords"]],viewQuery:function(e,n){if(1&e&&(Mt(Dae,5),Mt(Iae,5),Mt(Aae,5),Mt(Mae,5),Mt(H7,5),Mt(z7,5)),2&e){let r;xt(r=wt())&&(n.dtaccount=r.first),xt(r=wt())&&(n.dtsummary=r.first),xt(r=wt())&&(n.tabView=r.first),xt(r=wt())&&(n.menustab=r.first),xt(r=wt())&&(n.childComponent=r.first),xt(r=wt())&&(n.investmentComponent=r.first)}},features:[Nn([kn,Un])],decls:42,vars:30,consts:[[1,"text-muted"],[3,"activeIndex","activeIndexChange"],["tabView",""],["header","Years"],[1,"project-btn-group","project-btn-group--spaced"],[1,"btn-project",3,"click"],[1,"bi","bi-plus-lg"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dtaccount",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],[3,"displayAddAccountModal","recordedyear","clickClose","clickAdd"],["header","Main Menu",3,"disabled"],["menustab",""],[1,"list-item",3,"click"],["header","Income",3,"disabled"],[3,"yearID","transactions","total_amount","rem_amount","total_investment"],["header","Expenses",3,"disabled"],[3,"yearID","expensetransactions","total_amount"],["header","Summary",3,"disabled"],["dtsummary",""],["pTemplate","footer"],["acceptButtonStyleClass","btn-project","rejectButtonStyleClass","btn-project","acceptLabel","Yes","rejectLabel","No"],[2,"text-align","right"],[1,"fas","fa-search",2,"margin","4px 4px 0 0"],["type","text","pInputText","","size","50","placeholder","Search..",2,"width","200px",3,"input"],[4,"ngIf"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"]],template:function(e,n){1&e&&(f(0,"h2",0),_(1,"Branches Management"),p(),ee(2,"hr"),f(3,"p-tabView",1,2),L("activeIndexChange",function(o){return n.activeIndex=o}),f(5,"p-tabPanel",3)(6,"div",4)(7,"button",5),L("click",function(){return n.addNewYear()}),ee(8,"i",6),_(9," Add New "),p()(),f(10,"p-table",7,8),D(12,Fae,3,0,"ng-template",9),D(13,Oae,8,1,"ng-template",10),D(14,Lae,10,3,"ng-template",11),p(),D(15,Rae,2,0,"div",12),f(16,"app-officeedityear",13),L("clickClose",function(o){return n.hideAddAccountModal(o)})("clickAdd",function(o){return n.updateNovitaYear(o)}),p()(),f(17,"p-tabPanel",14,15)(19,"ul")(20,"li",16),L("click",function(){return n.toggleInvestment()}),f(21,"p"),_(22,"Income"),p()(),f(23,"li",16),L("click",function(){return n.toggleExpenses()}),f(24,"p"),_(25,"Expenses"),p()(),f(26,"li",16),L("click",function(){return n.toggleSummary()}),f(27,"p"),_(28,"Summary"),p()()()(),f(29,"p-tabPanel",17),ee(30,"app-officeinvestment",18),p(),f(31,"p-tabPanel",19),ee(32,"app-officeexpenses",20),p(),f(33,"p-tabPanel",21)(34,"p-table",7,22),D(36,Bae,4,0,"ng-template",9),D(37,jae,11,0,"ng-template",10),D(38,Vae,14,20,"ng-template",11),D(39,Uae,13,18,"ng-template",23),p(),D(40,Hae,2,0,"div",12),p()(),ee(41,"p-confirmDialog",24)),2&e&&(v(3),T("activeIndex",n.activeIndex),v(7),T("value",n.recordedyears)("paginator",!0)("rows",10)("globalFilterFields",rt(27,zae)),v(5),T("ngIf",n.isYearEmpty()),v(1),T("displayAddAccountModal",n.displayAddAccountModal)("recordedyear",n.recordedyear),v(1),T("disabled",!0),v(12),T("disabled",!0),v(1),T("yearID",n.yearID)("transactions",n.transactions)("total_amount",n.total_amount)("rem_amount",n.rem_amount)("total_investment",n.total_investment),v(1),T("disabled",!0),v(1),T("yearID",n.yearID)("expensetransactions",n.expensetransactions)("total_amount",n.total_amount),v(1),T("disabled",!0),v(1),T("value",n.summary)("paginator",!0)("rows",10)("globalFilterFields",rt(28,$ae)),v(6),T("ngIf",n.isSummaryEmpty()),v(1),Ft(rt(29,Wae)))},directives:[Cf,wf,ki,zn,li,Sn,_r,kae,z7,H7,mo],pipes:[dr],styles:[".list-item[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),t})();const Gae=["mask"];function Kae(t,i){if(1&t){const e=Ie();f(0,"button",12),L("click",function(){return z(e),A(3).hide()})("keydown.enter",function(){return z(e),A(3).hide()}),ee(1,"span",13),p()}2&t&&T("ngClass","p-dialog-header-icon p-dialog-header-maximize p-link")}function Yae(t,i){if(1&t&&(f(0,"div",8)(1,"span",9),_(2),p(),f(3,"div",10),D(4,Kae,2,1,"button",11),p()()),2&t){const e=A(2);v(2),U(e.config.header),v(2),T("ngIf",!1!==e.config.closable)}}function Xae(t,i){}function Qae(t,i){if(1&t&&(f(0,"div",14),_(1),p()),2&t){const e=A(2);v(1),hn(" ",e.config.footer," ")}}const Jae=function(t){return{"p-dialog p-dynamic-dialog p-component":!0,"p-dialog-rtl":t}},Zae=function(t,i){return{transform:t,transition:i}},ele=function(t){return{value:"visible",params:t}};function tle(t,i){if(1&t){const e=Ie();f(0,"div",3),L("@animation.start",function(r){return z(e),A().onAnimationStart(r)})("@animation.done",function(r){return z(e),A().onAnimationEnd(r)}),D(1,Yae,5,2,"div",4),f(2,"div",5),D(3,Xae,0,0,"ng-template",6),p(),D(4,Qae,2,1,"div",7),p()}if(2&t){const e=A();Ji(e.config.styleClass),ud("width",e.config.width)("height",e.config.height),T("ngClass",Ei(12,Jae,e.config.rtl))("ngStyle",e.config.style)("@animation",Ei(17,ele,ia(14,Zae,e.transformOptions,e.config.transitionOptions||"150ms cubic-bezier(0, 0, 0.2, 1)"))),v(1),T("ngIf",!1!==e.config.showHeader),v(1),T("ngStyle",e.config.contentStyle),v(2),T("ngIf",e.config.footer)}}const nle=function(t){return{"p-dialog-mask":!0,"p-component-overlay p-component-overlay-enter p-dialog-mask-scrollblocker":t}};let $7=(()=>{class t{constructor(e){this.viewContainerRef=e}}return t.\u0275fac=function(e){return new(e||t)(te(Al))},t.\u0275dir=Ln({type:t,selectors:[["","pDynamicDialogContent",""]],hostAttrs:[1,"p-element"]}),t})();class W7{}class fM{constructor(){this._onClose=new Wi,this.onClose=this._onClose.asObservable(),this._onDestroy=new Wi,this.onDestroy=this._onDestroy.asObservable()}close(i){this._onClose.next(i)}destroy(){this._onDestroy.next(null)}}const ile=L0([cs({transform:"{{transform}}",opacity:0}),Pl("{{transition}}",cs({transform:"none",opacity:1}))]),rle=L0([Pl("{{transition}}",cs({transform:"{{transform}}",opacity:0}))]);let ole=(()=>{class t{constructor(e,n,r,o,c,u,m){this.componentFactoryResolver=e,this.cd=n,this.renderer=r,this.config=o,this.dialogRef=c,this.zone=u,this.primeNGConfig=m,this.visible=!0,this.transformOptions="scale(0.7)"}ngAfterViewInit(){this.loadChildComponent(this.childComponentType),this.cd.detectChanges()}loadChildComponent(e){let n=this.componentFactoryResolver.resolveComponentFactory(e),r=this.insertionPoint.viewContainerRef;r.clear(),this.componentRef=r.createComponent(n)}moveOnTop(){!1!==this.config.autoZIndex&&(ls.set("modal",this.container,(this.config.baseZIndex||0)+this.primeNGConfig.zIndex.modal),this.wrapper.style.zIndex=String(parseInt(this.container.style.zIndex,10)-1))}onAnimationStart(e){switch(e.toState){case"visible":this.container=e.element,this.wrapper=this.container.parentElement,this.moveOnTop(),this.bindGlobalListeners(),!1!==this.config.modal&&this.enableModality(),this.focus();break;case"void":this.wrapper&&!1!==this.config.modal&&We.addClass(this.wrapper,"p-component-overlay-leave")}}onAnimationEnd(e){"void"===e.toState&&(this.onContainerDestroy(),this.dialogRef.destroy())}onContainerDestroy(){this.unbindGlobalListeners(),this.container&&!1!==this.config.autoZIndex&&ls.clear(this.container),!1!==this.config.modal&&this.disableModality(),this.container=null}close(){this.visible=!1,this.cd.markForCheck()}hide(){this.dialogRef&&this.dialogRef.close()}enableModality(){!1!==this.config.closable&&this.config.dismissableMask&&(this.maskClickListener=this.renderer.listen(this.wrapper,"mousedown",e=>{this.wrapper&&this.wrapper.isSameNode(e.target)&&this.hide()})),!1!==this.config.modal&&We.addClass(document.body,"p-overflow-hidden")}disableModality(){this.wrapper&&(this.config.dismissableMask&&this.unbindMaskClickListener(),!1!==this.config.modal&&We.removeClass(document.body,"p-overflow-hidden"),this.cd.destroyed||this.cd.detectChanges())}onKeydown(e){if(9===e.which){e.preventDefault();let n=We.getFocusableElements(this.container);if(n&&n.length>0)if(n[0].ownerDocument.activeElement){let r=n.indexOf(n[0].ownerDocument.activeElement);e.shiftKey?-1==r||0===r?n[n.length-1].focus():n[r-1].focus():-1==r||r===n.length-1?n[0].focus():n[r+1].focus()}else n[0].focus()}}focus(){let e=We.findSingle(this.container,"[autofocus]");e&&this.zone.runOutsideAngular(()=>{setTimeout(()=>e.focus(),5)})}bindGlobalListeners(){this.bindDocumentKeydownListener(),!1!==this.config.closeOnEscape&&!1!==this.config.closable&&this.bindDocumentEscapeListener()}unbindGlobalListeners(){this.unbindDocumentKeydownListener(),this.unbindDocumentEscapeListener()}bindDocumentKeydownListener(){this.zone.runOutsideAngular(()=>{this.documentKeydownListener=this.onKeydown.bind(this),window.document.addEventListener("keydown",this.documentKeydownListener)})}unbindDocumentKeydownListener(){this.documentKeydownListener&&(window.document.removeEventListener("keydown",this.documentKeydownListener),this.documentKeydownListener=null)}bindDocumentEscapeListener(){this.documentEscapeListener=this.renderer.listen(this.maskViewChild?this.maskViewChild.nativeElement.ownerDocument:"document","keydown",n=>{27==n.which&&parseInt(this.container.style.zIndex)==ls.getCurrent()&&this.hide()})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}ngOnDestroy(){this.onContainerDestroy(),this.componentRef&&this.componentRef.destroy()}}return t.\u0275fac=function(e){return new(e||t)(te(df),te(Wo),te(Ss),te(W7),te(fM),te(gr),te(Bp))},t.\u0275cmp=dn({type:t,selectors:[["p-dynamicDialog"]],viewQuery:function(e,n){if(1&e&&(Mt($7,5),Mt(Gae,5)),2&e){let r;xt(r=wt())&&(n.insertionPoint=r.first),xt(r=wt())&&(n.maskViewChild=r.first)}},hostAttrs:[1,"p-element"],decls:3,vars:4,consts:[[3,"ngClass"],["mask",""],["role","dialog",3,"ngClass","ngStyle","class","width","height",4,"ngIf"],["role","dialog",3,"ngClass","ngStyle"],["class","p-dialog-header",4,"ngIf"],[1,"p-dialog-content",3,"ngStyle"],["pDynamicDialogContent",""],["class","p-dialog-footer",4,"ngIf"],[1,"p-dialog-header"],[1,"p-dialog-title"],[1,"p-dialog-header-icons"],["type","button",3,"ngClass","click","keydown.enter",4,"ngIf"],["type","button",3,"ngClass","click","keydown.enter"],[1,"p-dialog-header-close-icon","pi","pi-times"],[1,"p-dialog-footer"]],template:function(e,n){1&e&&(f(0,"div",0,1),D(2,tle,5,19,"div",2),p()),2&e&&(T("ngClass",Ei(2,nle,!1!==n.config.modal)),v(2),T("ngIf",n.visible))},directives:function(){return[Na,Sn,La,$7]},styles:[".p-dialog-mask{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;pointer-events:none}.p-dialog-mask.p-component-overlay{pointer-events:auto}.p-dialog{display:flex;flex-direction:column;pointer-events:auto;max-height:90%;transform:scale(1);position:relative}.p-dialog-content{overflow-y:auto;flex-grow:1}.p-dialog-header{display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.p-dialog-draggable .p-dialog-header{cursor:move}.p-dialog-footer{flex-shrink:0}.p-dialog .p-dialog-header-icons{display:flex;align-items:center}.p-dialog .p-dialog-header-icon{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-fluid .p-dialog-footer .p-button{width:auto}.p-dialog-top .p-dialog,.p-dialog-bottom .p-dialog,.p-dialog-left .p-dialog,.p-dialog-right .p-dialog,.p-dialog-top-left .p-dialog,.p-dialog-top-right .p-dialog,.p-dialog-bottom-left .p-dialog,.p-dialog-bottom-right .p-dialog{margin:.75rem;transform:translate(0)}.p-dialog-maximized{transition:none;transform:none;width:100vw!important;height:100vh!important;top:0px!important;left:0px!important;max-height:100%;height:100%}.p-dialog-maximized .p-dialog-content{flex-grow:1}.p-dialog-left{justify-content:flex-start}.p-dialog-right{justify-content:flex-end}.p-dialog-top{align-items:flex-start}.p-dialog-top-left{justify-content:flex-start;align-items:flex-start}.p-dialog-top-right{justify-content:flex-end;align-items:flex-start}.p-dialog-bottom{align-items:flex-end}.p-dialog-bottom-left{justify-content:flex-start;align-items:flex-end}.p-dialog-bottom-right{justify-content:flex-end;align-items:flex-end}.p-dialog .p-resizable-handle{position:absolute;font-size:.1px;display:block;cursor:se-resize;width:12px;height:12px;right:1px;bottom:1px}.p-confirm-dialog .p-dialog-content{display:flex;align-items:center}\n"],encapsulation:2,data:{animation:[km("animation",[ul("void => visible",[R0(ile)]),ul("visible => void",[R0(rle)])])]}}),t})(),q7=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro]]}),t})();class sle{constructor(i,e){this._parentInjector=i,this._additionalTokens=e}get(i,e,n){return this._additionalTokens.get(i)||this._parentInjector.get(i,e)}}let Is=(()=>{class t{constructor(e,n,r){this.componentFactoryResolver=e,this.appRef=n,this.injector=r,this.dialogComponentRefMap=new Map}open(e,n){const r=this.appendDialogComponentToBody(n);return this.dialogComponentRefMap.get(r).instance.childComponentType=e,r}appendDialogComponentToBody(e){const n=new WeakMap;n.set(W7,e);const r=new fM;n.set(fM,r);const o=r.onClose.subscribe(()=>{this.dialogComponentRefMap.get(r).instance.close()}),c=r.onDestroy.subscribe(()=>{this.removeDialogComponentFromBody(r),c.unsubscribe(),o.unsubscribe()}),m=this.componentFactoryResolver.resolveComponentFactory(ole).create(new sle(this.injector,n));return this.appRef.attachView(m.hostView),document.body.appendChild(m.hostView.rootNodes[0]),this.dialogComponentRefMap.set(r,m),r}removeDialogComponentFromBody(e){if(!e||!this.dialogComponentRefMap.has(e))return;const n=this.dialogComponentRefMap.get(e);this.appRef.detachView(n.hostView),n.destroy(),this.dialogComponentRefMap.delete(e)}}return t.\u0275fac=function(e){return new(e||t)(zt(df),zt(y3),zt(ws))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();const bd=Ws_apiUrl,iS={headers:new io({"Content-Type":"application/json"})};let pM=(()=>{class t{constructor(e){this._http=e}addPlot(e){const n=e.value.location,{plotno:r,landcost:o,modeofpayment:c,taxes:u,commission:m,size:g,remarks:x}=e.value,S=new Date(e.value.purchasedate),M=this.formatDate(S);return this._http.post(bd+"addPlot",{plotno:r,location:n,landcost:o,purchasedate:M,taxes:u,commission:m,size:g,modeofpayment:c,remarks:x},iS)}updatePlot(e){const n=e.value.location,{id:r,plotno:o,landcost:c,modeofpayment:u,taxes:m,commission:g,size:x,remarks:S}=e.value,M=new Date(e.value.purchasedate),E=this.formatDate(M);return this._http.post(bd+"updatePlot",{id:r,plotno:o,landcost:c,modeofpayment:u,taxes:m,commission:g,size:x,purchasedate:E,location:n,remarks:S},iS)}getPlots(){return this._http.get(bd+"getPlots")}getPlot(e){return this._http.get(bd+"getPlot",{params:{id:e.toString()}})}getPlotSale(e){return this._http.get(bd+"getPlotSale",{params:{id:e.toString()}})}addPlotSale(e){const{plot:n,sellingprice:r,tax:o,commission:c,netprofit:u}=e.value,m=new Date(e.value.sellingdate),g=this.formatDate(m);return this._http.post(bd+"addPlotSale",{plot:n,sellingdate:g,sellingprice:r,tax:o,commission:c,netprofit:u},iS)}deletePlotSale(e){return this._http.delete(`${bd}deletePlotSale`,{body:{id:e}})}updatePlotSale(e){const{id:n,plot:r,sellingprice:o,tax:c,commission:u,netprofit:m}=e.value,g=new Date(e.value.sellingdate),x=this.formatDate(g);return this._http.post(bd+"updatePlotSale",{id:n,plot:r,sellingdate:x,sellingprice:o,tax:c,commission:u,netprofit:m},iS)}formatDate(e){return`${e.getFullYear().toString().slice(-2)}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`}deletePlot(e){return this._http.delete(`${bd}deletePlot`,{body:{id:e}})}getProfitContribution(e){return this._http.get(bd+"getPlotProfitContribution",{params:{id:e.toString()}})}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const xd=Ws_apiUrl,rS={headers:new io({"Content-Type":"application/json"})};let i_=(()=>{class t{constructor(e){this._http=e}getContributions(e){return this._http.get(xd+"getContributions",{params:{id:e.toString()}})}getPlotContributions(e){return this._http.get(xd+"getPlotContributions",{params:{id:e.toString()}})}getBudget(e){return this._http.get(xd+"getBudget",{params:{id:e.toString()}})}getPlotPrice(e){return this._http.get(xd+"getPlotPrice",{params:{id:e.toString()}})}addContribution(e){return this._http.post(xd+"addContribution",{project:e.value.project,investor:e.value.investor,contributions:e.value.contributions,officeshare:e.value.officeshare},rS)}updateContribution(e){return this._http.post(xd+"updateContribution",{id:e.value.id,project:e.value.project,investor:e.value.investor,contributions:e.value.contributions,officeshare:e.value.officeshare},rS)}addPlotContribution(e){return this._http.post(xd+"addPlotContribution",{plot:e.value.plot,investor:e.value.investor,contribution:e.value.contributions,officeshare:e.value.officeshare},rS)}updatePlotContribution(e){return this._http.post(xd+"updatePlotContribution",{id:e.value.id,plot:e.value.plot,investor:e.value.investor,contribution:e.value.contributions,officeshare:e.value.officeshare},rS)}deleteContribution(e){return this._http.delete(`${xd}deleteContribution`,{body:{id:e}})}deletePlotContribution(e){return this._http.delete(`${xd}deletePlotContribution`,{body:{id:e}})}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const ale=["form"],lle=["dt"];function cle(t,i){if(1&t&&(f(0,"div"),_(1),p()),2&t){const e=A().$implicit;v(1),hn(" ",e.message," ")}}function ule(t,i){if(1&t&&(f(0,"div",21),D(1,cle,2,1,"div",8),p()),2&t){const e=i.$implicit;A(2);const n=Fa(3);v(1),T("ngIf",null==n.controls.name?null:n.controls.name.hasError(e.type))}}function dle(t,i){if(1&t&&(f(0,"div"),D(1,ule,2,1,"div",20),p()),2&t){const e=A();v(1),T("ngForOf",e.validationMessages.name)}}function fle(t,i){if(1&t){const e=Ie();f(0,"div",22),ee(1,"i",23),f(2,"input",24),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()}}function ple(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function hle(t,i){1&t&&(f(0,"tr")(1,"th")(2,"div",25),_(3," Sr# "),p()(),D(4,ple,2,0,"th",8),f(5,"th"),_(6,"Name"),p(),f(7,"th"),_(8,"Action"),p()()),2&t&&(v(4),T("ngIf",!1))}function mle(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function gle(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,mle,2,1,"td",8),f(4,"td"),_(5),p(),f(6,"td")(7,"button",26),L("click",function(){const o=z(e).$implicit;return A().updateLocation(o)}),p(),_(8," \xa0"),f(9,"button",27),L("click",function(){const o=z(e).$implicit;return A().deleteLocation(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.name)}}function _le(t,i){1&t&&(f(0,"div",28),_(1,"No data found"),p())}const vle=function(){return["name"]},yle=function(){return{width:"450px"}};let ble=(()=>{class t{constructor(e,n,r){this._ls=e,this._ms=n,this._cs=r,this.locations=[],this.formData={id:"",name:""},this.validationMessages={name:[{type:"required",message:"Name is required"}]}}ngOnInit(){this.getLocations()}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}getLocations(){this._ls.getLocations().subscribe({next:e=>{console.log(e),this.locations=e},error:e=>{console.error(e)}})}updateLocation(e){this.formData.name=e.name,this.formData.id=e.id}deleteLocation(e){this.formData.id=e.id,this._cs.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._ls.deleteLocation(e.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Location deleted successfully.",life:3e3}),this.getLocations()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:n.error.message,life:3e3})}})}})}submitForm(e){if(e.valid){const{name:n}=this.formData,{id:r}=this.formData;this.formData.id?this._ls.updateLocation(Number(r),n).subscribe({next:o=>{this._ms.add({severity:"success",summary:"Successful",detail:"Location is updated successfully.",life:3e3}),this.clearForm(),this.getLocations()},error:o=>{console.error(o)}}):this._ls.addLocation(n).subscribe({next:o=>{this._ms.add({severity:"success",summary:"Successful",detail:"Location is saved successfully.",life:3e3}),this.clearForm(),this.getLocations()},error:o=>{console.error(o)}})}}clearForm(){this.form.resetForm()}isProjectsEmpty(){return 0===this.locations.length}}return t.\u0275fac=function(e){return new(e||t)(te(nS),te(kn),te(Un))},t.\u0275cmp=dn({type:t,selectors:[["app-add-edit-locations"]],viewQuery:function(e,n){if(1&e&&(Mt(ale,5),Mt(lle,5)),2&e){let r;xt(r=wt())&&(n.form=r.first),xt(r=wt())&&(n.dt=r.first)}},features:[Nn([Is,kn,Un])],decls:27,vars:11,consts:[[1,"row"],[1,"col-lg-12","col-md-4","col-xs-8"],["novalidate","",3,"ngSubmit"],["form","ngForm"],[1,"col-lg-4","col-md-12","col-xs-8"],[1,"form-group"],["for","name"],["pInputText","","type","text","id","name","name","name","required","",3,"ngModel","ngModelChange"],[4,"ngIf"],[1,"form-group",2,"text-align","center","margin-top","5px","margin-bottom","5px"],[1,"col-md-12","col-sm-12","col-xs-","col-md-offset-5"],["type","submit",1,"btn-project",2,"margin-top","5px","margin-right","5px"],["type","button",1,"btn-project",2,"margin-top","5px"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],["position","bottom-right"],["class","text-danger",4,"ngFor","ngForOf"],[1,"text-danger"],[2,"text-align","right"],[1,"fas","fa-search",2,"margin","4px 4px 0 0"],["type","text","pInputText","","size","50","placeholder","Global Filter",2,"width","auto",3,"input"],[1,"p-d-flex","p-jc-between","p-ai-center"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"]],template:function(e,n){if(1&e){const r=Ie();f(0,"div",0)(1,"div",1)(2,"form",2,3),L("ngSubmit",function(){z(r);const c=Fa(3);return n.submitForm(c)}),f(4,"div",0)(5,"div",4)(6,"div",5)(7,"label",6),_(8,"Name"),p(),ee(9,"br"),f(10,"input",7),L("ngModelChange",function(c){return n.formData.name=c}),p(),D(11,dle,2,1,"div",8),p()()(),ee(12,"hr"),f(13,"div",9)(14,"div",10)(15,"button",11),_(16,"Save"),p(),f(17,"button",12),_(18,"Clear"),p()()()()()(),f(19,"p-table",13,14),D(21,fle,3,0,"ng-template",15),D(22,hle,9,1,"ng-template",16),D(23,gle,10,3,"ng-template",17),p(),D(24,_le,2,0,"div",18),ee(25,"p-toast",19)(26,"p-confirmDialog")}if(2&e){const r=Fa(3);v(10),T("ngModel",n.formData.name),v(1),T("ngIf",r.submitted),v(8),T("value",n.locations)("paginator",!0)("rows",10)("globalFilterFields",rt(9,vle)),v(5),T("ngIf",n.isProjectsEmpty()),v(2),Ft(rt(10,yle))}},directives:[Hr,Ur,fT,Ir,li,By,Er,md,Sn,nc,ki,zn,_r,fr,mo],styles:[""]}),t})();const oS=Ws_apiUrl,G7={headers:new io({"Content-Type":"application/json"})};let K7=(()=>{class t{constructor(e){this._http=e}addUnit(e){return console.log("In service "+e),this._http.post(oS+"addUnit",{unit:e},G7)}getUnits(){return this._http.get(oS+"getUnits")}deleteUnit(e){return this._http.delete(`${oS}deleteUnit`,{body:{id:e}})}updateUnit(e,n){return this._http.post(oS+"updateUnit",{id:e,unit:n},G7)}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const xle=["dt"],wle=["dtunits"];function Cle(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedLocation)}}function Tle(t,i){1&t&&D(0,Cle,3,1,"div",31),2&t&&T("ngIf",A().selectedLocation)}function Sle(t,i){if(1&t&&(f(0,"div",32)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.name)}}function Ele(t,i){1&t&&(f(0,"small",33),_(1," Location is required."),p())}function kle(t,i){1&t&&(f(0,"small",33),_(1," Plot No is required."),p())}function Dle(t,i){1&t&&(f(0,"small",33),_(1," Plot size is required."),p())}function Ile(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedUnit)}}function Ale(t,i){1&t&&D(0,Ile,3,1,"div",31),2&t&&T("ngIf",A().selectedUnit)}function Mle(t,i){if(1&t&&(f(0,"div",32)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.name)}}function Fle(t,i){1&t&&(f(0,"small",33),_(1," Unit is required."),p())}function Ple(t,i){1&t&&(f(0,"small",33),_(1," Land Cost is required."),p())}function Ole(t,i){1&t&&(f(0,"small",33),_(1," Purchase Date is required."),p())}function Nle(t,i){if(1&t){const e=Ie();f(0,"div",34)(1,"button",35),L("click",function(){z(e);const r=A();return r.addPlot(r.plotForm)}),ee(2,"i",36),_(3," Save "),p(),f(4,"button",37),L("click",function(){return z(e),A().closeModal()}),ee(5,"i",38),_(6," Cancel "),p()()}if(2&t){const e=A();v(1),T("disabled",e.plotForm.invalid)}}function Lle(t,i){1&t&&(f(0,"small",33),_(1," Unit is required."),p())}function Rle(t,i){if(1&t){const e=Ie();f(0,"div",51)(1,"span",52),ee(2,"i",53),f(3,"input",54),L("input",function(r){return z(e),A(2).applyFilterGlobalUnits(r,"contains")}),p()()()}}function Ble(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function jle(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Ble,2,0,"th",31),f(4,"th"),_(5,"Unit"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Vle(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Ule(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Vle,2,1,"td",31),f(4,"td"),_(5),p(),f(6,"td")(7,"button",55),L("click",function(){const o=z(e).$implicit;return A(2).updateUnit(o)}),p(),_(8," \xa0"),f(9,"button",56),L("click",function(){const o=z(e).$implicit;return A(2).deleteUnit(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.unit)}}function Hle(t,i){1&t&&(f(0,"div",57),_(1,"No data found"),p())}const zle=function(){return["title"]};function $le(t,i){if(1&t){const e=Ie();f(0,"form",1)(1,"div",39)(2,"label",40),_(3,"Unit"),p(),f(4,"input",41),L("ngModelChange",function(r){return z(e),A().unit.unit=r}),p(),D(5,Lle,2,0,"small",11),p()(),f(6,"div",42)(7,"button",43),L("click",function(){z(e);const r=A();return r.saveUnit(r.unitForm)}),ee(8,"i",36),_(9," Save "),p(),f(10,"button",44),L("click",function(){return z(e),A().hideUnitDialog()}),ee(11,"i",38),_(12," Cancel "),p()(),ee(13,"hr"),f(14,"p-table",45,46),D(16,Rle,4,0,"ng-template",47),D(17,jle,8,1,"ng-template",48),D(18,Ule,10,3,"ng-template",49),p(),D(19,Hle,2,0,"div",50)}if(2&t){const e=A();T("formGroup",e.unitForm),v(4),T("ngModel",e.unit.unit),v(1),T("ngIf",e.unitForm.controls.unit.invalid&&e.unitForm.controls.unit.dirty),v(2),T("disabled",e.unitForm.invalid),v(7),T("value",e.units)("paginator",!0)("rows",10)("globalFilterFields",rt(9,zle)),v(5),T("ngIf",e.isUnitEmpty())}}const Wle=function(){return{width:"40vw"}},Y7=function(){return{width:"200px"}},qle=function(){return{width:"600px"}},Gle=function(){return{width:"450px"}};let Kle=(()=>{class t{constructor(e,n,r,o,c,u,m){this.fb=e,this._ls=n,this._ps=r,this._ms=o,this.confirmationService=c,this.dialogService=u,this._unit=m,this.displayAddModal=!1,this.clickClose=new Et,this.clickAdd=new Et}ngOnInit(){null==this.plot&&(this.plot={id:"",plotno:"",location:"",landcost:"",purchasedate:"",commission:"",taxes:"",remarks:"",size:"",unit:"",modeofpayment:""},this.unitForm=new Zn({id:new Me(""),unit:new Me("",jt.required)})),this.plotForm=new Zn({plotno:new Me("",jt.required),size:new Me("",jt.required),unit:new Me("",jt.required),location:new Me("",jt.required),purchasedate:new Me("",jt.required),landcost:new Me("",jt.required),modeofpayment:new Me("",jt.required),taxes:new Me(""),commission:new Me(""),remarks:new Me("")}),this.getLocations(),this.getUnits()}getLocations(){this._ls.getLocations().subscribe(e=>{this.locations=e},e=>{console.log(e)})}getUnits(){this._unit.getUnits().subscribe(e=>{this.units=e},e=>{console.log(e)})}closeModal(){this.clickClose.emit(!0)}hideUnitDialog(){this.unitDialog=!1,this.getUnits()}newUnit(){this.unit={},this.unitDialog=!0}deleteUnit(e){this.unit=Object.assign({},e),this.unit.unit="",this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._unit.deleteUnit(this.unit.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Unit deleted successfully.",life:3e3}),this.getUnits()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting unit.",life:3e3})}})}})}saveUnit(e){this.unit.id?(this.unitForm.value.id=this.unit.id,this._unit.updateUnit(this.unitForm.value.id,this.unitForm.value.unit).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Unit is updated succesfully.",life:3e3}),this.getUnits(),this.unitForm.reset()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while updating unit.",life:3e3})}})):this._unit.addUnit(this.unitForm.value.unit).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Unit is saved succesfully.",life:3e3}),this.getUnits(),this.unitForm.reset()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while saving unit.",life:3e3})}})}updateUnit(e){this.unit=Object.assign({},e)}applyFilterGlobalUnits(e,n){this.dtunits.filterGlobal(e.target.value,n)}isUnitEmpty(){return 0===this.units.length}addPlot(e){this.plot.id?(e.value.id=this.plot.id,this._ps.updatePlot(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Plot updated successfully."}),this.clickAdd.emit(n),this.closeModal()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while updating plot."})}})):this._ps.addPlot(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Plot added successfully."}),this.clickAdd.emit(n),this.plotForm.reset(),this.closeModal()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while saving plot."})}})}showLocationDialog(){this.ref=this.dialogService.open(ble,{header:"Add New Location",width:"50%",contentStyle:{"max-height":"500px",overflow:"auto"},baseZIndex:1e4})}hideAddModal(e){this.displayAddModal=!e}}return t.\u0275fac=function(e){return new(e||t)(te(pT),te(nS),te(pM),te(kn),te(Un),te(Is),te(K7))},t.\u0275cmp=dn({type:t,selectors:[["app-addeditplot"]],viewQuery:function(e,n){if(1&e&&(Mt(xle,5),Mt(wle,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.dtunits=r.first)}},inputs:{displayAddModal:"displayAddModal",plot:"plot",plotID:"plotID",obj_purchasedate:"obj_purchasedate",selectedLocation:"selectedLocation",selectedUnit:"selectedUnit"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd"},features:[Nn([Is,kn,Un])],decls:69,vars:45,consts:[["header","Plot Details",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[3,"formGroup"],[1,"p-fluid","formgrid"],[1,"row"],[1,"field","col-12","col-md-6"],["for","name"],[2,"display","flex","align-items","center","gap","0.5rem"],["id","location","name","location","optionLabel","name","optionValue","id","filterBy","name","placeholder","Select a Location","formControlName","location","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange"],["class","custom-dropdown"],["type","button",1,"btn-project","btn-project-icon",3,"click"],[1,"bi","bi-plus-lg"],["class","p-error block",4,"ngIf"],["pInputText","","type","text","id","plotno","name","plotno","formControlName","plotno",3,"ngModel","ngModelChange"],["pInputText","","type","text","id","size","name","size","formControlName","size",3,"ngModel","ngModelChange"],["id","unit","name","unit","optionValue","id","optionLabel","unit","filterBy","unit","placeholder","Select Unit","appendTo","body","formControlName","unit","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange"],["for","landcost"],["pInputText","","type","number","id","landcost","name","landcost","formControlName","landcost",3,"ngModel","ngModelChange"],["for","commission",2,"margin-right","10px"],["pInputText","","type","number","id","commission","name","commission","formControlName","commission",3,"ngModel","ngModelChange"],["for","taxes",2,"margin-right","10px"],["pInputText","","type","number","id","taxes","name","taxes","formControlName","taxes",3,"ngModel","ngModelChange"],["for","purchasedate",2,"margin-right","10px"],["appendTo","body","id","purchasedate","name","purchasedate","formControlName","purchasedate","dateFormat","dd-mm-yy",3,"ngModel","ngModelChange"],["for","modeofpayment",2,"margin-right","10px"],["pInputText","","type","text","id","modeofpayment","name","modeofpayment","formControlName","modeofpayment",3,"ngModel","ngModelChange"],["for","remarks",2,"margin-right","10px"],["id","remarks","pInputTextarea","","formControlName","remarks","cols","30",3,"ngModel","ngModelChange"],["pTemplate","footer"],["header","Unit Details","styleClass","p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["position","bottom-right"],[4,"ngIf"],[1,"flex","align-items-center","gap-2"],[1,"p-error","block"],[1,"project-btn-group","project-btn-group--center"],["icon","pi pi-check","type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["icon","pi pi-times","type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-circle"],[1,"p-field"],["for","unit"],["pInputText","","type","text","id","unit","name","unit","formControlName","unit",3,"ngModel","ngModelChange"],[1,"project-btn-group","project-btn-group--center",2,"margin","5px 0"],["type","button",1,"btn-project",3,"disabled","click"],["type","button",1,"btn-project",3,"click"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dtjobtypes",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"p-dialog",0),L("visibleChange",function(o){return n.displayAddModal=o})("onHide",function(){return n.closeModal()}),f(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),_(6,"Location"),p(),f(7,"div",6)(8,"p-dropdown",7),L("ngModelChange",function(o){return n.selectedLocation=o}),D(9,Tle,1,1,"ng-template",8),D(10,Sle,3,1,"ng-template",8),p(),f(11,"button",9),L("click",function(){return n.showLocationDialog()}),ee(12,"i",10),p()(),D(13,Ele,2,0,"small",11),p(),f(14,"div",4)(15,"label",5),_(16,"Plot No"),p(),f(17,"input",12),L("ngModelChange",function(o){return n.plot.plotno=o}),p(),D(18,kle,2,0,"small",11),p()(),f(19,"div",3)(20,"div",4)(21,"label",5),_(22,"Plot Size "),p(),f(23,"input",13),L("ngModelChange",function(o){return n.plot.size=o}),p(),D(24,Dle,2,0,"small",11),p(),f(25,"div",4)(26,"label",5),_(27,"Unit"),p(),f(28,"div",6)(29,"p-dropdown",14),L("ngModelChange",function(o){return n.selectedUnit=o}),D(30,Ale,1,1,"ng-template",8),D(31,Mle,3,1,"ng-template",8),p(),f(32,"button",9),L("click",function(){return n.newUnit()}),ee(33,"i",10),p()(),D(34,Fle,2,0,"small",11),p()(),f(35,"div",3)(36,"div",4)(37,"label",15),_(38,"Land Cost"),p(),f(39,"input",16),L("ngModelChange",function(o){return n.plot.landcost=o}),p(),D(40,Ple,2,0,"small",11),p(),f(41,"div",4)(42,"label",17),_(43,"Commission"),p(),f(44,"input",18),L("ngModelChange",function(o){return n.plot.commission=o}),p()()(),f(45,"div",3)(46,"div",4)(47,"label",19),_(48,"Taxes"),p(),f(49,"input",20),L("ngModelChange",function(o){return n.plot.taxes=o}),p()(),f(50,"div",4)(51,"label",21),_(52,"Purchase Date"),p(),f(53,"p-calendar",22),L("ngModelChange",function(o){return n.obj_purchasedate=o}),p(),D(54,Ole,2,0,"small",11),p()(),f(55,"div",3)(56,"div",4)(57,"label",23),_(58,"Mode of Payment"),p(),f(59,"input",24),L("ngModelChange",function(o){return n.plot.modeofpayment=o}),p()(),f(60,"div",4)(61,"label",25),_(62,"Remarks"),p(),f(63,"textarea",26),L("ngModelChange",function(o){return n.plot.remarks=o}),p()()()()(),D(64,Nle,7,1,"ng-template",27),p(),f(65,"p-dialog",28),L("visibleChange",function(o){return n.unitDialog=o}),D(66,$le,20,10,"ng-template",29),p(),ee(67,"p-toast",30)(68,"p-confirmDialog")),2&e&&(Ft(rt(40,Wle)),T("visible",n.displayAddModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("formGroup",n.plotForm),v(7),Ft(rt(41,Y7)),T("options",n.locations)("filter",!0)("showClear",!0)("ngModel",n.selectedLocation),v(5),T("ngIf",n.plotForm.controls.location.invalid&&n.plotForm.controls.location.dirty),v(4),T("ngModel",n.plot.plotno),v(1),T("ngIf",n.plotForm.controls.plotno.invalid&&n.plotForm.controls.plotno.dirty),v(5),T("ngModel",n.plot.size),v(1),T("ngIf",n.plotForm.controls.size.invalid&&n.plotForm.controls.size.dirty),v(5),Ft(rt(42,Y7)),T("options",n.units)("filter",!0)("showClear",!0)("ngModel",n.selectedUnit),v(5),T("ngIf",n.plotForm.controls.unit.invalid&&n.plotForm.controls.unit.dirty),v(5),T("ngModel",n.plot.landcost),v(1),T("ngIf",n.plotForm.controls.landcost.invalid&&n.plotForm.controls.landcost.dirty),v(4),T("ngModel",n.plot.commission),v(5),T("ngModel",n.plot.taxes),v(4),T("ngModel",n.obj_purchasedate),v(1),T("ngIf",n.plotForm.controls.purchasedate.invalid&&n.plotForm.controls.purchasedate.dirty),v(5),T("ngModel",n.plot.modeofpayment),v(4),T("ngModel",n.plot.remarks),v(2),Ft(rt(43,qle)),T("visible",n.unitDialog)("modal",!0),v(3),Ft(rt(44,Gle)))},directives:[ms,Hr,Ur,Pr,us,Er,zr,Sn,Ir,li,qo,oc,zn,ki,_r,fr,mo],styles:[""]}),t})();const Yle=["dt"],Xle=["dtprofit"];function Qle(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Jle(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Qle,2,0,"th",10),f(4,"th"),_(5,"Investor"),p(),f(6,"th"),_(7,"Contribution"),p()()),2&t&&(v(3),T("ngIf",!1))}function Zle(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function ece(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2),p(),D(3,Zle,2,1,"td",10),f(4,"td"),_(5),p(),f(6,"td"),_(7),Ne(8,"currency"),p()()),2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.investor),v(2),U(He(8,4,e.contribution," ","symbol","1.0-0"))}}function tce(t,i){if(1&t){const e=Ie();f(0,"div",11)(1,"span",12),ee(2,"i",13),f(3,"input",14),L("input",function(r){return z(e),A().applyFilterGlobalProfit(r,"contains")}),p()()()}}function nce(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),f(3,"th"),_(4,"Investor"),p(),f(5,"th"),_(6,"Total Cost"),p(),f(7,"th"),_(8,"Selling Price"),p(),f(9,"th"),_(10,"Net Profit"),p(),f(11,"th"),_(12,"Contribution"),p(),f(13,"th"),_(14,"Investor Share"),p(),f(15,"th"),_(16,"Office Share"),p(),f(17,"th"),_(18,"Amount"),p()())}function ice(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2),p(),f(3,"td"),_(4),p(),f(5,"td"),_(6),Ne(7,"currency"),p(),f(8,"td"),_(9),Ne(10,"currency"),p(),f(11,"td"),_(12),Ne(13,"currency"),p(),f(14,"td"),_(15),Ne(16,"currency"),p(),f(17,"td"),_(18),Ne(19,"currency"),p(),f(20,"td"),_(21),p(),f(22,"td"),_(23),Ne(24,"currency"),p()()),2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(2),U(e.investor),v(2),U(He(7,9,e.t_landcost," ","symbol","1.0-0")),v(3),U(He(10,14,e.t_sellingprice," ","symbol","1.0-0")),v(3),U(He(13,19,e.netprofit," ","symbol","1.0-0")),v(3),U(He(16,24,e.contributions," ","symbol","1.0-0")),v(3),U(He(19,29,e.investorshare," ","symbol","1.0-0")),v(3),hn("",e.officepercentage," %"),v(2),hn("",He(24,34,e.officeshare," ","symbol","1.0-0")," ")}}function rce(t,i){1&t&&(f(0,"div",15),_(1,"No data found"),p())}const oce=function(){return["investor"]};let sce=(()=>{class t{constructor(e,n){this._cs=e,this.exptoexcel=n,this.contribution=[],this.landcost="",this.tax="",this.plotID=0,this.commission="",this.sellingprice=0,this.totalcost=0,this.netprofit=0,this._plotprice=0,this.profitdistribution=[]}parseAsNumber(e){return parseFloat(e)||0}ngOnInit(){this.loadContributions()}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}loadContributions(){this._cs.getPlotContributions(this.plotID.toString()).subscribe({next:e=>{this.contribution=e},error:e=>{console.error(e)}})}applyFilterGlobalProfit(e,n){this.dt.filterGlobal(e.target.value,n)}isProfitEmpty(){return 0===this.profitdistribution.length}exportTableToExcel(){const e=this.toExcelFormat();this.exptoexcel.exportExcel(e,[],[],"PlotSummary_"+ui())}toExcelFormat(){let e=[];e.push(["Plot Details"]),e.push(["Land Cost:","Tax","Commission"]),e.push([Number(this.landcost).toLocaleString(),Number(this.tax).toLocaleString(),Number(this.commission).toLocaleString()]),e.push([""]),e.push(["Investment"]),e.push(["Investor","Contribtuion"]);for(var n=0;n<this.contribution.length;n++)e.push([this.contribution[n].investor,Number(this.contribution[n].contributions).toLocaleString()]);for(e.push([""]),e.push(["Plot Sale","",""]),e.push(["Seling Date","Selling Price","Net Profit"]),e.push(null!=this.obj_sellingdate?[Qr(this.obj_sellingdate),Number(this.sellingprice).toLocaleString(),Number(this.netprofit).toLocaleString()]:["",Number(this.sellingprice).toLocaleString(),Number(this.netprofit).toLocaleString()]),e.push(["","",""]),e.push(["Profit Distribution","",""]),e.push(["Investor","Land Cost","Total Cost","Net Profit","Contribution","Investor Share","Office Share","Amount"]),n=0;n<this.profitdistribution.length;n++)e.push([this.profitdistribution[n].investor,Number(this.profitdistribution[n].t_landcost).toLocaleString(),Number(this.profitdistribution[n].t_sellingprice).toLocaleString(),Number(this.profitdistribution[n].netprofit).toLocaleString(),Number(this.profitdistribution[n].contributions).toLocaleString(),Number(this.profitdistribution[n].investorshare).toLocaleString(),this.profitdistribution[n].officepercentage+"%",Number(this.profitdistribution[n].officeshare).toLocaleString()]);return e}}return t.\u0275fac=function(e){return new(e||t)(te(i_),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-plotsummary"]],viewQuery:function(e,n){if(1&e&&(Mt(Yle,5),Mt(Xle,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.dtprofit=r.first)}},inputs:{contribution:"contribution",landcost:"landcost",tax:"tax",plotID:"plotID",commission:"commission",obj_sellingdate:"obj_sellingdate",sellingprice:"sellingprice",totalcost:"totalcost",netprofit:"netprofit",_plotprice:"_plotprice",profitdistribution:"profitdistribution"},decls:47,vars:40,consts:[["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows"],["dt",""],["pTemplate","header"],["pTemplate","body"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dtprofit",""],["pTemplate","caption"],[1,"project-btn-group","project-btn-group--right","project-btn-group--spaced"],[1,"btn-project","btn-sm",3,"click"],["style","text-align: center;",4,"ngIf"],[4,"ngIf"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"p")(1,"b"),_(2,"Investment"),p()(),f(3,"p-table",0,1),D(5,Jle,8,1,"ng-template",2),D(6,ece,9,9,"ng-template",3),p(),f(7,"p")(8,"b"),_(9,"Plot Details"),p(),ee(10,"br"),_(11," Land Cost:\xa0\xa0"),f(12,"b"),_(13),Ne(14,"currency"),p(),_(15," \xa0\xa0 Tax:\xa0\xa0"),f(16,"b"),_(17),Ne(18,"currency"),p(),_(19," \xa0\xa0 Commission:\xa0\xa0"),f(20,"b"),_(21),Ne(22,"currency"),p()(),f(23,"p")(24,"b"),_(25,"Plot Sale"),p(),ee(26,"br"),_(27," Seling Date:\xa0\xa0"),f(28,"b"),_(29),p(),_(30," \xa0\xa0 Selling Price:\xa0\xa0"),f(31,"b"),_(32),Ne(33,"currency"),p(),_(34," \xa0\xa0 Net Profit: \xa0\xa0"),f(35,"b"),_(36),Ne(37,"currency"),p()(),f(38,"p-table",4,5),D(40,tce,4,0,"ng-template",6),D(41,nce,19,0,"ng-template",2),D(42,ice,25,39,"ng-template",3),p(),f(43,"div",7)(44,"button",8),L("click",function(){return n.exportTableToExcel()}),_(45,"Excel"),p()(),D(46,rce,2,0,"div",9)),2&e&&(v(3),T("value",n.contribution)("paginator",!0)("rows",10),v(10),U(He(14,14,n.parseAsNumber(n.landcost)," ","symbol","1.0-0")),v(4),U(He(18,19,n.parseAsNumber(n.tax)," ","symbol","1.0-0")),v(4),U(He(22,24,n.parseAsNumber(n.commission)," ","symbol","1.0-0")),v(8),U(n.obj_sellingdate),v(3),U(He(33,29,n.sellingprice," ","symbol","1.0-0")),v(4),U(He(37,34,n.netprofit," ","symbol","1.0-0")),v(2),T("value",n.profitdistribution)("paginator",!0)("rows",10)("globalFilterFields",rt(39,oce)),v(8),T("ngIf",n.isProfitEmpty()))},directives:[ki,zn,Sn,li],pipes:[dr],styles:[""]}),t})();const Au=Ws_apiUrl,sS={headers:new io({"Content-Type":"application/json"})};let r_=(()=>{class t{constructor(e){this._http=e}addInvestor(e){const{name:n,mobile:r,investment:o,address:c}=e.value;return this._http.post(Au+"addInvestor",{name:n,mobile:r,investment:o,address:c},sS)}updateInvestor(e){const{id:n,name:r,mobile:o,investment:c,address:u}=e.value;return this._http.post(Au+"updateInvestor",{id:n,name:r,mobile:o,investment:c,address:u},sS)}getInvestors(e){return this._http.get(Au+"getInvestors")}deleteInvestor(e){return this._http.delete(`${Au}deleteInvestor`,{body:{id:e}})}getInvestorsCombo(){return this._http.get(Au+"getInvestorsCombo")}getInvestorTransaction(e){return this._http.get(Au+"getInvestorTransaction",{params:{id:e.toString()}})}getInvestorSummary(e){return console.log(e),this._http.get(Au+"getInvestorProjectSummary",{params:{id:e.toString()}})}getPlotInvestmentSummary(e){return this._http.get(Au+"getPlotInvestmentSummary",{params:{id:e.toString()}})}addInvestorTransaction(e){console.log(e.value);const{investor:n,totalamount:r,profit:o,status:c,remarks:u}=e.value,m=new Date(e.value.transactiondate),g=this.formatDate(m);return this._http.post(Au+"addInvestorTransaction",{transactiondate:g,investor:n,totalamount:r,profit:o,status:c,remarks:u},sS)}updateInvestorTransaction(e){const{id:n,totalamount:r,profit:o,status:c,remarks:u}=e.value,m=new Date(e.value.transactiondate),g=this.formatDate(m);return this._http.post(Au+"updateInvestorTransaction",{id:n,transactiondate:g,totalamount:r,profit:o,status:c,remarks:u},sS)}deleteInvestorTransaction(e){return this._http.delete(`${Au}deleteInvestorTransaction`,{body:{id:e}})}formatDate(e){return`${e.getFullYear().toString().slice(-2)}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const ace=["dt"];function lce(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedInvestor.name)}}function cce(t,i){1&t&&D(0,lce,3,1,"div",27),2&t&&T("ngIf",A().selectedInvestor)}function uce(t,i){if(1&t&&(f(0,"div",28)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.name)}}function dce(t,i){1&t&&(f(0,"small",29),_(1," Investor is required. "),p())}function fce(t,i){1&t&&(f(0,"small",29),_(1," Contribution is required. "),p())}function pce(t,i){1&t&&(f(0,"small",29),_(1," Office Share is required. "),p())}function hce(t,i){if(1&t){const e=Ie();f(0,"div",30)(1,"span",31),ee(2,"i",32),f(3,"input",33),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function mce(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function gce(t,i){1&t&&(f(0,"th"),_(1,"InvestorID"),p())}function _ce(t,i){1&t&&(f(0,"th"),_(1,"OfficeShare"),p())}function vce(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,mce,2,0,"th",27),D(4,gce,2,0,"th",27),D(5,_ce,2,0,"th",27),f(6,"th"),_(7,"Investor"),p(),f(8,"th"),_(9,"Contribution"),p(),f(10,"th"),_(11,"Action"),p()()),2&t&&(v(3),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1))}function yce(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function bce(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.investorid)}}function xce(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.officeshare)}}function wce(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,yce,2,1,"td",27),D(4,bce,2,1,"td",27),D(5,xce,2,1,"td",27),f(6,"td"),_(7),p(),f(8,"td"),_(9),Ne(10,"currency"),p(),f(11,"td")(12,"button",34),L("click",function(){const o=z(e).$implicit;return A().editContribution(o)}),p(),f(13,"button",35),L("click",function(){const o=z(e).$implicit;return A().deleteContribution(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(2),U(e.investor),v(2),U(He(10,6,e.contribution," ","symbol","1.0-0"))}}function Cce(t,i){1&t&&(f(0,"div",36),_(1,"No data found"),p())}const Tce=function(){return{width:"100%"}},Sce=function(){return["investor"]},Ece=function(){return{width:"450px"}};let kce=(()=>{class t{constructor(e,n,r,o,c,u,m){this._ms=e,this._ps=n,this._cs=r,this._is=o,this.confirmationService=c,this.pdfserv=u,this.exptoexcel=m,this.contribution=[],this.total_contribution=0,this.headerData=["Investor","Amount"],this.total_contributions=0}ngOnInit(){this.investorForm=new Zn({plot:new Me(""),investor:new Me("",jt.required),contributions:new Me("",jt.required),plotprice:new Me(""),officeshare:new Me("",jt.required)}),this.inv_contribution={id:"",project:"",investorid:"",investor:"",contribution:"",profit:"",investorshare:"",officeshare:"",budget:""},this.loadInvestors()}loadInvestors(){this._is.getInvestorsCombo().subscribe(e=>{this.investors=e},e=>{console.log(e)})}loadContributions(){this.total_contributions=0,this._cs.getPlotContributions(this.plotID.toString()).subscribe({next:e=>{this.contribution=e,e.forEach(n=>{this.total_contributions=this.total_contributions+Number(n.contribution)})},error:e=>{console.error(e)}})}isContributionEmpty(){return 0===this.contribution.length}editContribution(e){this.inv_contribution=Object.assign({},e),this.selectedInvestor=this.inv_contribution.investorid}addPlotContribution(e){this.investorForm.value.plot=this.plotID,this.investorForm.value.investor=this.selectedInvestor.id,this.total_contribution=0,this.contribution.forEach(n=>{this.total_contribution=Number(this.total_contribution)+Number(n.contribution)}),this.inv_contribution.id?(this.investorForm.value.investor=this.selectedInvestor,this.investorForm.value.id=this.inv_contribution.id,this.investorForm.value.officeshare=this.inv_contribution.officeshare,this.investorForm.value.contributions=this.inv_contribution.contribution,this._cs.updatePlotContribution(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Contribution is updated successfully."}),this.resetForm(),this.inv_contribution={},this.loadContributions()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating contribution."})}})):(this.investorForm.value.investor=this.selectedInvestor,this._cs.addPlotContribution(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Contribution is saved successfully."}),this.resetForm(),this.loadContributions()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while saving contribution."})}}))}deleteContribution(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._cs.deletePlotContribution(e.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Contribution deleted successfully.",life:3e3}),this.loadContributions()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting contribution.",life:3e3})}})}})}resetForm(){const{plotprice:e}=this.investorForm.value;this.investorForm.reset({plotprice:e})}applyFilterGlobal(e,n){console.log(n),this.dt.filterGlobal(e.target.value,n)}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],"Plot-Contributions_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"Plot-Contributions_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.contribution.length;n++)e.push([this.contribution[n].investor,this.contribution[n].contribution.toLocaleString()]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.contribution.length;n++)e.push([this.contribution[n].investor,this.contribution[n].contribution.toLocaleString()]);return e}toPdfFooterFormat(){let e=[];return e.push(["Total",this.total_contributions.toLocaleString()]),e}toExcelFooterFormat(e){return e.push(["","","","","",""]),e.push(["Total",this.total_contributions.toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(ll),te(i_),te(r_),te(Un),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-plotcontribution"]],viewQuery:function(e,n){if(1&e&&Mt(ace,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{contribution:"contribution",plotID:"plotID",_plotprice:"_plotprice",total_contributions:"total_contributions"},features:[Nn([Is,kn,Un])],decls:53,vars:29,consts:[[3,"formGroup"],[1,"row"],[1,"col-lg-3","col-md-3","col-sm-3"],[1,"form-group"],["for","plotprice",2,"margin-right","10px"],["pInputText","","type","text","id","plotprice","name","plotprice","formControlName","plotprice","readonly","",1,"form-control",3,"ngModel","ngModelChange"],["for","contributions",2,"margin-right","10px"],["id","investor","name","investor","optionLabel","name","filterBy","name","placeholder","Select Investor","appendTo","body","optionValue","id","autoWidth","false","formControlName","investor",3,"options","ngModel","filter","ngModelChange"],["class","custom-dropdown"],["class","p-error block",4,"ngIf"],["pInputText","","type","number","id","contributions","name","contributions","formControlName","contributions",1,"form-control",3,"ngModel","ngModelChange"],["for","officeshare",2,"margin-right","10px"],["pInputText","","type","number","id","officeshare","name","officeshare","formControlName","officeshare",1,"form-control",3,"ngModel","ngModelChange"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["type","button",1,"btn-project",3,"click"],[1,"bi","bi-arrow-counterclockwise"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"project-btn-group","project-btn-group--right","project-btn-group--spaced"],[1,"btn-project","btn-sm",3,"click"],["style","text-align: center;",4,"ngIf"],["position","bottom-right"],[4,"ngIf"],[1,"flex","align-items-center","gap-2"],[1,"p-error","block"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),_(5,"Total Plot Cost"),p(),f(6,"input",5),L("ngModelChange",function(o){return n._plotprice=o}),p()()(),f(7,"div",2)(8,"div",3)(9,"label",6),_(10,"Investor"),p(),f(11,"p-dropdown",7),L("ngModelChange",function(o){return n.selectedInvestor=o}),D(12,cce,1,1,"ng-template",8),D(13,uce,3,1,"ng-template",8),p(),D(14,dce,2,0,"small",9),p()(),f(15,"div",2)(16,"div",3)(17,"label",6),_(18,"Contribution"),p(),f(19,"input",10),L("ngModelChange",function(o){return n.inv_contribution.contribution=o}),p(),D(20,fce,2,0,"small",9),p()(),f(21,"div",2)(22,"div",3)(23,"label",11),_(24,"Office Share"),p(),f(25,"input",12),L("ngModelChange",function(o){return n.inv_contribution.officeshare=o}),p(),D(26,pce,2,0,"small",9),p()()(),f(27,"div",13)(28,"button",14),L("click",function(){return n.addPlotContribution(n.investorForm)}),ee(29,"i",15),_(30," Save "),p(),f(31,"button",16),L("click",function(){return n.resetForm()}),ee(32,"i",17),_(33," Clear "),p()()(),ee(34,"hr"),f(35,"p-table",18,19),D(37,hce,4,0,"ng-template",20),D(38,vce,12,3,"ng-template",21),D(39,wce,14,11,"ng-template",22),p(),f(40,"div",23)(41,"button",24),L("click",function(){return n.exportTableToExcel()}),_(42,"Excel"),p(),f(43,"button",24),L("click",function(){return n.exportTableToPdf()}),_(44,"Pdf"),p()(),f(45,"p"),_(46,"Total Contribution: "),f(47,"strong"),_(48),Ne(49,"currency"),p()(),D(50,Cce,2,0,"div",25),ee(51,"p-toast",26)(52,"p-confirmDialog")),2&e&&(T("formGroup",n.investorForm),v(6),T("ngModel",n._plotprice),v(5),Ft(rt(26,Tce)),T("options",n.investors)("ngModel",n.selectedInvestor)("filter",!0),v(3),T("ngIf",n.investorForm.controls.investor.invalid&&n.investorForm.controls.investor.dirty),v(5),T("ngModel",n.inv_contribution.contribution),v(1),T("ngIf",n.investorForm.controls.contributions.invalid&&n.investorForm.controls.contributions.dirty),v(5),T("ngModel",n.inv_contribution.officeshare),v(1),T("ngIf",n.investorForm.controls.officeshare.invalid&&n.investorForm.controls.officeshare.dirty),v(2),T("disabled",n.investorForm.invalid),v(7),T("value",n.contribution)("paginator",!0)("rows",10)("globalFilterFields",rt(27,Sce)),v(13),U(He(49,21,n.total_contributions," ","symbol","1.0-0")),v(2),T("ngIf",n.isContributionEmpty()),v(2),Ft(rt(28,Ece)))},directives:[Hr,Ur,Pr,Ir,li,Er,zr,us,Sn,qo,ki,zn,_r,fr,mo],pipes:[dr],styles:[""]}),t})();function Dce(t,i){1&t&&(f(0,"small",26),_(1," Selling Price is required. "),p())}function Ice(t,i){1&t&&(f(0,"small",26),_(1," Selling Date is required. "),p())}function Ace(t,i){}function Mce(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Fce(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Mce,2,0,"th",27),f(4,"th"),_(5,"Selling Date"),p(),f(6,"th"),_(7,"Selling Price"),p(),f(8,"th"),_(9,"Tax"),p(),f(10,"th"),_(11,"Commission"),p(),f(12,"th"),_(13,"Total Price"),p(),f(14,"th"),_(15,"Total Cost"),p(),f(16,"th"),_(17,"Net Profit"),p(),f(18,"th"),_(19,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Pce(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Oce(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Pce,2,1,"td",27),f(4,"td"),_(5),Ne(6,"date"),p(),f(7,"td"),_(8),Ne(9,"currency"),p(),f(10,"td"),_(11),Ne(12,"currency"),p(),f(13,"td"),_(14),Ne(15,"currency"),p(),f(16,"td"),_(17),Ne(18,"currency"),p(),f(19,"td"),_(20),Ne(21,"currency"),p(),f(22,"td"),_(23),Ne(24,"currency"),p(),f(25,"td")(26,"button",28),L("click",function(){const o=z(e).$implicit;return A().updateplotsale(o)}),p(),_(27," \xa0"),f(28,"button",29),L("click",function(){const o=z(e).$implicit;return A().deleteplotsale(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(Oa(6,9,e.sellingdate,"dd-MM-yyyy")),v(3),U(He(9,12,e.sellingprice," ","symbol","1.0-0")),v(3),U(He(12,17,e.tax," ","symbol","1.0-0")),v(3),U(He(15,22,e.commission," ","symbol","1.0-0")),v(3),U(He(18,27,e.totalprice," ","symbol","1.0-0")),v(3),U(He(21,32,e.totalcost," ","symbol","1.0-0")),v(3),U(He(24,37,e.netprofit," ","symbol","1.0-0"))}}function Nce(t,i){1&t&&(f(0,"div",30),_(1,"No data found"),p())}const Lce=function(){return{width:"450px"}};let Rce=(()=>{class t{constructor(e,n,r){this._ms=e,this._ps=n,this.confirmationService=r,this.salecost=[],this.plotID=0}ngOnInit(){this.plotSale={id:"",sellingdate:"",sellingprice:"",tax:"",commission:"",netprofit:""},this.plotSaleForm=new Zn({id:new Me(""),plot:new Me(""),sellingdate:new Me("",jt.required),sellingprice:new Me("",jt.required),tax:new Me(""),commission:new Me("")})}getPlotSale(){this._ps.getPlotSale(this.plotID.toString()).subscribe({next:e=>{this.salecost=e},error:e=>{console.error(e)}})}isPlotsEmpty(){return 0===this.salecost.length}addPlotSale(e){this.salecost.length>0?this._ms.add({severity:"error",summary:"Error",detail:"Plot is already sold out.",life:3e3}):this.plotSale.id?(this.plotSaleForm.value.id=this.plotSale.id,this.plotSaleForm.value.plot=this.plotID,this._ps.updatePlotSale(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Plot sale is updated successfully.",life:3e3}),this.plotSaleForm.reset(),this.getPlotSale()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while updating plot sale.",life:3e3})}})):(this.plotSaleForm.value.plot=this.plotID,this._ps.addPlotSale(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Plot sale cost recorded successfully."}),this.plotSaleForm.reset(),this.getPlotSale()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while recording plot sale."})}}))}updateplotsale(e){this.plotSale.id=e.id.toString(),this.plotSale.sellingdate=e.sellingdate,this.obj_sellingdate=new Date(this.plotSale.sellingdate),this.plotSale.sellingprice=e.sellingprice,this.plotSale.tax=e.tax,this.plotSale.commission=e.commission}deleteplotsale(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._ps.deletePlotSale(e.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Plot sale entry deleted successfully.",life:3e3}),this.getPlotSale()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting plot sale.",life:3e3})}})}})}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(pM),te(Un))},t.\u0275cmp=dn({type:t,selectors:[["app-addplotsale"]],inputs:{salecost:"salecost",plotID:"plotID"},features:[Nn([kn,Un])],decls:39,vars:15,consts:[[3,"formGroup"],[1,"row"],[1,"col-lg-3","col-md-3","col-sm-3"],[1,"form-group"],["for","sellingprice",2,"margin-right","10px"],["pInputText","","type","number","id","sellingprice","name","sellingprice","formControlName","sellingprice",1,"form-control",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],["for","tax",2,"margin-right","10px"],["pInputText","","type","number","id","tax","name","tax","formControlName","tax",1,"form-control",3,"ngModel","ngModelChange"],["for","commission",2,"margin-right","10px"],["pInputText","","type","number","id","commission","name","commission","formControlName","commission",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-lg-3","col-md-3","col-sm-6"],["for","sellingdate"],["id","sellingdate","name","sellingdate","formControlName","sellingdate","classs","form-control","dateFormat","dd-mm-yy",3,"ngModel","ngModelChange"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["type","button",1,"btn-project",3,"click"],[1,"bi","bi-arrow-counterclockwise"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],["position","bottom-right"],[1,"p-error","block"],[4,"ngIf"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),_(5,"Price"),p(),f(6,"input",5),L("ngModelChange",function(o){return n.plotSale.sellingprice=o}),p(),D(7,Dce,2,0,"small",6),p()(),f(8,"div",2)(9,"div",3)(10,"label",7),_(11,"Tax"),p(),f(12,"input",8),L("ngModelChange",function(o){return n.plotSale.tax=o}),p()()(),f(13,"div",2)(14,"div",3)(15,"label",9),_(16,"Commission"),p(),f(17,"input",10),L("ngModelChange",function(o){return n.plotSale.commission=o}),p()()(),f(18,"div",11)(19,"div",3)(20,"label",12),_(21,"Selling Date"),p(),f(22,"p-calendar",13),L("ngModelChange",function(o){return n.obj_sellingdate=o}),p(),D(23,Ice,2,0,"small",6),p()()()(),f(24,"div",14)(25,"button",15),L("click",function(){return n.addPlotSale(n.plotSaleForm)}),ee(26,"i",16),_(27," Save "),p(),f(28,"button",17),L("click",function(){return n.plotSaleForm.reset()}),ee(29,"i",18),_(30," Clear All "),p()(),f(31,"p-table",19,20),D(33,Ace,0,0,"ng-template",21),D(34,Fce,20,1,"ng-template",22),D(35,Oce,29,42,"ng-template",23),p(),D(36,Nce,2,0,"div",24),ee(37,"p-confirmDialog")(38,"p-toast",25)),2&e&&(T("formGroup",n.plotSaleForm),v(6),T("ngModel",n.plotSale.sellingprice),v(1),T("ngIf",n.plotSaleForm.controls.sellingdate.invalid&&n.plotSaleForm.controls.sellingdate.dirty),v(5),T("ngModel",n.plotSale.tax),v(5),T("ngModel",n.plotSale.commission),v(5),T("ngModel",n.obj_sellingdate),v(1),T("ngIf",n.plotSaleForm.controls.sellingdate.invalid&&n.plotSaleForm.controls.sellingdate.dirty),v(2),T("disabled",n.plotSaleForm.invalid),v(6),T("value",n.salecost)("paginator",!0)("rows",10),v(5),T("ngIf",n.isPlotsEmpty()),v(1),Ft(rt(14,Lce)))},directives:[Hr,Ur,Pr,qo,Ir,li,Er,zr,Sn,oc,ki,zn,_r,mo,fr],pipes:[al,dr],styles:[""]}),t})();const Bce=["dt"];function jce(t,i){if(1&t){const e=Ie();f(0,"div",8)(1,"span",9),ee(2,"i",10),f(3,"input",11),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function Vce(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),f(3,"th"),_(4,"Investor"),p(),f(5,"th"),_(6,"Total Cost"),p(),f(7,"th"),_(8,"Selling Price"),p(),f(9,"th"),_(10,"Net Profit"),p(),f(11,"th"),_(12,"Contribution"),p(),f(13,"th"),_(14,"Investor Share"),p(),f(15,"th"),_(16,"Office Share"),p(),f(17,"th"),_(18,"Amount"),p()())}function Uce(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2),p(),f(3,"td"),_(4),p(),f(5,"td"),_(6),Ne(7,"currency"),p(),f(8,"td"),_(9),Ne(10,"currency"),p(),f(11,"td"),_(12),Ne(13,"currency"),p(),f(14,"td"),_(15),Ne(16,"currency"),p(),f(17,"td"),_(18),Ne(19,"currency"),p(),f(20,"td"),_(21),p(),f(22,"td"),_(23),Ne(24,"currency"),p()()),2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(2),U(e.investor),v(2),U(He(7,9,e.t_landcost," ","symbol","1.0-0")),v(3),U(He(10,14,e.t_sellingprice," ","symbol","1.0-0")),v(3),U(He(13,19,e.netprofit," ","symbol","1.0-0")),v(3),U(He(16,24,e.contributions," ","symbol","1.0-0")),v(3),U(He(19,29,e.investorshare," ","symbol","1.0-0")),v(3),hn("",e.officepercentage," %"),v(2),hn("",He(24,34,e.officeshare," ","symbol","1.0-0")," ")}}function Hce(t,i){1&t&&(f(0,"div",12),_(1,"No data found"),p())}const zce=function(){return["investor"]};let $ce=(()=>{class t{constructor(e,n){this.pdfserv=e,this.exptoexcel=n,this.profitdistribution=[],this.headerData=["Investor","Total Cost","Selling Price","Net Profit","Contribution","Investor Share","Office Share","Amount"]}ngOnInit(){}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}isProfitEmpty(){return 0===this.profitdistribution.length}exportTableToExcel(){const e=this.toExcelFormat();this.exptoexcel.exportExcel(e,this.headerData,[],"Profit_Distribution"+ui())}exportTableToPdf(){const e=this.toPdfFormat();this.toPdfFooterFormat(),this.pdfserv.generatePdf(this.headerData,e,[],"Profit_Distribution_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.profitdistribution.length;n++)e.push([this.profitdistribution[n].investor,this.profitdistribution[n].t_landcost.toLocaleString(),this.profitdistribution[n].t_sellingprice.toLocaleString(),this.profitdistribution[n].netprofit.toLocaleString(),this.profitdistribution[n].contributions.toLocaleString(),this.profitdistribution[n].investorshare.toLocaleString(),this.profitdistribution[n].officepercentage+"%",this.profitdistribution[n].officeshare.toLocaleString()]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.profitdistribution.length;n++)e.push([this.profitdistribution[n].investor,this.profitdistribution[n].t_landcost.toLocaleString(),this.profitdistribution[n].t_sellingprice.toLocaleString(),this.profitdistribution[n].netprofit.toLocaleString(),this.profitdistribution[n].contributions.toLocaleString(),this.profitdistribution[n].investorshare.toLocaleString(),this.profitdistribution[n].officepercentage+"%",this.profitdistribution[n].officeshare.toLocaleString()]);return e}toPdfFooterFormat(){let e=[];return e.push(["","","","","Total",this.profitdistribution[0].contributions.toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-plotprofitdistribution"]],viewQuery:function(e,n){if(1&e&&Mt(Bce,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{profitdistribution:"profitdistribution"},decls:11,vars:6,consts:[["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"project-btn-group","project-btn-group--right","project-btn-group--spaced"],[1,"btn-project","btn-sm",3,"click"],["style","text-align: center;",4,"ngIf"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"p-table",0,1),D(2,jce,4,0,"ng-template",2),D(3,Vce,19,0,"ng-template",3),D(4,Uce,25,39,"ng-template",4),p(),f(5,"div",5)(6,"button",6),L("click",function(){return n.exportTableToExcel()}),_(7,"Excel"),p(),f(8,"button",6),L("click",function(){return n.exportTableToPdf()}),_(9,"Pdf"),p()(),D(10,Hce,2,0,"div",7)),2&e&&(T("value",n.profitdistribution)("paginator",!0)("rows",10)("globalFilterFields",rt(5,zce)),v(10),T("ngIf",n.isProfitEmpty()))},directives:[ki,zn,li,Sn],pipes:[dr],styles:[""]}),t})();const Wce=["dt"],qce=["tabView"],Gce=["menustab"];function Kce(t,i){if(1&t){const e=Ie();f(0,"div",28)(1,"span",29),ee(2,"i",30),f(3,"input",31),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function Yce(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Xce(t,i){1&t&&(f(0,"th"),_(1,"LocID"),p())}function Qce(t,i){1&t&&(f(0,"th"),_(1,"Location"),p())}function Jce(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Yce,2,0,"th",32),D(4,Xce,2,0,"th",32),D(5,Qce,2,0,"th",32),f(6,"th"),_(7,"Plot No"),p(),f(8,"th"),_(9,"Size"),p(),f(10,"th"),_(11,"Purchase Date"),p(),f(12,"th"),_(13,"Payment Mode"),p(),f(14,"th"),_(15,"Land Cost"),p(),f(16,"th"),_(17,"Commission"),p(),f(18,"th"),_(19,"Taxes"),p(),f(20,"th"),_(21,"Action"),p()()),2&t&&(v(3),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1))}function Zce(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function eue(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.loc_id)}}function tue(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.location)}}function nue(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Zce,2,1,"td",32),D(4,eue,2,1,"td",32),D(5,tue,2,1,"td",32),f(6,"td",19),L("click",function(){const o=z(e).$implicit;return A().toggle(o)}),_(7),p(),f(8,"td"),_(9),p(),f(10,"td"),_(11),Ne(12,"date"),p(),f(13,"td"),_(14),p(),f(15,"td"),_(16),Ne(17,"currency"),p(),f(18,"td"),_(19),Ne(20,"currency"),p(),f(21,"td"),_(22),Ne(23,"currency"),p(),f(24,"td")(25,"button",33),L("click",function(){const o=z(e).$implicit;return A().updatePlot(o)}),p(),_(26," \xa0"),f(27,"button",34),L("click",function(){const o=z(e).$implicit;return A().deletePlot(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(2),U(e.plotno),v(2),U(e.size),v(2),U(Oa(12,11,e.purchasedate,"dd-MM-yyyy")),v(3),U(e.modeofpayment),v(2),U(He(17,14,e.landcost," ","symbol","1.0-0")),v(3),U(He(20,19,e.commission," ","symbol","1.0-0")),v(3),U(He(23,24,e.taxes," ","symbol","1.0-0"))}}function iue(t,i){1&t&&(f(0,"div",35),_(1,"No data found"),p())}const rue=function(){return["location"]},oue=function(){return{width:"450px"}};let sue=(()=>{class t{constructor(e,n,r,o,c,u,m){this.plot_Service=e,this.dialogService=n,this.messageService=r,this._cs=o,this.confirmationService=c,this.pdfserv=u,this.exptoexcel=m,this.plots=[],this.displayDialog=!1,this.displayAddModal=!1,this.activeIndex=0,this.plotID=0,this.contribution=[],this.salecost=[],this.total_contributions=0,this.profitdistribution=[],this._plotprice=" ",this._landcost=" ",this._commission=" ",this._taxes=" ",this._totalprice=0,this._totalcost=0,this._netprofit=0,this.headerData=["Plot No","Size","Purchase Date","Payment Mode","Land Cost","Commission"]}toggle(e){this.menustab.disabled=!1,this.plotID=e.id,this.activeIndex=1}toggleSummaryPanel(){this._cs.getPlotContributions(this.plotID.toString()).subscribe({next:e=>{this.contribution=e},error:e=>{console.error(e)}}),this.plot_Service.getPlot(this.plotID.toString()).subscribe({next:e=>{this._landcost=" ",this._taxes="",this._commission=" ",e.forEach(n=>{this._landcost=n.landcost,this._commission=n.commission,this._taxes=n.taxes,this._sellingprice=n.sellingprice})},error:e=>{console.error(e)}}),this.plot_Service.getPlotSale(this.plotID.toString()).subscribe({next:e=>{this.salecost=e,e.forEach(n=>{this._totalprice=n.totalprice,this._totalcost=n.totalcost,this._netprofit=n.netprofit,this.obj_sellingdate=new Date(n.sellingdate);var r=this.obj_sellingdate.getDate(),o=this.obj_sellingdate.getMonth()+1,c=this.obj_sellingdate.getFullYear();this.obj_sellingdate=(r<10?"0"+r:r)+"-"+(o<10?"0"+o:o)+"-"+c})},error:e=>{console.error(e)}}),this.plot_Service.getProfitContribution(this.plotID.toString()).subscribe({next:e=>{console.log(e),this.profitdistribution=e},error:e=>{console.error(e)}}),this.activeIndex=2}toggleInvestorsPanel(){this._cs.getPlotPrice(this.plotID.toString()).subscribe({next:e=>{this._plotprice=e[0].plotprice},error:e=>{console.error(e)}}),this.total_contributions=0,this._cs.getPlotContributions(this.plotID.toString()).subscribe({next:e=>{this.contribution=e,e.forEach(n=>{this.total_contributions=this.total_contributions+Number(n.contribution)})},error:e=>{console.error(e)}}),this.activeIndex=3}togglePSPanel(){this.plot_Service.getPlotSale(this.plotID.toString()).subscribe({next:e=>{this.salecost=e},error:e=>{console.error(e)}}),this.activeIndex=4}togglePDPanel(){this.plot_Service.getProfitContribution(this.plotID.toString()).subscribe({next:e=>{console.log(e),this.profitdistribution=e},error:e=>{console.error(e)}}),this.activeIndex=5}ngOnInit(){this.getPlots()}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}getPlots(){this.plot_Service.getPlots().subscribe({next:e=>{this.plots=e,this.selectedPlot=this.plots[0]},error:e=>{console.error(e)}})}isPlotsEmpty(){return 0===this.plots.length}showAddPlotDialog(){this.plot={id:"",loc_id:"",location:"",plotno:"",size:"",unit:"",landcost:"",purchasedate:"",commission:"",taxes:"",modeofpayment:"",remarks:""},this.selectedLocation="",this.obj_purchasedate="",this.displayAddModal=!0}hideAddModal(e){this.displayAddModal=!e}updatePlotList(e){this.getPlots()}updatePlot(e){this.plot=Object.assign({},e),this.obj_purchasedate=new Date(this.plot.purchasedate),this.selectedLocation=this.plot.loc_id,this.displayAddModal=!0}deletePlot(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this.plot_Service.deletePlot(e.id.toString()).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Plot deleted successfully.",life:3e3}),this.getPlots()},error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:n.error.message,life:3e3})}})}})}exportTableToExcel(){const e=this.toExcelFormat();this.exptoexcel.exportExcel(e,this.headerData,[],"Plots_"+ui())}exportTableToPdf(){const e=this.toPdfFormat();this.toPdfFooterFormat(),this.pdfserv.generatePdf(this.headerData,e,[],"Plots_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.plots.length;n++)e.push([this.plots[n].plotno,this.plots[n].size,Qr(this.plots[n].purchasedate),this.plots[n].modeofpayment,this.plots[n].landcost.toLocaleString(),Number(this.plots[n].commission).toLocaleString(),Number(this.plots[n].taxes).toLocaleString()]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.plots.length;n++)e.push([this.plots[n].plotno,this.plots[n].size,Qr(this.plots[n].purchasedate),this.plots[n].modeofpayment,this.plots[n].landcost.toLocaleString(),Number(this.plots[n].commission).toLocaleString(),Number(this.plots[n].taxes).toLocaleString()]);return e}toPdfFooterFormat(){let e=[];return e.push(["","","","","Total",this.plots[0].taxes.toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(pM),te(Is),te(kn),te(i_),te(Un),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-plot"]],viewQuery:function(e,n){if(1&e&&(Mt(Wce,5),Mt(qce,5),Mt(Gce,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.tabView=r.first),xt(r=wt())&&(n.menustab=r.first)}},features:[Nn([Is,kn,Un])],decls:47,vars:36,consts:[[1,"text-muted"],[3,"activeIndex","activeIndexChange"],["tabView",""],["header","Plots"],[1,"project-btn-group","project-btn-group--spaced"],[1,"btn-project",3,"click"],[1,"bi","bi-plus-lg"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"project-btn-group","project-btn-group--right","project-btn-group--spaced"],[1,"btn-project","btn-sm",3,"click"],["style","text-align: center;",4,"ngIf"],[2,"width","600px",3,"displayAddModal","plot","obj_purchasedate","selectedLocation","plotID","clickClose","clickAdd"],["position","bottom-right"],["header","Main Menu",3,"disabled"],["menustab",""],[1,"list-item",3,"click"],["header","Summary",3,"disabled"],[3,"plotID","contribution","tax","landcost","commission","netprofit","sellingprice","obj_sellingdate","profitdistribution"],["header","Contributions",3,"disabled"],[3,"plotID","contribution","_plotprice","total_contributions"],["header","Plot Sale",3,"disabled"],[3,"plotID","salecost"],["header","Profit Distribution",3,"disabled"],[3,"profitdistribution"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[4,"ngIf"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"h2",0),_(1,"Manage Plots"),p(),ee(2,"hr"),f(3,"p-tabView",1,2),L("activeIndexChange",function(o){return n.activeIndex=o}),f(5,"p-tabPanel",3)(6,"div",4)(7,"button",5),L("click",function(){return n.showAddPlotDialog()}),ee(8,"i",6),_(9," Add New "),p()(),f(10,"p-table",7,8),D(12,Kce,4,0,"ng-template",9),D(13,Jce,22,3,"ng-template",10),D(14,nue,28,29,"ng-template",11),p(),f(15,"div",12)(16,"button",13),L("click",function(){return n.exportTableToExcel()}),_(17,"Excel"),p(),f(18,"button",13),L("click",function(){return n.exportTableToPdf()}),_(19,"Pdf"),p()(),D(20,iue,2,0,"div",14),f(21,"app-addeditplot",15),L("clickClose",function(o){return n.hideAddModal(o)})("clickAdd",function(o){return n.updatePlotList(o)}),p(),ee(22,"p-confirmDialog")(23,"p-toast",16),p(),f(24,"p-tabPanel",17,18)(26,"ul")(27,"li",19),L("click",function(){return n.toggleSummaryPanel()}),f(28,"p"),_(29,"Plot Summary"),p()(),f(30,"li",19),L("click",function(){return n.toggleInvestorsPanel()}),f(31,"p"),_(32,"Contributions"),p()(),f(33,"li",19),L("click",function(){return n.togglePSPanel()}),f(34,"p"),_(35,"Plot Sale"),p()(),f(36,"li",19),L("click",function(){return n.togglePDPanel()}),f(37,"p"),_(38,"Profit Distribution"),p()()()(),f(39,"p-tabPanel",20),ee(40,"app-plotsummary",21),p(),f(41,"p-tabPanel",22),ee(42,"app-plotcontribution",23),p(),f(43,"p-tabPanel",24),ee(44,"app-addplotsale",25),p(),f(45,"p-tabPanel",26),ee(46,"app-plotprofitdistribution",27),p()()),2&e&&(v(3),T("activeIndex",n.activeIndex),v(7),T("value",n.plots)("paginator",!0)("rows",10)("globalFilterFields",rt(34,rue)),v(10),T("ngIf",n.isPlotsEmpty()),v(1),T("displayAddModal",n.displayAddModal)("plot",n.plot)("obj_purchasedate",n.obj_purchasedate)("selectedLocation",n.selectedLocation)("plotID",n.plotID),v(1),Ft(rt(35,oue)),v(2),T("disabled",!0),v(15),T("disabled",!0),v(1),T("plotID",n.plotID)("contribution",n.contribution)("tax",n._taxes)("landcost",n._landcost)("commission",n._commission)("netprofit",n._netprofit)("sellingprice",n._sellingprice)("obj_sellingdate",n.obj_sellingdate)("profitdistribution",n.profitdistribution),v(1),T("disabled",!0),v(1),T("plotID",n.plotID)("contribution",n.contribution)("_plotprice",n._plotprice)("total_contributions",n.total_contributions),v(1),T("disabled",!0),v(1),T("plotID",n.plotID)("salecost",n.salecost),v(1),T("disabled",!0),v(1),T("profitdistribution",n.profitdistribution))},directives:[Cf,wf,ki,zn,li,Sn,_r,Kle,mo,fr,sce,kce,Rce,$ce],pipes:[al,dr],styles:[".custom-dropdown[_ngcontent-%COMP%]{width:300px;height:60px}.list-item[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),t})();const nb=Ws_apiUrl,X7={headers:new io({"Content-Type":"application/json"})};let Q7=(()=>{class t{constructor(e){this._http=e}addCategory(e){return console.log("In service "+e),this._http.post(nb+"addCategory",{name:e},X7)}getCategories(){return this._http.get(nb+"getCategories")}summarizeCategory(e){return this._http.get(nb+"summarizeCategory",{params:{id:e.toString()}})}deleteCategory(e){return this._http.delete(`${nb}deleteCategory`,{body:{id:e}})}updateCategory(e,n){return this._http.post(nb+"updateCategory",{id:e,name:n},X7)}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const ib=Ws_apiUrl,J7={headers:new io({"Content-Type":"application/json"})};let hM=(()=>{class t{constructor(e){this._http=e}addContractor(e,n,r){return console.log("In service "+e+" "+n),this._http.post(ib+"addContractor",{name:e,mobile:n,service:r},J7)}updateContractor(e,n,r,o){return this._http.post(ib+"updateContractor",{id:e,name:n,mobile:r,service:o},J7)}summarizeContractor(e){return this._http.get(ib+"summarizeContractor",{params:{id:e.toString()}})}getContractors(){return this._http.get(ib+"getContractors")}deleteContractor(e){return this._http.delete(`${ib}deleteContractor`,{body:{id:e}})}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const aS=Ws_apiUrl,Z7={headers:new io({"Content-Type":"application/json"})};let aue=(()=>{class t{constructor(e){this._http=e}getServices(){return this._http.get(aS+"getServices")}addService(e){return this._http.post(aS+"addService",{name:e},Z7)}updateService(e,n){return this._http.post(aS+"updateService",{id:e,name:n},Z7)}deleteService(e){return this._http.delete(`${aS}deleteService`,{body:{id:e}})}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const lue=["dtcontractors"],cue=["dtcategories"],uue=["dtservices"];function due(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(3);v(2),U(e.selectedContractor)}}function fue(t,i){1&t&&D(0,due,3,1,"div",25),2&t&&T("ngIf",A(2).selectedContractor)}function pue(t,i){if(1&t&&(f(0,"div",26)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.name)}}function hue(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(3);v(2),U(e.selectedCategory)}}function mue(t,i){1&t&&D(0,hue,3,1,"div",25),2&t&&T("ngIf",A(2).selectedCategory)}function gue(t,i){if(1&t&&(f(0,"div",26)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.name)}}function _ue(t,i){1&t&&(f(0,"small",27),_(1," Payment date is required."),p())}function vue(t,i){1&t&&(f(0,"small",27),_(1," Amount is required."),p())}const e9=function(){return{width:"235px"}};function yue(t,i){if(1&t){const e=Ie();f(0,"form",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"label",12),_(5,"Contractor"),p(),f(6,"div",13)(7,"p-dropdown",14),L("ngModelChange",function(r){return z(e),A().selectedContractor=r}),D(8,fue,1,1,"ng-template",15),D(9,pue,3,1,"ng-template",15),p(),f(10,"button",16),L("click",function(){return z(e),A().showContractorDialog()}),_(11,"+"),p()()(),f(12,"div",11)(13,"label",17),_(14,"Category"),p(),f(15,"div",13)(16,"p-dropdown",18,19),L("ngModelChange",function(r){return z(e),A().selectedCategory=r}),D(18,mue,1,1,"ng-template",15),D(19,gue,3,1,"ng-template",15),p(),f(20,"button",16),L("click",function(){return z(e),A().showCategoryDialog()}),_(21,"+"),p()()()(),f(22,"div",10)(23,"div",11)(24,"label",17),_(25,"Payment Date"),p(),f(26,"p-calendar",20),L("ngModelChange",function(r){return z(e),A().obj_paymentdate=r}),p(),D(27,_ue,2,0,"small",21),p(),f(28,"div",11)(29,"label",17),_(30,"Description"),p(),f(31,"input",22),L("ngModelChange",function(r){return z(e),A().projcost.description=r}),p()()(),f(32,"div",10)(33,"div",11)(34,"label",17),_(35,"Amount (Rs.)"),p(),f(36,"input",23),L("ngModelChange",function(r){return z(e),A().projcost.amount=r}),p(),D(37,vue,2,0,"small",21),p(),f(38,"div",11)(39,"label",17),_(40,"Remarks"),p(),f(41,"input",24),L("ngModelChange",function(r){return z(e),A().projcost.remarks=r}),p()()()()()}if(2&t){const e=A();T("formGroup",e.projectCostForm),v(7),Ft(rt(21,e9)),T("options",e.contractors)("filter",!0)("ngModel",e.selectedContractor)("showClear",!0)("appendTo","body"),v(9),Ft(rt(22,e9)),T("options",e.categories)("filter",!0)("showClear",!0)("ngModel",e.selectedCategory)("appendTo","body"),v(10),T("ngModel",e.obj_paymentdate),v(1),T("ngIf",e.projectCostForm.controls.paymentdate.invalid&&e.projectCostForm.controls.paymentdate.dirty),v(4),T("ngModel",e.projcost.description),v(5),T("ngModel",e.projcost.amount),v(1),T("ngIf",e.projectCostForm.controls.amount.invalid&&e.projectCostForm.controls.amount.dirty),v(4),T("ngModel",e.projcost.remarks)}}function bue(t,i){if(1&t){const e=Ie();f(0,"div",28)(1,"div")(2,"button",29),L("click",function(){z(e);const r=A();return r.addProjectCost(r.projectCostForm)}),ee(3,"i",30),_(4,"Save"),p(),f(5,"button",31),L("click",function(){return z(e),A().closeModal()}),ee(6,"i",32),_(7,"Cancel"),p()()()}if(2&t){const e=A();v(2),T("disabled",e.projectCostForm.invalid)}}function xue(t,i){1&t&&(f(0,"small",27),_(1," Contractor name is required."),p())}function wue(t,i){1&t&&(f(0,"small",50),_(1," No services available. Click + to add one. "),p())}function Cue(t,i){1&t&&(f(0,"small",27),_(1," Service is required."),p())}function Tue(t,i){if(1&t){const e=Ie();f(0,"div",51),ee(1,"i",52),f(2,"input",53),L("input",function(r){return z(e),A(2).applyFilterContractors(r,"contains")}),p()()}}function Sue(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Eue(t,i){1&t&&(f(0,"tr")(1,"th")(2,"div",54),_(3," Sr# "),p()(),D(4,Sue,2,0,"th",25),f(5,"th"),_(6,"Name"),p(),f(7,"th"),_(8,"Mobile"),p(),f(9,"th"),_(10,"Service`"),p(),f(11,"th"),_(12,"Action"),p()()),2&t&&(v(4),T("ngIf",!1))}function kue(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Due(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,kue,2,1,"td",25),f(4,"td"),_(5),p(),f(6,"td"),_(7),p(),f(8,"td"),_(9),p(),f(10,"td")(11,"button",55),L("click",function(){const o=z(e).$implicit;return A(2).updateContractor(o)}),p(),_(12," \xa0"),f(13,"button",56),L("click",function(){const o=z(e).$implicit;return A(2).deleteContractor(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.name),v(2),U(e.mobile),v(2),U(e.service)}}function Iue(t,i){1&t&&(f(0,"div",57),_(1,"No data found"),p())}const Aue=function(){return{width:"200px"}},Mue=function(){return["name","service","mobile"]};function Fue(t,i){if(1&t){const e=Ie();f(0,"form",8)(1,"div",10)(2,"div",33)(3,"label",12),_(4,"Name"),p(),f(5,"div",13)(6,"input",34),L("ngModelChange",function(r){return z(e),A().contractor.name=r}),p()(),D(7,xue,2,0,"small",21),p(),f(8,"div",33)(9,"label",12),_(10,"Mobile"),p(),f(11,"div",13)(12,"input",35),L("ngModelChange",function(r){return z(e),A().contractor.mobile=r}),p()()(),f(13,"div",33)(14,"label",36),_(15,"Service"),p(),f(16,"div",37)(17,"p-dropdown",38),L("onChange",function(r){return z(e),A().onServiceChange(r)}),p(),f(18,"button",39),L("click",function(){return z(e),A().showServiceDialog()}),ee(19,"i",40),p()(),D(20,wue,2,0,"small",41),D(21,Cue,2,0,"small",21),p()()(),f(22,"div",42)(23,"button",43),L("click",function(){z(e);const r=A();return r.saveContractor(r.contractorForm)}),_(24,"Save"),p(),f(25,"button",16),L("click",function(){return z(e),A().hideContractorDialog()}),_(26,"Cancel"),p()(),ee(27,"hr"),f(28,"p-table",44,45),D(30,Tue,3,0,"ng-template",46),D(31,Eue,13,1,"ng-template",47),D(32,Due,14,5,"ng-template",48),p(),D(33,Iue,2,0,"div",49)}if(2&t){const e=A();T("formGroup",e.contractorForm),v(6),T("ngModel",e.contractor.name),v(1),T("ngIf",e.contractorForm.controls.name.invalid&&e.contractorForm.controls.name.dirty),v(5),T("ngModel",e.contractor.mobile),v(5),Ft(rt(17,Aue)),T("options",e.services)("filter",!0)("showClear",!0),v(3),T("ngIf",0===e.services.length),v(1),T("ngIf",e.contractorForm.controls.service.invalid&&e.contractorForm.controls.service.dirty),v(2),T("disabled",e.contractorForm.invalid),v(5),T("value",e.contractors)("paginator",!0)("rows",10)("globalFilterFields",rt(18,Mue)),v(5),T("ngIf",e.isContractorEmpty())}}function Pue(t,i){1&t&&(f(0,"small",27),_(1," Service name is required."),p())}function Oue(t,i){if(1&t){const e=Ie();f(0,"div",51),ee(1,"i",52),f(2,"input",53),L("input",function(r){return z(e),A(2).applyFilterServices(r,"contains")}),p()()}}function Nue(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Lue(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Nue,2,0,"th",25),f(4,"th"),_(5,"Name"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Rue(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Bue(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Rue,2,1,"td",25),f(4,"td"),_(5),p(),f(6,"td")(7,"button",55),L("click",function(){const o=z(e).$implicit;return A(2).updateService(o)}),p(),_(8," \xa0"),f(9,"button",56),L("click",function(){const o=z(e).$implicit;return A(2).deleteService(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.name)}}function jue(t,i){1&t&&(f(0,"div",57),_(1,"No data found"),p())}const t9=function(){return["name"]};function Vue(t,i){if(1&t){const e=Ie();f(0,"form",8)(1,"div",10)(2,"div",58)(3,"label",12),_(4,"Service Name"),p(),f(5,"div",13)(6,"input",34),L("ngModelChange",function(r){return z(e),A().service.name=r}),p()(),D(7,Pue,2,0,"small",21),p()()(),f(8,"div",42)(9,"button",43),L("click",function(){return z(e),A().saveService()}),ee(10,"i",59),_(11," Save "),p(),f(12,"button",16),L("click",function(){return z(e),A().hideServiceDialog()}),ee(13,"i",60),_(14," Cancel "),p()(),ee(15,"hr"),f(16,"p-table",44,61),D(18,Oue,3,0,"ng-template",46),D(19,Lue,8,1,"ng-template",47),D(20,Bue,10,3,"ng-template",48),p(),D(21,jue,2,0,"div",49)}if(2&t){const e=A();T("formGroup",e.serviceForm),v(6),T("ngModel",e.service.name),v(1),T("ngIf",e.serviceForm.controls.name.invalid&&e.serviceForm.controls.name.dirty),v(2),T("disabled",e.serviceForm.invalid),v(7),T("value",e.services)("paginator",!0)("rows",10)("globalFilterFields",rt(9,t9)),v(5),T("ngIf",e.isServiceEmpty())}}function Uue(t,i){1&t&&(f(0,"small",27),_(1," Category name is required."),p())}function Hue(t,i){if(1&t){const e=Ie();f(0,"div",51),ee(1,"i",52),f(2,"input",53),L("input",function(r){return z(e),A(2).applyFilterCategories(r,"contains")}),p()()}}function zue(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function $ue(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,zue,2,0,"th",25),f(4,"th"),_(5,"Name"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Wue(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A(3);v(1),U(e.contractor.id)}}function que(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Wue,2,1,"td",25),f(4,"td"),_(5),p(),f(6,"td")(7,"button",55),L("click",function(){const o=z(e).$implicit;return A(2).updateCategory(o)}),p(),_(8," \xa0"),f(9,"button",56),L("click",function(){const o=z(e).$implicit;return A(2).deleteCategory(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.name)}}function Gue(t,i){1&t&&(f(0,"div",57),_(1,"No data found"),p())}function Kue(t,i){if(1&t){const e=Ie();f(0,"form",8)(1,"div",10)(2,"div",33)(3,"label",12),_(4,"Name"),p(),f(5,"div",13)(6,"input",34),L("ngModelChange",function(r){return z(e),A().category.name=r}),p()(),D(7,Uue,2,0,"small",21),p()()(),f(8,"div",42)(9,"button",43),L("click",function(){z(e);const r=A();return r.saveCategory(r.categoryForm)}),_(10,"Save"),p(),f(11,"button",16),L("click",function(){return z(e),A().hideCategoryDialog()}),_(12,"Cancel"),p()(),ee(13,"hr"),f(14,"p-table",44,62),D(16,Hue,3,0,"ng-template",46),D(17,$ue,8,1,"ng-template",47),D(18,que,10,3,"ng-template",48),p(),D(19,Gue,2,0,"div",49)}if(2&t){const e=A();T("formGroup",e.categoryForm),v(6),T("ngModel",e.category.name),v(1),T("ngIf",e.categoryForm.controls.name.invalid&&e.categoryForm.controls.name.dirty),v(2),T("disabled",e.categoryForm.invalid),v(5),T("value",e.categories)("paginator",!0)("rows",10)("globalFilterFields",rt(9,t9)),v(5),T("ngIf",e.isCategoryEmpty())}}const Yue=function(){return{width:"45vw"}},mM=function(){return{width:"60vw"}};let Xue=(()=>{class t{constructor(e,n,r,o,c,u,m){this._conts=e,this._ss=n,this._ps=r,this._cs=o,this._ms=c,this._confirm=u,this.dialogService=m,this.displayAddModal=!1,this.projectID=0,this.clickClose=new Et,this.clickAdd=new Et,this.projects=[],this.categories=[],this.services=[],this.serviceDialog=!1,this.service={id:"",name:""},this.serviceForm=new Zn({id:new Me(""),name:new Me("",jt.required)})}ngOnInit(){this.projectCostForm=new Zn({project:new Me(""),description:new Me(""),category:new Me(""),contractor:new Me(""),amount:new Me("",jt.required),paymentdate:new Me("",jt.required),remarks:new Me("")}),this.contractorForm=new Zn({id:new Me(""),name:new Me("",jt.required),mobile:new Me(""),service:new Me("",jt.required)}),this.categoryForm=new Zn({id:new Me(""),name:new Me("",jt.required)}),this.contractor={id:"",name:"",mobile:"",service:""},this.category={id:"",name:""},this.getCategories(),this.getContractors(),this.getServices()}getCategories(){this._cs.getCategories().subscribe(e=>{this.categories=e},e=>{console.log(e)})}getContractors(){this._conts.getContractors().subscribe(e=>{this.contractors=e},e=>{console.log(e)})}showCategoryDialog(){this.categoryDialog=!0}showContractorDialog(){this.contractor={id:"",name:"",mobile:"",service:""},this.selectedContractorService=null,this.contractorForm.reset(),this.contractorDialog=!0}applyFilterContractors(e,n){this.dtcontractors.filterGlobal(e.target.value,n)}isContractorEmpty(){return 0===this.contractors.length}deleteContractor(e){this._confirm.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._conts.deleteContractor(e.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Contractor is deleted successfully.",life:3e3}),this.getContractors()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:n.error.message,life:3e3})}})}})}updateContractor(e){this.contractor=Object.assign({},e);const n=this.services.find(r=>r.name===e.service);this.selectedContractorService=n?n.id:null,this.contractorForm.patchValue({service:this.selectedContractorService||""})}hideContractorDialog(){this.contractorDialog=!1,this.selectedContractorService=null,this.getContractors()}onServiceChange(e){var n;const r=null===(n=this.contractorForm.get("service"))||void 0===n?void 0:n.value;this.selectedContractorService=r;const o=this.services.find(c=>c.id===r);this.contractor.service=o?o.name:""}saveContractor(e){const n=this.services.find(o=>o.id===this.selectedContractorService),r=n?n.name:"";this.contractor.id?this._conts.updateContractor(this.contractor.id,this.contractor.name,this.contractor.mobile,r).subscribe({next:o=>{this._ms.add({severity:"success",summary:"Successful",detail:"Contractor is updated successfully.",life:3e3}),this.contractorForm.reset(),this.contractor={},this.getContractors()},error:o=>{this._ms.add(409==o.status?{severity:"error",summary:"Error",detail:o.error.message,life:3e3}:{severity:"error",summary:"Error",detail:"Error occurred while updating contractor.",life:3e3})}}):this._conts.addContractor(e.value.name,e.value.mobile,r).subscribe({next:o=>{this._ms.add({severity:"success",summary:"Successful",detail:"Contractor is saved successfully.",life:3e3}),this.contractorForm.reset(),this.getContractors()},error:o=>{this._ms.add(409==o.status?{severity:"error",summary:"Error",detail:o.error.message,life:3e3}:{severity:"error",summary:"Error",detail:"Error occurred while saving contractor.",life:3e3})}})}isCategoryEmpty(){return 0===this.categories.length}deleteCategory(e){this._confirm.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._cs.deleteCategory(e.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Category is deleted successfully.",life:3e3}),this.getCategories()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:n.error.message,life:3e3})}})}})}updateCategory(e){this.category=Object.assign({},e)}hideCategoryDialog(){this.categoryDialog=!1}saveCategory(e){this.category.id?this._cs.updateCategory(this.category.id,this.category.name).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Category is updated successfully.",life:3e3}),this.categoryForm.reset(),this.category={},this.getCategories()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message,life:3e3}:{severity:"error",summary:"Error",detail:"Error occurred while updating category.",life:3e3})}}):this._cs.addCategory(e.value.name).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Category is saved successfully.",life:3e3}),this.categoryForm.reset(),this.getCategories()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message,life:3e3}:{severity:"error",summary:"Error",detail:"Error occurred while adding category.",life:3e3})}})}applyFilterCategories(e,n){this.dtcategories.filterGlobal(e.target.value,n)}getServices(){this._ss.getServices().subscribe({next:e=>{console.log("Services loaded:",e),this.services=e||[]},error:e=>{console.error("Error loading services:",e),this.services=[]}})}showServiceDialog(){this.service={id:"",name:""},this.serviceForm.reset(),this.serviceDialog=!0}hideServiceDialog(){this.serviceDialog=!1,this.getServices()}saveService(){this.serviceForm.valid&&(this.service.id?this._ss.updateService(this.service.id.toString(),this.service.name).subscribe({next:e=>{this._ms.add({severity:"success",summary:"Successful",detail:"Service updated successfully.",life:3e3}),this.serviceForm.reset(),this.service={id:"",name:""},this.getServices()},error:e=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while updating service.",life:3e3})}}):this._ss.addService(this.service.name).subscribe({next:e=>{this._ms.add({severity:"success",summary:"Successful",detail:"Service saved successfully.",life:3e3}),this.serviceForm.reset(),this.getServices(),setTimeout(()=>{const n=this.services.find(r=>r.name===this.service.name);n&&(this.selectedContractorService=n.id,this.contractor.service=n.name)},100)},error:e=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while saving service.",life:3e3})}}))}updateService(e){this.service=Object.assign({},e)}deleteService(e){this._confirm.confirm({message:"Are you sure you want to delete this service?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._ss.deleteService(e.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Service deleted successfully.",life:3e3}),this.getServices()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting service.",life:3e3})}})}})}applyFilterServices(e,n){this.dtservices.filterGlobal(e.target.value,n)}isServiceEmpty(){return 0===this.services.length}closeModal(){this.clickClose.emit(!0)}addProjectCost(e){this.projcost.id?(e.value.id=this.projcost.id,this._ps.updateProjectCost(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Project cost updated successfully."}),this.clickAdd.emit(n),this.closeModal()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while updating project cost."})}})):(e.value.project=this.projectID,console.log(e),this._ps.addProjectCost(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Project cost added successfully."}),this.clickAdd.emit(n),this.projectCostForm.reset()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while saving project cost."})}}))}}return t.\u0275fac=function(e){return new(e||t)(te(hM),te(aue),te(ll),te(Q7),te(kn),te(Un),te(Is))},t.\u0275cmp=dn({type:t,selectors:[["app-add-edit-dialog"]],viewQuery:function(e,n){if(1&e&&(Mt(lue,5),Mt(cue,5),Mt(uue,5)),2&e){let r;xt(r=wt())&&(n.dtcontractors=r.first),xt(r=wt())&&(n.dtcategories=r.first),xt(r=wt())&&(n.dtservices=r.first)}},inputs:{displayAddModal:"displayAddModal",projectID:"projectID",projcost:"projcost",obj_paymentdate:"obj_paymentdate",selectedCategory:"selectedCategory",selectedContractor:"selectedContractor"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd"},decls:10,vars:26,consts:[["header","Add Project Cost",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[3,"formGroup",4,"ngIf"],["pTemplate","footer"],["header","Manage Contractors",3,"visible","modal","visibleChange"],["pTemplate","content"],["header","Manage Services",3,"visible","modal","draggable","resizable","visibleChange"],["header","Manage Categories",3,"visible","modal","visibleChange"],["position","bottom-right"],[3,"formGroup"],[1,"p-fluid","formgrid"],[1,"row"],[1,"field","col-12","col-md-6"],["for","name"],[2,"display","flex","align-items","center"],["id","contractor","name","contractor","optionLabel","name","optionValue","id","filterBy","name","placeholder","Select a Contractor","formControlName","contractor","autoWidth","false",3,"options","filter","ngModel","showClear","appendTo","ngModelChange"],["class","custom-dropdown"],["type","button",1,"btn-project",3,"click"],["for","title"],["id","category","name","category","optionLabel","name","optionValue","id","filterBy","name","placeholder","Select a Category","formControlName","category","autoWidth","false",3,"options","filter","showClear","ngModel","appendTo","ngModelChange"],["dropdown",""],["appendTo","body","id","paymentdate","name","paymentdate","formControlName","paymentdate","dateFormat","dd-mm-yy",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],["pInputText","","type","text","id","description","name","description","formControlName","description",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","amount","name","amount","formControlName","amount",3,"ngModel","ngModelChange"],["pInputText","","type","text","id","remarks","name","remarks","formControlName","remarks",3,"ngModel","ngModelChange"],[4,"ngIf"],[1,"flex","align-items-center","gap-2"],[1,"p-error","block"],[2,"display","flex","justify-content","center"],["icon","pi pi-check","type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["icon","pi pi-times","type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-circle"],[1,"field","col-4","col-md-4"],["pInputText","","type","text","id","name","name","name","formControlName","name",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","mobile","name","mobile","formControlName","mobile",3,"ngModel","ngModelChange"],["for","service"],[2,"display","flex","align-items","center","gap","5px"],["id","service","name","service","optionLabel","name","optionValue","id","filterBy","name","placeholder","Select a Service","formControlName","service","appendTo","body",3,"options","filter","showClear","onChange"],["type","button","title","Add New Service",1,"btn-project","btn-project-icon",3,"click"],[1,"bi","bi-plus-lg"],["class","text-muted","style","font-size: 0.85rem; display: block; margin-top: 5px;",4,"ngIf"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["type","button",1,"btn-project",3,"disabled","click"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dtcontractors",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],[1,"text-muted",2,"font-size","0.85rem","display","block","margin-top","5px"],[2,"text-align","right"],[1,"fas","fa-search",2,"margin","4px 4px 0 0"],["type","text","pInputText","","size","50","placeholder","Global Filter",2,"width","auto",3,"input"],[1,"p-d-flex","p-jc-between","p-ai-center"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"],[1,"field","col-12","col-md-12"],[1,"bi","bi-check-lg"],[1,"bi","bi-x-lg"],["dtservices",""],["dtcategories",""]],template:function(e,n){1&e&&(f(0,"p-dialog",0),L("visibleChange",function(o){return n.displayAddModal=o})("onHide",function(){return n.closeModal()}),D(1,yue,42,23,"form",1),D(2,bue,8,1,"ng-template",2),p(),f(3,"p-dialog",3),L("visibleChange",function(o){return n.contractorDialog=o}),D(4,Fue,34,19,"ng-template",4),p(),f(5,"p-dialog",5),L("visibleChange",function(o){return n.serviceDialog=o}),D(6,Vue,22,10,"ng-template",4),p(),f(7,"p-dialog",6),L("visibleChange",function(o){return n.categoryDialog=o}),D(8,Kue,20,10,"ng-template",4),p(),ee(9,"p-toast",7)),2&e&&(Ft(rt(22,Yue)),T("visible",n.displayAddModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("ngIf",void 0!==n.projcost),v(2),Ft(rt(23,mM)),T("visible",n.contractorDialog)("modal",!0),v(2),Ft(rt(24,mM)),T("visible",n.serviceDialog)("modal",!0)("draggable",!1)("resizable",!1),v(2),Ft(rt(25,mM)),T("visible",n.categoryDialog)("modal",!0))},directives:[ms,Sn,Hr,Ur,Pr,us,Er,zr,oc,Ir,li,qo,zn,ki,_r,fr],styles:[".custom-dropdown[_ngcontent-%COMP%]{width:220px;height:60px;margin-right:10px}.dropdown-container[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center}.treetableDate[_ngcontent-%COMP%]   .ui-widget-content[_ngcontent-%COMP%]{width:80%}"]}),t})();const Que=["dt"];function Jue(t,i){if(1&t){const e=Ie();f(0,"div",8)(1,"span",9),ee(2,"i",10),f(3,"input",11),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function Zue(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),f(3,"th"),_(4," Description"),p(),f(5,"th"),_(6," Cost"),p()())}function ede(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2),p(),f(3,"td"),_(4),p(),f(5,"td"),_(6),Ne(7,"currency"),p()()),2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(2),U(e.name),v(2),U(He(7,3,e.totalcost," ","symbol","1.0-0"))}}function tde(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td")(2,"td"),f(3,"td"),_(4),Ne(5,"currency"),p(),f(6,"td")(7,"button",12),L("click",function(){return z(e),A().exportTableToExcel()}),_(8,"Excel"),p(),f(9,"button",13),L("click",function(){return z(e),A().exportTableToPdf()}),_(10,"Pdf"),p()()()}if(2&t){const e=A();v(4),hn("Total: ",He(5,1,e.totalcost," ","symbol","1.0-0"),"")}}function nde(t,i){1&t&&(f(0,"div",14),_(1,"No data found"),p())}const ide=function(){return{width:"60vw"}},rde=function(){return["name"]};let ode=(()=>{class t{constructor(e,n){this.pdfserv=e,this.exptoexcel=n,this.clickSummaryClose=new Et,this.categorysummary=[],this.displaySummaryModal=!1,this.totalcost=0,this.headerData=["Description","Cost"]}ngOnInit(){}closeModal(){this.clickSummaryClose.emit(!0)}isSummaryEmpty(){return 0===this.categorysummary.length}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],"CategorySummary_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"CategorySummary_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.categorysummary.length;n++)e.push([this.categorysummary[n].name,Number(this.categorysummary[n].totalcost).toLocaleString()]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.categorysummary.length;n++)e.push([this.categorysummary[n].name,Number(this.categorysummary[n].totalcost).toLocaleString()]);return e}toPdfFooterFormat(){let e=[];return e.push(["Total",this.totalcost.toLocaleString()]),e}toExcelFooterFormat(e){return e.push(["","",""]),e.push(["Total",this.totalcost.toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-categorysummary"]],viewQuery:function(e,n){if(1&e&&Mt(Que,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{categorysummary:"categorysummary",displaySummaryModal:"displaySummaryModal",totalcost:"totalcost"},outputs:{clickSummaryClose:"clickSummaryClose"},decls:8,vars:14,consts:[["header","Category Summary","name","costdialog",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[1,"btn-project",3,"click"],[1,"btn-project",2,"margin-left","5px",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"p-dialog",0),L("visibleChange",function(o){return n.displaySummaryModal=o})("onHide",function(){return n.closeModal()}),f(1,"p-table",1,2),D(3,Jue,4,0,"ng-template",3),D(4,Zue,7,0,"ng-template",4),D(5,ede,8,8,"ng-template",5),D(6,tde,11,6,"ng-template",6),p(),D(7,nde,2,0,"div",7),p()),2&e&&(Ft(rt(12,ide)),T("visible",n.displaySummaryModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("value",n.categorysummary)("paginator",!0)("rows",10)("globalFilterFields",rt(13,rde)),v(6),T("ngIf",n.isSummaryEmpty()))},directives:[ms,ki,zn,li,Sn],pipes:[dr],styles:[""]}),t})();const sde=["dt"];function ade(t,i){if(1&t){const e=Ie();f(0,"div",8)(1,"span",9),ee(2,"i",10),f(3,"input",11),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function lde(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),f(3,"th"),_(4," Name"),p(),f(5,"th"),_(6," Amount"),p()())}function cde(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2),p(),f(3,"td"),_(4),p(),f(5,"td"),_(6),Ne(7,"currency"),p()()),2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(2),U(e.name),v(2),U(He(7,3,e.totalcost," ","symbol","1.0-0"))}}function ude(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td")(2,"td"),f(3,"td"),_(4),Ne(5,"currency"),p(),f(6,"td")(7,"button",12),L("click",function(){return z(e),A().exportTableToExcel()}),_(8,"Excel"),p(),f(9,"button",13),L("click",function(){return z(e),A().exportTableToPdf()}),_(10,"Pdf"),p()()()}if(2&t){const e=A();v(4),hn("Total: ",He(5,1,e.totalcost," ","symbol","1.0-0"),"")}}function dde(t,i){1&t&&(f(0,"div",14),_(1,"No data found"),p())}const fde=function(){return{width:"60vw"}},pde=function(){return["name"]};let hde=(()=>{class t{constructor(e,n){this.pdfserv=e,this.exptoexcel=n,this.clickSummaryClose=new Et,this.contractorsummary=[],this.displaySummaryModal=!1,this.totalcost=0,this.headerData=["Description","Cost"]}ngOnInit(){}closeModal(){this.clickSummaryClose.emit(!0)}isSummaryEmpty(){return 0===this.contractorsummary.length}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],"ContractorSummary_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"ContractorSummary_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.contractorsummary.length;n++)e.push([this.contractorsummary[n].name,Number(this.contractorsummary[n].totalcost).toLocaleString()]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.contractorsummary.length;n++)e.push([this.contractorsummary[n].name,Number(this.contractorsummary[n].totalcost).toLocaleString()]);return e}toPdfFooterFormat(){let e=[];return e.push(["Total",this.totalcost.toLocaleString()]),e}toExcelFooterFormat(e){return e.push(["","",""]),e.push(["Total",this.totalcost.toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-contractorsummary"]],viewQuery:function(e,n){if(1&e&&Mt(sde,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{contractorsummary:"contractorsummary",displaySummaryModal:"displaySummaryModal",totalcost:"totalcost"},outputs:{clickSummaryClose:"clickSummaryClose"},decls:8,vars:14,consts:[["header","Contractor Summary","name","costdialog",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[1,"btn-project",3,"click"],[1,"btn-project",2,"margin-left","5px",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"p-dialog",0),L("visibleChange",function(o){return n.displaySummaryModal=o})("onHide",function(){return n.closeModal()}),f(1,"p-table",1,2),D(3,ade,4,0,"ng-template",3),D(4,lde,7,0,"ng-template",4),D(5,cde,8,8,"ng-template",5),D(6,ude,11,6,"ng-template",6),p(),D(7,dde,2,0,"div",7),p()),2&e&&(Ft(rt(12,fde)),T("visible",n.displaySummaryModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("value",n.contractorsummary)("paginator",!0)("rows",10)("globalFilterFields",rt(13,pde)),v(6),T("ngIf",n.isSummaryEmpty()))},directives:[ms,ki,zn,li,Sn],pipes:[dr],styles:[""]}),t})();const mde=["dt"],gde=["dtcontractors"];function _de(t,i){if(1&t){const e=Ie();f(0,"div",32)(1,"span",33),ee(2,"i",34),f(3,"input",35),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function vde(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function yde(t,i){1&t&&(f(0,"th")(1,"div",38),_(2," CategoryID "),p()())}function bde(t,i){1&t&&(f(0,"th")(1,"div",38),_(2," ContractorID "),p()())}function xde(t,i){1&t&&(f(0,"tr",36)(1,"th"),_(2,"Sr#"),p(),D(3,vde,2,0,"th",37),f(4,"th")(5,"div",38),_(6," Payment Date "),p()(),f(7,"th")(8,"div",38),_(9," Description "),p()(),D(10,yde,3,0,"th",37),f(11,"th")(12,"div",38),_(13," Category "),p()(),D(14,bde,3,0,"th",37),f(15,"th")(16,"div",38),_(17," Contractor "),p()(),f(18,"th")(19,"div",38),_(20," Amount "),p()(),f(21,"th")(22,"div",38),_(23,"Remarks"),p()(),f(24,"th")(25,"div",38),_(26," Action "),p()()()),2&t&&(v(3),T("ngIf",!1),v(7),T("ngIf",!1),v(4),T("ngIf",!1))}function wde(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Cde(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.categoryid)}}function Tde(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.contractorid)}}function Sde(t,i){if(1&t){const e=Ie();f(0,"tr",36)(1,"td"),_(2),p(),D(3,wde,2,1,"td",37),f(4,"td"),_(5),Ne(6,"date"),p(),f(7,"td"),_(8),p(),D(9,Cde,2,1,"td",37),f(10,"td"),_(11),p(),D(12,Tde,2,1,"td",37),f(13,"td"),_(14),p(),f(15,"td"),_(16),Ne(17,"currency"),p(),f(18,"td"),_(19),p(),f(20,"td")(21,"div",39)(22,"button",40),L("click",function(){const o=z(e).$implicit;return A().updateProjectCost(o)}),p(),f(23,"button",41),L("click",function(){const o=z(e).$implicit;return A().deleteProjectCost(o)}),p()()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(Oa(6,10,e.paymentdate,"dd-MM-yyyy")),v(3),U(e.description),v(1),T("ngIf",!1),v(2),U(e.category),v(1),T("ngIf",!1),v(2),U(e.contractor),v(2),U(He(17,13,e.amount," ","symbol","1.0-0")),v(3),U(e.remarks)}}function Ede(t,i){if(1&t&&(f(0,"tr"),ee(1,"td")(2,"td")(3,"td")(4,"td"),f(5,"td"),_(6,"Total:"),p(),f(7,"td"),_(8),Ne(9,"currency"),p(),ee(10,"td")(11,"td"),p()),2&t){const e=A();v(8),U(He(9,1,e.total_projectcost," ","symbol","1.0-0"))}}function kde(t,i){1&t&&(f(0,"div",42),_(1,"No data found"),p())}const Dde=function(){return["description","contractor","category"]},Ide=function(){return{width:"450px"}};let n9=(()=>{class t{constructor(e,n,r,o,c,u,m,g,x){this._ps=e,this.dialogService=n,this._cs=r,this._contservice=o,this.router=c,this.messageService=u,this.confirmationService=m,this.pdfserv=g,this.exptoexcel=x,this.displayDialog=!1,this.projectcost=[],this.displayAddModal=!1,this._budget=0,this._spent=0,this._cpca=0,this._remaining=0,this._landcost="",this._commission="",this._taxes="",this.displayCategorySummaryDialog=!1,this.displayCategorySummaryModal=!1,this.categorysummary=[],this.displayContractorSummaryDialog=!1,this.displayContractorSummaryModal=!1,this.contractorsummary=[],this.totalcost=0,this.total_projectcost=0,this.headerData=["Payment Date","Description","Category","Contractor","Amount","Remarks"]}parseAsNumber(e){return parseFloat(e)||0}ngOnInit(){}importData(){this.router.navigate(["/excelimport"])}getProjectCost(){this.total_projectcost=0,this._ps.getProjectCost(this.projectID.toString()).subscribe({next:e=>{this.projectcost=e,this._landcost="",this._commission="",this._taxes="",this._budget=0,this._spent=0,this._cpca=0,this._remaining=0,e.forEach(n=>{this._landcost=n.landcost,this._commission=n.commission,this._taxes=n.taxes;const r=(Number(this._landcost)+Number(this._commission)+Number(this._taxes)).toString();this.total_projectcost=this.total_projectcost+Number(n.amount),this._budget=n.budget+Number(r),this._cpca=n.coveredarea,this._spent=Number(n.totalcost)+Number(r)}),this._remaining=Number(this._budget)-Number(this._spent),this._cpca=this.total_projectcost/this._cpca},error:e=>{console.error(e)}})}fetchProjectCost(e){null!=e.value&&(this.total_projectcost=0,this._ps.getProjectCost(e.value.id).subscribe({next:n=>{this.projectcost=n,n.forEach(r=>{this._landcost=r.landcost,this._commission=r.commission,this._taxes=r.taxes,this._cpca=r.coveredarea;const o=(Number(this._landcost)+Number(this._commission)+Number(this._taxes)).toString();this.total_projectcost=this.total_projectcost+Number(r.amount),this._budget=r.budget+Number(o),this._spent=Number(r.totalcost)+Number(o)}),this._remaining=Number(this._budget)-Number(this._spent),this._cpca=this.total_projectcost/this._cpca},error:n=>{console.error(n)}}))}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}isProjectsEmpty(){return 0===this.projectcost.length}showAddCostDialog(){this.projcost={id:"",paymentdate:"",description:"",categoryid:"",category:"",contractorid:"",contractor:"",amount:"",remarks:""},this.selectedContractor="",this.selectedCategory="",this.obj_paymentdate="",this.displayAddModal=!0}hideAddModal(e){this.displayAddModal=!e}updateProjectCostList(e){this.total_projectcost=0,this._ps.getProjectCost(this.projectID.toString()).subscribe({next:n=>{this.projectcost=n,n.forEach(r=>{this._landcost=r.landcost,this._commission=r.commission,this._taxes=r.taxes,this._cpca=r.coveredarea;const o=(Number(this._landcost)+Number(this._commission)+Number(this._taxes)).toString();this.total_projectcost=this.total_projectcost+Number(r.amount),this._budget=r.budget+Number(o),this._spent=Number(r.totalcost)+Number(o)}),this._remaining=Number(this._budget)-Number(this._spent),this._cpca=this.total_projectcost/this._cpca},error:n=>{console.error(n)}})}updateProjectCost(e){this.projcost=Object.assign({},e),this.obj_paymentdate=new Date(this.projcost.paymentdate),this.selectedContractor=this.projcost.contractorid,this.selectedCategory=this.projcost.categoryid,this.displayAddModal=!0}deleteProjectCost(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._ps.deleteProjectCost(e.id).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Project cost deleted successfully.",life:3e3}),this.getProjectCost()},error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error occurred while deleting project cost.",life:3e3})}})}})}showContractorSummary(){this._contservice.summarizeContractor(this.projectID).subscribe({next:e=>{this.totalcost=0,e.forEach(n=>{this.totalcost=Number(this.totalcost)+Number(n.totalcost)}),this.contractorsummary=e},error:e=>{console.error(e)}}),this.displayContractorSummaryModal=!0}showCategorySummary(){this._cs.summarizeCategory(this.projectID).subscribe({next:e=>{this.totalcost=0,e.forEach(n=>{this.totalcost=Number(this.totalcost)+Number(n.totalcost)}),this.categorysummary=e},error:e=>{console.error(e)}}),this.displayCategorySummaryModal=!0}hideCategorySummaryModal(e){this.displayCategorySummaryModal=!e}hideContractorSummaryModal(e){this.displayContractorSummaryModal=!e}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],"Projects_Cost"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"Projects_Cost_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.projectcost.length;n++)e.push([Qr(this.projectcost[n].paymentdate),this.projectcost[n].description,this.projectcost[n].category,this.projectcost[n].contractor,this.projectcost[n].amount.toLocaleString(),this.projectcost[n].remarks]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.projectcost.length;n++)e.push([Qr(this.projectcost[n].paymentdate),this.projectcost[n].description,this.projectcost[n].category,this.projectcost[n].contractor,this.projectcost[n].amount.toLocaleString(),this.projectcost[n].remarks]);return e}toPdfFooterFormat(){let e=[];return e.push(["","","","Total",this.total_projectcost.toLocaleString()]),e}toExcelFooterFormat(e){return e.push(["","","","","",""]),e.push(["","","","Total",this.total_projectcost.toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(ll),te(Is),te(Q7),te(hM),te(zs),te(kn),te(Un),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-addcost"]],viewQuery:function(e,n){if(1&e&&(Mt(mde,5),Mt(gde,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.dtcontractors=r.first)}},inputs:{projectcost:"projectcost",projectID:"projectID",_budget:"_budget",_spent:"_spent",_cpca:"_cpca",_remaining:"_remaining",_landcost:"_landcost",_commission:"_commission",_taxes:"_taxes",total_projectcost:"total_projectcost"},features:[Nn([Is,kn,Un])],decls:85,vars:67,consts:[[1,"project-btn-group","project-btn-group--spaced"],[1,"btn-project",3,"click"],[1,"bi","bi-plus-lg"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],[1,"project-btn-group","project-btn-group--right","project-btn-group--spaced"],[1,"btn-project","btn-sm",3,"click"],[2,"width","600px",3,"displayAddModal","projectID","projcost","selectedContractor","selectedCategory","obj_paymentdate","clickClose","clickAdd"],[1,"project-cost-summary"],[1,"summary-card"],[1,"card-header"],[1,"card-icon","cost-icon"],[1,"bi","bi-cash-coin"],[1,"card-title"],[1,"card-body"],[1,"grid-3"],[1,"item"],[1,"label"],[1,"value"],[1,"card-icon","budget-icon"],[1,"bi","bi-wallet2"],[1,"value","negative"],[1,"grid-1"],[1,"value","highlight"],[2,"width","600px",3,"displaySummaryModal","totalcost","categorysummary","clickSummaryClose"],[2,"width","600px",3,"displaySummaryModal","totalcost","contractorsummary","clickSummaryClose"],["position","bottom-right"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[2,"font-size","medium"],[4,"ngIf"],[1,"p-d-flex","p-jc-between","p-ai-center"],[1,"actions-inline"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"div",0)(1,"button",1),L("click",function(){return n.showAddCostDialog()}),ee(2,"i",2),_(3,"Add New"),p(),f(4,"button",1),L("click",function(){return n.showCategorySummary()}),_(5,"Category Summary"),p(),f(6,"button",1),L("click",function(){return n.showContractorSummary()}),_(7,"Contractor Summary"),p()(),f(8,"p-table",3,4),D(10,_de,4,0,"ng-template",5),D(11,xde,27,3,"ng-template",6),D(12,Sde,24,18,"ng-template",7),D(13,Ede,12,6,"ng-template",8),p(),D(14,kde,2,0,"div",9),f(15,"div",10)(16,"button",11),L("click",function(){return n.exportTableToExcel()}),_(17,"Excel"),p(),f(18,"button",11),L("click",function(){return n.exportTableToPdf()}),_(19,"Pdf"),p()(),ee(20,"p-confirmDialog"),f(21,"app-add-edit-dialog",12),L("clickClose",function(o){return n.hideAddModal(o)})("clickAdd",function(o){return n.updateProjectCostList(o)}),p(),f(22,"div",13)(23,"div",14)(24,"div",15)(25,"div",16),ee(26,"i",17),p(),f(27,"h3",18),_(28,"Project Fixed Costs"),p()(),f(29,"div",19)(30,"div",20)(31,"div",21)(32,"span",22),_(33,"Land Cost"),p(),f(34,"span",23),_(35),Ne(36,"currency"),p()(),f(37,"div",21)(38,"span",22),_(39,"Taxes"),p(),f(40,"span",23),_(41),Ne(42,"currency"),p()(),f(43,"div",21)(44,"span",22),_(45,"Commission"),p(),f(46,"span",23),_(47),Ne(48,"currency"),p()()()()(),f(49,"div",14)(50,"div",15)(51,"div",24),ee(52,"i",25),p(),f(53,"h3",18),_(54,"Budget Overview"),p()(),f(55,"div",19)(56,"div",20)(57,"div",21)(58,"span",22),_(59,"Total Budget"),p(),f(60,"span",23),_(61),Ne(62,"currency"),p()(),f(63,"div",21)(64,"span",22),_(65,"Spent"),p(),f(66,"span",26),_(67),Ne(68,"currency"),p()(),f(69,"div",21)(70,"span",22),_(71,"Remaining"),p(),f(72,"span",23),_(73),Ne(74,"currency"),p()()(),f(75,"div",27)(76,"div",21)(77,"span",22),_(78,"Cost Per Covered Area"),p(),f(79,"span",28),_(80),Ne(81,"currency"),p()()()()()(),f(82,"app-categorysummary",29),L("clickSummaryClose",function(o){return n.hideCategorySummaryModal(o)}),p(),f(83,"app-contractorsummary",30),L("clickSummaryClose",function(o){return n.hideContractorSummaryModal(o)}),p(),ee(84,"p-toast",31)),2&e&&(v(8),T("value",n.projectcost)("paginator",!0)("rows",10)("globalFilterFields",rt(65,Dde)),v(6),T("ngIf",n.isProjectsEmpty()),v(6),Ft(rt(66,Ide)),v(1),T("displayAddModal",n.displayAddModal)("projectID",n.projectID)("projcost",n.projcost)("selectedContractor",n.selectedContractor)("selectedCategory",n.selectedCategory)("obj_paymentdate",n.obj_paymentdate),v(14),U(He(36,30,n.parseAsNumber(n._landcost)," ","symbol","1.0-0")),v(6),U(He(42,35,n.parseAsNumber(n._taxes)," ","symbol","1.0-0")),v(6),U(He(48,40,n.parseAsNumber(n._commission)," ","symbol","1.0-0")),v(14),U(He(62,45,n._budget," ","symbol","1.0-0")),v(6),U(He(68,50,n._spent," ","symbol","1.0-0")),v(5),po("positive",n._remaining>=0)("negative",n._remaining<0),v(1),U(He(74,55,n._remaining," ","symbol","1.0-0")),v(7),U(He(81,60,n._cpca," ","symbol","1.0-0")),v(2),T("displaySummaryModal",n.displayCategorySummaryModal)("totalcost",n.totalcost)("categorysummary",n.categorysummary),v(1),T("displaySummaryModal",n.displayContractorSummaryModal)("totalcost",n.totalcost)("contractorsummary",n.contractorsummary))},directives:[ki,zn,li,Sn,_r,mo,Xue,ode,hde,fr],pipes:[al,dr],styles:[".export-section[_ngcontent-%COMP%]{text-align:right;margin-top:10px}.project-cost-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;margin-top:15px}.summary-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;box-shadow:0 4px 20px #00000014}.card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding-bottom:12px;border-bottom:2px solid #f0f0f0;margin-bottom:15px}.card-icon[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.2rem;box-shadow:0 4px 15px #00000026}.cost-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%)}.budget-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#30cfd0 0%,#330867 100%)}.card-title[_ngcontent-%COMP%]{font-size:1.15rem;font-weight:600;color:#2d3748;margin:0}.grid-3[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));grid-gap:16px;gap:16px}.grid-1[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;margin-top:12px}.item[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:10px;padding:14px}.label[_ngcontent-%COMP%]{display:block;font-size:.82rem;color:#718096;font-weight:500;text-transform:uppercase;letter-spacing:.4px;margin-bottom:6px}.value[_ngcontent-%COMP%]{font-size:1.05rem;font-weight:600;color:#2d3748}.value.highlight[_ngcontent-%COMP%]{color:#667eea}.value.positive[_ngcontent-%COMP%]{color:#38a169}.value.negative[_ngcontent-%COMP%]{color:#e53e3e}@media (max-width: 768px){.summary-card[_ngcontent-%COMP%]{padding:16px}.card-icon[_ngcontent-%COMP%]{width:40px;height:40px;font-size:1rem}}.actions-inline[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px}"]}),t})();function Ade(t,i){1&t&&(f(0,"small",22),_(1," Selling Price is required. "),p())}function Mde(t,i){1&t&&(f(0,"small",22),_(1," Selling Date is required. "),p())}function Fde(t,i){}function Pde(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Ode(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Pde,2,0,"th",23),f(4,"th"),_(5,"Selling Date"),p(),f(6,"th"),_(7,"Selling Price"),p(),f(8,"th"),_(9,"Taxes"),p(),f(10,"th"),_(11,"Commission"),p(),f(12,"th"),_(13,"Total Price"),p(),f(14,"th"),_(15,"Total Cost"),p(),f(16,"th"),_(17,"Net Profit"),p(),f(18,"th"),_(19,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Nde(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Lde(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Nde,2,1,"td",23),f(4,"td"),_(5),Ne(6,"date"),p(),f(7,"td"),_(8),Ne(9,"currency"),p(),f(10,"td"),_(11),Ne(12,"currency"),p(),f(13,"td"),_(14),Ne(15,"currency"),p(),f(16,"td"),_(17),Ne(18,"currency"),p(),f(19,"td"),_(20),Ne(21,"currency"),p(),f(22,"td"),_(23),Ne(24,"currency"),p(),f(25,"td")(26,"button",24),L("click",function(){const o=z(e).$implicit;return A().updateProjectSale(o)}),p(),_(27," \xa0"),f(28,"button",25),L("click",function(){const o=z(e).$implicit;return A().deleteProjectSale(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(Oa(6,9,e.sellingdate,"dd-MM-yyyy")),v(3),U(He(9,12,e.sellingprice," ","symbol","1.0-0")),v(3),U(He(12,17,e.taxes," ","symbol","1.0-0")),v(3),U(He(15,22,e.commission," ","symbol","1.0-0")),v(3),U(He(18,27,e.totalprice," ","symbol","1.0-0")),v(3),U(He(21,32,e.totalcost," ","symbol","1.0-0")),v(3),U(He(24,37,e.netprofit," ","symbol","1.0-0"))}}function Rde(t,i){1&t&&(f(0,"div",26),_(1,"No data found"),p())}const Bde=function(){return{width:"450px"}};let r9=(()=>{class t{constructor(e,n,r){this._ms=e,this._ps=n,this.confirmationService=r,this.salecost=[],this.projectID=0}ngOnInit(){this.projectSale={id:"",sellingdate:"",sellingprice:"",taxes:"",commission:"",totalprice:"",totalcost:"",netprofit:""},this.projectSaleForm=new Zn({id:new Me(""),project:new Me(""),sellingdate:new Me("",jt.required),sellingprice:new Me("",jt.required),taxes:new Me(""),commission:new Me("")})}getProjectSale(){this._ps.getProjectsSale(this.projectID.toString()).subscribe({next:e=>{this.salecost=e},error:e=>{console.error(e)}})}isProjectsEmpty(){return 0===this.salecost.length}addProjectSale(e){this.projectSale.id?(this.projectSaleForm.value.id=this.projectSale.id,this.projectSaleForm.value.project=this.projectID,this._ps.updateProjectSale(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Project sale is updated successfully.",life:3e3}),this.projectSaleForm.reset(),this.getProjectSale()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while updating project sale.",life:3e3})}})):(this.projectSaleForm.value.project=this.projectID,this._ps.addProjectSale(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Project sale cost recorded successfully."}),this.projectSaleForm.reset(),this.getProjectSale()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while recording project sale cost."})}}))}updateProjectSale(e){this.projectSale.id=e.id.toString(),this.projectSale.sellingdate=e.sellingdate,this.obj_sellingdate=new Date(this.projectSale.sellingdate),this.projectSale.sellingprice=e.sellingprice,this.projectSale.taxes=e.taxes,this.projectSale.commission=e.commission}deleteProjectSale(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._ps.deleteProjectSale(e.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Project sale entry deleted successfully.",life:3e3}),this.getProjectSale()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting project sale.",life:3e3})}})}})}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(ll),te(Un))},t.\u0275cmp=dn({type:t,selectors:[["app-addprojectsales"]],inputs:{salecost:"salecost",projectID:"projectID"},features:[Nn([Is,kn,Un])],decls:39,vars:16,consts:[[3,"formGroup"],[1,"row"],[1,"field","col-3","col-md-3"],["for","name"],[2,"display","flex","align-items","center"],["pInputText","","type","number","id","sellingprice","name","sellingprice","formControlName","sellingprice",1,"form-control",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],["pInputText","","type","number","id","taxes","name","taxes","formControlName","taxes",1,"form-control",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","commission","name","commission","formControlName","commission",1,"form-control",3,"ngModel","ngModelChange"],["id","sellingdate","name","sellingdate","formControlName","sellingdate","classs","form-control","dateFormat","dd-mm-yy",3,"ngModel","appendTo","ngModelChange"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-circle"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],["position","bottom-right"],[1,"p-error","block"],[4,"ngIf"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),_(4,"Price"),p(),f(5,"div",4)(6,"input",5),L("ngModelChange",function(o){return n.projectSale.sellingprice=o}),p()(),D(7,Ade,2,0,"small",6),p(),f(8,"div",2)(9,"label",3),_(10,"Taxes"),p(),f(11,"div",4)(12,"input",7),L("ngModelChange",function(o){return n.projectSale.taxes=o}),p()()(),f(13,"div",2)(14,"label",3),_(15,"Commission"),p(),f(16,"div",4)(17,"input",8),L("ngModelChange",function(o){return n.projectSale.commission=o}),p()()(),f(18,"div",2)(19,"label",3),_(20,"Selling Date"),p(),f(21,"div",4)(22,"p-calendar",9),L("ngModelChange",function(o){return n.obj_sellingdate=o}),p()(),D(23,Mde,2,0,"small",6),p()()(),f(24,"div",10)(25,"button",11),L("click",function(){return n.addProjectSale(n.projectSaleForm)}),ee(26,"i",12),_(27,"Save"),p(),f(28,"button",13),L("click",function(){return n.projectSaleForm.reset()}),ee(29,"i",14),_(30,"Clear "),p()(),f(31,"p-table",15,16),D(33,Fde,0,0,"ng-template",17),D(34,Ode,20,1,"ng-template",18),D(35,Lde,29,42,"ng-template",19),p(),D(36,Rde,2,0,"div",20),ee(37,"p-confirmDialog")(38,"p-toast",21)),2&e&&(T("formGroup",n.projectSaleForm),v(6),T("ngModel",n.projectSale.sellingprice),v(1),T("ngIf",n.projectSaleForm.controls.sellingdate.invalid&&n.projectSaleForm.controls.sellingdate.dirty),v(5),T("ngModel",n.projectSale.taxes),v(5),T("ngModel",n.projectSale.commission),v(5),T("ngModel",n.obj_sellingdate)("appendTo","body"),v(1),T("ngIf",n.projectSaleForm.controls.sellingdate.invalid&&n.projectSaleForm.controls.sellingdate.dirty),v(2),T("disabled",n.projectSaleForm.invalid),v(6),T("value",n.salecost)("paginator",!0)("rows",10),v(5),T("ngIf",n.isProjectsEmpty()),v(1),Ft(rt(15,Bde)))},directives:[Hr,Ur,Pr,qo,Ir,li,Er,zr,Sn,oc,ki,zn,_r,mo,fr],pipes:[al,dr],styles:[""]}),t})();var jde=vo(5861);function Vde(t,i){1&t&&(f(0,"small",14),_(1," Investor name is required."),p())}function Ude(t,i){1&t&&(f(0,"small",14),_(1," Mobile is required."),p())}function Hde(t,i){1&t&&(f(0,"small",14),_(1," Investment is required."),p())}function zde(t,i){if(1&t){const e=Ie();f(0,"div",15)(1,"div")(2,"button",16),L("click",function(){z(e);const r=A();return r.addInvestor(r.investorForm)}),ee(3,"i",17),_(4,"Save"),p(),f(5,"button",18),L("click",function(){return z(e),A().closeModal()}),ee(6,"i",19),_(7,"Cancel"),p()()()}if(2&t){const e=A();v(2),T("disabled",e.investorForm.invalid)}}const $de=function(){return{width:"30vw"}};let Wde=(()=>{class t{constructor(e,n,r){this.fb=e,this._is=n,this._ms=r,this.displayAddModal=!1,this.clickClose=new Et,this.clickAdd=new Et}ngOnInit(){null==this.investor&&(this.investor={id:"",name:"",mobile:"",investment:"",address:""}),this.investorForm=new Zn({name:new Me("",jt.required),mobile:new Me("",jt.required),investment:new Me("",jt.required),address:new Me("")})}closeModal(){this.investorForm.reset(),this.clickClose.emit(!0)}addInvestor(e){this.investor.id?(e.value.id=this.investor.id,this._is.updateInvestor(e).subscribe({next:n=>{(n.status=200)&&(this._ms.add({severity:"success",summary:"Success",detail:"Investor updated successfully."}),this.clickAdd.emit(n),this.closeModal())},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating investor."})}})):this._is.addInvestor(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Investor added successfully."}),this.clickAdd.emit(n),e.reset()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while saving investor data."})}})}hideAddModal(e){this.displayAddModal=!e}}return t.\u0275fac=function(e){return new(e||t)(te(pT),te(r_),te(kn))},t.\u0275cmp=dn({type:t,selectors:[["app-add-edit-investor"]],inputs:{displayAddModal:"displayAddModal",investor:"investor"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd"},decls:23,vars:16,consts:[["header","Investor Information",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[3,"formGroup"],[1,"p-fluid","grid","formgrid"],[1,"field","col-12","md:col-4"],["for","name"],["pInputText","","type","text","id","name","name","name","formControlName","name",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],["for","mobile"],["pInputText","","type","text","id","mobile","name","mobile","formControlName","mobile",3,"ngModel","ngModelChange"],["for","investment"],["pInputText","","type","number","id","investment","name","investment","formControlName","investment",3,"ngModel","ngModelChange"],["for","address"],["pInputText","","type","text","id","address","name","address","formControlName","address",3,"ngModel","ngModelChange"],["pTemplate","footer"],[1,"p-error","block"],[2,"display","flex","justify-content","center"],["icon","pi pi-check","type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["icon","pi pi-times","type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-circle"]],template:function(e,n){1&e&&(f(0,"p-dialog",0),L("visibleChange",function(o){return n.displayAddModal=o})("onHide",function(){return n.closeModal()}),f(1,"form",1)(2,"div",2)(3,"div",3)(4,"label",4),_(5,"Name"),p(),f(6,"input",5),L("ngModelChange",function(o){return n.investor.name=o}),p(),D(7,Vde,2,0,"small",6),p(),f(8,"div",3)(9,"label",7),_(10,"Mobile"),p(),f(11,"input",8),L("ngModelChange",function(o){return n.investor.mobile=o}),p(),D(12,Ude,2,0,"small",6),p(),f(13,"div",3)(14,"label",9),_(15,"Investment Amount (Rs.)"),p(),f(16,"input",10),L("ngModelChange",function(o){return n.investor.investment=o}),p(),D(17,Hde,2,0,"small",6),p(),f(18,"div",3)(19,"label",11),_(20,"Address"),p(),f(21,"input",12),L("ngModelChange",function(o){return n.investor.address=o}),p()()()(),D(22,zde,8,1,"ng-template",13),p()),2&e&&(Ft(rt(15,$de)),T("visible",n.displayAddModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("formGroup",n.investorForm),v(5),T("ngModel",n.investor.name),v(1),T("ngIf",n.investorForm.controls.name.invalid&&n.investorForm.controls.name.dirty),v(4),T("ngModel",n.investor.mobile),v(1),T("ngIf",n.investorForm.controls.mobile.invalid&&n.investorForm.controls.mobile.dirty),v(4),T("ngModel",n.investor.investment),v(1),T("ngIf",n.investorForm.controls.investment.invalid&&n.investorForm.controls.investment.dirty),v(4),T("ngModel",n.investor.address))},directives:[ms,Hr,Ur,Pr,Ir,li,Er,zr,Sn,qo,zn],styles:[""]}),t})();const qde=["dt"];function Gde(t,i){1&t&&(f(0,"small",19),_(1," Date is required. "),p())}function Kde(t,i){if(1&t){const e=Ie();f(0,"div",2)(1,"label",3),_(2,"Debit"),p(),f(3,"div",4)(4,"input",20),L("ngModelChange",function(r){return z(e),A().transaction.profit=r})("input",function(){return z(e),A().onTextBoxProfit()}),p()()()}if(2&t){const e=A();v(4),T("ngModel",e.transaction.profit)}}function Yde(t,i){1&t&&(f(0,"small",19),_(1," Transaction type is required. "),p())}function Xde(t,i){1&t&&(f(0,"small",19),_(1," Remarks is required. "),p())}function Qde(t,i){if(1&t){const e=Ie();f(0,"div",27)(1,"span",28),ee(2,"i",29),f(3,"input",30),L("input",function(r){return z(e),A(2).applyFilterGlobal(r,"contains")}),p()()()}}function Jde(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Zde(t,i){1&t&&(f(0,"th"),_(1,"Profit"),p())}function efe(t,i){1&t&&(f(0,"th"),_(1,"Status"),p())}function tfe(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Jde,2,0,"th",16),f(4,"th"),_(5,"Date"),p(),f(6,"th"),_(7,"Debit"),p(),f(8,"th"),_(9,"Credit"),p(),D(10,Zde,2,0,"th",16),D(11,efe,2,0,"th",16),f(12,"th"),_(13,"Balance"),p(),f(14,"th"),_(15,"Remarks"),p(),f(16,"th"),_(17,"Action"),p()()),2&t&&(v(3),T("ngIf",!1),v(7),T("ngIf",!1),v(1),T("ngIf",!1))}function nfe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function ife(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.totalamount," ","symbol","1.0-0"))}}function rfe(t,i){1&t&&ee(0,"td")}function ofe(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.totalamount," ","symbol","1.0-0"))}}function sfe(t,i){1&t&&ee(0,"td")}function afe(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.profit," ","symbol","1.0-0"))}}function lfe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.status)}}function cfe(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,nfe,2,1,"td",16),f(4,"td"),_(5),Ne(6,"date"),p(),D(7,ife,3,6,"td",16),D(8,rfe,1,0,"td",16),D(9,ofe,3,6,"td",16),D(10,sfe,1,0,"td",16),D(11,afe,3,6,"td",16),D(12,lfe,2,1,"td",16),f(13,"td"),_(14),Ne(15,"currency"),p(),f(16,"td"),_(17),p(),f(18,"td"),_(19," \xa0"),f(20,"button",31),L("click",function(){const r=z(e),o=r.$implicit,c=r.rowIndex;return A(2).deleteTransaction(o,c)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(Oa(6,11,e.transactiondate,"dd-MM-yyyy")),v(2),T("ngIf","DB"===e.status),v(1),T("ngIf","DB"!==e.status),v(1),T("ngIf","CR"===e.status),v(1),T("ngIf","CR"!==e.status),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(2),U(He(15,14,e.balance," ","symbol","1.0-0")),v(3),U(e.remarks)}}function ufe(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A(3);v(1),hn(" ",He(2,1,e.total_amount," ","symbol","1.0-0"),"")}}function dfe(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A(3);v(1),hn(" ",He(2,1,e.total_profit," ","symbol","1.0-0"),"")}}function ffe(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td")(2,"td")(3,"td"),D(4,ufe,3,6,"td",16),ee(5,"td"),D(6,dfe,3,6,"td",16),ee(7,"td")(8,"td"),f(9,"td")(10,"button",32),L("click",function(){return z(e),A(2).exportTableToExcel()}),_(11,"Excel"),p(),f(12,"button",33),L("click",function(){return z(e),A(2).exportTableToPdf()}),_(13,"Pdf"),p()()()}2&t&&(v(4),T("ngIf",!1),v(2),T("ngIf",!1))}const pfe=function(){return["remarks","status"]};function hfe(t,i){if(1&t&&(f(0,"div")(1,"p-table",21,22),D(3,Qde,4,0,"ng-template",23),D(4,tfe,18,3,"ng-template",24),D(5,cfe,21,19,"ng-template",25),D(6,ffe,14,2,"ng-template",26),p(),f(7,"p")(8,"b"),_(9),Ne(10,"currency"),p()()()),2&t){const e=A();v(1),T("value",e.transactions)("paginator",!0)("rows",20)("globalFilterFields",rt(10,pfe)),v(8),hn("Balance: ",He(10,5,e.transactions[e.transactions.length-1].balance," ","symbol","1.0-0"),"")}}function mfe(t,i){1&t&&(f(0,"div",34),_(1,"No data found"),p())}const gfe=function(){return{width:"240px"}},_fe=function(){return{width:"200px"}},vfe=function(){return{width:"450px"}};let yfe=(()=>{class t{constructor(e,n,r,o,c){this._ms=e,this._invtr=n,this.confirmationService=r,this.pdfserv=o,this.exptoexcel=c,this.transactions=[],this.investorname="",this.investorID=0,this.total_amount=0,this.total_profit=0,this.headerData=["Date","Debit","Credit","Balance","Remarks"],this.updateInvestorBalance=new Et,this.types=[{name:"Credit",code:"CR"},{name:"Debit",code:"DB"}]}ngOnInit(){this.transaction={id:"",totalamount:"",profit:"",remarks:"",status:""},this.transactionForm=new Zn({id:new Me(""),investor:new Me(""),totalamount:new Me(""),profit:new Me(""),status:new Me(""),remarks:new Me(""),transactiondate:new Me("",jt.required)})}getInvestorTransaction(){this.total_amount=0,this.total_profit=0,this._invtr.getInvestorTransaction(this.investorID.toString()).subscribe({next:e=>{this.total_amount=0,this.total_profit=0,this.transactions=e,e.forEach(n=>{"CR"==n.status?(this.total_amount=Number(this.total_amount)+Number(n.totalamount),this.total_profit=Number(this.total_profit)+Number(n.profit)):"DB"==n.status&&(this.total_amount=Number(this.total_amount)-Number(n.totalamount),this.total_profit=Number(this.total_profit)-Number(n.profit))})},error:e=>{console.error(e)}})}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}isTransactionEmpty(){return 0===this.transactions.length}updateTransaction(e){this.transaction=Object.assign({},e),this.obj_date=new Date(this.transaction.transactiondate)}deleteTransaction(e,n){0==n&&this.transactions.length>1?this._ms.add({severity:"error",summary:"Error",detail:"Principle amount can not be deleted.",life:3e3}):this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._invtr.deleteInvestorTransaction(e.id).subscribe({next:r=>{this._ms.add({severity:"success",summary:"Successful",detail:"Investor transaction deleted successfully.",life:3e3}),this.getInvestorTransaction(),this.transactionForm.reset(),this.updateInvestorBalance.emit()},error:r=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting investor transaction.",life:3e3})}})}})}resetForm(){this.transactionForm.reset(),this.getInvestorTransaction()}addInvestorTransaction(e){let n=this.transactionForm.get("totalamount"),r=this.transactionForm.get("profit");if(this.transaction.id){if(""==this.transactionForm.value.totalamount&&""==this.transactionForm.value.profit)return void this._ms.add({severity:"error",summary:"Error",detail:"Transaction amount missing."});if("0"==this.transactionForm.value.totalamount&&"0"==this.transactionForm.value.profit)return void this._ms.add({severity:"error",summary:"Error",detail:"Invalid transaction amoun."});this.transactionForm.value.id=this.transaction.id,this._invtr.updateInvestorTransaction(this.transactionForm).subscribe({next:o=>{this._ms.add({severity:"success",summary:"Success",detail:"Investor transaction updated successfully."}),this.getInvestorTransaction(),this.transactionForm.reset(),this.updateInvestorBalance.emit()},error:o=>{this._ms.add(409==o.status?{severity:"error",summary:"Error",detail:o.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating investor transaction."})}})}else{if(n.disabled?this.transactionForm.value.totalamount="":r.disabled&&(this.transactionForm.value.profit=""),""==this.transactionForm.value.totalamount&&""==this.transactionForm.value.profit)return void this._ms.add({severity:"error",summary:"Error",detail:"Transaction amount missing."});this.transactionForm.value.investor=this.investorID,this._invtr.addInvestorTransaction(this.transactionForm).subscribe({next:o=>{this._ms.add({severity:"success",summary:"Success",detail:"Investor transaction added successfully."}),this.getInvestorTransaction(),this.transactionForm.reset(),n.enable(),r.enable(),this.updateInvestorBalance.emit()},error:o=>{409==o.status?(this._ms.add({severity:"error",summary:"Error",detail:o.error.message}),n.enable(),r.enable()):(this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while saving investor transaction."}),n.enable(),r.enable())}})}}deleteInvestorTransaction(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._invtr.deleteInvestorTransaction(e.value.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Investor transaction deleted successfully.",life:3e3}),this.getInvestorTransaction(),this.updateInvestorBalance.emit()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting investor transaction.",life:3e3})}})}})}onTextBoxAmount(){let e=this.transactionForm.get("totalamount"),n=this.transactionForm.get("profit");null==e.value?n.enable():""!==e.value&&(n.disable(),this.transactionForm.value.profit=null)}onTextBoxProfit(){let e=this.transactionForm.get("totalamount"),n=this.transactionForm.get("profit");null==n.value?e.enable():""!==n.value&&(e.disable(),this.transactionForm.value.totalamount=null)}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],this.investorname+"_Transactions_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,this.investorname+"_Transaction_"+ui())}toExcelFormat(){let e=[],n="",r="";e.push(this.headerData);for(var o=0;o<this.transactions.length;o++)"DB"==this.transactions[o].status&&(n=this.transactions[o].totalamount.toLocaleString(),r=""),"CR"==this.transactions[o].status&&(n="",r=this.transactions[o].totalamount.toLocaleString()),e.push([Qr(this.transactions[o].transactiondate),n,r,this.transactions[o].balance,this.transactions[o].remarks]);return e}toPdfFormat(){let e=[],n="",r="";for(var o=0;o<this.transactions.length;o++)"DB"==this.transactions[o].status&&(n=this.transactions[o].totalamount.toLocaleString(),r=""),"CR"==this.transactions[o].status&&(n="",r=this.transactions[o].totalamount.toLocaleString()),e.push([Qr(this.transactions[o].transactiondate),n,r,this.transactions[o].balance,this.transactions[o].remarks]);return e}toPdfFooterFormat(){let e=[],n=this.transactions[this.transactions.length-1].balance.toLocaleString();return e.push(["Balance:"+n,"","","",""]),e}toExcelFooterFormat(e){let n=this.transactions[this.transactions.length-1].balance.toLocaleString();return e.push(["","","","",""]),e.push(["Balance:",n,"","",""]),e}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(r_),te(Un),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-investortransaction"]],viewQuery:function(e,n){if(1&e&&Mt(qde,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{transactions:"transactions",investorname:"investorname",investorID:"investorID",total_amount:"total_amount",total_profit:"total_profit"},outputs:{updateInvestorBalance:"updateInvestorBalance"},features:[Nn([kn,Un])],decls:40,vars:24,consts:[[3,"formGroup"],[1,"row"],[1,"field","col-3","col-md-3"],["for","name"],[2,"display","flex","align-items","center"],["id","transactiondate","name","transactiondate","formControlName","transactiondate","classs","form-control","dateFormat","dd-mm-yy",3,"ngModel","inputStyle","appendTo","ngModelChange"],["class","p-error block",4,"ngIf"],["pInputText","","type","number","id","totalamount","name","totalamount","formControlName","totalamount","min","1",1,"form-control",3,"ngModel","ngModelChange","input"],["class","field col-3 col-md-3",4,"ngIf"],["optionLabel","name","optionValue","code","formControlName","status",3,"options","ngModel","ngModelChange"],["pInputText","","type","text","id","remarks","name","remarks","formControlName","remarks",1,"form-control",3,"ngModel","ngModelChange"],[2,"margin-top","20px","margin-bottom","20px","display","flex","justify-content","center"],["type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["type","button",1,"btn-project",2,"margin-left","5px",3,"click"],[1,"bi","bi-x-circle"],[4,"ngIf"],["style","text-align: center;",4,"ngIf"],["position","bottom-right"],[1,"p-error","block"],["pInputText","","type","number","id","profit","name","profit","formControlName","profit","min","1",1,"form-control",3,"ngModel","ngModelChange","input"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[1,"btn-project",3,"click"],[1,"btn-project",2,"margin-left","5px",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),_(4,"Date"),p(),f(5,"div",4)(6,"p-calendar",5),L("ngModelChange",function(o){return n.obj_date=o})("ngModelChange",function(o){return n.obj_date=o}),p()(),D(7,Gde,2,0,"small",6),p(),f(8,"div",2)(9,"label",3),_(10,"Amount"),p(),f(11,"div",4)(12,"input",7),L("ngModelChange",function(o){return n.transaction.totalamount=o})("input",function(){return n.onTextBoxAmount()}),p()()(),D(13,Kde,5,1,"div",8),f(14,"div",2)(15,"label",3),_(16,"Transaction Type"),p(),f(17,"div",4)(18,"p-dropdown",9),L("ngModelChange",function(o){return n.transaction.status=o}),p()(),D(19,Yde,2,0,"small",6),p(),f(20,"div",2)(21,"label",3),_(22,"Remarks"),p(),f(23,"div",4)(24,"input",10),L("ngModelChange",function(o){return n.transaction.remarks=o}),p()(),D(25,Xde,2,0,"small",6),p()(),f(26,"div",11)(27,"button",12),L("click",function(){return n.addInvestorTransaction(n.transactionForm)}),ee(28,"i",13),_(29,"Save"),p(),f(30,"button",14),L("click",function(){return n.resetForm()}),ee(31,"i",15),_(32,"Clear"),p()()(),ee(33,"hr"),f(34,"p"),_(35),p(),D(36,hfe,11,11,"div",16),D(37,mfe,2,0,"div",17),ee(38,"p-toast",18)(39,"p-confirmDialog")),2&e&&(T("formGroup",n.transactionForm),v(6),T("ngModel",n.obj_date)("inputStyle",rt(21,gfe))("ngModel",n.obj_date)("appendTo","body"),v(1),T("ngIf",n.transactionForm.controls.transactiondate.invalid&&n.transactionForm.controls.transactiondate.dirty),v(5),T("ngModel",n.transaction.totalamount),v(1),T("ngIf",!1),v(5),Ft(rt(22,_fe)),T("options",n.types)("ngModel",n.transaction.status),v(1),T("ngIf",n.transactionForm.controls.status.invalid&&n.transactionForm.controls.status.dirty),v(5),T("ngModel",n.transaction.remarks),v(1),T("ngIf",n.transactionForm.controls.remarks.invalid&&n.transactionForm.controls.remarks.dirty),v(2),T("disabled",n.transactionForm.invalid),v(8),hn("Name: \xa0\xa0",n.investorname,""),v(1),T("ngIf",n.transactions.length>0),v(1),T("ngIf",n.isTransactionEmpty()),v(2),Ft(rt(23,vfe)))},directives:[Hr,Ur,Pr,oc,Er,zr,Sn,qo,P0,Ir,li,us,ki,zn,_r,fr,mo],pipes:[al,dr],styles:[""]}),t})();const bfe=["dt"];function xfe(t,i){if(1&t){const e=Ie();f(0,"div",7)(1,"span",8),ee(2,"i",9),f(3,"input",10),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function wfe(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),f(3,"th"),_(4,"Amount"),p(),f(5,"th"),_(6,"Project"),p()())}function Cfe(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2),p(),f(3,"td"),_(4),Ne(5,"currency"),p(),f(6,"td"),_(7),p()()),2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(2),U(He(5,3,e.investment," ","symbol","1.0-0")),v(3),U(e.projectname)}}function Tfe(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2,"Total:"),p(),f(3,"td"),_(4),Ne(5,"currency"),p()()),2&t){const e=A();v(4),hn(" ",He(5,1,e.total_amount," ","symbol","1.0-0"),"")}}function Sfe(t,i){1&t&&(f(0,"div",11),_(1,"No data found"),p())}const Efe=function(){return["projectname"]};let kfe=(()=>{class t{constructor(){this.investorsummary=[],this.total_amount=0,this.investorname=""}ngOnInit(){}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}isInvestmentSummaryEmpty(){return 0===this.investorsummary.length}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=dn({type:t,selectors:[["app-investmentsummary"]],viewQuery:function(e,n){if(1&e&&Mt(bfe,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{investorsummary:"investorsummary",total_amount:"total_amount",investorname:"investorname"},decls:9,vars:7,consts:[["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"p"),_(1),p(),f(2,"p-table",0,1),D(4,xfe,4,0,"ng-template",2),D(5,wfe,7,0,"ng-template",3),D(6,Cfe,8,8,"ng-template",4),D(7,Tfe,6,6,"ng-template",5),p(),D(8,Sfe,2,0,"div",6)),2&e&&(v(1),hn("Name: \xa0\xa0",n.investorname,""),v(1),T("value",n.investorsummary)("paginator",!0)("rows",10)("globalFilterFields",rt(6,Efe)),v(6),T("ngIf",n.isInvestmentSummaryEmpty()))},directives:[ki,zn,li,Sn],pipes:[dr],styles:[""]}),t})();const Dfe=["dt"];function Ife(t,i){if(1&t){const e=Ie();f(0,"div",7)(1,"span",8),ee(2,"i",9),f(3,"input",10),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function Afe(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),f(3,"th"),_(4,"Amount"),p(),f(5,"th"),_(6,"Plot No"),p()())}function Mfe(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2),p(),f(3,"td"),_(4),Ne(5,"currency"),p(),f(6,"td"),_(7),p()()),2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(2),U(He(5,3,e.investment," ","symbol","1.0-0")),v(3),U(e.plotno)}}function Ffe(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2,"Total:"),p(),f(3,"td"),_(4),Ne(5,"currency"),p()()),2&t){const e=A();v(4),hn(" ",He(5,1,e.total_amount," ","symbol","1.0-0"),"")}}function Pfe(t,i){1&t&&(f(0,"div",11),_(1,"No data found"),p())}const Ofe=function(){return["projectname"]};let Nfe=(()=>{class t{constructor(){this.investorsummary=[],this.total_amount=0,this.investorname=""}ngOnInit(){}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}isInvestmentSummaryEmpty(){return 0===this.investorsummary.length}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=dn({type:t,selectors:[["app-plotinvestmentsumary"]],viewQuery:function(e,n){if(1&e&&Mt(Dfe,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{investorsummary:"investorsummary",total_amount:"total_amount",investorname:"investorname"},decls:9,vars:7,consts:[["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"p"),_(1),p(),f(2,"p-table",0,1),D(4,Ife,4,0,"ng-template",2),D(5,Afe,7,0,"ng-template",3),D(6,Mfe,8,8,"ng-template",4),D(7,Ffe,6,6,"ng-template",5),p(),D(8,Pfe,2,0,"div",6)),2&e&&(v(1),hn("Name: \xa0\xa0",n.investorname,""),v(1),T("value",n.investorsummary)("paginator",!0)("rows",10)("globalFilterFields",rt(6,Ofe)),v(6),T("ngIf",n.isInvestmentSummaryEmpty()))},directives:[ki,zn,li,Sn],pipes:[dr],styles:[""]}),t})();const Lfe=["dt"],Rfe=["tabView"],Bfe=["menustab"];function jfe(t,i){if(1&t){const e=Ie();f(0,"span",23),L("click",function(){return z(e),A().refreshPanel()}),_(1,"Investors"),p()}}function Vfe(t,i){if(1&t){const e=Ie();f(0,"div",24)(1,"span",25),ee(2,"i",26),f(3,"input",27),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function Ufe(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Hfe(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Ufe,2,0,"th",28),f(4,"th")(5,"div",29),_(6," Name "),p()(),f(7,"th")(8,"div",29),_(9," Mobile "),p()(),f(10,"th")(11,"div",29),_(12," Principal Amount "),p()(),f(13,"th")(14,"div",29),_(15," Investment "),p()(),f(16,"th")(17,"div",29),_(18," Remaining "),p()(),f(19,"th")(20,"div",29),_(21," Address "),p()(),f(22,"th")(23,"div",29),_(24," Action "),p()()()),2&t&&(v(3),T("ngIf",!1))}function zfe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function $fe(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,zfe,2,1,"td",28),f(4,"td",17),L("click",function(){const o=z(e).$implicit;return A().toggle(o)}),_(5),p(),f(6,"td"),_(7),p(),f(8,"td"),_(9),Ne(10,"currency"),p(),f(11,"td"),_(12),Ne(13,"currency"),p(),f(14,"td"),_(15),Ne(16,"currency"),p(),f(17,"td"),_(18),p(),f(19,"td")(20,"button",30),L("click",function(){const o=z(e).$implicit;return A().updateInvestor(o)}),p(),_(21," \xa0"),f(22,"button",31),L("click",function(){const o=z(e).$implicit;return A().deleteInvestor(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.name),v(2),U(e.mobile),v(2),U(He(10,8,e.investment," ","symbol","1.0-0")),v(3),U(He(13,13,e.invested," ","symbol","1.0-0")),v(3),U(He(16,18,e.remaining," ","symbol","1.0-0")),v(3),U(e.address)}}function Wfe(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td")(2,"td"),f(3,"td"),_(4,"Total:"),p(),f(5,"td"),_(6),Ne(7,"currency"),p(),f(8,"td"),_(9),Ne(10,"currency"),p(),f(11,"td"),_(12),Ne(13,"currency"),p(),f(14,"td")(15,"button",32),L("click",function(){return z(e),A().exportTableToExcel()}),_(16,"Excel"),p(),f(17,"button",33),L("click",function(){return z(e),A().exportTableToPdf()}),_(18,"Pdf"),p()()()}if(2&t){const e=A();v(6),U(He(7,3,e.total_principalamount," ","symbol","1.0-0")),v(3),U(He(10,8,e.total_investment," ","symbol","1.0-0")),v(3),U(He(13,13,e.total_remaining," ","symbol","1.0-0"))}}function qfe(t,i){1&t&&(f(0,"div",34),_(1,"No data found"),p())}const Gfe=function(){return["name","mobile","investment","address"]},Kfe=function(){return{width:"450px"}};let Yfe=(()=>{class t{constructor(e,n,r,o,c,u){this._is=e,this.confirmationService=n,this.messageService=r,this._invtr=o,this.pdfserv=c,this.exptoexcel=u,this.investors=[],this.investorID=0,this.activeIndex=0,this.projectID=0,this.displayDialog=!1,this.displayAddModal=!1,this.transactions=[],this.investorsummary=[],this.investorname="",this.total_amount=0,this.total_profit=0,this.total_investment=0,this.total_principalamount=0,this.total_remaining=0,this.invested=0,this.remaining=0,this.headerData=["Name","Mobile","Pr.Amount","Invested","Remaining","Address"]}ngOnInit(){this.getInvestors()}refreshPanel(){this.getInvestors()}toggle(e){this.menustab.disabled=!1,this.investorID=e.id,this.investorname=e.name,this.activeIndex=1}toggleITPanel(){this.total_amount=0,this.total_profit=0,this._invtr.getInvestorTransaction(this.investorID.toString()).subscribe({next:e=>{this.transactions=e,this.investorname=e[0].investor,e.forEach(n=>{"CR"==n.status?(this.total_amount=Number(this.total_amount)+Number(n.totalamount),this.total_profit=Number(this.total_profit)+Number(n.profit)):"DB"==n.status&&(this.total_amount=Number(this.total_amount)-Number(n.totalamount),this.total_profit=Number(this.total_profit)-Number(n.profit))})},error:e=>{console.error(e)}}),this.activeIndex=2}togglePSPanel(){this._invtr.getPlotInvestmentSummary(this.investorID.toString()).subscribe({next:e=>{this.total_amount=0,this.investorsummary=[],e.forEach(n=>{this.total_amount=Number(this.total_amount)+Number(n.investment)}),this.investorsummary=e},error:e=>{console.error(e)}}),this.activeIndex=4}toggleISPanel(){this.investorsummary=[],this._invtr.getInvestorSummary(this.investorID.toString()).subscribe({next:e=>{this.total_amount=0,e.forEach(n=>{this.total_amount=Number(this.total_amount)+Number(n.investment)}),this.investorsummary=e},error:e=>{console.error(e)}}),this.activeIndex=3}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}getInvestors(){var e=this;return(0,jde.Z)(function*(){e.total_investment=0,e.total_principalamount=0,e.total_remaining=0,e.invested=0,e._is.getInvestors(e.projectID.toString()).subscribe({next:n=>{e.investors=n,e.investors.forEach(r=>{e.total_investment=e.total_investment+Number(r.invested),e.total_principalamount=e.total_principalamount+Number(r.investment),e.total_remaining=e.total_remaining+Number(r.remaining)})},error:n=>{console.error(n)}})})()}isInvestorsEmpty(){return 0===this.investors.length}showAddInvestorsDialog(){this.displayAddModal=!0}hideAddModal(e){this.displayAddModal=!e}updateInvestorList(e){this.getInvestors()}updateInvestor(e){this.investor=Object.assign({},e),this.displayAddModal=!0}deleteInvestor(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._is.deleteInvestor(e.id).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Investor deleted successfully.",life:3e3}),this.getInvestors()},error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:n.error.message,life:3e3})}})}})}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],"Investment_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"Investment_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.investors.length;n++)e.push([this.investors[n].name,this.investors[n].mobile,this.investors[n].investment.toLocaleString(),this.investors[n].invested.toLocaleString(),this.investors[n].remaining.toLocaleString(),this.investors[n].address]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.investors.length;n++)e.push([this.investors[n].name,this.investors[n].mobile,this.investors[n].investment.toLocaleString(),this.investors[n].invested.toLocaleString(),this.investors[n].remaining.toLocaleString(),this.investors[n].address]);return e}toPdfFooterFormat(){let e=[];return e.push(["","","Total",this.total_investment.toLocaleString(),"","",""]),e}toExcelFooterFormat(e){return e.push(["","","","","","",""]),e.push(["","","Total",this.total_investment.toLocaleString(),"","",""]),e}}return t.\u0275fac=function(e){return new(e||t)(te(r_),te(Un),te(kn),te(r_),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-investors"]],viewQuery:function(e,n){if(1&e&&(Mt(Lfe,5),Mt(Rfe,5),Mt(Bfe,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.tabView=r.first),xt(r=wt())&&(n.menustab=r.first)}},inputs:{projectID:"projectID"},features:[Nn([Is,kn,Un])],decls:38,vars:27,consts:[[1,"text-muted"],[3,"activeIndex","activeIndexChange"],["tabView",""],["header","Investors"],["pTemplate","header"],[1,"btn-project",2,"margin-right","700px",3,"click"],[1,"bi","bi-plus-lg"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],["position","bottom-right"],[2,"width","600px",3,"displayAddModal","investor","clickClose","clickAdd"],["header","Menu",3,"disabled"],["menustab",""],[1,"list-item",3,"click"],["header","Transactions Detail",3,"disabled"],[3,"investorID","investorname","transactions","total_amount","total_profit","updateInvestorBalance"],["header","Projects Investment Summary",3,"disabled"],[3,"investorsummary","total_amount","investorname"],["header","Plots Investment Summary",3,"disabled"],[1,"custom-tab-header",3,"click"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[4,"ngIf"],[1,"p-d-flex","p-jc-between"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[1,"btn-project",3,"click"],[1,"btn-project",2,"margin-left","5px",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"h2",0),_(1,"Manage Investors"),p(),ee(2,"hr"),f(3,"p-tabView",1,2),L("activeIndexChange",function(o){return n.activeIndex=o}),f(5,"p-tabPanel",3),D(6,jfe,2,0,"ng-template",4),f(7,"button",5),L("click",function(){return n.showAddInvestorsDialog()}),ee(8,"i",6),_(9,"Add New"),p(),f(10,"p-table",7,8),D(12,Vfe,4,0,"ng-template",9),D(13,Hfe,25,1,"ng-template",4),D(14,$fe,23,23,"ng-template",10),D(15,Wfe,19,18,"ng-template",11),p(),D(16,qfe,2,0,"div",12),ee(17,"p-toast",13)(18,"p-confirmDialog"),f(19,"app-add-edit-investor",14),L("clickClose",function(o){return n.hideAddModal(o)})("clickAdd",function(o){return n.updateInvestorList(o)}),p()(),f(20,"p-tabPanel",15,16)(22,"ul")(23,"li",17),L("click",function(){return n.toggleITPanel()}),f(24,"p"),_(25,"Transactions"),p()(),f(26,"li",17),L("click",function(){return n.toggleISPanel()}),f(27,"p"),_(28,"Projects Summary"),p()(),f(29,"li",17),L("click",function(){return n.togglePSPanel()}),f(30,"p"),_(31,"Plots Summary"),p()()()(),f(32,"p-tabPanel",18)(33,"app-investortransaction",19),L("updateInvestorBalance",function(){return n.getInvestors()}),p()(),f(34,"p-tabPanel",20),ee(35,"app-investmentsummary",21),p(),f(36,"p-tabPanel",22),ee(37,"app-plotinvestmentsumary",21),p()()),2&e&&(v(3),T("activeIndex",n.activeIndex),v(7),T("value",n.investors)("paginator",!0)("rows",25)("globalFilterFields",rt(25,Gfe)),v(6),T("ngIf",n.isInvestorsEmpty()),v(2),Ft(rt(26,Kfe)),v(1),T("displayAddModal",n.displayAddModal)("investor",n.investor),v(1),T("disabled",!0),v(12),T("disabled",!0),v(1),T("investorID",n.investorID)("investorname",n.investorname)("transactions",n.transactions)("total_amount",n.total_amount)("total_profit",n.total_profit),v(1),T("disabled",!0),v(1),T("investorsummary",n.investorsummary)("total_amount",n.total_amount)("investorname",n.investorname),v(1),T("disabled",!0),v(1),T("investorsummary",n.investorsummary)("total_amount",n.total_amount)("investorname",n.investorname))},directives:[Cf,wf,zn,ki,li,Sn,_r,fr,mo,Wde,yfe,kfe,Nfe],pipes:[dr],styles:[".list-item[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),t})();const Rm=Ws_apiUrl,o9={headers:new io({"Content-Type":"application/json"})};let gM=(()=>{class t{constructor(e){this._http=e}addLabourCost(e){const n=e.value.jobtype,r=e.value.project,o=e.value.unit,{description:c,quantity:u,unitcost:m}=e.value;return console.log("In service "+r+" "+n+" "+c+" "+o+" "+u+" "+m),this._http.post(Rm+"addLabourCost",{project:r,jobtype:n,description:c,unit:o,quantity:u,unitcost:m},o9)}updateLabourCost(e){const n=e.value.jobtype,r=e.value.project.id,o=e.value.unit,{id:c,description:u,quantity:m,unitcost:g}=e.value;return console.log("In service "+c+" "+r+" "+n+" "+u+" "+o+" "+m+" "+g),this._http.post(Rm+"updateLabourCost",{id:c,project:r,jobtype:n,description:u,unit:o,quantity:m,unitcost:g},o9)}getLabourCost(){return this._http.get(Rm+"getLabourCost")}getLabourCostSummary(e){return this._http.get(Rm+"getLabourCostSummary",{params:{projectid:e.toString()}})}getTotalEstimatedCost(e){return this._http.get(Rm+"getTotalEstimatedCost",{params:{projectid:e.toString()}})}getLabourCostWithProject(e){return this._http.get(Rm+"getLabourCostWithProject",{params:{id:e.toString()}})}deleteLabourCost(e){return this._http.delete(`${Rm}deleteLabourCost`,{body:{id:e}})}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Xfe=(()=>{class t{constructor(e,n,r,o){this.el=e,this.ngModel=n,this.control=r,this.cd=o,this.onResize=new Et}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(e){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}onFocus(e){this.autoResize&&this.resize(e)}onBlur(e){this.autoResize&&this.resize(e)}resize(e){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(e||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(te(mr),te(md,8),te(gf,8),te(Wo))},t.\u0275dir=Ln({type:t,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:4,hostBindings:function(e,n){1&e&&L("input",function(o){return n.onInput(o)})("focus",function(o){return n.onFocus(o)})("blur",function(o){return n.onBlur(o)}),2&e&&po("p-filled",n.filled)("p-inputtextarea-resizable",n.autoResize)},inputs:{autoResize:"autoResize"},outputs:{onResize:"onResize"}}),t})(),Qfe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[Ro]]}),t})();const Jfe=["dt"],Zfe=["dtlocations"];function epe(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedLocation)}}function tpe(t,i){1&t&&D(0,epe,3,1,"div",37),2&t&&T("ngIf",A().selectedLocation)}function npe(t,i){if(1&t&&(f(0,"div",38)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.name)}}function ipe(t,i){1&t&&(f(0,"small",39),_(1," Location is required."),p())}function rpe(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedStatus)}}function ope(t,i){1&t&&D(0,rpe,3,1,"div",37),2&t&&T("ngIf",A().selectedStatus)}function spe(t,i){if(1&t&&(f(0,"div",38)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.name)}}function ape(t,i){1&t&&(f(0,"small",39),_(1," Status is required."),p())}function lpe(t,i){1&t&&(f(0,"small",39),_(1," Covered area is required."),p())}function cpe(t,i){1&t&&(f(0,"small",39),_(1," Project name is required."),p())}function upe(t,i){1&t&&(f(0,"small",39),_(1," Budget is required."),p())}function dpe(t,i){1&t&&(f(0,"small",39),_(1," Land Cost is required."),p())}function fpe(t,i){1&t&&(f(0,"small",39),_(1," Commission is required."),p())}function ppe(t,i){1&t&&(f(0,"small",39),_(1," Tax is required."),p())}function hpe(t,i){1&t&&(f(0,"small",39),_(1," Start Date is required."),p())}function mpe(t,i){if(1&t){const e=Ie();f(0,"div",40)(1,"button",41),L("click",function(){z(e);const r=A();return r.addProject(r.projectForm)}),ee(2,"i",42),_(3," Save "),p(),f(4,"button",43),L("click",function(){return z(e),A().closeModal()}),ee(5,"i",44),_(6," Cancel "),p()()}if(2&t){const e=A();v(1),T("disabled",e.projectForm.invalid)}}function gpe(t,i){1&t&&(f(0,"small",39),_(1," Location name is required."),p())}function _pe(t,i){if(1&t){const e=Ie();f(0,"div",54),ee(1,"i",55),f(2,"input",56),L("input",function(r){return z(e),A(2).applyFilterLocations(r,"contains")}),p()()}}function vpe(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function ype(t,i){1&t&&(f(0,"tr")(1,"th")(2,"div",57),_(3," Sr# "),p()(),D(4,vpe,2,0,"th",37),f(5,"th"),_(6,"Name"),p(),f(7,"th"),_(8,"Action"),p()()),2&t&&(v(4),T("ngIf",!1))}function bpe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function xpe(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,bpe,2,1,"td",37),f(4,"td"),_(5),p(),f(6,"td")(7,"button",58),L("click",function(){const o=z(e).$implicit;return A(2).updateLocation(o)}),p(),_(8," \xa0"),f(9,"button",59),L("click",function(){const o=z(e).$implicit;return A(2).deleteLocation(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.name)}}function wpe(t,i){1&t&&(f(0,"div",60),_(1,"No data found"),p())}const Cpe=function(){return["name"]};function Tpe(t,i){if(1&t){const e=Ie();f(0,"form",2)(1,"div",4)(2,"label",6),_(3,"Name"),p(),f(4,"input",16),L("ngModelChange",function(r){return z(e),A().location.name=r}),p(),D(5,gpe,2,0,"small",12),p()(),f(6,"div",45)(7,"button",46),L("click",function(){z(e);const r=A();return r.saveLocations(r.locationForm)}),ee(8,"i",42),_(9," Save "),p(),f(10,"button",47),L("click",function(){return z(e),A().hideLocationDialog()}),ee(11,"i",44),_(12," Cancel "),p()(),ee(13,"hr"),f(14,"p-table",48,49),D(16,_pe,3,0,"ng-template",50),D(17,ype,9,1,"ng-template",51),D(18,xpe,10,3,"ng-template",52),p(),D(19,wpe,2,0,"div",53)}if(2&t){const e=A();T("formGroup",e.locationForm),v(4),T("ngModel",e.location.name),v(1),T("ngIf",e.locationForm.controls.name.invalid&&e.locationForm.controls.name.dirty),v(2),T("disabled",e.locationForm.invalid),v(7),T("value",e.locations)("paginator",!0)("rows",10)("globalFilterFields",rt(9,Cpe)),v(5),T("ngIf",e.isLocationEmpty())}}const Spe=function(){return{width:"40vw"}},Epe=function(){return{width:"200px"}},_M=function(){return{width:"230px"}},kpe=function(){return{width:"30vw"}};let Dpe=(()=>{class t{constructor(e,n,r,o,c,u,m){this.fb=e,this._cs=n,this._ls=r,this._ps=o,this._ms=c,this.dialogService=u,this._confirm=m,this.displayAddModal=!1,this.clickClose=new Et,this.clickAdd=new Et,this.slectedStatus="",this.statuses=[{name:"Started"},{name:"In Progress"},{name:"Completed"}]}ngOnInit(){null==this.project&&(this.project={id:"",project_name:"",description:"",location:"",landcost:"",startdate:"",enddate:"",status:"",budget:"",commission:"",taxes:"",notes:"",coveredarea:"",type:""}),this.projectForm=new Zn({name:new Me("",jt.required),budget:new Me("",jt.required),coveredarea:new Me("",jt.required),description:new Me(""),location:new Me("",jt.required),startdate:new Me("",jt.required),enddate:new Me(""),landcost:new Me("",jt.required),status:new Me("",jt.required),taxes:new Me(""),commission:new Me(""),notes:new Me(""),type:new Me("")}),this.locationForm=new Zn({id:new Me(""),name:new Me("",jt.required)}),this.location={id:"",name:""},this.getLocations()}getLocations(){this._ls.getLocations().subscribe(e=>{this.locations=e},e=>{console.log(e)})}isLocationEmpty(){return 0===this.locations.length}applyFilterLocations(e,n){this.dtlocations.filterGlobal(e.target.value,n)}hideLocationDialog(){this.locationDialog=!1,this.getLocations()}saveLocations(e){this.location.id?this._ls.updateLocation(Number(this.location.id),this.location.name).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Location is updated successfully.",life:3e3}),this.locationForm.reset(),this.location={},this.getLocations()},error:n=>{console.error(n)}}):this._ls.addLocation(this.location.name).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Location is saved successfully.",life:3e3}),this.locationForm.reset(),this.getLocations()},error:n=>{console.error(n)}})}updateLocation(e){this.location=Object.assign({},e)}deleteLocation(e){this._confirm.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._ls.deleteLocation(e.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Location deleted successfully.",life:3e3}),this.getLocations()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:n.error.message,life:3e3})}})}})}closeModal(){this.clickClose.emit(!0)}addProject(e){this.project.id?(e.value.id=this.project.id,e.value.type=this.selectedType,this._ps.updateProject(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Project updated successfully."}),this.clickAdd.emit(n),this.closeModal()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message,life:3e3}:{severity:"error",summary:"Error",detail:"Error occurred while updating project."})}})):(e.value.type=this.selectedType,this._ps.addProject(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Project added successfully."}),this.clickAdd.emit(n),this.projectForm.reset(),this.closeModal()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message,life:3e3}:{severity:"error",summary:"Error",detail:"Error occurred while saving project."})}}))}showLocationDialog(){this.locationDialog=!0}hideAddModal(e){this.displayAddModal=!e}}return t.\u0275fac=function(e){return new(e||t)(te(pT),te(hM),te(nS),te(ll),te(kn),te(Is),te(Un))},t.\u0275cmp=dn({type:t,selectors:[["app-add-edit-project"]],viewQuery:function(e,n){if(1&e&&(Mt(Jfe,5),Mt(Zfe,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.dtlocations=r.first)}},inputs:{displayAddModal:"displayAddModal",project:"project",projectID:"projectID",selectedType:"selectedType",obj_startdate:"obj_startdate",obj_enddate:"obj_enddate",selectedStatus:"selectedStatus",selectedLocation:"selectedLocation"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd"},decls:90,vars:52,consts:[["header","Add Project",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[1,"flex","justify-content-center",2,"margin-bottom","5px"],[3,"formGroup"],[1,"p-fluid","formgrid"],[1,"row"],[1,"field","col-12","col-md-6"],["for","name"],[2,"display","flex","align-items","center"],["id","location","name","location","optionLabel","name","optionValue","id","filterBy","name","placeholder","Select a Location","formControlName","location","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange"],["class","custom-dropdown"],["type","button",1,"btn-project","btn-project-icon",3,"click"],[1,"bi","bi-plus-lg"],["class","p-error block",4,"ngIf"],["id","status","name","status","optionLabel","name","filterBy","name","placeholder","Select a Status","formControlName","status","autoWidth","false","optionValue","name",3,"options","filter","showClear","ngModel","ngModelChange"],["dropdown",""],["pInputText","","type","number","id","coveredarea","name","coveredarea","formControlName","coveredarea",3,"ngModel","ngModelChange"],["pInputText","","type","text","id","name","name","name","formControlName","name",3,"ngModel","ngModelChange"],["for","budget"],["pInputText","","type","number","id","budget","name","budget","formControlName","budget",3,"ngModel","ngModelChange"],["for","landcost"],["pInputText","","type","number","id","landcost","name","landcost","formControlName","landcost",3,"ngModel","ngModelChange"],["for","commission",2,"margin-right","10px"],["pInputText","","type","number","id","commission","name","commission","formControlName","commission",3,"ngModel","ngModelChange"],["for","taxes",2,"margin-right","10px"],["pInputText","","type","number","id","taxes","name","taxes","formControlName","taxes",3,"ngModel","ngModelChange"],["for","startdate",2,"margin-right","10px"],["appendTo","body","id","startdate","name","startdate","formControlName","startdate","dateFormat","dd-mm-yy",3,"ngModel","ngModelChange"],["for","enddate",2,"margin-right","10px"],["appendTo","body","id","enddate","name","enddate","formControlName","enddate"],["for","description",2,"margin-right","10px"],["id","description","pInputTextarea","","formControlName","description","cols","23",3,"ngModel","ngModelChange"],["for","remarks",2,"margin-right","10px"],["id","remarks","pInputTextarea","","formControlName","notes","cols","23",3,"ngModel","ngModelChange"],["pTemplate","footer"],["header","Manage Locations",3,"visible","modal","visibleChange"],["pTemplate","content"],["position","bottom-right"],[4,"ngIf"],[1,"flex","align-items-center","gap-2"],[1,"p-error","block"],[1,"project-btn-group","project-btn-group--center"],["icon","pi pi-check","type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["icon","pi pi-times","type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-circle"],[1,"project-btn-group","project-btn-group--center",2,"margin","5px 0"],["type","button",1,"btn-project",3,"disabled","click"],["type","button",1,"btn-project",3,"click"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dtlocations",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],[2,"text-align","right"],[1,"fas","fa-search",2,"margin","4px 4px 0 0"],["type","text","pInputText","","size","50","placeholder","Global Filter",2,"width","auto",3,"input"],[1,"p-d-flex","p-jc-between","p-ai-center"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"p-dialog",0),L("visibleChange",function(o){return n.displayAddModal=o})("onHide",function(){return n.closeModal()}),ee(1,"div",1),f(2,"form",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"label",6),_(7,"Location"),p(),f(8,"div",7)(9,"p-dropdown",8),L("ngModelChange",function(o){return n.selectedLocation=o}),D(10,tpe,1,1,"ng-template",9),D(11,npe,3,1,"ng-template",9),p(),f(12,"button",10),L("click",function(){return n.showLocationDialog()}),ee(13,"i",11),p()(),D(14,ipe,2,0,"small",12),p(),f(15,"div",5)(16,"label",6),_(17,"Status"),p(),f(18,"div",7)(19,"p-dropdown",13,14),L("ngModelChange",function(o){return n.selectedStatus=o}),D(21,ope,1,1,"ng-template",9),D(22,spe,3,1,"ng-template",9),p()(),D(23,ape,2,0,"small",12),p()(),f(24,"div",4)(25,"div",5)(26,"label",6),_(27,"Covered Area"),p(),f(28,"div",7)(29,"input",15),L("ngModelChange",function(o){return n.project.coveredarea=o}),p()(),D(30,lpe,2,0,"small",12),p(),f(31,"div",5)(32,"label",6),_(33,"Name"),p(),f(34,"div",7)(35,"input",16),L("ngModelChange",function(o){return n.project.project_name=o}),p()(),D(36,cpe,2,0,"small",12),p()(),f(37,"div",4)(38,"div",5)(39,"label",17),_(40,"Estimated Construction Cost"),p(),f(41,"div",7)(42,"input",18),L("ngModelChange",function(o){return n.project.budget=o}),p()(),D(43,upe,2,0,"small",12),p(),f(44,"div",5)(45,"label",19),_(46,"Land Cost"),p(),f(47,"div",7)(48,"input",20),L("ngModelChange",function(o){return n.project.landcost=o}),p()(),D(49,dpe,2,0,"small",12),p()(),f(50,"div",4)(51,"div",5)(52,"label",21),_(53,"Commission"),p(),f(54,"div",7)(55,"input",22),L("ngModelChange",function(o){return n.project.commission=o}),p()(),D(56,fpe,2,0,"small",12),p(),f(57,"div",5)(58,"label",23),_(59,"Taxes"),p(),f(60,"div",7)(61,"input",24),L("ngModelChange",function(o){return n.project.taxes=o}),p()(),D(62,ppe,2,0,"small",12),p()(),f(63,"div",4)(64,"div",5)(65,"label",25),_(66,"Start Date"),p(),f(67,"div",7)(68,"p-calendar",26),L("ngModelChange",function(o){return n.obj_startdate=o}),p()(),D(69,hpe,2,0,"small",12),p(),f(70,"div",5)(71,"label",27),_(72,"End Date"),p(),f(73,"div",7),ee(74,"p-calendar",28),p()()(),f(75,"div",4)(76,"div",5)(77,"label",29),_(78,"Description"),p(),f(79,"div",7)(80,"textarea",30),L("ngModelChange",function(o){return n.project.description=o}),p()()(),f(81,"div",5)(82,"label",31),_(83,"Remarks"),p(),f(84,"div",7)(85,"textarea",32),L("ngModelChange",function(o){return n.project.notes=o}),p()()()()()(),D(86,mpe,7,1,"ng-template",33),p(),f(87,"p-dialog",34),L("visibleChange",function(o){return n.locationDialog=o}),D(88,Tpe,20,10,"ng-template",35),p(),ee(89,"p-toast",36)),2&e&&(Ft(rt(46,Spe)),T("visible",n.displayAddModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(2),T("formGroup",n.projectForm),v(7),Ft(rt(47,Epe)),T("options",n.locations)("filter",!0)("showClear",!0)("ngModel",n.selectedLocation),v(5),T("ngIf",n.projectForm.controls.location.invalid&&n.projectForm.controls.location.dirty),v(5),Ft(rt(48,_M)),T("options",n.statuses)("filter",!0)("showClear",!0)("ngModel",n.selectedStatus),v(4),T("ngIf",n.projectForm.controls.status.invalid&&n.projectForm.controls.status.dirty),v(6),T("ngModel",n.project.coveredarea),v(1),T("ngIf",n.projectForm.controls.coveredarea.invalid&&n.projectForm.controls.coveredarea.dirty),v(5),T("ngModel",n.project.project_name),v(1),T("ngIf",n.projectForm.controls.name.invalid&&n.projectForm.controls.name.dirty),v(6),T("ngModel",n.project.budget),v(1),T("ngIf",n.projectForm.controls.budget.invalid&&n.projectForm.controls.budget.dirty),v(5),T("ngModel",n.project.landcost),v(1),T("ngIf",n.projectForm.controls.landcost.invalid&&n.projectForm.controls.landcost.dirty),v(6),T("ngModel",n.project.commission),v(1),T("ngIf",n.projectForm.controls.commission.invalid&&n.projectForm.controls.commission.dirty),v(5),T("ngModel",n.project.taxes),v(1),T("ngIf",n.projectForm.controls.taxes.invalid&&n.projectForm.controls.taxes.dirty),v(6),Ft(rt(49,_M)),T("ngModel",n.obj_startdate),v(1),T("ngIf",n.projectForm.controls.startdate.invalid&&n.projectForm.controls.startdate.dirty),v(5),Ft(rt(50,_M)),v(6),T("ngModel",n.project.description),v(5),T("ngModel",n.project.notes),v(2),Ft(rt(51,kpe)),T("visible",n.locationDialog)("modal",!0))},directives:[ms,Hr,Ur,Pr,us,Er,zr,Sn,qo,Ir,li,oc,Xfe,zn,ki,_r,fr],styles:[".custom-dropdown[_ngcontent-%COMP%]{width:220px;height:60px;margin-right:10px}.dropdown-container[_ngcontent-%COMP%]{display:flex}.custom-calendar-container[_ngcontent-%COMP%]{width:300px;height:200px}"]}),t})();const lS=Ws_apiUrl,s9={headers:new io({"Content-Type":"application/json"})};let Ipe=(()=>{class t{constructor(e){this._http=e}addJobType(e){return console.log("In service "+e),this._http.post(lS+"addJobType",{jobtype:e},s9)}updateJobType(e,n){return this._http.post(lS+"updateJobType",{id:e,jobtype:n},s9)}getJobTypes(){return this._http.get(lS+"getJobTypes")}deleteJobType(e){return this._http.delete(`${lS}deleteJobType`,{body:{id:e}})}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Ape=["dt"],Mpe=["dtjobtypes"],Fpe=["dtunits"];function Ppe(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedJobtype)}}function Ope(t,i){1&t&&D(0,Ppe,3,1,"div",22),2&t&&T("ngIf",A().selectedJobtype)}function Npe(t,i){if(1&t&&(f(0,"div",23)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.title)}}function Lpe(t,i){1&t&&(f(0,"small",24),_(1," Job type is required."),p())}function Rpe(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedUnit)}}function Bpe(t,i){1&t&&D(0,Rpe,3,1,"div",22),2&t&&T("ngIf",A().selectedUnit)}function jpe(t,i){if(1&t&&(f(0,"div",23)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.name)}}function Vpe(t,i){1&t&&(f(0,"small",24),_(1," Unit is required."),p())}function Upe(t,i){1&t&&(f(0,"small",24),_(1," Quantity is required."),p())}function Hpe(t,i){1&t&&(f(0,"small",24),_(1," Unit Cost is required."),p())}function zpe(t,i){if(1&t){const e=Ie();f(0,"div",25)(1,"div")(2,"button",26),L("click",function(){z(e);const r=A();return r.addLabourCost(r.labourCostForm)}),ee(3,"i",27),_(4,"Save"),p(),f(5,"button",28),L("click",function(){return z(e),A().closeModal()}),ee(6,"i",29),_(7," Cancel"),p()()()}if(2&t){const e=A();v(2),T("disabled",e.labourCostForm.invalid)}}function $pe(t,i){1&t&&(f(0,"small",24),_(1," Job name is required."),p())}function Wpe(t,i){if(1&t){const e=Ie();f(0,"div",41)(1,"span",42),ee(2,"i",43),f(3,"input",44),L("input",function(r){return z(e),A(2).applyFilterGlobalJobtype(r,"contains")}),p()()()}}function qpe(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Gpe(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,qpe,2,0,"th",22),f(4,"th"),_(5,"Title"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function Kpe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Ype(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Kpe,2,1,"td",22),f(4,"td"),_(5),p(),f(6,"td")(7,"button",45),L("click",function(){const o=z(e).$implicit;return A(2).updateJobtype(o)}),p(),_(8," \xa0"),f(9,"button",46),L("click",function(){const o=z(e).$implicit;return A(2).deleteJobtype(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.title)}}function Xpe(t,i){1&t&&(f(0,"div",47),_(1,"No data found"),p())}const a9=function(){return["title"]};function Qpe(t,i){if(1&t){const e=Ie();f(0,"form",1)(1,"div",30)(2,"label",31),_(3,"Job Name"),p(),f(4,"input",32),L("ngModelChange",function(r){return z(e),A().job.title=r}),p(),D(5,$pe,2,0,"small",10),p()(),f(6,"div",25)(7,"button",33),L("click",function(){z(e);const r=A();return r.saveJob(r.jobForm)}),_(8,"Save"),p(),f(9,"button",34),L("click",function(){return z(e),A().hideDialog()}),_(10,"Cancel"),p()(),ee(11,"hr"),f(12,"p-table",35,36),D(14,Wpe,4,0,"ng-template",37),D(15,Gpe,8,1,"ng-template",38),D(16,Ype,10,3,"ng-template",39),p(),D(17,Xpe,2,0,"div",40)}if(2&t){const e=A();T("formGroup",e.jobForm),v(4),T("ngModel",e.job.title),v(1),T("ngIf",e.jobForm.controls.title.invalid&&e.jobForm.controls.title.dirty),v(2),T("disabled",e.jobForm.invalid),v(5),T("value",e.jobtypes)("paginator",!0)("rows",10)("globalFilterFields",rt(9,a9)),v(5),T("ngIf",e.isJobtypeEmpty())}}function Jpe(t,i){1&t&&(f(0,"small",24),_(1," Unit is required."),p())}function Zpe(t,i){if(1&t){const e=Ie();f(0,"div",41)(1,"span",42),ee(2,"i",43),f(3,"input",44),L("input",function(r){return z(e),A(2).applyFilterGlobalUnits(r,"contains")}),p()()()}}function ehe(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function the(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,ehe,2,0,"th",22),f(4,"th"),_(5,"Unit"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function nhe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function ihe(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,nhe,2,1,"td",22),f(4,"td"),_(5),p(),f(6,"td")(7,"button",45),L("click",function(){const o=z(e).$implicit;return A(2).updateUnit(o)}),p(),_(8," \xa0"),f(9,"button",46),L("click",function(){const o=z(e).$implicit;return A(2).deleteUnit(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.unit)}}function rhe(t,i){1&t&&(f(0,"div",47),_(1,"No data found"),p())}function ohe(t,i){if(1&t){const e=Ie();f(0,"form",1)(1,"div",30)(2,"label",48),_(3,"Unit"),p(),f(4,"input",49),L("ngModelChange",function(r){return z(e),A().unit.unit=r}),p(),D(5,Jpe,2,0,"small",10),p()(),f(6,"div",25)(7,"button",33),L("click",function(){z(e);const r=A();return r.saveUnit(r.unitForm)}),_(8,"Save"),p(),f(9,"button",34),L("click",function(){return z(e),A().hideUnitDialog()}),_(10,"Cancel"),p()(),ee(11,"hr"),f(12,"p-table",35,36),D(14,Zpe,4,0,"ng-template",37),D(15,the,8,1,"ng-template",38),D(16,ihe,10,3,"ng-template",39),p(),D(17,rhe,2,0,"div",40)}if(2&t){const e=A();T("formGroup",e.unitForm),v(4),T("ngModel",e.unit.unit),v(1),T("ngIf",e.unitForm.controls.unit.invalid&&e.unitForm.controls.unit.dirty),v(2),T("disabled",e.unitForm.invalid),v(5),T("value",e.units)("paginator",!0)("rows",10)("globalFilterFields",rt(9,a9)),v(5),T("ngIf",e.isUnitEmpty())}}const she=function(){return{width:"30vw"}},l9=function(){return{width:"260px"}},ahe=function(){return{width:"700px"}},lhe=function(){return{width:"600px"}},che=function(){return{width:"450px"}};let uhe=(()=>{class t{constructor(e,n,r,o,c,u,m){this._js=e,this._unit=n,this._ps=r,this._ls=o,this._ms=c,this.dialogService=u,this.confirmationService=m,this.displayAddModal=!1,this.clickClose=new Et,this.clickAdd=new Et}ngOnInit(){this.labourcost={id:"",jobtype:"",project:"",unit:"",description:"",quantity:"",unitcost:""},this.labourCostForm=new Zn({id:new Me(""),project:new Me(""),description:new Me(""),jobtype:new Me("",jt.required),unit:new Me("",jt.required),unitcost:new Me("",jt.required),quantity:new Me("",jt.required)}),this.jobForm=new Zn({id:new Me(""),title:new Me("",jt.required)}),this.unitForm=new Zn({id:new Me(""),unit:new Me("",jt.required)}),this.getJobTypes(),this.getUnits()}getJobTypes(){this._js.getJobTypes().subscribe(e=>{this.jobtypes=e},e=>{console.log(e)})}isJobtypeEmpty(){return 0===this.jobtypes.length}isUnitEmpty(){return 0===this.units.length}deleteJobtype(e){this.job=Object.assign({},e),this.job.title="",this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._js.deleteJobType(this.job.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Job deleted successfully.",life:3e3}),this.getJobTypes()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting job.",life:3e3})}})}})}deleteUnit(e){this.unit=Object.assign({},e),this.unit.unit="",this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._unit.deleteUnit(this.unit.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Unit deleted successfully.",life:3e3}),this.getUnits()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting unit.",life:3e3})}})}})}updateJobtype(e){this.job=Object.assign({},e)}updateUnit(e){this.unit=Object.assign({},e)}applyFilterGlobalJobtype(e,n){this.dtjobtypes.filterGlobal(e.target.value,n)}applyFilterGlobalUnits(e,n){this.dtunits.filterGlobal(e.target.value,n)}getUnits(){this._unit.getUnits().subscribe(e=>{this.units=e},e=>{console.log(e)})}closeModal(){this.clickClose.emit(!0)}addLabourCost(e){this.labourcost.id?(e.value.id=this.labourcost.id,e.value.project=this.projectID,this._ls.updateLabourCost(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Labour cost updated successfully."}),this.clickAdd.emit(n),this.closeModal()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while updating labour cost."})}})):(e.value.project=this.projectID,this._ls.addLabourCost(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Labour cost added successfully."}),this.clickAdd.emit(n),this.labourCostForm.reset()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while saving labour cost."})}}))}hideDialog(){this.jobDialog=!1,this.getJobTypes()}hideUnitDialog(){this.unitDialog=!1,this.getUnits()}newJob(){this.job={},this.jobDialog=!0}newUnit(){this.unit={},this.unitDialog=!0}saveJob(e){this.job.id?(this.jobForm.value.id=this.job.id,this._js.updateJobType(this.jobForm.value.id,this.jobForm.value.title).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Job is updated succesfully.",life:3e3}),this.jobForm.reset(),this.getJobTypes()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating job."})}})):this._js.addJobType(this.jobForm.value.title).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Job is saved succesfully.",life:3e3}),this.jobForm.reset(),this.getJobTypes()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while saving job.",life:3e3})}})}saveUnit(e){this.unit.id?(this.unitForm.value.id=this.unit.id,this._unit.updateUnit(this.unitForm.value.id,this.unitForm.value.unit).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Unit is updated succesfully.",life:3e3}),this.getUnits(),this.unitForm.reset()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while updating unit.",life:3e3})}})):this._unit.addUnit(this.unitForm.value.unit).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Unit is saved succesfully.",life:3e3}),this.getUnits(),this.unitForm.reset()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while saving unit.",life:3e3})}})}}return t.\u0275fac=function(e){return new(e||t)(te(Ipe),te(K7),te(ll),te(gM),te(kn),te(Is),te(Un))},t.\u0275cmp=dn({type:t,selectors:[["app-addeditlaboursheet"]],viewQuery:function(e,n){if(1&e&&(Mt(Ape,5),Mt(Mpe,5),Mt(Fpe,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.dtjobtypes=r.first),xt(r=wt())&&(n.dtunits=r.first)}},inputs:{displayAddModal:"displayAddModal",labourcost:"labourcost",projectID:"projectID",selectedDlgProject:"selectedDlgProject",selectedJobtype:"selectedJobtype",selectedUnit:"selectedUnit"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd"},features:[Nn([Is,kn,Un])],decls:49,vars:43,consts:[["header","Cost Estimation","name","costdialog",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[3,"formGroup"],[1,"p-fluid","formgrid"],[1,"row"],[1,"field","col-12","col-md-6"],["for","name"],[2,"display","flex","align-items","center"],["id","jobtype","name","jobtype","optionValue","id","optionLabel","title","filterBy","title","placeholder","Select Job","appendTo","body","formControlName","jobtype","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange"],["class","custom-dropdown"],["type","button",1,"btn-project","btn-project-icon",3,"click"],["class","p-error block",4,"ngIf"],["id","unit","name","unit","optionValue","id","optionLabel","unit","filterBy","unit","placeholder","Select Unit","appendTo","body","formControlName","unit","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange"],[1,"field","col-12","col-md-10"],["pInputText","","type","text","id","description","name","description","formControlName","description",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","quantity","name","quantity","formControlName","quantity",3,"ngModel","ngModelChange"],["for","unitcost"],["pInputText","","type","number","id","unitcost","name","unitcost","formControlName","unitcost",3,"ngModel","ngModelChange"],["pTemplate","footer"],["header","Job Details","styleClass","p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["header","Unit Details","styleClass","p-fluid",3,"visible","modal","visibleChange"],["position","bottom-right"],[4,"ngIf"],[1,"flex","align-items-center","gap-2"],[1,"p-error","block"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["icon","pi pi-check","type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["icon","pi pi-times","type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-circle"],[1,"p-field"],["for","title"],["pInputText","","type","text","id","title","name","title","formControlName","title",3,"ngModel","ngModelChange"],["type","button",1,"btn-project",3,"disabled","click"],["type","button",1,"btn-project",3,"click"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dtjobtypes",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"],["for","unit"],["pInputText","","type","text","id","unit","name","unit","formControlName","unit",3,"ngModel","ngModelChange"]],template:function(e,n){1&e&&(f(0,"p-dialog",0),L("visibleChange",function(o){return n.displayAddModal=o})("onHide",function(){return n.closeModal()}),f(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),_(6,"Job Type"),p(),f(7,"div",6)(8,"p-dropdown",7),L("ngModelChange",function(o){return n.selectedJobtype=o}),D(9,Ope,1,1,"ng-template",8),D(10,Npe,3,1,"ng-template",8),p(),f(11,"button",9),L("click",function(){return n.newJob()}),_(12,"+ "),p()(),D(13,Lpe,2,0,"small",10),p()(),f(14,"div",3)(15,"div",4)(16,"label",5),_(17,"Unit"),p(),f(18,"div",6)(19,"p-dropdown",11),L("ngModelChange",function(o){return n.selectedUnit=o}),D(20,Bpe,1,1,"ng-template",8),D(21,jpe,3,1,"ng-template",8),p(),f(22,"button",9),L("click",function(){return n.newUnit()}),_(23,"+ "),p()(),D(24,Vpe,2,0,"small",10),p()(),f(25,"div",3)(26,"div",12)(27,"label",5),_(28,"Description"),p(),f(29,"input",13),L("ngModelChange",function(o){return n.labourcost.description=o}),p()()(),f(30,"div",3)(31,"div",12)(32,"label",5),_(33,"Quantity"),p(),f(34,"input",14),L("ngModelChange",function(o){return n.labourcost.quantity=o}),p(),D(35,Upe,2,0,"small",10),p()(),f(36,"div",3)(37,"div",12)(38,"label",15),_(39,"Unit Cost"),p(),f(40,"input",16),L("ngModelChange",function(o){return n.labourcost.unit_cost=o}),p(),D(41,Hpe,2,0,"small",10),p()()()(),D(42,zpe,8,1,"ng-template",17),p(),f(43,"p-dialog",18),L("visibleChange",function(o){return n.jobDialog=o}),D(44,Qpe,18,10,"ng-template",19),p(),f(45,"p-dialog",20),L("visibleChange",function(o){return n.unitDialog=o}),D(46,ohe,18,10,"ng-template",19),p(),ee(47,"p-confirmDialog")(48,"p-toast",21)),2&e&&(Ft(rt(37,she)),T("visible",n.displayAddModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("formGroup",n.labourCostForm),v(7),Ft(rt(38,l9)),T("options",n.jobtypes)("filter",!0)("showClear",!0)("ngModel",n.selectedJobtype),v(5),T("ngIf",n.labourCostForm.controls.jobtype.invalid&&n.labourCostForm.controls.jobtype.dirty),v(6),Ft(rt(39,l9)),T("options",n.units)("filter",!0)("showClear",!0)("ngModel",n.selectedUnit),v(5),T("ngIf",n.labourCostForm.controls.unit.invalid&&n.labourCostForm.controls.unit.dirty),v(5),T("ngModel",n.labourcost.description),v(5),T("ngModel",n.labourcost.quantity),v(1),T("ngIf",n.labourCostForm.controls.quantity.invalid&&n.labourCostForm.controls.quantity.dirty),v(5),T("ngModel",n.labourcost.unit_cost),v(1),T("ngIf",n.labourCostForm.controls.unitcost.invalid&&n.labourCostForm.controls.unitcost.dirty),v(2),Ft(rt(40,ahe)),T("visible",n.jobDialog)("modal",!0),v(2),Ft(rt(41,lhe)),T("visible",n.unitDialog)("modal",!0),v(2),Ft(rt(42,che)))},directives:[ms,Hr,Ur,Pr,us,Er,zr,Sn,Ir,li,qo,zn,ki,_r,mo,fr],styles:[".custom-dropdown[_ngcontent-%COMP%]{width:220px;height:60px;margin-right:10px}.dropdown-container[_ngcontent-%COMP%]{display:flex}"]}),t})();const dhe=["dt"];function fhe(t,i){if(1&t){const e=Ie();f(0,"div",8)(1,"span",9),ee(2,"i",10),f(3,"input",11),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function phe(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),f(3,"th"),_(4," Description"),p(),f(5,"th"),_(6,"Total Cost"),p()())}function hhe(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2),p(),f(3,"td"),_(4),p(),f(5,"td"),_(6),Ne(7,"currency"),p()()),2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(2),U(e.title),v(2),U(He(7,3,e.totalcost," ","symbol","1.0-0"))}}function mhe(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td")(2,"td"),f(3,"td"),_(4),Ne(5,"currency"),p(),f(6,"td")(7,"button",12),L("click",function(){return z(e),A().exportTableToExcel()}),_(8,"Excel"),p(),f(9,"button",13),L("click",function(){return z(e),A().exportTableToPdf()}),_(10,"Pdf"),p()()()}if(2&t){const e=A();v(4),hn("Total: ",He(5,1,e.totalcost," ","symbol","1.0-0"),"")}}function ghe(t,i){1&t&&(f(0,"div",14),_(1,"No data found"),p())}const _he=function(){return{width:"60vw"}},vhe=function(){return["title","description"]};let yhe=(()=>{class t{constructor(e,n){this.pdfserv=e,this.exptoexcel=n,this.clickSummaryClose=new Et,this.labourcostsummary=[],this.displaySummaryModal=!1,this.totalcost=0,this.headerData=["Description","Total Cost"]}ngOnInit(){}closeModal(){this.clickSummaryClose.emit(!0)}isSummaryEmpty(){return 0===this.labourcostsummary.length}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],"LabourSheetSummary_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"LabourSheetSummary_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.labourcostsummary.length;n++)e.push([this.labourcostsummary[n].title,Number(this.labourcostsummary[n].totalcost).toLocaleString()]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.labourcostsummary.length;n++)e.push([this.labourcostsummary[n].title,Number(this.labourcostsummary[n].totalcost).toLocaleString()]);return e}toPdfFooterFormat(){let e=[];return e.push(["Total",this.totalcost.toLocaleString()]),e}toExcelFooterFormat(e){return e.push(["","",""]),e.push(["Total",this.totalcost.toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-labourcostsummary"]],viewQuery:function(e,n){if(1&e&&Mt(dhe,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{labourcostsummary:"labourcostsummary",displaySummaryModal:"displaySummaryModal",totalcost:"totalcost"},outputs:{clickSummaryClose:"clickSummaryClose"},decls:8,vars:14,consts:[["header","Labour Sheet Summary","name","costdialog",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-primary",2,"margin-left","5px",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"p-dialog",0),L("visibleChange",function(o){return n.displaySummaryModal=o})("onHide",function(){return n.closeModal()}),f(1,"p-table",1,2),D(3,fhe,4,0,"ng-template",3),D(4,phe,7,0,"ng-template",4),D(5,hhe,8,8,"ng-template",5),D(6,mhe,11,6,"ng-template",6),p(),D(7,ghe,2,0,"div",7),p()),2&e&&(Ft(rt(12,_he)),T("visible",n.displaySummaryModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("value",n.labourcostsummary)("paginator",!0)("rows",10)("globalFilterFields",rt(13,vhe)),v(6),T("ngIf",n.isSummaryEmpty()))},directives:[ms,ki,zn,li,Sn],pipes:[dr],styles:[""]}),t})();const bhe=["dt"];function xhe(t,i){if(1&t){const e=Ie();f(0,"div",13)(1,"span",14),ee(2,"i",15),f(3,"input",16),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function whe(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Che(t,i){1&t&&(f(0,"th"),_(1,"JobID"),p())}function The(t,i){1&t&&(f(0,"th"),_(1,"UnitID"),p())}function She(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,whe,2,0,"th",17),D(4,Che,2,0,"th",17),f(5,"th"),_(6,"Job Title"),p(),f(7,"th"),_(8," Description"),p(),D(9,The,2,0,"th",17),f(10,"th"),_(11,"Unit"),p(),f(12,"th"),_(13,"Quantity"),p(),f(14,"th"),_(15,"Unit Cost (Rs.)"),p(),f(16,"th"),_(17,"Total Cost (Rs.)"),p(),f(18,"th"),_(19,"Action"),p()()),2&t&&(v(3),T("ngIf",!1),v(1),T("ngIf",!1),v(5),T("ngIf",!1))}function Ehe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function khe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.jobid)}}function Dhe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.unitid)}}function Ihe(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Ehe,2,1,"td",17),D(4,khe,2,1,"td",17),f(5,"td"),_(6),p(),f(7,"td"),_(8),p(),D(9,Dhe,2,1,"td",17),f(10,"td"),_(11),p(),f(12,"td"),_(13),p(),f(14,"td"),_(15),Ne(16,"currency"),p(),f(17,"td"),_(18),Ne(19,"currency"),p(),f(20,"td")(21,"button",18),L("click",function(){const o=z(e).$implicit;return A().updateLabourCost(o)}),p(),_(22," \xa0"),f(23,"button",19),L("click",function(){const o=z(e).$implicit;return A().deleteLabourCost(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(2),U(e.jobtype),v(2),U(e.description),v(1),T("ngIf",!1),v(2),U(e.unit),v(2),U(e.quantity),v(2),U(He(16,10,e.unit_cost," ","symbol","1.0-0")),v(3),U(He(19,15,e.total_cost," ","symbol","1.0-0"))}}function Ahe(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td")(2,"td")(3,"td")(4,"td")(5,"td"),f(6,"td"),_(7,"Total:"),p(),f(8,"td"),_(9),Ne(10,"currency"),p(),f(11,"td")(12,"button",20),L("click",function(){return z(e),A().exportTableToExcel()}),_(13,"Excel"),p(),f(14,"button",20),L("click",function(){return z(e),A().exportTableToPdf()}),_(15,"Pdf"),p()()()}if(2&t){const e=A();v(9),hn(" ",He(10,1,e.sumoftotalcost," ","symbol","1.0-0"),"")}}function Mhe(t,i){1&t&&(f(0,"div",21),_(1,"No data found"),p())}const Fhe=function(){return["jobtype","description"]},Phe=function(){return{width:"450px"}};let c9=(()=>{class t{constructor(e,n,r,o,c,u,m){this._lcs=e,this.dialogService=n,this._ms=r,this._ps=o,this.confirmationService=c,this.pdfserv=u,this.exptoexcel=m,this.projectID=0,this.totalcost=0,this.labourcosts=[],this.labourcostsummary=[],this.displayDialog=!1,this.displayAddModal=!1,this.displaySummaryDialog=!1,this.displaySummaryModal=!1,this.sumoftotalcost=0,this.headerData=["Job Title","Description","Unit","Quantity","Unit Cost (Rs.)","Total Cost (Rs.)"]}ngOnInit(){}loadData(e){this.sumoftotalcost=0,this._lcs.getLabourCostWithProject(this.projectID.toString()).subscribe({next:n=>{this.labourcosts=n,n.forEach(r=>{this.sumoftotalcost=Number(this.sumoftotalcost)+Number(r.total_cost)})},error:n=>{console.error(n)}})}getProjects(){this._ps.getProjectsCombo().subscribe(e=>{this.projects=e,this.selectedProject=this.projects[0],this.onDropdownChange()},e=>{console.log(e)})}onDropdownChange(){this.sumoftotalcost=0,this._lcs.getLabourCostWithProject(this.projectID.toString()).subscribe({next:e=>{this.labourcosts=e,e.forEach(n=>{this.sumoftotalcost=Number(this.sumoftotalcost)+Number(n.total_cost)})},error:e=>{console.error(e)}})}onChange(e){this._lcs.getLabourCostWithProject(e.value.id).subscribe({next:n=>{this.labourcosts=n},error:n=>{console.error(n)}})}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}getLabourCost(){this._lcs.getLabourCost().subscribe({next:e=>{this.labourcosts=e},error:e=>{console.error(e)}})}isProjectsEmpty(){return 0===this.labourcosts.length}showAddLabourDialog(){this.labourcost={id:"",jobid:"",jobtype:"",project:"",unitid:"",unit:"",description:"",quantity:"",unitcost:"",totalcost:""},this.selectedJobtype="",this.selectedUnit="",this.displayAddModal=!0}hideAddModal(e){this.displayAddModal=!e}hideSummaryModal(e){this.displaySummaryModal=!e}updateLabourSheetList(e){this.onDropdownChange()}updateLabourCost(e){this.labourcost=Object.assign({},e),this.selectedJobtype=this.labourcost.jobid,this.selectedUnit=this.labourcost.unitid,this.displayAddModal=!0}deleteLabourCost(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._lcs.deleteLabourCost(e.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Labour cost deleted successfully.",life:3e3}),this.onDropdownChange()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting labour cost.",life:3e3})}})}})}showSummary(){this.totalcost=0,this._lcs.getLabourCostSummary(this.projectID.toString()).subscribe({next:e=>{e.forEach(n=>{this.totalcost=this.totalcost+n.totalcost}),this.labourcostsummary=e},error:e=>{console.error(e)}}),this.displaySummaryModal=!0}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],"QuantityEstimation_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"QuantityEstimation_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.labourcosts.length;n++)e.push([this.labourcosts[n].jobtype,this.labourcosts[n].description,this.labourcosts[n].unit,this.labourcosts[n].quantity,Number(this.labourcosts[n].unit_cost).toLocaleString(),Number(this.labourcosts[n].total_cost).toLocaleString()]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.labourcosts.length;n++)e.push([this.labourcosts[n].jobtype,this.labourcosts[n].description,this.labourcosts[n].unit,this.labourcosts[n].quantity,Number(this.labourcosts[n].unit_cost).toLocaleString(),Number(this.labourcosts[n].total_cost).toLocaleString()]);return e}toPdfFooterFormat(){let e=[];return e.push(["","","","","Total",this.sumoftotalcost.toLocaleString()]),e}toExcelFooterFormat(e){return e.push(["","","","","",""]),e.push(["","","","","Total",this.sumoftotalcost.toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(gM),te(Is),te(kn),te(ll),te(Un),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-quantityestimation"]],viewQuery:function(e,n){if(1&e&&Mt(bhe,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{projectID:"projectID",labourcosts:"labourcosts",sumoftotalcost:"sumoftotalcost"},features:[Nn([Is,kn,Un])],decls:17,vars:17,consts:[[1,"project-btn-group","project-btn-group--spaced"],[1,"btn-project",3,"click"],[1,"bi","bi-plus-lg"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],[2,"width","600px",3,"displayAddModal","labourcost","selectedJobtype","selectedUnit","projectID","clickClose","clickAdd"],[2,"width","600px",3,"displaySummaryModal","totalcost","labourcostsummary","clickSummaryClose"],["position","bottom-right"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[4,"ngIf"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[1,"btn-project","btn-sm",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"div",0)(1,"button",1),L("click",function(){return n.showAddLabourDialog()}),ee(2,"i",2),_(3," Add New\n"),p(),f(4,"button",1),L("click",function(){return n.showSummary()}),_(5,"Summary"),p()(),f(6,"p-table",3,4),D(8,xhe,4,0,"ng-template",5),D(9,She,20,3,"ng-template",6),D(10,Ihe,24,20,"ng-template",7),D(11,Ahe,16,6,"ng-template",8),p(),D(12,Mhe,2,0,"div",9),f(13,"app-addeditlaboursheet",10),L("clickClose",function(o){return n.hideAddModal(o)})("clickAdd",function(o){return n.updateLabourSheetList(o)}),p(),f(14,"app-labourcostsummary",11),L("clickSummaryClose",function(o){return n.hideSummaryModal(o)}),p(),ee(15,"p-confirmDialog")(16,"p-toast",12)),2&e&&(v(6),T("value",n.labourcosts)("paginator",!0)("rows",10)("globalFilterFields",rt(15,Fhe)),v(6),T("ngIf",n.isProjectsEmpty()),v(1),T("displayAddModal",n.displayAddModal)("labourcost",n.labourcost)("selectedJobtype",n.selectedJobtype)("selectedUnit",n.selectedUnit)("projectID",n.projectID),v(1),T("displaySummaryModal",n.displaySummaryModal)("totalcost",n.totalcost)("labourcostsummary",n.labourcostsummary),v(1),Ft(rt(16,Phe)))},directives:[ki,zn,li,Sn,_r,uhe,yhe,mo,fr],pipes:[dr],styles:[""]}),t})();const Ohe=["dt"];function Nhe(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedInvestor.name)}}function Lhe(t,i){1&t&&D(0,Nhe,3,1,"div",26),2&t&&T("ngIf",A().selectedInvestor)}function Rhe(t,i){if(1&t&&(f(0,"div",27)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.name)}}function Bhe(t,i){1&t&&(f(0,"small",28),_(1," Investor is required. "),p())}function jhe(t,i){1&t&&(f(0,"small",28),_(1," Amount is required. "),p())}function Vhe(t,i){1&t&&(f(0,"small",28),_(1," Office Share is required. "),p())}function Uhe(t,i){if(1&t){const e=Ie();f(0,"div",29)(1,"span",30),ee(2,"i",31),f(3,"input",32),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function Hhe(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function zhe(t,i){1&t&&(f(0,"th"),_(1,"InvestorID"),p())}function $he(t,i){1&t&&(f(0,"th"),_(1,"OfficeShare"),p())}function Whe(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,Hhe,2,0,"th",26),D(4,zhe,2,0,"th",26),D(5,$he,2,0,"th",26),f(6,"th"),_(7,"Investor"),p(),f(8,"th"),_(9,"Amount"),p(),f(10,"th"),_(11,"Action"),p()()),2&t&&(v(3),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1))}function qhe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Ghe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.investorid)}}function Khe(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.officeshare)}}function Yhe(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,qhe,2,1,"td",26),D(4,Ghe,2,1,"td",26),D(5,Khe,2,1,"td",26),f(6,"td"),_(7),p(),f(8,"td"),_(9),Ne(10,"currency"),p(),f(11,"td")(12,"button",33),L("click",function(){const o=z(e).$implicit;return A().editContribution(o)}),p(),f(13,"button",34),L("click",function(){const o=z(e).$implicit;return A().deleteContribution(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(2),U(e.investor),v(2),U(He(10,6,e.contributions," ","symbol","1.0-0"))}}function Xhe(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td"),f(2,"td"),_(3,"Total:"),p(),f(4,"td"),_(5),Ne(6,"currency"),p(),f(7,"td")(8,"button",35),L("click",function(){return z(e),A().exportTableToExcel()}),_(9,"Excel"),p(),f(10,"button",35),L("click",function(){return z(e),A().exportTableToPdf()}),_(11,"Pdf"),p()()()}if(2&t){const e=A();v(5),U(He(6,1,e.total_contributions," ","symbol","1.0-0"))}}function Qhe(t,i){1&t&&(f(0,"div",36),_(1,"No data found"),p())}const Jhe=function(){return{width:"100%"}},Zhe=function(){return["investor"]},eme=function(){return{width:"450px"}};let tme=(()=>{class t{constructor(e,n,r,o,c,u,m){this._ms=e,this._ps=n,this._cs=r,this._is=o,this.confirmationService=c,this.pdfserv=u,this.exptoexcel=m,this.contribution=[],this.total_contributions=0,this.total_contribution=0,this.headerData=["Investor","Amount"]}ngOnInit(){this.investorForm=new Zn({project:new Me(""),investor:new Me("",jt.required),contributions:new Me("",jt.required),budget:new Me(""),officeshare:new Me("",jt.required)}),this.inv_contribution={id:"",project:"",investorid:"",investor:"",contributions:"",profit:"",investorshare:"",officeshare:"",budget:""},this.loadInvestors()}formatBudget(){return new Intl.NumberFormat("en-US",{style:"currency",currency:"PKR",minimumFractionDigits:2}).format(this._budget)}loadInvestors(){this._is.getInvestorsCombo().subscribe(e=>{this.investors=e},e=>{console.log(e)})}loadContributions(){this.total_contributions=0,this._cs.getContributions(this.projectID.toString()).subscribe({next:e=>{this.contribution=e,this.contribution.forEach(n=>{this.total_contributions=this.total_contributions+Number(n.contributions)})},error:e=>{console.error(e)}})}isContributionEmpty(){return 0===this.contribution.length}addContribution(e){this.investorForm.value.project=this.projectID,this.investorForm.value.investor=this.selectedInvestor,this.total_contribution=0,this.contribution.forEach(n=>{this.total_contribution=Number(this.total_contribution)+Number(n.contribution)}),this.inv_contribution.id?(this.investorForm.value.investor=this.selectedInvestor,this.investorForm.value.id=this.inv_contribution.id,this.investorForm.value.officeshare=this.inv_contribution.officeshare,this.investorForm.value.contributions=this.inv_contribution.contributions,this._cs.updateContribution(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Contribution is updated successfully."}),this.resetForm(),this.inv_contribution={},this.loadContributions()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while updating contribution."})}})):(this.investorForm.value.investor=this.selectedInvestor,this._cs.addContribution(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Contribution is saved successfully."}),this.resetForm(),this.selectedInvestor=0,this.loadContributions()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"error",summary:"Error",detail:"Error occurred while saving contribution."})}}))}editContribution(e){this.inv_contribution=Object.assign({},e),this.selectedInvestor=this.inv_contribution.investorid}deleteContribution(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._cs.deleteContribution(e.id).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Contribution deleted successfully.",life:3e3}),this.loadContributions()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting contribution.",life:3e3})}})}})}resetForm(){const{budget:e}=this.investorForm.value;this.investorForm.reset({budget:e})}applyFilterGlobal(e,n){console.log(n),this.dt.filterGlobal(e.target.value,n)}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],"Project-Contributions_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"Project-Contributions_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.contribution.length;n++)e.push([this.contribution[n].investor,this.contribution[n].contributions.toLocaleString()]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.contribution.length;n++)e.push([this.contribution[n].investor,this.contribution[n].contributions.toLocaleString()]);return e}toPdfFooterFormat(){let e=[];return e.push(["","","","Total",this.total_contributions.toLocaleString()]),e}toExcelFooterFormat(e){return e.push(["","","","","",""]),e.push(["Total",this.total_contributions.toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(ll),te(i_),te(r_),te(Un),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-contributions"]],viewQuery:function(e,n){if(1&e&&Mt(Ohe,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{contribution:"contribution",total_contributions:"total_contributions",projectID:"projectID",_budget:"_budget"},features:[Nn([Is,kn,Un])],decls:44,vars:23,consts:[[3,"formGroup"],[1,"row"],[1,"col-lg-3","col-md-3","col-sm-3"],[1,"form-group"],["for","budget",2,"margin-right","10px"],["pInputText","","type","text","id","budget","name","budget","formControlName","budget","readonly","",1,"form-control",3,"ngModel","ngModelChange"],["for","contributions",2,"margin-right","10px"],["id","investor","name","investor","optionLabel","name","optionValue","id","filterBy","name","placeholder","Select Investor","appendTo","body","autoWidth","false","formControlName","investor",3,"options","ngModel","filter","ngModelChange"],["class","custom-dropdown"],["class","p-error block",4,"ngIf"],["pInputText","","type","number","id","contributions","name","contributions","formControlName","contributions",1,"form-control",3,"ngModel","ngModelChange"],["for","officeshare",2,"margin-right","10px"],["pInputText","","type","number","id","officeshare","name","officeshare","formControlName","officeshare",1,"form-control",3,"ngModel","ngModelChange"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-circle"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],["position","bottom-right"],[4,"ngIf"],[1,"flex","align-items-center","gap-2"],[1,"p-error","block"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[1,"btn-project","btn-sm",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),_(5,"Total Project Budget"),p(),f(6,"input",5),L("ngModelChange",function(o){return n._budget=o}),p()()(),f(7,"div",2)(8,"div",3)(9,"label",6),_(10,"Investor"),p(),f(11,"p-dropdown",7),L("ngModelChange",function(o){return n.selectedInvestor=o}),D(12,Lhe,1,1,"ng-template",8),D(13,Rhe,3,1,"ng-template",8),p(),D(14,Bhe,2,0,"small",9),p()(),f(15,"div",2)(16,"div",3)(17,"label",6),_(18,"Amount (Rs.)"),p(),f(19,"input",10),L("ngModelChange",function(o){return n.inv_contribution.contributions=o}),p(),D(20,jhe,2,0,"small",9),p()(),f(21,"div",2)(22,"div",3)(23,"label",11),_(24,"Office Share (%)"),p(),f(25,"input",12),L("ngModelChange",function(o){return n.inv_contribution.officeshare=o}),p(),D(26,Vhe,2,0,"small",9),p()()(),f(27,"div",13)(28,"button",14),L("click",function(){return n.addContribution(n.investorForm)}),ee(29,"i",15),_(30,"Save"),p(),f(31,"button",16),L("click",function(){return n.resetForm()}),ee(32,"i",17),_(33,"Clear"),p()()(),ee(34,"hr"),f(35,"p-table",18,19),D(37,Uhe,4,0,"ng-template",20),D(38,Whe,12,3,"ng-template",21),D(39,Yhe,14,11,"ng-template",22),D(40,Xhe,12,6,"ng-template",23),p(),D(41,Qhe,2,0,"div",24),ee(42,"p-toast",25)(43,"p-confirmDialog")),2&e&&(T("formGroup",n.investorForm),v(6),T("ngModel",n._budget),v(5),Ft(rt(20,Jhe)),T("options",n.investors)("ngModel",n.selectedInvestor)("filter",!0),v(3),T("ngIf",n.investorForm.controls.investor.invalid&&n.investorForm.controls.investor.dirty),v(5),T("ngModel",n.inv_contribution.contributions),v(1),T("ngIf",n.investorForm.controls.contributions.invalid&&n.investorForm.controls.contributions.dirty),v(5),T("ngModel",n.inv_contribution.officeshare),v(1),T("ngIf",n.investorForm.controls.officeshare.invalid&&n.investorForm.controls.officeshare.dirty),v(2),T("disabled",n.investorForm.invalid),v(7),T("value",n.contribution)("paginator",!0)("rows",10)("globalFilterFields",rt(21,Zhe)),v(6),T("ngIf",n.isContributionEmpty()),v(2),Ft(rt(22,eme)))},directives:[Hr,Ur,Pr,Ir,li,Er,zr,us,Sn,qo,ki,zn,_r,fr,mo],pipes:[dr],styles:[""]}),t})();const nme=["dt"];function ime(t,i){if(1&t){const e=Ie();f(0,"div",9)(1,"span",10),ee(2,"i",11),f(3,"input",12),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function rme(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function ome(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,rme,2,0,"th",13),f(4,"th"),_(5,"Investor"),p(),f(6,"th"),_(7,"Project Cost"),p(),f(8,"th"),_(9,"Sale Price"),p(),f(10,"th"),_(11,"Net Profit"),p(),f(12,"th"),_(13,"Contribution"),p(),f(14,"th"),_(15,"Investor Share"),p(),f(16,"th"),_(17,"Office Share"),p(),f(18,"th"),_(19,"Amount"),p()()),2&t&&(v(3),T("ngIf",!1))}function sme(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2),p(),f(3,"td"),_(4),p(),f(5,"td"),_(6),Ne(7,"currency"),p(),f(8,"td"),_(9),Ne(10,"currency"),p(),f(11,"td"),_(12),Ne(13,"currency"),p(),f(14,"td"),_(15),Ne(16,"currency"),p(),f(17,"td"),_(18),Ne(19,"currency"),p(),f(20,"td"),_(21),p(),f(22,"td"),_(23),Ne(24,"currency"),p()()),2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(2),U(e.investor),v(2),U(He(7,9,e.cost," ","symbol","1.0-0")),v(3),U(He(10,14,e.price," ","symbol","1.0-0")),v(3),U(He(13,19,e.netprofit," ","symbol","1.0-0")),v(3),U(He(16,24,e.contributions," ","symbol","1.0-0")),v(3),U(He(19,29,e.investorshare," ","symbol","1.0-0")),v(3),hn("",e.officepercentage," %"),v(2),hn("",He(24,34,e.officeshare," ","symbol","1.0-0")," ")}}function ame(t,i){if(1&t&&(f(0,"tr"),ee(1,"td")(2,"td")(3,"td")(4,"td")(5,"td"),f(6,"td"),_(7,"Total:"),p(),f(8,"td"),_(9),Ne(10,"currency"),p(),ee(11,"td"),f(12,"td"),_(13),Ne(14,"currency"),p()()),2&t){const e=A();v(9),U(He(10,2,e.total_investor_share," ","symbol","1.0-0")),v(4),U(He(14,7,e.total_office_share," ","symbol","1.0-0"))}}function lme(t,i){1&t&&(f(0,"div",14),_(1,"No data found"),p())}const cme=function(){return["investor"]};let ume=(()=>{class t{constructor(e,n){this.pdfserv=e,this.exptoexcel=n,this.profitdistribution=[],this.total_investor_share=0,this.total_office_share=0,this.headerData=["Investor","Project Cost","Sale Price","Net Profit","Contribution","Investor Share","Office Share","Amount"]}ngOnInit(){}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}isProfitEmpty(){return 0===this.profitdistribution.length}exportTableToExcel(){const e=this.toExcelFormat();this.toExcelFooterFormat(e),this.exptoexcel.exportExcel(e,this.headerData,[],"Projects_Distribution"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"Projects_Distribution"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.profitdistribution.length;n++)e.push([this.profitdistribution[n].investor,this.profitdistribution[n].cost.toLocaleString(),this.profitdistribution[n].price.toLocaleString(),this.profitdistribution[n].netprofit.toLocaleString(),this.profitdistribution[n].contributions.toLocaleString(),Math.round(this.profitdistribution[n].investorshare).toLocaleString(),this.profitdistribution[n].officepercentage+"%",Math.round(this.profitdistribution[n].officeshare).toLocaleString()]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.profitdistribution.length;n++)e.push([this.profitdistribution[n].investor,this.profitdistribution[n].cost.toLocaleString(),this.profitdistribution[n].price.toLocaleString(),this.profitdistribution[n].netprofit.toLocaleString(),this.profitdistribution[n].contributions.toLocaleString(),Math.round(this.profitdistribution[n].investorshare).toLocaleString(),this.profitdistribution[n].officepercentage+"%",Math.round(this.profitdistribution[n].officeshare).toLocaleString()]);return e}toPdfFooterFormat(){let e=[];return e.push(["","","","","Total",Math.round(this.total_investor_share).toLocaleString(),"",Math.round(this.total_office_share).toLocaleString()]),e}toExcelFooterFormat(e){return e.push(["","","","","",""]),e.push(["","","","","Total",Math.round(this.total_investor_share).toLocaleString(),"",Math.round(this.total_office_share).toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-profitdistribution"]],viewQuery:function(e,n){if(1&e&&Mt(nme,5),2&e){let r;xt(r=wt())&&(n.dt=r.first)}},inputs:{profitdistribution:"profitdistribution",total_investor_share:"total_investor_share",total_office_share:"total_office_share"},decls:12,vars:6,consts:[["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],[1,"project-btn-group","project-btn-group--right","project-btn-group--spaced"],[1,"btn-project","btn-sm",3,"click"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[4,"ngIf"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"p-table",0,1),D(2,ime,4,0,"ng-template",2),D(3,ome,20,1,"ng-template",3),D(4,sme,25,39,"ng-template",4),D(5,ame,15,12,"ng-template",5),p(),D(6,lme,2,0,"div",6),f(7,"div",7)(8,"button",8),L("click",function(){return n.exportTableToExcel()}),_(9,"Excel"),p(),f(10,"button",8),L("click",function(){return n.exportTableToPdf()}),_(11,"Pdf"),p()()),2&e&&(T("value",n.profitdistribution)("paginator",!0)("rows",10)("globalFilterFields",rt(5,cme)),v(6),T("ngIf",n.isProfitEmpty()))},directives:[ki,zn,li,Sn],pipes:[dr],styles:[""]}),t})();const dme=["dt"],fme=["dtProfit"];function pme(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function hme(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,pme,2,0,"th",47),f(4,"th"),_(5,"Investor"),p(),f(6,"th"),_(7,"Contribution"),p()()),2&t&&(v(3),T("ngIf",!1))}function mme(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function gme(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2),p(),D(3,mme,2,1,"td",47),f(4,"td"),_(5),p(),f(6,"td",48),_(7),Ne(8,"currency"),p()()),2&t){const e=i.$implicit,n=i.rowIndex,r=A();v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.investor||"N/A"),v(2),U(He(8,4,r.toNumber(e.contributions)," ","symbol","1.0-0"))}}function _me(t,i){1&t&&(f(0,"div",49),ee(1,"i",50),f(2,"p"),_(3,"No investment data found"),p()())}function vme(t,i){if(1&t){const e=Ie();f(0,"div",51)(1,"span",52),ee(2,"i",53),f(3,"input",54),L("input",function(r){return z(e),A().applyFilterGlobalProfit(r,"contains")}),p()()()}}function yme(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function bme(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,yme,2,0,"th",47),f(4,"th"),_(5,"Investor"),p(),f(6,"th"),_(7,"Project Cost"),p(),f(8,"th"),_(9,"Sale Price"),p(),f(10,"th"),_(11,"Net Profit"),p(),f(12,"th"),_(13,"Contribution"),p(),f(14,"th"),_(15,"Investor Share"),p(),f(16,"th"),_(17,"Office Share"),p(),f(18,"th"),_(19,"Amount"),p()()),2&t&&(v(3),T("ngIf",!1))}function xme(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2),p(),f(3,"td"),_(4),p(),f(5,"td",48),_(6),Ne(7,"currency"),p(),f(8,"td",48),_(9),Ne(10,"currency"),p(),f(11,"td",48),_(12),Ne(13,"currency"),p(),f(14,"td",48),_(15),Ne(16,"currency"),p(),f(17,"td",55),_(18),Ne(19,"currency"),p(),f(20,"td"),_(21),p(),f(22,"td",48),_(23),Ne(24,"currency"),p()()),2&t){const e=i.$implicit,n=i.rowIndex,r=A();v(2),U(n+1),v(2),U(e.investor||"N/A"),v(2),U(He(7,13,r.toNumber(e.cost)," ","symbol","1.0-0")),v(3),U(He(10,18,r.toNumber(e.price)," ","symbol","1.0-0")),v(2),po("positive",r.toNumber(e.netprofit)>=0)("negative",r.toNumber(e.netprofit)<0),v(1),hn(" ",He(13,23,r.toNumber(e.netprofit)," ","symbol","1.0-0")," "),v(3),U(He(16,28,r.toNumber(e.contributions)," ","symbol","1.0-0")),v(3),U(He(19,33,r.toNumber(e.investorshare)," ","symbol","1.0-0")),v(3),hn("",e.officepercentage||"0"," %"),v(2),U(He(24,38,r.toNumber(e.officeshare)," ","symbol","1.0-0"))}}function wme(t,i){1&t&&(f(0,"div",49),ee(1,"i",50),f(2,"p"),_(3,"No profit distribution data found"),p()())}const Cme=function(){return["investor"]};let Tme=(()=>{class t{constructor(e,n,r,o){this._cs=e,this.proj_Service=n,this.pdfserv=r,this.exptoexcel=o,this.contribution=[],this.estimatedcost="",this.budget=0,this.spent=0,this.remaining=0,this.totalprice=0,this.totalcost=0,this.netprofit=0,this.profitdistribution=[],this.projects=[]}ngOnInit(){this.loadContributions()}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}loadContributions(){this._cs.getContributions(this.projectID.toString()).subscribe({next:e=>{this.contribution=e},error:e=>{console.error(e)}})}applyFilterGlobalProfit(e,n){this.dtProfit.filterGlobal(e.target.value,n)}isProfitEmpty(){return 0===this.profitdistribution.length}isContributionEmpty(){return 0===this.contribution.length}toNumber(e){if(null==e||""===e)return 0;if("number"==typeof e)return e;if("string"==typeof e){const n=e.toString().replace(/,/g,"").replace(/\s/g,"").trim(),r=Number(n);return isNaN(r)?0:r}return Number(e)||0}exportTableToExcel(){const e=this.toExcelFormat();this.exptoexcel.exportExcel(e,[],[],"ProjectSummary_"+ui())}exportTableToPdf(){const e=this.toPdfFormat();this.pdfserv.generatePdf([],e,[],"ProjectSummary_"+ui())}toExcelFormat(){let e=[];e.push(["Project Details"]),e.push(["Name:",this.projectDetails[0].project_name]),e.push(["Status:",this.projectDetails[0].status]),e.push(["Covered Area:",this.projectDetails[0].coveredarea]),e.push(["Total Project Cost:",Number(this.projectDetails[0].totalcost).toLocaleString()]),e.push(["Start Date:",Qr(this.projectDetails[0].startdate)]),e.push(null!=this.projectDetails[0].enddate?["End Date:",Qr(this.projectDetails[0].enddate)]:["End Date:",""]),e.push(["","",""]),e.push(["Total Estimated Cost:",Number(this.estimatedcost).toLocaleString(),"",""]),e.push(["","",""]),e.push(["Total Investment","",""]),e.push(["Investor","Contribtuion"]);for(var n=0;n<this.contribution.length;n++)e.push([this.contribution[n].investor,Number(this.contribution[n].contributions).toLocaleString()]);for(e.push(["","",""]),e.push(["Project Cost","",""]),e.push(["Budget:",Number(this.budget).toLocaleString(),"Remaining:",Number(this.remaining).toLocaleString(),""]),e.push(["Project Sale","",""]),e.push(["Seling Date:",this.obj_sellingdate,"Total Cost:",Number(this.totalcost).toLocaleString(),"Net Profit:",Number(this.netprofit).toLocaleString()]),e.push(["Profit Distribution","",""]),e.push(["Investor","Project Cost","Sale Price","Net Profit","Contribution","Investor Share","Office Share","Amount"]),n=0;n<this.profitdistribution.length;n++)e.push([this.profitdistribution[n].investor,Number(this.profitdistribution[n].cost).toLocaleString(),Number(this.profitdistribution[n].price).toLocaleString(),Number(this.profitdistribution[n].netprofit).toLocaleString(),Number(this.profitdistribution[n].contributions).toLocaleString(),Number(this.profitdistribution[n].investorshare).toLocaleString(),this.profitdistribution[n].officepercentage+"%",Number(this.profitdistribution[n].officeshare).toLocaleString()]);return e}toPdfFormat(){let e=[];e.push(["Project Details"]),e.push(["Name:",this.projectDetails[0].project_name]),e.push(["Status:",this.projectDetails[0].status]),e.push(["Covered Area:",this.projectDetails[0].coveredarea]),e.push(["Total Project Cost:",Number(this.projectDetails[0].totalcost).toLocaleString()]),e.push(["Start Date:",Qr(this.projectDetails[0].startdate)]),e.push(null!=this.projectDetails[0].enddate?["End Date:",Qr(this.projectDetails[0].enddate)]:["End Date:",""]),e.push(["","",""]),e.push(["Total Estimated Cost:",Number(this.estimatedcost).toLocaleString(),"",""]),e.push(["","",""]),e.push(["Total Investment","",""]),e.push(["Investor","Contribtuion"]);for(var n=0;n<this.contribution.length;n++)e.push([this.contribution[n].investor,Number(this.contribution[n].contributions).toLocaleString()]);for(e.push(["","",""]),e.push(["Project Cost","",""]),e.push(["Budget:",Number(this.budget).toLocaleString(),"Remaining:",Number(this.remaining).toLocaleString(),""]),e.push(["Project Sale","",""]),e.push(["Seling Date:",this.obj_sellingdate,"Total Cost:",Number(this.totalcost).toLocaleString(),"Net Profit:",Number(this.netprofit).toLocaleString()]),e.push(["Profit Distribution","",""]),e.push(["Investor","Project Cost","Sale Price","Net Profit","Contribution","Investor Share","Office Share","Amount"]),n=0;n<this.profitdistribution.length;n++)e.push([this.profitdistribution[n].investor,Number(this.profitdistribution[n].cost).toLocaleString(),Number(this.profitdistribution[n].price).toLocaleString(),Number(this.profitdistribution[n].netprofit).toLocaleString(),Number(this.profitdistribution[n].contributions).toLocaleString(),Number(this.profitdistribution[n].investorshare).toLocaleString(),this.profitdistribution[n].officepercentage+"%",Number(this.profitdistribution[n].officeshare).toLocaleString()]);return e}toPdfFooterFormat(){let e=[];return e.push(["Total",this.totalcost.toLocaleString()]),e}toExcelFooterFormat(e){return e.push(["","",""]),e.push(["Total",this.totalcost.toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(i_),te(ll),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-projectsummary"]],viewQuery:function(e,n){if(1&e&&(Mt(dme,5),Mt(fme,5)),2&e){let r;xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.dtProfit=r.first)}},inputs:{contribution:"contribution",projectID:"projectID",estimatedcost:"estimatedcost",budget:"budget",spent:"spent",remaining:"remaining",obj_sellingdate:"obj_sellingdate",totalprice:"totalprice",totalcost:"totalcost",netprofit:"netprofit",profitdistribution:"profitdistribution",projects:"projects",projectDetails:"projectDetails",_landcost:"_landcost",_commission:"_commission",_taxes:"_taxes",_cpca:"_cpca"},decls:162,vars:107,consts:[["id","exportContent",1,"project-summary-wrapper"],[1,"summary-card","project-details-card"],[1,"card-header"],[1,"card-icon","project-icon"],[1,"bi","bi-building"],[1,"card-title"],[1,"card-body"],[1,"detail-grid"],[1,"detail-item"],[1,"detail-label"],[1,"detail-value"],[1,"detail-value","status-badge"],[1,"detail-value","highlight"],[1,"summary-card","investment-card"],[1,"card-icon","investment-icon"],[1,"bi","bi-currency-dollar"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","styleClass"],["dt",""],["pTemplate","header"],["pTemplate","body"],["class","no-data-message",4,"ngIf"],[1,"summary-card","cost-card"],[1,"card-icon","cost-icon"],[1,"bi","bi-cash-stack"],[1,"cost-grid"],[1,"cost-item"],[1,"cost-label"],[1,"cost-value"],[1,"cost-value","spent"],[1,"cost-item","full-width"],[1,"cost-value","highlight"],[1,"summary-card","sale-card"],[1,"card-icon","sale-icon"],[1,"bi","bi-graph-up-arrow"],[1,"sale-grid"],[1,"sale-item"],[1,"sale-label"],[1,"sale-value"],[1,"sale-value","highlight","positive"],[1,"summary-card","profit-card"],[1,"card-icon","profit-icon"],[1,"bi","bi-pie-chart"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields","styleClass"],["dtProfit",""],["pTemplate","caption"],[1,"export-section"],[1,"btn-project","btn-sm",3,"click"],[4,"ngIf"],[1,"amount-cell"],[1,"no-data-message"],[1,"bi","bi-inbox"],[1,"table-search"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search investor...",3,"input"],[1,"amount-cell","positive"]],template:function(e,n){1&e&&(f(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),ee(4,"i",4),p(),f(5,"h3",5),_(6,"Project Details"),p()(),f(7,"div",6)(8,"div",7)(9,"div",8)(10,"span",9),_(11,"Name"),p(),f(12,"span",10),_(13),p()(),f(14,"div",8)(15,"span",9),_(16,"Location"),p(),f(17,"span",10),_(18),p()(),f(19,"div",8)(20,"span",9),_(21,"Status"),p(),f(22,"span",11),_(23),p()(),f(24,"div",8)(25,"span",9),_(26,"Covered Area"),p(),f(27,"span",10),_(28),p()(),f(29,"div",8)(30,"span",9),_(31,"Total Project Cost"),p(),f(32,"span",12),_(33),Ne(34,"currency"),p()(),f(35,"div",8)(36,"span",9),_(37,"Start Date"),p(),f(38,"span",10),_(39),Ne(40,"date"),p()(),f(41,"div",8)(42,"span",9),_(43,"End Date"),p(),f(44,"span",10),_(45),Ne(46,"date"),p()(),f(47,"div",8)(48,"span",9),_(49,"Total Estimated Cost"),p(),f(50,"span",12),_(51),Ne(52,"currency"),p()()()()(),f(53,"div",13)(54,"div",2)(55,"div",14),ee(56,"i",15),p(),f(57,"h3",5),_(58,"Investment"),p()(),f(59,"div",6)(60,"p-table",16,17),D(62,hme,8,1,"ng-template",18),D(63,gme,9,9,"ng-template",19),p(),D(64,_me,4,0,"div",20),p()(),f(65,"div",21)(66,"div",2)(67,"div",22),ee(68,"i",23),p(),f(69,"h3",5),_(70,"Project Cost"),p()(),f(71,"div",6)(72,"div",24)(73,"div",25)(74,"span",26),_(75,"Budget"),p(),f(76,"span",27),_(77),Ne(78,"currency"),p()(),f(79,"div",25)(80,"span",26),_(81,"Spent"),p(),f(82,"span",28),_(83),Ne(84,"currency"),p()(),f(85,"div",25)(86,"span",26),_(87,"Remaining"),p(),f(88,"span",27),_(89),Ne(90,"currency"),p()(),f(91,"div",25)(92,"span",26),_(93,"Land Cost"),p(),f(94,"span",27),_(95),Ne(96,"currency"),p()(),f(97,"div",25)(98,"span",26),_(99,"Commission"),p(),f(100,"span",27),_(101),Ne(102,"currency"),p()(),f(103,"div",25)(104,"span",26),_(105,"Taxes"),p(),f(106,"span",27),_(107),Ne(108,"currency"),p()(),f(109,"div",29)(110,"span",26),_(111,"Cost Per Covered Area"),p(),f(112,"span",30),_(113),Ne(114,"currency"),p()()()()(),f(115,"div",31)(116,"div",2)(117,"div",32),ee(118,"i",33),p(),f(119,"h3",5),_(120,"Project Sale"),p()(),f(121,"div",6)(122,"div",34)(123,"div",35)(124,"span",36),_(125,"Selling Date"),p(),f(126,"span",37),_(127),p()(),f(128,"div",35)(129,"span",36),_(130,"Selling Price"),p(),f(131,"span",38),_(132),Ne(133,"currency"),p()(),f(134,"div",35)(135,"span",36),_(136,"Total Cost"),p(),f(137,"span",37),_(138),Ne(139,"currency"),p()(),f(140,"div",35)(141,"span",36),_(142,"Net Profit"),p(),f(143,"span",37),_(144),Ne(145,"currency"),p()()()()(),f(146,"div",39)(147,"div",2)(148,"div",40),ee(149,"i",41),p(),f(150,"h3",5),_(151,"Profit Distribution"),p()(),f(152,"div",6)(153,"p-table",42,43),D(155,vme,4,0,"ng-template",44),D(156,bme,20,1,"ng-template",18),D(157,xme,25,43,"ng-template",19),p(),D(158,wme,4,0,"div",20),p()(),f(159,"div",45)(160,"button",46),L("click",function(){return n.exportTableToExcel()}),_(161,"Excel"),p()()()),2&e&&(v(13),U((null==n.projectDetails[0]?null:n.projectDetails[0].project_name)||"N/A"),v(5),U((null==n.projectDetails[0]?null:n.projectDetails[0].location)||"N/A"),v(4),po("active","Active"===(null==n.projectDetails[0]?null:n.projectDetails[0].status)),v(1),U((null==n.projectDetails[0]?null:n.projectDetails[0].status)||"N/A"),v(5),U((null==n.projectDetails[0]?null:n.projectDetails[0].coveredarea)||"N/A"),v(5),U(He(34,40,n.toNumber(null==n.projectDetails[0]?null:n.projectDetails[0].totalcost)," ","symbol","1.0-0")),v(6),U(Oa(40,45,null==n.projectDetails[0]?null:n.projectDetails[0].startdate,"dd-MM-yyyy")||"N/A"),v(6),U(Oa(46,48,null==n.projectDetails[0]?null:n.projectDetails[0].enddate,"dd-MM-yyyy")||"N/A"),v(6),U(He(52,51,n.toNumber(n.estimatedcost)," ","symbol","1.0-0")),v(9),T("value",n.contribution)("paginator",!0)("rows",10)("styleClass","custom-table"),v(4),T("ngIf",n.isContributionEmpty()),v(13),U(He(78,56,n.toNumber(n.budget)," ","symbol","1.0-0")),v(6),U(He(84,61,n.toNumber(n.spent)," ","symbol","1.0-0")),v(5),po("positive",n.toNumber(n.remaining)>=0)("negative",n.toNumber(n.remaining)<0),v(1),hn(" ",He(90,66,n.toNumber(n.remaining)," ","symbol","1.0-0")," "),v(6),U(He(96,71,n.toNumber(n._landcost)," ","symbol","1.0-0")),v(6),U(He(102,76,n.toNumber(n._commission)," ","symbol","1.0-0")),v(6),U(He(108,81,n.toNumber(n._taxes)," ","symbol","1.0-0")),v(6),U(He(114,86,n.toNumber(n._cpca)," ","symbol","1.0-0")),v(14),U(n.obj_sellingdate||"N/A"),v(5),U(He(133,91,n.toNumber(n.totalprice)," ","symbol","1.0-0")),v(6),U(He(139,96,n.toNumber(n.totalcost)," ","symbol","1.0-0")),v(5),po("positive",n.toNumber(n.netprofit)>=0)("negative",n.toNumber(n.netprofit)<0),v(1),hn(" ",He(145,101,n.toNumber(n.netprofit)," ","symbol","1.0-0")," "),v(9),T("value",n.profitdistribution)("paginator",!0)("rows",10)("globalFilterFields",rt(106,Cme))("styleClass","custom-table"),v(5),T("ngIf",n.isProfitEmpty()))},directives:[ki,zn,Sn,li],pipes:[dr,al],styles:['.project-summary-wrapper[_ngcontent-%COMP%]{padding:20px;display:flex;flex-direction:column;gap:25px}.summary-card[_ngcontent-%COMP%]{background:white;border-radius:15px;padding:25px;box-shadow:0 4px 20px #00000014;transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden}.summary-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:5px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.5),transparent);transform:translate(-100%);transition:transform .6s}.summary-card[_ngcontent-%COMP%]:hover:before{transform:translate(100%)}.summary-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 8px 30px #00000026}.card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;margin-bottom:25px;padding-bottom:15px;border-bottom:2px solid #f0f0f0}.card-icon[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.5rem;color:#fff;flex-shrink:0;box-shadow:0 4px 15px #0003}.project-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)}.investment-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%)}.cost-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%)}.sale-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#43e97b 0%,#38f9d7 100%)}.profit-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fa709a 0%,#fee140 100%)}.card-title[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:600;margin:0;color:#2d3748;letter-spacing:-.3px}.card-body[_ngcontent-%COMP%]{margin-top:10px}.detail-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));grid-gap:20px;gap:20px}.detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.detail-label[_ngcontent-%COMP%]{font-size:.85rem;color:#718096;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.detail-value[_ngcontent-%COMP%]{font-size:1rem;color:#2d3748;font-weight:500}.detail-value.highlight[_ngcontent-%COMP%]{font-size:1.15rem;font-weight:600;color:#667eea}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 12px;border-radius:20px;font-size:.85rem;font-weight:600;background:#e2e8f0;color:#64748b}.status-badge.active[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.cost-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));grid-gap:20px;gap:20px}.cost-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;padding:15px;background:#f8f9fa;border-radius:10px;transition:all .2s}.cost-item[_ngcontent-%COMP%]:hover{background:#e9ecef;transform:translateY(-2px)}.cost-item.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.cost-label[_ngcontent-%COMP%]{font-size:.85rem;color:#718096;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.cost-value[_ngcontent-%COMP%]{font-size:1.1rem;color:#2d3748;font-weight:600}.cost-value.spent[_ngcontent-%COMP%]{color:#e53e3e}.cost-value.highlight[_ngcontent-%COMP%]{font-size:1.25rem;color:#667eea}.cost-value.positive[_ngcontent-%COMP%]{color:#38a169}.cost-value.negative[_ngcontent-%COMP%]{color:#e53e3e}.sale-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));grid-gap:20px;gap:20px}.sale-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;padding:15px;background:#f8f9fa;border-radius:10px;transition:all .2s}.sale-item[_ngcontent-%COMP%]:hover{background:#e9ecef;transform:translateY(-2px)}.sale-label[_ngcontent-%COMP%]{font-size:.85rem;color:#718096;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.sale-value[_ngcontent-%COMP%]{font-size:1.1rem;color:#2d3748;font-weight:600}.sale-value.highlight[_ngcontent-%COMP%]{font-size:1.3rem;color:#667eea}.sale-value.positive[_ngcontent-%COMP%]{color:#38a169}.sale-value.negative[_ngcontent-%COMP%]{color:#e53e3e}  .custom-table{width:100%;border-radius:10px;overflow:hidden}  .custom-table .p-datatable-header{background:#f8f9fa;border:none;padding:15px}  .custom-table .p-datatable-thead>tr>th{background:#f8f9fa;border:none;padding:12px 15px;font-weight:600;color:#2d3748;text-transform:uppercase;font-size:.85rem;letter-spacing:.5px}  .custom-table .p-datatable-tbody>tr{border-bottom:1px solid #e2e8f0;transition:all .2s}  .custom-table .p-datatable-tbody>tr:hover{background:#f8f9fa}  .custom-table .p-datatable-tbody>tr>td{border:none;padding:12px 15px;color:#4a5568}.amount-cell[_ngcontent-%COMP%]{font-weight:600;color:#2d3748;text-align:right}.amount-cell.positive[_ngcontent-%COMP%]{color:#38a169}.amount-cell.negative[_ngcontent-%COMP%]{color:#e53e3e}.table-search[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:10px 0}.table-search[_ngcontent-%COMP%]   .p-input-icon-left[_ngcontent-%COMP%]{width:300px}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px 15px 10px 40px;border:2px solid #e2e8f0;border-radius:8px;transition:all .2s}.table-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.no-data-message[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#a0aec0}.no-data-message[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:15px;display:block;opacity:.5}.no-data-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:500}.export-section[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:10px}@media (max-width: 768px){.project-summary-wrapper[_ngcontent-%COMP%]{padding:15px;gap:20px}.summary-card[_ngcontent-%COMP%]{padding:20px}.detail-grid[_ngcontent-%COMP%], .cost-grid[_ngcontent-%COMP%], .sale-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.card-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:10px}.card-icon[_ngcontent-%COMP%]{width:45px;height:45px;font-size:1.3rem}.card-title[_ngcontent-%COMP%]{font-size:1.2rem}.table-search[_ngcontent-%COMP%]{justify-content:center}.table-search[_ngcontent-%COMP%]   .p-input-icon-left[_ngcontent-%COMP%]{width:100%}.export-section[_ngcontent-%COMP%]{justify-content:center}  .custom-table{font-size:.9rem}  .custom-table .p-datatable-thead>tr>th,   .custom-table .p-datatable-tbody>tr>td{padding:8px 10px}}@media (max-width: 480px){.project-summary-wrapper[_ngcontent-%COMP%]{padding:10px}.summary-card[_ngcontent-%COMP%]{padding:15px}.cost-item[_ngcontent-%COMP%], .sale-item[_ngcontent-%COMP%]{padding:12px}}']}),t})();function Sme(t,i){if(1&t&&(f(0,"div",16)(1,"div",17)(2,"div"),ee(3,"i",18),_(4),p()()()),2&t){const e=A();v(4),Kv(" ",e.fileName," (",e.fileSize,") ")}}function Eme(t,i){1&t&&(f(0,"div",19)(1,"div",20)(2,"span",21),_(3,"Loading..."),p()(),f(4,"p"),_(5,"Processing file..."),p()())}function kme(t,i){if(1&t&&(f(0,"th"),_(1),p()),2&t){const e=i.$implicit;v(1),U(e)}}function Dme(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=i.$implicit,n=A().$implicit;v(1),hn("",n[e]," ")}}function Ime(t,i){if(1&t&&(f(0,"tr"),D(1,Dme,2,1,"td",25),p()),2&t){const e=A(2);v(1),T("ngForOf",e.headers)}}function Ame(t,i){if(1&t&&(f(0,"tr")(1,"td",29),_(2),p()()),2&t){const e=A(2);v(1),T("colSpan",e.headers.length),v(1),hn(" + ",e.excelData.length-5," more records... ")}}function Mme(t,i){if(1&t){const e=Ie();f(0,"div",22)(1,"h5"),_(2,"Data Preview"),p(),f(3,"div",23)(4,"table",24)(5,"thead")(6,"tr"),D(7,kme,2,1,"th",25),p()(),f(8,"tbody"),D(9,Ime,2,1,"tr",25),D(10,Ame,3,2,"tr",26),p()()(),f(11,"div",27)(12,"button",28),L("click",function(){return z(e),A().confirmImport()}),_(13," Import Data "),p(),f(14,"button",28),L("click",function(){return z(e),A().cancelImport()}),_(15," Clear "),p()()()}if(2&t){const e=A();v(7),T("ngForOf",e.headers),v(2),T("ngForOf",e.excelData.slice(0,5)),v(1),T("ngIf",e.excelData.length>5)}}let Fme=(()=>{class t{constructor(e,n,r){this._ps=e,this.dialogService=n,this._ms=r,this.importComplete=new Et,this.cancel=new Et,this.excelData=[],this.headers=[],this.fileName="",this.fileSize="",this.isLoading=!1,this.input=document.createElement("input")}ngOnInit(){this.projectCostForm=new Zn({project:new Me("",jt.required),description:new Me(""),category:new Me(""),contractor:new Me(""),amount:new Me(0,[jt.required,jt.min(0)]),paymentdate:new Me(null),remarks:new Me("")})}onFileChange(e){var n;this.input=e.target;const r=null===(n=this.input.files)||void 0===n?void 0:n[0];if(!r)return;this.fileName=r.name,this.isLoading=!0;const o=new FileReader;o.onload=c=>{var u;try{const m=new Uint8Array(null===(u=c.target)||void 0===u?void 0:u.result),g=n_.read(m,{type:"array",sheetRows:100,cellText:!0,cellDates:!0}),x=g.Sheets[g.SheetNames[0]],E=(n_.utils.decode_range(x["!ref"]||"A1:Z100"),n_.utils.sheet_to_json(x,{header:1,raw:!1,dateNF:"dd-mm-yyyy"}).filter(R=>R.some(B=>null!==B&&""!==B)));E.length>0&&(this.headers=E[0].map(R=>(null==R?void 0:R.toString().trim())||""),this.excelData=E.slice(1).filter(R=>R.some(B=>null!==B)).map(R=>{const B={},K=R;return this.headers.forEach((q,Y)=>{B[q]=void 0!==K[Y]?K[Y]:"",B[q]="date"===q.toLowerCase()&&K[Y]instanceof Date?this.formatDate(K[Y]):void 0!==K[Y]?K[Y]:""}),B}))}catch(m){console.error("Error processing Excel file:",m),this._ms.add({severity:"error",summary:"Import Error",detail:"Error processing Excel file"})}finally{this.isLoading=!1}},o.readAsArrayBuffer(r)}formatDate(e){const n=e.getUTCFullYear(),r=(e.getUTCMonth()+1).toString().padStart(2,"0");return`${e.getUTCDate().toString().padStart(2,"0")}-${r}-${n}`}confirmImport(){if(0===this.excelData.length)return void this._ms.add({severity:"warn",summary:"Warning",detail:"No data to import"});this.isLoading=!0;let e=0,n=0;const r=[],o=c=>{if(c>=this.excelData.length)return this.isLoading=!1,this._ms.add({severity:"success",summary:"Import Complete",detail:`Processed ${this.excelData.length} rows. Success: ${e}, Errors: ${n}`}),this.cancelImport(),void this.importComplete.emit({successCount:e,errorCount:n,processedData:r});const u=this.excelData[c];if(this.projectCostForm.value.project=this.projectID,this.projectCostForm.value.paymentdate=u.DATE||null,this.projectCostForm.value.description=u.DISCRIPTION||"",this.projectCostForm.value.remarks=u.REMARKS||"",this.projectCostForm.value.amount=u.AMOUNT||0,this.projectCostForm.value.category=u.CATEGORY||"",this.projectCostForm.value.contractor=u["SUB. CONTRACTOR"]||"",!this.projectCostForm.value.amount||!this.projectCostForm.value.project)return n++,r.push(Object.assign(Object.assign({},u),{status:"error",error:"Missing required fields"})),this._ms.add({severity:"error",summary:"Skipped Row",detail:`Row ${c+1} missing required fields`,life:3e3}),void o(c+1);console.log("Saving row:",this.projectCostForm),this._ps.addProjectCost(this.projectCostForm).subscribe({next:m=>{e++,r.push(Object.assign(Object.assign({},u),{status:"success",response:m})),o(c+1)},error:m=>{var g;n++,r.push(Object.assign(Object.assign({},u),{status:"error",error:m.message})),this._ms.add({severity:"error",summary:"Error",detail:`Row ${c+1}: ${(null===(g=m.error)||void 0===g?void 0:g.message)||m.message||"Failed to save"}`,life:5e3}),o(c+1)}})};o(0)}cancelImport(){this.excelData=[],this.headers=[],this.fileName="",this.fileSize="",this.input.value="",this.cancel.emit(),this._ms.add({severity:"info",summary:"Cleared",detail:"Data cleared",life:3e3})}formatFileSize(e){if(0===e)return"0 Bytes";const o=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,o)).toFixed(2)+" "+["Bytes","KB","MB","GB"][o]}}return t.\u0275fac=function(e){return new(e||t)(te(ll),te(Is),te(kn))},t.\u0275cmp=dn({type:t,selectors:[["app-excel-import"]],inputs:{projectID:"projectID"},outputs:{importComplete:"importComplete",cancel:"cancel"},decls:21,vars:3,consts:[[1,"excel-import-container"],[1,"card"],[1,"card-header","bg-primary","text-white"],[1,"fas","fa-file-import","me-2"],[1,"card-body"],[1,"mb-4"],[1,"form-label"],[1,"file-upload",3,"click"],["type","file","accept",".xlsx, .xls, .xlsm",1,"d-none",3,"change"],["fileInput",""],[1,"fas","fa-file-excel","text-primary"],[1,"text-muted"],["class","file-info mt-3",4,"ngIf"],["class","text-center",4,"ngIf"],["class","preview-section",4,"ngIf"],["position","bottom-right"],[1,"file-info","mt-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"fas","fa-file-excel","text-success","me-2"],[1,"text-center"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"preview-section"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"d-flex","justify-content-end","mt-4","gap-2"],[1,"btn","btn-primary",3,"click"],[1,"text-center","text-muted",3,"colSpan"]],template:function(e,n){if(1&e){const r=Ie();f(0,"div",0)(1,"div",1)(2,"div",2),ee(3,"i",3),_(4," Excel Import "),p(),f(5,"div",4)(6,"div",5)(7,"label",6),_(8,"Select Excel File"),p(),f(9,"div",7),L("click",function(){return z(r),Fa(11).click()}),f(10,"input",8,9),L("change",function(c){return n.onFileChange(c)}),p(),ee(12,"i",10),f(13,"h5"),_(14,"Click to browse files"),p(),f(15,"p",11),_(16,"Supported formats: .xlsx, .xls, .xlsm"),p()(),D(17,Sme,5,2,"div",12),p(),D(18,Eme,6,0,"div",13),D(19,Mme,16,3,"div",14),p()()(),ee(20,"p-toast",15)}2&e&&(v(17),T("ngIf",n.fileName),v(1),T("ngIf",n.isLoading),v(1),T("ngIf",n.excelData.length>0))},directives:[Sn,nc,fr],styles:[".excel-import-container[_ngcontent-%COMP%]{max-width:800px;margin:2rem auto}.file-upload[_ngcontent-%COMP%]{border:2px dashed #ced4da;border-radius:8px;padding:2rem;text-align:center;background-color:#e7f1ff;cursor:pointer;transition:all .3s}.file-upload[_ngcontent-%COMP%]:hover{border-color:#0d6efd;background-color:#0d6efd0d}.file-upload[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;color:#0d6efd;margin-bottom:1rem}.file-info[_ngcontent-%COMP%]{background-color:#f8f9fa;border-radius:5px;padding:10px}.preview-section[_ngcontent-%COMP%]{margin-top:2rem}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#e7f1ff}"]}),t})();const Pme=["tableContainer"],Ome=["dt"],Nme=["tabView"],Lme=["menustab"],Rme=["inventorytab"];function Bme(t,i){if(1&t){const e=Ie();f(0,"div",39)(1,"span",40),ee(2,"i",41),f(3,"input",42),L("input",function(r){return z(e),A().applyFilterGlobal(r,"contains")}),p()()()}}function jme(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Vme(t,i){1&t&&(f(0,"th"),_(1,"LocID"),p())}function Ume(t,i){1&t&&(f(0,"th"),_(1,"Location"),p())}function Hme(t,i){1&t&&(f(0,"th"),_(1,"Land Cost"),p())}function zme(t,i){1&t&&(f(0,"th"),_(1,"Comm"),p())}function $me(t,i){1&t&&(f(0,"th"),_(1,"Taxes"),p())}function Wme(t,i){1&t&&(f(0,"th"),_(1,"Area(SqrFt) "),p())}function qme(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,jme,2,0,"th",43),f(4,"th"),_(5,"Name"),p(),D(6,Vme,2,0,"th",43),D(7,Ume,2,0,"th",43),f(8,"th"),_(9,"Start Date"),p(),f(10,"th"),_(11,"Status"),p(),f(12,"th"),_(13,"Project Cost"),p(),f(14,"th"),_(15,"Remarks"),p(),f(16,"th"),_(17,"Description"),p(),D(18,Hme,2,0,"th",43),D(19,zme,2,0,"th",43),D(20,$me,2,0,"th",43),D(21,Wme,2,0,"th",43),f(22,"th"),_(23,"Action"),p()()),2&t&&(v(3),T("ngIf",!1),v(3),T("ngIf",!1),v(1),T("ngIf",!1),v(11),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1))}function Gme(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Kme(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.loc_id)}}function Yme(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.location)}}function Xme(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.budget," ","symbol","1.0-0"))}}function Qme(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.landcost," ","symbol","1.0-0"))}}function Jme(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.commission," ","symbol","1.0-0"))}}function Zme(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.taxes," ","symbol","1.0-0"))}}function ege(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.coveredarea)}}function tge(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,Gme,2,1,"td",43),f(4,"td",22),L("click",function(){const o=z(e).$implicit;return A().toggle(o)}),_(5),p(),D(6,Kme,2,1,"td",43),D(7,Yme,2,1,"td",43),f(8,"td"),_(9),Ne(10,"date"),p(),f(11,"td"),_(12),p(),f(13,"td"),_(14),Ne(15,"currency"),p(),f(16,"td"),_(17),p(),f(18,"td"),_(19),p(),D(20,Xme,3,6,"td",43),D(21,Qme,3,6,"td",43),D(22,Jme,3,6,"td",43),D(23,Zme,3,6,"td",43),D(24,ege,2,1,"td",43),f(25,"td")(26,"button",44),L("click",function(){const o=z(e).$implicit;return A().updateProject(o)}),p(),_(27," \xa0"),f(28,"button",45),L("click",function(){const o=z(e).$implicit;return A().deleteProject(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.project_name),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(2),U(Oa(10,15,e.startdate,"dd-MM-yyyy")),v(3),U(e.status),v(2),U(He(15,18,e.totalcost," ","symbol","1.0-0")),v(3),U(e.notes),v(2),U(e.description),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(1),T("ngIf",!1)}}function nge(t,i){if(1&t){const e=Ie();f(0,"tr"),ee(1,"td")(2,"td")(3,"td")(4,"td")(5,"td")(6,"td")(7,"td"),f(8,"td")(9,"button",46),L("click",function(){return z(e),A().exportTableToExcel()}),_(10,"Excel"),p(),f(11,"button",47),L("click",function(){return z(e),A().exportTableToPdf()}),_(12,"Pdf"),p()()()}}function ige(t,i){1&t&&(f(0,"div",48),_(1,"No data found"),p())}function rge(t,i){if(1&t){const e=Ie();f(0,"li",22),L("click",function(){return z(e),A().toggleInventoryPanel()}),f(1,"p"),_(2,"Project Inventory"),p()()}}function oge(t,i){if(1&t&&(f(0,"p-tabPanel",49,50),ee(2,"app-inventory",37),p()),2&t){const e=A();T("disabled",!0),v(2),T("projectID",e.projectID)}}const sge=function(){return{width:"200px"}},age=function(){return["project_name","client","location","status"]},lge=function(){return{width:"450px"}};let cge=(()=>{class t{constructor(e,n,r,o,c,u,m,g,x,S){this.proj_Service=e,this.dialogService=n,this.messageService=r,this._lcs=o,this._is=c,this._cs=u,this.confirmationService=m,this.pdfserv=g,this.exptoexcel=x,this.router=S,this.showinvmenu=!1,this.projects=[],this.projectDetails=[],this.displayDialog=!1,this.displayAddModal=!1,this.activeIndex=0,this.projectID=0,this.labourcosts=[],this.sumoftotalcost=0,this.contribution=[],this.total_contributions=0,this.projectcost=[],this.salecost=[],this.profitdistribution=[],this.total_investor_share=0,this.total_office_share=0,this._budget=0,this._spent=0,this._cpca=0,this._remaining=0,this._landcost=" ",this._commission=" ",this._taxes=" ",this._estimatedcost="",this._totalprice=0,this._totalcost=0,this._netprofit=0,this.selectedType=1,this.total_projectcost=0,this.types=[{name:"Residential",code:"1"},{name:"Commercial",code:"2"}]}ngOnInit(){this.getProjects(this.selectedType)}exportTableToExcel(){const e=["Name","Start Date","Status","Budget","Land Cost","Comm","Tax","Area"],n=this.toExcelFormat();1==this.selectedType?this.exptoexcel.exportExcel(n,e,[],"Residential_Projects_'"+ui()):2==this.selectedType&&this.exptoexcel.exportExcel(n,e,[],"Commercial_Projects_"+ui())}exportTableToPdf(){const e=["Name","Start Date","Status","Budget","Land Cost","Comm","Tax","Area"],n=this.toPdfFormat();this.toPdfFooterFormat(),1==this.selectedType?this.pdfserv.generatePdf(e,n,[],"Residential_Projects_"+ui()):2==this.selectedType&&this.pdfserv.generatePdf(e,n,[],"Commercial_Projects_"+ui())}toExcelFormat(){let e=[];e.push(["Name","Start Date","Status","Budget","Land Cost","Commission","Tax","Covered Area"]);for(var n=0;n<this.projects.length;n++)e.push([this.projects[n].project_name,Qr(this.projects[n].startdate),this.projects[n].status,this.projects[n].budget.toLocaleString(),this.projects[n].landcost.toLocaleString(),this.projects[n].commission.toLocaleString(),this.projects[n].taxes.toLocaleString(),this.projects[n].coveredarea]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.projects.length;n++)e.push([this.projects[n].project_name,Qr(this.projects[n].startdate),this.projects[n].status,this.projects[n].budget.toLocaleString(),this.projects[n].landcost.toLocaleString(),this.projects[n].commission.toLocaleString(),this.projects[n].taxes.toLocaleString(),this.projects[n].coveredarea]);return e}toPdfFooterFormat(){let e=[];return e.push(["","","","","Total",this.projects[0].taxes.toLocaleString()]),e}onDropdownChange(e){this.selectedType=e.value,this.getProjects(Number(this.selectedType)),this.total_projectcost=0}toggleQEPanel(){this.sumoftotalcost=0,this._lcs.getLabourCostWithProject(this.projectID.toString()).subscribe({next:e=>{this.labourcosts=e,e.forEach(n=>{this.sumoftotalcost=Number(this.sumoftotalcost)+Number(n.total_cost)})},error:e=>{console.error(e)}}),this.activeIndex=2}toggleInvestorsPanel(){this._cs.getBudget(this.projectID.toString()).subscribe({next:e=>{this._budget=e[0].budget},error:e=>{console.error(e)}}),this._budget=Number(new Intl.NumberFormat("en-US",{style:"currency",currency:"PKR",minimumFractionDigits:2}).format(this._budget)),this.total_contributions=0,this._cs.getContributions(this.projectID.toString()).subscribe({next:e=>{this.contribution=e,this.contribution.forEach(n=>{this.total_contributions=this.total_contributions+Number(n.contributions)})},error:e=>{console.error(e)}}),this.activeIndex=3}togglePCPanel(){this.proj_Service.getProjectCost(this.projectID.toString()).subscribe({next:e=>{if(console.log("Project Cost Response:",e),this.projectcost=e,this._budget=0,this._spent=0,this._cpca=0,this._remaining=0,this.total_projectcost=0,this._landcost="",this._commission="",this._taxes="",e&&e.length>0){const n=e[0];this._landcost=null!=n.landcost?String(n.landcost):"",this._commission=null!=n.commission?String(n.commission):"",this._taxes=null!=n.taxes?String(n.taxes):"",this._cpca=n.coveredarea||0;const r=(Number(this._landcost)||0)+(Number(this._commission)||0)+(Number(this._taxes)||0);e.forEach(o=>{this.total_projectcost=this.total_projectcost+(Number(o.amount)||0)}),this._budget=(n.budget||0)+r,this._spent=(Number(n.totalcost)||0)+r}this._remaining=Number(this._budget)-Number(this._spent),this._cpca>0&&(this._cpca=this.total_projectcost/this._cpca),console.log("Calculated values:",{landcost:this._landcost,commission:this._commission,taxes:this._taxes,budget:this._budget,spent:this._spent,remaining:this._remaining})},error:e=>{console.error("Error fetching project cost:",e)}}),this.activeIndex=4}togglePSPanel(){this.proj_Service.getProjectsSale(this.projectID.toString()).subscribe({next:e=>{this.salecost=e},error:e=>{console.error(e)}}),this.activeIndex=5}toggle(e){this.menustab.disabled=!1,this.projectID=e.id,this._landcost=e.landcost||" ",this._commission=e.commission||" ",this._taxes=e.taxes||" ",this.showinvmenu=2==this.selectedType,this.activeIndex=1}togglePDPanel(){this.total_investor_share=0,this.total_office_share=0,this.proj_Service.getProfitContribution(this.projectID.toString()).subscribe({next:e=>{this.profitdistribution=e,this.profitdistribution.forEach(n=>{this.total_investor_share=this.total_investor_share+n.investorshare,this.total_office_share=this.total_office_share+n.officeshare})},error:e=>{console.error(e)}}),this.activeIndex=6}toggleInventoryPanel(){this.childComponent.projectID=this.projectID,this.childComponent.getPlazaInventory(),this.childComponent.activeIndex=0,this.activeIndex=8}toggleImportPanel(){this.activeIndex=8}toggleSummaryPanel(){this._lcs.getTotalEstimatedCost(this.projectID.toString()).subscribe({next:e=>{this._estimatedcost=e[0].totalcost},error:e=>{console.error(e)}}),this._cs.getContributions(this.projectID.toString()).subscribe({next:e=>{this.contribution=e},error:e=>{console.error(e)}}),this.proj_Service.getProjectCost(this.projectID.toString()).subscribe({next:e=>{this.projectcost=e,this._budget=0,this._spent=0,this._remaining=0,this.total_projectcost=0,this._cpca=0,e.forEach(n=>{this._landcost=n.landcost,this._commission=n.commission,this._taxes=n.taxes,this._cpca=n.coveredarea;const r=(Number(this._landcost)+Number(this._commission)+Number(this._taxes)).toString();this._budget=n.budget+Number(r),this._spent=Number(n.totalcost)+Number(r),this.total_projectcost=this.total_projectcost+Number(n.amount)}),this._remaining=Number(this._budget)-Number(this._spent),this._cpca=this.total_projectcost/this._cpca},error:e=>{console.error(e)}}),this.proj_Service.getProjectsSale(this.projectID.toString()).subscribe({next:e=>{this._totalprice=0,this._totalcost=0,this._netprofit=0,this.obj_sellingdate="",this.salecost=e,e.forEach(n=>{this._totalprice=n.totalprice,this._totalcost=n.totalcost,this._netprofit=n.netprofit,this.obj_sellingdate=new Date(n.sellingdate);var r=this.obj_sellingdate.getDate(),o=this.obj_sellingdate.getMonth()+1,c=this.obj_sellingdate.getFullYear();this.obj_sellingdate=(r<10?"0"+r:r)+"-"+(o<10?"0"+o:o)+"-"+c})},error:e=>{console.error(e)}}),this.loadProjectDetails(),this.activeIndex=7}loadProjectDetails(){this.proj_Service.getProjDetails(this.projectID).subscribe({next:e=>{this.projectDetails=e},error:e=>{console.error(e)}})}applyFilterGlobal(e,n){this.dt.filterGlobal(e.target.value,n)}getProjects(e){this.proj_Service.getUserProjects(e,Number(sessionStorage.getItem("userid"))).subscribe({next:n=>{this.projects=n,this.selectedProject=this.projects[0]},error:n=>{console.error(n)}})}isProjectsEmpty(){return 0===this.projects.length}showAddProjectDialog(){this.project={id:"",project_name:"",description:"",loc_id:"",location:"",landcost:"",startdate:"",enddate:"",status:"",budget:"",commission:"",taxes:"",notes:"",type:"",coveredarea:"",selected:!1},this.selectedLocation="",this.selectedStatus="",this.obj_startdate="",this.displayAddModal=!0}hideAddModal(e){this.displayAddModal=!e}updateProjectList(e){this.getProjects(this.selectedType)}updateProject(e){this.project=Object.assign({},e),this.obj_startdate=new Date(this.project.startdate),this.obj_enddate=null!=this.project.enddate?new Date(this.project.enddate):"",this.selectedLocation=this.project.loc_id,this.selectedStatus=this.project.status,this.displayAddModal=!0}deleteProject(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this.proj_Service.deleteProject(e.id.toString()).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Project deleted successfully.",life:3e3}),this.getProjects(this.selectedType)},error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:n.error.message,life:3e3})}})}})}}return t.\u0275fac=function(e){return new(e||t)(te(ll),te(Is),te(kn),te(gM),te(eS),te(i_),te(Un),te(hs),te(Ko),te(zs))},t.\u0275cmp=dn({type:t,selectors:[["app-project"]],viewQuery:function(e,n){if(1&e&&(Mt(Pme,5),Mt(Ome,5),Mt(Nme,5),Mt(Lme,5),Mt(Rme,5),Mt(tb,5)),2&e){let r;xt(r=wt())&&(n.tableContainer=r.first),xt(r=wt())&&(n.dt=r.first),xt(r=wt())&&(n.tabView=r.first),xt(r=wt())&&(n.menustab=r.first),xt(r=wt())&&(n.inventorytab=r.first),xt(r=wt())&&(n.childComponent=r.first)}},features:[Nn([Is,kn,Un])],decls:64,vars:73,consts:[[1,"text-muted"],[1,"tab-container"],[3,"activeIndex","scrollable","activeIndexChange"],["tabView",""],["header","Projects"],[2,"display","flex","align-items","center"],["for","status",2,"margin-right","5px"],["optionLabel","name","optionValue","code",3,"options","onChange"],[1,"btn-project","btn-project-icon",3,"click"],[1,"bi","bi-plus-lg"],[1,"table-responsive"],["tableContainer",""],["id","projectstable","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["style","text-align: center;",4,"ngIf"],[2,"width","600px",3,"displayAddModal","project","obj_startdate","obj_enddate","selectedLocation","selectedStatus","projectID","selectedType","clickClose","clickAdd"],["header","Main Menu",3,"disabled"],["menustab",""],[1,"list-item",3,"click"],["class","list-item",3,"click",4,"ngIf"],["header","Quantity Estimation",3,"disabled"],[3,"projectID","labourcosts","sumoftotalcost"],["header","Investment",3,"disabled"],[3,"projectID","contribution","_budget","total_contributions"],["header","Project Cost",3,"disabled"],[3,"projectID","projectcost","_budget","_spent","_cpca","_remaining","_landcost","_commission","_taxes","total_projectcost"],["header","Project Sale",3,"disabled"],[3,"projectID","salecost"],["header","Profit Distribution",3,"disabled"],[3,"profitdistribution","total_investor_share","total_office_share"],["header","Summary",3,"disabled"],[3,"projectID","contribution","budget","spent","remaining","totalprice","totalcost","netprofit","_landcost","_commission","_taxes","_cpca","obj_sellingdate","estimatedcost","profitdistribution","projects","projectDetails"],["header","Import Data",3,"disabled"],[3,"projectID"],["header","Inventory",3,"disabled",4,"ngIf"],[2,"text-align","right"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[4,"ngIf"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[1,"btn-project","btn-sm",3,"click"],[1,"btn-project","btn-sm",2,"margin-left","5px",3,"click"],[2,"text-align","center"],["header","Inventory",3,"disabled"],["inventorytab",""]],template:function(e,n){1&e&&(f(0,"h2",0),_(1,"Manage Projects"),p(),ee(2,"hr"),f(3,"div",1)(4,"p-tabView",2,3),L("activeIndexChange",function(o){return n.activeIndex=o}),f(6,"p-tabPanel",4)(7,"div",5)(8,"label",6),_(9,"Project Type"),p(),f(10,"p-dropdown",7),L("onChange",function(o){return n.onDropdownChange(o)}),p(),f(11,"button",8),L("click",function(){return n.showAddProjectDialog()}),ee(12,"i",9),p()(),f(13,"div",10,11)(15,"p-table",12,13),D(17,Bme,4,0,"ng-template",14),D(18,qme,24,7,"ng-template",15),D(19,tge,29,23,"ng-template",16),D(20,nge,13,0,"ng-template",17),p()(),D(21,ige,2,0,"div",18),f(22,"app-add-edit-project",19),L("clickClose",function(o){return n.hideAddModal(o)})("clickAdd",function(o){return n.updateProjectList(o)}),p(),ee(23,"p-confirmDialog"),p(),f(24,"p-tabPanel",20,21)(26,"ul")(27,"li",22),L("click",function(){return n.toggleQEPanel()}),f(28,"p"),_(29,"Quantity Estimation"),p()(),f(30,"li",22),L("click",function(){return n.toggleInvestorsPanel()}),f(31,"p"),_(32,"Investors Contributions"),p()(),f(33,"li",22),L("click",function(){return n.togglePCPanel()}),f(34,"p"),_(35,"Project Cost"),p()(),f(36,"li",22),L("click",function(){return n.togglePSPanel()}),f(37,"p"),_(38,"Project Sale"),p()(),f(39,"li",22),L("click",function(){return n.togglePDPanel()}),f(40,"p"),_(41,"Profit Distribution"),p()(),f(42,"li",22),L("click",function(){return n.toggleSummaryPanel()}),f(43,"p"),_(44,"Project Summary"),p()(),f(45,"li",22),L("click",function(){return n.toggleImportPanel()}),f(46,"p"),_(47,"Import Data"),p()(),D(48,rge,3,0,"li",23),p()(),f(49,"p-tabPanel",24),ee(50,"app-quantityestimation",25),p(),f(51,"p-tabPanel",26),ee(52,"app-contributions",27),p(),f(53,"p-tabPanel",28),ee(54,"app-addcost",29),p(),f(55,"p-tabPanel",30),ee(56,"app-addprojectsales",31),p(),f(57,"p-tabPanel",32),ee(58,"app-profitdistribution",33),p(),f(59,"p-tabPanel",34),ee(60,"app-projectsummary",35),p(),f(61,"p-tabPanel",36),ee(62,"app-excel-import",37),p(),D(63,oge,3,2,"p-tabPanel",38),p()()),2&e&&(v(4),T("activeIndex",n.activeIndex)("scrollable",!0),v(6),Ft(rt(70,sge)),T("options",n.types),v(5),T("value",n.projects)("paginator",!0)("rows",10)("globalFilterFields",rt(71,age)),v(6),T("ngIf",n.isProjectsEmpty()),v(1),T("displayAddModal",n.displayAddModal)("project",n.project)("obj_startdate",n.obj_startdate)("obj_enddate",n.obj_enddate)("selectedLocation",n.selectedLocation)("selectedStatus",n.selectedStatus)("projectID",n.projectID)("selectedType",n.selectedType),v(1),Ft(rt(72,lge)),v(1),T("disabled",!0),v(24),T("ngIf",n.showinvmenu),v(1),T("disabled",!0),v(1),T("projectID",n.projectID)("labourcosts",n.labourcosts)("sumoftotalcost",n.sumoftotalcost),v(1),T("disabled",!0),v(1),T("projectID",n.projectID)("contribution",n.contribution)("_budget",n._budget)("total_contributions",n.total_contributions),v(1),T("disabled",!0),v(1),T("projectID",n.projectID)("projectcost",n.projectcost)("_budget",n._budget)("_spent",n._spent)("_cpca",n._cpca)("_remaining",n._remaining)("_landcost",n._landcost)("_commission",n._commission)("_taxes",n._taxes)("total_projectcost",n.total_projectcost),v(1),T("disabled",!0),v(1),T("projectID",n.projectID)("salecost",n.salecost),v(1),T("disabled",!0),v(1),T("profitdistribution",n.profitdistribution)("total_investor_share",n.total_investor_share)("total_office_share",n.total_office_share),v(1),T("disabled",!0),v(1),T("projectID",n.projectID)("contribution",n.contribution)("budget",n._budget)("spent",n._spent)("remaining",n._remaining)("totalprice",n._totalprice)("totalcost",n._totalcost)("netprofit",n._netprofit)("_landcost",n._landcost)("_commission",n._commission)("_taxes",n._taxes)("_cpca",n._cpca)("obj_sellingdate",n.obj_sellingdate)("estimatedcost",n._estimatedcost)("profitdistribution",n.profitdistribution)("projects",n.projects)("projectDetails",n.projectDetails),v(1),T("disabled",!0),v(1),T("projectID",n.projectID),v(1),T("ngIf",n.showinvmenu))},directives:[Cf,wf,us,ki,zn,li,Sn,_r,Dpe,mo,c9,tme,n9,r9,ume,Tme,Fme,tb],pipes:[al,dr],styles:[".custom-dropdown[_ngcontent-%COMP%]{width:300px;height:60px}.list-item[_ngcontent-%COMP%]:hover{cursor:pointer}.tab-container[_ngcontent-%COMP%]{width:100%;max-width:100%;padding:10px;box-sizing:border-box;overflow-x:auto}#projectstable[_ngcontent-%COMP%]{width:100%!important;overflow-x:auto;display:block}.tab-container[_ngcontent-%COMP%] > p-tabView[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[style*=flex][_ngcontent-%COMP%]{flex-wrap:wrap!important;gap:8px}.tab-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex-shrink:0;margin-right:5px}.tab-container[_ngcontent-%COMP%]   p-dropdown[_ngcontent-%COMP%]{min-width:150px;flex-grow:1;max-width:200px}\\.tab-container[_ngcontent-%COMP%]   .btn-project[_ngcontent-%COMP%]{flex-shrink:0}@media (max-width: 768px){.tab-container[_ngcontent-%COMP%]   p-dropdown[_ngcontent-%COMP%]{max-width:100%}.tab-container[_ngcontent-%COMP%] > p-tabView[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[style*=flex][_ngcontent-%COMP%]{justify-content:flex-start}#projectstable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], #projectstable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:normal!important;word-wrap:break-word!important}}  .p-tabview-nav li{flex:0 0 auto}@media (max-width: 600px){  .p-tabview-nav{font-size:14px}}"]}),t})();const wd=Ws_apiUrl,cS={headers:new io({"Content-Type":"application/json"})};let u9=(()=>{class t{constructor(e){this._http=e}getSocieties(){return this._http.get(wd+"getSocieties")}getPlotSizeSummary(e){return this._http.get(wd+"getPlotSizeSummary",{params:{societyid:e.toString()}})}getSocietySummary(e){return this._http.get(wd+"getSocietySummary",{params:{plotsize:e.toString()}})}addSociety(e){const{name:n}=e.value;return this._http.post(wd+"addSociety",{name:n},cS)}updateSociety(e){const{id:n,name:r}=e.value;return console.log(e.value),this._http.post(wd+"updateSociety",{id:n,name:r},cS)}deleteSociety(e){return this._http.delete(`${wd}deleteSociety`,{body:{id:e}})}getSocietyTransactions(e){return this._http.get(wd+"getSocietyTransactions",{params:{society:e.toString()}})}addSocietyTransaction(e){const{society:n,name:r,cnic:o,plotsize:c,amount:u,rebate:m,officeshare:g,recshare:x,recname:S}=e.value;return this._http.post(wd+"addSocietyTransaction",{society:n,name:r,cnic:o,plotsize:c,amount:u,rebate:m,officeshare:g,recshare:x,recname:S},cS)}updateSocietyTransaction(e){const{id:n,name:r,cnic:o,plotsize:c,amount:u,rebate:m,officeshare:g,recshare:x,recname:S}=e.value;return this._http.post(wd+"updateSocietyTransaction",{id:n,name:r,cnic:o,plotsize:c,amount:u,rebate:m,officeshare:g,recshare:x,recname:S},cS)}deleteSocietyTransaction(e){return this._http.delete(`${wd}deleteSocietyTransaction`,{body:{id:e}})}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const uge=["dttransactions"],dge=["dtbranches"];function fge(t,i){if(1&t){const e=Ie();f(0,"div",34),ee(1,"i",35),f(2,"input",36),L("input",function(r){return z(e),A().applyFilterAccount(r,"contains")}),p()()}}function pge(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function hge(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,pge,2,0,"th",37),f(4,"th"),_(5,"Name"),p(),f(6,"th"),_(7,"CNIC"),p(),f(8,"th"),_(9,"Size"),p(),f(10,"th"),_(11,"Amount"),p(),f(12,"th"),_(13,"Rebate"),p(),f(14,"th"),_(15,"Office"),p(),f(16,"th"),_(17,"REC"),p(),f(18,"th"),_(19,"REC Name"),p(),f(20,"th"),_(21,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function mge(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function gge(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.rebate," ","symbol","1.0-0"))}}function _ge(t,i){1&t&&ee(0,"td")}function vge(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.officeshare," ","symbol","1.0-0"))}}function yge(t,i){1&t&&ee(0,"td")}function bge(t,i){if(1&t&&(f(0,"td"),_(1),Ne(2,"currency"),p()),2&t){const e=A().$implicit;v(1),U(He(2,1,e.recshare," ","symbol","1.0-0"))}}function xge(t,i){1&t&&ee(0,"td")}function wge(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,mge,2,1,"td",37),f(4,"td"),_(5),p(),f(6,"td"),_(7),p(),f(8,"td"),_(9),p(),f(10,"td"),_(11),Ne(12,"currency"),p(),D(13,gge,3,6,"td",37),D(14,_ge,1,0,"td",37),D(15,vge,3,6,"td",37),D(16,yge,1,0,"td",37),D(17,bge,3,6,"td",37),D(18,xge,1,0,"td",37),f(19,"td"),_(20),p(),f(21,"td")(22,"button",38),L("click",function(){const o=z(e).$implicit;return A().updateSocietyTransaction(o)}),p(),_(23," \xa0"),f(24,"button",39),L("click",function(){const o=z(e).$implicit;return A().deleteSocietyTransaction(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.name),v(2),U(e.cnic),v(2),U(e.plotsize),v(2),U(He(12,13,e.amount," ","symbol","1.0-0")),v(2),T("ngIf",0!==e.rebate),v(1),T("ngIf",0===e.rebate),v(1),T("ngIf",0!==e.officeshare),v(1),T("ngIf",0===e.officeshare),v(1),T("ngIf",0!==e.recshare),v(1),T("ngIf",0===e.recshare),v(2),U(e.recname)}}function Cge(t,i){if(1&t&&(f(0,"tr"),ee(1,"td")(2,"td")(3,"td"),f(4,"td"),_(5,"Total"),p(),f(6,"td"),_(7),Ne(8,"currency"),p(),f(9,"td"),_(10),Ne(11,"currency"),p(),f(12,"td"),_(13),Ne(14,"currency"),p(),f(15,"td"),_(16),Ne(17,"currency"),p()()),2&t){const e=A();v(7),U(He(8,4,e.total_amount," ","symbol","1.0-0")),v(3),U(He(11,9,e.total_rebate," ","symbol","1.0-0")),v(3),U(He(14,14,e.total_office," ","symbol","1.0-0")),v(3),U(He(17,19,e.total_rec," ","symbol","1.0-0"))}}function Tge(t,i){1&t&&(f(0,"div",40),_(1,"No data found"),p())}function Sge(t,i){1&t&&(f(0,"small",41),_(1," Name is required."),p())}function Ege(t,i){1&t&&(f(0,"small",41),_(1," CNIC is required."),p())}function kge(t,i){1&t&&(f(0,"small",41),_(1," Plot size is required."),p())}function Dge(t,i){1&t&&(f(0,"small",41),_(1," Price is required."),p())}function Ige(t,i){1&t&&(f(0,"small",41),_(1," REC name is required."),p())}function Age(t,i){if(1&t){const e=Ie();f(0,"div",42)(1,"button",43),L("click",function(){z(e);const r=A();return r.saveSocietyTransaction(r.societyForm)}),ee(2,"i",44),_(3," Save "),p(),f(4,"button",45),L("click",function(){return z(e),A().closeModal()}),ee(5,"i",46),_(6," Cancel "),p()()}if(2&t){const e=A();v(1),T("disabled",e.societyForm.invalid)}}function Mge(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),f(3,"th"),_(4,"Plot Size"),p(),f(5,"th"),_(6,"Amount"),p(),f(7,"th"),_(8,"Rebate"),p(),f(9,"th"),_(10,"Office Share"),p(),f(11,"th"),_(12,"REC Share"),p()())}function Fge(t,i){if(1&t&&(f(0,"tr")(1,"td"),_(2),p(),f(3,"td"),_(4),p(),f(5,"td"),_(6),Ne(7,"currency"),p(),f(8,"td"),_(9),Ne(10,"currency"),p(),f(11,"td"),_(12),Ne(13,"currency"),p(),f(14,"td"),_(15),Ne(16,"currency"),p()()),2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(2),U(e.plotsize),v(2),U(He(7,6,e.amount," ","symbol","1.0-0")),v(3),U(He(10,11,e.rebate," ","symbol","1.0-0")),v(3),U(He(13,16,e.officeshare," ","symbol","1.0-0")),v(3),U(He(16,21,e.recshare," ","symbol","1.0-0"))}}function Pge(t,i){if(1&t&&(f(0,"tr"),ee(1,"td"),f(2,"td"),_(3,"Total:"),p(),f(4,"td"),_(5),Ne(6,"currency"),p(),f(7,"td"),_(8),Ne(9,"currency"),p(),f(10,"td"),_(11),Ne(12,"currency"),p(),f(13,"td"),_(14),Ne(15,"currency"),p()()),2&t){const e=A();v(5),U(He(6,4,e.summ_amount," ","symbol","1.0-0")),v(3),U(He(9,9,e.summ_rebate," ","symbol","1.0-0")),v(3),U(He(12,14,e.summ_officeshare," ","symbol","1.0-0")),v(3),U(He(15,19,e.summ_recshare," ","symbol","1.0-0"))}}const Oge=function(){return["name","cnic","recname","plotsize"]},Nge=function(){return{width:"40vw"}},Lge=function(){return{width:"60vw"}},Rge=function(){return{width:"450px"}};let Bge=(()=>{class t{constructor(e,n,r,o,c){this._ms=e,this._ss=n,this.confirmationService=r,this.pdfserv=o,this.exptoexcel=c,this.displayAddAccountModal=!1,this.clickClose=new Et,this.clickAdd=new Et,this.transactions=[],this.headerData=["Name","CNIC","Size","Amount","Rebate","Office","REC","REC Name"],this.headerDataSumm=["Plot Size","Amount","Rebate","Office Share","REC Share"],this.total_amount=0,this.total_rebate=0,this.total_office=0,this.total_rec=0,this.addBranchDialog=!1,this.showSummary=!1,this.summ_amount=0,this.summ_rebate=0,this.summ_officeshare=0,this.summ_recshare=0}ngOnInit(){this.societyForm=new Zn({id:new Me(""),name:new Me("",jt.required),cnic:new Me("",jt.required),plotsize:new Me("",jt.required),amount:new Me("",jt.required),rebate:new Me(""),officeshare:new Me(""),recshare:new Me(""),recname:new Me("",jt.required)}),this.transaction={id:"",name:"",cnic:"",plotsize:"",amount:"",rebate:"",officeshare:"",recshare:"",recname:""}}summaryTransaction(){this.showSummary=!0,this._ss.getPlotSizeSummary(this.societyID).subscribe(e=>{this.branches=e,this.branches.forEach(n=>{this.summ_amount=Number(this.summ_amount)+Number(n.amount),this.summ_rebate=Number(this.summ_rebate)+Number(n.rebate),this.summ_officeshare=Number(this.summ_officeshare)+Number(n.officeshare),this.summ_recshare=Number(this.summ_recshare)+Number(n.recshare)})},e=>{console.log(e)})}closeSummary(){this.showSummary=!1}getSocietyTransactions(){this._ss.getSocietyTransactions(this.societyID).subscribe({next:e=>{this.transactions=e},error:e=>{console.error(e)}})}applyFilterAccount(e,n){this.dttransactions.filterGlobal(e.target.value,n)}isSocietyEmpty(){return 0===this.transactions.length}deleteSocietyTransaction(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._ss.deleteSocietyTransaction(e.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Plot transaction is deleted successfully.",life:3e3}),this.getSocietyTransactions()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting plot transaction.",life:3e3})}})}})}addSocietyTransaction(){this.transaction={id:"",name:"",cnic:"",plotsize:"",amount:"",rebate:"",officeshare:"",recshare:"",recname:""},this.displayAddAccountModal=!0}updateSocietyTransaction(e){this.transaction=Object.assign({},e),this.displayAddAccountModal=!0}closeModal(){this.displayAddAccountModal=!1,this.getSocietyTransactions(),this.clickClose.emit(!0)}hideAddAccountModal(e){this.displayAddAccountModal=!e}saveSocietyTransaction(e){this.transaction.id?(e.value.id=this.transaction.id,e.value.society=this.societyID,this._ss.updateSocietyTransaction(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Plot transaction is updated successfully."}),this.clickAdd.emit(n),this.societyForm.reset(),this.getSocietyTransactions(),this.closeModal()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while updating plot transaction."})}})):(e.value.society=this.societyID,console.log(e.value),this._ss.addSocietyTransaction(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Plot transaction added successfully."}),this.clickAdd.emit(n),this.societyForm.reset(),this.getSocietyTransactions()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while saving plot transaction."})}}))}exportTableToExcel(){const e=this.toExcelFormat(),n=this.toExcelFooterFormat();this.exptoexcel.exportExcel(e,this.headerData,n,"Society_Investment_"+ui())}exportTableToPdf(){const e=this.toPdfFormat(),n=this.toPdfFooterFormat();this.pdfserv.generatePdf(this.headerData,e,n,"Society_Investment_"+ui())}toExcelFormat(){let e=[];e.push(this.headerData);for(var n=0;n<this.transactions.length;n++)e.push([this.transactions[n].name,this.transactions[n].cnic,this.transactions[n].plotsize,this.transactions[n].amount.toLocaleString(),this.transactions[n].rebate.toLocaleString(),this.transactions[n].officeshare.toLocaleString(),this.transactions[n].recshare.toLocaleString(),this.transactions[n].recname]);return e}toPdfFormat(){let e=[];for(var n=0;n<this.transactions.length;n++)e.push([this.transactions[n].name,this.transactions[n].cnic,this.transactions[n].plotsize,this.transactions[n].amount.toLocaleString(),this.transactions[n].rebate.toLocaleString(),this.transactions[n].officeshare.toLocaleString(),this.transactions[n].recshare.toLocaleString(),this.transactions[n].recname]);return e}toPdfFooterFormat(){let e=[];return e.push(["","","Total",this.total_amount.toLocaleString(),this.total_rebate.toLocaleString(),this.total_office.toLocaleString(),this.total_rec.toLocaleString()]),e}toExcelFooterFormat(){let e=[];return e.push(["","","Total",this.total_amount.toLocaleString(),this.total_rebate.toLocaleString(),this.total_office.toLocaleString(),this.total_rec.toLocaleString()]),e}exportTableToExcelSumm(){const e=this.toExcelFormatSumm(),n=this.toExcelFooterFormatSumm();this.exptoexcel.exportExcel(e,this.headerDataSumm,n,"Society_Summary_"+ui())}exportTableToPdfSumm(){const e=this.toPdfFormatSumm(),n=this.toPdfFooterFormatSumm();this.pdfserv.generatePdf(this.headerDataSumm,e,n,"Society_Summary_"+ui())}toExcelFormatSumm(){let e=[];e.push(this.headerDataSumm);for(var n=0;n<this.branches.length;n++)e.push([this.branches[n].plotsize.toLocaleString(),this.branches[n].amount.toLocaleString(),this.branches[n].rebate.toLocaleString(),this.branches[n].officeshare.toLocaleString(),this.branches[n].recshare.toLocaleString()]);return e}toPdfFormatSumm(){let e=[];for(var n=0;n<this.branches.length;n++)e.push([this.branches[n].plotsize.toLocaleString(),this.branches[n].amount.toLocaleString(),this.branches[n].rebate.toLocaleString(),this.branches[n].officeshare.toLocaleString(),this.branches[n].recshare.toLocaleString()]);return e}toPdfFooterFormatSumm(){let e=[];return e.push(["Total",this.summ_amount.toLocaleString(),this.summ_rebate.toLocaleString(),this.summ_officeshare.toLocaleString(),this.summ_recshare.toLocaleString()]),e}toExcelFooterFormatSumm(){let e=[];return e.push(["Total",this.summ_amount.toLocaleString(),this.summ_rebate.toLocaleString(),this.summ_officeshare.toLocaleString(),this.summ_recshare.toLocaleString()]),e}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(u9),te(Un),te(hs),te(Ko))},t.\u0275cmp=dn({type:t,selectors:[["app-society"]],viewQuery:function(e,n){if(1&e&&(Mt(uge,5),Mt(dge,5)),2&e){let r;xt(r=wt())&&(n.dttransactions=r.first),xt(r=wt())&&(n.dtbranches=r.first)}},inputs:{displayAddAccountModal:"displayAddAccountModal",transactions:"transactions",transaction:"transaction",societyID:"societyID",total_amount:"total_amount",total_rebate:"total_rebate",total_office:"total_office",total_rec:"total_rec"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd"},features:[Nn([kn,Un])],decls:77,vars:42,consts:[[1,"project-btn-group","project-btn-group--spaced"],[1,"btn-project",3,"click"],[1,"bi","bi-plus-lg"],[1,"bi","bi-clipboard-data"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dttransactions",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[1,"project-btn-group","project-btn-group--right","project-btn-group--spaced"],[1,"btn-project","btn-sm",3,"click"],["style","text-align: center;",4,"ngIf"],["header","Plot File Transaction",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[3,"formGroup"],[1,"p-fluid","formgrid"],[1,"row"],[1,"field","col-12","col-md-6"],["for","name"],["pInputText","","type","text","id","name","name","name","formControlName","name",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],["for","title"],["pInputText","","type","text","id","cnic","name","cnic","formControlName","cnic",3,"ngModel","ngModelChange"],["pInputText","","type","text","id","plotsize","name","plotsize","formControlName","plotsize",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","amount","name","amount","formControlName","amount",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","rebate","name","rebate","formControlName","rebate",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","officeshare","name","officeshare","formControlName","officeshare",3,"ngModel","ngModelChange"],["pInputText","","type","number","id","recshare","name","recshare","formControlName","recshare",3,"ngModel","ngModelChange"],["pInputText","","type","text","id","recname","name","recname","formControlName","recname",3,"ngModel","ngModelChange"],["header","Summary",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows"],["dtbranches",""],["position","bottom-right"],["acceptButtonStyleClass","btn-project","rejectButtonStyleClass","btn-project","acceptLabel","Yes","rejectLabel","No"],[2,"text-align","right"],[1,"fas","fa-search",2,"margin","4px 4px 0 0"],["type","text","pInputText","","size","50","placeholder","Search..",2,"width","200px",3,"input"],[4,"ngIf"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"],[1,"p-error","block"],[1,"project-btn-group","project-btn-group--center"],["icon","pi pi-check","type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["icon","pi pi-times","type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-circle"]],template:function(e,n){1&e&&(f(0,"div",0)(1,"button",1),L("click",function(){return n.addSocietyTransaction()}),ee(2,"i",2),_(3," Add New "),p(),f(4,"button",1),L("click",function(){return n.summaryTransaction()}),ee(5,"i",3),_(6," Summary "),p()(),f(7,"p-table",4,5),D(9,fge,3,0,"ng-template",6),D(10,hge,22,1,"ng-template",7),D(11,wge,25,18,"ng-template",8),D(12,Cge,18,24,"ng-template",9),p(),f(13,"div",10)(14,"button",11),L("click",function(){return n.exportTableToExcel()}),_(15,"Excel"),p(),f(16,"button",11),L("click",function(){return n.exportTableToPdf()}),_(17,"Pdf"),p()(),D(18,Tge,2,0,"div",12),f(19,"p-dialog",13),L("visibleChange",function(o){return n.displayAddAccountModal=o})("onHide",function(){return n.closeModal()}),f(20,"form",14)(21,"div",15)(22,"div",16)(23,"div",17)(24,"label",18),_(25,"Name"),p(),f(26,"input",19),L("ngModelChange",function(o){return n.transaction.name=o}),p(),D(27,Sge,2,0,"small",20),p(),f(28,"div",17)(29,"label",21),_(30,"CNIC"),p(),f(31,"input",22),L("ngModelChange",function(o){return n.transaction.cnic=o}),p(),D(32,Ege,2,0,"small",20),p()(),f(33,"div",16)(34,"div",17)(35,"label",21),_(36,"Plot Size"),p(),f(37,"input",23),L("ngModelChange",function(o){return n.transaction.plotsize=o}),p(),D(38,kge,2,0,"small",20),p(),f(39,"div",17)(40,"label",21),_(41,"Downpayment/Amount"),p(),f(42,"input",24),L("ngModelChange",function(o){return n.transaction.amount=o}),p(),D(43,Dge,2,0,"small",20),p()(),f(44,"div",16)(45,"div",17)(46,"label",21),_(47,"Rebate"),p(),f(48,"input",25),L("ngModelChange",function(o){return n.transaction.rebate=o}),p()(),f(49,"div",17)(50,"label",21),_(51,"Office Share %"),p(),f(52,"input",26),L("ngModelChange",function(o){return n.transaction.officeshare=o}),p()()(),f(53,"div",16)(54,"div",17)(55,"label",21),_(56,"REC Share %"),p(),f(57,"input",27),L("ngModelChange",function(o){return n.transaction.recshare=o}),p()(),f(58,"div",17)(59,"label",21),_(60,"REC Name"),p(),f(61,"input",28),L("ngModelChange",function(o){return n.transaction.recname=o}),p(),D(62,Ige,2,0,"small",20),p()()()(),D(63,Age,7,1,"ng-template",9),p(),f(64,"p-dialog",29),L("visibleChange",function(o){return n.showSummary=o})("onHide",function(){return n.closeSummary()}),f(65,"p-table",30,31),D(67,Mge,13,0,"ng-template",7),D(68,Fge,17,26,"ng-template",8),D(69,Pge,16,24,"ng-template",9),p(),f(70,"div",10)(71,"button",11),L("click",function(){return n.exportTableToExcelSumm()}),_(72,"Excel"),p(),f(73,"button",11),L("click",function(){return n.exportTableToPdfSumm()}),_(74,"Pdf"),p()()(),ee(75,"p-toast",32)(76,"p-confirmDialog",33)),2&e&&(v(7),T("value",n.transactions)("paginator",!0)("rows",10)("globalFilterFields",rt(38,Oge)),v(11),T("ngIf",n.isSocietyEmpty()),v(1),Ft(rt(39,Nge)),T("visible",n.displayAddAccountModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("formGroup",n.societyForm),v(6),T("ngModel",n.transaction.name),v(1),T("ngIf",n.societyForm.controls.name.invalid&&n.societyForm.controls.name.dirty),v(4),T("ngModel",n.transaction.cnic),v(1),T("ngIf",n.societyForm.controls.cnic.invalid&&n.societyForm.controls.cnic.dirty),v(5),T("ngModel",n.transaction.plotsize),v(1),T("ngIf",n.societyForm.controls.plotsize.invalid&&n.societyForm.controls.plotsize.dirty),v(4),T("ngModel",n.transaction.amount),v(1),T("ngIf",n.societyForm.controls.amount.invalid&&n.societyForm.controls.amount.dirty),v(5),T("ngModel",n.transaction.rebate),v(4),T("ngModel",n.transaction.officeshare),v(5),T("ngModel",n.transaction.recshare),v(4),T("ngModel",n.transaction.recname),v(1),T("ngIf",n.societyForm.controls.recname.invalid&&n.societyForm.controls.recname.dirty),v(2),Ft(rt(40,Lge)),T("visible",n.showSummary)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("value",n.branches)("paginator",!0)("rows",10),v(11),Ft(rt(41,Rge)))},directives:[ki,zn,li,Sn,_r,ms,Hr,Ur,Pr,Ir,Er,zr,qo,fr,mo],pipes:[dr],styles:[""]}),t})();const jge=["dtaccount"],Vge=["tabView"],Uge=["menustab"];function Hge(t,i){1&t&&(f(0,"small",27),_(1," Name is required. "),p())}function zge(t,i){if(1&t){const e=Ie();f(0,"div",28),ee(1,"i",29),f(2,"input",30),L("input",function(r){return z(e),A().applyFilterAccount(r,"contains")}),p()()}}function $ge(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function Wge(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,$ge,2,0,"th",31),f(4,"th"),_(5,"Name"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function qge(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function Gge(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,qge,2,1,"td",31),f(4,"td",32),L("click",function(){const o=z(e).$implicit;return A().toggle(o)}),_(5),p(),f(6,"td")(7,"button",33),L("click",function(){const o=z(e).$implicit;return A().updateSociety(o)}),p(),_(8," \xa0"),f(9,"button",34),L("click",function(){const o=z(e).$implicit;return A().deleteSociety(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.name)}}function Kge(t,i){1&t&&(f(0,"div",35),_(1,"No data found"),p())}const Yge=function(){return["name"]},Xge=function(){return{width:"450px"}};let Qge=(()=>{class t{constructor(e,n,r){this.messageService=e,this._ss=n,this.confirmationService=r,this.recordedyears=[],this.activeIndex=0,this.transactions=[],this.total_amount=0,this.total_rebate=0,this.total_office=0,this.total_rec=0}ngOnInit(){this.society={id:"",name:""},this.societyForm=new Zn({id:new Me(""),name:new Me("",jt.required)}),this.getSocieties()}getSocieties(){this._ss.getSocieties().subscribe({next:e=>{this.recordedyears=e},error:e=>{console.error(e)}})}toggle(e){this.menustab.disabled=!1,this.societyID=e.id,this.getSocietyTransactions(),this.activeIndex=1}summaryTransaction(){this.activeIndex=2}getSocietyTransactions(){this.total_amount=0,this.total_office=0,this.total_rebate=0,this.total_rec=0,this._ss.getSocietyTransactions(this.societyID).subscribe({next:e=>{this.transactions=e,this.transactions.forEach(n=>{console.log(n),this.total_amount=this.total_amount+n.amount,this.total_office=this.total_office+n.officeshare,this.total_rebate=this.total_rebate+n.rebate,this.total_rec=this.total_rec+n.recshare})},error:e=>{console.error(e)}})}applyFilterAccount(e,n){this.dtaccount.filterGlobal(e.target.value,n)}addNewSociety(e){this.society.id?(e.value.id=this.society.id,this._ss.updateSociety(e).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Society is update succesfully.",life:3e3}),this.societyForm.reset(),this.getSocieties()},error:n=>{this.messageService.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while updating new society.",life:3e3})}})):this._ss.addSociety(e).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Society is added succesfully.",life:3e3}),this.societyForm.reset(),this.getSocieties()},error:n=>{this.messageService.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message}:{severity:"erro",summary:"Error",detail:"Error occurred while adding new society.",life:3e3})}})}updateSociety(e){this.society=e}deleteSociety(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._ss.deleteSociety(e.id.toString()).subscribe({next:n=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Society is deleted successfully.",life:3e3}),this.getSocieties()},error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error occurred while deleting society.",life:3e3})}})}})}isSocietyEmpty(){return 0===this.recordedyears.length}resetForm(){this.societyForm.reset()}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(u9),te(Un))},t.\u0275cmp=dn({type:t,selectors:[["app-realestate"]],viewQuery:function(e,n){if(1&e&&(Mt(jge,5),Mt(Vge,5),Mt(Uge,5)),2&e){let r;xt(r=wt())&&(n.dtaccount=r.first),xt(r=wt())&&(n.tabView=r.first),xt(r=wt())&&(n.menustab=r.first)}},features:[Nn([kn,Un])],decls:33,vars:21,consts:[[1,"text-muted"],[3,"activeIndex","activeIndexChange"],["tabView",""],["header","Societies"],[3,"formGroup"],[1,"row"],[1,"col-lg-3","col-md-3","col-sm-3"],[1,"form-group"],["for","name",2,"margin-right","10px"],["pInputText","","type","text","id","name","name","name","formControlName","name",1,"form-control",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check2-circle"],["type","button",1,"btn-project",3,"click"],[1,"bi","bi-arrow-counterclockwise"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dtaccount",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],["header","Society Details",3,"disabled"],["menustab",""],[3,"societyID","transactions","total_amount","total_rebate","total_office","total_rec"],["position","bottom-right"],["acceptButtonStyleClass","btn-project","rejectButtonStyleClass","btn-project","acceptLabel","Yes","rejectLabel","No"],[1,"p-error","block"],[2,"text-align","right"],[1,"fas","fa-search",2,"margin","4px 4px 0 0"],["type","text","pInputText","","size","50","placeholder","Search..",2,"width","200px",3,"input"],[4,"ngIf"],[1,"list-item",3,"click"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"]],template:function(e,n){1&e&&(f(0,"h2",0),_(1,"Manage Societies"),p(),ee(2,"hr"),f(3,"p-tabView",1,2),L("activeIndexChange",function(o){return n.activeIndex=o}),f(5,"p-tabPanel",3)(6,"form",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"label",8),_(11,"Name"),p(),f(12,"input",9),L("ngModelChange",function(o){return n.society.name=o}),p(),D(13,Hge,2,0,"small",10),p()()(),f(14,"div",11)(15,"button",12),L("click",function(){return n.addNewSociety(n.societyForm)}),ee(16,"i",13),_(17," Save "),p(),f(18,"button",14),L("click",function(){return n.resetForm()}),ee(19,"i",15),_(20," Clear "),p()()(),ee(21,"hr"),f(22,"p-table",16,17),D(24,zge,3,0,"ng-template",18),D(25,Wge,8,1,"ng-template",19),D(26,Gge,10,3,"ng-template",20),p(),D(27,Kge,2,0,"div",21),p(),f(28,"p-tabPanel",22,23),ee(30,"app-society",24),p()(),ee(31,"p-toast",25)(32,"p-confirmDialog",26)),2&e&&(v(3),T("activeIndex",n.activeIndex),v(3),T("formGroup",n.societyForm),v(6),T("ngModel",n.society.name),v(1),T("ngIf",n.societyForm.controls.name.invalid&&n.societyForm.controls.name.dirty),v(2),T("disabled",n.societyForm.invalid),v(7),T("value",n.recordedyears)("paginator",!0)("rows",10)("globalFilterFields",rt(19,Yge)),v(5),T("ngIf",n.isSocietyEmpty()),v(1),T("disabled",!0),v(2),T("societyID",n.societyID)("transactions",n.transactions)("total_amount",n.total_amount)("total_rebate",n.total_rebate)("total_office",n.total_office)("total_rec",n.total_rec),v(2),Ft(rt(20,Xge)))},directives:[Cf,wf,Hr,Ur,Pr,Ir,li,Er,zr,Sn,ki,zn,_r,Bge,fr,mo],styles:[".list-item[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),t})();const Bm=Ws_apiUrl,vM={headers:new io({"Content-Type":"application/json"})};let Jge=(()=>{class t{constructor(e){this._http=e}getModules(){return this._http.get(Bm+"getModules")}getModulesforRole(e){return this._http.get(Bm+"getModulesforRole",{params:{id:e.toString()}})}getRoles(){return this._http.get(Bm+"getRoles")}addRole(e){const{role:n}=e.value;return this._http.post(Bm+"addRole",{role:n},vM)}addRoleModules(e,n){return this._http.post(Bm+"addRoleModules",{roleid:e,modules:n},vM)}updateRole(e){const{id:n,role:r}=e.value;return this._http.post(Bm+"updateRole",{id:n,role:r},vM)}deleteRole(e){return this._http.delete(`${Bm}deleteRole`,{body:{id:e}})}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Zge=["dtaccount"];function e0e(t,i){if(1&t){const e=Ie();f(0,"div",25),ee(1,"i",26),f(2,"input",27),L("input",function(r){return z(e),A().applyFilterAccount(r,"contains")}),p()()}}function t0e(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function n0e(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,t0e,2,0,"th",28),f(4,"th"),_(5,"Role"),p(),f(6,"th"),_(7,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function i0e(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.roleid)}}function r0e(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,i0e,2,1,"td",28),f(4,"td",29),L("click",function(){const o=z(e).$implicit;return A().showModules(o)}),_(5),p(),f(6,"td")(7,"button",30),L("click",function(){const o=z(e).$implicit;return A().updateAccount(o)}),p(),_(8," \xa0"),f(9,"button",31),L("click",function(){const o=z(e).$implicit;return A().deleteAccount(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(2),U(e.roletype)}}function o0e(t,i){1&t&&(f(0,"div",32),_(1,"No data found"),p())}function s0e(t,i){1&t&&(f(0,"small",33),_(1," Role is required."),p())}function a0e(t,i){if(1&t){const e=Ie();f(0,"div",34)(1,"p-checkbox",35,36),L("onChange",function(r){return z(e),A().addModule(r)})("ngModelChange",function(r){return z(e),A().selectedModules=r}),p(),f(3,"label",37),_(4),p()()}if(2&t){const e=i.$implicit,n=A();v(1),T("value",e)("ngModel",n.selectedModules)("inputId",e.name),v(2),T("for",e.name),v(1),U(e.name)}}const l0e=function(){return["roletype"]},d9=function(){return{width:"25vw"}},c0e=function(){return{width:"450px"}};let u0e=(()=>{class t{constructor(e,n,r){this._ms=e,this._rs=n,this.confirmationService=r,this.displayAddAccountModal=!1,this.showModuleModal=!1,this.clickClose=new Et,this.clickAdd=new Et,this.users=[],this.modules=[],this.selectedModules=[],this.modulesForRole=[],this.moduleschecked=[],this.roletypes=[],this.moduleCheckedState={},this.selected=!0,this.role={id:"",role:""}}ngOnInit(){this.roleForm=new Zn({id:new Me(""),role:new Me("",jt.required)}),this.getRoleTypes(),this.getModules()}loadModulesForRole(e){this._rs.getModulesforRole(e).subscribe(n=>{this.modulesForRole=n,this.selectedModules=this.modules,this.selectedModules=this.selectedModules.filter(r=>this.modulesForRole.some(o=>r.id===o.id))})}getRoleTypes(){this._rs.getRoles().subscribe({next:e=>{this.roletypes=e},error:e=>{console.error(e)}})}closeModal(){this.displayAddAccountModal=!1,this.getRoleTypes(),this.clickClose.emit(!0),this.selectedModules=[]}closeModuleModal(){this.showModuleModal=!1}hideAddAccountModal(e){this.displayAddAccountModal=!e}applyFilterAccount(e,n){this.dtaccount.filterGlobal(e.target.value,n)}showAddUserDialog(){this.role={id:"",role:""},this.displayAddAccountModal=!0}saveRole(e){this.role.id?(e.value.id=this.role.id,this._rs.updateRole(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Role is updated successfully."}),this.roleForm.reset(),this.getRoleTypes(),this.closeModal()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message,life:3e3}:{severity:"error",summary:"Error",detail:"Error occurred while updating role."})}})):this._rs.addRole(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"Role added successfully."}),this.clickAdd.emit(n),this.roleForm.reset(),this.getRoleTypes()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message,life:3e3}:{severity:"error",summary:"Error",detail:"Error occurred while saving user."})}})}addNewRole(){this.role={id:"",role:""},this.displayAddAccountModal=!0}updateAccount(e){this.role=e,this.displayAddAccountModal=!0}deleteAccount(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._rs.deleteRole(e.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"Role is deleted successfully.",life:3e3}),this.getRoleTypes()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting role.",life:3e3})}})}})}isAccountEmpty(){return 0===this.roletypes.length}showModules(e){this.role=e,this.loadModulesForRole(this.role.id),this.showModuleModal=!0}saveRoleModule(){this._rs.addRoleModules(this.role.id,this.moduleschecked).subscribe({next:e=>{this._ms.add({severity:"success",summary:"Success",detail:"Modules added to role successfully."}),this.getRoleTypes(),this.closeModuleModal(),location.reload()},error:e=>{this._ms.add(409==e.status?{severity:"error",summary:"Error",detail:e.error.message,life:3e3}:{severity:"error",summary:"Error",detail:"Error occurred while adding modules to role."})}})}getModules(){this._rs.getModules().subscribe({next:e=>{this.modules=e},error:e=>{console.error(e)}})}addModule(e){this.moduleschecked=e.checked}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(Jge),te(Un))},t.\u0275cmp=dn({type:t,selectors:[["app-roles"]],viewQuery:function(e,n){if(1&e&&Mt(Zge,5),2&e){let r;xt(r=wt())&&(n.dtaccount=r.first)}},inputs:{displayAddAccountModal:"displayAddAccountModal",showModuleModal:"showModuleModal"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd"},features:[Nn([kn,Un])],decls:40,vars:30,consts:[[1,"text-muted"],["aria-label","Add Role",1,"btn-project",3,"click"],[1,"bi","bi-plus-lg"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dtaccount",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],["header","Roles Info",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[3,"formGroup"],[1,"p-fluid","grid","formgrid"],[1,"field","col-12","col-md-12"],["for","name"],["autocomplete","off","pInputText","","type","text","id","role","name","role","formControlName","role",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check-lg"],["type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-lg"],["header","Add/Remove Modules",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],["class","field-checkbox",4,"ngFor","ngForOf"],["position","bottom-right"],["acceptButtonStyleClass","btn-project","rejectButtonStyleClass","btn-project"],[2,"text-align","right"],[1,"fas","fa-search",2,"margin","4px 4px 0 0"],["type","text","pInputText","","size","50","placeholder","Search..",2,"width","200px",3,"input"],[4,"ngIf"],[1,"list-item",3,"click"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"],[1,"p-error","block"],[1,"field-checkbox"],["name","group","value","module",3,"value","ngModel","inputId","onChange","ngModelChange"],["myCheckbox",""],[3,"for"]],template:function(e,n){1&e&&(f(0,"h2",0),_(1,"Manage Roles"),p(),ee(2,"hr"),f(3,"button",1),L("click",function(){return n.showAddUserDialog()}),ee(4,"i",2),_(5," Add New\n"),p(),f(6,"p-table",3,4),D(8,e0e,3,0,"ng-template",5),D(9,n0e,8,1,"ng-template",6),D(10,r0e,10,3,"ng-template",7),p(),D(11,o0e,2,0,"div",8),f(12,"p-dialog",9),L("visibleChange",function(o){return n.displayAddAccountModal=o})("onHide",function(){return n.closeModal()}),f(13,"form",10)(14,"div",11)(15,"div",12)(16,"label",13),_(17,"Role Type"),p(),f(18,"input",14),L("ngModelChange",function(o){return n.role.roletype=o}),p(),D(19,s0e,2,0,"small",15),p()(),f(20,"div",16)(21,"button",17),L("click",function(){return n.saveRole(n.roleForm)}),ee(22,"i",18),_(23," Save "),p(),f(24,"button",19),L("click",function(){return n.closeModal()}),ee(25,"i",20),_(26," Cancel "),p()()()(),f(27,"p-dialog",21),L("visibleChange",function(o){return n.showModuleModal=o})("onHide",function(){return n.closeModuleModal()}),f(28,"div",11)(29,"div",12),D(30,a0e,5,5,"div",22),p()(),f(31,"div",16)(32,"button",19),L("click",function(){return n.saveRoleModule()}),ee(33,"i",18),_(34," Save "),p(),f(35,"button",19),L("click",function(){return n.closeModuleModal()}),ee(36,"i",20),_(37," Cancel "),p()()(),ee(38,"p-toast",23)(39,"p-confirmDialog",24)),2&e&&(v(6),T("value",n.roletypes)("paginator",!0)("rows",10)("globalFilterFields",rt(26,l0e)),v(5),T("ngIf",n.isAccountEmpty()),v(1),Ft(rt(27,d9)),T("visible",n.displayAddAccountModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("formGroup",n.roleForm),v(5),T("ngModel",n.role.roletype),v(1),T("ngIf",n.roleForm.controls.role.invalid&&n.roleForm.controls.role.dirty),v(2),T("disabled",n.roleForm.invalid),v(6),Ft(rt(28,d9)),T("visible",n.showModuleModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(3),T("ngForOf",n.modules),v(9),Ft(rt(29,c0e)))},directives:[ki,zn,li,Sn,_r,ms,Hr,Ur,Pr,Ir,Er,zr,nc,ST,md,fr,mo],styles:[".list-item[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),t})();const rb=Ws_apiUrl,f9={headers:new io({"Content-Type":"application/json"})};let d0e=(()=>{class t{constructor(e){this._http=e}getRoles(){return this._http.get(rb+"getRoles")}addUser(e){const{name:n,role:r}=e.value;return this._http.post(rb+"addUser",{name:n,email:e.value.field1,password:e.value.field2,role:r},f9)}updateUser(e){const{id:n,name:r,role:o}=e.value;return this._http.post(rb+"updateUser",{id:n,name:r,email:e.value.field1,password:e.value.field2,role:o},f9)}getUsers(){return this._http.get(rb+"getUsers")}deleteUser(e){return this._http.delete(`${rb}deleteUser`,{body:{id:e}})}}return t.\u0275fac=function(e){return new(e||t)(zt($s))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const f0e=["dtaccount"];function p0e(t,i){if(1&t){const e=Ie();f(0,"div",29),ee(1,"i",30),f(2,"input",31),L("input",function(r){return z(e),A().applyFilterAccount(r,"contains")}),p()()}}function h0e(t,i){1&t&&(f(0,"th"),_(1,"ID"),p())}function m0e(t,i){1&t&&(f(0,"tr")(1,"th"),_(2,"Sr#"),p(),D(3,h0e,2,0,"th",32),f(4,"th"),_(5,"Name"),p(),f(6,"th"),_(7,"Email"),p(),f(8,"th"),_(9,"Role"),p(),f(10,"th"),_(11,"Action"),p()()),2&t&&(v(3),T("ngIf",!1))}function g0e(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.id)}}function _0e(t,i){if(1&t&&(f(0,"td"),_(1),p()),2&t){const e=A().$implicit;v(1),U(e.roleid)}}function v0e(t,i){if(1&t){const e=Ie();f(0,"tr")(1,"td"),_(2),p(),D(3,g0e,2,1,"td",32),D(4,_0e,2,1,"td",32),f(5,"td"),_(6),p(),f(7,"td"),_(8),p(),f(9,"td"),_(10),p(),f(11,"td")(12,"button",33),L("click",function(){const o=z(e).$implicit;return A().updateAccount(o)}),p(),_(13," \xa0"),f(14,"button",34),L("click",function(){const o=z(e).$implicit;return A().deleteAccount(o)}),p()()()}if(2&t){const e=i.$implicit,n=i.rowIndex;v(2),U(n+1),v(1),T("ngIf",!1),v(1),T("ngIf",!1),v(2),U(e.name),v(2),U(e.email),v(2),U(e.role)}}function y0e(t,i){1&t&&(f(0,"div",35),_(1,"No data found"),p())}function b0e(t,i){1&t&&(f(0,"small",36),_(1," Name is required."),p())}function x0e(t,i){1&t&&(f(0,"small",36),_(1," Email is required."),p())}function w0e(t,i){1&t&&(f(0,"small",36),_(1," Password is required."),p())}function C0e(t,i){if(1&t&&(f(0,"div")(1,"div"),_(2),p()()),2&t){const e=A(2);v(2),U(e.selectedRoletype)}}function T0e(t,i){1&t&&D(0,C0e,3,1,"div",32),2&t&&T("ngIf",A().selectedRoletype)}function S0e(t,i){if(1&t&&(f(0,"div",37)(1,"div"),_(2),p()()),2&t){const e=i.$implicit;v(2),U(e.roletype)}}function E0e(t,i){1&t&&(f(0,"small",36),_(1," Role is required."),p())}const k0e=function(){return["name","email"]},D0e=function(){return{width:"25vw"}},I0e=function(){return{width:"295px"}},A0e=function(){return{width:"450px"}},M0e=[{path:"login",component:IL},{path:"dashboard",component:$$,canActivate:[ja]},{path:"projects",component:cge,canActivate:[ja]},{path:"projectcost",component:n9,canActivate:[ja]},{path:"projectsale",component:r9,canActivate:[ja]},{path:"laboursheet",component:c9,canActivate:[ja]},{path:"investors",component:Yfe,canActivate:[ja]},{path:"bankingrecord",component:Ite,canActivate:[ja]},{path:"plot",component:sue,canActivate:[ja]},{path:"novita",component:lse,canActivate:[ja]},{path:"novitarealestate",component:Qge,canActivate:[ja]},{path:"adduser",component:(()=>{class t{constructor(e,n,r){this._ms=e,this._user=n,this.confirmationService=r,this.displayAddAccountModal=!1,this.clickClose=new Et,this.clickAdd=new Et,this.users=[],this.useraccount={id:"",name:"",field1:"",field2:"",role:""}}ngOnInit(){this.userForm=new Zn({id:new Me(""),name:new Me("",jt.required),field1:new Me("",jt.required),field2:new Me("",jt.required),role:new Me("",jt.required)}),this.getUsers(),this.getRoleTypes(),this.userForm.reset()}getRoleTypes(){this._user.getRoles().subscribe(e=>{this.roletypes=e},e=>{console.log(e)})}closeModal(){this.displayAddAccountModal=!1,this.getUsers(),this.clickClose.emit(!0)}hideAddAccountModal(e){this.displayAddAccountModal=!e}applyFilterAccount(e,n){this.dtaccount.filterGlobal(e.target.value,n)}showAddUserDialog(){this.useraccount={id:"",name:"",field1:"",field2:"",role:""},this.displayAddAccountModal=!0}saveUser(e){this.useraccount.id?(e.value.id=this.useraccount.id,this._user.updateUser(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"User is updated successfully."}),this.userForm.reset(),this.getUsers(),this.closeModal()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message,life:3e3}:{severity:"error",summary:"Error",detail:"Error occurred while updating user."})}})):this._user.addUser(e).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Success",detail:"User added successfully."}),this.clickAdd.emit(n),this.userForm.reset(),this.getUsers()},error:n=>{this._ms.add(409==n.status?{severity:"error",summary:"Error",detail:n.error.message,life:3e3}:{severity:"error",summary:"Error",detail:"Error occurred while saving user."})}})}getUsers(){this._user.getUsers().subscribe({next:e=>{this.users=e},error:e=>{console.error(e)}})}addNewUser(){this.useraccount={id:"",name:"",field1:"",field2:"",role:""},this.displayAddAccountModal=!0}updateAccount(e){this.useraccount=e,this.selectedRoletype=e.roleid,this.displayAddAccountModal=!0}deleteAccount(e){this.confirmationService.confirm({message:"Are you sure you want to delete this record ? ",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this._user.deleteUser(e.id.toString()).subscribe({next:n=>{this._ms.add({severity:"success",summary:"Successful",detail:"User is deleted successfully.",life:3e3}),this.getUsers()},error:n=>{this._ms.add({severity:"error",summary:"Error",detail:"Error occurred while deleting user.",life:3e3})}})}})}isAccountEmpty(){return 0===this.users.length}}return t.\u0275fac=function(e){return new(e||t)(te(kn),te(d0e),te(Un))},t.\u0275cmp=dn({type:t,selectors:[["app-user"]],viewQuery:function(e,n){if(1&e&&Mt(f0e,5),2&e){let r;xt(r=wt())&&(n.dtaccount=r.first)}},inputs:{displayAddAccountModal:"displayAddAccountModal"},outputs:{clickClose:"clickClose",clickAdd:"clickAdd"},features:[Nn([kn,Un])],decls:46,vars:33,consts:[[1,"text-muted"],["aria-label","Add User",1,"btn-project",3,"click"],[1,"bi","bi-plus-lg"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","globalFilterFields"],["dtaccount",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["style","text-align: center;",4,"ngIf"],["header","User Details",3,"visible","modal","draggable","resizable","responsive","visibleChange","onHide"],[3,"formGroup"],[1,"p-fluid","grid","formgrid"],[1,"field","col-12","col-md-12"],["for","name"],["autocomplete","off","pInputText","","type","text","id","name","name","name","formControlName","name",3,"ngModel","ngModelChange"],["class","p-error block",4,"ngIf"],["for","title"],["autocomplete","off","pInputText","","type","text","id","field1","name","field1","formControlName","field1",3,"ngModel","ngModelChange"],["autocomplete","off","pInputText","","type","password","id","field2","name","field2","formControlName","field2",3,"ngModel","ngModelChange"],[1,"field","col-12","col-md-4"],["id","roletype","name","roletype","optionValue","id","optionLabel","roletype","filterBy","roletype","placeholder","Select Role","appendTo","body","formControlName","role","autoWidth","false",3,"options","filter","showClear","ngModel","ngModelChange"],["class","custom-dropdown"],[1,"project-btn-group","project-btn-group--center","project-btn-group--spaced"],["type","button",1,"btn-project",3,"disabled","click"],[1,"bi","bi-check-lg"],["type","button",1,"btn-project",3,"click"],[1,"bi","bi-x-lg"],["position","bottom-right"],["acceptButtonStyleClass","btn-project","rejectButtonStyleClass","btn-project"],[2,"text-align","right"],[1,"fas","fa-search",2,"margin","4px 4px 0 0"],["type","text","pInputText","","size","50","placeholder","Search..",2,"width","200px",3,"input"],[4,"ngIf"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[2,"text-align","center"],[1,"p-error","block"],[1,"flex","align-items-center","gap-2"]],template:function(e,n){1&e&&(f(0,"h2",0),_(1,"Manage Users"),p(),ee(2,"hr"),f(3,"button",1),L("click",function(){return n.showAddUserDialog()}),ee(4,"i",2),_(5," Add New\n"),p(),f(6,"p-table",3,4),D(8,p0e,3,0,"ng-template",5),D(9,m0e,12,1,"ng-template",6),D(10,v0e,15,6,"ng-template",7),p(),D(11,y0e,2,0,"div",8),f(12,"p-dialog",9),L("visibleChange",function(o){return n.displayAddAccountModal=o})("onHide",function(){return n.closeModal()}),f(13,"form",10)(14,"div",11)(15,"div",12)(16,"label",13),_(17,"Name"),p(),f(18,"input",14),L("ngModelChange",function(o){return n.useraccount.name=o}),p(),D(19,b0e,2,0,"small",15),p(),f(20,"div",12)(21,"label",16),_(22,"Email"),p(),f(23,"input",17),L("ngModelChange",function(o){return n.useraccount.field1=o}),p(),D(24,x0e,2,0,"small",15),p(),f(25,"div",12)(26,"label",16),_(27,"Password"),p(),f(28,"input",18),L("ngModelChange",function(o){return n.useraccount.field2=o}),p(),D(29,w0e,2,0,"small",15),p(),f(30,"div",19)(31,"label",16),_(32,"Role"),p(),f(33,"p-dropdown",20),L("ngModelChange",function(o){return n.selectedRoletype=o}),D(34,T0e,1,1,"ng-template",21),D(35,S0e,3,1,"ng-template",21),p(),D(36,E0e,2,0,"small",15),p()(),f(37,"div",22)(38,"button",23),L("click",function(){return n.saveUser(n.userForm)}),ee(39,"i",24),_(40," Save "),p(),f(41,"button",25),L("click",function(){return n.closeModal()}),ee(42,"i",26),_(43," Cancel "),p()()()(),ee(44,"p-toast",27)(45,"p-confirmDialog",28)),2&e&&(v(6),T("value",n.users)("paginator",!0)("rows",10)("globalFilterFields",rt(29,k0e)),v(5),T("ngIf",n.isAccountEmpty()),v(1),Ft(rt(30,D0e)),T("visible",n.displayAddAccountModal)("modal",!0)("draggable",!1)("resizable",!1)("responsive",!0),v(1),T("formGroup",n.userForm),v(5),T("ngModel",n.useraccount.name),v(1),T("ngIf",n.userForm.controls.name.invalid&&n.userForm.controls.name.dirty),v(4),T("ngModel",n.useraccount.field1),v(1),T("ngIf",n.userForm.controls.field1.invalid&&n.userForm.controls.field1.dirty),v(4),T("ngModel",n.useraccount.field2),v(1),T("ngIf",n.userForm.controls.field2.invalid&&n.userForm.controls.field2.dirty),v(4),Ft(rt(31,I0e)),T("options",n.roletypes)("filter",!0)("showClear",!0)("ngModel",n.selectedRoletype),v(3),T("ngIf",n.userForm.controls.role.invalid&&n.userForm.controls.role.dirty),v(2),T("disabled",n.userForm.invalid),v(7),Ft(rt(32,A0e)))},directives:[ki,zn,li,Sn,_r,ms,Hr,Ur,Pr,Ir,Er,zr,us,fr,mo],styles:[""]}),t})(),canActivate:[ja]},{path:"addrole",component:u0e,canActivate:[ja]},{path:"assignprojects",component:GQ,canActivate:[ja]},{path:"assignbranches",component:SQ,canActivate:[ja]},{path:"inventory",component:tb,canActivate:[ja]},{path:"officeexpense",component:qae,canActivate:[ja]},{path:"",redirectTo:"/login",pathMatch:"full"}];let F0e=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({imports:[[QN.forRoot(M0e)],QN]}),t})();const P0e=["sidebar"],O0e=["sidebarBackdrop"],N0e=["navLink"];function L0e(t,i){if(1&t){const e=Ie();f(0,"li",35)(1,"a",36,37),L("click",function(){return z(e),A(2).onNavLinkClick()}),f(3,"span",38),ee(4,"img",39),p(),f(5,"span",40),_(6),p()()()}if(2&t){const e=A().$implicit;v(1),T("routerLink",e.link),v(3),T("src",e.imagesrc,rd),v(2),U(e.name)}}function R0e(t,i){if(1&t&&(ni(0),D(1,L0e,7,3,"li",34),Si()),2&t){const e=i.$implicit;v(1),T("ngIf","excelimport"!==e.link&&"addrole"!==e.link&&"adduser"!==e.link&&"inventory"!==e.link&&"assignprojects"!==e.link&&"assignbranches"!==e.link)}}function B0e(t,i){if(1&t){const e=Ie();f(0,"li")(1,"a",41),L("click",function(r){return z(e),A().createuser(r)}),ee(2,"i",42),_(3," Add User "),p()()}}function j0e(t,i){if(1&t){const e=Ie();f(0,"li")(1,"a",41),L("click",function(r){return z(e),A().createrole(r)}),ee(2,"i",43),_(3," Add Role "),p()()}}function V0e(t,i){if(1&t){const e=Ie();f(0,"li")(1,"a",41),L("click",function(r){return z(e),A().assignProjects(r)}),ee(2,"i",44),_(3," Assign Projects "),p()()}}function U0e(t,i){if(1&t){const e=Ie();f(0,"li")(1,"a",41),L("click",function(r){return z(e),A().assignBranches(r)}),ee(2,"i",45),_(3," Assign Branches "),p()()}}let H0e=(()=>{class t{constructor(e,n,r,o){this.renderer=e,this._ms=n,this.router=r,this.elRef=o,this.sideNavStatus=!1,this.admin="",this.isMobileSidebarVisible=!1,this.modules=[]}ngOnInit(){const e=sessionStorage.getItem("username");this._ms.getAlowedModules(e).subscribe(r=>{this.modules=r;const o=JSON.stringify(this.modules);sessionStorage.setItem("modules",o)});const n=sessionStorage.getItem("role");this.admin=null!==n?n:"staff"}ngAfterViewInit(){setTimeout(()=>{this.addNavLinkListeners(),this.navLinks.changes.subscribe(()=>{this.addNavLinkListeners()})},0)}addNavLinkListeners(){this.navLinks.forEach(e=>{this.renderer.listen(e.nativeElement,"click",()=>{window.innerWidth<=768&&this.closeSidebar()})})}onNavLinkClick(){window.innerWidth<=768&&this.closeSidebar()}closeSidebar(){const e=this.elRef.nativeElement.querySelector("#sidebar"),n=this.elRef.nativeElement.querySelector("#sidebarBackdrop");e&&e.classList.remove("show"),n&&(n.style.display="none"),document.body.classList.remove("overlay-active")}toggleSidebar(){const e=this.sidebar.nativeElement;setTimeout(()=>{window.innerWidth>768&&e.classList.toggle("collapsed")},100)}toggleMobileSidebar(e){e&&e.stopPropagation();const n=this.sidebar.nativeElement,r=this.sidebarBackdrop.nativeElement;this.isMobileSidebarVisible=!this.isMobileSidebarVisible,n.classList.toggle("show",this.isMobileSidebarVisible),window.innerWidth<=768&&(n.style.transform=""),r.style.display=this.isMobileSidebarVisible?"block":"none",document.body.classList.toggle("overlay-active",this.isMobileSidebarVisible)}closeMobileSidebar(){const e=this.sidebar.nativeElement,n=this.sidebarBackdrop.nativeElement;this.isMobileSidebarVisible=!1,e.classList.remove("show"),window.innerWidth<=768&&(e.style.transform="translateX(-100%)"),n.style.display="none",document.body.classList.remove("overlay-active")}onResize(){const e=this.sidebar.nativeElement;window.innerWidth>768?(this.closeMobileSidebar(),e.style.transform=""):(e.style.transform="translateX(-100%)",e.classList.remove("collapsed"))}onDocumentClick(e){var n;const r=e.target,o=r.closest(".mobile-menu-btn"),c=null===(n=this.sidebar)||void 0===n?void 0:n.nativeElement;window.innerWidth<=768&&this.isMobileSidebarVisible&&c&&!c.contains(r)&&!o&&this.closeMobileSidebar()}logout(e){e.preventDefault(),sessionStorage.removeItem("accessToken"),this.router.navigate([""])}createuser(e){e.preventDefault(),window.innerWidth<=768&&(this.closeSidebar(),this.toggleMobileSidebar(),this.toggleSidebar()),this.router.navigate(["adduser"])}createrole(e){e.preventDefault(),window.innerWidth<=768&&(this.closeSidebar(),this.toggleMobileSidebar(),this.toggleSidebar()),this.router.navigate(["addrole"])}assignProjects(e){e.preventDefault(),window.innerWidth<=768&&(this.closeSidebar(),this.toggleMobileSidebar(),this.toggleSidebar()),this.router.navigate(["assignprojects"])}assignBranches(e){e.preventDefault(),window.innerWidth<=768&&(this.closeSidebar(),this.toggleMobileSidebar(),this.toggleSidebar()),this.router.navigate(["assignbranches"])}}return t.\u0275fac=function(e){return new(e||t)(te(Ss),te(_L),te(zs),te(mr))},t.\u0275cmp=dn({type:t,selectors:[["app-sidebar"]],viewQuery:function(e,n){if(1&e&&(Mt(P0e,5),Mt(O0e,5),Mt(N0e,5)),2&e){let r;xt(r=wt())&&(n.sidebar=r.first),xt(r=wt())&&(n.sidebarBackdrop=r.first),xt(r=wt())&&(n.navLinks=r)}},hostBindings:function(e,n){1&e&&L("resize",function(o){return n.onResize(o)},!1,Bx)("click",function(o){return n.onDocumentClick(o)},!1,jx)},inputs:{sideNavStatus:"sideNavStatus",admin:"admin"},decls:45,vars:5,consts:[["id","mobileMenuBtn","aria-label","Toggle Mobile Menu",1,"mobile-menu-btn",3,"click"],[1,"bi","bi-list"],["id","sidebar",1,"modern-sidebar"],["sidebar",""],[1,"sidebar-header-modern"],[1,"sidebar-logo"],[1,"logo-badge"],[1,"bi","bi-box-seam"],[1,"logo-title-group"],[1,"sidebar-brand"],[1,"sidebar-tagline"],["id","toggleBtn","aria-label","Toggle Sidebar",1,"collapse-toggle",3,"click"],[1,"bi","bi-chevron-left"],[1,"modern-nav-menu"],[1,"modern-nav-list"],[4,"ngFor","ngForOf"],[1,"sidebar-footer-modern"],[1,"footer-user-section","dropup"],[1,"user-avatar-wrapper"],["src","https://i.pravatar.cc/100","alt","User",1,"footer-avatar"],[1,"status-indicator"],[1,"footer-user-info"],[1,"footer-username"],[1,"footer-userrole"],["type","button","id","userDropdown","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-link","dropdown-toggle","modern-dropup-toggle"],[1,"bi","bi-chevron-up"],["aria-labelledby","userDropdown",1,"dropdown-menu","modern-dropup-menu"],[4,"ngIf"],[1,"dropdown-divider"],["href","#",1,"dropdown-item","text-danger",3,"click"],[1,"bi","bi-box-arrow-right","me-2"],["id","sidebarBackdrop",1,"sidebar-backdrop",3,"click"],["sidebarBackdrop",""],[1,"main-content"],["class","modern-nav-item",4,"ngIf"],[1,"modern-nav-item"],["routerLinkActive","active",1,"modern-nav-link",3,"routerLink","click"],["navLink",""],[1,"nav-icon-wrapper"],["alt","",1,"nav-icon-img",3,"src"],[1,"nav-label"],["href","#",1,"dropdown-item",3,"click"],[1,"bi","bi-person","me-2"],[1,"bi","bi-person-plus","me-2"],[1,"bi","bi-grid-3x3-gap","me-2"],[1,"bi","bi-building","me-2"]],template:function(e,n){1&e&&(f(0,"button",0),L("click",function(o){return n.toggleMobileSidebar(o)}),ee(1,"i",1),p(),f(2,"div",2,3)(4,"div",4)(5,"div",5)(6,"div",6),ee(7,"i",7),p(),f(8,"div",8)(9,"h2",9),_(10,"Construction"),p(),f(11,"span",10),_(12,"ERP System"),p()()(),f(13,"button",11),L("click",function(){return n.toggleSidebar()}),ee(14,"i",12),p()(),f(15,"div",13)(16,"ul",14),D(17,R0e,2,1,"ng-container",15),p()(),f(18,"div",16)(19,"div",17)(20,"div",18),ee(21,"img",19)(22,"span",20),p(),f(23,"div",21)(24,"div",22),_(25,"Admin User"),p(),f(26,"div",23),_(27,"Administrator"),p()(),f(28,"button",24),ee(29,"i",25),p(),f(30,"ul",26),D(31,B0e,4,0,"li",27),D(32,j0e,4,0,"li",27),D(33,V0e,4,0,"li",27),D(34,U0e,4,0,"li",27),f(35,"li"),ee(36,"hr",28),p(),f(37,"li")(38,"a",29),L("click",function(o){return n.logout(o)}),ee(39,"i",30),_(40," Logout "),p()()()()()(),f(41,"div",31,32),L("click",function(){return n.closeMobileSidebar()}),p(),f(43,"div",33),ee(44,"router-outlet"),p()),2&e&&(v(17),T("ngForOf",n.modules),v(14),T("ngIf","Admin"===n.admin),v(1),T("ngIf","Admin"===n.admin),v(1),T("ngIf","Admin"===n.admin),v(1),T("ngIf","Admin"===n.admin))},directives:[nc,Sn,eT,qN,OI],styles:['.modern-sidebar[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]{width:var(--sidebar-width);height:100vh;position:fixed;left:0;top:0;background:white;color:#2d3748;transition:all .3s cubic-bezier(.4,0,.2,1);z-index:1000;box-shadow:4px 0 20px #00000014;border-right:1px solid #e2e8f0;display:flex;flex-direction:column;overflow:hidden}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]{padding:20px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #e2e8f0;background:white}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .sidebar-logo[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .sidebar-logo[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex:1}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .sidebar-logo[_ngcontent-%COMP%]   .logo-badge[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .sidebar-logo[_ngcontent-%COMP%]   .logo-badge[_ngcontent-%COMP%]{width:45px;height:45px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.5rem;color:#fff;box-shadow:0 4px 15px #667eea4d}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .sidebar-logo[_ngcontent-%COMP%]   .logo-title-group[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .sidebar-logo[_ngcontent-%COMP%]   .logo-title-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .sidebar-logo[_ngcontent-%COMP%]   .logo-title-group[_ngcontent-%COMP%]   .sidebar-brand[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .sidebar-logo[_ngcontent-%COMP%]   .logo-title-group[_ngcontent-%COMP%]   .sidebar-brand[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:700;color:#2d3748;margin:0;letter-spacing:.5px}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .sidebar-logo[_ngcontent-%COMP%]   .logo-title-group[_ngcontent-%COMP%]   .sidebar-tagline[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .sidebar-logo[_ngcontent-%COMP%]   .logo-title-group[_ngcontent-%COMP%]   .sidebar-tagline[_ngcontent-%COMP%]{font-size:.75rem;color:#718096;font-weight:500}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .collapse-toggle[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .collapse-toggle[_ngcontent-%COMP%]{background:#f8f9fa;border:1px solid #e2e8f0;color:#2d3748;width:35px;height:35px;border-radius:8px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.1rem;transition:all .3s ease}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .collapse-toggle[_ngcontent-%COMP%]:hover, .sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .collapse-toggle[_ngcontent-%COMP%]:hover{background:#e2e8f0;transform:scale(1.1);box-shadow:0 2px 8px #0000001a}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-menu[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-menu[_ngcontent-%COMP%]{flex:1;overflow-y:auto;overflow-x:hidden;padding:20px 15px}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-menu[_ngcontent-%COMP%]::-webkit-scrollbar, .sidebar[_ngcontent-%COMP%]   .modern-nav-menu[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-menu[_ngcontent-%COMP%]::-webkit-scrollbar-track, .sidebar[_ngcontent-%COMP%]   .modern-nav-menu[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f8f9fa}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-menu[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .sidebar[_ngcontent-%COMP%]   .modern-nav-menu[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e0;border-radius:3px}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-menu[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .sidebar[_ngcontent-%COMP%]   .modern-nav-menu[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a0aec0}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-list[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:8px}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]{position:relative}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;padding:12px 15px;color:#2d3748;text-decoration:none;border-radius:12px;transition:all .3s ease;position:relative;font-weight:500}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]   .nav-icon-wrapper[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]   .nav-icon-wrapper[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;background:#f8f9fa;border-radius:10px;transition:all .3s ease}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]   .nav-icon-wrapper[_ngcontent-%COMP%]   .nav-icon-img[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]   .nav-icon-wrapper[_ngcontent-%COMP%]   .nav-icon-img[_ngcontent-%COMP%]{width:24px;height:24px;filter:none;opacity:.7}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]   .nav-label[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]   .nav-label[_ngcontent-%COMP%]{transition:all .3s ease;font-size:.95rem}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]:hover, .sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]:hover{background:#f8f9fa;transform:translate(5px)}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]:hover   .nav-icon-wrapper[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]:hover   .nav-icon-wrapper[_ngcontent-%COMP%]{background:#e2e8f0;transform:scale(1.1)}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]:hover   .nav-icon-img[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]:hover   .nav-icon-img[_ngcontent-%COMP%]{opacity:1}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link.active[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;box-shadow:0 4px 12px #667eea4d;position:relative}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link.active[_ngcontent-%COMP%]:before, .sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link.active[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:50%;transform:translateY(-50%);width:4px;height:70%;background:white;border-radius:0 4px 4px 0}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link.active[_ngcontent-%COMP%]   .nav-icon-wrapper[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link.active[_ngcontent-%COMP%]   .nav-icon-wrapper[_ngcontent-%COMP%]{background:rgba(255,255,255,.2)}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link.active[_ngcontent-%COMP%]   .nav-icon-img[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link.active[_ngcontent-%COMP%]   .nav-icon-img[_ngcontent-%COMP%]{filter:brightness(0) invert(1);opacity:1}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link.active[_ngcontent-%COMP%]   .nav-label[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-item[_ngcontent-%COMP%]   .modern-nav-link.active[_ngcontent-%COMP%]   .nav-label[_ngcontent-%COMP%]{font-weight:600}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]{padding:15px;border-top:1px solid #e2e8f0;background:white;position:relative;overflow:visible}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;position:relative;overflow:visible}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section.dropup[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section.dropup[_ngcontent-%COMP%]{overflow:visible!important}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .user-avatar-wrapper[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .user-avatar-wrapper[_ngcontent-%COMP%]{position:relative}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .user-avatar-wrapper[_ngcontent-%COMP%]   .footer-avatar[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .user-avatar-wrapper[_ngcontent-%COMP%]   .footer-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;border:2px solid #e2e8f0;object-fit:cover}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .user-avatar-wrapper[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .user-avatar-wrapper[_ngcontent-%COMP%]   .status-indicator[_ngcontent-%COMP%]{position:absolute;bottom:2px;right:2px;width:12px;height:12px;background:#4ade80;border:2px solid white;border-radius:50%}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .footer-user-info[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .footer-user-info[_ngcontent-%COMP%]{flex:1;min-width:0}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .footer-user-info[_ngcontent-%COMP%]   .footer-username[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .footer-user-info[_ngcontent-%COMP%]   .footer-username[_ngcontent-%COMP%]{color:#2d3748;font-weight:600;font-size:.9rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .footer-user-info[_ngcontent-%COMP%]   .footer-userrole[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .footer-user-info[_ngcontent-%COMP%]   .footer-userrole[_ngcontent-%COMP%]{color:#718096;font-size:.75rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-toggle[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-toggle[_ngcontent-%COMP%]{background:#f8f9fa;border:1px solid #e2e8f0;color:#2d3748;padding:6px 10px;border-radius:8px;cursor:pointer;transition:all .3s ease;font-size:.9rem;display:flex;align-items:center;justify-content:center;margin-left:auto}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-toggle[_ngcontent-%COMP%]:hover, .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-toggle[_ngcontent-%COMP%]:hover{background:#e2e8f0;box-shadow:0 2px 8px #0000001a}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-toggle[_ngcontent-%COMP%]:after, .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-toggle[_ngcontent-%COMP%]:after{display:none}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]{position:absolute;bottom:calc(100% + 10px);left:0;right:0;background:white;border-radius:12px;box-shadow:0 -4px 20px #00000026;padding:8px 0;margin:0;list-style:none;z-index:2000;border:none}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 15px;color:#333;text-decoration:none;transition:all .2s ease;font-size:.9rem;border:none;background:transparent}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px;width:18px;color:#667eea}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover, .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:#f8f9fa;padding-left:20px}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-item.text-danger[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-item.text-danger[_ngcontent-%COMP%], .modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-item.text-danger[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-item.text-danger[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#ff4757}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-item.text-danger[_ngcontent-%COMP%]:hover, .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-item.text-danger[_ngcontent-%COMP%]:hover{background:#ffe5e7}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-divider[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]   .dropdown-divider[_ngcontent-%COMP%]{height:1px;background:#e0e0e0;margin:8px 0;border:none}.modern-sidebar.collapsed[_ngcontent-%COMP%], .collapsed.sidebar[_ngcontent-%COMP%]{width:var(--sidebar-collapsed)}.modern-sidebar.collapsed[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .sidebar-logo[_ngcontent-%COMP%]   .logo-title-group[_ngcontent-%COMP%], .collapsed.sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .sidebar-logo[_ngcontent-%COMP%]   .logo-title-group[_ngcontent-%COMP%]{display:none}.modern-sidebar.collapsed[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .collapse-toggle[_ngcontent-%COMP%], .collapsed.sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]   .collapse-toggle[_ngcontent-%COMP%]{transform:rotate(180deg)}.modern-sidebar.collapsed[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]   .nav-label[_ngcontent-%COMP%], .collapsed.sidebar[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]   .nav-label[_ngcontent-%COMP%]{opacity:0;width:0;overflow:hidden}.modern-sidebar.collapsed[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]   .nav-icon-wrapper[_ngcontent-%COMP%], .collapsed.sidebar[_ngcontent-%COMP%]   .modern-nav-link[_ngcontent-%COMP%]   .nav-icon-wrapper[_ngcontent-%COMP%]{margin:0 auto}.modern-sidebar.collapsed[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-info[_ngcontent-%COMP%], .collapsed.sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-info[_ngcontent-%COMP%]{display:none}.modern-sidebar.collapsed[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%], .collapsed.sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]{justify-content:center;flex-wrap:wrap}.modern-sidebar.collapsed[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-toggle[_ngcontent-%COMP%], .collapsed.sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-toggle[_ngcontent-%COMP%]{width:100%;margin-top:8px;margin-left:0}.modern-sidebar.collapsed[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%], .collapsed.sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]   .footer-user-section[_ngcontent-%COMP%]   .modern-dropup-menu[_ngcontent-%COMP%]{left:calc(100% + 10px);bottom:0;min-width:200px}.mobile-menu-btn[_ngcontent-%COMP%]{display:none;position:fixed;top:80px;left:15px;z-index:1100;background:white;color:#2d3748;border:1px solid #e2e8f0;width:45px;height:45px;border-radius:12px;font-size:1.2rem;cursor:pointer;box-shadow:0 4px 15px #0000001a;transition:all .3s ease;align-items:center;justify-content:center;pointer-events:auto}.mobile-menu-btn[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 6px 20px #00000026;background:#f8f9fa}.mobile-menu-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.sidebar-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);z-index:999;display:none;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}@media (max-width: 768px){.modern-sidebar[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]{transform:translate(-100%);width:280px!important;box-shadow:4px 0 30px #0000004d}.modern-sidebar.show[_ngcontent-%COMP%], .show.sidebar[_ngcontent-%COMP%]{transform:translate(0)}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-header-modern[_ngcontent-%COMP%]{padding:15px}.modern-sidebar[_ngcontent-%COMP%]   .modern-nav-menu[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .modern-nav-menu[_ngcontent-%COMP%]{padding:15px 10px}.modern-sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer-modern[_ngcontent-%COMP%]{padding:12px}.mobile-menu-btn[_ngcontent-%COMP%]{display:flex;top:15px}.sidebar-backdrop[_ngcontent-%COMP%]{display:none}.sidebar-backdrop.show[_ngcontent-%COMP%]{display:block}}.main-content[_ngcontent-%COMP%]{margin-left:var(--sidebar-width);padding:90px 20px 20px;transition:margin-left .3s ease;min-height:100vh}.modern-sidebar.collapsed[_ngcontent-%COMP%] ~ .main-content[_ngcontent-%COMP%], .sidebar.collapsed[_ngcontent-%COMP%] ~ .main-content[_ngcontent-%COMP%]{margin-left:var(--sidebar-collapsed)}@media (max-width: 768px){.main-content[_ngcontent-%COMP%]{margin-left:0;padding-top:80px}}.sidebar-header[_ngcontent-%COMP%], .logo[_ngcontent-%COMP%], .toggle-btn[_ngcontent-%COMP%], .nav-menu[_ngcontent-%COMP%], .nav-list[_ngcontent-%COMP%], .nav-item[_ngcontent-%COMP%], .nav-link[_ngcontent-%COMP%], .nav-icon[_ngcontent-%COMP%], .nav-text[_ngcontent-%COMP%], .sidebar-footer[_ngcontent-%COMP%], .user-profile[_ngcontent-%COMP%], .user-avatar[_ngcontent-%COMP%], .user-info[_ngcontent-%COMP%]{display:none}']}),t})();function z0e(t,i){if(1&t&&(f(0,"div",2),ee(1,"app-sidebar",3),p()),2&t){const e=A();v(1),T("sideNavStatus",e.sideNavStatus)}}function $0e(t,i){1&t&&ee(0,"app-userlogin")}let W0e=(()=>{class t{constructor(e){this.router=e,this.sideNavStatus=!0,this.showContent=!0,e.events.subscribe(n=>{n instanceof k0&&(this.showContent="/"!=n.url&&"/login"!=n.url)})}ngOnInit(){this.showContent=!1}}return t.\u0275fac=function(e){return new(e||t)(te(zs))},t.\u0275cmp=dn({type:t,selectors:[["app-root"]],decls:2,vars:2,consts:[["class","app-container",4,"ngIf"],[4,"ngIf"],[1,"app-container"],[3,"sideNavStatus"]],template:function(e,n){1&e&&(D(0,z0e,2,1,"div",0),D(1,$0e,1,0,"app-userlogin",1)),2&e&&(T("ngIf",n.showContent),v(1),T("ngIf",!n.showContent))},directives:[Sn,H0e,IL],styles:[".app-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;background-color:#f5f7fa}.main-content[_ngcontent-%COMP%]{margin-left:250px;margin-top:4rem;padding:1.5rem;transition:margin-left .25s ease;min-height:calc(100vh - 4rem);background-color:#f5f7fa}.main-content[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:1rem;background:#ffffff;border-radius:.5rem;box-shadow:0 2px 10px #0000000d}@media (max-width: 992px){.main-content[_ngcontent-%COMP%]{margin-left:0!important;padding:1rem}.main-content.mobile-sidebar-open[_ngcontent-%COMP%]{transform:translate(250px)}}.main-content[_ngcontent-%COMP%]{margin-left:250px;padding:20px;transition:all .3s ease}.main-content.collapsed[_ngcontent-%COMP%]{margin-left:60px}@media (max-width: 992px){.main-content[_ngcontent-%COMP%]{margin-left:0!important;padding:15px}.main-content.mobile-sidebar-open[_ngcontent-%COMP%]{transform:translate(250px);overflow:hidden;position:fixed;width:100%}}"]}),t})();const ir=!1;function p9(t){return new Tn(3e3,ir)}function S_e(){return"undefined"!=typeof window&&void 0!==window.document}function yM(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Xp(t){switch(t.length){case 0:return new Vy;case 1:return t[0];default:return new kL(t)}}function h9(t,i,e,n,r={},o={}){const c=[],u=[];let m=-1,g=null;if(n.forEach(x=>{const S=x.offset,M=S==m,E=M&&g||{};Object.keys(x).forEach(R=>{let B=R,K=x[R];if("offset"!==R)switch(B=i.normalizePropertyName(B,c),K){case"!":K=r[R];break;case vf:K=o[R];break;default:K=i.normalizeStyleValue(R,B,K,c)}E[B]=K}),M||u.push(E),g=E,m=S}),c.length)throw function h_e(t){return new Tn(3502,ir)}();return u}function bM(t,i,e,n){switch(i){case"start":t.onStart(()=>n(e&&xM(e,"start",t)));break;case"done":t.onDone(()=>n(e&&xM(e,"done",t)));break;case"destroy":t.onDestroy(()=>n(e&&xM(e,"destroy",t)))}}function xM(t,i,e){const n=e.totalTime,o=wM(t.element,t.triggerName,t.fromState,t.toState,i||t.phaseName,null==n?t.totalTime:n,!!e.disabled),c=t._data;return null!=c&&(o._data=c),o}function wM(t,i,e,n,r="",o=0,c){return{element:t,triggerName:i,fromState:e,toState:n,phaseName:r,totalTime:o,disabled:!!c}}function ac(t,i,e){let n;return t instanceof Map?(n=t.get(i),n||t.set(i,n=e)):(n=t[i],n||(n=t[i]=e)),n}function m9(t){const i=t.indexOf(":");return[t.substring(1,i),t.substr(i+1)]}let CM=(t,i)=>!1,g9=(t,i,e)=>[],_9=null;function TM(t){const i=t.parentNode||t.host;return i===_9?null:i}(yM()||"undefined"!=typeof Element)&&(S_e()?(_9=(()=>document.documentElement)(),CM=(t,i)=>{for(;i;){if(i===t)return!0;i=TM(i)}return!1}):CM=(t,i)=>t.contains(i),g9=(t,i,e)=>{if(e)return Array.from(t.querySelectorAll(i));const n=t.querySelector(i);return n?[n]:[]});let jm=null,v9=!1;function y9(t){jm||(jm=function k_e(){return"undefined"!=typeof document?document.body:null}()||{},v9=!!jm.style&&"WebkitAppearance"in jm.style);let i=!0;return jm.style&&!function E_e(t){return"ebkit"==t.substring(1,6)}(t)&&(i=t in jm.style,!i&&v9&&(i="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in jm.style)),i}const b9=CM,x9=g9;let w9=(()=>{class t{validateStyleProperty(e){return y9(e)}matchesElement(e,n){return!1}containsElement(e,n){return b9(e,n)}getParentElement(e){return TM(e)}query(e,n,r){return x9(e,n,r)}computeStyle(e,n,r){return r||""}animate(e,n,r,o,c,u=[],m){return new Vy(r,o)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})(),SM=(()=>{class t{}return t.NOOP=new w9,t})();const EM="ng-enter",dS="ng-leave",fS="ng-trigger",pS=".ng-trigger",T9="ng-animating",kM=".ng-animating";function Vm(t){if("number"==typeof t)return t;const i=t.match(/^(-?[\.\d]+)(m?s)/);return!i||i.length<2?0:DM(parseFloat(i[1]),i[2])}function DM(t,i){return"s"===i?1e3*t:t}function hS(t,i,e){return t.hasOwnProperty("duration")?t:function A_e(t,i,e){let r,o=0,c="";if("string"==typeof t){const u=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===u)return i.push(p9()),{duration:0,delay:0,easing:""};r=DM(parseFloat(u[1]),u[2]);const m=u[3];null!=m&&(o=DM(parseFloat(m),u[4]));const g=u[5];g&&(c=g)}else r=t;if(!e){let u=!1,m=i.length;r<0&&(i.push(function q0e(){return new Tn(3100,ir)}()),u=!0),o<0&&(i.push(function G0e(){return new Tn(3101,ir)}()),u=!0),u&&i.splice(m,0,p9())}return{duration:r,delay:o,easing:c}}(t,i,e)}function o_(t,i={}){return Object.keys(t).forEach(e=>{i[e]=t[e]}),i}function Qp(t,i,e={}){if(i)for(let n in t)e[n]=t[n];else o_(t,e);return e}function E9(t,i,e){return e?i+":"+e+";":""}function k9(t){let i="";for(let e=0;e<t.style.length;e++){const n=t.style.item(e);i+=E9(0,n,t.style.getPropertyValue(n))}for(const e in t.style)t.style.hasOwnProperty(e)&&!e.startsWith("_")&&(i+=E9(0,P_e(e),t.style[e]));t.setAttribute("style",i)}function Cd(t,i,e){t.style&&(Object.keys(i).forEach(n=>{const r=AM(n);e&&!e.hasOwnProperty(n)&&(e[n]=t.style[r]),t.style[r]=i[n]}),yM()&&k9(t))}function Um(t,i){t.style&&(Object.keys(i).forEach(e=>{const n=AM(e);t.style[n]=""}),yM()&&k9(t))}function ob(t){return Array.isArray(t)?1==t.length?t[0]:TL(t):t}const IM=new RegExp("{{\\s*(.+?)\\s*}}","g");function D9(t){let i=[];if("string"==typeof t){let e;for(;e=IM.exec(t);)i.push(e[1]);IM.lastIndex=0}return i}function mS(t,i,e){const n=t.toString(),r=n.replace(IM,(o,c)=>{let u=i[c];return i.hasOwnProperty(c)||(e.push(function Y0e(t){return new Tn(3003,ir)}()),u=""),u.toString()});return r==n?t:r}function gS(t){const i=[];let e=t.next();for(;!e.done;)i.push(e.value),e=t.next();return i}const F_e=/-+([a-z0-9])/g;function AM(t){return t.replace(F_e,(...i)=>i[1].toUpperCase())}function P_e(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function lc(t,i,e){switch(i.type){case 7:return t.visitTrigger(i,e);case 0:return t.visitState(i,e);case 1:return t.visitTransition(i,e);case 2:return t.visitSequence(i,e);case 3:return t.visitGroup(i,e);case 4:return t.visitAnimate(i,e);case 5:return t.visitKeyframes(i,e);case 6:return t.visitStyle(i,e);case 8:return t.visitReference(i,e);case 9:return t.visitAnimateChild(i,e);case 10:return t.visitAnimateRef(i,e);case 11:return t.visitQuery(i,e);case 12:return t.visitStagger(i,e);default:throw function X0e(t){return new Tn(3004,ir)}()}}function I9(t,i){return window.getComputedStyle(t)[i]}function j_e(t,i){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(n=>function V_e(t,i,e){if(":"==t[0]){const m=function U_e(t,i){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,n)=>parseFloat(n)>parseFloat(e);case":decrement":return(e,n)=>parseFloat(n)<parseFloat(e);default:return i.push(function u_e(t){return new Tn(3016,ir)}()),"* => *"}}(t,e);if("function"==typeof m)return void i.push(m);t=m}const n=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return e.push(function c_e(t){return new Tn(3015,ir)}()),i;const r=n[1],o=n[2],c=n[3];i.push(A9(r,c));"<"==o[0]&&!("*"==r&&"*"==c)&&i.push(A9(c,r))}(n,e,i)):e.push(t),e}const bS=new Set(["true","1"]),xS=new Set(["false","0"]);function A9(t,i){const e=bS.has(t)||xS.has(t),n=bS.has(i)||xS.has(i);return(r,o)=>{let c="*"==t||t==r,u="*"==i||i==o;return!c&&e&&"boolean"==typeof r&&(c=r?bS.has(t):xS.has(t)),!u&&n&&"boolean"==typeof o&&(u=o?bS.has(i):xS.has(i)),c&&u}}const H_e=new RegExp("s*:selfs*,?","g");function MM(t,i,e,n){return new z_e(t).build(i,e,n)}class z_e{constructor(i){this._driver=i}build(i,e,n){const r=new q_e(e);this._resetContextStyleTimingState(r);const o=lc(this,ob(i),r);return r.unsupportedCSSPropertiesFound.size&&r.unsupportedCSSPropertiesFound.keys(),o}_resetContextStyleTimingState(i){i.currentQuerySelector="",i.collectedStyles={},i.collectedStyles[""]={},i.currentTime=0}visitTrigger(i,e){let n=e.queryCount=0,r=e.depCount=0;const o=[],c=[];return"@"==i.name.charAt(0)&&e.errors.push(function J0e(){return new Tn(3006,ir)}()),i.definitions.forEach(u=>{if(this._resetContextStyleTimingState(e),0==u.type){const m=u,g=m.name;g.toString().split(/\s*,\s*/).forEach(x=>{m.name=x,o.push(this.visitState(m,e))}),m.name=g}else if(1==u.type){const m=this.visitTransition(u,e);n+=m.queryCount,r+=m.depCount,c.push(m)}else e.errors.push(function Z0e(){return new Tn(3007,ir)}())}),{type:7,name:i.name,states:o,transitions:c,queryCount:n,depCount:r,options:null}}visitState(i,e){const n=this.visitStyle(i.styles,e),r=i.options&&i.options.params||null;if(n.containsDynamicStyles){const o=new Set,c=r||{};n.styles.forEach(u=>{if(wS(u)){const m=u;Object.keys(m).forEach(g=>{D9(m[g]).forEach(x=>{c.hasOwnProperty(x)||o.add(x)})})}}),o.size&&(gS(o.values()),e.errors.push(function e_e(t,i){return new Tn(3008,ir)}()))}return{type:0,name:i.name,style:n,options:r?{params:r}:null}}visitTransition(i,e){e.queryCount=0,e.depCount=0;const n=lc(this,ob(i.animation),e);return{type:1,matchers:j_e(i.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:Hm(i.options)}}visitSequence(i,e){return{type:2,steps:i.steps.map(n=>lc(this,n,e)),options:Hm(i.options)}}visitGroup(i,e){const n=e.currentTime;let r=0;const o=i.steps.map(c=>{e.currentTime=n;const u=lc(this,c,e);return r=Math.max(r,e.currentTime),u});return e.currentTime=r,{type:3,steps:o,options:Hm(i.options)}}visitAnimate(i,e){const n=function K_e(t,i){let e=null;if(t.hasOwnProperty("duration"))e=t;else if("number"==typeof t)return FM(hS(t,i).duration,0,"");const n=t;if(n.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=FM(0,0,"");return o.dynamic=!0,o.strValue=n,o}return e=e||hS(n,i),FM(e.duration,e.delay,e.easing)}(i.timings,e.errors);e.currentAnimateTimings=n;let r,o=i.styles?i.styles:cs({});if(5==o.type)r=this.visitKeyframes(o,e);else{let c=i.styles,u=!1;if(!c){u=!0;const g={};n.easing&&(g.easing=n.easing),c=cs(g)}e.currentTime+=n.duration+n.delay;const m=this.visitStyle(c,e);m.isEmptyStep=u,r=m}return e.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(i,e){const n=this._makeStyleAst(i,e);return this._validateStyleAst(n,e),n}_makeStyleAst(i,e){const n=[];Array.isArray(i.styles)?i.styles.forEach(c=>{"string"==typeof c?c==vf?n.push(c):e.errors.push(function t_e(t){return new Tn(3002,ir)}()):n.push(c)}):n.push(i.styles);let r=!1,o=null;return n.forEach(c=>{if(wS(c)){const u=c,m=u.easing;if(m&&(o=m,delete u.easing),!r)for(let g in u)if(u[g].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:o,offset:i.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(i,e){const n=e.currentAnimateTimings;let r=e.currentTime,o=e.currentTime;n&&o>0&&(o-=n.duration+n.delay),i.styles.forEach(c=>{"string"!=typeof c&&Object.keys(c).forEach(u=>{if(!this._driver.validateStyleProperty(u))return delete c[u],void e.unsupportedCSSPropertiesFound.add(u);const m=e.collectedStyles[e.currentQuerySelector],g=m[u];let x=!0;g&&(o!=r&&o>=g.startTime&&r<=g.endTime&&(e.errors.push(function n_e(t,i,e,n,r){return new Tn(3010,ir)}()),x=!1),o=g.startTime),x&&(m[u]={startTime:o,endTime:r}),e.options&&function M_e(t,i,e){const n=i.params||{},r=D9(t);r.length&&r.forEach(o=>{n.hasOwnProperty(o)||e.push(function K0e(t){return new Tn(3001,ir)}())})}(c[u],e.options,e.errors)})})}visitKeyframes(i,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function i_e(){return new Tn(3011,ir)}()),n;let o=0;const c=[];let u=!1,m=!1,g=0;const x=i.steps.map(q=>{const Y=this._makeStyleAst(q,e);let ce=null!=Y.offset?Y.offset:function G_e(t){if("string"==typeof t)return null;let i=null;if(Array.isArray(t))t.forEach(e=>{if(wS(e)&&e.hasOwnProperty("offset")){const n=e;i=parseFloat(n.offset),delete n.offset}});else if(wS(t)&&t.hasOwnProperty("offset")){const e=t;i=parseFloat(e.offset),delete e.offset}return i}(Y.styles),De=0;return null!=ce&&(o++,De=Y.offset=ce),m=m||De<0||De>1,u=u||De<g,g=De,c.push(De),Y});m&&e.errors.push(function r_e(){return new Tn(3012,ir)}()),u&&e.errors.push(function o_e(){return new Tn(3200,ir)}());const S=i.steps.length;let M=0;o>0&&o<S?e.errors.push(function s_e(){return new Tn(3202,ir)}()):0==o&&(M=1/(S-1));const E=S-1,R=e.currentTime,B=e.currentAnimateTimings,K=B.duration;return x.forEach((q,Y)=>{const ce=M>0?Y==E?1:M*Y:c[Y],De=ce*K;e.currentTime=R+B.delay+De,B.duration=De,this._validateStyleAst(q,e),q.offset=ce,n.styles.push(q)}),n}visitReference(i,e){return{type:8,animation:lc(this,ob(i.animation),e),options:Hm(i.options)}}visitAnimateChild(i,e){return e.depCount++,{type:9,options:Hm(i.options)}}visitAnimateRef(i,e){return{type:10,animation:this.visitReference(i.animation,e),options:Hm(i.options)}}visitQuery(i,e){const n=e.currentQuerySelector,r=i.options||{};e.queryCount++,e.currentQuery=i;const[o,c]=function $_e(t){const i=!!t.split(/\s*,\s*/).find(e=>":self"==e);return i&&(t=t.replace(H_e,"")),t=t.replace(/@\*/g,pS).replace(/@\w+/g,e=>pS+"-"+e.substr(1)).replace(/:animating/g,kM),[t,i]}(i.selector);e.currentQuerySelector=n.length?n+" "+o:o,ac(e.collectedStyles,e.currentQuerySelector,{});const u=lc(this,ob(i.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:c,animation:u,originalSelector:i.selector,options:Hm(i.options)}}visitStagger(i,e){e.currentQuery||e.errors.push(function a_e(){return new Tn(3013,ir)}());const n="full"===i.timings?{duration:0,delay:0,easing:"full"}:hS(i.timings,e.errors,!0);return{type:12,animation:lc(this,ob(i.animation),e),timings:n,options:null}}}class q_e{constructor(i){this.errors=i,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function wS(t){return!Array.isArray(t)&&"object"==typeof t}function Hm(t){return t?(t=o_(t)).params&&(t.params=function W_e(t){return t?o_(t):null}(t.params)):t={},t}function FM(t,i,e){return{duration:t,delay:i,easing:e}}function PM(t,i,e,n,r,o,c=null,u=!1){return{type:1,element:t,keyframes:i,preStyleProps:e,postStyleProps:n,duration:r,delay:o,totalTime:r+o,easing:c,subTimeline:u}}class CS{constructor(){this._map=new Map}get(i){return this._map.get(i)||[]}append(i,e){let n=this._map.get(i);n||this._map.set(i,n=[]),n.push(...e)}has(i){return this._map.has(i)}clear(){this._map.clear()}}const Q_e=new RegExp(":enter","g"),Z_e=new RegExp(":leave","g");function OM(t,i,e,n,r,o={},c={},u,m,g=[]){return(new e1e).buildKeyframes(t,i,e,n,r,o,c,u,m,g)}class e1e{buildKeyframes(i,e,n,r,o,c,u,m,g,x=[]){g=g||new CS;const S=new NM(i,e,g,r,o,x,[]);S.options=m,S.currentTimeline.setStyles([c],null,S.errors,m),lc(this,n,S);const M=S.timelines.filter(E=>E.containsAnimation());if(Object.keys(u).length){let E;for(let R=M.length-1;R>=0;R--){const B=M[R];if(B.element===e){E=B;break}}E&&!E.allowOnlyTimelineStyles()&&E.setStyles([u],null,S.errors,m)}return M.length?M.map(E=>E.buildKeyframes()):[PM(e,[],[],[],0,0,"",!1)]}visitTrigger(i,e){}visitState(i,e){}visitTransition(i,e){}visitAnimateChild(i,e){const n=e.subInstructions.get(e.element);if(n){const r=e.createSubContext(i.options),o=e.currentTimeline.currentTime,c=this._visitSubInstructions(n,r,r.options);o!=c&&e.transformIntoNewTimeline(c)}e.previousNode=i}visitAnimateRef(i,e){const n=e.createSubContext(i.options);n.transformIntoNewTimeline(),this.visitReference(i.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=i}_visitSubInstructions(i,e,n){let o=e.currentTimeline.currentTime;const c=null!=n.duration?Vm(n.duration):null,u=null!=n.delay?Vm(n.delay):null;return 0!==c&&i.forEach(m=>{const g=e.appendInstructionToTimeline(m,c,u);o=Math.max(o,g.duration+g.delay)}),o}visitReference(i,e){e.updateOptions(i.options,!0),lc(this,i.animation,e),e.previousNode=i}visitSequence(i,e){const n=e.subContextCount;let r=e;const o=i.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=TS);const c=Vm(o.delay);r.delayNextStep(c)}i.steps.length&&(i.steps.forEach(c=>lc(this,c,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=i}visitGroup(i,e){const n=[];let r=e.currentTimeline.currentTime;const o=i.options&&i.options.delay?Vm(i.options.delay):0;i.steps.forEach(c=>{const u=e.createSubContext(i.options);o&&u.delayNextStep(o),lc(this,c,u),r=Math.max(r,u.currentTimeline.currentTime),n.push(u.currentTimeline)}),n.forEach(c=>e.currentTimeline.mergeTimelineCollectedStyles(c)),e.transformIntoNewTimeline(r),e.previousNode=i}_visitTiming(i,e){if(i.dynamic){const n=i.strValue;return hS(e.params?mS(n,e.params,e.errors):n,e.errors)}return{duration:i.duration,delay:i.delay,easing:i.easing}}visitAnimate(i,e){const n=e.currentAnimateTimings=this._visitTiming(i.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());const o=i.style;5==o.type?this.visitKeyframes(o,e):(e.incrementTime(n.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=i}visitStyle(i,e){const n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const o=r&&r.easing||i.easing;i.isEmptyStep?n.applyEmptyStep(o):n.setStyles(i.styles,o,e.errors,e.options),e.previousNode=i}visitKeyframes(i,e){const n=e.currentAnimateTimings,r=e.currentTimeline.duration,o=n.duration,u=e.createSubContext().currentTimeline;u.easing=n.easing,i.styles.forEach(m=>{u.forwardTime((m.offset||0)*o),u.setStyles(m.styles,m.easing,e.errors,e.options),u.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(u),e.transformIntoNewTimeline(r+o),e.previousNode=i}visitQuery(i,e){const n=e.currentTimeline.currentTime,r=i.options||{},o=r.delay?Vm(r.delay):0;o&&(6===e.previousNode.type||0==n&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=TS);let c=n;const u=e.invokeQuery(i.selector,i.originalSelector,i.limit,i.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=u.length;let m=null;u.forEach((g,x)=>{e.currentQueryIndex=x;const S=e.createSubContext(i.options,g);o&&S.delayNextStep(o),g===e.element&&(m=S.currentTimeline),lc(this,i.animation,S),S.currentTimeline.applyStylesToKeyframe(),c=Math.max(c,S.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(c),m&&(e.currentTimeline.mergeTimelineCollectedStyles(m),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=i}visitStagger(i,e){const n=e.parentContext,r=e.currentTimeline,o=i.timings,c=Math.abs(o.duration),u=c*(e.currentQueryTotal-1);let m=c*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":m=u-m;break;case"full":m=n.currentStaggerTime}const x=e.currentTimeline;m&&x.delayNextStep(m);const S=x.currentTime;lc(this,i.animation,e),e.previousNode=i,n.currentStaggerTime=r.currentTime-S+(r.startTime-n.currentTimeline.startTime)}}const TS={};class NM{constructor(i,e,n,r,o,c,u,m){this._driver=i,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=o,this.errors=c,this.timelines=u,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=TS,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=m||new SS(this._driver,e,0),u.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(i,e){if(!i)return;const n=i;let r=this.options;null!=n.duration&&(r.duration=Vm(n.duration)),null!=n.delay&&(r.delay=Vm(n.delay));const o=n.params;if(o){let c=r.params;c||(c=this.options.params={}),Object.keys(o).forEach(u=>{(!e||!c.hasOwnProperty(u))&&(c[u]=mS(o[u],c,this.errors))})}}_copyOptions(){const i={};if(this.options){const e=this.options.params;if(e){const n=i.params={};Object.keys(e).forEach(r=>{n[r]=e[r]})}}return i}createSubContext(i=null,e,n){const r=e||this.element,o=new NM(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(i),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(i){return this.previousNode=TS,this.currentTimeline=this.currentTimeline.fork(this.element,i),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(i,e,n){const r={duration:null!=e?e:i.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+i.delay,easing:""},o=new t1e(this._driver,i.element,i.keyframes,i.preStyleProps,i.postStyleProps,r,i.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(i){this.currentTimeline.forwardTime(this.currentTimeline.duration+i)}delayNextStep(i){i>0&&this.currentTimeline.delayNextStep(i)}invokeQuery(i,e,n,r,o,c){let u=[];if(r&&u.push(this.element),i.length>0){i=(i=i.replace(Q_e,"."+this._enterClassName)).replace(Z_e,"."+this._leaveClassName);let g=this._driver.query(this.element,i,1!=n);0!==n&&(g=n<0?g.slice(g.length+n,g.length):g.slice(0,n)),u.push(...g)}return!o&&0==u.length&&c.push(function l_e(t){return new Tn(3014,ir)}()),u}}class SS{constructor(i,e,n,r){this._driver=i,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(i){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+i),e&&this.snapshotCurrentStyles()):this.startTime+=i}fork(i,e){return this.applyStylesToKeyframe(),new SS(this._driver,i,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(i){this.applyStylesToKeyframe(),this.duration=i,this._loadKeyframe()}_updateStyle(i,e){this._localTimelineStyles[i]=e,this._globalTimelineStyles[i]=e,this._styleSummary[i]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(i){i&&(this._previousKeyframe.easing=i),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||vf,this._currentKeyframe[e]=vf}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(i,e,n,r){e&&(this._previousKeyframe.easing=e);const o=r&&r.params||{},c=function n1e(t,i){const e={};let n;return t.forEach(r=>{"*"===r?(n=n||Object.keys(i),n.forEach(o=>{e[o]=vf})):Qp(r,!1,e)}),e}(i,this._globalTimelineStyles);Object.keys(c).forEach(u=>{const m=mS(c[u],o,n);this._pendingStyles[u]=m,this._localTimelineStyles.hasOwnProperty(u)||(this._backFill[u]=this._globalTimelineStyles.hasOwnProperty(u)?this._globalTimelineStyles[u]:vf),this._updateStyle(u,m)})}applyStylesToKeyframe(){const i=this._pendingStyles,e=Object.keys(i);0!=e.length&&(this._pendingStyles={},e.forEach(n=>{this._currentKeyframe[n]=i[n]}),Object.keys(this._localTimelineStyles).forEach(n=>{this._currentKeyframe.hasOwnProperty(n)||(this._currentKeyframe[n]=this._localTimelineStyles[n])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(i=>{const e=this._localTimelineStyles[i];this._pendingStyles[i]=e,this._updateStyle(i,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const i=[];for(let e in this._currentKeyframe)i.push(e);return i}mergeTimelineCollectedStyles(i){Object.keys(i._styleSummary).forEach(e=>{const n=this._styleSummary[e],r=i._styleSummary[e];(!n||r.time>n.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const i=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((u,m)=>{const g=Qp(u,!0);Object.keys(g).forEach(x=>{const S=g[x];"!"==S?i.add(x):S==vf&&e.add(x)}),n||(g.offset=m/this.duration),r.push(g)});const o=i.size?gS(i.values()):[],c=e.size?gS(e.values()):[];if(n){const u=r[0],m=o_(u);u.offset=0,m.offset=1,r=[u,m]}return PM(this.element,r,o,c,this.duration,this.startTime,this.easing,!1)}}class t1e extends SS{constructor(i,e,n,r,o,c,u=!1){super(i,e,c.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=u,this.timings={duration:c.duration,delay:c.delay,easing:c.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let i=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],c=n+e,u=e/c,m=Qp(i[0],!1);m.offset=0,o.push(m);const g=Qp(i[0],!1);g.offset=P9(u),o.push(g);const x=i.length-1;for(let S=1;S<=x;S++){let M=Qp(i[S],!1);M.offset=P9((e+M.offset*n)/c),o.push(M)}n=c,e=0,r="",i=o}return PM(this.element,i,this.preStyleProps,this.postStyleProps,n,e,r,!0)}}function P9(t,i=3){const e=Math.pow(10,i-1);return Math.round(t*e)/e}class LM{}class i1e extends LM{normalizePropertyName(i,e){return AM(i)}normalizeStyleValue(i,e,n,r){let o="";const c=n.toString().trim();if(r1e[e]&&0!==n&&"0"!==n)if("number"==typeof n)o="px";else{const u=n.match(/^[+-]?[\d\.]+([a-z]*)$/);u&&0==u[1].length&&r.push(function Q0e(t,i){return new Tn(3005,ir)}())}return c+o}}const r1e=(()=>function o1e(t){const i={};return t.forEach(e=>i[e]=!0),i}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function O9(t,i,e,n,r,o,c,u,m,g,x,S,M){return{type:0,element:t,triggerName:i,isRemovalTransition:r,fromState:e,fromStyles:o,toState:n,toStyles:c,timelines:u,queriedElements:m,preStyleProps:g,postStyleProps:x,totalTime:S,errors:M}}const RM={};class N9{constructor(i,e,n){this._triggerName=i,this.ast=e,this._stateStyles=n}match(i,e,n,r){return function s1e(t,i,e,n,r){return t.some(o=>o(i,e,n,r))}(this.ast.matchers,i,e,n,r)}buildStyles(i,e,n){const r=this._stateStyles["*"],o=this._stateStyles[i],c=r?r.buildStyles(e,n):{};return o?o.buildStyles(e,n):c}build(i,e,n,r,o,c,u,m,g,x){const S=[],M=this.ast.options&&this.ast.options.params||RM,R=this.buildStyles(n,u&&u.params||RM,S),B=m&&m.params||RM,K=this.buildStyles(r,B,S),q=new Set,Y=new Map,ce=new Map,De="void"===r,Ye={params:Object.assign(Object.assign({},M),B)},yt=x?[]:OM(i,e,this.ast.animation,o,c,R,K,Ye,g,S);let Ge=0;if(yt.forEach(mt=>{Ge=Math.max(mt.duration+mt.delay,Ge)}),S.length)return O9(e,this._triggerName,n,r,De,R,K,[],[],Y,ce,Ge,S);yt.forEach(mt=>{const vt=mt.element,fe=ac(Y,vt,{});mt.preStyleProps.forEach(Oe=>fe[Oe]=!0);const de=ac(ce,vt,{});mt.postStyleProps.forEach(Oe=>de[Oe]=!0),vt!==e&&q.add(vt)});const Te=gS(q.values());return O9(e,this._triggerName,n,r,De,R,K,yt,Te,Y,ce,Ge)}}class a1e{constructor(i,e,n){this.styles=i,this.defaultParams=e,this.normalizer=n}buildStyles(i,e){const n={},r=o_(this.defaultParams);return Object.keys(i).forEach(o=>{const c=i[o];null!=c&&(r[o]=c)}),this.styles.styles.forEach(o=>{if("string"!=typeof o){const c=o;Object.keys(c).forEach(u=>{let m=c[u];m.length>1&&(m=mS(m,r,e));const g=this.normalizer.normalizePropertyName(u,e);m=this.normalizer.normalizeStyleValue(u,g,m,e),n[g]=m})}}),n}}class c1e{constructor(i,e,n){this.name=i,this.ast=e,this._normalizer=n,this.transitionFactories=[],this.states={},e.states.forEach(r=>{this.states[r.name]=new a1e(r.style,r.options&&r.options.params||{},n)}),L9(this.states,"true","1"),L9(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new N9(i,r,this.states))}),this.fallbackTransition=function u1e(t,i,e){return new N9(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(c,u)=>!0],options:null,queryCount:0,depCount:0},i)}(i,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(i,e,n,r){return this.transitionFactories.find(c=>c.match(i,e,n,r))||null}matchStyles(i,e,n){return this.fallbackTransition.buildStyles(i,e,n)}}function L9(t,i,e){t.hasOwnProperty(i)?t.hasOwnProperty(e)||(t[e]=t[i]):t.hasOwnProperty(e)&&(t[i]=t[e])}const d1e=new CS;class f1e{constructor(i,e,n){this.bodyNode=i,this._driver=e,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(i,e){const n=[],o=MM(this._driver,e,n,[]);if(n.length)throw function m_e(t){return new Tn(3503,ir)}();this._animations[i]=o}_buildPlayer(i,e,n){const r=i.element,o=h9(0,this._normalizer,0,i.keyframes,e,n);return this._driver.animate(r,o,i.duration,i.delay,i.easing,[],!0)}create(i,e,n={}){const r=[],o=this._animations[i];let c;const u=new Map;if(o?(c=OM(this._driver,e,o,EM,dS,{},{},n,d1e,r),c.forEach(x=>{const S=ac(u,x.element,{});x.postStyleProps.forEach(M=>S[M]=null)})):(r.push(function g_e(){return new Tn(3300,ir)}()),c=[]),r.length)throw function __e(t){return new Tn(3504,ir)}();u.forEach((x,S)=>{Object.keys(x).forEach(M=>{x[M]=this._driver.computeStyle(S,M,vf)})});const g=Xp(c.map(x=>{const S=u.get(x.element);return this._buildPlayer(x,{},S)}));return this._playersById[i]=g,g.onDestroy(()=>this.destroy(i)),this.players.push(g),g}destroy(i){const e=this._getPlayer(i);e.destroy(),delete this._playersById[i];const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(i){const e=this._playersById[i];if(!e)throw function v_e(t){return new Tn(3301,ir)}();return e}listen(i,e,n,r){const o=wM(e,"","","");return bM(this._getPlayer(i),n,o,r),()=>{}}command(i,e,n,r){if("register"==n)return void this.register(i,r[0]);if("create"==n)return void this.create(i,e,r[0]||{});const o=this._getPlayer(i);switch(n){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(i)}}}const R9="ng-animate-queued",BM="ng-animate-disabled",_1e=[],B9={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},v1e={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},$c="__ng_removed";class jM{constructor(i,e=""){this.namespaceId=e;const n=i&&i.hasOwnProperty("value");if(this.value=function w1e(t){return null!=t?t:null}(n?i.value:i),n){const o=o_(i);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(i){const e=i.params;if(e){const n=this.options.params;Object.keys(e).forEach(r=>{null==n[r]&&(n[r]=e[r])})}}}const sb="void",VM=new jM(sb);class y1e{constructor(i,e,n){this.id=i,this.hostElement=e,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+i,Wc(e,this._hostClassName)}listen(i,e,n,r){if(!this._triggers.hasOwnProperty(e))throw function y_e(t,i){return new Tn(3302,ir)}();if(null==n||0==n.length)throw function b_e(t){return new Tn(3303,ir)}();if(!function C1e(t){return"start"==t||"done"==t}(n))throw function x_e(t,i){return new Tn(3400,ir)}();const o=ac(this._elementListeners,i,[]),c={name:e,phase:n,callback:r};o.push(c);const u=ac(this._engine.statesByElement,i,{});return u.hasOwnProperty(e)||(Wc(i,fS),Wc(i,fS+"-"+e),u[e]=VM),()=>{this._engine.afterFlush(()=>{const m=o.indexOf(c);m>=0&&o.splice(m,1),this._triggers[e]||delete u[e]})}}register(i,e){return!this._triggers[i]&&(this._triggers[i]=e,!0)}_getTrigger(i){const e=this._triggers[i];if(!e)throw function w_e(t){return new Tn(3401,ir)}();return e}trigger(i,e,n,r=!0){const o=this._getTrigger(e),c=new UM(this.id,e,i);let u=this._engine.statesByElement.get(i);u||(Wc(i,fS),Wc(i,fS+"-"+e),this._engine.statesByElement.set(i,u={}));let m=u[e];const g=new jM(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&m&&g.absorbOptions(m.options),u[e]=g,m||(m=VM),g.value!==sb&&m.value===g.value){if(!function E1e(t,i){const e=Object.keys(t),n=Object.keys(i);if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++){const o=e[r];if(!i.hasOwnProperty(o)||t[o]!==i[o])return!1}return!0}(m.params,g.params)){const B=[],K=o.matchStyles(m.value,m.params,B),q=o.matchStyles(g.value,g.params,B);B.length?this._engine.reportError(B):this._engine.afterFlush(()=>{Um(i,K),Cd(i,q)})}return}const M=ac(this._engine.playersByElement,i,[]);M.forEach(B=>{B.namespaceId==this.id&&B.triggerName==e&&B.queued&&B.destroy()});let E=o.matchTransition(m.value,g.value,i,g.params),R=!1;if(!E){if(!r)return;E=o.fallbackTransition,R=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:i,triggerName:e,transition:E,fromState:m,toState:g,player:c,isFallbackTransition:R}),R||(Wc(i,R9),c.onStart(()=>{s_(i,R9)})),c.onDone(()=>{let B=this.players.indexOf(c);B>=0&&this.players.splice(B,1);const K=this._engine.playersByElement.get(i);if(K){let q=K.indexOf(c);q>=0&&K.splice(q,1)}}),this.players.push(c),M.push(c),c}deregister(i){delete this._triggers[i],this._engine.statesByElement.forEach((e,n)=>{delete e[i]}),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(r=>r.name!=i))})}clearElementCache(i){this._engine.statesByElement.delete(i),this._elementListeners.delete(i);const e=this._engine.playersByElement.get(i);e&&(e.forEach(n=>n.destroy()),this._engine.playersByElement.delete(i))}_signalRemovalForInnerTriggers(i,e){const n=this._engine.driver.query(i,pS,!0);n.forEach(r=>{if(r[$c])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(c=>c.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(i,e,n,r){const o=this._engine.statesByElement.get(i),c=new Map;if(o){const u=[];if(Object.keys(o).forEach(m=>{if(c.set(m,o[m].value),this._triggers[m]){const g=this.trigger(i,m,sb,r);g&&u.push(g)}}),u.length)return this._engine.markElementAsRemoved(this.id,i,!0,e,c),n&&Xp(u).onDone(()=>this._engine.processLeaveNode(i)),!0}return!1}prepareLeaveAnimationListeners(i){const e=this._elementListeners.get(i),n=this._engine.statesByElement.get(i);if(e&&n){const r=new Set;e.forEach(o=>{const c=o.name;if(r.has(c))return;r.add(c);const m=this._triggers[c].fallbackTransition,g=n[c]||VM,x=new jM(sb),S=new UM(this.id,c,i);this._engine.totalQueuedPlayers++,this._queue.push({element:i,triggerName:c,transition:m,fromState:g,toState:x,player:S,isFallbackTransition:!0})})}}removeNode(i,e){const n=this._engine;if(i.childElementCount&&this._signalRemovalForInnerTriggers(i,e),this.triggerLeaveAnimation(i,e,!0))return;let r=!1;if(n.totalAnimations){const o=n.players.length?n.playersByQueriedElement.get(i):[];if(o&&o.length)r=!0;else{let c=i;for(;c=c.parentNode;)if(n.statesByElement.get(c)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(i),r)n.markElementAsRemoved(this.id,i,!1,e);else{const o=i[$c];(!o||o===B9)&&(n.afterFlush(()=>this.clearElementCache(i)),n.destroyInnerAnimations(i),n._onRemovalComplete(i,e))}}insertNode(i,e){Wc(i,this._hostClassName)}drainQueuedTransitions(i){const e=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const o=n.element,c=this._elementListeners.get(o);c&&c.forEach(u=>{if(u.name==n.triggerName){const m=wM(o,n.triggerName,n.fromState.value,n.toState.value);m._data=i,bM(n.player,u.phase,m,u.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((n,r)=>{const o=n.transition.ast.depCount,c=r.transition.ast.depCount;return 0==o||0==c?o-c:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(i){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,i)}elementContainsData(i){let e=!1;return this._elementListeners.has(i)&&(e=!0),e=!!this._queue.find(n=>n.element===i)||e,e}}class b1e{constructor(i,e,n){this.bodyNode=i,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}_onRemovalComplete(i,e){this.onRemovalComplete(i,e)}get queuedPlayers(){const i=[];return this._namespaceList.forEach(e=>{e.players.forEach(n=>{n.queued&&i.push(n)})}),i}createNamespace(i,e){const n=new y1e(i,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[i]=n}_balanceNamespaceList(i,e){const n=this._namespaceList,r=this.namespacesByHostElement,o=n.length-1;if(o>=0){let c=!1;if(void 0!==this.driver.getParentElement){let u=this.driver.getParentElement(e);for(;u;){const m=r.get(u);if(m){const g=n.indexOf(m);n.splice(g+1,0,i),c=!0;break}u=this.driver.getParentElement(u)}}else for(let u=o;u>=0;u--)if(this.driver.containsElement(n[u].hostElement,e)){n.splice(u+1,0,i),c=!0;break}c||n.unshift(i)}else n.push(i);return r.set(e,i),i}register(i,e){let n=this._namespaceLookup[i];return n||(n=this.createNamespace(i,e)),n}registerTrigger(i,e,n){let r=this._namespaceLookup[i];r&&r.register(e,n)&&this.totalAnimations++}destroy(i,e){if(!i)return;const n=this._fetchNamespace(i);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[i];const r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(i){return this._namespaceLookup[i]}fetchNamespacesByElement(i){const e=new Set,n=this.statesByElement.get(i);if(n){const r=Object.keys(n);for(let o=0;o<r.length;o++){const c=n[r[o]].namespaceId;if(c){const u=this._fetchNamespace(c);u&&e.add(u)}}}return e}trigger(i,e,n,r){if(ES(e)){const o=this._fetchNamespace(i);if(o)return o.trigger(e,n,r),!0}return!1}insertNode(i,e,n,r){if(!ES(e))return;const o=e[$c];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const c=this.collectedLeaveElements.indexOf(e);c>=0&&this.collectedLeaveElements.splice(c,1)}if(i){const c=this._fetchNamespace(i);c&&c.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(i){this.collectedEnterElements.push(i)}markElementAsDisabled(i,e){e?this.disabledNodes.has(i)||(this.disabledNodes.add(i),Wc(i,BM)):this.disabledNodes.has(i)&&(this.disabledNodes.delete(i),s_(i,BM))}removeNode(i,e,n,r){if(ES(e)){const o=i?this._fetchNamespace(i):null;if(o?o.removeNode(e,r):this.markElementAsRemoved(i,e,!1,r),n){const c=this.namespacesByHostElement.get(e);c&&c.id!==i&&c.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(i,e,n,r,o){this.collectedLeaveElements.push(e),e[$c]={namespaceId:i,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:o}}listen(i,e,n,r,o){return ES(e)?this._fetchNamespace(i).listen(e,n,r,o):()=>{}}_buildInstruction(i,e,n,r,o){return i.transition.build(this.driver,i.element,i.fromState.value,i.toState.value,n,r,i.fromState.options,i.toState.options,e,o)}destroyInnerAnimations(i){let e=this.driver.query(i,pS,!0);e.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(i,kM,!0),e.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(i){const e=this.playersByElement.get(i);e&&e.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(i){const e=this.playersByQueriedElement.get(i);e&&e.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(i=>{if(this.players.length)return Xp(this.players).onDone(()=>i());i()})}processLeaveNode(i){var e;const n=i[$c];if(n&&n.setForRemoval){if(i[$c]=B9,n.namespaceId){this.destroyInnerAnimations(i);const r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(i)}this._onRemovalComplete(i,n.setForRemoval)}(null===(e=i.classList)||void 0===e?void 0:e.contains(BM))&&this.markElementAsDisabled(i,!1),this.driver.query(i,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(i=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Wc(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,i)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],e.length?Xp(e).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(i){throw function C_e(t){return new Tn(3402,ir)}()}_flushAnimations(i,e){const n=new CS,r=[],o=new Map,c=[],u=new Map,m=new Map,g=new Map,x=new Set;this.disabledNodes.forEach(Re=>{x.add(Re);const Je=this.driver.query(Re,".ng-animate-queued",!0);for(let Ue=0;Ue<Je.length;Ue++)x.add(Je[Ue])});const S=this.bodyNode,M=Array.from(this.statesByElement.keys()),E=U9(M,this.collectedEnterElements),R=new Map;let B=0;E.forEach((Re,Je)=>{const Ue=EM+B++;R.set(Je,Ue),Re.forEach(lt=>Wc(lt,Ue))});const K=[],q=new Set,Y=new Set;for(let Re=0;Re<this.collectedLeaveElements.length;Re++){const Je=this.collectedLeaveElements[Re],Ue=Je[$c];Ue&&Ue.setForRemoval&&(K.push(Je),q.add(Je),Ue.hasAnimation?this.driver.query(Je,".ng-star-inserted",!0).forEach(lt=>q.add(lt)):Y.add(Je))}const ce=new Map,De=U9(M,Array.from(q));De.forEach((Re,Je)=>{const Ue=dS+B++;ce.set(Je,Ue),Re.forEach(lt=>Wc(lt,Ue))}),i.push(()=>{E.forEach((Re,Je)=>{const Ue=R.get(Je);Re.forEach(lt=>s_(lt,Ue))}),De.forEach((Re,Je)=>{const Ue=ce.get(Je);Re.forEach(lt=>s_(lt,Ue))}),K.forEach(Re=>{this.processLeaveNode(Re)})});const Ye=[],yt=[];for(let Re=this._namespaceList.length-1;Re>=0;Re--)this._namespaceList[Re].drainQueuedTransitions(e).forEach(Ue=>{const lt=Ue.player,_t=Ue.element;if(Ye.push(lt),this.collectedEnterElements.length){const it=_t[$c];if(it&&it.setForMove){if(it.previousTriggersValues&&it.previousTriggersValues.has(Ue.triggerName)){const ct=it.previousTriggersValues.get(Ue.triggerName),pt=this.statesByElement.get(Ue.element);pt&&pt[Ue.triggerName]&&(pt[Ue.triggerName].value=ct)}return void lt.destroy()}}const on=!S||!this.driver.containsElement(S,_t),ne=ce.get(_t),ve=R.get(_t),we=this._buildInstruction(Ue,n,ve,ne,on);if(we.errors&&we.errors.length)return void yt.push(we);if(on)return lt.onStart(()=>Um(_t,we.fromStyles)),lt.onDestroy(()=>Cd(_t,we.toStyles)),void r.push(lt);if(Ue.isFallbackTransition)return lt.onStart(()=>Um(_t,we.fromStyles)),lt.onDestroy(()=>Cd(_t,we.toStyles)),void r.push(lt);const je=[];we.timelines.forEach(it=>{it.stretchStartingKeyframe=!0,this.disabledNodes.has(it.element)||je.push(it)}),we.timelines=je,n.append(_t,we.timelines),c.push({instruction:we,player:lt,element:_t}),we.queriedElements.forEach(it=>ac(u,it,[]).push(lt)),we.preStyleProps.forEach((it,ct)=>{const pt=Object.keys(it);if(pt.length){let qt=m.get(ct);qt||m.set(ct,qt=new Set),pt.forEach(Gt=>qt.add(Gt))}}),we.postStyleProps.forEach((it,ct)=>{const pt=Object.keys(it);let qt=g.get(ct);qt||g.set(ct,qt=new Set),pt.forEach(Gt=>qt.add(Gt))})});if(yt.length){const Re=[];yt.forEach(Je=>{Re.push(function T_e(t,i){return new Tn(3505,ir)}())}),Ye.forEach(Je=>Je.destroy()),this.reportError(Re)}const Ge=new Map,Te=new Map;c.forEach(Re=>{const Je=Re.element;n.has(Je)&&(Te.set(Je,Je),this._beforeAnimationBuild(Re.player.namespaceId,Re.instruction,Ge))}),r.forEach(Re=>{const Je=Re.element;this._getPreviousPlayers(Je,!1,Re.namespaceId,Re.triggerName,null).forEach(lt=>{ac(Ge,Je,[]).push(lt),lt.destroy()})});const mt=K.filter(Re=>z9(Re,m,g)),vt=new Map;V9(vt,this.driver,Y,g,vf).forEach(Re=>{z9(Re,m,g)&&mt.push(Re)});const de=new Map;E.forEach((Re,Je)=>{V9(de,this.driver,new Set(Re),m,"!")}),mt.forEach(Re=>{const Je=vt.get(Re),Ue=de.get(Re);vt.set(Re,Object.assign(Object.assign({},Je),Ue))});const Oe=[],Ae=[],Ct={};c.forEach(Re=>{const{element:Je,player:Ue,instruction:lt}=Re;if(n.has(Je)){if(x.has(Je))return Ue.onDestroy(()=>Cd(Je,lt.toStyles)),Ue.disabled=!0,Ue.overrideTotalTime(lt.totalTime),void r.push(Ue);let _t=Ct;if(Te.size>1){let ne=Je;const ve=[];for(;ne=ne.parentNode;){const we=Te.get(ne);if(we){_t=we;break}ve.push(ne)}ve.forEach(we=>Te.set(we,_t))}const on=this._buildAnimation(Ue.namespaceId,lt,Ge,o,de,vt);if(Ue.setRealPlayer(on),_t===Ct)Oe.push(Ue);else{const ne=this.playersByElement.get(_t);ne&&ne.length&&(Ue.parentPlayer=Xp(ne)),r.push(Ue)}}else Um(Je,lt.fromStyles),Ue.onDestroy(()=>Cd(Je,lt.toStyles)),Ae.push(Ue),x.has(Je)&&r.push(Ue)}),Ae.forEach(Re=>{const Je=o.get(Re.element);if(Je&&Je.length){const Ue=Xp(Je);Re.setRealPlayer(Ue)}}),r.forEach(Re=>{Re.parentPlayer?Re.syncPlayerEvents(Re.parentPlayer):Re.destroy()});for(let Re=0;Re<K.length;Re++){const Je=K[Re],Ue=Je[$c];if(s_(Je,dS),Ue&&Ue.hasAnimation)continue;let lt=[];if(u.size){let on=u.get(Je);on&&on.length&&lt.push(...on);let ne=this.driver.query(Je,kM,!0);for(let ve=0;ve<ne.length;ve++){let we=u.get(ne[ve]);we&&we.length&&lt.push(...we)}}const _t=lt.filter(on=>!on.destroyed);_t.length?T1e(this,Je,_t):this.processLeaveNode(Je)}return K.length=0,Oe.forEach(Re=>{this.players.push(Re),Re.onDone(()=>{Re.destroy();const Je=this.players.indexOf(Re);this.players.splice(Je,1)}),Re.play()}),Oe}elementContainsData(i,e){let n=!1;const r=e[$c];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(i).elementContainsData(e)||n}afterFlush(i){this._flushFns.push(i)}afterFlushAnimationsDone(i){this._whenQuietFns.push(i)}_getPreviousPlayers(i,e,n,r,o){let c=[];if(e){const u=this.playersByQueriedElement.get(i);u&&(c=u)}else{const u=this.playersByElement.get(i);if(u){const m=!o||o==sb;u.forEach(g=>{g.queued||!m&&g.triggerName!=r||c.push(g)})}}return(n||r)&&(c=c.filter(u=>!(n&&n!=u.namespaceId||r&&r!=u.triggerName))),c}_beforeAnimationBuild(i,e,n){const o=e.element,c=e.isRemovalTransition?void 0:i,u=e.isRemovalTransition?void 0:e.triggerName;for(const m of e.timelines){const g=m.element,x=g!==o,S=ac(n,g,[]);this._getPreviousPlayers(g,x,c,u,e.toState).forEach(E=>{const R=E.getRealPlayer();R.beforeDestroy&&R.beforeDestroy(),E.destroy(),S.push(E)})}Um(o,e.fromStyles)}_buildAnimation(i,e,n,r,o,c){const u=e.triggerName,m=e.element,g=[],x=new Set,S=new Set,M=e.timelines.map(R=>{const B=R.element;x.add(B);const K=B[$c];if(K&&K.removedBeforeQueried)return new Vy(R.duration,R.delay);const q=B!==m,Y=function S1e(t){const i=[];return H9(t,i),i}((n.get(B)||_1e).map(Ge=>Ge.getRealPlayer())).filter(Ge=>!!Ge.element&&Ge.element===B),ce=o.get(B),De=c.get(B),Ye=h9(0,this._normalizer,0,R.keyframes,ce,De),yt=this._buildPlayer(R,Ye,Y);if(R.subTimeline&&r&&S.add(B),q){const Ge=new UM(i,u,B);Ge.setRealPlayer(yt),g.push(Ge)}return yt});g.forEach(R=>{ac(this.playersByQueriedElement,R.element,[]).push(R),R.onDone(()=>function x1e(t,i,e){let n;if(t instanceof Map){if(n=t.get(i),n){if(n.length){const r=n.indexOf(e);n.splice(r,1)}0==n.length&&t.delete(i)}}else if(n=t[i],n){if(n.length){const r=n.indexOf(e);n.splice(r,1)}0==n.length&&delete t[i]}return n}(this.playersByQueriedElement,R.element,R))}),x.forEach(R=>Wc(R,T9));const E=Xp(M);return E.onDestroy(()=>{x.forEach(R=>s_(R,T9)),Cd(m,e.toStyles)}),S.forEach(R=>{ac(r,R,[]).push(E)}),E}_buildPlayer(i,e,n){return e.length>0?this.driver.animate(i.element,e,i.duration,i.delay,i.easing,n):new Vy(i.duration,i.delay)}}class UM{constructor(i,e,n){this.namespaceId=i,this.triggerName=e,this.element=n,this._player=new Vy,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(i){this._containsRealPlayer||(this._player=i,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(n=>bM(i,e,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(i.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(i){this.totalTime=i}syncPlayerEvents(i){const e=this._player;e.triggerCallback&&i.onStart(()=>e.triggerCallback("start")),i.onDone(()=>this.finish()),i.onDestroy(()=>this.destroy())}_queueEvent(i,e){ac(this._queuedCallbacks,i,[]).push(e)}onDone(i){this.queued&&this._queueEvent("done",i),this._player.onDone(i)}onStart(i){this.queued&&this._queueEvent("start",i),this._player.onStart(i)}onDestroy(i){this.queued&&this._queueEvent("destroy",i),this._player.onDestroy(i)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(i){this.queued||this._player.setPosition(i)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(i){const e=this._player;e.triggerCallback&&e.triggerCallback(i)}}function ES(t){return t&&1===t.nodeType}function j9(t,i){const e=t.style.display;return t.style.display=null!=i?i:"none",e}function V9(t,i,e,n,r){const o=[];e.forEach(m=>o.push(j9(m)));const c=[];n.forEach((m,g)=>{const x={};m.forEach(S=>{const M=x[S]=i.computeStyle(g,S,r);(!M||0==M.length)&&(g[$c]=v1e,c.push(g))}),t.set(g,x)});let u=0;return e.forEach(m=>j9(m,o[u++])),c}function U9(t,i){const e=new Map;if(t.forEach(u=>e.set(u,[])),0==i.length)return e;const r=new Set(i),o=new Map;function c(u){if(!u)return 1;let m=o.get(u);if(m)return m;const g=u.parentNode;return m=e.has(g)?g:r.has(g)?1:c(g),o.set(u,m),m}return i.forEach(u=>{const m=c(u);1!==m&&e.get(m).push(u)}),e}function Wc(t,i){var e;null===(e=t.classList)||void 0===e||e.add(i)}function s_(t,i){var e;null===(e=t.classList)||void 0===e||e.remove(i)}function T1e(t,i,e){Xp(e).onDone(()=>t.processLeaveNode(i))}function H9(t,i){for(let e=0;e<t.length;e++){const n=t[e];n instanceof kL?H9(n.players,i):i.push(n)}}function z9(t,i,e){const n=e.get(t);if(!n)return!1;let r=i.get(t);return r?n.forEach(o=>r.add(o)):i.set(t,n),e.delete(t),!0}class kS{constructor(i,e,n){this.bodyNode=i,this._driver=e,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new b1e(i,e,n),this._timelineEngine=new f1e(i,e,n),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(i,e,n,r,o){const c=i+"-"+r;let u=this._triggerCache[c];if(!u){const m=[],x=MM(this._driver,o,m,[]);if(m.length)throw function p_e(t,i){return new Tn(3404,ir)}();u=function l1e(t,i,e){return new c1e(t,i,e)}(r,x,this._normalizer),this._triggerCache[c]=u}this._transitionEngine.registerTrigger(e,r,u)}register(i,e){this._transitionEngine.register(i,e)}destroy(i,e){this._transitionEngine.destroy(i,e)}onInsert(i,e,n,r){this._transitionEngine.insertNode(i,e,n,r)}onRemove(i,e,n,r){this._transitionEngine.removeNode(i,e,r||!1,n)}disableAnimations(i,e){this._transitionEngine.markElementAsDisabled(i,e)}process(i,e,n,r){if("@"==n.charAt(0)){const[o,c]=m9(n);this._timelineEngine.command(o,e,c,r)}else this._transitionEngine.trigger(i,e,n,r)}listen(i,e,n,r,o){if("@"==n.charAt(0)){const[c,u]=m9(n);return this._timelineEngine.listen(c,e,u,o)}return this._transitionEngine.listen(i,e,n,r,o)}flush(i=-1){this._transitionEngine.flush(i)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let D1e=(()=>{class t{constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r,this._state=0;let o=t.initialStylesByElement.get(e);o||t.initialStylesByElement.set(e,o={}),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Cd(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Cd(this._element,this._initialStyles),this._endStyles&&(Cd(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(Um(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Um(this._element,this._endStyles),this._endStyles=null),Cd(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function HM(t){let i=null;const e=Object.keys(t);for(let n=0;n<e.length;n++){const r=e[n];I1e(r)&&(i=i||{},i[r]=t[r])}return i}function I1e(t){return"display"===t||"position"===t}class $9{constructor(i,e,n,r){this.element=i,this.keyframes=e,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(i=>i()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const i=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,i,this.options),this._finalKeyframe=i.length?i[i.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(i,e,n){return i.animate(e,n)}onStart(i){this._onStartFns.push(i)}onDone(i){this._onDoneFns.push(i)}onDestroy(i){this._onDestroyFns.push(i)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(i=>i()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(i=>i()),this._onDestroyFns=[])}setPosition(i){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=i*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const i={};if(this.hasStarted()){const e=this._finalKeyframe;Object.keys(e).forEach(n=>{"offset"!=n&&(i[n]=this._finished?e[n]:I9(this.element,n))})}this.currentSnapshot=i}triggerCallback(i){const e="start"==i?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class A1e{validateStyleProperty(i){return y9(i)}matchesElement(i,e){return!1}containsElement(i,e){return b9(i,e)}getParentElement(i){return TM(i)}query(i,e,n){return x9(i,e,n)}computeStyle(i,e,n){return window.getComputedStyle(i)[e]}animate(i,e,n,r,o,c=[]){const m={duration:n,delay:r,fill:0==r?"both":"forwards"};o&&(m.easing=o);const g={},x=c.filter(M=>M instanceof $9);(function O_e(t,i){return 0===t||0===i})(n,r)&&x.forEach(M=>{let E=M.currentSnapshot;Object.keys(E).forEach(R=>g[R]=E[R])}),e=function N_e(t,i,e){const n=Object.keys(e);if(n.length&&i.length){let o=i[0],c=[];if(n.forEach(u=>{o.hasOwnProperty(u)||c.push(u),o[u]=e[u]}),c.length)for(var r=1;r<i.length;r++){let u=i[r];c.forEach(function(m){u[m]=I9(t,m)})}}return i}(i,e=e.map(M=>Qp(M,!1)),g);const S=function k1e(t,i){let e=null,n=null;return Array.isArray(i)&&i.length?(e=HM(i[0]),i.length>1&&(n=HM(i[i.length-1]))):i&&(e=HM(i)),e||n?new D1e(t,e,n):null}(i,e);return new $9(i,e,m,S)}}let M1e=(()=>{class t extends CL{constructor(e,n){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(n.body,{id:"0",encapsulation:ya.None,styles:[],data:{animation:[]}})}build(e){const n=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?TL(e):e;return W9(this._renderer,null,n,"register",[r]),new F1e(n,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(zt(_m),zt(ra))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();class F1e extends class zW{}{constructor(i,e){super(),this._id=i,this._renderer=e}create(i,e){return new P1e(this._id,i,e||{},this._renderer)}}class P1e{constructor(i,e,n,r){this.id=i,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(i,e){return this._renderer.listen(this.element,`@@${this.id}:${i}`,e)}_command(i,...e){return W9(this._renderer,this.element,this.id,i,e)}onDone(i){this._listen("done",i)}onStart(i){this._listen("start",i)}onDestroy(i){this._listen("destroy",i)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(i){this._command("setPosition",i)}getPosition(){var i,e;return null!==(e=null===(i=this._renderer.engine.players[+this.id])||void 0===i?void 0:i.getPosition())&&void 0!==e?e:0}}function W9(t,i,e,n,r){return t.setProperty(i,`@@${e}:${n}`,r)}const q9="@.disabled";let O1e=(()=>{class t{constructor(e,n,r){this.delegate=e,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(o,c)=>{const u=null==c?void 0:c.parentNode(o);u&&c.removeChild(u,o)}}createRenderer(e,n){const o=this.delegate.createRenderer(e,n);if(!(e&&n&&n.data&&n.data.animation)){let x=this._rendererCache.get(o);return x||(x=new G9("",o,this.engine),this._rendererCache.set(o,x)),x}const c=n.id,u=n.id+"-"+this._currentId;this._currentId++,this.engine.register(u,e);const m=x=>{Array.isArray(x)?x.forEach(m):this.engine.registerTrigger(c,u,e,x.name,x)};return n.data.animation.forEach(m),new N1e(this,u,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,n,r){e>=0&&e<this._microtaskId?this._zone.run(()=>n(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[c,u]=o;c(u)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(zt(_m),zt(kS),zt(gr))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();class G9{constructor(i,e,n){this.namespaceId=i,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?r=>e.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(i,e){return this.delegate.createElement(i,e)}createComment(i){return this.delegate.createComment(i)}createText(i){return this.delegate.createText(i)}appendChild(i,e){this.delegate.appendChild(i,e),this.engine.onInsert(this.namespaceId,e,i,!1)}insertBefore(i,e,n,r=!0){this.delegate.insertBefore(i,e,n),this.engine.onInsert(this.namespaceId,e,i,r)}removeChild(i,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(i,e){return this.delegate.selectRootElement(i,e)}parentNode(i){return this.delegate.parentNode(i)}nextSibling(i){return this.delegate.nextSibling(i)}setAttribute(i,e,n,r){this.delegate.setAttribute(i,e,n,r)}removeAttribute(i,e,n){this.delegate.removeAttribute(i,e,n)}addClass(i,e){this.delegate.addClass(i,e)}removeClass(i,e){this.delegate.removeClass(i,e)}setStyle(i,e,n,r){this.delegate.setStyle(i,e,n,r)}removeStyle(i,e,n){this.delegate.removeStyle(i,e,n)}setProperty(i,e,n){"@"==e.charAt(0)&&e==q9?this.disableAnimations(i,!!n):this.delegate.setProperty(i,e,n)}setValue(i,e){this.delegate.setValue(i,e)}listen(i,e,n){return this.delegate.listen(i,e,n)}disableAnimations(i,e){this.engine.disableAnimations(i,e)}}class N1e extends G9{constructor(i,e,n,r){super(e,n,r),this.factory=i,this.namespaceId=e}setProperty(i,e,n){"@"==e.charAt(0)?"."==e.charAt(1)&&e==q9?this.disableAnimations(i,n=void 0===n||!!n):this.engine.process(this.namespaceId,i,e.substr(1),n):this.delegate.setProperty(i,e,n)}listen(i,e,n){if("@"==e.charAt(0)){const r=function L1e(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(i);let o=e.substr(1),c="";return"@"!=o.charAt(0)&&([o,c]=function R1e(t){const i=t.indexOf(".");return[t.substring(0,i),t.substr(i+1)]}(o)),this.engine.listen(this.namespaceId,r,o,c,u=>{this.factory.scheduleListenerCallback(u._data||-1,n,u)})}return this.delegate.listen(i,e,n)}}let B1e=(()=>{class t extends kS{constructor(e,n,r){super(e.body,n,r)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(e){return new(e||t)(zt(ra),zt(SM),zt(LM))},t.\u0275prov=Vt({token:t,factory:t.\u0275fac}),t})();const K9=new hi("AnimationModuleType"),Y9=[{provide:CL,useClass:M1e},{provide:LM,useFactory:function j1e(){return new i1e}},{provide:kS,useClass:B1e},{provide:_m,useFactory:function V1e(t,i,e){return new O1e(t,i,e)},deps:[L3,kS,gr]}],X9=[{provide:SM,useFactory:()=>new A1e},{provide:K9,useValue:"BrowserAnimations"},...Y9],U1e=[{provide:SM,useClass:w9},{provide:K9,useValue:"NoopAnimations"},...Y9];let zM=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?U1e:X9}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({providers:X9,imports:[R3]}),t})(),H1e=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({providers:[kn],imports:[[Ro,DA,p8,O0,Im,R3,zM,Up,q7,wT,qy,lM,jy,j0,gA,cM]]}),t})(),z1e=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t}),t.\u0275inj=Ci({providers:[kn],imports:[[Ro,DA,p8,O0,Im,R3,zM,Up,q7,wT,qy,lM,jy,j0,gA,F7,H1e,cM,Qfe]]}),t})();!function jd(t,i,e){const n=t.\u0275cmp;n.directiveDefs=()=>i.map(Z_),n.pipeDefs=()=>e.map(cg)}(tb,[Cf,Sn,wf,ki,zn,li,N7,B7],[dr]);let $1e=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ti({type:t,bootstrap:[W0e]}),t.\u0275inj=Ci({providers:[],imports:[[R3,F0e,O0,jy,Im,z1e,DA,ZL,zM,wT,lM,cM,F7,jy,j0,qy,gA,Im,gQ]]}),t})();(function Pj(){eO=!1})(),HU().bootstrapModule($1e).catch(t=>console.error(t))},4327:function(Lf,Pd){var Do;void 0!==(Do=function(){"use strict";function Ia(pi,ji,Os){var ar=new XMLHttpRequest;ar.open("GET",pi),ar.responseType="blob",ar.onload=function(){Ao(ar.response,ji,Os)},ar.onerror=function(){console.error("could not download file")},ar.send()}function lo(pi){var ji=new XMLHttpRequest;ji.open("HEAD",pi,!1);try{ji.send()}catch(Os){}return 200<=ji.status&&299>=ji.status}function fa(pi){try{pi.dispatchEvent(new MouseEvent("click"))}catch(Os){var ji=document.createEvent("MouseEvents");ji.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),pi.dispatchEvent(ji)}}var vs="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,Io=vs.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),Ao=vs.saveAs||("object"!=typeof window||window!==vs?function(){}:"download"in HTMLAnchorElement.prototype&&!Io?function(pi,ji,Os){var ar=vs.URL||vs.webkitURL,Zo=document.createElement("a");Zo.download=ji=ji||pi.name||"download",Zo.rel="noopener","string"==typeof pi?(Zo.href=pi,Zo.origin===location.origin?fa(Zo):lo(Zo.href)?Ia(pi,ji,Os):fa(Zo,Zo.target="_blank")):(Zo.href=ar.createObjectURL(pi),setTimeout(function(){ar.revokeObjectURL(Zo.href)},4e4),setTimeout(function(){fa(Zo)},0))}:"msSaveOrOpenBlob"in navigator?function(pi,ji,Os){if(ji=ji||pi.name||"download","string"!=typeof pi)navigator.msSaveOrOpenBlob(function Ks(pi,ji){return void 0===ji?ji={autoBom:!1}:"object"!=typeof ji&&(console.warn("Deprecated: Expected third argument to be a object"),ji={autoBom:!ji}),ji.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(pi.type)?new Blob(["\ufeff",pi],{type:pi.type}):pi}(pi,Os),ji);else if(lo(pi))Ia(pi,ji,Os);else{var ar=document.createElement("a");ar.href=pi,ar.target="_blank",setTimeout(function(){fa(ar)})}}:function(pi,ji,Os,ar){if((ar=ar||open("","_blank"))&&(ar.document.title=ar.document.body.innerText="downloading..."),"string"==typeof pi)return Ia(pi,ji,Os);var Zo="application/octet-stream"===pi.type,hh=/constructor/i.test(vs.HTMLElement)||vs.safari,Pi=/CriOS\/[\d]+/.test(navigator.userAgent);if((Pi||Zo&&hh||Io)&&"undefined"!=typeof FileReader){var Ul=new FileReader;Ul.onloadend=function(){var Ys=Ul.result;Ys=Pi?Ys:Ys.replace(/^data:[^;]*;/,"data:attachment/file;"),ar?ar.location.href=Ys:location=Ys,ar=null},Ul.readAsDataURL(pi)}else{var Mr=vs.URL||vs.webkitURL,Jc=Mr.createObjectURL(pi);ar?ar.location=Jc:location.href=Jc,ar=null,setTimeout(function(){Mr.revokeObjectURL(Jc)},4e4)}});vs.saveAs=Ao.saveAs=Ao,Lf.exports=Ao}.apply(Pd,[]))&&(Lf.exports=Do)},574:(Lf,Pd,vo)=>{"use strict";vo.r(Pd),vo.d(Pd,{set_cptable:()=>Ul,set_fs:()=>M5,version:()=>u3,parse_xlscfb:()=>fm,parse_zip:()=>qC,read:()=>hm,readFile:()=>ty,readFileSync:()=>ty,write:()=>Ts,writeFile:()=>ry,writeFileSync:()=>ry,writeFileAsync:()=>a6,writeXLSX:()=>ZC,writeFileXLSX:()=>t3,utils:()=>uD,stream:()=>c3,SSF:()=>Qb,CFB:()=>In});var fi_version="0.18.5",Do=1200,Ks=1252,Ia=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],lo={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},fa=function(s){-1!=Ia.indexOf(s)&&(Ks=lo[0]=s)},Io=function(s){Do=s,fa(s)};function Ao(){Io(1200),function vs(){fa(1252)}()}function pi(s){for(var l=[],a=0,d=s.length;a<d;++a)l[a]=s.charCodeAt(a);return l}function Os(s){for(var l=[],a=0;a<s.length>>1;++a)l[a]=String.fromCharCode(s.charCodeAt(2*a+1)+(s.charCodeAt(2*a)<<8));return l.join("")}var Pi,ar=function(s){var l=s.charCodeAt(0),a=s.charCodeAt(1);return 255==l&&254==a?function ji(s){for(var l=[],a=0;a<s.length>>1;++a)l[a]=String.fromCharCode(s.charCodeAt(2*a)+(s.charCodeAt(2*a+1)<<8));return l.join("")}(s.slice(2)):254==l&&255==a?Os(s.slice(2)):65279==l?s.slice(1):s},Zo=function(l){return String.fromCharCode(l)},hh=function(l){return String.fromCharCode(l)};function Ul(s){Pi=s,Io=function(l){Do=l,fa(l)},ar=function(l){return 255===l.charCodeAt(0)&&254===l.charCodeAt(1)?Pi.utils.decode(1200,pi(l.slice(2))):l},Zo=function(a){return 1200===Do?String.fromCharCode(a):Pi.utils.decode(Do,[255&a,a>>8])[0]},hh=function(a){return Pi.utils.decode(Ks,[a])[0]},dg()}var Ys="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function mh(s){for(var l="",a=0,d=0,h=0,y=0,b=0,C=0,I=0,F=0;F<s.length;)y=(a=s.charCodeAt(F++))>>2,b=(3&a)<<4|(d=s.charCodeAt(F++))>>4,C=(15&d)<<2|(h=s.charCodeAt(F++))>>6,I=63&h,isNaN(d)?C=I=64:isNaN(h)&&(I=64),l+=Ys.charAt(y)+Ys.charAt(b)+Ys.charAt(C)+Ys.charAt(I);return l}function pa(s){var l="",y=0,b=0,C=0,I=0;s=s.replace(/[^\w\+\/\=]/g,"");for(var F=0;F<s.length;)y=Ys.indexOf(s.charAt(F++)),b=Ys.indexOf(s.charAt(F++)),l+=String.fromCharCode(y<<2|b>>4),64!==(C=Ys.indexOf(s.charAt(F++)))&&(l+=String.fromCharCode((15&b)<<4|C>>2)),64!==(I=Ys.indexOf(s.charAt(F++)))&&(l+=String.fromCharCode((3&C)<<6|I));return l}var Oi=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),Ga=function(){if("undefined"!=typeof Buffer){var s=!Buffer.from;if(!s)try{Buffer.from("foo","utf8")}catch(l){s=!0}return s?function(l,a){return a?new Buffer(l,a):new Buffer(l)}:Buffer.from.bind(Buffer)}return function(){}}();function Hl(s){return Oi?Buffer.alloc?Buffer.alloc(s):new Buffer(s):"undefined"!=typeof Uint8Array?new Uint8Array(s):new Array(s)}function Lb(s){return Oi?Buffer.allocUnsafe?Buffer.allocUnsafe(s):new Buffer(s):"undefined"!=typeof Uint8Array?new Uint8Array(s):new Array(s)}var ha=function(l){return Oi?Ga(l,"binary"):l.split("").map(function(a){return 255&a.charCodeAt(0)})};function gh(s){if("undefined"==typeof ArrayBuffer)return ha(s);for(var l=new ArrayBuffer(s.length),a=new Uint8Array(l),d=0;d!=s.length;++d)a[d]=255&s.charCodeAt(d);return l}function hc(s){if(Array.isArray(s))return s.map(function(d){return String.fromCharCode(d)}).join("");for(var l=[],a=0;a<s.length;++a)l[a]=String.fromCharCode(s[a]);return l.join("")}function Rb(s){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(s instanceof ArrayBuffer)return Rb(new Uint8Array(s));for(var l=new Array(s.length),a=0;a<s.length;++a)l[a]=s[a];return l}var es=Oi?function(s){return Buffer.concat(s.map(function(l){return Buffer.isBuffer(l)?l:Ga(l)}))}:function(s){if("undefined"!=typeof Uint8Array){var l=0,a=0;for(l=0;l<s.length;++l)a+=s[l].length;var d=new Uint8Array(a),h=0;for(l=0,a=0;l<s.length;a+=h,++l)if(h=s[l].length,s[l]instanceof Uint8Array)d.set(s[l],a);else{if("string"==typeof s[l])throw"wtf";d.set(new Uint8Array(s[l]),a)}return d}return[].concat.apply([],s.map(function(y){return Array.isArray(y)?y:[].slice.call(y)}))},Ns=/\u0000/g,_h=/[\u0001-\u0006]/g;function Rf(s){for(var l="",a=s.length-1;a>=0;)l+=s.charAt(a--);return l}function zl(s,l){var a=""+s;return a.length>=l?a:uo("0",l-a.length)+a}function Wi(s,l){var a=""+s;return a.length>=l?a:uo(" ",l-a.length)+a}function vh(s,l){var a=""+s;return a.length>=l?a:a+uo(" ",l-a.length)}var co=Math.pow(2,32);function Bf(s,l){return s>co||s<-co?function Bb(s,l){var a=""+Math.round(s);return a.length>=l?a:uo("0",l-a.length)+a}(s,l):function Mo(s,l){var a=""+s;return a.length>=l?a:uo("0",l-a.length)+a}(Math.round(s),l)}function or(s,l){return s.length>=7+(l=l||0)&&103==(32|s.charCodeAt(l))&&101==(32|s.charCodeAt(l+1))&&110==(32|s.charCodeAt(l+2))&&101==(32|s.charCodeAt(l+3))&&114==(32|s.charCodeAt(l+4))&&97==(32|s.charCodeAt(l+5))&&108==(32|s.charCodeAt(l+6))}var Zm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],N_=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],Wn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},jb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},_5={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function eg(s,l,a){for(var d=s<0?-1:1,h=s*d,y=0,b=1,C=0,I=1,F=0,O=0,H=Math.floor(h);F<l&&(C=(H=Math.floor(h))*b+y,O=H*F+I,!(h-H<5e-8));)h=1/(h-H),y=b,b=C,I=F,F=O;if(O>l&&(F>l?(O=I,C=y):(O=F,C=b)),!a)return[0,d*C,O];var W=Math.floor(d*C/O);return[W,d*C-W*O,O]}function Gu(s,l,a){if(s>2958465||s<0)return null;var d=0|s,h=Math.floor(86400*(s-d)),y=0,b=[],C={D:d,T:h,u:86400*(s-d)-h,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(C.u)<1e-6&&(C.u=0),l&&l.date1904&&(d+=1462),C.u>.9999&&(C.u=0,86400==++h&&(C.T=h=0,++d,++C.D)),60===d)b=a?[1317,10,29]:[1900,2,29],y=3;else if(0===d)b=a?[1317,8,29]:[1900,1,0],y=6;else{d>60&&--d;var I=new Date(1900,0,1);I.setDate(I.getDate()+d-1),b=[I.getFullYear(),I.getMonth()+1,I.getDate()],y=I.getDay(),d<60&&(y=(y+6)%7),a&&(y=function x5(s,l){l[0]-=581;var a=s.getDay();return s<60&&(a=(a+6)%7),a}(I,b))}return C.y=b[0],C.m=b[1],C.d=b[2],C.S=h%60,h=Math.floor(h/60),C.M=h%60,h=Math.floor(h/60),C.H=h,C.q=y,C}var Vb=new Date(1899,11,31,0,0,0),v5=Vb.getTime(),y5=new Date(1900,2,1,0,0,0);function R_(s,l){var a=s.getTime();return l?a-=1262304e5:s>=y5&&(a+=864e5),(a-(v5+6e4*(s.getTimezoneOffset()-Vb.getTimezoneOffset())))/864e5}function B_(s){return-1==s.indexOf(".")?s:s.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function jf(s){var a,l=Math.floor(Math.log(Math.abs(s))*Math.LOG10E);return a=l>=-4&&l<=-1?s.toPrecision(10+l):Math.abs(l)<=9?function b5(s){var l=s<0?12:11,a=B_(s.toFixed(12));return a.length<=l||(a=s.toPrecision(10)).length<=l?a:s.toExponential(5)}(s):10===l?s.toFixed(10).substr(0,12):function V_(s){var l=B_(s.toFixed(11));return l.length>(s<0?12:11)||"0"===l||"-0"===l?s.toPrecision(6):l}(s),B_(function j_(s){return-1==s.indexOf("E")?s:s.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(a.toUpperCase()))}function Od(s,l){switch(typeof s){case"string":return s;case"boolean":return s?"TRUE":"FALSE";case"number":return(0|s)===s?s.toString(10):jf(s);case"undefined":return"";case"object":if(null==s)return"";if(s instanceof Date)return Ka(14,R_(s,l&&l.date1904),l)}throw new Error("unsupported value in General format: "+s)}function w5(s,l,a,d){var I,h="",y=0,b=0,C=a.y,F=0;switch(s){case 98:C=a.y+543;case 121:switch(l.length){case 1:case 2:I=C%100,F=2;break;default:I=C%1e4,F=4}break;case 109:switch(l.length){case 1:case 2:I=a.m,F=l.length;break;case 3:return N_[a.m-1][1];case 5:return N_[a.m-1][0];default:return N_[a.m-1][2]}break;case 100:switch(l.length){case 1:case 2:I=a.d,F=l.length;break;case 3:return Zm[a.q][0];default:return Zm[a.q][1]}break;case 104:switch(l.length){case 1:case 2:I=1+(a.H+11)%12,F=l.length;break;default:throw"bad hour format: "+l}break;case 72:switch(l.length){case 1:case 2:I=a.H,F=l.length;break;default:throw"bad hour format: "+l}break;case 77:switch(l.length){case 1:case 2:I=a.M,F=l.length;break;default:throw"bad minute format: "+l}break;case 115:if("s"!=l&&"ss"!=l&&".0"!=l&&".00"!=l&&".000"!=l)throw"bad second format: "+l;return 0!==a.u||"s"!=l&&"ss"!=l?(b=d>=2?3===d?1e3:100:1===d?10:1,(y=Math.round(b*(a.S+a.u)))>=60*b&&(y=0),"s"===l?0===y?"0":""+y/b:(h=zl(y,2+d),"ss"===l?h.substr(0,2):"."+h.substr(2,l.length-1))):zl(a.S,l.length);case 90:switch(l){case"[h]":case"[hh]":I=24*a.D+a.H;break;case"[m]":case"[mm]":I=60*(24*a.D+a.H)+a.M;break;case"[s]":case"[ss]":I=60*(60*(24*a.D+a.H)+a.M)+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+l}F=3===l.length?1:2;break;case 101:I=C,F=1}return F>0?zl(I,F):""}function ma(s){if(s.length<=3)return s;for(var a=s.length%3,d=s.substr(0,a);a!=s.length;a+=3)d+=(d.length>0?",":"")+s.substr(a,3);return d}var U_=/%/g;function Hb(s,l){var a,d=s.indexOf("E")-s.indexOf(".")-1;if(s.match(/^#+0.0E\+0$/)){if(0==l)return"0.0E+0";if(l<0)return"-"+Hb(s,-l);var h=s.indexOf(".");-1===h&&(h=s.indexOf("E"));var y=Math.floor(Math.log(l)*Math.LOG10E)%h;if(y<0&&(y+=h),-1===(a=(l/Math.pow(10,y)).toPrecision(d+1+(h+y)%h)).indexOf("e")){var b=Math.floor(Math.log(l)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(b-a.length+y):a+="E+"+(b-y);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,h)+"."+a.substr(2+h)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(C,I,F,O){return I+F+O.substr(0,(h+y)%h)+"."+O.substr(y)+"E"})}else a=l.toExponential(d);return s.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),s.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var zb=/# (\?+)( ?)\/( ?)(\d+)/,$b=/^#*0*\.([0#]+)/,Wb=/\).*[0#]/,qb=/\(###\) ###\\?-####/;function ga(s){for(var a,l="",d=0;d!=s.length;++d)switch(a=s.charCodeAt(d)){case 35:break;case 63:l+=" ";break;case 48:l+="0";break;default:l+=String.fromCharCode(a)}return l}function Gb(s,l){var a=Math.pow(10,l);return""+Math.round(s*a)/a}function Kb(s,l){var a=s-Math.floor(s),d=Math.pow(10,l);return l<(""+Math.round(a*d)).length?0:Math.round(a*d)}function $l(s,l,a){if(40===s.charCodeAt(0)&&!l.match(Wb)){var d=l.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?$l("n",d,a):"("+$l("n",d,-a)+")"}if(44===l.charCodeAt(l.length-1))return function Ub(s,l,a){for(var d=l.length-1;44===l.charCodeAt(d-1);)--d;return mc(s,l.substr(0,d),a/Math.pow(10,3*(l.length-d)))}(s,l,a);if(-1!==l.indexOf("%"))return function C5(s,l,a){var d=l.replace(U_,""),h=l.length-d.length;return mc(s,d,a*Math.pow(10,2*h))+uo("%",h)}(s,l,a);if(-1!==l.indexOf("E"))return Hb(l,a);if(36===l.charCodeAt(0))return"$"+$l(s,l.substr(" "==l.charAt(1)?2:1),a);var h,y,b,C,I=Math.abs(a),F=a<0?"-":"";if(l.match(/^00+$/))return F+Bf(I,l.length);if(l.match(/^[#?]+$/))return"0"===(h=Bf(a,0))&&(h=""),h.length>l.length?h:ga(l.substr(0,l.length-h.length))+h;if(y=l.match(zb))return function H_(s,l,a){var d=parseInt(s[4],10),h=Math.round(l*d),y=Math.floor(h/d),b=h-y*d,C=d;return a+(0===y?"":""+y)+" "+(0===b?uo(" ",s[1].length+1+s[4].length):Wi(b,s[1].length)+s[2]+"/"+s[3]+zl(C,s[4].length))}(y,I,F);if(l.match(/^#+0+$/))return F+Bf(I,l.length-l.indexOf("0"));if(y=l.match($b))return h=Gb(a,y[1].length).replace(/^([^\.]+)$/,"$1."+ga(y[1])).replace(/\.$/,"."+ga(y[1])).replace(/\.(\d*)$/,function(X,V){return"."+V+uo("0",ga(y[1]).length-V.length)}),-1!==l.indexOf("0.")?h:h.replace(/^0\./,".");if(l=l.replace(/^#+([0.])/,"$1"),y=l.match(/^(0*)\.(#*)$/))return F+Gb(I,y[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,y[1].length?"0.":".");if(y=l.match(/^#{1,3},##0(\.?)$/))return F+ma(Bf(I,0));if(y=l.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+$l(s,l,-a):ma(""+(Math.floor(a)+function S5(s,l){return l<(""+Math.round((s-Math.floor(s))*Math.pow(10,l))).length?1:0}(a,y[1].length)))+"."+zl(Kb(a,y[1].length),y[1].length);if(y=l.match(/^#,#*,#0/))return $l(s,l.replace(/^#,#*,/,""),a);if(y=l.match(/^([0#]+)(\\?-([0#]+))+$/))return h=Rf($l(s,l.replace(/[\\-]/g,""),a)),b=0,Rf(Rf(l.replace(/\\/g,"")).replace(/[0#]/g,function(X){return b<h.length?h.charAt(b++):"0"===X?"0":""}));if(l.match(qb))return"("+(h=$l(s,"##########",a)).substr(0,3)+") "+h.substr(3,3)+"-"+h.substr(6);var O="";if(y=l.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(y[4].length,7),C=eg(I,Math.pow(10,b)-1,!1),h=""+F," "==(O=mc("n",y[1],C[1])).charAt(O.length-1)&&(O=O.substr(0,O.length-1)+"0"),h+=O+y[2]+"/"+y[3],(O=vh(C[2],b)).length<y[4].length&&(O=ga(y[4].substr(y[4].length-O.length))+O),h+=O;if(y=l.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(Math.max(y[1].length,y[4].length),7),F+((C=eg(I,Math.pow(10,b)-1,!0))[0]||(C[1]?"":"0"))+" "+(C[1]?Wi(C[1],b)+y[2]+"/"+y[3]+vh(C[2],b):uo(" ",2*b+1+y[2].length+y[3].length));if(y=l.match(/^[#0?]+$/))return h=Bf(a,0),l.length<=h.length?h:ga(l.substr(0,l.length-h.length))+h;if(y=l.match(/^([#0?]+)\.([#0]+)$/)){h=""+a.toFixed(Math.min(y[2].length,10)).replace(/([^0])0+$/,"$1"),b=h.indexOf(".");var H=l.indexOf(".")-b,W=l.length-h.length-H;return ga(l.substr(0,H)+h+l.substr(l.length-W))}if(y=l.match(/^00,000\.([#0]*0)$/))return b=Kb(a,y[1].length),a<0?"-"+$l(s,l,-a):ma(function E5(s){return s<2147483647&&s>-2147483648?""+(s>=0?0|s:s-1|0):""+Math.floor(s)}(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(X){return"00,"+(X.length<3?zl(0,3-X.length):"")+X})+"."+zl(b,y[1].length);switch(l){case"###,##0.00":return $l(s,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var G=ma(Bf(I,0));return"0"!==G?F+G:"";case"###,###.00":return $l(s,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return $l(s,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+l+"|")}function $_(s,l){var a,d=s.indexOf("E")-s.indexOf(".")-1;if(s.match(/^#+0.0E\+0$/)){if(0==l)return"0.0E+0";if(l<0)return"-"+$_(s,-l);var h=s.indexOf(".");-1===h&&(h=s.indexOf("E"));var y=Math.floor(Math.log(l)*Math.LOG10E)%h;if(y<0&&(y+=h),!(a=(l/Math.pow(10,y)).toPrecision(d+1+(h+y)%h)).match(/[Ee]/)){var b=Math.floor(Math.log(l)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(b-a.length+y):a+="E+"+(b-y),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(C,I,F,O){return I+F+O.substr(0,(h+y)%h)+"."+O.substr(y)+"E"})}else a=l.toExponential(d);return s.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),s.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function Wl(s,l,a){if(40===s.charCodeAt(0)&&!l.match(Wb)){var d=l.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Wl("n",d,a):"("+Wl("n",d,-a)+")"}if(44===l.charCodeAt(l.length-1))return function z_(s,l,a){for(var d=l.length-1;44===l.charCodeAt(d-1);)--d;return mc(s,l.substr(0,d),a/Math.pow(10,3*(l.length-d)))}(s,l,a);if(-1!==l.indexOf("%"))return function Yb(s,l,a){var d=l.replace(U_,""),h=l.length-d.length;return mc(s,d,a*Math.pow(10,2*h))+uo("%",h)}(s,l,a);if(-1!==l.indexOf("E"))return $_(l,a);if(36===l.charCodeAt(0))return"$"+Wl(s,l.substr(" "==l.charAt(1)?2:1),a);var h,y,b,C,I=Math.abs(a),F=a<0?"-":"";if(l.match(/^00+$/))return F+zl(I,l.length);if(l.match(/^[#?]+$/))return h=""+a,0===a&&(h=""),h.length>l.length?h:ga(l.substr(0,l.length-h.length))+h;if(y=l.match(zb))return function T5(s,l,a){return a+(0===l?"":""+l)+uo(" ",s[1].length+2+s[4].length)}(y,I,F);if(l.match(/^#+0+$/))return F+zl(I,l.length-l.indexOf("0"));if(y=l.match($b))return h=(h=(""+a).replace(/^([^\.]+)$/,"$1."+ga(y[1])).replace(/\.$/,"."+ga(y[1]))).replace(/\.(\d*)$/,function(X,V){return"."+V+uo("0",ga(y[1]).length-V.length)}),-1!==l.indexOf("0.")?h:h.replace(/^0\./,".");if(l=l.replace(/^#+([0.])/,"$1"),y=l.match(/^(0*)\.(#*)$/))return F+(""+I).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,y[1].length?"0.":".");if(y=l.match(/^#{1,3},##0(\.?)$/))return F+ma(""+I);if(y=l.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Wl(s,l,-a):ma(""+a)+"."+uo("0",y[1].length);if(y=l.match(/^#,#*,#0/))return Wl(s,l.replace(/^#,#*,/,""),a);if(y=l.match(/^([0#]+)(\\?-([0#]+))+$/))return h=Rf(Wl(s,l.replace(/[\\-]/g,""),a)),b=0,Rf(Rf(l.replace(/\\/g,"")).replace(/[0#]/g,function(X){return b<h.length?h.charAt(b++):"0"===X?"0":""}));if(l.match(qb))return"("+(h=Wl(s,"##########",a)).substr(0,3)+") "+h.substr(3,3)+"-"+h.substr(6);var O="";if(y=l.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(y[4].length,7),C=eg(I,Math.pow(10,b)-1,!1),h=""+F," "==(O=mc("n",y[1],C[1])).charAt(O.length-1)&&(O=O.substr(0,O.length-1)+"0"),h+=O+y[2]+"/"+y[3],(O=vh(C[2],b)).length<y[4].length&&(O=ga(y[4].substr(y[4].length-O.length))+O),h+=O;if(y=l.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(Math.max(y[1].length,y[4].length),7),F+((C=eg(I,Math.pow(10,b)-1,!0))[0]||(C[1]?"":"0"))+" "+(C[1]?Wi(C[1],b)+y[2]+"/"+y[3]+vh(C[2],b):uo(" ",2*b+1+y[2].length+y[3].length));if(y=l.match(/^[#0?]+$/))return l.length<=(h=""+a).length?h:ga(l.substr(0,l.length-h.length))+h;if(y=l.match(/^([#0]+)\.([#0]+)$/)){h=""+a.toFixed(Math.min(y[2].length,10)).replace(/([^0])0+$/,"$1"),b=h.indexOf(".");var H=l.indexOf(".")-b,W=l.length-h.length-H;return ga(l.substr(0,H)+h+l.substr(l.length-W))}if(y=l.match(/^00,000\.([#0]*0)$/))return a<0?"-"+Wl(s,l,-a):ma(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(X){return"00,"+(X.length<3?zl(0,3-X.length):"")+X})+"."+zl(0,y[1].length);switch(l){case"###,###":case"##,###":case"#,###":var G=ma(""+I);return"0"!==G?F+G:"";default:if(l.match(/\.[0#?]*$/))return Wl(s,l.slice(0,l.lastIndexOf(".")),a)+ga(l.slice(l.lastIndexOf(".")))}throw new Error("unsupported format |"+l+"|")}function mc(s,l,a){return(0|a)===a?Wl(s,l,a):$l(s,l,a)}var W_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ku(s){for(var l=0,a="",d="";l<s.length;)switch(a=s.charAt(l)){case"G":or(s,l)&&(l+=6),l++;break;case'"':for(;34!==s.charCodeAt(++l)&&l<s.length;);++l;break;case"\\":case"_":l+=2;break;case"@":++l;break;case"B":case"b":if("1"===s.charAt(l+1)||"2"===s.charAt(l+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===s.substr(l,3).toUpperCase()||"AM/PM"===s.substr(l,5).toUpperCase()||"\u4e0a\u5348/\u4e0b\u5348"===s.substr(l,5).toUpperCase())return!0;++l;break;case"[":for(d=a;"]"!==s.charAt(l++)&&l<s.length;)d+=s.charAt(l);if(d.match(W_))return!0;break;case".":case"0":case"#":for(;l<s.length&&("0#?.,E+-%".indexOf(a=s.charAt(++l))>-1||"\\"==a&&"-"==s.charAt(l+1)&&"0#".indexOf(s.charAt(l+2))>-1););break;case"?":for(;s.charAt(++l)===a;);break;case"*":++l,(" "==s.charAt(l)||"*"==s.charAt(l))&&++l;break;case"(":case")":++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;l<s.length&&"0123456789".indexOf(s.charAt(++l))>-1;);break;default:++l}return!1}var q_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function _a(s,l){if(null==l)return!1;var a=parseFloat(l[2]);switch(l[1]){case"=":if(s==a)return!0;break;case">":if(s>a)return!0;break;case"<":if(s<a)return!0;break;case"<>":if(s!=a)return!0;break;case">=":if(s>=a)return!0;break;case"<=":if(s<=a)return!0}return!1}function Ka(s,l,a){null==a&&(a={});var d="";switch(typeof s){case"string":d="m/d/yy"==s&&a.dateNF?a.dateNF:s;break;case"number":null==(d=14==s&&a.dateNF?a.dateNF:(null!=a.table?a.table:Wn)[s])&&(d=a.table&&a.table[jb[s]]||Wn[jb[s]]),null==d&&(d=_5[s]||"General")}if(or(d,0))return Od(l,a);l instanceof Date&&(l=R_(l,a.date1904));var h=function D5(s,l){var a=function k5(s){for(var l=[],a=!1,d=0,h=0;d<s.length;++d)switch(s.charCodeAt(d)){case 34:a=!a;break;case 95:case 42:case 92:++d;break;case 59:l[l.length]=s.substr(h,d-h),h=d+1}if(l[l.length]=s.substr(h),!0===a)throw new Error("Format |"+s+"| unterminated string ");return l}(s),d=a.length,h=a[d-1].indexOf("@");if(d<4&&h>-1&&--d,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if("number"!=typeof l)return[4,4===a.length||h>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=h>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=h>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=h>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"]}var y=l>0?a[0]:l<0?a[1]:a[2];if(-1===a[0].indexOf("[")&&-1===a[1].indexOf("["))return[d,y];if(null!=a[0].match(/\[[=<>]/)||null!=a[1].match(/\[[=<>]/)){var b=a[0].match(q_),C=a[1].match(q_);return _a(l,b)?[d,a[0]]:_a(l,C)?[d,a[1]]:[d,a[null!=b&&null!=C?2:1]]}return[d,y]}(d,l);if(or(h[1]))return Od(l,a);if(!0===l)l="TRUE";else if(!1===l)l="FALSE";else if(""===l||null==l)return"";return function Xb(s,l,a,d){for(var F,O,H,h=[],y="",b=0,C="",I="t",W="H";b<s.length;)switch(C=s.charAt(b)){case"G":if(!or(s,b))throw new Error("unrecognized character "+C+" in "+s);h[h.length]={t:"G",v:"General"},b+=7;break;case'"':for(y="";34!==(H=s.charCodeAt(++b))&&b<s.length;)y+=String.fromCharCode(H);h[h.length]={t:"t",v:y},++b;break;case"\\":var G=s.charAt(++b);h[h.length]={t:"("===G||")"===G?G:"t",v:G},++b;break;case"_":h[h.length]={t:"t",v:" "},b+=2;break;case"@":h[h.length]={t:"T",v:l},++b;break;case"B":case"b":if("1"===s.charAt(b+1)||"2"===s.charAt(b+1)){if(null==F&&null==(F=Gu(l,a,"2"===s.charAt(b+1))))return"";h[h.length]={t:"X",v:s.substr(b,2)},I=C,b+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":C=C.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(l<0||null==F&&null==(F=Gu(l,a)))return"";for(y=C;++b<s.length&&s.charAt(b).toLowerCase()===C;)y+=C;"m"===C&&"h"===I.toLowerCase()&&(C="M"),"h"===C&&(C=W),h[h.length]={t:C,v:y},I=C;break;case"A":case"a":case"\u4e0a":var V={t:C,v:C};if(null==F&&(F=Gu(l,a)),"A/P"===s.substr(b,3).toUpperCase()?(null!=F&&(V.v=F.H>=12?"P":"A"),V.t="T",W="h",b+=3):"AM/PM"===s.substr(b,5).toUpperCase()?(null!=F&&(V.v=F.H>=12?"PM":"AM"),V.t="T",b+=5,W="h"):"\u4e0a\u5348/\u4e0b\u5348"===s.substr(b,5).toUpperCase()?(null!=F&&(V.v=F.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),V.t="T",b+=5,W="h"):(V.t="t",++b),null==F&&"T"===V.t)return"";h[h.length]=V,I=C;break;case"[":for(y=C;"]"!==s.charAt(b++)&&b<s.length;)y+=s.charAt(b);if("]"!==y.slice(-1))throw'unterminated "[" block: |'+y+"|";if(y.match(W_)){if(null==F&&null==(F=Gu(l,a)))return"";h[h.length]={t:"Z",v:y.toLowerCase()},I=y.charAt(1)}else y.indexOf("$")>-1&&(y=(y.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ku(s)||(h[h.length]={t:"t",v:y}));break;case".":if(null!=F){for(y=C;++b<s.length&&"0"===(C=s.charAt(b));)y+=C;h[h.length]={t:"s",v:y};break}case"0":case"#":for(y=C;++b<s.length&&"0#?.,E+-%".indexOf(C=s.charAt(b))>-1;)y+=C;h[h.length]={t:"n",v:y};break;case"?":for(y=C;s.charAt(++b)===C;)y+=C;h[h.length]={t:C,v:y},I=C;break;case"*":++b,(" "==s.charAt(b)||"*"==s.charAt(b))&&++b;break;case"(":case")":h[h.length]={t:1===d?"t":C,v:C},++b;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(y=C;b<s.length&&"0123456789".indexOf(s.charAt(++b))>-1;)y+=s.charAt(b);h[h.length]={t:"D",v:y};break;case" ":h[h.length]={t:C,v:C},++b;break;case"$":h[h.length]={t:"t",v:"$"},++b;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(C))throw new Error("unrecognized character "+C+" in "+s);h[h.length]={t:"t",v:C},++b}var ge,Z=0,he=0;for(b=h.length-1,I="t";b>=0;--b)switch(h[b].t){case"h":case"H":h[b].t=W,I="h",Z<1&&(Z=1);break;case"s":(ge=h[b].v.match(/\.0+$/))&&(he=Math.max(he,ge[0].length-1)),Z<3&&(Z=3);case"d":case"y":case"M":case"e":I=h[b].t;break;case"m":"s"===I&&(h[b].t="M",Z<2&&(Z=2));break;case"X":break;case"Z":Z<1&&h[b].v.match(/[Hh]/)&&(Z=1),Z<2&&h[b].v.match(/[Mm]/)&&(Z=2),Z<3&&h[b].v.match(/[Ss]/)&&(Z=3)}switch(Z){case 0:break;case 1:F.u>=.5&&(F.u=0,++F.S),F.S>=60&&(F.S=0,++F.M),F.M>=60&&(F.M=0,++F.H);break;case 2:F.u>=.5&&(F.u=0,++F.S),F.S>=60&&(F.S=0,++F.M)}var Ke,le="";for(b=0;b<h.length;++b)switch(h[b].t){case"t":case"T":case" ":case"D":break;case"X":h[b].v="",h[b].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":h[b].v=w5(h[b].t.charCodeAt(0),h[b].v,F,he),h[b].t="t";break;case"n":case"?":for(Ke=b+1;null!=h[Ke]&&("?"===(C=h[Ke].t)||"D"===C||(" "===C||"t"===C)&&null!=h[Ke+1]&&("?"===h[Ke+1].t||"t"===h[Ke+1].t&&"/"===h[Ke+1].v)||"("===h[b].t&&(" "===C||"n"===C||")"===C)||"t"===C&&("/"===h[Ke].v||" "===h[Ke].v&&null!=h[Ke+1]&&"?"==h[Ke+1].t));)h[b].v+=h[Ke].v,h[Ke]={v:"",t:";"},++Ke;le+=h[b].v,b=Ke-1;break;case"G":h[b].t="t",h[b].v=Od(l,a)}var ze,be,tt="";if(le.length>0){40==le.charCodeAt(0)?(ze=l<0&&45===le.charCodeAt(0)?-l:l,be=mc("n",le,ze)):(be=mc("n",le,ze=l<0&&d>1?-l:l),ze<0&&h[0]&&"t"==h[0].t&&(be=be.substr(1),h[0].v="-"+h[0].v)),Ke=be.length-1;var Qe=h.length;for(b=0;b<h.length;++b)if(null!=h[b]&&"t"!=h[b].t&&h[b].v.indexOf(".")>-1){Qe=b;break}var qe=h.length;if(Qe===h.length&&-1===be.indexOf("E")){for(b=h.length-1;b>=0;--b)null==h[b]||-1==="n?".indexOf(h[b].t)||(Ke>=h[b].v.length-1?h[b].v=be.substr(1+(Ke-=h[b].v.length),h[b].v.length):Ke<0?h[b].v="":(h[b].v=be.substr(0,Ke+1),Ke=-1),h[b].t="t",qe=b);Ke>=0&&qe<h.length&&(h[qe].v=be.substr(0,Ke+1)+h[qe].v)}else if(Qe!==h.length&&-1===be.indexOf("E")){for(Ke=be.indexOf(".")-1,b=Qe;b>=0;--b)if(null!=h[b]&&-1!=="n?".indexOf(h[b].t)){for(O=h[b].v.indexOf(".")>-1&&b===Qe?h[b].v.indexOf(".")-1:h[b].v.length-1,tt=h[b].v.substr(O+1);O>=0;--O)Ke>=0&&("0"===h[b].v.charAt(O)||"#"===h[b].v.charAt(O))&&(tt=be.charAt(Ke--)+tt);h[b].v=tt,h[b].t="t",qe=b}for(Ke>=0&&qe<h.length&&(h[qe].v=be.substr(0,Ke+1)+h[qe].v),Ke=be.indexOf(".")+1,b=Qe;b<h.length;++b)if(null!=h[b]&&(-1!=="n?(".indexOf(h[b].t)||b===Qe)){for(O=h[b].v.indexOf(".")>-1&&b===Qe?h[b].v.indexOf(".")+1:0,tt=h[b].v.substr(0,O);O<h[b].v.length;++O)Ke<be.length&&(tt+=be.charAt(Ke++));h[b].v=tt,h[b].t="t",qe=b}}}for(b=0;b<h.length;++b)null!=h[b]&&"n?".indexOf(h[b].t)>-1&&(h[b].v=mc(h[b].t,h[b].v,ze=d>1&&l<0&&b>0&&"-"===h[b-1].v?-l:l),h[b].t="t");var gt="";for(b=0;b!==h.length;++b)null!=h[b]&&(gt+=h[b].v);return gt}(h[1],l,a,h[0])}function gc(s,l){if("number"!=typeof l){l=+l||-1;for(var a=0;a<392;++a)if(null!=Wn[a]){if(Wn[a]==s){l=a;break}}else l<0&&(l=a);l<0&&(l=391)}return Wn[l]=s,l}function yh(s){for(var l=0;392!=l;++l)void 0!==s[l]&&gc(s[l],l)}function Nd(){Wn=function L_(s){return s||(s={}),s[0]="General",s[1]="0",s[2]="0.00",s[3]="#,##0",s[4]="#,##0.00",s[9]="0%",s[10]="0.00%",s[11]="0.00E+00",s[12]="# ?/?",s[13]="# ??/??",s[14]="m/d/yy",s[15]="d-mmm-yy",s[16]="d-mmm",s[17]="mmm-yy",s[18]="h:mm AM/PM",s[19]="h:mm:ss AM/PM",s[20]="h:mm",s[21]="h:mm:ss",s[22]="m/d/yy h:mm",s[37]="#,##0 ;(#,##0)",s[38]="#,##0 ;[Red](#,##0)",s[39]="#,##0.00;(#,##0.00)",s[40]="#,##0.00;[Red](#,##0.00)",s[45]="mm:ss",s[46]="[h]:mm:ss",s[47]="mmss.0",s[48]="##0.0E+0",s[49]="@",s[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',s}()}var Qb={format:Ka,load:gc,_table:Wn,load_table:yh,parse_date_code:Gu,is_date:Ku,get_table:function(){return Qb._table=Wn}},I5={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},_c=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,bh=function(){var s={version:"1.2.0"},a=function l(){for(var be=0,Qe=new Array(256),qe=0;256!=qe;++qe)Qe[qe]=be=1&(be=1&(be=1&(be=1&(be=1&(be=1&(be=1&(be=1&(be=qe)?-306674912^be>>>1:be>>>1)?-306674912^be>>>1:be>>>1)?-306674912^be>>>1:be>>>1)?-306674912^be>>>1:be>>>1)?-306674912^be>>>1:be>>>1)?-306674912^be>>>1:be>>>1)?-306674912^be>>>1:be>>>1)?-306674912^be>>>1:be>>>1;return"undefined"!=typeof Int32Array?new Int32Array(Qe):Qe}(),h=function d(be){var Qe=0,qe=0,gt=0,bt="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(gt=0;256!=gt;++gt)bt[gt]=be[gt];for(gt=0;256!=gt;++gt)for(qe=be[gt],Qe=256+gt;Qe<4096;Qe+=256)qe=bt[Qe]=qe>>>8^be[255&qe];var et=[];for(gt=1;16!=gt;++gt)et[gt-1]="undefined"!=typeof Int32Array?bt.subarray(256*gt,256*gt+256):bt.slice(256*gt,256*gt+256);return et}(a),y=h[0],b=h[1],C=h[2],I=h[3],F=h[4],O=h[5],H=h[6],W=h[7],G=h[8],X=h[9],V=h[10],Z=h[11],he=h[12],ge=h[13],le=h[14];return s.table=a,s.bstr=function Ke(be,Qe){for(var qe=-1^Qe,gt=0,bt=be.length;gt<bt;)qe=qe>>>8^a[255&(qe^be.charCodeAt(gt++))];return~qe},s.buf=function tt(be,Qe){for(var qe=-1^Qe,gt=be.length-15,bt=0;bt<gt;)qe=le[be[bt++]^255&qe]^ge[be[bt++]^qe>>8&255]^he[be[bt++]^qe>>16&255]^Z[be[bt++]^qe>>>24]^V[be[bt++]]^X[be[bt++]]^G[be[bt++]]^W[be[bt++]]^H[be[bt++]]^O[be[bt++]]^F[be[bt++]]^I[be[bt++]]^C[be[bt++]]^b[be[bt++]]^y[be[bt++]]^a[be[bt++]];for(gt+=15;bt<gt;)qe=qe>>>8^a[255&(qe^be[bt++])];return~qe},s.str=function ze(be,Qe){for(var qe=-1^Qe,gt=0,bt=be.length,et=0,Xt=0;gt<bt;)(et=be.charCodeAt(gt++))<128?qe=qe>>>8^a[255&(qe^et)]:et<2048?qe=(qe=qe>>>8^a[255&(qe^(192|et>>6&31))])>>>8^a[255&(qe^(128|63&et))]:et>=55296&&et<57344?(et=64+(1023&et),Xt=1023&be.charCodeAt(gt++),qe=(qe=(qe=(qe=qe>>>8^a[255&(qe^(240|et>>8&7))])>>>8^a[255&(qe^(128|et>>2&63))])>>>8^a[255&(qe^(128|Xt>>6&15|(3&et)<<4))])>>>8^a[255&(qe^(128|63&Xt))]):qe=(qe=(qe=qe>>>8^a[255&(qe^(224|et>>12&15))])>>>8^a[255&(qe^(128|et>>6&63))])>>>8^a[255&(qe^(128|63&et))];return~qe},s}(),In=function(){var I,l={};function d(oe){if("/"==oe.charAt(oe.length-1))return-1===oe.slice(0,-1).indexOf("/")?oe:d(oe.slice(0,-1));var ye=oe.lastIndexOf("/");return-1===ye?oe:oe.slice(0,ye+1)}function h(oe){if("/"==oe.charAt(oe.length-1))return h(oe.slice(0,-1));var ye=oe.lastIndexOf("/");return-1===ye?oe:oe.slice(ye+1)}function y(oe,ye){"string"==typeof ye&&(ye=new Date(ye));var ue=ye.getHours();ue=(ue=ue<<6|ye.getMinutes())<<5|ye.getSeconds()>>>1,oe.write_shift(2,ue);var pe=ye.getFullYear()-1980;pe=(pe=pe<<4|ye.getMonth()+1)<<5|ye.getDate(),oe.write_shift(2,pe)}function C(oe){yo(oe,0);for(var ye={},ue=0;oe.l<=oe.length-4;){var pe=oe.read_shift(2),_e=oe.read_shift(2),xe=oe.l+_e,at={};21589===pe&&(1&(ue=oe.read_shift(1))&&(at.mtime=oe.read_shift(4)),_e>5&&(2&ue&&(at.atime=oe.read_shift(4)),4&ue&&(at.ctime=oe.read_shift(4))),at.mtime&&(at.mt=new Date(1e3*at.mtime))),oe.l=xe,ye[pe]=at}return ye}function F(){return I||(I={})}function O(oe,ye){if(80==oe[0]&&75==oe[1])return cy(oe,ye);if(109==(32|oe[0])&&105==(32|oe[1]))return function vD(oe,ye){if("mime-version:"!=ln(oe.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var ue=ye&&ye.root||"",pe=(Oi&&Buffer.isBuffer(oe)?oe.toString("binary"):ln(oe)).split("\r\n"),_e=0,xe="";for(_e=0;_e<pe.length;++_e)if(/^Content-Location:/i.test(xe=pe[_e])&&(xe=xe.slice(xe.indexOf("file")),ue||(ue=xe.slice(0,xe.lastIndexOf("/")+1)),xe.slice(0,ue.length)!=ue))for(;ue.length>0&&(ue=(ue=ue.slice(0,ue.length-1)).slice(0,ue.lastIndexOf("/")+1),xe.slice(0,ue.length)!=ue););var at=(pe[1]||"").match(/boundary="(.*?)"/);if(!at)throw new Error("MAD cannot find boundary");var kt="--"+(at[1]||""),ht={FileIndex:[],FullPaths:[]};be(ht);var Wt,rn=0;for(_e=0;_e<pe.length;++_e){var An=pe[_e];An!==kt&&An!==kt+"--"||(rn++&&mr(ht,pe.slice(Wt,_e),ue),Wt=_e)}return ht}(oe,ye);if(oe.length<512)throw new Error("CFB file size "+oe.length+" < 512");var ue,_e,xe,at,kt,ft,pe=512,ut=[],ht=oe.slice(0,512);yo(ht,0);var Wt=function H(oe){if(80==oe[oe.l]&&75==oe[oe.l+1])return[0,0];oe.chk(vn,"Header Signature: "),oe.l+=16;var ye=oe.read_shift(2,"u");return[oe.read_shift(2,"u"),ye]}(ht);switch(ue=Wt[0]){case 3:pe=512;break;case 4:pe=4096;break;case 0:if(0==Wt[1])return cy(oe,ye);default:throw new Error("Major Version: Expected 3 or 4 saw "+ue)}512!==pe&&yo(ht=oe.slice(0,pe),28);var rn=oe.slice(0,pe);!function W(oe,ye){var ue;switch(oe.l+=2,ue=oe.read_shift(2)){case 9:if(3!=ye)throw new Error("Sector Shift: Expected 9 saw "+ue);break;case 12:if(4!=ye)throw new Error("Sector Shift: Expected 12 saw "+ue);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ue)}oe.chk("0600","Mini Sector Shift: "),oe.chk("000000000000","Reserved: ")}(ht,ue);var An=ht.read_shift(4,"i");if(3===ue&&0!==An)throw new Error("# Directory Sectors: Expected 0 saw "+An);ht.l+=4,at=ht.read_shift(4,"i"),ht.l+=4,ht.chk("00100000","Mini Stream Cutoff Size: "),kt=ht.read_shift(4,"i"),_e=ht.read_shift(4,"i"),ft=ht.read_shift(4,"i"),xe=ht.read_shift(4,"i");for(var nn=-1,en=0;en<109&&!((nn=ht.read_shift(4,"i"))<0);++en)ut[en]=nn;var ci=function G(oe,ye){for(var ue=Math.ceil(oe.length/ye)-1,pe=[],_e=1;_e<ue;++_e)pe[_e-1]=oe.slice(_e*ye,(_e+1)*ye);return pe[ue-1]=oe.slice(ue*ye),pe}(oe,pe);Z(ft,xe,ci,pe,ut);var Sr=function ge(oe,ye,ue,pe){var _e=oe.length,xe=[],at=[],kt=[],ft=[],ut=pe-1,ht=0,Wt=0,rn=0,An=0;for(ht=0;ht<_e;++ht)if(kt=[],(rn=ht+ye)>=_e&&(rn-=_e),!at[rn]){ft=[];var nn=[];for(Wt=rn;Wt>=0;){nn[Wt]=!0,at[Wt]=!0,kt[kt.length]=Wt,ft.push(oe[Wt]);var en=ue[Math.floor(4*Wt/pe)];if(pe<4+(An=4*Wt&ut))throw new Error("FAT boundary crossed: "+Wt+" 4 "+pe);if(!oe[en]||nn[Wt=Ud(oe[en],An)])break}xe[rn]={nodes:kt,data:lg([ft])}}return xe}(ci,at,ut,pe);Sr[at].name="!Directory",_e>0&&kt!==Xt&&(Sr[kt].name="!MiniFAT"),Sr[ut[0]].name="!FAT",Sr.fat_addrs=ut,Sr.ssz=pe;var No=[],rl=[],b0=[];(function le(oe,ye,ue,pe,_e,xe,at,kt){for(var An,ft=0,ut=pe.length?2:0,ht=ye[oe].data,Wt=0,rn=0;Wt<ht.length;Wt+=128){var nn=ht.slice(Wt,Wt+128);yo(nn,64),rn=nn.read_shift(2),An=gl(nn,0,rn-ut),pe.push(An);var en={name:An,type:nn.read_shift(1),color:nn.read_shift(1),L:nn.read_shift(4,"i"),R:nn.read_shift(4,"i"),C:nn.read_shift(4,"i"),clsid:nn.read_shift(16),state:nn.read_shift(4,"i"),start:0,size:0};0!==nn.read_shift(2)+nn.read_shift(2)+nn.read_shift(2)+nn.read_shift(2)&&(en.ct=Ke(nn,nn.l-8)),0!==nn.read_shift(2)+nn.read_shift(2)+nn.read_shift(2)+nn.read_shift(2)&&(en.mt=Ke(nn,nn.l-8)),en.start=nn.read_shift(4,"i"),en.size=nn.read_shift(4,"i"),en.size<0&&en.start<0&&(en.size=en.type=0,en.start=Xt,en.name=""),5===en.type?(ft=en.start,_e>0&&ft!==Xt&&(ye[ft].name="!StreamData")):en.size>=4096?(en.storage="fat",void 0===ye[en.start]&&(ye[en.start]=he(ue,en.start,ye.fat_addrs,ye.ssz)),ye[en.start].name=en.name,en.content=ye[en.start].data.slice(0,en.size)):(en.storage="minifat",en.size<0?en.size=0:ft!==Xt&&en.start!==Xt&&ye[ft]&&(en.content=V(en,ye[ft].data,(ye[kt]||{}).data))),en.content&&yo(en.content,0),xe[An]=en,at.push(en)}})(at,Sr,ci,No,_e,{},rl,kt),function X(oe,ye,ue){for(var pe=0,_e=0,xe=0,at=0,kt=0,ft=ue.length,ut=[],ht=[];pe<ft;++pe)ut[pe]=ht[pe]=pe,ye[pe]=ue[pe];for(;kt<ht.length;++kt)_e=oe[pe=ht[kt]].L,xe=oe[pe].R,at=oe[pe].C,ut[pe]===pe&&(-1!==_e&&ut[_e]!==_e&&(ut[pe]=ut[_e]),-1!==xe&&ut[xe]!==xe&&(ut[pe]=ut[xe])),-1!==at&&(ut[at]=pe),-1!==_e&&pe!=ut[pe]&&(ut[_e]=ut[pe],ht.lastIndexOf(_e)<kt&&ht.push(_e)),-1!==xe&&pe!=ut[pe]&&(ut[xe]=ut[pe],ht.lastIndexOf(xe)<kt&&ht.push(xe));for(pe=1;pe<ft;++pe)ut[pe]===pe&&(-1!==xe&&ut[xe]!==xe?ut[pe]=ut[xe]:-1!==_e&&ut[_e]!==_e&&(ut[pe]=ut[_e]));for(pe=1;pe<ft;++pe)if(0!==oe[pe].type){if((kt=pe)!=ut[kt])do{ye[pe]=ye[kt=ut[kt]]+"/"+ye[pe]}while(0!==kt&&-1!==ut[kt]&&kt!=ut[kt]);ut[pe]=-1}for(ye[0]+="/",pe=1;pe<ft;++pe)2!==oe[pe].type&&(ye[pe]+="/")}(rl,b0,No),No.shift();var Sp={FileIndex:rl,FullPaths:b0};return ye&&ye.raw&&(Sp.raw={header:rn,sectors:ci}),Sp}function V(oe,ye,ue){for(var _e=oe.size,xe=[],at=oe.start;ue&&_e>0&&at>=0;)xe.push(ye.slice(at*et,at*et+et)),_e-=et,at=Ud(ue,4*at);return 0===xe.length?Tt(0):es(xe).slice(0,oe.size)}function Z(oe,ye,ue,pe,_e){var xe=Xt;if(oe===Xt){if(0!==ye)throw new Error("DIFAT chain shorter than expected")}else if(-1!==oe){var at=ue[oe],kt=(pe>>>2)-1;if(!at)return;for(var ft=0;ft<kt&&(xe=Ud(at,4*ft))!==Xt;++ft)_e.push(xe);Z(Ud(at,pe-4),ye-1,ue,pe,_e)}}function he(oe,ye,ue,pe,_e){var xe=[],at=[];_e||(_e=[]);var kt=pe-1,ft=0,ut=0;for(ft=ye;ft>=0;){_e[ft]=!0,xe[xe.length]=ft,at.push(oe[ft]);var ht=ue[Math.floor(4*ft/pe)];if(pe<4+(ut=4*ft&kt))throw new Error("FAT boundary crossed: "+ft+" 4 "+pe);if(!oe[ht])break;ft=Ud(oe[ht],ut)}return{nodes:xe,data:lg([at])}}function Ke(oe,ye){return new Date(1e3*(sr(oe,ye+4)/1e7*Math.pow(2,32)+sr(oe,ye)/1e7-11644473600))}function be(oe,ye){var ue=ye||{},pe=ue.root||"Root Entry";if(oe.FullPaths||(oe.FullPaths=[]),oe.FileIndex||(oe.FileIndex=[]),oe.FullPaths.length!==oe.FileIndex.length)throw new Error("inconsistent CFB structure");0===oe.FullPaths.length&&(oe.FullPaths[0]=pe+"/",oe.FileIndex[0]={name:pe,type:5}),ue.CLSID&&(oe.FileIndex[0].clsid=ue.CLSID),function Qe(oe){var ye="\x01Sh33tJ5";if(!In.find(oe,"/"+ye)){var ue=Tt(4);ue[0]=55,ue[1]=ue[3]=50,ue[2]=54,oe.FileIndex.push({name:ye,type:2,content:ue,size:4,L:69,R:69,C:69}),oe.FullPaths.push(oe.FullPaths[0]+ye),qe(oe)}}(oe)}function qe(oe,ye){be(oe);for(var ue=!1,pe=!1,_e=oe.FullPaths.length-1;_e>=0;--_e){var xe=oe.FileIndex[_e];switch(xe.type){case 0:pe?ue=!0:(oe.FileIndex.pop(),oe.FullPaths.pop());break;case 1:case 2:case 5:pe=!0,isNaN(xe.R*xe.L*xe.C)&&(ue=!0),xe.R>-1&&xe.L>-1&&xe.R==xe.L&&(ue=!0);break;default:ue=!0}}if(ue||ye){var at=new Date(1987,1,19),kt=0,ft=Object.create?Object.create(null):{},ut=[];for(_e=0;_e<oe.FullPaths.length;++_e)ft[oe.FullPaths[_e]]=!0,0!==oe.FileIndex[_e].type&&ut.push([oe.FullPaths[_e],oe.FileIndex[_e]]);for(_e=0;_e<ut.length;++_e){var ht=d(ut[_e][0]);(pe=ft[ht])||(ut.push([ht,{name:h(ht).replace("/",""),type:1,clsid:Fn,ct:at,mt:at,content:null}]),ft[ht]=!0)}for(ut.sort(function(An,nn){return function a(oe,ye){for(var ue=oe.split("/"),pe=ye.split("/"),_e=0,xe=0,at=Math.min(ue.length,pe.length);_e<at;++_e){if(xe=ue[_e].length-pe[_e].length)return xe;if(ue[_e]!=pe[_e])return ue[_e]<pe[_e]?-1:1}return ue.length-pe.length}(An[0],nn[0])}),oe.FullPaths=[],oe.FileIndex=[],_e=0;_e<ut.length;++_e)oe.FullPaths[_e]=ut[_e][0],oe.FileIndex[_e]=ut[_e][1];for(_e=0;_e<ut.length;++_e){var Wt=oe.FileIndex[_e],rn=oe.FullPaths[_e];if(Wt.name=h(rn).replace("/",""),Wt.L=Wt.R=Wt.C=-(Wt.color=1),Wt.size=Wt.content?Wt.content.length:0,Wt.start=0,Wt.clsid=Wt.clsid||Fn,0===_e)Wt.C=ut.length>1?1:-1,Wt.size=0,Wt.type=5;else if("/"==rn.slice(-1)){for(kt=_e+1;kt<ut.length&&d(oe.FullPaths[kt])!=rn;++kt);for(Wt.C=kt>=ut.length?-1:kt,kt=_e+1;kt<ut.length&&d(oe.FullPaths[kt])!=d(rn);++kt);Wt.R=kt>=ut.length?-1:kt,Wt.type=1}else d(oe.FullPaths[_e+1]||"")==d(rn)&&(Wt.R=_e+1),Wt.type=2}}}function gt(oe,ye){var ue=ye||{};if("mad"==ue.fileType)return function l6(oe,ye){for(var ue=ye||{},pe=ue.boundary||"SheetJS",_e=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(pe="------="+pe).slice(2)+'"',"","",""],xe=oe.FullPaths[0],at=xe,kt=oe.FileIndex[0],ft=1;ft<oe.FullPaths.length;++ft)if(at=oe.FullPaths[ft].slice(xe.length),(kt=oe.FileIndex[ft]).size&&kt.content&&"\x01Sh33tJ5"!=at){at=at.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ci){return"_x"+ci.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ci){return"_u"+ci.charCodeAt(0).toString(16)+"_"});for(var ut=kt.content,ht=Oi&&Buffer.isBuffer(ut)?ut.toString("binary"):ln(ut),Wt=0,rn=Math.min(1024,ht.length),An=0,nn=0;nn<=rn;++nn)(An=ht.charCodeAt(nn))>=32&&An<128&&++Wt;var en=Wt>=4*rn/5;_e.push(pe),_e.push("Content-Location: "+(ue.root||"file:///C:/SheetJS/")+at),_e.push("Content-Transfer-Encoding: "+(en?"quoted-printable":"base64")),_e.push("Content-Type: "+gD(kt,at)),_e.push(""),_e.push(en?_D(ht):df(ht))}return _e.push(pe+"--\r\n"),_e.join("\r\n")}(oe,ue);if("zip"===(qe(oe),ue.fileType))return function p3(oe,ye){var ue=ye||{},pe=[],_e=[],xe=Tt(1),at=ue.compression?8:0,ut=0,ht=0,Wt=0,rn=0,An=oe.FullPaths[0],nn=An,en=oe.FileIndex[0],ci=[],Sr=0;for(ut=1;ut<oe.FullPaths.length;++ut)if(nn=oe.FullPaths[ut].slice(An.length),(en=oe.FileIndex[ut]).size&&en.content&&"\x01Sh33tJ5"!=nn){var il=Wt,No=Tt(nn.length);for(ht=0;ht<nn.length;++ht)No.write_shift(1,127&nn.charCodeAt(ht));No=No.slice(0,No.l),ci[rn]=bh.buf(en.content,0);var rl=en.content;8==at&&(rl=Fe(rl)),(xe=Tt(30)).write_shift(4,67324752),xe.write_shift(2,20),xe.write_shift(2,0),xe.write_shift(2,at),en.mt?y(xe,en.mt):xe.write_shift(4,0),xe.write_shift(-4,ci[rn]),xe.write_shift(4,rl.length),xe.write_shift(4,en.content.length),xe.write_shift(2,No.length),xe.write_shift(2,0),Wt+=xe.length,pe.push(xe),Wt+=No.length,pe.push(No),Wt+=rl.length,pe.push(rl),(xe=Tt(46)).write_shift(4,33639248),xe.write_shift(2,0),xe.write_shift(2,20),xe.write_shift(2,0),xe.write_shift(2,at),xe.write_shift(4,0),xe.write_shift(-4,ci[rn]),xe.write_shift(4,rl.length),xe.write_shift(4,en.content.length),xe.write_shift(2,No.length),xe.write_shift(2,0),xe.write_shift(2,0),xe.write_shift(2,0),xe.write_shift(2,0),xe.write_shift(4,0),xe.write_shift(4,il),Sr+=xe.l,_e.push(xe),Sr+=No.length,_e.push(No),++rn}return(xe=Tt(22)).write_shift(4,101010256),xe.write_shift(2,0),xe.write_shift(2,0),xe.write_shift(2,rn),xe.write_shift(2,rn),xe.write_shift(4,Sr),xe.write_shift(4,Wt),xe.write_shift(2,0),es([es(pe),es(_e),xe])}(oe,ue);var pe=function(An){for(var nn=0,en=0,ci=0;ci<An.FileIndex.length;++ci){var Sr=An.FileIndex[ci];if(Sr.content){var il=Sr.content.length;il>0&&(il<4096?nn+=il+63>>6:en+=il+511>>9)}}for(var No=An.FullPaths.length+3>>2,b0=nn+127>>7,Sp=(nn+7>>3)+en+No+b0,Ep=Sp+127>>7,x0=Ep<=109?0:Math.ceil((Ep-109)/127);Sp+Ep+x0+127>>7>Ep;)x0=++Ep<=109?0:Math.ceil((Ep-109)/127);var tc=[1,x0,Ep,b0,No,en,nn,0];return An.FileIndex[0].size=nn<<6,tc[7]=(An.FileIndex[0].start=tc[0]+tc[1]+tc[2]+tc[3]+tc[4]+tc[5])+(tc[6]+7>>3),tc}(oe),_e=Tt(pe[7]<<9),xe=0,at=0;for(xe=0;xe<8;++xe)_e.write_shift(1,Zt[xe]);for(xe=0;xe<8;++xe)_e.write_shift(2,0);for(_e.write_shift(2,62),_e.write_shift(2,3),_e.write_shift(2,65534),_e.write_shift(2,9),_e.write_shift(2,6),xe=0;xe<3;++xe)_e.write_shift(2,0);for(_e.write_shift(4,0),_e.write_shift(4,pe[2]),_e.write_shift(4,pe[0]+pe[1]+pe[2]+pe[3]-1),_e.write_shift(4,0),_e.write_shift(4,4096),_e.write_shift(4,pe[3]?pe[0]+pe[1]+pe[2]-1:Xt),_e.write_shift(4,pe[3]),_e.write_shift(-4,pe[1]?pe[0]-1:Xt),_e.write_shift(4,pe[1]),xe=0;xe<109;++xe)_e.write_shift(-4,xe<pe[2]?pe[1]+xe:-1);if(pe[1])for(at=0;at<pe[1];++at){for(;xe<236+127*at;++xe)_e.write_shift(-4,xe<pe[2]?pe[1]+xe:-1);_e.write_shift(-4,at===pe[1]-1?Xt:at+1)}var kt=function(An){for(at+=An;xe<at-1;++xe)_e.write_shift(-4,xe+1);An&&(++xe,_e.write_shift(-4,Xt))};for(at=xe=0,at+=pe[1];xe<at;++xe)_e.write_shift(-4,Dn.DIFSECT);for(at+=pe[2];xe<at;++xe)_e.write_shift(-4,Dn.FATSECT);kt(pe[3]),kt(pe[4]);for(var ft=0,ut=0,ht=oe.FileIndex[0];ft<oe.FileIndex.length;++ft)(ht=oe.FileIndex[ft]).content&&!((ut=ht.content.length)<4096)&&(ht.start=at,kt(ut+511>>9));for(kt(pe[6]+7>>3);511&_e.l;)_e.write_shift(-4,Dn.ENDOFCHAIN);for(at=xe=0,ft=0;ft<oe.FileIndex.length;++ft)(ht=oe.FileIndex[ft]).content&&(ut=ht.content.length)&&!(ut>=4096)&&(ht.start=at,kt(ut+63>>6));for(;511&_e.l;)_e.write_shift(-4,Dn.ENDOFCHAIN);for(xe=0;xe<pe[4]<<2;++xe){var Wt=oe.FullPaths[xe];if(Wt&&0!==Wt.length){ht=oe.FileIndex[xe],0===xe&&(ht.start=ht.size?ht.start-1:Xt);var rn=0===xe&&ue.root||ht.name;if(ut=2*(rn.length+1),_e.write_shift(64,rn,"utf16le"),_e.write_shift(2,ut),_e.write_shift(1,ht.type),_e.write_shift(1,ht.color),_e.write_shift(-4,ht.L),_e.write_shift(-4,ht.R),_e.write_shift(-4,ht.C),ht.clsid)_e.write_shift(16,ht.clsid,"hex");else for(ft=0;ft<4;++ft)_e.write_shift(4,0);_e.write_shift(4,ht.state||0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,ht.start),_e.write_shift(4,ht.size),_e.write_shift(4,0)}else{for(ft=0;ft<17;++ft)_e.write_shift(4,0);for(ft=0;ft<3;++ft)_e.write_shift(4,-1);for(ft=0;ft<12;++ft)_e.write_shift(4,0)}}for(xe=1;xe<oe.FileIndex.length;++xe)if((ht=oe.FileIndex[xe]).size>=4096)if(_e.l=ht.start+1<<9,Oi&&Buffer.isBuffer(ht.content))ht.content.copy(_e,_e.l,0,ht.size),_e.l+=ht.size+511&-512;else{for(ft=0;ft<ht.size;++ft)_e.write_shift(1,ht.content[ft]);for(;511&ft;++ft)_e.write_shift(1,0)}for(xe=1;xe<oe.FileIndex.length;++xe)if((ht=oe.FileIndex[xe]).size>0&&ht.size<4096)if(Oi&&Buffer.isBuffer(ht.content))ht.content.copy(_e,_e.l,0,ht.size),_e.l+=ht.size+63&-64;else{for(ft=0;ft<ht.size;++ft)_e.write_shift(1,ht.content[ft]);for(;63&ft;++ft)_e.write_shift(1,0)}if(Oi)_e.l=_e.length;else for(;_e.l<_e.length;)_e.write_shift(1,0);return _e}l.version="1.2.1";var Pt,et=64,Xt=-2,vn="d0cf11e0a1b11ae1",Zt=[208,207,17,224,161,177,26,225],Fn="00000000000000000000000000000000",Dn={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Xt,FREESECT:-1,HEADER_SIGNATURE:vn,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Fn,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ln(oe){for(var ye=new Array(oe.length),ue=0;ue<oe.length;++ue)ye[ue]=String.fromCharCode(oe[ue]);return ye.join("")}function Fe(oe){return Pt?Pt.deflateRawSync(oe):Mi(oe)}for(var oe,ye,Pe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],It=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],sn=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Qt="undefined"!=typeof Uint8Array,Rt=Qt?new Uint8Array(256):[],gi=0;gi<256;++gi)Rt[gi]=(void 0,255&((ye=139536&((oe=gi)<<1|oe<<11)|558144&(oe<<5|oe<<15))>>16|ye>>8|ye));function Se(oe,ye){var ue=Rt[255&oe];return ye<=8?ue>>>8-ye:(ue=ue<<8|Rt[oe>>8&255],ye<=16?ue>>>16-ye:(ue=ue<<8|Rt[oe>>16&255])>>>24-ye)}function Tr(oe,ye){var ue=7&ye,pe=ye>>>3;return(oe[pe]|(ue<=6?0:oe[pe+1]<<8))>>>ue&3}function Hi(oe,ye){var ue=7&ye,pe=ye>>>3;return(oe[pe]|(ue<=5?0:oe[pe+1]<<8))>>>ue&7}function zi(oe,ye){var ue=7&ye,pe=ye>>>3;return(oe[pe]|(ue<=3?0:oe[pe+1]<<8))>>>ue&31}function fn(oe,ye){var ue=7&ye,pe=ye>>>3;return(oe[pe]|(ue<=1?0:oe[pe+1]<<8))>>>ue&127}function Po(oe,ye,ue){var pe=7&ye,_e=ye>>>3,at=oe[_e]>>>pe;return ue<8-pe||(at|=oe[_e+1]<<8-pe,ue<16-pe)||(at|=oe[_e+2]<<16-pe,ue<24-pe)||(at|=oe[_e+3]<<24-pe),at&(1<<ue)-1}function Il(oe,ye,ue){var pe=7&ye,_e=ye>>>3;return pe<=5?oe[_e]|=(7&ue)<<pe:(oe[_e]|=ue<<pe&255,oe[_e+1]=(7&ue)>>8-pe),ye+3}function Nc(oe,ye,ue){return oe[ye>>>3]|=ue=(1&ue)<<(7&ye),ye+1}function _u(oe,ye,ue){var _e=ye>>>3;return oe[_e]|=255&(ue<<=7&ye),oe[_e+1]=ue>>>=8,ye+8}function Cp(oe,ye,ue){var _e=ye>>>3;return oe[_e]|=255&(ue<<=7&ye),oe[_e+1]=255&(ue>>>=8),oe[_e+2]=ue>>>8,ye+16}function vu(oe,ye){var ue=oe.length,pe=2*ue>ye?2*ue:ye+5,_e=0;if(ue>=ye)return oe;if(Oi){var xe=Lb(pe);if(oe.copy)oe.copy(xe);else for(;_e<oe.length;++_e)xe[_e]=oe[_e];return xe}if(Qt){var at=new Uint8Array(pe);if(at.set)at.set(oe);else for(;_e<ue;++_e)at[_e]=oe[_e];return at}return oe.length=pe,oe}function tl(oe){for(var ye=new Array(oe),ue=0;ue<oe;++ue)ye[ue]=0;return ye}function yu(oe,ye,ue){var pe=1,_e=0,xe=0,at=0,kt=0,ft=oe.length,ut=Qt?new Uint16Array(32):tl(32);for(xe=0;xe<32;++xe)ut[xe]=0;for(xe=ft;xe<ue;++xe)oe[xe]=0;ft=oe.length;var ht=Qt?new Uint16Array(ft):tl(ft);for(xe=0;xe<ft;++xe)ut[_e=oe[xe]]++,pe<_e&&(pe=_e),ht[xe]=0;for(ut[0]=0,xe=1;xe<=pe;++xe)ut[xe+16]=kt=kt+ut[xe-1]<<1;for(xe=0;xe<ft;++xe)0!=(kt=oe[xe])&&(ht[xe]=ut[kt+16]++);var Wt=0;for(xe=0;xe<ft;++xe)if(0!=(Wt=oe[xe]))for(kt=Se(ht[xe],pe)>>pe-Wt,at=(1<<pe+4-Wt)-1;at>=0;--at)ye[kt|at<<Wt]=15&Wt|xe<<4;return pe}var bu=Qt?new Uint16Array(512):tl(512),gm=Qt?new Uint16Array(32):tl(32);if(!Qt){for(var Ta=0;Ta<512;++Ta)bu[Ta]=0;for(Ta=0;Ta<32;++Ta)gm[Ta]=0}!function(){for(var oe=[],ye=0;ye<32;ye++)oe.push(5);yu(oe,gm,32);var ue=[];for(ye=0;ye<=143;ye++)ue.push(8);for(;ye<=255;ye++)ue.push(9);for(;ye<=279;ye++)ue.push(7);for(;ye<=287;ye++)ue.push(8);yu(ue,bu,288)}();var Lc=function(){for(var ye=Qt?new Uint8Array(32768):[],ue=0,pe=0;ue<sn.length-1;++ue)for(;pe<sn[ue+1];++pe)ye[pe]=ue;for(;pe<32768;++pe)ye[pe]=29;var _e=Qt?new Uint8Array(259):[];for(ue=0,pe=0;ue<It.length-1;++ue)for(;pe<It[ue+1];++pe)_e[pe]=ue;return function(ft,ut){return ft.length<8?function xe(kt,ft){for(var ut=0;ut<kt.length;){var ht=Math.min(65535,kt.length-ut);for(ft.write_shift(1,+(ut+ht==kt.length)),ft.write_shift(2,ht),ft.write_shift(2,65535&~ht);ht-- >0;)ft[ft.l++]=kt[ut++]}return ft.l}(ft,ut):function at(kt,ft){for(var ut=0,ht=0,Wt=Qt?new Uint16Array(32768):[];ht<kt.length;){var rn=Math.min(65535,kt.length-ht);if(rn<10){for(7&(ut=Il(ft,ut,+(ht+rn==kt.length)))&&(ut+=8-(7&ut)),ft.l=ut/8|0,ft.write_shift(2,rn),ft.write_shift(2,65535&~rn);rn-- >0;)ft[ft.l++]=kt[ht++];ut=8*ft.l}else{ut=Il(ft,ut,+(ht+rn==kt.length)+2);for(var An=0;rn-- >0;){var nn=kt[ht],en=-1,ci=0;if((en=Wt[An=32767&(An<<5^nn)])&&((en|=-32768&ht)>ht&&(en-=32768),en<ht))for(;kt[en+ci]==kt[ht+ci]&&ci<250;)++ci;if(ci>2){(nn=_e[ci])<=22?ut=_u(ft,ut,Rt[nn+1]>>1)-1:(_u(ft,ut,3),_u(ft,ut+=5,Rt[nn-23]>>5),ut+=3);var Sr=nn<8?0:nn-4>>2;Sr>0&&(Cp(ft,ut,ci-It[nn]),ut+=Sr),ut=_u(ft,ut,Rt[nn=ye[ht-en]]>>3),ut-=3;var il=nn<4?0:nn-2>>1;il>0&&(Cp(ft,ut,ht-en-sn[nn]),ut+=il);for(var No=0;No<ci;++No)Wt[An]=32767&ht,An=32767&(An<<5^kt[ht]),++ht;rn-=ci-1}else nn<=143?nn+=48:ut=Nc(ft,ut,1),ut=_u(ft,ut,Rt[nn]),Wt[An]=32767&ht,++ht}ut=_u(ft,ut,0)-1}}return ft.l=(ut+7)/8|0,ft.l}(ft,ut)}}();function Mi(oe){var ye=Tt(50+Math.floor(1.1*oe.length)),ue=Lc(oe,ye);return ye.slice(0,ue)}var wo=Qt?new Uint16Array(32768):tl(32768),nl=Qt?new Uint16Array(32768):tl(32768),Oo=Qt?new Uint16Array(128):tl(128),uf=1,d3=1;function ly(oe,ye){var ue=zi(oe,ye)+257,pe=zi(oe,ye+=5)+1,_e=function Dr(oe,ye){var ue=7&ye,pe=ye>>>3;return(oe[pe]|(ue<=4?0:oe[pe+1]<<8))>>>ue&15}(oe,ye+=5)+4;ye+=4;for(var xe=0,at=Qt?new Uint8Array(19):tl(19),kt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ft=1,ut=Qt?new Uint8Array(8):tl(8),ht=Qt?new Uint8Array(8):tl(8),Wt=at.length,rn=0;rn<_e;++rn)at[Pe[rn]]=xe=Hi(oe,ye),ft<xe&&(ft=xe),ut[xe]++,ye+=3;var An=0;for(ut[0]=0,rn=1;rn<=ft;++rn)ht[rn]=An=An+ut[rn-1]<<1;for(rn=0;rn<Wt;++rn)0!=(An=at[rn])&&(kt[rn]=ht[An]++);var nn=0;for(rn=0;rn<Wt;++rn)if(0!=(nn=at[rn])){An=Rt[kt[rn]]>>8-nn;for(var en=(1<<7-nn)-1;en>=0;--en)Oo[An|en<<nn]=7&nn|rn<<3}var ci=[];for(ft=1;ci.length<ue+pe;)switch(An=Oo[fn(oe,ye)],ye+=7&An,An>>>=3){case 16:for(xe=3+Tr(oe,ye),ye+=2,An=ci[ci.length-1];xe-- >0;)ci.push(An);break;case 17:for(xe=3+Hi(oe,ye),ye+=3;xe-- >0;)ci.push(0);break;case 18:for(xe=11+fn(oe,ye),ye+=7;xe-- >0;)ci.push(0);break;default:ci.push(An),ft<An&&(ft=An)}var Sr=ci.slice(0,ue),il=ci.slice(ue);for(rn=ue;rn<286;++rn)Sr[rn]=0;for(rn=pe;rn<30;++rn)il[rn]=0;return uf=yu(Sr,wo,286),d3=yu(il,nl,30),ye}function Nn(oe,ye){var pe=function hD(oe,ye){if(3==oe[0]&&!(3&oe[1]))return[Hl(ye),2];for(var ue=0,pe=0,_e=Lb(ye||1<<18),xe=0,at=_e.length>>>0,kt=0,ft=0;0==(1&pe);)if(pe=Hi(oe,ue),ue+=3,pe>>>1!=0)for(pe>>1==1?(kt=9,ft=5):(ue=ly(oe,ue),kt=uf,ft=d3);;){!ye&&at<xe+32767&&(at=(_e=vu(_e,xe+32767)).length);var ht=Po(oe,ue,kt),Wt=pe>>>1==1?bu[ht]:wo[ht];if(ue+=15&Wt,0==((Wt>>>=4)>>>8&255))_e[xe++]=Wt;else{if(256==Wt)break;var rn=(Wt-=257)<8?0:Wt-4>>2;rn>5&&(rn=0);var An=xe+It[Wt];rn>0&&(An+=Po(oe,ue,rn),ue+=rn),ht=Po(oe,ue,ft),ue+=15&(Wt=pe>>>1==1?gm[ht]:nl[ht]);var nn=(Wt>>>=4)<4?0:Wt-2>>1,en=sn[Wt];for(nn>0&&(en+=Po(oe,ue,nn),ue+=nn),!ye&&at<An&&(at=(_e=vu(_e,An+100)).length);xe<An;)_e[xe]=_e[xe-en],++xe}}else{7&ue&&(ue+=8-(7&ue));var ut=oe[ue>>>3]|oe[1+(ue>>>3)]<<8;if(ue+=32,ut>0)for(!ye&&at<xe+ut&&(at=(_e=vu(_e,xe+ut)).length);ut-- >0;)_e[xe++]=oe[ue>>>3],ue+=8}return ye?[_e,ue+7>>>3]:[_e.slice(0,xe),ue+7>>>3]}(oe.slice(oe.l||0),ye);return oe.l+=pe[1],pe[0]}function f3(oe,ye){if(!oe)throw new Error(ye);"undefined"!=typeof console&&console.error(ye)}function cy(oe,ye){var ue=oe;yo(ue,0);var xe={FileIndex:[],FullPaths:[]};be(xe,{root:ye.root});for(var at=ue.length-4;(80!=ue[at]||75!=ue[at+1]||5!=ue[at+2]||6!=ue[at+3])&&at>=0;)--at;ue.l=at+4,ue.l+=4;var kt=ue.read_shift(2);ue.l+=6;var ft=ue.read_shift(4);for(ue.l=ft,at=0;at<kt;++at){ue.l+=20;var ut=ue.read_shift(4),ht=ue.read_shift(4),Wt=ue.read_shift(2),rn=ue.read_shift(2),An=ue.read_shift(2);ue.l+=8;var nn=ue.read_shift(4),en=C(ue.slice(ue.l+Wt,ue.l+Wt+rn));ue.l+=Wt+rn+An;var ci=ue.l;ue.l=nn+4,mD(ue,ut,ht,xe,en),ue.l=ci}return xe}function mD(oe,ye,ue,pe,_e){oe.l+=2;var xe=oe.read_shift(2),at=oe.read_shift(2),kt=function b(oe){var ye=65535&oe.read_shift(2),ue=65535&oe.read_shift(2),pe=new Date,_e=31&ue,xe=15&(ue>>>=5);ue>>>=4,pe.setMilliseconds(0),pe.setFullYear(ue+1980),pe.setMonth(xe-1),pe.setDate(_e);var at=31&ye,kt=63&(ye>>>=5);return pe.setHours(ye>>>=6),pe.setMinutes(kt),pe.setSeconds(at<<1),pe}(oe);if(8257&xe)throw new Error("Unsupported ZIP encryption");oe.read_shift(4);for(var ut=oe.read_shift(4),ht=oe.read_shift(4),Wt=oe.read_shift(2),rn=oe.read_shift(2),An="",nn=0;nn<Wt;++nn)An+=String.fromCharCode(oe[oe.l++]);if(rn){var en=C(oe.slice(oe.l,oe.l+rn));(en[21589]||{}).mt&&(kt=en[21589].mt),((_e||{})[21589]||{}).mt&&(kt=_e[21589].mt)}oe.l+=rn;var ci=oe.slice(oe.l,oe.l+ut);switch(at){case 8:ci=function dt(oe,ye){if(!Pt)return Nn(oe,ye);var pe=new(0,Pt.InflateRaw),_e=pe._processChunk(oe.slice(oe.l),pe._finishFlushFlag);return oe.l+=pe.bytesRead,_e}(oe,ht);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+at)}var Sr=!1;8&xe&&(134695760==oe.read_shift(4)&&(oe.read_shift(4),Sr=!0),ut=oe.read_shift(4),ht=oe.read_shift(4)),ut!=ye&&f3(Sr,"Bad compressed size: "+ye+" != "+ut),ht!=ue&&f3(Sr,"Bad uncompressed size: "+ue+" != "+ht),Ss(pe,An,ci,{unsafe:!0,mt:kt})}var uy={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function gD(oe,ye){if(oe.ctype)return oe.ctype;var ue=oe.name||"",pe=ue.match(/\.([^\.]+)$/);return pe&&uy[pe[1]]||ye&&(pe=(ue=ye).match(/[\.\\]([^\.\\])+$/))&&uy[pe[1]]?uy[pe[1]]:"application/octet-stream"}function df(oe){for(var ye=mh(oe),ue=[],pe=0;pe<ye.length;pe+=76)ue.push(ye.slice(pe,pe+76));return ue.join("\r\n")+"\r\n"}function _D(oe){var ye=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ut){var ht=ut.charCodeAt(0).toString(16).toUpperCase();return"="+(1==ht.length?"0"+ht:ht)});"\n"==(ye=ye.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(ye="=0D"+ye.slice(1));for(var ue=[],pe=(ye=ye.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),_e=0;_e<pe.length;++_e){var xe=pe[_e];if(0!=xe.length)for(var at=0;at<xe.length;){var kt=76,ft=xe.slice(at,at+kt);"="==ft.charAt(kt-1)?kt--:"="==ft.charAt(kt-2)?kt-=2:"="==ft.charAt(kt-3)&&(kt-=3),ft=xe.slice(at,at+kt),(at+=kt)<xe.length&&(ft+="="),ue.push(ft)}else ue.push("")}return ue.join("\r\n")}function mr(oe,ye,ue){for(var at,pe="",_e="",xe="",kt=0;kt<10;++kt){var ft=ye[kt];if(!ft||ft.match(/^\s*$/))break;var ut=ft.match(/^(.*?):\s*([^\s].*)$/);if(ut)switch(ut[1].toLowerCase()){case"content-location":pe=ut[2].trim();break;case"content-type":xe=ut[2].trim();break;case"content-transfer-encoding":_e=ut[2].trim()}}switch(++kt,_e.toLowerCase()){case"base64":at=ha(pa(ye.slice(kt).join("")));break;case"quoted-printable":at=function Tp(oe){for(var ye=[],ue=0;ue<oe.length;++ue){for(var pe=oe[ue];ue<=oe.length&&"="==pe.charAt(pe.length-1);)pe=pe.slice(0,pe.length-1)+oe[++ue];ye.push(pe)}for(var _e=0;_e<ye.length;++_e)ye[_e]=ye[_e].replace(/[=][0-9A-Fa-f]{2}/g,function(xe){return String.fromCharCode(parseInt(xe.slice(1),16))});return ha(ye.join("\r\n"))}(ye.slice(kt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+_e)}var ht=Ss(oe,pe.slice(ue.length),at,{unsafe:!0});xe&&(ht.ctype=xe)}function Ss(oe,ye,ue,pe){var _e=pe&&pe.unsafe;_e||be(oe);var xe=!_e&&In.find(oe,ye);if(!xe){var at=oe.FullPaths[0];ye.slice(0,at.length)==at?at=ye:("/"!=at.slice(-1)&&(at+="/"),at=(at+ye).replace("//","/")),xe={name:h(ye),type:2},oe.FileIndex.push(xe),oe.FullPaths.push(at),_e||In.utils.cfb_gc(oe)}return xe.content=ue,xe.size=ue?ue.length:0,pe&&(pe.CLSID&&(xe.clsid=pe.CLSID),pe.mt&&(xe.mt=pe.mt),pe.ct&&(xe.ct=pe.ct)),xe}return l.find=function bt(oe,ye){var ue=oe.FullPaths.map(function(ft){return ft.toUpperCase()}),pe=ue.map(function(ft){var ut=ft.split("/");return ut[ut.length-("/"==ft.slice(-1)?2:1)]}),_e=!1;47===ye.charCodeAt(0)?(_e=!0,ye=ue[0].slice(0,-1)+ye):_e=-1!==ye.indexOf("/");var xe=ye.toUpperCase(),at=!0===_e?ue.indexOf(xe):pe.indexOf(xe);if(-1!==at)return oe.FileIndex[at];var kt=!xe.match(_h);for(xe=xe.replace(Ns,""),kt&&(xe=xe.replace(_h,"!")),at=0;at<ue.length;++at)if((kt?ue[at].replace(_h,"!"):ue[at]).replace(Ns,"")==xe||(kt?pe[at].replace(_h,"!"):pe[at]).replace(Ns,"")==xe)return oe.FileIndex[at];return null},l.read=function ze(oe,ye){var ue=ye&&ye.type;switch(ue||Oi&&Buffer.isBuffer(oe)&&(ue="buffer"),ue||"base64"){case"file":return function tt(oe,ye){return F(),O(I.readFileSync(oe),ye)}(oe,ye);case"base64":return O(ha(pa(oe)),ye);case"binary":return O(ha(oe),ye)}return O(oe,ye)},l.parse=O,l.write=function Mn(oe,ye){var ue=gt(oe,ye);switch(ye&&ye.type||"buffer"){case"file":return F(),I.writeFileSync(ye.filename,ue),ue;case"binary":return"string"==typeof ue?ue:ln(ue);case"base64":return mh("string"==typeof ue?ue:ln(ue));case"buffer":if(Oi)return Buffer.isBuffer(ue)?ue:Ga(ue);case"array":return"string"==typeof ue?ha(ue):ue}return ue},l.writeFile=function Li(oe,ye,ue){F();var pe=gt(oe,ue);I.writeFileSync(ye,pe)},l.utils={cfb_new:function _m(oe){var ye={};return be(ye,oe),ye},cfb_add:Ss,cfb_del:function yD(oe,ye){be(oe);var ue=In.find(oe,ye);if(ue)for(var pe=0;pe<oe.FileIndex.length;++pe)if(oe.FileIndex[pe]==ue)return oe.FileIndex.splice(pe,1),oe.FullPaths.splice(pe,1),!0;return!1},cfb_mov:function bD(oe,ye,ue){be(oe);var pe=In.find(oe,ye);if(pe)for(var _e=0;_e<oe.FileIndex.length;++_e)if(oe.FileIndex[_e]==pe)return oe.FileIndex[_e].name=h(ue),oe.FullPaths[_e]=ue,!0;return!1},cfb_gc:function xD(oe){qe(oe,!0)},ReadShift:an,CheckField:rs,prep_blob:yo,bconcat:es,use_zlib:function Ee(oe){try{var ue=new(0,oe.InflateRaw);if(ue._processChunk(new Uint8Array([3,0]),ue._finishFlushFlag),!ue.bytesRead)throw new Error("zlib does not expose bytesRead");Pt=oe}catch(pe){console.error("cannot use native zlib: "+(pe.message||pe))}},_deflateRaw:Mi,_inflateRaw:Nn,consts:Dn},l}();let Ld;function M5(s){Ld=s}function Jb(s){return"string"==typeof s?gh(s):Array.isArray(s)?function qu(s){if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(s)}(s):s}function Rd(s,l,a){if(void 0!==Ld&&Ld.writeFileSync)return a?Ld.writeFileSync(s,l,a):Ld.writeFileSync(s,l);if("undefined"!=typeof Deno){if(a&&"string"==typeof l)switch(a){case"utf8":l=new TextEncoder(a).encode(l);break;case"binary":l=gh(l);break;default:throw new Error("Unsupported encoding "+a)}return Deno.writeFileSync(s,l)}var d="utf8"==a?hl(l):l;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(d,s);if("undefined"!=typeof Blob){var h=new Blob([Jb(d)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(h,s);if("undefined"!=typeof saveAs)return saveAs(h,s);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var y=URL.createObjectURL(h);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(y)},6e4),chrome.downloads.download({url:y,filename:s,saveAs:!0});var b=document.createElement("a");if(null!=b.download)return b.download=s,b.href=y,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(y)},6e4),y}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var C=File(s);return C.open("w"),C.encoding="binary",Array.isArray(l)&&(l=hc(l)),C.write(l),C.close(),l}catch(I){if(!I.message||!I.message.match(/onstruct/))throw I}throw new Error("cannot save file "+s)}function Gr(s){for(var l=Object.keys(s),a=[],d=0;d<l.length;++d)Object.prototype.hasOwnProperty.call(s,l[d])&&a.push(l[d]);return a}function e2(s,l){for(var a=[],d=Gr(s),h=0;h!==d.length;++h)null==a[s[d[h]][l]]&&(a[s[d[h]][l]]=d[h]);return a}function xh(s){for(var l=[],a=Gr(s),d=0;d!==a.length;++d)l[s[a[d]]]=a[d];return l}function wh(s){for(var l=[],a=Gr(s),d=0;d!==a.length;++d)l[s[a[d]]]=parseInt(a[d],10);return l}var tg=new Date(1899,11,30,0,0,0);function ns(s,l){var a=s.getTime();return l&&(a-=1263168e5),(a-(tg.getTime()+6e4*(s.getTimezoneOffset()-tg.getTimezoneOffset())))/864e5}var t2=new Date,n2=tg.getTime()+6e4*(t2.getTimezoneOffset()-tg.getTimezoneOffset()),r2=t2.getTimezoneOffset();function ng(s){var l=new Date;return l.setTime(24*s*60*60*1e3+n2),l.getTimezoneOffset()!==r2&&l.setTime(l.getTime()+6e4*(l.getTimezoneOffset()-r2)),l}function Ls(s){var l=0,a=0,d=!1,h=s.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!h)throw new Error("|"+s+"| is not an ISO8601 Duration");for(var y=1;y!=h.length;++y)if(h[y]){switch(a=1,y>3&&(d=!0),h[y].slice(h[y].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+h[y].slice(h[y].length-1));case"D":a*=24;case"H":a*=60;case"M":if(!d)throw new Error("Unsupported ISO Duration Field: M");a*=60}l+=a*parseInt(h[y],10)}return l}var o2=new Date("2017-02-19T19:06:09.000Z"),G_=isNaN(o2.getFullYear())?new Date("2/19/17"):o2,K_=2017==G_.getFullYear();function Kn(s,l){var a=new Date(s);if(K_)return l>0?a.setTime(a.getTime()+60*a.getTimezoneOffset()*1e3):l<0&&a.setTime(a.getTime()-60*a.getTimezoneOffset()*1e3),a;if(s instanceof Date)return s;if(1917==G_.getFullYear()&&!isNaN(a.getFullYear())){var d=a.getFullYear();return s.indexOf(""+d)>-1||a.setFullYear(a.getFullYear()+100),a}var h=s.match(/\d+/g)||["2017","2","19","0","0","0"],y=new Date(+h[0],+h[1]-1,+h[2],+h[3]||0,+h[4]||0,+h[5]||0);return s.indexOf("Z")>-1&&(y=new Date(y.getTime()-60*y.getTimezoneOffset()*1e3)),y}function Zc(s,l){if(Oi&&Buffer.isBuffer(s)){if(l){if(255==s[0]&&254==s[1])return hl(s.slice(2).toString("utf16le"));if(254==s[1]&&255==s[2])return hl(Os(s.slice(2).toString("binary")))}return s.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(l){if(255==s[0]&&254==s[1])return hl(new TextDecoder("utf-16le").decode(s.slice(2)));if(254==s[0]&&255==s[1])return hl(new TextDecoder("utf-16be").decode(s.slice(2)))}var a={"\u20ac":"\x80","\u201a":"\x82",\u0192:"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87",\u02c6:"\x88","\u2030":"\x89",\u0160:"\x8a","\u2039":"\x8b",\u0152:"\x8c",\u017d:"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99",\u0161:"\x9a","\u203a":"\x9b",\u0153:"\x9c",\u017e:"\x9e",\u0178:"\x9f"};return Array.isArray(s)&&(s=new Uint8Array(s)),new TextDecoder("latin1").decode(s).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(y){return a[y]||y})}catch(y){}for(var d=[],h=0;h!=s.length;++h)d.push(String.fromCharCode(s[h]));return d.join("")}function Bn(s){if("undefined"!=typeof JSON&&!Array.isArray(s))return JSON.parse(JSON.stringify(s));if("object"!=typeof s||null==s)return s;if(s instanceof Date)return new Date(s.getTime());var l={};for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(l[a]=Bn(s[a]));return l}function uo(s,l){for(var a="";a.length<l;)a+=s;return a}function ql(s){var l=Number(s);if(!isNaN(l))return isFinite(l)?l:NaN;if(!/\d/.test(s))return l;var a=1,d=s.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return isNaN(l=Number(d))&&(d=d.replace(/[(](.*)[)]/,function(h,y){return a=-a,y}),isNaN(l=Number(d)))?l:l/a}var tr=["january","february","march","april","may","june","july","august","september","october","november","december"];function si(s){var l=new Date(s),a=new Date(NaN),d=l.getYear(),h=l.getMonth(),y=l.getDate();if(isNaN(y))return a;var b=s.toLowerCase();if(b.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((b=b.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==tr.indexOf(b))return a}else if(b.match(/[a-z]/))return a;return d<0||d>8099?a:(h>0||y>1)&&101!=d?l:s.match(/[^-0-9:,\/\\]/)?a:l}var s2=function(){var s=5=="abacaba".split(/(:?b)/i).length;return function(a,d,h){if(s||"string"==typeof d)return a.split(d);for(var y=a.split(d),b=[y[0]],C=1;C<y.length;++C)b.push(h),b.push(y[C]);return b}}();function P5(s){return s?s.content&&s.type?Zc(s.content,!0):s.data?ar(s.data):s.asNodeBuffer&&Oi?ar(s.asNodeBuffer().toString("binary")):s.asBinary?ar(s.asBinary()):s._data&&s._data.getContent?ar(Zc(Array.prototype.slice.call(s._data.getContent(),0))):null:null}function Tn(s){if(!s)return null;if(s.data)return pi(s.data);if(s.asNodeBuffer&&Oi)return s.asNodeBuffer();if(s._data&&s._data.getContent){var l=s._data.getContent();return"string"==typeof l?pi(l):Array.prototype.slice.call(l)}return s.content&&s.type?s.content:null}function jn(s,l){for(var a=s.FullPaths||Gr(s.files),d=l.toLowerCase().replace(/[\/]/g,"\\"),h=d.replace(/\\/g,"/"),y=0;y<a.length;++y){var b=a[y].replace(/^Root Entry[\/]/,"").toLowerCase();if(d==b||h==b)return s.files?s.files[a[y]]:s.FileIndex[y]}return null}function Rs(s,l){var a=jn(s,l);if(null==a)throw new Error("Cannot find file "+l+" in zip");return a}function jo(s,l,a){if(!a)return function Y_(s){return s&&".bin"===s.name.slice(-4)?Tn(s):P5(s)}(Rs(s,l));if(!l)return null;try{return jo(s,l)}catch(d){return null}}function pl(s,l,a){if(!a)return P5(Rs(s,l));if(!l)return null;try{return pl(s,l)}catch(d){return null}}function O5(s,l,a){if(!a)return Tn(Rs(s,l));if(!l)return null;try{return O5(s,l)}catch(d){return null}}function Ch(s){for(var l=s.FullPaths||Gr(s.files),a=[],d=0;d<l.length;++d)"/"!=l[d].slice(-1)&&a.push(l[d].replace(/^Root Entry[\/]/,""));return a.sort()}function Hn(s,l,a){if(s.FullPaths){var d;if("string"==typeof a)return d=Oi?Ga(a):function Lr(s){for(var l=[],a=0,d=s.length+250,h=Hl(s.length+255),y=0;y<s.length;++y){var b=s.charCodeAt(y);if(b<128)h[a++]=b;else if(b<2048)h[a++]=192|b>>6&31,h[a++]=128|63&b;else if(b>=55296&&b<57344){b=64+(1023&b);var C=1023&s.charCodeAt(++y);h[a++]=240|b>>8&7,h[a++]=128|b>>2&63,h[a++]=128|C>>6&15|(3&b)<<4,h[a++]=128|63&C}else h[a++]=224|b>>12&15,h[a++]=128|b>>6&63,h[a++]=128|63&b;a>d&&(l.push(h.slice(0,a)),a=0,h=Hl(65535),d=65530)}return l.push(h.slice(0,a)),es(l)}(a),In.utils.cfb_add(s,l,d);In.utils.cfb_add(s,l,a)}else s.file(l,a)}function a2(){return In.utils.cfb_new()}function l2(s,l){switch(l.type){case"base64":return In.read(s,{type:"base64"});case"binary":return In.read(s,{type:"binary"});case"buffer":case"array":return In.read(s,{type:"buffer"})}throw new Error("Unrecognized type "+l.type)}function ig(s,l){if("/"==s.charAt(0))return s.slice(1);var a=l.split("/");"/"!=l.slice(-1)&&a.pop();for(var d=s.split("/");0!==d.length;){var h=d.shift();".."===h?a.pop():"."!==h&&a.push(h)}return a.join("/")}var br='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',OF=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,N5=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,va=br.match(N5)?N5:/<[^>]*>/g,L5=/<\w*:/,LF=/<(\/?)\w+:/;function Qn(s,l,a){for(var d={},h=0,y=0;h!==s.length&&32!==(y=s.charCodeAt(h))&&10!==y&&13!==y;++h);if(l||(d[0]=s.slice(0,h)),h===s.length)return d;var b=s.match(OF),C=0,I="",F=0,O="",H="",W=1;if(b)for(F=0;F!=b.length;++F){for(H=b[F],y=0;y!=H.length&&61!==H.charCodeAt(y);++y);for(O=H.slice(0,y).trim();32==H.charCodeAt(y+1);)++y;for(W=34==(h=H.charCodeAt(y+1))||39==h?1:0,I=H.slice(y+1+W,H.length-W),C=0;C!=O.length&&58!==O.charCodeAt(C);++C);if(C===O.length)O.indexOf("_")>0&&(O=O.slice(0,O.indexOf("_"))),d[O]=I,a||(d[O.toLowerCase()]=I);else{var G=(5===C&&"xmlns"===O.slice(0,5)?"xmlns":"")+O.slice(C+1);if(d[G]&&"ext"==O.slice(C-3,C))continue;d[G]=I,a||(d[G.toLowerCase()]=I)}}return d}function eu(s){return s.replace(LF,"<$1")}var Aa={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Rr=xh(Aa),lr=function(){var s=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,l=/_x([\da-fA-F]{4})_/gi;return function a(d){var h=d+"",y=h.indexOf("<![CDATA[");if(-1==y)return h.replace(s,function(C,I){return Aa[C]||String.fromCharCode(parseInt(I,C.indexOf("x")>-1?16:10))||C}).replace(l,function(C,I){return String.fromCharCode(parseInt(I,16))});var b=h.indexOf("]]>");return a(h.slice(0,y))+h.slice(y+9,b)+a(h.slice(b+3))}}(),c2=/[&<>'"]/g,RF=/[\u0000-\u0008\u000b-\u001f]/g;function Vt(s){return(s+"").replace(c2,function(a){return Rr[a]}).replace(RF,function(a){return"_x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+"_"})}function R5(s){return Vt(s).replace(/ /g,"_x0020_")}var Ci=/[\u0000-\u001f]/g;function Th(s){return(s+"").replace(c2,function(a){return Rr[a]}).replace(/\n/g,"<br/>").replace(Ci,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}var d2=function(){var s=/&#(\d+);/g;function l(a,d){return String.fromCharCode(parseInt(d,10))}return function(d){return d.replace(s,l)}}();function Kr(s){switch(s){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Vf(s){for(var l="",a=0,d=0,h=0,y=0,b=0,C=0;a<s.length;)(d=s.charCodeAt(a++))<128?l+=String.fromCharCode(d):(h=s.charCodeAt(a++),d>191&&d<224?(b=(31&d)<<6,b|=63&h,l+=String.fromCharCode(b)):(y=s.charCodeAt(a++),d<240?l+=String.fromCharCode((15&d)<<12|(63&h)<<6|63&y):(C=((7&d)<<18|(63&h)<<12|(63&y)<<6|63&(b=s.charCodeAt(a++)))-65536,l+=String.fromCharCode(55296+(C>>>10&1023)),l+=String.fromCharCode(56320+(1023&C)))));return l}function rg(s){var a,d,C,l=Hl(2*s.length),h=1,y=0,b=0;for(d=0;d<s.length;d+=h)h=1,(C=s.charCodeAt(d))<128?a=C:C<224?(a=64*(31&C)+(63&s.charCodeAt(d+1)),h=2):C<240?(a=4096*(15&C)+64*(63&s.charCodeAt(d+1))+(63&s.charCodeAt(d+2)),h=3):(h=4,a=262144*(7&C)+4096*(63&s.charCodeAt(d+1))+64*(63&s.charCodeAt(d+2))+(63&s.charCodeAt(d+3)),b=55296+((a-=65536)>>>10&1023),a=56320+(1023&a)),0!==b&&(l[y++]=255&b,l[y++]=b>>>8,b=0),l[y++]=a%256,l[y++]=a>>>8;return l.slice(0,y).toString("ucs2")}function X_(s){return Ga(s,"binary").toString("utf8")}var og="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",_n=Oi&&(X_(og)==Vf(og)&&X_||rg(og)==Vf(og)&&rg)||Vf,hl=Oi?function(s){return Ga(s,"utf8").toString("binary")}:function(s){for(var l=[],a=0,d=0,h=0;a<s.length;)switch(d=s.charCodeAt(a++),!0){case d<128:l.push(String.fromCharCode(d));break;case d<2048:l.push(String.fromCharCode(192+(d>>6))),l.push(String.fromCharCode(128+(63&d)));break;case d>=55296&&d<57344:d-=55296,h=s.charCodeAt(a++)-56320+(d<<10),l.push(String.fromCharCode(240+(h>>18&7))),l.push(String.fromCharCode(144+(h>>12&63))),l.push(String.fromCharCode(128+(h>>6&63))),l.push(String.fromCharCode(128+(63&h)));break;default:l.push(String.fromCharCode(224+(d>>12))),l.push(String.fromCharCode(128+(d>>6&63))),l.push(String.fromCharCode(128+(63&d)))}return l.join("")},Sh=function(){var s={};return function(a,d){var h=a+"|"+(d||"");return s[h]?s[h]:s[h]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",d||"")}}(),tu=function(){var s=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(l){return[new RegExp("&"+l[0]+";","ig"),l[1]]});return function(a){for(var d=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),h=0;h<s.length;++h)d=d.replace(s[h][0],s[h][1]);return d}}(),f2=function(){var s={};return function(a){return void 0!==s[a]?s[a]:s[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}}(),BF=/<\/?(?:vt:)?variant>/g,Yu=/<(?:vt:)([^>]*)>([\s\S]*)</;function ml(s,l){var a=Qn(s),d=s.match(f2(a.baseType))||[],h=[];if(d.length!=a.size){if(l.WTF)throw new Error("unexpected vector length "+d.length+" != "+a.size);return h}return d.forEach(function(y){var b=y.replace(BF,"").match(Yu);b&&h.push({v:_n(b[2]),t:b[1]})}),h}var j5=/(^\s|\s$|\n)/;function Xs(s,l){return"<"+s+(l.match(j5)?' xml:space="preserve"':"")+">"+l+"</"+s+">"}function ya(s){return Gr(s).map(function(l){return" "+l+'="'+s[l]+'"'}).join("")}function Jt(s,l,a){return"<"+s+(null!=a?ya(a):"")+(null!=l?(l.match(j5)?' xml:space="preserve"':"")+">"+l+"</"+s:"/")+">"}function Q_(s,l){try{return s.toISOString().replace(/\.\d*/,"")}catch(a){if(l)throw a}return""}function p2(s){if(Oi&&Buffer.isBuffer(s))return s.toString("utf8");if("string"==typeof s)return s;if("undefined"!=typeof Uint8Array&&s instanceof Uint8Array)return _n(hc(Rb(s)));throw new Error("Bad input format: expected Buffer or string")}var cr=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,is_CT="http://schemas.openxmlformats.org/package/2006/content-types",is_TCMNT="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",is_r="http://schemas.openxmlformats.org/officeDocument/2006/relationships",is_vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",is_xsi="http://www.w3.org/2001/XMLSchema-instance",Bd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ys_o="urn:schemas-microsoft-com:office:office",ys_x="urn:schemas-microsoft-com:office:excel",ys_ss="urn:schemas-microsoft-com:office:spreadsheet",ag=function(s){for(var l=[],d=0;d<s[0].length;++d)if(s[0][d])for(var h=0,y=s[0][d].length;h<y;h+=10240)l.push.apply(l,s[0][d].slice(h,h+10240));return l},lg=Oi?function(s){return s[0].length>0&&Buffer.isBuffer(s[0][0])?Buffer.concat(s[0].map(function(l){return Buffer.isBuffer(l)?l:Ga(l)})):ag(s)}:ag,J_=function(s,l,a){for(var d=[],h=l;h<a;h+=2)d.push(String.fromCharCode(_l(s,h)));return d.join("").replace(Ns,"")},gl=Oi?function(s,l,a){return Buffer.isBuffer(s)?s.toString("utf16le",l,a).replace(Ns,""):J_(s,l,a)}:J_,Uf=function(s,l,a){for(var d=[],h=l;h<l+a;++h)d.push(("0"+s[h].toString(16)).slice(-2));return d.join("")},h2=Oi?function(s,l,a){return Buffer.isBuffer(s)?s.toString("hex",l,l+a):Uf(s,l,a)}:Uf,dn=function(s,l,a){for(var d=[],h=l;h<a;h++)d.push(String.fromCharCode(yc(s,h)));return d.join("")},jd=Oi?function(l,a,d){return Buffer.isBuffer(l)?l.toString("utf8",a,d):dn(l,a,d)}:dn,Z_=function(s,l){var a=sr(s,l);return a>0?jd(s,l+4,l+4+a-1):""},cg=Z_,e1=function(s,l){var a=sr(s,l);return a>0?jd(s,l+4,l+4+a-1):""},Ti=e1,m2=function(s,l){var a=2*sr(s,l);return a>0?jd(s,l+4,l+4+a-1):""},ug=m2,Ln=function(l,a){var d=sr(l,a);return d>0?gl(l,a+4,a+4+d):""},Qs=Ln,Bs=function(s,l){var a=sr(s,l);return a>0?jd(s,l+4,l+4+a):""},vc=Bs,Xu=function(s,l){return function Br(s,l){for(var a=1-2*(s[l+7]>>>7),d=((127&s[l+7])<<4)+(s[l+6]>>>4&15),h=15&s[l+6],y=5;y>=0;--y)h=256*h+s[l+y];return 2047==d?0==h?a*(1/0):NaN:(0==d?d=-1022:(d-=1023,h+=Math.pow(2,52)),a*Math.pow(2,d-52)*h)}(s,l)},ba=Xu,Hf=function(l){return Array.isArray(l)||"undefined"!=typeof Uint8Array&&l instanceof Uint8Array};function dg(){gl=function(s,l,a){return Pi.utils.decode(1200,s.slice(l,a)).replace(Ns,"")},jd=function(s,l,a){return Pi.utils.decode(65001,s.slice(l,a))},cg=function(s,l){var a=sr(s,l);return a>0?Pi.utils.decode(Ks,s.slice(l+4,l+4+a-1)):""},Ti=function(s,l){var a=sr(s,l);return a>0?Pi.utils.decode(Do,s.slice(l+4,l+4+a-1)):""},ug=function(s,l){var a=2*sr(s,l);return a>0?Pi.utils.decode(1200,s.slice(l+4,l+4+a-1)):""},Qs=function(s,l){var a=sr(s,l);return a>0?Pi.utils.decode(1200,s.slice(l+4,l+4+a)):""},vc=function(s,l){var a=sr(s,l);return a>0?Pi.utils.decode(65001,s.slice(l+4,l+4+a)):""}}Oi&&(cg=function(l,a){if(!Buffer.isBuffer(l))return Z_(l,a);var d=l.readUInt32LE(a);return d>0?l.toString("utf8",a+4,a+4+d-1):""},Ti=function(l,a){if(!Buffer.isBuffer(l))return e1(l,a);var d=l.readUInt32LE(a);return d>0?l.toString("utf8",a+4,a+4+d-1):""},ug=function(l,a){if(!Buffer.isBuffer(l))return m2(l,a);var d=2*l.readUInt32LE(a);return l.toString("utf16le",a+4,a+4+d-1)},Qs=function(l,a){if(!Buffer.isBuffer(l))return Ln(l,a);var d=l.readUInt32LE(a);return l.toString("utf16le",a+4,a+4+d)},vc=function(l,a){if(!Buffer.isBuffer(l))return Bs(l,a);var d=l.readUInt32LE(a);return l.toString("utf8",a+4,a+4+d)},ba=function(l,a){return Buffer.isBuffer(l)?l.readDoubleLE(a):Xu(l,a)},Hf=function(l){return Buffer.isBuffer(l)||Array.isArray(l)||"undefined"!=typeof Uint8Array&&l instanceof Uint8Array}),void 0!==Pi&&dg();var yc=function(s,l){return s[l]},_l=function(s,l){return 256*s[l+1]+s[l]},Vd=function(s,l){var a=256*s[l+1]+s[l];return a<32768?a:-1*(65535-a+1)},sr=function(s,l){return s[l+3]*(1<<24)+(s[l+2]<<16)+(s[l+1]<<8)+s[l]},Ud=function(s,l){return s[l+3]<<24|s[l+2]<<16|s[l+1]<<8|s[l]},vl=function(s,l){return s[l]<<24|s[l+1]<<16|s[l+2]<<8|s[l+3]};function an(s,l){var d,h,b,C,I,F,a="",y=[];switch(l){case"dbcs":if(F=this.l,Oi&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*s).toString("utf16le");else for(I=0;I<s;++I)a+=String.fromCharCode(_l(this,F)),F+=2;s*=2;break;case"utf8":a=jd(this,this.l,this.l+s);break;case"utf16le":a=gl(this,this.l,this.l+(s*=2));break;case"wstr":if(void 0===Pi)return an.call(this,s,"dbcs");a=Pi.utils.decode(Do,this.slice(this.l,this.l+2*s)),s*=2;break;case"lpstr-ansi":a=cg(this,this.l),s=4+sr(this,this.l);break;case"lpstr-cp":a=Ti(this,this.l),s=4+sr(this,this.l);break;case"lpwstr":a=ug(this,this.l),s=4+2*sr(this,this.l);break;case"lpp4":s=4+sr(this,this.l),a=Qs(this,this.l),2&s&&(s+=2);break;case"8lpp4":s=4+sr(this,this.l),a=vc(this,this.l),3&s&&(s+=4-(3&s));break;case"cstr":for(s=0,a="";0!==(b=yc(this,this.l+s++));)y.push(Zo(b));a=y.join("");break;case"_wstr":for(s=0,a="";0!==(b=_l(this,this.l+s));)y.push(Zo(b)),s+=2;s+=2,a=y.join("");break;case"dbcs-cont":for(a="",F=this.l,I=0;I<s;++I){if(this.lens&&-1!==this.lens.indexOf(F))return b=yc(this,F),this.l=F+1,C=an.call(this,s-I,b?"dbcs-cont":"sbcs-cont"),y.join("")+C;y.push(Zo(_l(this,F))),F+=2}a=y.join(""),s*=2;break;case"cpstr":if(void 0!==Pi){a=Pi.utils.decode(Do,this.slice(this.l,this.l+s));break}case"sbcs-cont":for(a="",F=this.l,I=0;I!=s;++I){if(this.lens&&-1!==this.lens.indexOf(F))return b=yc(this,F),this.l=F+1,C=an.call(this,s-I,b?"dbcs-cont":"sbcs-cont"),y.join("")+C;y.push(Zo(yc(this,F))),F+=1}a=y.join("");break;default:switch(s){case 1:return d=yc(this,this.l),this.l++,d;case 2:return d=("i"===l?Vd:_l)(this,this.l),this.l+=2,d;case 4:case-4:return"i"===l||0==(128&this[this.l+3])?(d=(s>0?Ud:vl)(this,this.l),this.l+=4,d):(h=sr(this,this.l),this.l+=4,h);case 8:case-8:if("f"===l)return h=8==s?ba(this,this.l):ba([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,h;s=8;case 16:a=h2(this,this.l,s)}}return this.l+=s,a}var Ya=function(s,l,a){s[a]=255&l,s[a+1]=l>>>8&255};function Hd(s,l,a){var d=0,h=0;if("dbcs"===a){for(h=0;h!=l.length;++h)Ya(this,l.charCodeAt(h),this.l+2*h);d=2*l.length}else if("sbcs"===a){if(void 0!==Pi&&874==Ks)for(h=0;h!=l.length;++h){var y=Pi.utils.encode(Ks,l.charAt(h));this[this.l+h]=y[0]}else for(l=l.replace(/[^\x00-\x7F]/g,"_"),h=0;h!=l.length;++h)this[this.l+h]=255&l.charCodeAt(h);d=l.length}else{if("hex"===a){for(;h<s;++h)this[this.l++]=parseInt(l.slice(2*h,2*h+2),16)||0;return this}if("utf16le"===a){var b=Math.min(this.l+s,this.length);for(h=0;h<Math.min(l.length,s);++h){var C=l.charCodeAt(h);this[this.l++]=255&C,this[this.l++]=C>>8}for(;this.l<b;)this[this.l++]=0;return this}switch(s){case 1:d=1,this[this.l]=255&l;break;case 2:d=2,this[this.l]=255&l,this[this.l+1]=255&(l>>>=8);break;case 3:d=3,this[this.l]=255&l,this[this.l+1]=255&(l>>>=8),this[this.l+2]=255&(l>>>=8);break;case 4:d=4,function(s,l,a){s[a]=255&l,s[a+1]=l>>>8&255,s[a+2]=l>>>16&255,s[a+3]=l>>>24&255}(this,l,this.l);break;case 8:if(d=8,"f"===a){!function sg(s,l,a){var d=(l<0||1/l==-1/0?1:0)<<7,h=0,y=0,b=d?-l:l;isFinite(b)?0==b?h=y=0:(h=Math.floor(Math.log(b)/Math.LN2),y=b*Math.pow(2,52-h),h<=-1023&&(!isFinite(y)||y<Math.pow(2,52))?h=-1022:(y-=Math.pow(2,52),h+=1023)):(h=2047,y=isNaN(l)?26985:0);for(var C=0;C<=5;++C,y/=256)s[a+C]=255&y;s[a+6]=(15&h)<<4|15&y,s[a+7]=h>>4|d}(this,l,this.l);break}case 16:break;case-4:d=4,function(s,l,a){s[a]=255&l,s[a+1]=l>>8&255,s[a+2]=l>>16&255,s[a+3]=l>>24&255}(this,l,this.l)}}return this.l+=d,this}function rs(s,l){var a=h2(this,this.l,s.length>>1);if(a!==s)throw new Error(l+"Expected "+s+" saw "+a);this.l+=s.length>>1}function yo(s,l){s.l=l,s.read_shift=an,s.chk=rs,s.write_shift=Hd}function qi(s,l){s.l+=l}function Tt(s){var l=Hl(s);return yo(l,0),l}function Ma(s,l,a){if(s){var d,h,y;yo(s,s.l||0);for(var b=s.length,C=0,I=0;s.l<b;){128&(C=s.read_shift(1))&&(C=(127&C)+((127&s.read_shift(1))<<7));var F=bp[C]||bp[65535];for(y=127&(d=s.read_shift(1)),h=1;h<4&&128&d;++h)y+=(127&(d=s.read_shift(1)))<<7*h;I=s.l+y;var O=F.f&&F.f(s,y,a);if(s.l=I,l(O,F,C))return}}}function Vn(){var s=[],l=Oi?256:2048,a=function(F){var O=Tt(F);return yo(O,0),O},d=a(l),h=function(){!d||(d.length>d.l&&((d=d.slice(0,d.l)).l=d.length),d.length>0&&s.push(d),d=null)},y=function(F){return d&&F<d.length-d.l?d:(h(),d=a(Math.max(F+1,l)))};return{next:y,push:function(F){h(),null==(d=F).l&&(d.l=d.length),y(l)},end:function(){return h(),es(s)},_bufs:s}}function Nt(s,l,a,d){var y,h=+l;if(!isNaN(h)){d||(d=bp[h].p||(a||[]).length||0),y=1+(h>=128?1:0)+1,d>=128&&++y,d>=16384&&++y,d>=2097152&&++y;var b=s.next(y);h<=127?b.write_shift(1,h):(b.write_shift(1,128+(127&h)),b.write_shift(1,h>>7));for(var C=0;4!=C;++C){if(!(d>=128)){b.write_shift(1,d);break}b.write_shift(1,128+(127&d)),d>>=7}d>0&&Hf(a)&&s.push(a)}}function bc(s,l,a){var d=Bn(s);if(l.s?(d.cRel&&(d.c+=l.s.c),d.rRel&&(d.r+=l.s.r)):(d.cRel&&(d.c+=l.c),d.rRel&&(d.r+=l.r)),!a||a.biff<12){for(;d.c>=256;)d.c-=256;for(;d.r>=65536;)d.r-=65536}return d}function fg(s,l,a){var d=Bn(s);return d.s=bc(d.s,l.s,a),d.e=bc(d.e,l.s,a),d}function xc(s,l){if(s.cRel&&s.c<0)for(s=Bn(s);s.c<0;)s.c+=l>8?16384:256;if(s.rRel&&s.r<0)for(s=Bn(s);s.r<0;)s.r+=l>8?1048576:l>5?65536:16384;var a=qn(s);return!s.cRel&&null!=s.cRel&&(a=function wc(s){return s.replace(/^([A-Z])/,"$$$1")}(a)),!s.rRel&&null!=s.rRel&&(a=function Gl(s){return s.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(a)),a}function Js(s,l){return 0!=s.s.r||s.s.rRel||s.e.r!=(l.biff>=12?1048575:l.biff>=8?65536:16384)||s.e.rRel?0!=s.s.c||s.s.cRel||s.e.c!=(l.biff>=12?16383:255)||s.e.cRel?xc(s.s,l.biff)+":"+xc(s.e,l.biff):(s.s.rRel?"":"$")+jr(s.s.r)+":"+(s.e.rRel?"":"$")+jr(s.e.r):(s.s.cRel?"":"$")+to(s.s.c)+":"+(s.e.cRel?"":"$")+to(s.e.c)}function zd(s){return parseInt(function Yr(s){return s.replace(/\$(\d+)$/,"$1")}(s),10)-1}function jr(s){return""+(s+1)}function t1(s){for(var l=function Kl(s){return s.replace(/^\$([A-Z])/,"$1")}(s),a=0,d=0;d!==l.length;++d)a=26*a+l.charCodeAt(d)-64;return a-1}function to(s){if(s<0)throw new Error("invalid column "+s);var l="";for(++s;s;s=Math.floor((s-1)/26))l=String.fromCharCode((s-1)%26+65)+l;return l}function Xr(s){for(var l=0,a=0,d=0;d<s.length;++d){var h=s.charCodeAt(d);h>=48&&h<=57?l=10*l+(h-48):h>=65&&h<=90&&(a=26*a+(h-64))}return{c:a-1,r:l-1}}function qn(s){for(var l=s.c+1,a="";l;l=(l-1)/26|0)a=String.fromCharCode((l-1)%26+65)+a;return a+(s.r+1)}function no(s){var l=s.indexOf(":");return-1==l?{s:Xr(s),e:Xr(s)}:{s:Xr(s.slice(0,l)),e:Xr(s.slice(l+1))}}function yi(s,l){return void 0===l||"number"==typeof l?yi(s.s,s.e):("string"!=typeof s&&(s=qn(s)),"string"!=typeof l&&(l=qn(l)),s==l?s:s+":"+l)}function Yi(s){var l={s:{c:0,r:0},e:{c:0,r:0}},a=0,d=0,h=0,y=s.length;for(a=0;d<y&&!((h=s.charCodeAt(d)-64)<1||h>26);++d)a=26*a+h;for(l.s.c=--a,a=0;d<y&&!((h=s.charCodeAt(d)-48)<0||h>9);++d)a=10*a+h;if(l.s.r=--a,d===y||10!=h)return l.e.c=l.s.c,l.e.r=l.s.r,l;for(++d,a=0;d!=y&&!((h=s.charCodeAt(d)-64)<1||h>26);++d)a=26*a+h;for(l.e.c=--a,a=0;d!=y&&!((h=s.charCodeAt(d)-48)<0||h>9);++d)a=10*a+h;return l.e.r=--a,l}function Cc(s,l,a){return null==s||null==s.t||"z"==s.t?"":void 0!==s.w?s.w:("d"==s.t&&!s.z&&a&&a.dateNF&&(s.z=a.dateNF),"e"==s.t?su[s.v]||s.v:function g2(s,l){var a="d"==s.t&&l instanceof Date;if(null!=s.z)try{return s.w=Ka(s.z,a?ns(l):l)}catch(d){}try{return s.w=Ka((s.XF||{}).numFmtId||(a?14:0),a?ns(l):l)}catch(d){return""+l}}(s,null==l?s.v:l))}function $d(s,l){var a=l&&l.sheet?l.sheet:"Sheet1",d={};return d[a]=s,{SheetNames:[a],Sheets:d}}function U5(s,l,a){var d=a||{},h=s?Array.isArray(s):d.dense,y=s||(h?[]:{}),b=0,C=0;if(y&&null!=d.origin){if("number"==typeof d.origin)b=d.origin;else{var I="string"==typeof d.origin?Xr(d.origin):d.origin;b=I.r,C=I.c}y["!ref"]||(y["!ref"]="A1:A1")}var F={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(y["!ref"]){var O=Yi(y["!ref"]);F.s.c=O.s.c,F.s.r=O.s.r,F.e.c=Math.max(F.e.c,O.e.c),F.e.r=Math.max(F.e.r,O.e.r),-1==b&&(F.e.r=b=O.e.r+1)}for(var H=0;H!=l.length;++H)if(l[H]){if(!Array.isArray(l[H]))throw new Error("aoa_to_sheet expects an array of arrays");for(var W=0;W!=l[H].length;++W)if(void 0!==l[H][W]){var G={v:l[H][W]},X=b+H,V=C+W;if(F.s.r>X&&(F.s.r=X),F.s.c>V&&(F.s.c=V),F.e.r<X&&(F.e.r=X),F.e.c<V&&(F.e.c=V),!l[H][W]||"object"!=typeof l[H][W]||Array.isArray(l[H][W])||l[H][W]instanceof Date)if(Array.isArray(G.v)&&(G.f=l[H][W][1],G.v=G.v[0]),null===G.v)if(G.f)G.t="n";else if(d.nullError)G.t="e",G.v=0;else{if(!d.sheetStubs)continue;G.t="z"}else"number"==typeof G.v?G.t="n":"boolean"==typeof G.v?G.t="b":G.v instanceof Date?(G.z=d.dateNF||Wn[14],d.cellDates?(G.t="d",G.w=Ka(G.z,ns(G.v))):(G.t="n",G.v=ns(G.v),G.w=Ka(G.z,G.v))):G.t="s";else G=l[H][W];if(h)y[X]||(y[X]=[]),y[X][V]&&y[X][V].z&&(G.z=y[X][V].z),y[X][V]=G;else{var Z=qn({c:V,r:X});y[Z]&&y[Z].z&&(G.z=y[Z].z),y[Z]=G}}}return F.s.c<1e7&&(y["!ref"]=yi(F)),y}function Eh(s,l){return U5(null,s,l)}function Tc(s,l){return l||(l=Tt(4)),l.write_shift(4,s),l}function xa(s){var l=s.read_shift(4);return 0===l?"":s.read_shift(l,"dbcs")}function js(s,l){var a=!1;return null==l&&(a=!0,l=Tt(4+2*s.length)),l.write_shift(4,s.length),s.length>0&&l.write_shift(0,s,"dbcs"),a?l.slice(0,l.l):l}function VF(s){return{ich:s.read_shift(2),ifnt:s.read_shift(2)}}function _2(s,l){var a=s.l,d=s.read_shift(1),h=xa(s),y=[],b={t:h,h};if(0!=(1&d)){for(var C=s.read_shift(4),I=0;I!=C;++I)y.push(VF(s));b.r=y}else b.r=[{ich:0,ifnt:0}];return s.l=a+l,b}var zF=_2;function Yl(s){var l=s.read_shift(4),a=s.read_shift(2);return a+=s.read_shift(1)<<16,s.l++,{c:l,iStyleRef:a}}function Qu(s,l){return null==l&&(l=Tt(8)),l.write_shift(-4,s.c),l.write_shift(3,s.iStyleRef||s.s),l.write_shift(1,0),l}function nu(s){var l=s.read_shift(2);return l+=s.read_shift(1)<<16,s.l++,{c:-1,iStyleRef:l}}function zf(s,l){return null==l&&(l=Tt(4)),l.write_shift(3,s.iStyleRef||s.s),l.write_shift(1,0),l}var WF=xa,H5=js;function iu(s){var l=s.read_shift(4);return 0===l||4294967295===l?"":s.read_shift(l,"dbcs")}function pg(s,l){var a=!1;return null==l&&(a=!0,l=Tt(127)),l.write_shift(4,s.length>0?s.length:4294967295),s.length>0&&l.write_shift(0,s,"dbcs"),a?l.slice(0,l.l):l}var Vs=xa,hg=iu,r1=pg;function o1(s){var l=s.slice(s.l,s.l+4),a=1&l[0],d=2&l[0];s.l+=4;var h=0===d?ba([0,0,0,0,252&l[0],l[1],l[2],l[3]],0):Ud(l,0)>>2;return a?h/100:h}function s1(s,l){null==l&&(l=Tt(4));var a=0,d=0,h=100*s;if(s==(0|s)&&s>=-(1<<29)&&s<1<<29?d=1:h==(0|h)&&h>=-(1<<29)&&h<1<<29&&(d=1,a=1),!d)throw new Error("unsupported RkNumber "+s);l.write_shift(-4,((a?h:s)<<2)+(a+2))}function a1(s){var l={s:{},e:{}};return l.s.r=s.read_shift(4),l.e.r=s.read_shift(4),l.s.c=s.read_shift(4),l.e.c=s.read_shift(4),l}var ru=a1,$f=function z5(s,l){return l||(l=Tt(16)),l.write_shift(4,s.s.r),l.write_shift(4,s.e.r),l.write_shift(4,s.s.c),l.write_shift(4,s.e.c),l};function Vr(s){if(s.length-s.l<8)throw"XLS Xnum Buffer underflow";return s.read_shift(8,"f")}function ou(s,l){return(l||Tt(8)).write_shift(8,s,"f")}function Wf(s,l){if(l||(l=Tt(8)),!s||s.auto)return l.write_shift(4,0),l.write_shift(4,0),l;null!=s.index?(l.write_shift(1,2),l.write_shift(1,s.index)):null!=s.theme?(l.write_shift(1,6),l.write_shift(1,s.theme)):(l.write_shift(1,5),l.write_shift(1,0));var a=s.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),l.write_shift(2,a),s.rgb&&null==s.theme){var d=s.rgb||"FFFFFF";"number"==typeof d&&(d=("000000"+d.toString(16)).slice(-6)),l.write_shift(1,parseInt(d.slice(0,2),16)),l.write_shift(1,parseInt(d.slice(2,4),16)),l.write_shift(1,parseInt(d.slice(4,6),16)),l.write_shift(1,255)}else l.write_shift(2,0),l.write_shift(1,0),l.write_shift(1,0);return l}function mg(s,l){var d=s.read_shift(4);switch(d){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[s.read_shift(4)]||""}if(d>400)throw new Error("Unsupported Clipboard: "+d.toString(16));return s.l-=4,s.read_shift(0,1==l?"lpstr":"lpwstr")}var f1=[80,81],p1={1:{n:"CodePage",t:2},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Sc={1:{n:"CodePage",t:2},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},h1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},m1=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ai(s){return s.map(function(l){return[l>>16&255,l>>8&255,255&l]})}var Wd=Bn(ai([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),su={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},b2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},_g={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},vg={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Qi(s,l){var h,a=function F5(s){for(var l=[],a=Gr(s),d=0;d!==a.length;++d)null==l[s[a[d]]]&&(l[s[a[d]]]=[]),l[s[a[d]]].push(a[d]);return l}(_g),d=[];d[d.length]=br,d[d.length]=Jt("Types",null,{xmlns:is_CT,"xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":is_xsi}),d=d.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(I){return Jt("Default",null,{Extension:I[0],ContentType:I[1]})}));var y=function(I){s[I]&&s[I].length>0&&(d[d.length]=Jt("Override",null,{PartName:("/"==(h=s[I][0])[0]?"":"/")+h,ContentType:vg[I][l.bookType]||vg[I].xlsx}))},b=function(I){(s[I]||[]).forEach(function(F){d[d.length]=Jt("Override",null,{PartName:("/"==F[0]?"":"/")+F,ContentType:vg[I][l.bookType]||vg[I].xlsx})})},C=function(I){(s[I]||[]).forEach(function(F){d[d.length]=Jt("Override",null,{PartName:("/"==F[0]?"":"/")+F,ContentType:a[I][0]})})};return y("workbooks"),b("sheets"),b("charts"),C("themes"),["strs","styles"].forEach(y),["coreprops","extprops","custprops"].forEach(C),C("vba"),C("comments"),C("threadedcomments"),C("drawings"),b("metadata"),C("people"),d.length>2&&(d[d.length]="</Types>",d[1]=d[1].replace("/>",">")),d.join("")}var z={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xo(s){var l=s.lastIndexOf("/");return s.slice(0,l+1)+"_rels/"+s.slice(l+1)+".rels"}function Gf(s,l){var a={"!id":{}};if(!s)return a;"/"!==l.charAt(0)&&(l="/"+l);var d={};return(s.match(va)||[]).forEach(function(h){var y=Qn(h);if("<Relationship"===y[0]){var b={};b.Type=y.Type,b.Target=y.Target,b.Id=y.Id,y.TargetMode&&(b.TargetMode=y.TargetMode);var C="External"===y.TargetMode?y.Target:ig(y.Target,l);a[C]=b,d[y.Id]=b}}),a["!id"]=d,a}function Ec(s){var l=[br,Jt("Relationships",null,{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"})];return Gr(s["!id"]).forEach(function(a){l[l.length]=Jt("Relationship",null,s["!id"][a])}),l.length>2&&(l[l.length]="</Relationships>",l[1]=l[1].replace("/>",">")),l.join("")}function Ni(s,l,a,d,h,y){if(h||(h={}),s["!id"]||(s["!id"]={}),s["!idx"]||(s["!idx"]=1),l<0)for(l=s["!idx"];s["!id"]["rId"+l];++l);if(s["!idx"]=l+1,h.Id="rId"+l,h.Type=d,h.Target=a,y?h.TargetMode=y:[z.HLINK,z.XPATH,z.XMISS].indexOf(h.Type)>-1&&(h.TargetMode="External"),s["!id"][h.Id])throw new Error("Cannot rewrite rId "+l);return s["!id"][h.Id]=h,s[("/"+h.Target).replace("//","/")]=h,l}function x2(s,l,a){return['  <rdf:Description rdf:about="'+s+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+l+'"/>\n',"  </rdf:Description>\n"].join("")}function yg(s,l){return['  <rdf:Description rdf:about="'+s+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+l+'"/>\n',"  </rdf:Description>\n"].join("")}function Zs(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+fi_version+"</meta:generator></office:meta></office:document-meta>"}var Vo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],w2=function(){for(var s=new Array(Vo.length),l=0;l<Vo.length;++l){var a=Vo[l],d="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);s[l]=new RegExp("<"+d+"[^>]*>([\\s\\S]*?)</"+d+">")}return s}();function qd(s){var l={};s=_n(s);for(var a=0;a<Vo.length;++a){var d=Vo[a],h=s.match(w2[a]);null!=h&&h.length>0&&(l[d[1]]=lr(h[1])),"date"===d[2]&&l[d[1]]&&(l[d[1]]=Kn(l[d[1]]))}return l}function Xl(s,l,a,d,h){null!=h[s]||null==l||""===l||(h[s]=l,l=Vt(l),d[d.length]=a?Jt(s,l,a):Xs(s,l))}function C2(s,l){var a=l||{},d=[br,Jt("cp:coreProperties",null,{"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":is_xsi})],h={};if(!s&&!a.Props)return d.join("");s&&(null!=s.CreatedDate&&Xl("dcterms:created","string"==typeof s.CreatedDate?s.CreatedDate:Q_(s.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},d,h),null!=s.ModifiedDate&&Xl("dcterms:modified","string"==typeof s.ModifiedDate?s.ModifiedDate:Q_(s.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},d,h));for(var y=0;y!=Vo.length;++y){var b=Vo[y],C=a.Props&&null!=a.Props[b[1]]?a.Props[b[1]]:s?s[b[1]]:null;!0===C?C="1":!1===C?C="0":"number"==typeof C&&(C=String(C)),null!=C&&Xl(b[0],C,null,d,h)}return d.length>2&&(d[d.length]="</cp:coreProperties>",d[1]=d[1].replace("/>",">")),d.join("")}var Ju=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],T2=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function S2(s,l,a,d){var h=[];if("string"==typeof s)h=ml(s,d);else for(var y=0;y<s.length;++y)h=h.concat(s[y].map(function(O){return{v:O}}));var b="string"==typeof l?ml(l,d).map(function(O){return O.v}):l,C=0,I=0;if(b.length>0)for(var F=0;F!==h.length;F+=2){switch(I=+h[F+1].v,h[F].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":a.Worksheets=I,a.SheetNames=b.slice(C,C+I);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":a.NamedRanges=I,a.DefinedNames=b.slice(C,C+I);break;case"Charts":case"Diagramme":a.Chartsheets=I,a.ChartNames=b.slice(C,C+I)}C+=I}}function xg(s){var l=[],a=Jt;return s||(s={}),s.Application="SheetJS",l[l.length]=br,l[l.length]=Jt("Properties",null,{xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":is_vt}),Ju.forEach(function(d){if(void 0!==s[d[1]]){var h;switch(d[2]){case"string":h=Vt(String(s[d[1]]));break;case"bool":h=s[d[1]]?"true":"false"}void 0!==h&&(l[l.length]=a(d[0],h))}}),l[l.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(s.Worksheets))),{size:2,baseType:"variant"})),l[l.length]=a("TitlesOfParts",a("vt:vector",s.SheetNames.map(function(d){return"<vt:lpstr>"+Vt(d)+"</vt:lpstr>"}).join(""),{size:s.Worksheets,baseType:"lpstr"})),l.length>2&&(l[l.length]="</Properties>",l[1]=l[1].replace("/>",">")),l.join("")}var E2=/<[^>]+>[^<]*/g;function k2(s){var l=[br,Jt("Properties",null,{xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties","xmlns:vt":is_vt})];if(!s)return l.join("");var a=1;return Gr(s).forEach(function(h){++a,l[l.length]=Jt("property",function V5(s,l){switch(typeof s){case"string":var a=Jt("vt:lpwstr",Vt(s));return l&&(a=a.replace(/&quot;/g,"_x0022_")),a;case"number":return Jt((0|s)==s?"vt:i4":"vt:r8",Vt(String(s)));case"boolean":return Jt("vt:bool",s?"true":"false")}if(s instanceof Date)return Jt("vt:filetime",Q_(s));throw new Error("Unable to serialize "+s)}(s[h],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:Vt(h)})}),l.length>2&&(l[l.length]="</Properties>",l[1]=l[1].replace("/>",">")),l.join("")}var Kf,wg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function D2(s,l,a){Kf||(Kf=xh(wg)),s[l=Kf[l]||l]=a}function Cg(s){var l=s.read_shift(4),a=s.read_shift(4);return new Date(1e3*(a/1e7*Math.pow(2,32)+l/1e7-11644473600)).toISOString().replace(/\.000/,"")}function M2(s,l,a){var d=s.l,h=s.read_shift(0,"lpstr-cp");if(a)for(;s.l-d&3;)++s.l;return h}function F2(s,l,a){var d=s.read_shift(0,"lpwstr");return a&&(s.l+=4-(d.length+1&3)&3),d}function ea(s,l,a){return 31===l?F2(s):M2(s,0,a)}function kc(s,l,a){return ea(s,l,!1===a?0:4)}function O2(s){var l=s.l,a=Gd(s,81);return 0==s[s.l]&&0==s[s.l+1]&&s.l-l&2&&(s.l+=2),[a,Gd(s,3)]}function N2(s,l){for(var a=s.read_shift(4),d={},h=0;h!=a;++h){var y=s.read_shift(4),b=s.read_shift(4);d[y]=s.read_shift(b,1200===l?"utf16le":"utf8").replace(Ns,"").replace(_h,"!"),1200===l&&b%2&&(s.l+=2)}return 3&s.l&&(s.l=s.l>>3<<2),d}function L2(s){var l=s.read_shift(4),a=s.slice(s.l,s.l+l);return s.l+=l,(3&l)>0&&(s.l+=4-(3&l)&3),a}function Gd(s,l,a){var h,d=s.read_shift(2),y=a||{};if(s.l+=2,12!==l&&d!==l&&-1===f1.indexOf(l)&&(4126!=(65534&l)||4126!=(65534&d)))throw new Error("Expected type "+l+" saw "+d);switch(12===l?d:l){case 2:return h=s.read_shift(2,"i"),y.raw||(s.l+=2),h;case 3:return s.read_shift(4,"i");case 11:return 0!==s.read_shift(4);case 19:return s.read_shift(4);case 30:return M2(s,0,4).replace(Ns,"");case 31:return F2(s);case 64:return Cg(s);case 65:return L2(s);case 71:return function Sg(s){var l={};return l.Size=s.read_shift(4),s.l+=l.Size+3-(l.Size-1)%4,l}(s);case 80:return kc(s,d,!y.raw).replace(Ns,"");case 81:return function To(s,l){if(!l)throw new Error("VtUnalignedString must have positive length");return ea(s,l,0)}(s,d).replace(Ns,"");case 4108:return function Y5(s){for(var l=s.read_shift(4),a=[],d=0;d<l/2;++d)a.push(O2(s));return a}(s);case 4126:case 4127:return 4127==d?function P2(s){for(var l=s.read_shift(4),a=[],d=0;d!=l;++d){var h=s.l;a[d]=s.read_shift(0,"lpwstr").replace(Ns,""),s.l-h&2&&(s.l+=2)}return a}(s):function K5(s){for(var l=s.read_shift(4),a=[],d=0;d!=l;++d)a[d]=s.read_shift(0,"lpstr-cp").replace(Ns,"");return a}(s);default:throw new Error("TypedPropertyValue unrecognized type "+l+" "+d)}}function Dh(s,l){var a=Tt(4),d=Tt(4);switch(a.write_shift(4,80==s?31:s),s){case 3:d.write_shift(-4,l);break;case 5:(d=Tt(8)).write_shift(8,l,"f");break;case 11:d.write_shift(4,l?1:0);break;case 64:d=function Tg(s){var a=("string"==typeof s?new Date(Date.parse(s)):s).getTime()/1e3+11644473600,d=a%Math.pow(2,32),h=(a-d)/Math.pow(2,32);h*=1e7;var y=(d*=1e7)/Math.pow(2,32)|0;y>0&&(d%=Math.pow(2,32),h+=y);var b=Tt(8);return b.write_shift(4,d),b.write_shift(4,h),b}(l);break;case 31:case 80:for((d=Tt(4+2*(l.length+1)+(l.length%2?0:2))).write_shift(4,l.length+1),d.write_shift(0,l,"dbcs");d.l!=d.length;)d.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+s+" "+l)}return es([a,d])}function Eg(s,l){var a=s.l,d=s.read_shift(4),h=s.read_shift(4),y=[],b=0,C=0,I=-1,F={};for(b=0;b!=h;++b){var O=s.read_shift(4),H=s.read_shift(4);y[b]=[O,H+a]}y.sort(function(ge,le){return ge[1]-le[1]});var W={};for(b=0;b!=h;++b){if(s.l!==y[b][1]){var G=!0;if(b>0&&l)switch(l[y[b-1][0]].t){case 2:s.l+2===y[b][1]&&(s.l+=2,G=!1);break;case 80:case 4108:s.l<=y[b][1]&&(s.l=y[b][1],G=!1)}if((!l||0==b)&&s.l<=y[b][1]&&(G=!1,s.l=y[b][1]),G)throw new Error("Read Error: Expected address "+y[b][1]+" at "+s.l+" :"+b)}if(l){var X=l[y[b][0]];if(W[X.n]=Gd(s,X.t,{raw:!0}),"version"===X.p&&(W[X.n]=String(W[X.n]>>16)+"."+("0000"+String(65535&W[X.n])).slice(-4)),"CodePage"==X.n)switch(W[X.n]){case 0:W[X.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Io(C=W[X.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+W[X.n])}}else if(1===y[b][0]){if(C=W.CodePage=Gd(s,2),Io(C),-1!==I){var V=s.l;s.l=y[I][1],F=N2(s,C),s.l=V}}else if(0===y[b][0]){if(0===C){I=b,s.l=y[b+1][1];continue}F=N2(s,C)}else{var he,Z=F[y[b][0]];switch(s[s.l]){case 65:s.l+=4,he=L2(s);break;case 30:case 31:s.l+=4,he=kc(s,s[s.l-4]).replace(/\u0000+$/,"");break;case 3:s.l+=4,he=s.read_shift(4,"i");break;case 19:s.l+=4,he=s.read_shift(4);break;case 5:s.l+=4,he=s.read_shift(8,"f");break;case 11:s.l+=4,he=Fo(s,4);break;case 64:s.l+=4,he=Kn(Cg(s));break;default:throw new Error("unparsed value: "+s[s.l])}W[Z]=he}}return s.l=a+d,W}var x1=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function X5(s){switch(typeof s){case"boolean":return 11;case"number":return(0|s)==s?3:5;case"string":return 31;case"object":if(s instanceof Date)return 64}return-1}function au(s,l,a){var d=Tt(8),h=[],y=[],b=8,C=0,I=Tt(8),F=Tt(8);if(I.write_shift(4,2),I.write_shift(4,1200),F.write_shift(4,1),y.push(I),h.push(F),b+=8+I.length,!l){(F=Tt(8)).write_shift(4,0),h.unshift(F);var O=[Tt(4)];for(O[0].write_shift(4,s.length),C=0;C<s.length;++C){var H=s[C][0];for((I=Tt(8+2*(H.length+1)+(H.length%2?0:2))).write_shift(4,C+2),I.write_shift(4,H.length+1),I.write_shift(0,H,"dbcs");I.l!=I.length;)I.write_shift(1,0);O.push(I)}I=es(O),y.unshift(I),b+=8+I.length}for(C=0;C<s.length;++C)if((!l||l[s[C][0]])&&!(x1.indexOf(s[C][0])>-1||T2.indexOf(s[C][0])>-1)&&null!=s[C][1]){var W=s[C][1],G=0;if(l){var X=a[G=+l[s[C][0]]];if("version"==X.p&&"string"==typeof W){var V=W.split(".");W=(+V[0]<<16)+(+V[1]||0)}I=Dh(X.t,W)}else{var Z=X5(W);-1==Z&&(Z=31,W=String(W)),I=Dh(Z,W)}y.push(I),(F=Tt(8)).write_shift(4,l?G:2+C),h.push(F),b+=8+I.length}var he=8*(y.length+1);for(C=0;C<y.length;++C)h[C].write_shift(4,he),he+=y[C].length;return d.write_shift(4,b),d.write_shift(4,y.length),es([d].concat(h).concat(y))}function Yf(s,l,a){var d=s.content;if(!d)return{};yo(d,0);var h,y,b,C,I=0;d.chk("feff","Byte Order: "),d.read_shift(2);var F=d.read_shift(4),O=d.read_shift(16);if(O!==In.utils.consts.HEADER_CLSID&&O!==a)throw new Error("Bad PropertySet CLSID "+O);if(1!==(h=d.read_shift(4))&&2!==h)throw new Error("Unrecognized #Sets: "+h);if(y=d.read_shift(16),C=d.read_shift(4),1===h&&C!==d.l)throw new Error("Length mismatch: "+C+" !== "+d.l);2===h&&(b=d.read_shift(16),I=d.read_shift(4));var X,H=Eg(d,l),W={SystemIdentifier:F};for(var G in H)W[G]=H[G];if(W.FMTID=y,1===h)return W;if(I-d.l==2&&(d.l+=2),d.l!==I)throw new Error("Length mismatch 2: "+d.l+" !== "+I);try{X=Eg(d,null)}catch(V){}for(G in X)W[G]=X[G];return W.FMTID=[y,b],W}function R2(s,l,a,d,h,y){var b=Tt(h?68:48),C=[b];b.write_shift(2,65534),b.write_shift(2,0),b.write_shift(4,842412599),b.write_shift(16,In.utils.consts.HEADER_CLSID,"hex"),b.write_shift(4,h?2:1),b.write_shift(16,l,"hex"),b.write_shift(4,h?68:48);var I=au(s,a,d);if(C.push(I),h){var F=au(h,null,null);b.write_shift(16,y,"hex"),b.write_shift(4,68+I.length),C.push(F)}return es(C)}function Zu(s,l){return s.read_shift(l),null}function Fo(s,l){return 1===s.read_shift(l)}function wa(s,l){return l||(l=Tt(2)),l.write_shift(2,+!!s),l}function os(s){return s.read_shift(2,"u")}function Ql(s,l){return l||(l=Tt(2)),l.write_shift(2,s),l}function Ah(s,l){return function w1(s,l,a){for(var d=[],h=s.l+l;s.l<h;)d.push(a(s,h-s.l));if(h!==s.l)throw new Error("Slurp error");return d}(s,l,os)}function kg(s,l,a){return a||(a=Tt(2)),a.write_shift(1,"e"==l?+s:+!!s),a.write_shift(1,"e"==l?1:0),a}function ed(s,l,a){var d=s.read_shift(a&&a.biff>=12?2:1),h="sbcs-cont",y=Do;a&&a.biff>=8&&(Do=1200),a&&8!=a.biff?12==a.biff&&(h="wstr"):s.read_shift(1)&&(h="dbcs-cont"),a.biff>=2&&a.biff<=5&&(h="cpstr");var C=d?s.read_shift(d,h):"";return Do=y,C}function j2(s){var l=Do;Do=1200;var I,a=s.read_shift(2),d=s.read_shift(1),h=4&d,y=8&d,b=1+(1&d),C=0,F={};y&&(C=s.read_shift(2)),h&&(I=s.read_shift(4));var H=0===a?"":s.read_shift(a,2==b?"dbcs-cont":"sbcs-cont");return y&&(s.l+=4*C),h&&(s.l+=I),F.t=H,y||(F.raw="<t>"+F.t+"</t>",F.r=F.t),Do=l,F}function V2(s){var l=s.t||"",d=Tt(3);d.write_shift(2,l.length),d.write_shift(1,1);var h=Tt(2*l.length);return h.write_shift(2*l.length,l,"utf16le"),es([d,h])}function bl(s,l,a){if(a){if(a.biff>=2&&a.biff<=5)return s.read_shift(l,"cpstr");if(a.biff>=12)return s.read_shift(l,"dbcs-cont")}var h=s.read_shift(1);return s.read_shift(l,0===h?"sbcs-cont":"dbcs-cont")}function Mh(s,l,a){var d=s.read_shift(a&&2==a.biff?1:2);return 0===d?(s.l++,""):bl(s,d,a)}function xl(s,l,a){if(a.biff>5)return Mh(s,0,a);var d=s.read_shift(1);return 0===d?(s.l++,""):s.read_shift(d,a.biff<=4||!s.lens?"cpstr":"sbcs-cont")}function Dg(s,l,a){return a||(a=Tt(3+2*s.length)),a.write_shift(2,s.length),a.write_shift(1,1),a.write_shift(31,s,"utf16le"),a}function Ag(s){var l=s.read_shift(4);return l>0?s.read_shift(l,"utf16le").replace(Ns,""):""}function z2(s,l){l||(l=Tt(6+2*s.length)),l.write_shift(4,1+s.length);for(var a=0;a<s.length;++a)l.write_shift(2,s.charCodeAt(a));return l.write_shift(2,0),l}function C1(s){var l=Tt(512),a=0,d=s.Target;"file://"==d.slice(0,7)&&(d=d.slice(7));var h=d.indexOf("#"),y=h>-1?31:23;switch(d.charAt(0)){case"#":y=28;break;case".":y&=-3}l.write_shift(4,2),l.write_shift(4,y);var b=[8,6815827,6619237,4849780,83];for(a=0;a<b.length;++a)l.write_shift(4,b[a]);if(28==y)z2(d=d.slice(1),l);else if(2&y){for(b="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<b.length;++a)l.write_shift(1,parseInt(b[a],16));var C=h>-1?d.slice(0,h):d;for(l.write_shift(4,2*(C.length+1)),a=0;a<C.length;++a)l.write_shift(2,C.charCodeAt(a));l.write_shift(2,0),8&y&&z2(h>-1?d.slice(h+1):"",l)}else{for(b="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<b.length;++a)l.write_shift(1,parseInt(b[a],16));for(var I=0;"../"==d.slice(3*I,3*I+3)||"..\\"==d.slice(3*I,3*I+3);)++I;for(l.write_shift(2,I),l.write_shift(4,d.length-3*I+1),a=0;a<d.length-3*I;++a)l.write_shift(1,255&d.charCodeAt(a+3*I));for(l.write_shift(1,0),l.write_shift(2,65535),l.write_shift(2,57005),a=0;a<6;++a)l.write_shift(4,0)}return l.slice(0,l.l)}function Mg(s){return[s.read_shift(1),s.read_shift(1),s.read_shift(1),s.read_shift(1)]}function Ph(s,l){var a=Mg(s);return a[3]=0,a}function Xa(s){return{r:s.read_shift(2),c:s.read_shift(2),ixfe:s.read_shift(2)}}function Kd(s,l,a,d){return d||(d=Tt(6)),d.write_shift(2,s),d.write_shift(2,l),d.write_shift(2,a||0),d}function q2(s,l,a){var d=a.biff>8?4:2;return[s.read_shift(d),s.read_shift(d,"i"),s.read_shift(d,"i")]}function T1(s){return[s.read_shift(2),o1(s)]}function Fg(s){var l=s.read_shift(2),a=s.read_shift(2);return{s:{c:s.read_shift(2),r:l},e:{c:s.read_shift(2),r:a}}}function Oh(s,l){return l||(l=Tt(8)),l.write_shift(2,s.s.r),l.write_shift(2,s.e.r),l.write_shift(2,s.s.c),l.write_shift(2,s.e.c),l}function Xf(s){var l=s.read_shift(2),a=s.read_shift(2);return{s:{c:s.read_shift(1),r:l},e:{c:s.read_shift(1),r:a}}}var J5=Xf;function S1(s){s.l+=4;var l=s.read_shift(2),a=s.read_shift(2),d=s.read_shift(2);return s.l+=12,[a,l,d]}function hr(s){s.l+=2,s.l+=s.read_shift(2)}var E1={0:hr,4:hr,5:hr,6:hr,7:function Qf(s){return s.l+=4,s.cf=s.read_shift(2),{}},8:hr,9:hr,10:hr,11:hr,12:hr,13:function G2(s){var l={};return s.l+=4,s.l+=16,l.fSharedNote=s.read_shift(2),s.l+=4,l},14:hr,15:hr,16:hr,17:hr,18:hr,19:hr,20:hr,21:S1};function lu(s,l){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=s.read_shift(2),(l-=2)>=2&&(a.dt=s.read_shift(2),s.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(l>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return s.read_shift(l),a}function td(s,l,a){var d=1536,h=16;switch(a.bookType){case"biff8":case"xla":break;case"biff5":d=1280,h=8;break;case"biff4":d=4,h=6;break;case"biff3":d=3,h=6;break;case"biff2":d=2,h=4;break;default:throw new Error("unsupported BIFF version")}var y=Tt(h);return y.write_shift(2,d),y.write_shift(2,l),h>4&&y.write_shift(2,29282),h>6&&y.write_shift(2,1997),h>8&&(y.write_shift(2,49161),y.write_shift(2,1),y.write_shift(2,1798),y.write_shift(2,0)),y}function Z5(s,l){var a=!l||l.biff>=8?2:1,d=Tt(8+a*s.name.length);d.write_shift(4,s.pos),d.write_shift(1,s.hs||0),d.write_shift(1,s.dt),d.write_shift(1,s.name.length),l.biff>=8&&d.write_shift(1,1),d.write_shift(a*s.name.length,s.name,l.biff<8?"sbcs":"utf16le");var h=d.slice(0,d.l);return h.l=d.l,h}function tE(s,l,a){var d=0;a&&2==a.biff||(d=s.read_shift(2));var h=s.read_shift(2);return a&&2==a.biff&&(d=1-(h>>15),h&=32767),[{Unsynced:1&d,DyZero:(2&d)>>1,ExAsc:(4&d)>>2,ExDsc:(8&d)>>3},h]}function Bh(s,l,a,d){var h=a&&5==a.biff;d||(d=Tt(h?3+l.length:5+2*l.length)),d.write_shift(2,s),d.write_shift(h?1:2,l.length),h||d.write_shift(1,1),d.write_shift((h?1:2)*l.length,l,h?"sbcs":"utf16le");var y=d.length>d.l?d.slice(0,d.l):d;return null==y.l&&(y.l=y.length),y}var X2=xl;function Q2(s,l,a){var d=s.l+l,h=8!=a.biff&&a.biff?2:4,y=s.read_shift(h),b=s.read_shift(h),C=s.read_shift(2),I=s.read_shift(2);return s.l=d,{s:{r:y,c:C},e:{r:b,c:I}}}function Yd(s,l,a,d){var h=a&&5==a.biff;d||(d=Tt(h?16:20)),d.write_shift(2,0),s.style?(d.write_shift(2,s.numFmtId||0),d.write_shift(2,65524)):(d.write_shift(2,s.numFmtId||0),d.write_shift(2,l<<4));var y=0;return s.numFmtId>0&&h&&(y|=1024),d.write_shift(4,y),d.write_shift(4,0),h||d.write_shift(4,0),d.write_shift(2,0),d}function ex(s,l,a){var d=Xa(s);(2==a.biff||9==l)&&++s.l;var h=function B2(s){var l=s.read_shift(1);return 1===s.read_shift(1)?l:1===l}(s);return d.val=h,d.t=!0===h||!1===h?"b":"e",d}var tx=function W2(s,l,a){return 0===l?"":xl(s,0,a)};function Og(s,l,a){var h,d=s.read_shift(2),y={fBuiltIn:1&d,fWantAdvise:d>>>1&1,fWantPict:d>>>2&1,fOle:d>>>3&1,fOleLink:d>>>4&1,cf:d>>>5&1023,fIcon:d>>>15&1};return 14849===a.sbcch&&(h=function Q5(s,l,a){s.l+=4;var d=s.l+(l-=4),h=ed(s,0,a),y=s.read_shift(2);if(y!==(d-=s.l))throw new Error("Malformed AddinUdf: padding = "+d+" != "+y);return s.l+=y,h}(s,l-2,a)),y.body=h||s.read_shift(l-2),"string"==typeof h&&(y.Name=h),y}var Ng=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function aE(s,l,a){var d=s.l+l,h=s.read_shift(2),y=s.read_shift(1),b=s.read_shift(1),C=s.read_shift(a&&2==a.biff?1:2),I=0;(!a||a.biff>=5)&&(5!=a.biff&&(s.l+=2),I=s.read_shift(2),5==a.biff&&(s.l+=2),s.l+=4);var F=bl(s,b,a);32&h&&(F=Ng[F.charCodeAt(0)]);var O=d-s.l;a&&2==a.biff&&--O;var H=d!=s.l&&0!==C&&O>0?function M4(s,l,a,d){var b,h=s.l+l,y=fu(s,d,a);return h!==s.l&&(b=Ac(s,h-s.l,y,a)),[y,b]}(s,O,a,C):[];return{chKey:y,Name:F,itab:I,rgce:H}}function ep(s,l,a){if(a.biff<8)return function A1(s,l,a){3==s[s.l+1]&&s[s.l]++;var d=ed(s,0,a);return 3==d.charCodeAt(0)?d.slice(1):d}(s,0,a);for(var d=[],h=s.l+l,y=s.read_shift(a.biff>8?4:2);0!=y--;)d.push(q2(s,0,a));if(s.l!=h)throw new Error("Bad ExternSheet: "+s.l+" != "+h);return d}function ix(s,l,a){var d=J5(s,6);switch(a.biff){case 2:s.l++,l-=7;break;case 3:case 4:s.l+=2,l-=8;break;default:s.l+=6,l-=12}return[d,Sw(s,l,a)]}var zt={8:function(s,l){var a=s.l+l;s.l+=10;var d=s.read_shift(2);s.l+=4,s.l+=2,s.l+=2,s.l+=2,s.l+=4;var h=s.read_shift(1);return s.l+=h,s.l=a,{fmt:d}}};function Vh(s){var l=Tt(24),a=Xr(s[0]);l.write_shift(2,a.r),l.write_shift(2,a.r),l.write_shift(2,a.c),l.write_shift(2,a.c);for(var d="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),h=0;h<16;++h)l.write_shift(1,parseInt(d[h],16));return es([l,C1(s[1])])}function pE(s){var l=s[1].Tooltip,a=Tt(10+2*(l.length+1));a.write_shift(2,2048);var d=Xr(s[0]);a.write_shift(2,d.r),a.write_shift(2,d.r),a.write_shift(2,d.c),a.write_shift(2,d.c);for(var h=0;h<l.length;++h)a.write_shift(2,l.charCodeAt(h));return a.write_shift(2,0),a}function cx(s,l,a){if(!a.cellStyles)return qi(s,l);var d=a&&a.biff>=12?4:2,h=s.read_shift(d),y=s.read_shift(d),b=s.read_shift(d),C=s.read_shift(d),I=s.read_shift(2);2==d&&(s.l+=2);var F={s:h,e:y,w:b,ixfe:C,flags:I};return(a.biff>=5||!a.biff)&&(F.level=I>>8&7),F}var mE=Xa,gE=Ah,tp=Mh,jg=[2,3,48,49,131,139,140,245],zh=function(){var s={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},l=xh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function d(C,I){var F=I||{};F.dateNF||(F.dateNF="yyyymmdd");var O=Eh(function a(C,I){var F=[],O=Hl(1);switch(I.type){case"base64":O=ha(pa(C));break;case"binary":O=ha(C);break;case"buffer":case"array":O=C}yo(O,0);var H=O.read_shift(1),W=!!(136&H),G=!1,X=!1;switch(H){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:G=!0,W=!0;break;case 140:X=!0;break;default:throw new Error("DBF Unsupported Version: "+H.toString(16))}var V=0,Z=521;2==H&&(V=O.read_shift(2)),O.l+=3,2!=H&&(V=O.read_shift(4)),V>1048576&&(V=1e6),2!=H&&(Z=O.read_shift(2));var he=O.read_shift(2),ge=I.codepage||1252;2!=H&&(O.l+=16,O.read_shift(1),0!==O[O.l]&&(ge=s[O[O.l]]),O.l+=1,O.l+=2),X&&(O.l+=36);for(var le=[],Ke={},tt=Math.min(O.length,2==H?521:Z-10-(G?264:0)),ze=X?32:11;O.l<tt&&13!=O[O.l];)switch(Ke={},Ke.name=Pi.utils.decode(ge,O.slice(O.l,O.l+ze)).replace(/[\u0000\r\n].*$/g,""),O.l+=ze,Ke.type=String.fromCharCode(O.read_shift(1)),2!=H&&!X&&(Ke.offset=O.read_shift(4)),Ke.len=O.read_shift(1),2==H&&(Ke.offset=O.read_shift(2)),Ke.dec=O.read_shift(1),Ke.name.length&&le.push(Ke),2!=H&&(O.l+=X?13:14),Ke.type){case"B":(!G||8!=Ke.len)&&I.WTF&&console.log("Skipping "+Ke.name+":"+Ke.type);break;case"G":case"P":I.WTF&&console.log("Skipping "+Ke.name+":"+Ke.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+Ke.type)}if(13!==O[O.l]&&(O.l=Z-1),13!==O.read_shift(1))throw new Error("DBF Terminator not found "+O.l+" "+O[O.l]);O.l=Z;var be=0,Qe=0;for(F[0]=[],Qe=0;Qe!=le.length;++Qe)F[0][Qe]=le[Qe].name;for(;V-- >0;)if(42!==O[O.l])for(++O.l,F[++be]=[],Qe=0,Qe=0;Qe!=le.length;++Qe){var qe=O.slice(O.l,O.l+le[Qe].len);O.l+=le[Qe].len,yo(qe,0);var gt=Pi.utils.decode(ge,qe);switch(le[Qe].type){case"C":gt.trim().length&&(F[be][Qe]=gt.replace(/\s+$/,""));break;case"D":F[be][Qe]=8===gt.length?new Date(+gt.slice(0,4),+gt.slice(4,6)-1,+gt.slice(6,8)):gt;break;case"F":F[be][Qe]=parseFloat(gt.trim());break;case"+":case"I":F[be][Qe]=X?2147483648^qe.read_shift(-4,"i"):qe.read_shift(4,"i");break;case"L":switch(gt.trim().toUpperCase()){case"Y":case"T":F[be][Qe]=!0;break;case"N":case"F":F[be][Qe]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+gt+"|")}break;case"M":if(!W)throw new Error("DBF Unexpected MEMO for type "+H.toString(16));F[be][Qe]="##MEMO##"+(X?parseInt(gt.trim(),10):qe.read_shift(4));break;case"N":(gt=gt.replace(/\u0000/g,"").trim())&&"."!=gt&&(F[be][Qe]=+gt||0);break;case"@":F[be][Qe]=new Date(qe.read_shift(-8,"f")-621356832e5);break;case"T":F[be][Qe]=new Date(864e5*(qe.read_shift(4)-2440588)+qe.read_shift(4));break;case"Y":F[be][Qe]=qe.read_shift(4,"i")/1e4+qe.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":F[be][Qe]=-qe.read_shift(-8,"f");break;case"B":if(G&&8==le[Qe].len){F[be][Qe]=qe.read_shift(8,"f");break}case"G":case"P":qe.l+=le[Qe].len;break;case"0":if("_NullFlags"===le[Qe].name)break;default:throw new Error("DBF Unsupported data type "+le[Qe].type)}}else O.l+=he;if(2!=H&&O.l<O.length&&26!=O[O.l++])throw new Error("DBF EOF Marker missing "+(O.l-1)+" of "+O.length+" "+O[O.l-1].toString(16));return I&&I.sheetRows&&(F=F.slice(0,I.sheetRows)),I.DBF=le,F}(C,F),F);return O["!cols"]=F.DBF.map(function(H){return{wch:H.len,DBF:H}}),delete F.DBF,O}var y={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function h(C,I){try{return $d(d(C,I),I)}catch(F){if(I&&I.WTF)throw F}return{SheetNames:[],Sheets:{}}},to_sheet:d,from_sheet:function b(C,I){var F=I||{};if(+F.codepage>=0&&Io(+F.codepage),"string"==F.type)throw new Error("Cannot write DBF to JS string");var O=Vn(),H=g0(C,{header:1,raw:!0,cellDates:!0}),W=H[0],G=H.slice(1),X=C["!cols"]||[],V=0,Z=0,he=0,ge=1;for(V=0;V<W.length;++V)if(((X[V]||{}).DBF||{}).name)W[V]=X[V].DBF.name,++he;else if(null!=W[V]){if(++he,"number"==typeof W[V]&&(W[V]=W[V].toString(10)),"string"!=typeof W[V])throw new Error("DBF Invalid column name "+W[V]+" |"+typeof W[V]+"|");if(W.indexOf(W[V])!==V)for(Z=0;Z<1024;++Z)if(-1==W.indexOf(W[V]+"_"+Z)){W[V]+="_"+Z;break}}var le=Yi(C["!ref"]),Ke=[],tt=[],ze=[];for(V=0;V<=le.e.c-le.s.c;++V){var be="",Qe="",qe=0,gt=[];for(Z=0;Z<G.length;++Z)null!=G[Z][V]&&gt.push(G[Z][V]);if(0!=gt.length&&null!=W[V]){for(Z=0;Z<gt.length;++Z){switch(typeof gt[Z]){case"number":Qe="B";break;case"string":default:Qe="C";break;case"boolean":Qe="L";break;case"object":Qe=gt[Z]instanceof Date?"D":"C"}qe=Math.max(qe,String(gt[Z]).length),be=be&&be!=Qe?"C":Qe}qe>250&&(qe=250),"C"==(Qe=((X[V]||{}).DBF||{}).type)&&X[V].DBF.len>qe&&(qe=X[V].DBF.len),"B"==be&&"N"==Qe&&(be="N",ze[V]=X[V].DBF.dec,qe=X[V].DBF.len),tt[V]="C"==be||"N"==Qe?qe:y[be]||0,ge+=tt[V],Ke[V]=be}else Ke[V]="?"}var bt=O.next(32);for(bt.write_shift(4,318902576),bt.write_shift(4,G.length),bt.write_shift(2,296+32*he),bt.write_shift(2,ge),V=0;V<4;++V)bt.write_shift(4,0);for(bt.write_shift(4,0|(+l[Ks]||3)<<8),V=0,Z=0;V<W.length;++V)if(null!=W[V]){var et=O.next(32),Xt=(W[V].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);et.write_shift(1,Xt,"sbcs"),et.write_shift(1,"?"==Ke[V]?"C":Ke[V],"sbcs"),et.write_shift(4,Z),et.write_shift(1,tt[V]||y[Ke[V]]||0),et.write_shift(1,ze[V]||0),et.write_shift(1,2),et.write_shift(4,0),et.write_shift(1,0),et.write_shift(4,0),et.write_shift(4,0),Z+=tt[V]||y[Ke[V]]||0}var vn=O.next(264);for(vn.write_shift(4,13),V=0;V<65;++V)vn.write_shift(4,0);for(V=0;V<G.length;++V){var Zt=O.next(ge);for(Zt.write_shift(1,0),Z=0;Z<W.length;++Z)if(null!=W[Z])switch(Ke[Z]){case"L":Zt.write_shift(1,null==G[V][Z]?63:G[V][Z]?84:70);break;case"B":Zt.write_shift(8,G[V][Z]||0,"f");break;case"N":var Fn="0";for("number"==typeof G[V][Z]&&(Fn=G[V][Z].toFixed(ze[Z]||0)),he=0;he<tt[Z]-Fn.length;++he)Zt.write_shift(1,32);Zt.write_shift(1,Fn,"sbcs");break;case"D":G[V][Z]?(Zt.write_shift(4,("0000"+G[V][Z].getFullYear()).slice(-4),"sbcs"),Zt.write_shift(2,("00"+(G[V][Z].getMonth()+1)).slice(-2),"sbcs"),Zt.write_shift(2,("00"+G[V][Z].getDate()).slice(-2),"sbcs")):Zt.write_shift(8,"00000000","sbcs");break;case"C":var Dn=String(null!=G[V][Z]?G[V][Z]:"").slice(0,tt[Z]);for(Zt.write_shift(1,Dn,"sbcs"),he=0;he<tt[Z]-Dn.length;++he)Zt.write_shift(1,32)}}return O.next(1).write_shift(1,26),O.end()}}}(),Xd=function(){var s={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},l=new RegExp("\x1bN("+Gr(s).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(W,G){var X=s[G];return"number"==typeof X?hh(X):X},d=function(W,G,X){var V=G.charCodeAt(0)-32<<4|X.charCodeAt(0)-48;return 59==V?W:hh(V)};function y(W,G){var bt,X=W.split(/[\n\r]+/),V=-1,Z=-1,he=0,ge=0,le=[],Ke=[],tt=null,ze={},be=[],Qe=[],qe=[],gt=0;for(+G.codepage>=0&&Io(+G.codepage);he!==X.length;++he){gt=0;var Zt,et=X[he].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,d).replace(l,a),Xt=et.replace(/;;/g,"\0").split(";").map(function(Pe){return Pe.replace(/\u0000/g,";")});if(et.length>0)switch(Xt[0]){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==Xt[1].charAt(0)&&Ke.push(et.slice(3).replace(/;;/g,";"));break;case"C":var Fn=!1,Dn=!1,Li=!1,ln=!1,Mn=-1,Pt=-1;for(ge=1;ge<Xt.length;++ge)switch(Xt[ge].charAt(0)){case"A":case"G":break;case"X":Z=parseInt(Xt[ge].slice(1))-1,Dn=!0;break;case"Y":for(V=parseInt(Xt[ge].slice(1))-1,Dn||(Z=0),bt=le.length;bt<=V;++bt)le[bt]=[];break;case"K":'"'===(Zt=Xt[ge].slice(1)).charAt(0)?Zt=Zt.slice(1,Zt.length-1):"TRUE"===Zt?Zt=!0:"FALSE"===Zt?Zt=!1:isNaN(ql(Zt))?isNaN(si(Zt).getDate())||(Zt=Kn(Zt)):(Zt=ql(Zt),null!==tt&&Ku(tt)&&(Zt=ng(Zt))),void 0!==Pi&&"string"==typeof Zt&&"string"!=(G||{}).type&&(G||{}).codepage&&(Zt=Pi.utils.decode(G.codepage,Zt)),Fn=!0;break;case"E":ln=!0;var Ee=ad(Xt[ge].slice(1),{r:V,c:Z});le[V][Z]=[le[V][Z],Ee];break;case"S":Li=!0,le[V][Z]=[le[V][Z],"S5S"];break;case"R":Mn=parseInt(Xt[ge].slice(1))-1;break;case"C":Pt=parseInt(Xt[ge].slice(1))-1;break;default:if(G&&G.WTF)throw new Error("SYLK bad record "+et)}if(Fn&&(le[V][Z]&&2==le[V][Z].length?le[V][Z][0]=Zt:le[V][Z]=Zt,tt=null),Li){if(ln)throw new Error("SYLK shared formula cannot have own formula");var dt=Mn>-1&&le[Mn][Pt];if(!dt||!dt[1])throw new Error("SYLK shared formula cannot find base");le[V][Z][1]=J1(dt[1],{r:V-Mn,c:Z-Pt})}break;case"F":var Fe=0;for(ge=1;ge<Xt.length;++ge)switch(Xt[ge].charAt(0)){case"X":Z=parseInt(Xt[ge].slice(1))-1,++Fe;break;case"Y":for(V=parseInt(Xt[ge].slice(1))-1,bt=le.length;bt<=V;++bt)le[bt]=[];break;case"M":gt=parseInt(Xt[ge].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":tt=Ke[parseInt(Xt[ge].slice(1))];break;case"W":for(qe=Xt[ge].slice(1).split(" "),bt=parseInt(qe[0],10);bt<=parseInt(qe[1],10);++bt)gt=parseInt(qe[2],10),Qe[bt-1]=0===gt?{hidden:!0}:{wch:gt},od(Qe[bt-1]);break;case"C":Qe[Z=parseInt(Xt[ge].slice(1))-1]||(Qe[Z]={});break;case"R":be[V=parseInt(Xt[ge].slice(1))-1]||(be[V]={}),gt>0?(be[V].hpt=gt,be[V].hpx=Xh(gt)):0===gt&&(be[V].hidden=!0);break;default:if(G&&G.WTF)throw new Error("SYLK bad record "+et)}Fe<1&&(tt=null);break;default:if(G&&G.WTF)throw new Error("SYLK bad record "+et)}}return be.length>0&&(ze["!rows"]=be),Qe.length>0&&(ze["!cols"]=Qe),G&&G.sheetRows&&(le=le.slice(0,G.sheetRows)),[le,ze]}function b(W,G){var X=function h(W,G){switch(G.type){case"base64":return y(pa(W),G);case"binary":return y(W,G);case"buffer":return y(Oi&&Buffer.isBuffer(W)?W.toString("binary"):hc(W),G);case"array":return y(Zc(W),G)}throw new Error("Unrecognized type "+G.type)}(W,G),Z=X[1],he=Eh(X[0],G);return Gr(Z).forEach(function(ge){he[ge]=Z[ge]}),he}function I(W,G,X,V){var Z="C;Y"+(X+1)+";X"+(V+1)+";K";switch(W.t){case"n":Z+=W.v||0,W.f&&!W.F&&(Z+=";E"+rw(W.f,{r:X,c:V}));break;case"b":Z+=W.v?"TRUE":"FALSE";break;case"e":Z+=W.w||W.v;break;case"d":Z+='"'+(W.w||W.v)+'"';break;case"s":Z+='"'+W.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return Z}return s["|"]=254,{to_workbook:function C(W,G){return $d(b(W,G),G)},to_sheet:b,from_sheet:function H(W,G){var he,X=["ID;PWXL;N;E"],V=[],Z=Yi(W["!ref"]),ge=Array.isArray(W),le="\r\n";X.push("P;PGeneral"),X.push("F;P0;DG0G8;M255"),W["!cols"]&&function F(W,G){G.forEach(function(X,V){var Z="F;W"+(V+1)+" "+(V+1)+" ";X.hidden?Z+="0":("number"==typeof X.width&&!X.wpx&&(X.wpx=Kh(X.width)),"number"==typeof X.wpx&&!X.wch&&(X.wch=rd(X.wpx)),"number"==typeof X.wch&&(Z+=Math.round(X.wch)))," "!=Z.charAt(Z.length-1)&&W.push(Z)})}(X,W["!cols"]),W["!rows"]&&function O(W,G){G.forEach(function(X,V){var Z="F;";X.hidden?Z+="M0;":X.hpt?Z+="M"+20*X.hpt+";":X.hpx&&(Z+="M"+20*qg(X.hpx)+";"),Z.length>2&&W.push(Z+"R"+(V+1))})}(X,W["!rows"]),X.push("B;Y"+(Z.e.r-Z.s.r+1)+";X"+(Z.e.c-Z.s.c+1)+";D"+[Z.s.c,Z.s.r,Z.e.c,Z.e.r].join(" "));for(var Ke=Z.s.r;Ke<=Z.e.r;++Ke)for(var tt=Z.s.c;tt<=Z.e.c;++tt){var ze=qn({r:Ke,c:tt});(he=ge?(W[Ke]||[])[tt]:W[ze])&&(null!=he.v||he.f&&!he.F)&&V.push(I(he,0,Ke,tt))}return X.join(le)+le+V.join(le)+le+"E"+le}}}(),px=function(){function l(y,b){for(var C=y.split("\n"),I=-1,F=-1,O=0,H=[];O!==C.length;++O)if("BOT"!==C[O].trim()){if(!(I<0)){for(var W=C[O].trim().split(","),G=W[0],X=W[1],V=C[++O]||"";1&(V.match(/["]/g)||[]).length&&O<C.length-1;)V+="\n"+C[++O];switch(V=V.trim(),+G){case-1:if("BOT"===V){H[++I]=[],F=0;continue}if("EOD"!==V)throw new Error("Unrecognized DIF special command "+V);break;case 0:H[I][F]="TRUE"===V||"FALSE"!==V&&(isNaN(ql(X))?isNaN(si(X).getDate())?X:Kn(X):ql(X)),++F;break;case 1:(V=(V=V.slice(1,V.length-1)).replace(/""/g,'"'))&&V.match(/^=".*"$/)&&(V=V.slice(2,-1)),H[I][F++]=""!==V?V:null}if("EOD"===V)break}}else H[++I]=[],F=0;return b&&b.sheetRows&&(H=H.slice(0,b.sheetRows)),H}function a(y,b){return Eh(function s(y,b){switch(b.type){case"base64":return l(pa(y),b);case"binary":return l(y,b);case"buffer":return l(Oi&&Buffer.isBuffer(y)?y.toString("binary"):hc(y),b);case"array":return l(Zc(y),b)}throw new Error("Unrecognized type "+b.type)}(y,b),b)}return{to_workbook:function d(y,b){return $d(a(y,b),b)},to_sheet:a,from_sheet:function(){var y=function(I,F,O,H,W){I.push(F),I.push(O+","+H),I.push('"'+W.replace(/"/g,'""')+'"')},b=function(I,F,O,H){I.push(F+","+O),I.push(1==F?'"'+H.replace(/"/g,'""')+'"':H)};return function(I){var H,F=[],O=Yi(I["!ref"]),W=Array.isArray(I);y(F,"TABLE",0,1,"sheetjs"),y(F,"VECTORS",0,O.e.r-O.s.r+1,""),y(F,"TUPLES",0,O.e.c-O.s.c+1,""),y(F,"DATA",0,0,"");for(var G=O.s.r;G<=O.e.r;++G){b(F,-1,0,"BOT");for(var X=O.s.c;X<=O.e.c;++X){var V=qn({r:G,c:X});if(H=W?(I[G]||[])[X]:I[V])switch(H.t){case"n":var Z=H.w;!Z&&null!=H.v&&(Z=H.v),null==Z?b(F,1,0,H.f&&!H.F?"="+H.f:""):b(F,0,Z,"V");break;case"b":b(F,0,H.v?1:0,H.v?"TRUE":"FALSE");break;case"s":b(F,1,0,isNaN(H.v)?H.v:'="'+H.v+'"');break;case"d":H.w||(H.w=Ka(H.z||Wn[14],ns(Kn(H.v)))),b(F,0,H.w,"V");break;default:b(F,1,0,"")}else b(F,1,0,"")}}return b(F,-1,0,"EOD"),F.join("\r\n")}}()}}(),hx=function(){function s(H){return H.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function l(H){return H.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function d(H,W){return Eh(function a(H,W){for(var G=H.split("\n"),X=-1,V=-1,Z=0,he=[];Z!==G.length;++Z){var ge=G[Z].trim().split(":");if("cell"===ge[0]){var le=Xr(ge[1]);if(he.length<=le.r)for(X=he.length;X<=le.r;++X)he[X]||(he[X]=[]);switch(X=le.r,V=le.c,ge[2]){case"t":he[X][V]=s(ge[3]);break;case"v":he[X][V]=+ge[3];break;case"vtf":var Ke=ge[ge.length-1];case"vtc":he[X][V]="nl"===ge[3]?!!+ge[4]:+ge[4],"vtf"==ge[2]&&(he[X][V]=[he[X][V],Ke])}}}return W&&W.sheetRows&&(he=he.slice(0,W.sheetRows)),he}(H,W),W)}var y=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),b=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",C=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),I="--SocialCalcSpreadsheetControlSave--";function F(H){if(!H||!H["!ref"])return"";for(var X,W=[],G=[],V="",Z=no(H["!ref"]),he=Array.isArray(H),ge=Z.s.r;ge<=Z.e.r;++ge)for(var le=Z.s.c;le<=Z.e.c;++le)if(V=qn({r:ge,c:le}),(X=he?(H[ge]||[])[le]:H[V])&&null!=X.v&&"z"!==X.t){switch(G=["cell",V,"t"],X.t){case"s":case"str":G.push(l(X.v));break;case"n":X.f?(G[2]="vtf",G[3]="n",G[4]=X.v,G[5]=l(X.f)):(G[2]="v",G[3]=X.v);break;case"b":G[2]="vt"+(X.f?"f":"c"),G[3]="nl",G[4]=X.v?"1":"0",G[5]=l(X.f||(X.v?"TRUE":"FALSE"));break;case"d":var Ke=ns(Kn(X.v));G[2]="vtc",G[3]="nd",G[4]=""+Ke,G[5]=X.w||Ka(X.z||Wn[14],Ke);break;case"e":continue}W.push(G.join(":"))}return W.push("sheet:c:"+(Z.e.c-Z.s.c+1)+":r:"+(Z.e.r-Z.s.r+1)+":tvf:1"),W.push("valueformat:1:text-wiki"),W.join("\n")}return{to_workbook:function h(H,W){return $d(d(H,W),W)},to_sheet:d,from_sheet:function O(H){return[y,b,C,b,F(H),I].join("\n")}}}(),$h=function(){function s(O,H,W,G,X){X.raw?H[W][G]=O:""===O||(H[W][G]="TRUE"===O||"FALSE"!==O&&(isNaN(ql(O))?isNaN(si(O).getDate())?O:Kn(O):ql(O)))}var a={44:",",9:"\t",59:";",124:"|"},d={44:3,9:2,59:1,124:0};function h(O){for(var H={},W=!1,G=0,X=0;G<O.length;++G)34==(X=O.charCodeAt(G))?W=!W:!W&&X in a&&(H[X]=(H[X]||0)+1);for(G in X=[],H)Object.prototype.hasOwnProperty.call(H,G)&&X.push([H[G],G]);if(!X.length)for(G in H=d)Object.prototype.hasOwnProperty.call(H,G)&&X.push([H[G],G]);return X.sort(function(V,Z){return V[0]-Z[0]||d[V[1]]-d[Z[1]]}),a[X.pop()[1]]||44}function b(O,H){return!H||!H.PRN||H.FS||"sep="==O.slice(0,4)||O.indexOf("\t")>=0||O.indexOf(",")>=0||O.indexOf(";")>=0?function y(O,H){var W=H||{},G="",X=W.dense?[]:{},V={s:{c:0,r:0},e:{c:0,r:0}};"sep="==O.slice(0,4)?13==O.charCodeAt(5)&&10==O.charCodeAt(6)?(G=O.charAt(4),O=O.slice(7)):13==O.charCodeAt(5)||10==O.charCodeAt(5)?(G=O.charAt(4),O=O.slice(6)):G=h(O.slice(0,1024)):G=W&&W.FS?W.FS:h(O.slice(0,1024));var Z=0,he=0,ge=0,le=0,Ke=0,tt=G.charCodeAt(0),ze=!1,be=0,Qe=O.charCodeAt(0);O=O.replace(/\r\n/gm,"\n");var qe=null!=W.dateNF?function A5(s){var l="number"==typeof s?Wn[s]:s;return l=l.replace(_c,"(\\d+)"),new RegExp("^"+l+"$")}(W.dateNF):null;function gt(){var bt=O.slice(le,Ke),et={};if('"'==bt.charAt(0)&&'"'==bt.charAt(bt.length-1)&&(bt=bt.slice(1,-1).replace(/""/g,'"')),0===bt.length)et.t="z";else if(W.raw)et.t="s",et.v=bt;else if(0===bt.trim().length)et.t="s",et.v=bt;else if(61==bt.charCodeAt(0))34==bt.charCodeAt(1)&&34==bt.charCodeAt(bt.length-1)?(et.t="s",et.v=bt.slice(2,-1).replace(/""/g,'"')):function ow(s){return 1!=s.length}(bt)?(et.t="n",et.f=bt.slice(1)):(et.t="s",et.v=bt);else if("TRUE"==bt)et.t="b",et.v=!0;else if("FALSE"==bt)et.t="b",et.v=!1;else if(isNaN(ge=ql(bt)))if(!isNaN(si(bt).getDate())||qe&&bt.match(qe)){et.z=W.dateNF||Wn[14];var Xt=0;qe&&bt.match(qe)&&(bt=function ts(s,l,a){var d=-1,h=-1,y=-1,b=-1,C=-1,I=-1;(l.match(_c)||[]).forEach(function(H,W){var G=parseInt(a[W+1],10);switch(H.toLowerCase().charAt(0)){case"y":d=G;break;case"d":y=G;break;case"h":b=G;break;case"s":I=G;break;case"m":b>=0?C=G:h=G}}),I>=0&&-1==C&&h>=0&&(C=h,h=-1);var F=(""+(d>=0?d:(new Date).getFullYear())).slice(-4)+"-"+("00"+(h>=1?h:1)).slice(-2)+"-"+("00"+(y>=1?y:1)).slice(-2);7==F.length&&(F="0"+F),8==F.length&&(F="20"+F);var O=("00"+(b>=0?b:0)).slice(-2)+":"+("00"+(C>=0?C:0)).slice(-2)+":"+("00"+(I>=0?I:0)).slice(-2);return-1==b&&-1==C&&-1==I?F:-1==d&&-1==h&&-1==y?O:F+"T"+O}(0,W.dateNF,bt.match(qe)||[]),Xt=1),W.cellDates?(et.t="d",et.v=Kn(bt,Xt)):(et.t="n",et.v=ns(Kn(bt,Xt))),!1!==W.cellText&&(et.w=Ka(et.z,et.v instanceof Date?ns(et.v):et.v)),W.cellNF||delete et.z}else et.t="s",et.v=bt;else et.t="n",!1!==W.cellText&&(et.w=bt),et.v=ge;if("z"==et.t||(W.dense?(X[Z]||(X[Z]=[]),X[Z][he]=et):X[qn({c:he,r:Z})]=et),Qe=O.charCodeAt(le=Ke+1),V.e.c<he&&(V.e.c=he),V.e.r<Z&&(V.e.r=Z),be==tt)++he;else if(he=0,++Z,W.sheetRows&&W.sheetRows<=Z)return!0}e:for(;Ke<O.length;++Ke)switch(be=O.charCodeAt(Ke)){case 34:34===Qe&&(ze=!ze);break;case tt:case 10:case 13:if(!ze&&gt())break e}return Ke-le>0&&gt(),X["!ref"]=yi(V),X}(O,H):Eh(function l(O,H){var W=H||{},G=[];if(!O||0===O.length)return G;for(var X=O.split(/[\r\n]/),V=X.length-1;V>=0&&0===X[V].length;)--V;for(var Z=10,he=0,ge=0;ge<=V;++ge)-1==(he=X[ge].indexOf(" "))?he=X[ge].length:he++,Z=Math.max(Z,he);for(ge=0;ge<=V;++ge){G[ge]=[];var le=0;for(s(X[ge].slice(0,Z).trim(),G,ge,le,W),le=1;le<=(X[ge].length-Z)/10+1;++le)s(X[ge].slice(Z+10*(le-1),Z+10*le).trim(),G,ge,le,W)}return W.sheetRows&&(G=G.slice(0,W.sheetRows)),G}(O,H),H)}function C(O,H){var W="",G="string"==H.type?[0,0,0,0]:Zv(O,H);switch(H.type){case"base64":W=pa(O);break;case"binary":case"string":W=O;break;case"buffer":W=65001==H.codepage?O.toString("utf8"):H.codepage&&void 0!==Pi?Pi.utils.decode(H.codepage,O):Oi&&Buffer.isBuffer(O)?O.toString("binary"):hc(O);break;case"array":W=Zc(O);break;default:throw new Error("Unrecognized type "+H.type)}return 239==G[0]&&187==G[1]&&191==G[2]?W=_n(W.slice(3)):"string"!=H.type&&"buffer"!=H.type&&65001==H.codepage?W=_n(W):"binary"==H.type&&void 0!==Pi&&H.codepage&&(W=Pi.utils.decode(H.codepage,Pi.utils.encode(28591,W))),"socialcalc:version:"==W.slice(0,19)?hx.to_sheet("string"==H.type?W:_n(W),H):b(W,H)}return{to_workbook:function I(O,H){return $d(C(O,H),H)},to_sheet:C,from_sheet:function F(O){for(var G,H=[],W=Yi(O["!ref"]),X=Array.isArray(O),V=W.s.r;V<=W.e.r;++V){for(var Z=[],he=W.s.c;he<=W.e.c;++he){var ge=qn({r:V,c:he});if((G=X?(O[V]||[])[he]:O[ge])&&null!=G.v){for(var le=(G.w||(Cc(G),G.w)||"").slice(0,10);le.length<10;)le+=" ";Z.push(le+(0===he?" ":""))}else Z.push("          ")}H.push(Z.join(""))}return H.join("\n")}}}(),cu=function(){function s(Ee,dt,Fe){if(Ee){yo(Ee,Ee.l||0);for(var Pe=Fe.Enum||Mn;Ee.l<Ee.length;){var It=Ee.read_shift(2),sn=Pe[It]||Pe[65535],Yt=Ee.read_shift(2),Qt=Ee.l+Yt,Rt=sn.f&&sn.f(Ee,Yt,Fe);if(Ee.l=Qt,dt(Rt,sn,It))return}}}function a(Ee,dt){if(!Ee)return Ee;var Fe=dt||{},Pe=Fe.dense?[]:{},It="Sheet1",sn="",Yt=0,Qt={},Rt=[],gi=[],Se={s:{r:0,c:0},e:{r:0,c:0}},Tr=Fe.sheetRows||0;if(0==Ee[2]&&(8==Ee[3]||9==Ee[3])&&Ee.length>=16&&5==Ee[14]&&108===Ee[15])throw new Error("Unsupported Works 3 for Mac file");if(2==Ee[2])Fe.Enum=Mn,s(Ee,function(fn,Po,Il){switch(Il){case 0:Fe.vers=fn,fn>=4096&&(Fe.qpro=!0);break;case 6:Se=fn;break;case 204:fn&&(sn=fn);break;case 222:sn=fn;break;case 15:case 51:Fe.qpro||(fn[1].v=fn[1].v.slice(1));case 13:case 14:case 16:14==Il&&112==(112&fn[2])&&(15&fn[2])>1&&(15&fn[2])<15&&(fn[1].z=Fe.dateNF||Wn[14],Fe.cellDates&&(fn[1].t="d",fn[1].v=ng(fn[1].v))),Fe.qpro&&fn[3]>Yt&&(Pe["!ref"]=yi(Se),Qt[It]=Pe,Rt.push(It),Pe=Fe.dense?[]:{},Se={s:{r:0,c:0},e:{r:0,c:0}},Yt=fn[3],It=sn||"Sheet"+(Yt+1),sn="");var Nc=Fe.dense?(Pe[fn[0].r]||[])[fn[0].c]:Pe[qn(fn[0])];if(Nc){Nc.t=fn[1].t,Nc.v=fn[1].v,null!=fn[1].z&&(Nc.z=fn[1].z),null!=fn[1].f&&(Nc.f=fn[1].f);break}Fe.dense?(Pe[fn[0].r]||(Pe[fn[0].r]=[]),Pe[fn[0].r][fn[0].c]=fn[1]):Pe[qn(fn[0])]=fn[1]}},Fe);else{if(26!=Ee[2]&&14!=Ee[2])throw new Error("Unrecognized LOTUS BOF "+Ee[2]);Fe.Enum=Pt,14==Ee[2]&&(Fe.qpro=!0,Ee.l=0),s(Ee,function(fn,Po,Il){switch(Il){case 204:It=fn;break;case 22:fn[1].v=fn[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(fn[3]>Yt&&(Pe["!ref"]=yi(Se),Qt[It]=Pe,Rt.push(It),Pe=Fe.dense?[]:{},Se={s:{r:0,c:0},e:{r:0,c:0}},It="Sheet"+((Yt=fn[3])+1)),Tr>0&&fn[0].r>=Tr)break;Fe.dense?(Pe[fn[0].r]||(Pe[fn[0].r]=[]),Pe[fn[0].r][fn[0].c]=fn[1]):Pe[qn(fn[0])]=fn[1],Se.e.c<fn[0].c&&(Se.e.c=fn[0].c),Se.e.r<fn[0].r&&(Se.e.r=fn[0].r);break;case 27:fn[14e3]&&(gi[fn[14e3][0]]=fn[14e3][1]);break;case 1537:gi[fn[0]]=fn[1],fn[0]==Yt&&(It=fn[1])}},Fe)}if(Pe["!ref"]=yi(Se),Qt[sn||It]=Pe,Rt.push(sn||It),!gi.length)return{SheetNames:Rt,Sheets:Qt};for(var Hi={},Dr=[],zi=0;zi<gi.length;++zi)Qt[Rt[zi]]?(Dr.push(gi[zi]||Rt[zi]),Hi[gi[zi]]=Qt[gi[zi]]||Qt[Rt[zi]]):(Dr.push(gi[zi]),Hi[gi[zi]]={"!ref":"A1"});return{SheetNames:Dr,Sheets:Hi}}function F(Ee,dt,Fe){var Pe=[{c:0,r:0},{t:"n",v:0},0,0];return Fe.qpro&&20768!=Fe.vers?(Pe[0].c=Ee.read_shift(1),Pe[3]=Ee.read_shift(1),Pe[0].r=Ee.read_shift(2),Ee.l+=2):(Pe[2]=Ee.read_shift(1),Pe[0].c=Ee.read_shift(2),Pe[0].r=Ee.read_shift(2)),Pe}function O(Ee,dt,Fe){var Pe=Ee.l+dt,It=F(Ee,0,Fe);if(It[1].t="s",20768==Fe.vers){Ee.l++;var sn=Ee.read_shift(1);return It[1].v=Ee.read_shift(sn,"utf8"),It}return Fe.qpro&&Ee.l++,It[1].v=Ee.read_shift(Pe-Ee.l,"cstr"),It}function H(Ee,dt,Fe){var Pe=Tt(7+Fe.length);Pe.write_shift(1,255),Pe.write_shift(2,dt),Pe.write_shift(2,Ee),Pe.write_shift(1,39);for(var It=0;It<Pe.length;++It){var sn=Fe.charCodeAt(It);Pe.write_shift(1,sn>=128?95:sn)}return Pe.write_shift(1,0),Pe}function G(Ee,dt,Fe){var Pe=Tt(7);return Pe.write_shift(1,255),Pe.write_shift(2,dt),Pe.write_shift(2,Ee),Pe.write_shift(2,Fe,"i"),Pe}function V(Ee,dt,Fe){var Pe=Tt(13);return Pe.write_shift(1,255),Pe.write_shift(2,dt),Pe.write_shift(2,Ee),Pe.write_shift(8,Fe,"f"),Pe}function he(Ee,dt,Fe){var Pe=32768&dt;return dt=(Pe?Ee:0)+((dt&=-32769)>=8192?dt-16384:dt),(Pe?"":"$")+(Fe?to(dt):jr(dt))}var ge={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},le=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function tt(Ee){var dt=[{c:0,r:0},{t:"n",v:0},0];return dt[0].r=Ee.read_shift(2),dt[3]=Ee[Ee.l++],dt[0].c=Ee[Ee.l++],dt}function be(Ee,dt,Fe,Pe){var It=Tt(6+Pe.length);It.write_shift(2,Ee),It.write_shift(1,Fe),It.write_shift(1,dt),It.write_shift(1,39);for(var sn=0;sn<Pe.length;++sn){var Yt=Pe.charCodeAt(sn);It.write_shift(1,Yt>=128?95:Yt)}return It.write_shift(1,0),It}function qe(Ee,dt){var Fe=tt(Ee),Pe=Ee.read_shift(4),It=Ee.read_shift(4),sn=Ee.read_shift(2);if(65535==sn)return 0===Pe&&3221225472===It?(Fe[1].t="e",Fe[1].v=15):0===Pe&&3489660928===It?(Fe[1].t="e",Fe[1].v=42):Fe[1].v=0,Fe;var Yt=32768&sn;return sn=(32767&sn)-16446,Fe[1].v=(1-2*Yt)*(It*Math.pow(2,sn+32)+Pe*Math.pow(2,sn)),Fe}function gt(Ee,dt,Fe,Pe){var It=Tt(14);if(It.write_shift(2,Ee),It.write_shift(1,Fe),It.write_shift(1,dt),0==Pe)return It.write_shift(4,0),It.write_shift(4,0),It.write_shift(2,65535),It;var sn=0,Yt=0,Rt=0;return Pe<0&&(sn=1,Pe=-Pe),Yt=0|Math.log2(Pe),0==(2147483648&(Rt=(Pe/=Math.pow(2,Yt-31))>>>0))&&(++Yt,Rt=(Pe/=2)>>>0),Pe-=Rt,Rt|=2147483648,Rt>>>=0,Pe*=Math.pow(2,32),It.write_shift(4,Pe>>>0),It.write_shift(4,Rt),It.write_shift(2,Yt+=16383+(sn?32768:0)),It}function Xt(Ee,dt){var Fe=tt(Ee),Pe=Ee.read_shift(8,"f");return Fe[1].v=Pe,Fe}function Zt(Ee,dt){return 0==Ee[Ee.l+dt-1]?Ee.read_shift(dt,"cstr"):""}function ln(Ee,dt){var Fe=Tt(5+Ee.length);Fe.write_shift(2,14e3),Fe.write_shift(2,dt);for(var Pe=0;Pe<Ee.length;++Pe){var It=Ee.charCodeAt(Pe);Fe[Fe.l++]=It>127?95:It}return Fe[Fe.l++]=0,Fe}var Mn={0:{n:"BOF",f:os},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function C(Ee,dt,Fe){var Pe={s:{c:0,r:0},e:{c:0,r:0}};return 8==dt&&Fe.qpro?(Pe.s.c=Ee.read_shift(1),Ee.l++,Pe.s.r=Ee.read_shift(2),Pe.e.c=Ee.read_shift(1),Ee.l++,Pe.e.r=Ee.read_shift(2),Pe):(Pe.s.c=Ee.read_shift(2),Pe.s.r=Ee.read_shift(2),12==dt&&Fe.qpro&&(Ee.l+=2),Pe.e.c=Ee.read_shift(2),Pe.e.r=Ee.read_shift(2),12==dt&&Fe.qpro&&(Ee.l+=2),65535==Pe.s.c&&(Pe.s.c=Pe.e.c=Pe.s.r=Pe.e.r=0),Pe)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function W(Ee,dt,Fe){var Pe=F(Ee,0,Fe);return Pe[1].v=Ee.read_shift(2,"i"),Pe}},14:{n:"NUMBER",f:function X(Ee,dt,Fe){var Pe=F(Ee,0,Fe);return Pe[1].v=Ee.read_shift(8,"f"),Pe}},15:{n:"LABEL",f:O},16:{n:"FORMULA",f:function Z(Ee,dt,Fe){var Pe=Ee.l+dt,It=F(Ee,0,Fe);if(It[1].v=Ee.read_shift(8,"f"),Fe.qpro)Ee.l=Pe;else{var sn=Ee.read_shift(2);(function Ke(Ee,dt){yo(Ee,0);for(var Fe=[],Pe=0,It="",sn="",Yt="",Qt="";Ee.l<Ee.length;){var Rt=Ee[Ee.l++];switch(Rt){case 0:Fe.push(Ee.read_shift(8,"f"));break;case 1:sn=he(dt[0].c,Ee.read_shift(2),!0),It=he(dt[0].r,Ee.read_shift(2),!1),Fe.push(sn+It);break;case 2:var gi=he(dt[0].c,Ee.read_shift(2),!0),Se=he(dt[0].r,Ee.read_shift(2),!1);sn=he(dt[0].c,Ee.read_shift(2),!0),It=he(dt[0].r,Ee.read_shift(2),!1),Fe.push(gi+Se+":"+sn+It);break;case 3:if(Ee.l<Ee.length)return void console.error("WK1 premature formula end");break;case 4:Fe.push("("+Fe.pop()+")");break;case 5:Fe.push(Ee.read_shift(2));break;case 6:for(var Tr="";Rt=Ee[Ee.l++];)Tr+=String.fromCharCode(Rt);Fe.push('"'+Tr.replace(/"/g,'""')+'"');break;case 8:Fe.push("-"+Fe.pop());break;case 23:Fe.push("+"+Fe.pop());break;case 22:Fe.push("NOT("+Fe.pop()+")");break;case 20:case 21:Qt=Fe.pop(),Yt=Fe.pop(),Fe.push(["AND","OR"][Rt-20]+"("+Yt+","+Qt+")");break;default:if(Rt<32&&le[Rt])Qt=Fe.pop(),Yt=Fe.pop(),Fe.push(Yt+le[Rt]+Qt);else{if(!ge[Rt])return Rt<=7?console.error("WK1 invalid opcode "+Rt.toString(16)):Rt<=24?console.error("WK1 unsupported op "+Rt.toString(16)):Rt<=30?console.error("WK1 invalid opcode "+Rt.toString(16)):Rt<=115?console.error("WK1 unsupported function opcode "+Rt.toString(16)):console.error("WK1 unrecognized opcode "+Rt.toString(16));if(69==(Pe=ge[Rt][1])&&(Pe=Ee[Ee.l++]),Pe>Fe.length)return void console.error("WK1 bad formula parse 0x"+Rt.toString(16)+":|"+Fe.join("|")+"|");var Hi=Fe.slice(-Pe);Fe.length-=Pe,Fe.push(ge[Rt][0]+"("+Hi.join(",")+")")}}}1==Fe.length?dt[1].f=""+Fe[0]:console.error("WK1 bad formula parse |"+Fe.join("|")+"|")})(Ee.slice(Ee.l,Ee.l+sn),It),Ee.l+=sn}return It}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:O},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Zt},222:{n:"SHEETNAMELP",f:function Fn(Ee,dt){var Fe=Ee[Ee.l++];Fe>dt-1&&(Fe=dt-1);for(var Pe="";Pe.length<Fe;)Pe+=String.fromCharCode(Ee[Ee.l++]);return Pe}},65535:{n:""}},Pt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function ze(Ee,dt){var Fe=tt(Ee);return Fe[1].t="s",Fe[1].v=Ee.read_shift(dt-4,"cstr"),Fe}},23:{n:"NUMBER17",f:qe},24:{n:"NUMBER18",f:function Qe(Ee,dt){var Fe=tt(Ee);Fe[1].v=Ee.read_shift(2);var Pe=Fe[1].v>>1;if(1&Fe[1].v)switch(7&Pe){case 0:Pe=5e3*(Pe>>3);break;case 1:Pe=500*(Pe>>3);break;case 2:Pe=(Pe>>3)/20;break;case 3:Pe=(Pe>>3)/200;break;case 4:Pe=(Pe>>3)/2e3;break;case 5:Pe=(Pe>>3)/2e4;break;case 6:Pe=(Pe>>3)/16;break;case 7:Pe=(Pe>>3)/64}return Fe[1].v=Pe,Fe}},25:{n:"FORMULA19",f:function bt(Ee,dt){var Fe=qe(Ee);return Ee.l+=dt-14,Fe}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function Li(Ee,dt){for(var Fe={},Pe=Ee.l+dt;Ee.l<Pe;){var It=Ee.read_shift(2);if(14e3==It){for(Fe[It]=[0,""],Fe[It][0]=Ee.read_shift(2);Ee[Ee.l];)Fe[It][1]+=String.fromCharCode(Ee[Ee.l]),Ee.l++;Ee.l++}}return Fe}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function et(Ee,dt){var Fe=tt(Ee),Pe=Ee.read_shift(4);return Fe[1].v=Pe>>6,Fe}},38:{n:"??"},39:{n:"NUMBER27",f:Xt},40:{n:"FORMULA28",f:function vn(Ee,dt){var Fe=Xt(Ee);return Ee.l+=dt-10,Fe}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Zt},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function Dn(Ee,dt,Fe){if(Fe.qpro&&!(dt<21)){var Pe=Ee.read_shift(1);return Ee.l+=17,Ee.l+=1,Ee.l+=2,[Pe,Ee.read_shift(dt-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function d(Ee,dt){var Fe=dt||{};if(+Fe.codepage>=0&&Io(+Fe.codepage),"string"==Fe.type)throw new Error("Cannot write WK1 to JS string");var Pe=Vn(),It=Yi(Ee["!ref"]),sn=Array.isArray(Ee),Yt=[];tn(Pe,0,function y(Ee){var dt=Tt(2);return dt.write_shift(2,Ee),dt}(1030)),tn(Pe,6,function I(Ee){var dt=Tt(8);return dt.write_shift(2,Ee.s.c),dt.write_shift(2,Ee.s.r),dt.write_shift(2,Ee.e.c),dt.write_shift(2,Ee.e.r),dt}(It));for(var Qt=Math.min(It.e.r,8191),Rt=It.s.r;Rt<=Qt;++Rt)for(var gi=jr(Rt),Se=It.s.c;Se<=It.e.c;++Se){Rt===It.s.r&&(Yt[Se]=to(Se));var Hi=sn?(Ee[Rt]||[])[Se]:Ee[Yt[Se]+gi];Hi&&"z"!=Hi.t&&("n"==Hi.t?(0|Hi.v)==Hi.v&&Hi.v>=-32768&&Hi.v<=32767?tn(Pe,13,G(Rt,Se,Hi.v)):tn(Pe,14,V(Rt,Se,Hi.v)):tn(Pe,15,H(Rt,Se,Cc(Hi).slice(0,239))))}return tn(Pe,1),Pe.end()},book_to_wk3:function h(Ee,dt){var Fe=dt||{};if(+Fe.codepage>=0&&Io(+Fe.codepage),"string"==Fe.type)throw new Error("Cannot write WK3 to JS string");var Pe=Vn();tn(Pe,0,function b(Ee){var dt=Tt(26);dt.write_shift(2,4096),dt.write_shift(2,4),dt.write_shift(4,0);for(var Fe=0,Pe=0,It=0,sn=0;sn<Ee.SheetNames.length;++sn){var Qt=Ee.Sheets[Ee.SheetNames[sn]];if(Qt&&Qt["!ref"]){++It;var Rt=no(Qt["!ref"]);Fe<Rt.e.r&&(Fe=Rt.e.r),Pe<Rt.e.c&&(Pe=Rt.e.c)}}return Fe>8191&&(Fe=8191),dt.write_shift(2,Fe),dt.write_shift(1,It),dt.write_shift(1,Pe),dt.write_shift(2,0),dt.write_shift(2,0),dt.write_shift(1,1),dt.write_shift(1,2),dt.write_shift(4,0),dt.write_shift(4,0),dt}(Ee));for(var It=0,sn=0;It<Ee.SheetNames.length;++It)(Ee.Sheets[Ee.SheetNames[It]]||{})["!ref"]&&tn(Pe,27,ln(Ee.SheetNames[It],sn++));var Yt=0;for(It=0;It<Ee.SheetNames.length;++It){var Qt=Ee.Sheets[Ee.SheetNames[It]];if(Qt&&Qt["!ref"]){for(var Rt=Yi(Qt["!ref"]),gi=Array.isArray(Qt),Se=[],Tr=Math.min(Rt.e.r,8191),Hi=Rt.s.r;Hi<=Tr;++Hi)for(var Dr=jr(Hi),zi=Rt.s.c;zi<=Rt.e.c;++zi){Hi===Rt.s.r&&(Se[zi]=to(zi));var Po=gi?(Qt[Hi]||[])[zi]:Qt[Se[zi]+Dr];Po&&"z"!=Po.t&&("n"==Po.t?tn(Pe,23,gt(Hi,zi,Yt,Po.v)):tn(Pe,22,be(Hi,zi,Yt,Cc(Po).slice(0,239))))}++Yt}}return tn(Pe,1),Pe.end()},to_workbook:function l(Ee,dt){switch(dt.type){case"base64":return a(ha(pa(Ee)),dt);case"binary":return a(ha(Ee),dt);case"buffer":case"array":return a(Ee,dt)}throw"Unsupported type "+dt.type}}}(),gx=function(){var s=Sh("t"),l=Sh("rPr");function a(y){var b=y.match(s);if(!b)return{t:"s",v:""};var C={t:"s",v:lr(b[1])},I=y.match(l);return I&&(C.s=function mx(s){var l={},a=s.match(va),d=0,h=!1;if(a)for(;d!=a.length;++d){var y=Qn(a[d]);switch(y[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!y.val)break;case"<shadow>":case"<shadow/>":l.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==y.val)break;l.cp=lo[parseInt(y.val,10)];break;case"<outline":if(!y.val)break;case"<outline>":case"<outline/>":l.outline=1;break;case"</outline>":break;case"<rFont":l.name=y.val;break;case"<sz":l.sz=y.val;break;case"<strike":if(!y.val)break;case"<strike>":case"<strike/>":l.strike=1;break;case"</strike>":break;case"<u":if(!y.val)break;switch(y.val){case"double":l.uval="double";break;case"singleAccounting":l.uval="single-accounting";break;case"doubleAccounting":l.uval="double-accounting"}case"<u>":case"<u/>":l.u=1;break;case"</u>":break;case"<b":if("0"==y.val)break;case"<b>":case"<b/>":l.b=1;break;case"</b>":break;case"<i":if("0"==y.val)break;case"<i>":case"<i/>":l.i=1;break;case"</i>":break;case"<color":y.rgb&&(l.color=y.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":l.family=y.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":l.valign=y.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":h=!0;break;case"</ext>":h=!1;break;default:if(47!==y[0].charCodeAt(1)&&!h)throw new Error("Unrecognized rich format "+y[0])}}return l}(I[1])),C}var d=/<(?:\w+:)?r>/g,h=/<\/(?:\w+:)?r>/;return function(b){return b.replace(d,"").split(h).map(a).filter(function(C){return C.v})}}(),_x=function(){var l=/(\r\n|\n)/g;function d(h){var y=[[],h.v,[]];return h.v?(h.s&&function a(h,y,b){var C=[];h.u&&C.push("text-decoration: underline;"),h.uval&&C.push("text-underline-style:"+h.uval+";"),h.sz&&C.push("font-size:"+h.sz+"pt;"),h.outline&&C.push("text-effect: outline;"),h.shadow&&C.push("text-shadow: auto;"),y.push('<span style="'+C.join("")+'">'),h.b&&(y.push("<b>"),b.push("</b>")),h.i&&(y.push("<i>"),b.push("</i>")),h.strike&&(y.push("<s>"),b.push("</s>"));var I=h.valign||"";"superscript"==I||"super"==I?I="sup":"subscript"==I&&(I="sub"),""!=I&&(y.push("<"+I+">"),b.push("</"+I+">")),b.push("</span>")}(h.s,y[0],y[2]),y[0].join("")+y[1].replace(l,"<br/>")+y[2].join("")):""}return function(y){return y.map(d).join("")}}(),vx=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,wE=/<(?:\w+:)?r>/,CE=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function P1(s,l){var a=!l||l.cellHTML,d={};return s?(s.match(/^\s*<(?:\w+:)?t[^>]*>/)?(d.t=lr(_n(s.slice(s.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),d.r=_n(s),a&&(d.h=Th(d.t))):s.match(wE)&&(d.r=_n(s),d.t=lr(_n((s.replace(CE,"").match(vx)||[]).join("").replace(va,""))),a&&(d.h=_x(gx(d.r)))),d):{t:""}}var TE=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,SE=/<(?:\w+:)?(?:si|sstItem)>/g,id=/<\/(?:\w+:)?(?:si|sstItem)>/,EE=/^\s|\s$|[\t\n\r]/;function kE(s,l){if(!l.bookSST)return"";var a=[br];a[a.length]=Jt("sst",null,{xmlns:Bd[0],count:s.Count,uniqueCount:s.Unique});for(var d=0;d!=s.length;++d)if(null!=s[d]){var h=s[d],y="<si>";h.r?y+=h.r:(y+="<t",h.t||(h.t=""),h.t.match(EE)&&(y+=' xml:space="preserve"'),y+=">"+Vt(h.t)+"</t>"),a[a.length]=y+="</si>"}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}var pP=function HF(s,l){var a=!1;return null==l&&(a=!0,l=Tt(15+4*s.t.length)),l.write_shift(1,0),js(s.t,l),a?l.slice(0,l.l):l};function yx(s){var l=Vn();Nt(l,159,function fP(s,l){return l||(l=Tt(8)),l.write_shift(4,s.Count),l.write_shift(4,s.Unique),l}(s));for(var a=0;a<s.length;++a)Nt(l,19,pP(s[a]));return Nt(l,160),l.end()}function bx(s){if(void 0!==Pi)return Pi.utils.encode(Ks,s);for(var l=[],a=s.split(""),d=0;d<a.length;++d)l[d]=a[d].charCodeAt(0);return l}function uu(s,l){var a={};return a.Major=s.read_shift(2),a.Minor=s.read_shift(2),l>=4&&(s.l+=l-4),a}function IE(s){for(var l=s.read_shift(4),a=s.l+l-4,d={},h=s.read_shift(4),y=[];h-- >0;)y.push({t:s.read_shift(4),v:s.read_shift(0,"lpp4")});if(d.name=s.read_shift(0,"lpp4"),d.comps=y,s.l!=a)throw new Error("Bad DataSpaceMapEntry: "+s.l+" != "+a);return d}function Jl(s,l){var a=s.l+l,d={};d.Flags=63&s.read_shift(4),s.l+=4,d.AlgID=s.read_shift(4);var h=!1;switch(d.AlgID){case 26126:case 26127:case 26128:h=36==d.Flags;break;case 26625:h=4==d.Flags;break;case 0:h=16==d.Flags||4==d.Flags||36==d.Flags;break;default:throw"Unrecognized encryption algorithm: "+d.AlgID}if(!h)throw new Error("Encryption Flags/AlgID mismatch");return d.AlgIDHash=s.read_shift(4),d.KeySize=s.read_shift(4),d.ProviderType=s.read_shift(4),s.l+=8,d.CSPName=s.read_shift(a-s.l>>1,"utf16le"),s.l=a,d}function np(s,l){var a={},d=s.l+l;return s.l+=4,a.Salt=s.slice(s.l,s.l+16),s.l+=16,a.Verifier=s.slice(s.l,s.l+16),s.l+=16,s.read_shift(4),a.VerifierHash=s.slice(s.l,d),s.l=d,a}function Cx(s){if(36!=(63&s.read_shift(4)))throw new Error("EncryptionInfo mismatch");var a=s.read_shift(4);return{t:"Std",h:Jl(s,a),v:np(s,s.length-s.l)}}function Tx(){throw new Error("File is password-protected: ECMA-376 Extensible")}function mP(s){var l=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];s.l+=4;var a=s.read_shift(s.length-s.l,"utf8"),d={};return a.replace(va,function(y){var b=Qn(y);switch(eu(b[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":l.forEach(function(C){d[C]=b[C]});break;case"<dataIntegrity":d.encryptedHmacKey=b.encryptedHmacKey,d.encryptedHmacValue=b.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":d.encs=[];break;case"<keyEncryptor":d.uri=b.uri;break;case"<encryptedKey":d.encs.push(b);break;default:throw b[0]}}),d}function qh(s){var a,y,l=0,d=bx(s),h=d.length+1;for((a=Hl(h))[0]=d.length,y=1;y!=h;++y)a[y]=d[y-1];for(y=h-1;y>=0;--y)l=((0==(16384&l)?0:1)|l<<1&32767)^a[y];return 52811^l}var Hg=function(){var s=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],l=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],h=function(b,C){return function(b){return 255&(b/2|128*b)}(b^C)};return function(b){for(var C=bx(b),I=function(b){for(var C=l[b.length-1],I=104,F=b.length-1;F>=0;--F)for(var O=b[F],H=0;7!=H;++H)64&O&&(C^=a[I]),O*=2,--I;return C}(C),F=C.length,O=Hl(16),H=0;16!=H;++H)O[H]=0;var X;for(1==(1&F)&&(O[F]=h(s[0],I>>8),O[--F]=h(C[C.length-1],255&I));F>0;)O[--F]=h(C[F],I>>8),O[--F]=h(C[F],255&I);for(F=15,X=15-C.length;X>0;)O[F]=h(s[X],I>>8),--X,O[--F]=h(C[F],255&I),--F,--X;return O}}();var Ex=function(){function s(h,y){switch(y.type){case"base64":return l(pa(h),y);case"binary":return l(h,y);case"buffer":return l(Oi&&Buffer.isBuffer(h)?h.toString("binary"):hc(h),y);case"array":return l(Zc(h),y)}throw new Error("Unrecognized type "+y.type)}function l(h,y){var C=(y||{}).dense?[]:{},I=h.match(/\\trowd.*?\\row\b/g);if(!I.length)throw new Error("RTF missing table");var F={s:{c:0,r:0},e:{c:0,r:I.length-1}};return I.forEach(function(O,H){Array.isArray(C)&&(C[H]=[]);for(var X,W=/\\\w+\b/g,G=0,V=-1;X=W.exec(O);){if("\\cell"===X[0]){var Z=O.slice(G,W.lastIndex-X[0].length);if(" "==Z[0]&&(Z=Z.slice(1)),++V,Z.length){var he={v:Z,t:"s"};Array.isArray(C)?C[H][V]=he:C[qn({r:H,c:V})]=he}}G=W.lastIndex}V>F.e.c&&(F.e.c=V)}),C["!ref"]=yi(F),C}return{to_workbook:function a(h,y){return $d(s(h,y),y)},to_sheet:s,from_sheet:function d(h){for(var C,y=["{\\rtf1\\ansi"],b=Yi(h["!ref"]),I=Array.isArray(h),F=b.s.r;F<=b.e.r;++F){y.push("\\trowd\\trautofit1");for(var O=b.s.c;O<=b.e.c;++O)y.push("\\cellx"+(O+1));for(y.push("\\pard\\intbl"),O=b.s.c;O<=b.e.c;++O){var H=qn({r:F,c:O});(C=I?(h[F]||[])[O]:h[H])&&(null!=C.v||C.f&&!C.F)&&(y.push(" "+(C.w||(Cc(C),C.w))),y.push("\\cell"))}y.push("\\pard\\intbl\\row")}return y.join("")+"}"}}}();function Gh(s){for(var l=0,a=1;3!=l;++l)a=256*a+(s[l]>255?255:s[l]<0?0:s[l]);return a.toString(16).toUpperCase().slice(1)}function $g(s,l){if(0===l)return s;var a=function kx(s){var l=s[0]/255,a=s[1]/255,d=s[2]/255,h=Math.max(l,a,d),y=Math.min(l,a,d),b=h-y;if(0===b)return[0,0,l];var I,C=0,F=h+y;switch(I=b/(F>1?2-F:F),h){case l:C=((a-d)/b+6)%6;break;case a:C=(d-l)/b+2;break;case d:C=(l-a)/b+4}return[C/6,I,F/2]}(function FE(s){var l=s.slice("#"===s[0]?1:0).slice(0,6);return[parseInt(l.slice(0,2),16),parseInt(l.slice(2,4),16),parseInt(l.slice(4,6),16)]}(s));return a[2]=l<0?a[2]*(1+l):1-(1-a[2])*(1-l),Gh(function zg(s){var I,a=s[1],d=s[2],h=2*a*(d<.5?d:1-d),y=d-h/2,b=[y,y,y],C=6*s[0];if(0!==a)switch(0|C){case 0:case 6:I=h*C,b[0]+=h,b[1]+=I;break;case 1:b[0]+=I=h*(2-C),b[1]+=h;break;case 2:I=h*(C-2),b[1]+=h,b[2]+=I;break;case 3:b[1]+=I=h*(4-C),b[2]+=h;break;case 4:I=h*(C-4),b[2]+=h,b[0]+=I;break;case 5:b[2]+=I=h*(6-C),b[0]+=h}for(var F=0;3!=F;++F)b[F]=Math.round(255*b[F]);return b}(a))}var Us=6;function Kh(s){return Math.floor((s+Math.round(128/Us)/256)*Us)}function rd(s){return Math.floor((s-5)/Us*100+.5)/100}function Yh(s){return Math.round((s*Us+5)/Us*256)/256}function N1(s){return Yh(rd(Kh(s)))}function L1(s){var l=Math.abs(s-N1(s)),a=Us;if(l>.005)for(Us=1;Us<15;++Us)Math.abs(s-N1(s))<=l&&(l=Math.abs(s-N1(s)),a=Us);Us=a}function od(s){s.width?(s.wpx=Kh(s.width),s.wch=rd(s.wpx),s.MDW=Us):s.wpx?(s.wch=rd(s.wpx),s.width=Yh(s.wch),s.MDW=Us):"number"==typeof s.wch&&(s.width=Yh(s.wch),s.wpx=Kh(s.width),s.MDW=Us),s.customWidth&&delete s.customWidth}function qg(s){return 96*s/96}function Xh(s){return 96*s/96}var Qh={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},sd=["numFmtId","fillId","fontId","borderId","xfId"],ip=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],Mx=function(){var l=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,d=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,h=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,y=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(C,I,F){var H,O={};return C?((H=(C=C.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(l))&&function Ax(s,l,a){l.NumberFmt=[];for(var d=Gr(Wn),h=0;h<d.length;++h)l.NumberFmt[d[h]]=Wn[d[h]];var y=s[0].match(va);if(y)for(h=0;h<y.length;++h){var b=Qn(y[h]);switch(eu(b[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var C=lr(_n(b.formatCode)),I=parseInt(b.numFmtId,10);if(l.NumberFmt[I]=C,I>0){if(I>392){for(I=392;I>60&&null!=l.NumberFmt[I];--I);l.NumberFmt[I]=C}gc(C,I)}break;default:if(a.WTF)throw new Error("unrecognized "+b[0]+" in numFmts")}}}(H,O,F),(H=C.match(h))&&function Ix(s,l,a,d){l.Fonts=[];var h={},y=!1;(s[0].match(va)||[]).forEach(function(b){var C=Qn(b);switch(eu(C[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":l.Fonts.push(h),h={};break;case"<name":C.val&&(h.name=_n(C.val));break;case"<b":h.bold=C.val?Kr(C.val):1;break;case"<b/>":h.bold=1;break;case"<i":h.italic=C.val?Kr(C.val):1;break;case"<i/>":h.italic=1;break;case"<u":switch(C.val){case"none":h.underline=0;break;case"single":h.underline=1;break;case"double":h.underline=2;break;case"singleAccounting":h.underline=33;break;case"doubleAccounting":h.underline=34}break;case"<u/>":h.underline=1;break;case"<strike":h.strike=C.val?Kr(C.val):1;break;case"<strike/>":h.strike=1;break;case"<outline":h.outline=C.val?Kr(C.val):1;break;case"<outline/>":h.outline=1;break;case"<shadow":h.shadow=C.val?Kr(C.val):1;break;case"<shadow/>":h.shadow=1;break;case"<condense":h.condense=C.val?Kr(C.val):1;break;case"<condense/>":h.condense=1;break;case"<extend":h.extend=C.val?Kr(C.val):1;break;case"<extend/>":h.extend=1;break;case"<sz":C.val&&(h.sz=+C.val);break;case"<vertAlign":C.val&&(h.vertAlign=C.val);break;case"<family":C.val&&(h.family=parseInt(C.val,10));break;case"<scheme":C.val&&(h.scheme=C.val);break;case"<charset":if("1"==C.val)break;C.codepage=lo[parseInt(C.val,10)];break;case"<color":if(h.color||(h.color={}),C.auto&&(h.color.auto=Kr(C.auto)),C.rgb)h.color.rgb=C.rgb.slice(-6);else if(C.indexed){h.color.index=parseInt(C.indexed,10);var I=Wd[h.color.index];81==h.color.index&&(I=Wd[1]),I||(I=Wd[1]),h.color.rgb=I[0].toString(16)+I[1].toString(16)+I[2].toString(16)}else C.theme&&(h.color.theme=parseInt(C.theme,10),C.tint&&(h.color.tint=parseFloat(C.tint)),C.theme&&a.themeElements&&a.themeElements.clrScheme&&(h.color.rgb=$g(a.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0)));break;case"<AlternateContent":case"<ext":y=!0;break;case"</AlternateContent>":case"</ext>":y=!1;break;default:if(d&&d.WTF&&!y)throw new Error("unrecognized "+C[0]+" in fonts")}})}(H,O,I,F),(H=C.match(d))&&function R1(s,l,a,d){l.Fills=[];var h={},y=!1;(s[0].match(va)||[]).forEach(function(b){var C=Qn(b);switch(eu(C[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":l.Fills.push(h={});break;case"<gradientFill":case"</gradientFill>":l.Fills.push(h),h={};break;case"<patternFill":case"<patternFill>":C.patternType&&(h.patternType=C.patternType);break;case"<bgColor":h.bgColor||(h.bgColor={}),C.indexed&&(h.bgColor.indexed=parseInt(C.indexed,10)),C.theme&&(h.bgColor.theme=parseInt(C.theme,10)),C.tint&&(h.bgColor.tint=parseFloat(C.tint)),C.rgb&&(h.bgColor.rgb=C.rgb.slice(-6));break;case"<fgColor":h.fgColor||(h.fgColor={}),C.theme&&(h.fgColor.theme=parseInt(C.theme,10)),C.tint&&(h.fgColor.tint=parseFloat(C.tint)),null!=C.rgb&&(h.fgColor.rgb=C.rgb.slice(-6));break;case"<ext":y=!0;break;case"</ext>":y=!1;break;default:if(d&&d.WTF&&!y)throw new Error("unrecognized "+C[0]+" in fills")}})}(H,O,0,F),(H=C.match(y))&&function Ca(s,l,a,d){l.Borders=[];var h={},y=!1;(s[0].match(va)||[]).forEach(function(b){var C=Qn(b);switch(eu(C[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":h={},C.diagonalUp&&(h.diagonalUp=Kr(C.diagonalUp)),C.diagonalDown&&(h.diagonalDown=Kr(C.diagonalDown)),l.Borders.push(h);break;case"<ext":y=!0;break;case"</ext>":y=!1;break;default:if(d&&d.WTF&&!y)throw new Error("unrecognized "+C[0]+" in borders")}})}(H,O,0,F),(H=C.match(a))&&function NE(s,l,a){l.CellXf=[];var d,h=!1;(s[0].match(va)||[]).forEach(function(y){var b=Qn(y),C=0;switch(eu(b[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(d=b)[0],C=0;C<sd.length;++C)d[sd[C]]&&(d[sd[C]]=parseInt(d[sd[C]],10));for(C=0;C<ip.length;++C)d[ip[C]]&&(d[ip[C]]=Kr(d[ip[C]]));if(l.NumberFmt&&d.numFmtId>392)for(C=392;C>60;--C)if(l.NumberFmt[d.numFmtId]==l.NumberFmt[C]){d.numFmtId=C;break}l.CellXf.push(d);break;case"<alignment":case"<alignment/>":var I={};b.vertical&&(I.vertical=b.vertical),b.horizontal&&(I.horizontal=b.horizontal),null!=b.textRotation&&(I.textRotation=b.textRotation),b.indent&&(I.indent=b.indent),b.wrapText&&(I.wrapText=Kr(b.wrapText)),d.alignment=I;break;case"<AlternateContent":case"<ext":h=!0;break;case"</AlternateContent>":case"</ext>":h=!1;break;default:if(a&&a.WTF&&!h)throw new Error("unrecognized "+b[0]+" in cellXfs")}})}(H,O,F),O):O}}();function Fx(s,l){var d,a=[br,Jt("styleSheet",null,{xmlns:Bd[0],"xmlns:vt":is_vt})];return s.SSF&&null!=(d=function ta(s){var l=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var d=a[0];d<=a[1];++d)null!=s[d]&&(l[l.length]=Jt("numFmt",null,{numFmtId:d,formatCode:Vt(s[d])}))}),1===l.length?"":(l[l.length]="</numFmts>",l[0]=Jt("numFmts",null,{count:l.length-2}).replace("/>",">"),l.join(""))}(s.SSF))&&(a[a.length]=d),a[a.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',a[a.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',a[a.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',a[a.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(d=function LE(s){var l=[];return l[l.length]=Jt("cellXfs",null),s.forEach(function(a){l[l.length]=Jt("xf",null,a)}),l[l.length]="</cellXfs>",2===l.length?"":(l[0]=Jt("cellXfs",null,{count:l.length-2}).replace("/>",">"),l.join(""))}(l.cellXfs))&&(a[a.length]=d),a[a.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',a[a.length]='<dxfs count="0"/>',a[a.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',a.length>2&&(a[a.length]="</styleSheet>",a[1]=a[1].replace("/>",">")),a.join("")}function RE(s,l,a){a||(a=Tt(6+4*l.length)),a.write_shift(2,s),js(l,a);var d=a.length>a.l?a.slice(0,a.l):a;return null==a.l&&(a.l=a.length),d}var Jh,jE=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],VE=qi;function Nx(s,l){l||(l=Tt(84)),Jh||(Jh=xh(jE));var a=Jh[s.patternType];null==a&&(a=40),l.write_shift(4,a);var d=0;if(40!=a)for(Wf({auto:1},l),Wf({auto:1},l);d<12;++d)l.write_shift(4,0);else{for(;d<4;++d)l.write_shift(4,0);for(;d<12;++d)l.write_shift(4,0)}return l.length>l.l?l.slice(0,l.l):l}function Lx(s,l,a){return a||(a=Tt(16)),a.write_shift(2,l||0),a.write_shift(2,s.numFmtId||0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a}function Zh(s,l){return l||(l=Tt(10)),l.write_shift(1,0),l.write_shift(1,0),l.write_shift(4,0),l.write_shift(4,0),l}var em=qi;function rp(s,l){var a=Vn();return Nt(a,278),function WE(s,l){if(l){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(d){for(var h=d[0];h<=d[1];++h)null!=l[h]&&++a}),0!=a&&(Nt(s,615,Tc(a)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(d){for(var h=d[0];h<=d[1];++h)null!=l[h]&&Nt(s,44,RE(h,l[h]))}),Nt(s,616))}}(a,s.SSF),function Rx(s){Nt(s,611,Tc(1)),Nt(s,43,function BE(s,l){l||(l=Tt(153)),l.write_shift(2,20*s.sz),function q5(s,l){l||(l=Tt(2)),l.write_shift(1,(s.italic?2:0)|(s.strike?8:0)|(s.outline?16:0)|(s.shadow?32:0)|(s.condense?64:0)|(s.extend?128:0)),l.write_shift(1,0)}(s,l),l.write_shift(2,s.bold?700:400);var a=0;"superscript"==s.vertAlign?a=1:"subscript"==s.vertAlign&&(a=2),l.write_shift(2,a),l.write_shift(1,s.underline||0),l.write_shift(1,s.family||0),l.write_shift(1,s.charset||0),l.write_shift(1,0),Wf(s.color,l);var d=0;return"major"==s.scheme&&(d=1),"minor"==s.scheme&&(d=2),l.write_shift(1,d),js(s.name,l),l.length>l.l?l.slice(0,l.l):l}({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Nt(s,612)}(a),function qE(s){Nt(s,603,Tc(2)),Nt(s,45,Nx({patternType:"none"})),Nt(s,45,Nx({patternType:"gray125"})),Nt(s,604)}(a),function GE(s){Nt(s,613,Tc(1)),Nt(s,46,function UE(s,l){return l||(l=Tt(51)),l.write_shift(1,0),Zh(0,l),Zh(0,l),Zh(0,l),Zh(0,l),Zh(0,l),l.length>l.l?l.slice(0,l.l):l}()),Nt(s,614)}(a),function KE(s){Nt(s,626,Tc(1)),Nt(s,47,Lx({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Nt(s,627)}(a),function YE(s,l){Nt(s,617,Tc(l.length)),l.forEach(function(a){Nt(s,47,Lx(a,0))}),Nt(s,618)}(a,l.cellXfs),function XE(s){Nt(s,619,Tc(1)),Nt(s,48,function HE(s,l){return l||(l=Tt(52)),l.write_shift(4,s.xfId),l.write_shift(2,1),l.write_shift(1,+s.builtinId),l.write_shift(1,0),pg(s.name||"",l),l.length>l.l?l.slice(0,l.l):l}({xfId:0,builtinId:0,name:"Normal"})),Nt(s,620)}(a),function Bx(s){Nt(s,505,Tc(0)),Nt(s,506)}(a),function jx(s){Nt(s,508,function zE(s,l,a){var d=Tt(2052);return d.write_shift(4,s),pg(l,d),pg(a,d),d.length>d.l?d.slice(0,d.l):d}(0,"TableStyleMedium9","PivotStyleMedium4")),Nt(s,509)}(a),Nt(a,279),a.end()}var Ic=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function xP(s,l,a){l.themeElements.clrScheme=[];var d={};(s[0].match(va)||[]).forEach(function(h){var y=Qn(h);switch(y[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":d.rgb=y.val;break;case"<a:sysClr":d.rgb=y.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===y[0].charAt(1)?(l.themeElements.clrScheme[Ic.indexOf(y[0])]=d,d={}):d.name=y[0].slice(3,y[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+y[0]+" in clrScheme")}})}function wP(){}function Vx(){}var CP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Ja=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,j1=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,QE=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function U1(s,l){(!s||0===s.length)&&(s=Qd());var a,d={};if(!(a=s.match(QE)))throw new Error("themeElements not found in theme");return function V1(s,l,a){var d;l.themeElements={},[["clrScheme",CP,xP],["fontScheme",Ja,wP],["fmtScheme",j1,Vx]].forEach(function(h){if(!(d=s.match(h[1])))throw new Error(h[0]+" not found in themeElements");h[2](d,l,a)})}(a[0],d,l),d.raw=s,d}function Qd(s,l){if(l&&l.themeXLSX)return l.themeXLSX;if(s&&"string"==typeof s.raw)return s.raw;var a=[br];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',a[a.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',a[a.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',a[a.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',a[a.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',a[a.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',a[a.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function TP(s){var l=s.read_shift(2),a=s.read_shift(2)-4,d=[l];switch(l){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:d[1]=function H1(s){var l={};switch(l.xclrType=s.read_shift(2),l.nTintShade=s.read_shift(2),l.xclrType){case 0:case 4:s.l+=4;break;case 1:l.xclrValue=function z1(s,l){return qi(s,l)}(s,4);break;case 2:l.xclrValue=Mg(s);break;case 3:l.xclrValue=function Hx(s){return s.read_shift(4)}(s)}return s.l+=8,l}(s);break;case 6:d[1]=function zx(s,l){return qi(s,l)}(s,a);break;case 14:case 15:d[1]=s.read_shift(1===a?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+l+" "+a)}return d}function $1(s,l){l.forEach(function(a){})}function o4(){var s=Vn();return Nt(s,332),Nt(s,334,Tc(1)),Nt(s,335,function JE(s){var l=Tt(12+2*s.name.length);return l.write_shift(4,s.flags),l.write_shift(4,s.version),js(s.name,l),l.slice(0,l.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Nt(s,336),Nt(s,339,function e4(s,l){var a=Tt(8+2*l.length);return a.write_shift(4,s),js(l,a),a.slice(0,a.l)}(1,"XLDAPR")),Nt(s,52),Nt(s,35,Tc(514)),Nt(s,4096,Tc(0)),Nt(s,4097,Ql(1)),Nt(s,36),Nt(s,53),Nt(s,340),Nt(s,337,function n4(s,l){var a=Tt(8);return a.write_shift(4,s),a.write_shift(4,l?1:0),a}(1,!0)),Nt(s,51,function ZE(s){var l=Tt(4+8*s.length);l.write_shift(4,s.length);for(var a=0;a<s.length;++a)l.write_shift(4,s[a][0]),l.write_shift(4,s[a][1]);return l}([[1,0]])),Nt(s,338),Nt(s,333),s.end()}function Gg(){var s=[br];return s.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),s.join("")}var Cl=1024;function G1(s,l){for(var a=[21600,21600],d=["m0,0l0",a[1],a[0],a[1],a[0],"0xe"].join(","),h=[Jt("xml",null,{"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":ys_o,"xmlns:x":ys_x,"xmlns:mv":"http://macVmlSchemaUri"}).replace(/\/>/,">"),Jt("o:shapelayout",Jt("o:idmap",null,{"v:ext":"edit",data:s}),{"v:ext":"edit"}),Jt("v:shapetype",[Jt("v:stroke",null,{joinstyle:"miter"}),Jt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:a.join(","),path:d})];Cl<1e3*s;)Cl+=1e3;return l.forEach(function(y){var b=Xr(y[0]),C={color2:"#BEFF82",type:"gradient"};"gradient"==C.type&&(C.angle="-180");var I="gradient"==C.type?Jt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,F=Jt("v:fill",I,C);++Cl,h=h.concat(["<v:shape"+ya({id:"_x0000_s"+Cl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(y[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",F,Jt("v:shadow",null,{on:"t",obscured:"t"}),Jt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Xs("x:Anchor",[b.c+1,0,b.r+1,0,b.c+3,20,b.r+5,20].join(",")),Xs("x:AutoFill","False"),Xs("x:Row",String(b.r)),Xs("x:Column",String(b.c)),y[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),h.push("</xml>"),h.join("")}function K1(s,l,a,d){var y,h=Array.isArray(s);l.forEach(function(b){var C=Xr(b.ref);if(h?(s[C.r]||(s[C.r]=[]),y=s[C.r][C.c]):y=s[b.ref],!y){y={t:"z"},h?s[C.r][C.c]=y:s[b.ref]=y;var I=Yi(s["!ref"]||"BDWGO1000001:A1");I.s.r>C.r&&(I.s.r=C.r),I.e.r<C.r&&(I.e.r=C.r),I.s.c>C.c&&(I.s.c=C.c),I.e.c<C.c&&(I.e.c=C.c);var F=yi(I);F!==s["!ref"]&&(s["!ref"]=F)}y.c||(y.c=[]);var O={a:b.author,t:b.t,r:b.r,T:a};b.h&&(O.h=b.h);for(var H=y.c.length-1;H>=0;--H){if(!a&&y.c[H].T)return;a&&!y.c[H].T&&y.c.splice(H,1)}if(a&&d)for(H=0;H<d.length;++H)if(O.a==d[H].id){O.a=d[H].name||O.a;break}y.c.push(O)})}function tm(s){var l=[br,Jt("comments",null,{xmlns:Bd[0]})],a=[];return l.push("<authors>"),s.forEach(function(d){d[1].forEach(function(h){var y=Vt(h.a);-1==a.indexOf(y)&&(a.push(y),l.push("<author>"+y+"</author>")),h.T&&h.ID&&-1==a.indexOf("tc="+h.ID)&&(a.push("tc="+h.ID),l.push("<author>tc="+h.ID+"</author>"))})}),0==a.length&&(a.push("SheetJ5"),l.push("<author>SheetJ5</author>")),l.push("</authors>"),l.push("<commentList>"),s.forEach(function(d){var h=0,y=[];if(d[1][0]&&d[1][0].T&&d[1][0].ID?h=a.indexOf("tc="+d[1][0].ID):d[1].forEach(function(I){I.a&&(h=a.indexOf(Vt(I.a))),y.push(I.t||"")}),l.push('<comment ref="'+d[0]+'" authorId="'+h+'"><text>'),y.length<=1)l.push(Xs("t",Vt(y[0]||"")));else{for(var b="Comment:\n    "+y[0]+"\n",C=1;C<y.length;++C)b+="Reply:\n    "+y[C]+"\n";l.push(Xs("t",Vt(b)))}l.push("</text></comment>")}),l.push("</commentList>"),l.length>2&&(l[l.length]="</comments>",l[1]=l[1].replace("/>",">")),l.join("")}function Yx(s,l,a){var d=[br,Jt("ThreadedComments",null,{xmlns:is_TCMNT}).replace(/[\/]>/,">")];return s.forEach(function(h){var y="";(h[1]||[]).forEach(function(b,C){if(b.T){b.a&&-1==l.indexOf(b.a)&&l.push(b.a);var I={ref:h[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+a.tcid++).slice(-12)+"}"};0==C?y=I.id:I.parentId=y,b.ID=I.id,b.a&&(I.personId="{54EE7950-7262-4200-6969-"+("000000000000"+l.indexOf(b.a)).slice(-12)+"}"),d.push(Jt("threadedComment",Xs("text",b.t||""),I))}else delete b.ID})}),d.push("</ThreadedComments>"),d.join("")}var Kg=xa;function X1(s){var l=Vn(),a=[];return Nt(l,628),Nt(l,630),s.forEach(function(d){d[1].forEach(function(h){a.indexOf(h.a)>-1||(a.push(h.a.slice(0,54)),Nt(l,632,function Yg(s){return js(s.slice(0,54))}(h.a)))})}),Nt(l,631),Nt(l,633),s.forEach(function(d){d[1].forEach(function(h){h.iauthor=a.indexOf(h.a);var y={s:Xr(d[0]),e:Xr(d[0])};Nt(l,635,function Jx(s,l){return null==l&&(l=Tt(36)),l.write_shift(4,s[1].iauthor),$f(s[0],l),l.write_shift(4,0),l.write_shift(4,0),l.write_shift(4,0),l.write_shift(4,0),l}([y,h])),h.t&&h.t.length>0&&Nt(l,637,function $F(s,l){var a=!1;return null==l&&(a=!0,l=Tt(23+4*s.t.length)),l.write_shift(1,1),js(s.t,l),l.write_shift(4,1),function UF(s,l){l||(l=Tt(4)),l.write_shift(2,s.ich||0),l.write_shift(2,s.ifnt||0)}({ich:0,ifnt:0},l),a?l.slice(0,l.l):l}(h)),Nt(l,636),delete h.iauthor})}),Nt(l,634),Nt(l,629),l.end()}var tw=["xlsb","xlsm","xlam","biff8","xla"],ad=function(){var s=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,l={r:0,c:0};function a(d,h,y,b){var C=!1,I=!1;0==y.length?I=!0:"["==y.charAt(0)&&(I=!0,y=y.slice(1,-1)),0==b.length?C=!0:"["==b.charAt(0)&&(C=!0,b=b.slice(1,-1));var F=y.length>0?0|parseInt(y,10):0,O=b.length>0?0|parseInt(b,10):0;return C?O+=l.c:--O,I?F+=l.r:--F,h+(C?"":"$")+to(O)+(I?"":"$")+jr(F)}return function(h,y){return l=y,h.replace(s,a)}}(),Xg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,rw=function(){return function(l,a){return l.replace(Xg,function(d,h,y,b,C,I){var F=t1(b)-(y?0:a.c),O=zd(I)-(C?0:a.r);return h+"R"+(0==O?"":C?O+1:"["+O+"]")+"C"+(0==F?"":y?F+1:"["+F+"]")})}}();function J1(s,l){return s.replace(Xg,function(a,d,h,y,b,C){return d+("$"==h?h+y:to(t1(y)+l.c))+("$"==b?b+C:jr(zd(C)+l.r))})}function d4(s,l,a){var h=no(l).s,y=Xr(a);return J1(s,{r:y.r-h.r,c:y.c-h.c})}function sw(s){return s.replace(/_xlfn\./g,"")}function Ho(s){s.l+=1}function bs(s,l){var a=s.read_shift(1==l?1:2);return[16383&a,a>>14&1,a>>15&1]}function aw(s,l,a){var d=2;if(a){if(a.biff>=2&&a.biff<=5)return Z1(s);12==a.biff&&(d=4)}var h=s.read_shift(d),y=s.read_shift(d),b=bs(s,2),C=bs(s,2);return{s:{r:h,c:b[0],cRel:b[1],rRel:b[2]},e:{r:y,c:C[0],cRel:C[1],rRel:C[2]}}}function Z1(s){var l=bs(s,2),a=bs(s,2),d=s.read_shift(1),h=s.read_shift(1);return{s:{r:l[0],c:d,cRel:l[1],rRel:l[2]},e:{r:a[0],c:h,cRel:a[1],rRel:a[2]}}}function lw(s,l,a){if(a&&a.biff>=2&&a.biff<=5)return function p4(s){var l=bs(s,2),a=s.read_shift(1);return{r:l[0],c:a,cRel:l[1],rRel:l[2]}}(s);var d=s.read_shift(a&&12==a.biff?4:2),h=bs(s,2);return{r:d,c:h[0],cRel:h[1],rRel:h[2]}}function h4(s){var l=s.read_shift(2),a=s.read_shift(2);return{r:l,c:255&a,fQuoted:!!(16384&a),cRel:a>>15,rRel:a>>15}}function im(s){var l=1&s[s.l+1];return s.l+=4,[l,1]}function Qg(s){return[s.read_shift(1),s.read_shift(1)]}function mw(s,l){var a=[s.read_shift(1)];if(12==l)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2}switch(a[0]){case 4:a[1]=Fo(s,1)?"TRUE":"FALSE",12!=l&&(s.l+=7);break;case 37:case 16:a[1]=su[s[s.l]],s.l+=12==l?4:8;break;case 0:s.l+=8;break;case 1:a[1]=Vr(s);break;case 2:a[1]=xl(s,0,{biff:l>0&&l<8?2:l});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function IP(s,l,a){for(var d=s.read_shift(12==a.biff?4:2),h=[],y=0;y!=d;++y)h.push((12==a.biff?ru:Fg)(s,8));return h}function C4(s,l,a){var d=0,h=0;12==a.biff?(d=s.read_shift(4),h=s.read_shift(4)):(h=1+s.read_shift(1),d=1+s.read_shift(2)),a.biff>=2&&a.biff<8&&(--d,0==--h&&(h=256));for(var y=0,b=[];y!=d&&(b[y]=[]);++y)for(var C=0;C!=h;++C)b[y][C]=mw(s,a.biff);return b}function e0(s,l,a){return s.l+=2,[h4(s)]}function vw(s){return s.l+=6,[]}function t0(s){return s.l+=2,[os(s),1&s.read_shift(2)]}var E4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],Cw={1:{n:"PtgExp",f:function rv(s,l,a){return s.l++,a&&12==a.biff?[s.read_shift(4,"i"),0]:[s.read_shift(2),s.read_shift(a&&2==a.biff?1:2)]}},2:{n:"PtgTbl",f:qi},3:{n:"PtgAdd",f:Ho},4:{n:"PtgSub",f:Ho},5:{n:"PtgMul",f:Ho},6:{n:"PtgDiv",f:Ho},7:{n:"PtgPower",f:Ho},8:{n:"PtgConcat",f:Ho},9:{n:"PtgLt",f:Ho},10:{n:"PtgLe",f:Ho},11:{n:"PtgEq",f:Ho},12:{n:"PtgGe",f:Ho},13:{n:"PtgGt",f:Ho},14:{n:"PtgNe",f:Ho},15:{n:"PtgIsect",f:Ho},16:{n:"PtgUnion",f:Ho},17:{n:"PtgRange",f:Ho},18:{n:"PtgUplus",f:Ho},19:{n:"PtgUminus",f:Ho},20:{n:"PtgPercent",f:Ho},21:{n:"PtgParen",f:Ho},22:{n:"PtgMissArg",f:Ho},23:{n:"PtgStr",f:function w4(s,l,a){return s.l++,ed(s,0,a)}},26:{n:"PtgSheet",f:function k4(s,l,a){return s.l+=5,s.l+=2,s.l+=2==a.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function lv(s,l,a){return s.l+=2==a.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function DP(s){return s.l++,su[s.read_shift(1)]}},29:{n:"PtgBool",f:function b4(s){return s.l++,0!==s.read_shift(1)}},30:{n:"PtgInt",f:function y4(s){return s.l++,s.read_shift(2)}},31:{n:"PtgNum",f:function x4(s){return s.l++,Vr(s)}},32:{n:"PtgArray",f:function dw(s,l,a){var d=(96&s[s.l++])>>5;return s.l+=2==a.biff?6:12==a.biff?14:7,[d]}},33:{n:"PtgFunc",f:function Jg(s,l,a){var d=(96&s[s.l])>>5;s.l+=1;var h=s.read_shift(a&&a.biff<=3?1:2);return[VP[h],L4[h],d]}},34:{n:"PtgFuncVar",f:function Zg(s,l,a){var d=s[s.l++],h=s.read_shift(1),y=a&&a.biff<=3?[88==d?-1:0,s.read_shift(1)]:function nv(s){return[s[s.l+1]>>7,32767&s.read_shift(2)]}(s);return[h,(0===y[0]?L4:N4)[y[1]]]}},35:{n:"PtgName",f:function AP(s,l,a){var d=s.read_shift(1)>>>5&3,y=s.read_shift(!a||a.biff>=8?4:2);switch(a.biff){case 2:s.l+=5;break;case 3:case 4:s.l+=8;break;case 5:s.l+=12}return[d,0,y]}},36:{n:"PtgRef",f:function EP(s,l,a){var d=(96&s[s.l])>>5;return s.l+=1,[d,lw(s,0,a)]}},37:{n:"PtgArea",f:function g4(s,l,a){return[(96&s[s.l++])>>5,aw(s,0,a)]}},38:{n:"PtgMemArea",f:function T4(s,l,a){var d=s.read_shift(1)>>>5&3;return s.l+=a&&2==a.biff?3:4,[d,s.read_shift(a&&2==a.biff?1:2)]}},39:{n:"PtgMemErr",f:qi},40:{n:"PtgMemNoMem",f:qi},41:{n:"PtgMemFunc",f:function ov(s,l,a){return[s.read_shift(1)>>>5&3,s.read_shift(a&&2==a.biff?1:2)]}},42:{n:"PtgRefErr",f:function MP(s,l,a){var d=s.read_shift(1)>>>5&3;return s.l+=4,a.biff<8&&s.l--,12==a.biff&&(s.l+=2),[d]}},43:{n:"PtgAreaErr",f:function mi(s,l,a){var d=(96&s[s.l++])>>5;return s.l+=a&&a.biff>8?12:a.biff<8?6:8,[d]}},44:{n:"PtgRefN",f:function hw(s,l,a){var d=(96&s[s.l])>>5;s.l+=1;var h=function cw(s,l,a){var d=a&&a.biff?a.biff:8;if(d>=2&&d<=5)return function m4(s){var l=s.read_shift(2),a=s.read_shift(1),d=(32768&l)>>15,h=(16384&l)>>14;return l&=16383,1==d&&l>=8192&&(l-=16384),1==h&&a>=128&&(a-=256),{r:l,c:a,cRel:h,rRel:d}}(s);var h=s.read_shift(d>=12?4:2),y=s.read_shift(2),b=(16384&y)>>14,C=(32768&y)>>15;if(y&=16383,1==C)for(;h>524287;)h-=1048576;if(1==b)for(;y>8191;)y-=16384;return{r:h,c:y,cRel:b,rRel:C}}(s,0,a);return[d,h]}},45:{n:"PtgAreaN",f:function uw(s,l,a){var d=(96&s[s.l++])>>5,h=function f4(s,l,a){if(a.biff<8)return Z1(s);var d=s.read_shift(12==a.biff?4:2),h=s.read_shift(12==a.biff?4:2),y=bs(s,2),b=bs(s,2);return{s:{r:d,c:y[0],cRel:y[1],rRel:y[2]},e:{r:h,c:b[0],cRel:b[1],rRel:b[2]}}}(s,0,a);return[d,h]}},46:{n:"PtgMemAreaN",f:function D4(s){return[s.read_shift(1)>>>5&3,s.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function ww(s){return[s.read_shift(1)>>>5&3,s.read_shift(2)]}},57:{n:"PtgNameX",f:function gw(s,l,a){return 5==a.biff?function _w(s){var l=s.read_shift(1)>>>5&3,a=s.read_shift(2,"i");s.l+=8;var d=s.read_shift(2);return s.l+=12,[l,a,d]}(s):[s.read_shift(1)>>>5&3,s.read_shift(2),s.read_shift(4)]}},58:{n:"PtgRef3d",f:function kP(s,l,a){var d=(96&s[s.l])>>5;s.l+=1;var h=s.read_shift(2);return a&&5==a.biff&&(s.l+=12),[d,h,lw(s,0,a)]}},59:{n:"PtgArea3d",f:function _4(s,l,a){var d=(96&s[s.l++])>>5,h=s.read_shift(2,"i");if(a&&5===a.biff)s.l+=12;return[d,h,aw(s,0,a)]}},60:{n:"PtgRefErr3d",f:function FP(s,l,a){var d=(96&s[s.l++])>>5,h=s.read_shift(2),y=4;if(a)switch(a.biff){case 5:y=15;break;case 12:y=6}return s.l+=y,[d,h]}},61:{n:"PtgAreaErr3d",f:function v(s,l,a){var d=(96&s[s.l++])>>5,h=s.read_shift(2),y=8;if(a)switch(a.biff){case 5:s.l+=12,y=6;break;case 12:y=12}return s.l+=y,[d,h]}},255:{}},rm={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},sp={1:{n:"PtgElfLel",f:t0},2:{n:"PtgElfRw",f:e0},3:{n:"PtgElfCol",f:e0},6:{n:"PtgElfRwV",f:e0},7:{n:"PtgElfColV",f:e0},10:{n:"PtgElfRadical",f:e0},11:{n:"PtgElfRadicalS",f:vw},13:{n:"PtgElfColS",f:vw},15:{n:"PtgElfColSV",f:vw},16:{n:"PtgElfRadicalLel",f:t0},25:{n:"PtgList",f:function cd(s){s.l+=2;var l=s.read_shift(2),a=s.read_shift(2),d=s.read_shift(4),h=s.read_shift(2),y=s.read_shift(2);return{ixti:l,coltype:3&a,rt:E4[a>>2&31],idx:d,c:h,C:y}}},29:{n:"PtgSxName",f:function xw(s){return s.l+=2,[s.read_shift(4)]}},255:{}},cv={0:{n:"PtgAttrNoop",f:function I4(s){return s.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function du(s,l,a){var d=255&s[s.l+1]?1:0;return s.l+=a&&2==a.biff?3:4,[d]}},2:{n:"PtgAttrIf",f:function v4(s,l,a){var d=255&s[s.l+1]?1:0;return s.l+=2,[d,s.read_shift(a&&2==a.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function Zl(s,l,a){s.l+=2;for(var d=s.read_shift(a&&2==a.biff?1:2),h=[],y=0;y<=d;++y)h.push(s.read_shift(a&&2==a.biff?1:2));return h}},8:{n:"PtgAttrGoto",f:function fw(s,l,a){var d=255&s[s.l+1]?1:0;return s.l+=2,[d,s.read_shift(a&&2==a.biff?1:2)]}},16:{n:"PtgAttrSum",f:function iv(s,l,a){s.l+=a&&2==a.biff?3:4}},32:{n:"PtgAttrBaxcel",f:im},33:{n:"PtgAttrBaxcel",f:im},64:{n:"PtgAttrSpace",f:function pw(s){return s.read_shift(2),Qg(s)}},65:{n:"PtgAttrSpaceSemi",f:function tv(s){return s.read_shift(2),Qg(s)}},128:{n:"PtgAttrIfError",f:function ev(s){var l=255&s[s.l+1]?1:0;return s.l+=2,[l,s.read_shift(2)]}},255:{}};function Ac(s,l,a,d){if(d.biff<8)return qi(s,l);for(var h=s.l+l,y=[],b=0;b!==a.length;++b)switch(a[b][0]){case"PtgArray":a[b][1]=C4(s,0,d),y.push(a[b][1]);break;case"PtgMemArea":a[b][2]=IP(s,0,d),y.push(a[b][2]);break;case"PtgExp":d&&12==d.biff&&(a[b][1][1]=s.read_shift(4),y.push(a[b][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[b][0]}return 0!=(l=h-s.l)&&y.push(qi(s,l)),y}function fu(s,l,a){for(var h,y,d=s.l+l,b=[];d!=s.l;)l=d-s.l,h=Cw[y=s[s.l]]||Cw[rm[y]],(24===y||25===y)&&(h=(24===y?sp:cv)[s[s.l+1]]),h&&h.f?b.push([h.n,h.f(s,l,a)]):qi(s,l);return b}function ap(s){for(var l=[],a=0;a<s.length;++a){for(var d=s[a],h=[],y=0;y<d.length;++y){var b=d[y];h.push(b?2===b[0]?'"'+b[1].replace(/"/g,'""')+'"':b[1]:"")}l.push(h.join(","))}return l.join(";")}var A4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function uv(s,l,a){if(!s)return"SH33TJSERR0";if(a.biff>8&&(!s.XTI||!s.XTI[l]))return s.SheetNames[l];if(!s.XTI)return"SH33TJSERR6";var d=s.XTI[l];if(a.biff<8)return l>1e4&&(l-=65536),l<0&&(l=-l),0==l?"":s.XTI[l-1];if(!d)return"SH33TJSERR1";var h="";if(a.biff>8)switch(s[d[0]][0]){case 357:return h=-1==d[1]?"#REF":s.SheetNames[d[1]],d[1]==d[2]?h:h+":"+s.SheetNames[d[2]];case 358:return null!=a.SID?s.SheetNames[a.SID]:"SH33TJSSAME"+s[d[0]][0];default:return"SH33TJSSRC"+s[d[0]][0]}switch(s[d[0]][0][0]){case 1025:return h=-1==d[1]?"#REF":s.SheetNames[d[1]]||"SH33TJSERR3",d[1]==d[2]?h:h+":"+s.SheetNames[d[2]];case 14849:return s[d[0]].slice(1).map(function(y){return y.Name}).join(";;");default:return s[d[0]][0][3]?(h=-1==d[1]?"#REF":s[d[0]][0][3][d[1]]||"SH33TJSERR4",d[1]==d[2]?h:h+":"+s[d[0]][0][3][d[2]]):"SH33TJSERR2"}}function n0(s,l,a){var d=uv(s,l,a);return"#REF"==d?d:function Tw(s,l){if(!(s||l&&l.biff<=5&&l.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(s)?"'"+s+"'":s}(d,a)}function xs(s,l,a,d,h){var I,F,O,G,y=h&&h.biff||8,b={s:{c:0,r:0},e:{c:0,r:0}},C=[],H=0,W=0,X="";if(!s[0]||!s[0][0])return"";for(var V=-1,Z="",he=0,ge=s[0].length;he<ge;++he){var le=s[0][he];switch(le[0]){case"PtgUminus":C.push("-"+C.pop());break;case"PtgUplus":C.push("+"+C.pop());break;case"PtgPercent":C.push(C.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(I=C.pop(),F=C.pop(),V>=0){switch(s[0][V][1][0]){case 0:Z=uo(" ",s[0][V][1][1]);break;case 1:Z=uo("\r",s[0][V][1][1]);break;default:if(Z="",h.WTF)throw new Error("Unexpected PtgAttrSpaceType "+s[0][V][1][0])}F+=Z,V=-1}C.push(F+A4[le[0]]+I);break;case"PtgIsect":I=C.pop(),F=C.pop(),C.push(F+" "+I);break;case"PtgUnion":I=C.pop(),F=C.pop(),C.push(F+","+I);break;case"PtgRange":I=C.pop(),F=C.pop(),C.push(F+":"+I);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":O=bc(le[1][1],b,h),C.push(xc(O,y));break;case"PtgRefN":O=a?bc(le[1][1],a,h):le[1][1],C.push(xc(O,y));break;case"PtgRef3d":H=le[1][1],O=bc(le[1][2],b,h),X=n0(d,H,h),C.push(X+"!"+xc(O,y));break;case"PtgFunc":case"PtgFuncVar":var tt=le[1][0],ze=le[1][1];tt||(tt=0);var be=0==(tt&=127)?[]:C.slice(-tt);C.length-=tt,"User"===ze&&(ze=be.shift()),C.push(ze+"("+be.join(",")+")");break;case"PtgBool":C.push(le[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":C.push(le[1]);break;case"PtgNum":C.push(String(le[1]));break;case"PtgStr":C.push('"'+le[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":G=fg(le[1][1],a?{s:a}:b,h),C.push(Js(G,h));break;case"PtgArea":G=fg(le[1][1],b,h),C.push(Js(G,h));break;case"PtgArea3d":G=le[1][2],X=n0(d,H=le[1][1],h),C.push(X+"!"+Js(G,h));break;case"PtgAttrSum":C.push("SUM("+C.pop()+")");break;case"PtgName":var Qe=(d.names||[])[(W=le[1][2])-1]||(d[0]||[])[W],qe=Qe?Qe.Name:"SH33TJSNAME"+String(W);qe&&"_xlfn."==qe.slice(0,6)&&!h.xlfn&&(qe=qe.slice(6)),C.push(qe);break;case"PtgNameX":var bt,gt=le[1][1];if(W=le[1][2],!(h.biff<=5)){var et="";if(14849==((d[gt]||[])[0]||[])[0]||(1025==((d[gt]||[])[0]||[])[0]?d[gt][W]&&d[gt][W].itab>0&&(et=d.SheetNames[d[gt][W].itab-1]+"!"):et=d.SheetNames[W-1]+"!"),d[gt]&&d[gt][W])et+=d[gt][W].Name;else if(d[0]&&d[0][W])et+=d[0][W].Name;else{var Xt=(uv(d,gt,h)||"").split(";;");Xt[W-1]?et=Xt[W-1]:et+="SH33TJSERRX"}C.push(et);break}gt<0&&(gt=-gt),d[gt]&&(bt=d[gt][W]),bt||(bt={Name:"SH33TJSERRY"}),C.push(bt.Name);break;case"PtgParen":var vn="(",Zt=")";if(V>=0){switch(Z="",s[0][V][1][0]){case 2:vn=uo(" ",s[0][V][1][1])+vn;break;case 3:vn=uo("\r",s[0][V][1][1])+vn;break;case 4:Zt=uo(" ",s[0][V][1][1])+Zt;break;case 5:Zt=uo("\r",s[0][V][1][1])+Zt;break;default:if(h.WTF)throw new Error("Unexpected PtgAttrSpaceType "+s[0][V][1][0])}V=-1}C.push(vn+C.pop()+Zt);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":C.push("#REF!");break;case"PtgExp":var Fn={c:a.c,r:a.r};if(d.sharedf[qn(O={c:le[1][1],r:le[1][0]})]){var Dn=d.sharedf[qn(O)];C.push(xs(Dn,0,Fn,d,h))}else{var Li=!1;for(I=0;I!=d.arrayf.length;++I)if(!(O.c<(F=d.arrayf[I])[0].s.c||O.c>F[0].e.c||O.r<F[0].s.r||O.r>F[0].e.r)){C.push(xs(F[1],0,Fn,d,h)),Li=!0;break}Li||C.push(le[1])}break;case"PtgArray":C.push("{"+ap(le[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":V=he;break;case"PtgMissArg":C.push("");break;case"PtgList":C.push("Table"+le[1].idx+"[#"+le[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(le))}if(3!=h.biff&&V>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(s[0][he][0])){var Mn=!0;switch((le=s[0][V])[1][0]){case 4:Mn=!1;case 0:Z=uo(" ",le[1][1]);break;case 5:Mn=!1;case 1:Z=uo("\r",le[1][1]);break;default:if(Z="",h.WTF)throw new Error("Unexpected PtgAttrSpaceType "+le[1][0])}C.push((Mn?Z:"")+C.pop()+(Mn?"":Z)),V=-1}}if(C.length>1&&h.WTF)throw new Error("bad formula stack");return C[0]}function Sw(s,l,a){var y,d=s.l+l,h=2==a.biff?1:2,b=s.read_shift(h);if(65535==b)return[[],qi(s,l-2)];var C=fu(s,b,a);return l!==b+h&&(y=Ac(s,l-b-h,C,a)),s.l=d,[C,y]}function Ew(s,l,a){var h,d=s.l+l,y=s.read_shift(2),b=fu(s,y,a);return 65535==y?[[],qi(s,l-2)]:(l!==y+2&&(h=Ac(s,d-y-2,b,a)),[b,h])}function o0(s,l,a){var d=s.l+l,h=Xa(s);2==a.biff&&++s.l;var y=function jP(s){var l;if(65535!==_l(s,s.l+6))return[Vr(s),"n"];switch(s[s.l]){case 0:return s.l+=8,["String","s"];case 1:return l=1===s[s.l+2],s.l+=8,[l,"b"];case 2:return l=s[s.l+2],s.l+=8,[l,"e"];case 3:return s.l+=8,["","s"]}return[]}(s),b=s.read_shift(1);2!=a.biff&&(s.read_shift(1),a.biff>=5&&s.read_shift(4));var C=function r0(s,l,a){var y,d=s.l+l,h=2==a.biff?1:2,b=s.read_shift(h);if(65535==b)return[[],qi(s,l-2)];var C=fu(s,b,a);return l!==b+h&&(y=Ac(s,l-b-h,C,a)),s.l=d,[C,y]}(s,d-s.l,a);return{cell:h,val:y[0],formula:C,shared:b>>3&1,tt:y[1]}}function om(s,l,a){var d=s.read_shift(4),h=fu(s,d,a),y=s.read_shift(4);return[h,y>0?Ac(s,y,h,a):null]}var P4=om,s0=om,Za=om,O4=om,N4={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},L4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},VP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function dv(s){return"of:"==s.slice(0,3)&&(s=s.slice(3)),61==s.charCodeAt(0)&&61==(s=s.slice(1)).charCodeAt(0)&&(s=s.slice(1)),(s=(s=(s=s.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(l,a){return a.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function UP(s){return("of:="+s.replace(Xg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function fv(s){var l=s.split(":");return[l[0].split(".")[0],l[0].split(".")[1]+(l.length>1?":"+(l[1].split(".")[1]||l[1].split(".")[0]):"")]}function pv(s){return s.replace(/\./,"!")}var lp={},cp={},sm="undefined"!=typeof Map;function hv(s,l,a){var d=0,h=s.length;if(a){if(sm?a.has(l):Object.prototype.hasOwnProperty.call(a,l))for(var y=sm?a.get(l):a[l];d<y.length;++d)if(s[y[d]].t===l)return s.Count++,y[d]}else for(;d<h;++d)if(s[d].t===l)return s.Count++,d;return s[h]={t:l},s.Count++,s.Unique++,a&&(sm?(a.has(l)||a.set(l,[]),a.get(l).push(h)):(Object.prototype.hasOwnProperty.call(a,l)||(a[l]=[]),a[l].push(h))),h}function am(s,l){var a={min:s+1,max:s+1},d=-1;return l.MDW&&(Us=l.MDW),null!=l.width?a.customWidth=1:null!=l.wpx?d=rd(l.wpx):null!=l.wch&&(d=l.wch),d>-1?(a.width=Yh(d),a.customWidth=1):null!=l.width&&(a.width=l.width),l.hidden&&(a.hidden=!0),null!=l.level&&(a.outlineLevel=a.level=l.level),a}function Jd(s,l){if(s){var a=[.7,.7,.75,.75,.3,.3];"xlml"==l&&(a=[1,1,1,1,.5,.5]),null==s.left&&(s.left=a[0]),null==s.right&&(s.right=a[1]),null==s.top&&(s.top=a[2]),null==s.bottom&&(s.bottom=a[3]),null==s.header&&(s.header=a[4]),null==s.footer&&(s.footer=a[5])}}function pu(s,l,a){var d=a.revssf[null!=l.z?l.z:"General"],h=60,y=s.length;if(null==d&&a.ssf)for(;h<392;++h)if(null==a.ssf[h]){gc(l.z,h),a.ssf[h]=l.z,a.revssf[l.z]=d=h;break}for(h=0;h!=y;++h)if(s[h].numFmtId===d)return h;return s[y]={numFmtId:d,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},y}function Dw(s,l,a,d,h,y){try{d.cellNF&&(s.z=Wn[l])}catch(C){if(d.WTF)throw C}if("z"!==s.t||d.cellStyles){if("d"===s.t&&"string"==typeof s.v&&(s.v=Kn(s.v)),(!d||!1!==d.cellText)&&"z"!==s.t)try{if(null==Wn[l]&&gc(I5[l]||"General",l),"e"===s.t)s.w=s.w||su[s.v];else if(0===l)if("n"===s.t)s.w=(0|s.v)===s.v?s.v.toString(10):jf(s.v);else if("d"===s.t){var b=ns(s.v);s.w=(0|b)===b?b.toString(10):jf(b)}else{if(void 0===s.v)return"";s.w=Od(s.v,cp)}else s.w=Ka(l,"d"===s.t?ns(s.v):s.v,cp)}catch(C){if(d.WTF)throw C}if(d.cellStyles&&null!=a)try{s.s=y.Fills[a],s.s.fgColor&&s.s.fgColor.theme&&!s.s.fgColor.rgb&&(s.s.fgColor.rgb=$g(h.themeElements.clrScheme[s.s.fgColor.theme].rgb,s.s.fgColor.tint||0),d.WTF&&(s.s.fgColor.raw_rgb=h.themeElements.clrScheme[s.s.fgColor.theme].rgb)),s.s.bgColor&&s.s.bgColor.theme&&(s.s.bgColor.rgb=$g(h.themeElements.clrScheme[s.s.bgColor.theme].rgb,s.s.bgColor.tint||0),d.WTF&&(s.s.bgColor.raw_rgb=h.themeElements.clrScheme[s.s.bgColor.theme].rgb))}catch(C){if(d.WTF&&y.Fills)throw C}}}function R4(s,l,a){if(s&&s["!ref"]){var d=Yi(s["!ref"]);if(d.e.c<d.s.c||d.e.r<d.s.r)throw new Error("Bad range ("+a+"): "+s["!ref"])}}var Aw=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,B4=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Mc=/<(?:\w:)?hyperlink [^>]*>/gm,mv=/"(\w*:\w*)"/,j4=/<(?:\w:)?col\b[^>]*[\/]?>/g,V4=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,HP=/<(?:\w:)?pageMargins[^>]*\/>/g,gv=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,U4=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,H4=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function vv(s,l,a,d){var h=Qn(s);a.Sheets[d]||(a.Sheets[d]={}),h.codeName&&(a.Sheets[d].CodeName=lr(_n(h.codeName)))}var yv=["objects","scenarios","selectLockedCells","selectUnlockedCells"],W4=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],Fw=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Nw(s,l,a,d){if(s.c&&a["!comments"].push([l,s.c]),void 0===s.v&&"string"!=typeof s.f||"z"===s.t&&!s.f)return"";var h="",y=s.t,b=s.v;if("z"!==s.t)switch(s.t){case"b":h=s.v?"1":"0";break;case"n":h=""+s.v;break;case"e":h=su[s.v];break;case"d":d&&d.cellDates?h=Kn(s.v,-1).toISOString():((s=Bn(s)).t="n",h=""+(s.v=ns(Kn(s.v)))),void 0===s.z&&(s.z=Wn[14]);break;default:h=s.v}var C=Xs("v",Vt(h)),I={r:l},F=pu(d.cellXfs,s,d);switch(0!==F&&(I.s=F),s.t){case"n":case"z":break;case"d":I.t="d";break;case"b":I.t="b";break;case"e":I.t="e";break;default:if(null==s.v){delete s.t;break}if(s.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(d&&d.bookSST){C=Xs("v",""+hv(d.Strings,s.v,d.revStrings)),I.t="s";break}I.t="str"}if(s.t!=y&&(s.t=y,s.v=b),"string"==typeof s.f&&s.f){var O=s.F&&s.F.slice(0,l.length)==l?{t:"array",ref:s.F}:null;C=Jt("f",Vt(s.f),O)+(null!=s.v?C:"")}return s.l&&a["!links"].push([l,s.l]),s.D&&(I.cm=1),Jt("c",C,I)}var Lw=function(){var s=/<(?:\w+:)?c[ \/>]/,l=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,d=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,h=/ref=["']([^"']*)["']/,y=Sh("v"),b=Sh("f");return function(I,F,O,H,W,G){for(var ze,be,gt,bt,Zt,X=0,V="",Z=[],he=[],ge=0,le=0,Ke=0,tt="",Qe=0,qe=0,et=0,Xt=0,vn=Array.isArray(G.CellXf),Fn=[],Dn=[],Li=Array.isArray(F),ln=[],Mn={},Pt=!1,Ee=!!O.sheetStubs,dt=I.split(l),Fe=0,Pe=dt.length;Fe!=Pe;++Fe){var It=(V=dt[Fe].trim()).length;if(0!==It){var sn=0;e:for(X=0;X<It;++X)switch(V[X]){case">":if("/"!=V[X-1]){++X;break e}if(O&&O.cellStyles){if(Qe=null!=(be=Qn(V.slice(sn,X),!0)).r?parseInt(be.r,10):Qe+1,qe=-1,O.sheetRows&&O.sheetRows<Qe)continue;Mn={},Pt=!1,be.ht&&(Pt=!0,Mn.hpt=parseFloat(be.ht),Mn.hpx=Xh(Mn.hpt)),"1"==be.hidden&&(Pt=!0,Mn.hidden=!0),null!=be.outlineLevel&&(Pt=!0,Mn.level=+be.outlineLevel),Pt&&(ln[Qe-1]=Mn)}break;case"<":sn=X}if(sn>=X)break;if(Qe=null!=(be=Qn(V.slice(sn,X),!0)).r?parseInt(be.r,10):Qe+1,qe=-1,!(O.sheetRows&&O.sheetRows<Qe)){H.s.r>Qe-1&&(H.s.r=Qe-1),H.e.r<Qe-1&&(H.e.r=Qe-1),O&&O.cellStyles&&(Mn={},Pt=!1,be.ht&&(Pt=!0,Mn.hpt=parseFloat(be.ht),Mn.hpx=Xh(Mn.hpt)),"1"==be.hidden&&(Pt=!0,Mn.hidden=!0),null!=be.outlineLevel&&(Pt=!0,Mn.level=+be.outlineLevel),Pt&&(ln[Qe-1]=Mn)),Z=V.slice(X).split(s);for(var Yt=0;Yt!=Z.length&&"<"==Z[Yt].trim().charAt(0);++Yt);for(Z=Z.slice(Yt),X=0;X!=Z.length;++X)if(0!==(V=Z[X].trim()).length){if(he=V.match(a),ge=X,le=0,Ke=0,V="<c "+("<"==V.slice(0,1)?">":"")+V,null!=he&&2===he.length){for(ge=0,tt=he[1],le=0;le!=tt.length&&!((Ke=tt.charCodeAt(le)-64)<1||Ke>26);++le)ge=26*ge+Ke;qe=--ge}else++qe;for(le=0;le!=V.length&&62!==V.charCodeAt(le);++le);if(++le,(be=Qn(V.slice(0,le),!0)).r||(be.r=qn({r:Qe-1,c:qe})),ze={t:""},null!=(he=(tt=V.slice(le)).match(y))&&""!==he[1]&&(ze.v=lr(he[1])),O.cellFormula){if(null!=(he=tt.match(b))&&""!==he[1]){if(ze.f=lr(_n(he[1])).replace(/\r\n/g,"\n"),O.xlfn||(ze.f=sw(ze.f)),he[0].indexOf('t="array"')>-1)ze.F=(tt.match(h)||[])[1],ze.F.indexOf(":")>-1&&Fn.push([Yi(ze.F),ze.F]);else if(he[0].indexOf('t="shared"')>-1){bt=Qn(he[0]);var Qt=lr(_n(he[1]));O.xlfn||(Qt=sw(Qt)),Dn[parseInt(bt.si,10)]=[bt,Qt,be.r]}}else(he=tt.match(/<f[^>]*\/>/))&&Dn[(bt=Qn(he[0])).si]&&(ze.f=d4(Dn[bt.si][1],Dn[bt.si][2],be.r));var Rt=Xr(be.r);for(le=0;le<Fn.length;++le)Rt.r>=Fn[le][0].s.r&&Rt.r<=Fn[le][0].e.r&&Rt.c>=Fn[le][0].s.c&&Rt.c<=Fn[le][0].e.c&&(ze.F=Fn[le][1])}if(null==be.t&&void 0===ze.v)if(ze.f||ze.F)ze.v=0,ze.t="n";else{if(!Ee)continue;ze.t="z"}else ze.t=be.t||"n";switch(H.s.c>qe&&(H.s.c=qe),H.e.c<qe&&(H.e.c=qe),ze.t){case"n":if(""==ze.v||null==ze.v){if(!Ee)continue;ze.t="z"}else ze.v=parseFloat(ze.v);break;case"s":if(void 0===ze.v){if(!Ee)continue;ze.t="z"}else gt=lp[parseInt(ze.v,10)],ze.v=gt.t,ze.r=gt.r,O.cellHTML&&(ze.h=gt.h);break;case"str":ze.t="s",ze.v=null!=ze.v?_n(ze.v):"",O.cellHTML&&(ze.h=Th(ze.v));break;case"inlineStr":he=tt.match(d),ze.t="s",null!=he&&(gt=P1(he[1]))?(ze.v=gt.t,O.cellHTML&&(ze.h=gt.h)):ze.v="";break;case"b":ze.v=Kr(ze.v);break;case"d":O.cellDates?ze.v=Kn(ze.v,1):(ze.v=ns(Kn(ze.v,1)),ze.t="n");break;case"e":(!O||!1!==O.cellText)&&(ze.w=ze.v),ze.v=b2[ze.v]}if(et=Xt=0,Zt=null,vn&&void 0!==be.s&&null!=(Zt=G.CellXf[be.s])&&(null!=Zt.numFmtId&&(et=Zt.numFmtId),O.cellStyles&&null!=Zt.fillId&&(Xt=Zt.fillId)),Dw(ze,et,Xt,O,W,G),O.cellDates&&vn&&"n"==ze.t&&Ku(Wn[et])&&(ze.t="d",ze.v=ng(ze.v)),be.cm&&O.xlmeta){var gi=(O.xlmeta.Cell||[])[+be.cm-1];gi&&"XLDAPR"==gi.type&&(ze.D=!0)}if(Li){var Se=Xr(be.r);F[Se.r]||(F[Se.r]=[]),F[Se.r][Se.c]=ze}else F[be.r]=ze}}}}ln.length>0&&(F["!rows"]=ln)}}();function lm(s,l,a,d){var b,h=[br,Jt("worksheet",null,{xmlns:Bd[0],"xmlns:r":is_r})],C="",I=a.Sheets[a.SheetNames[s]];null==I&&(I={});var F=I["!ref"]||"A1",O=Yi(F);if(O.e.c>16383||O.e.r>1048575){if(l.WTF)throw new Error("Range "+F+" exceeds format limit A1:XFD1048576");O.e.c=Math.min(O.e.c,16383),O.e.r=Math.min(O.e.c,1048575),F=yi(O)}d||(d={}),I["!comments"]=[];var H=[];(function a0(s,l,a,d,h){var y=!1,b={},C=null;if("xlsx"!==d.bookType&&l.vbaraw){var I=l.SheetNames[a];try{l.Workbook&&(I=l.Workbook.Sheets[a].CodeName||I)}catch(O){}y=!0,b.codeName=hl(Vt(I))}if(s&&s["!outline"]){var F={summaryBelow:1,summaryRight:1};s["!outline"].above&&(F.summaryBelow=0),s["!outline"].left&&(F.summaryRight=0),C=(C||"")+Jt("outlinePr",null,F)}!y&&!C||(h[h.length]=Jt("sheetPr",C,b))})(I,a,s,l,h),h[h.length]=Jt("dimension",null,{ref:F}),h[h.length]=function Ow(s,l,a,d){var h={workbookViewId:"0"};return(((d||{}).Workbook||{}).Views||[])[0]&&(h.rightToLeft=d.Workbook.Views[0].RTL?"1":"0"),Jt("sheetViews",Jt("sheetView",null,h),{})}(0,0,0,a),l.sheetFormat&&(h[h.length]=Jt("sheetFormatPr",null,{defaultRowHeight:l.sheetFormat.defaultRowHeight||"16",baseColWidth:l.sheetFormat.baseColWidth||"10",outlineLevelRow:l.sheetFormat.outlineLevelRow||"7"})),null!=I["!cols"]&&I["!cols"].length>0&&(h[h.length]=function wv(s,l){for(var d,a=["<cols>"],h=0;h!=l.length;++h)!(d=l[h])||(a[a.length]=Jt("col",null,am(h,d)));return a[a.length]="</cols>",a.join("")}(0,I["!cols"])),h[b=h.length]="<sheetData/>",I["!links"]=[],null!=I["!ref"]&&(C=function hu(s,l,a,d){var I,Z,h=[],y=[],b=Yi(s["!ref"]),C="",F="",O=[],H=0,W=0,G=s["!rows"],X=Array.isArray(s),V={r:F},he=-1;for(W=b.s.c;W<=b.e.c;++W)O[W]=to(W);for(H=b.s.r;H<=b.e.r;++H){for(y=[],F=jr(H),W=b.s.c;W<=b.e.c;++W){I=O[W]+F;var ge=X?(s[H]||[])[W]:s[I];void 0!==ge&&null!=(C=Nw(ge,I,s,l))&&y.push(C)}(y.length>0||G&&G[H])&&(V={r:F},G&&G[H]&&((Z=G[H]).hidden&&(V.hidden=1),he=-1,Z.hpx?he=qg(Z.hpx):Z.hpt&&(he=Z.hpt),he>-1&&(V.ht=he,V.customHeight=1),Z.level&&(V.outlineLevel=Z.level)),h[h.length]=Jt("row",y.join(""),V))}if(G)for(;H<G.length;++H)G&&G[H]&&(V={r:H+1},(Z=G[H]).hidden&&(V.hidden=1),he=-1,Z.hpx?he=qg(Z.hpx):Z.hpt&&(he=Z.hpt),he>-1&&(V.ht=he,V.customHeight=1),Z.level&&(V.outlineLevel=Z.level),h[h.length]=Jt("row","",V));return h.join("")}(I,l),C.length>0&&(h[h.length]=C)),h.length>b+1&&(h[h.length]="</sheetData>",h[b]=h[b].replace("/>",">")),I["!protect"]&&(h[h.length]=function bv(s){var l={sheet:1};return yv.forEach(function(a){null!=s[a]&&s[a]&&(l[a]="1")}),W4.forEach(function(a){null!=s[a]&&!s[a]&&(l[a]="0")}),s.password&&(l.password=qh(s.password).toString(16).toUpperCase()),Jt("sheetProtection",null,l)}(I["!protect"])),null!=I["!autofilter"]&&(h[h.length]=function K4(s,l,a,d){var h="string"==typeof s.ref?s.ref:yi(s.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var y=a.Workbook.Names,b=no(h);b.s.r==b.e.r&&(b.e.r=no(l["!ref"]).e.r,h=yi(b));for(var C=0;C<y.length;++C){var I=y[C];if("_xlnm._FilterDatabase"==I.Name&&I.Sheet==d){I.Ref="'"+a.SheetNames[d]+"'!"+h;break}}return C==y.length&&y.push({Name:"_xlnm._FilterDatabase",Sheet:d,Ref:"'"+a.SheetNames[d]+"'!"+h}),Jt("autoFilter",null,{ref:h})}(I["!autofilter"],I,a,s)),null!=I["!merges"]&&I["!merges"].length>0&&(h[h.length]=function _v(s){if(0===s.length)return"";for(var l='<mergeCells count="'+s.length+'">',a=0;a!=s.length;++a)l+='<mergeCell ref="'+yi(s[a])+'"/>';return l+"</mergeCells>"}(I["!merges"]));var G,W=-1,X=-1;return I["!links"].length>0&&(h[h.length]="<hyperlinks>",I["!links"].forEach(function(V){!V[1].Target||(G={ref:V[0]},"#"!=V[1].Target.charAt(0)&&(X=Ni(d,-1,Vt(V[1].Target).replace(/#.*$/,""),z.HLINK),G["r:id"]="rId"+X),(W=V[1].Target.indexOf("#"))>-1&&(G.location=Vt(V[1].Target.slice(W+1))),V[1].Tooltip&&(G.tooltip=Vt(V[1].Tooltip)),h[h.length]=Jt("hyperlink",null,G))}),h[h.length]="</hyperlinks>"),delete I["!links"],null!=I["!margins"]&&(h[h.length]=function q4(s){return Jd(s),Jt("pageMargins",null,s)}(I["!margins"])),(!l||l.ignoreEC||null==l.ignoreEC)&&(h[h.length]=Xs("ignoredErrors",Jt("ignoredError",null,{numberStoredAsText:1,sqref:F}))),H.length>0&&(X=Ni(d,-1,"../drawings/drawing"+(s+1)+".xml",z.DRAW),h[h.length]=Jt("drawing",null,{"r:id":"rId"+X}),I["!drawing"]=H),I["!comments"].length>0&&(X=Ni(d,-1,"../drawings/vmlDrawing"+(s+1)+".vml",z.VML),h[h.length]=Jt("legacyDrawing",null,{"r:id":"rId"+X}),I["!legacy"]=X),h.length>1&&(h[h.length]="</worksheet>",h[1]=h[1].replace("/>",">")),h.join("")}function $P(s,l,a,d){var h=function X4(s,l,a){var d=Tt(145),h=(a["!rows"]||[])[s]||{};d.write_shift(4,s),d.write_shift(4,0);var y=320;h.hpx?y=20*qg(h.hpx):h.hpt&&(y=20*h.hpt),d.write_shift(2,y),d.write_shift(1,0);var b=0;h.level&&(b|=h.level),h.hidden&&(b|=16),(h.hpx||h.hpt)&&(b|=32),d.write_shift(1,b),d.write_shift(1,0);var C=0,I=d.l;d.l+=4;for(var F={r:s,c:0},O=0;O<16;++O)if(!(l.s.c>O+1<<10||l.e.c<O<<10)){for(var H=-1,W=-1,G=O<<10;G<O+1<<10;++G)F.c=G,(Array.isArray(a)?(a[F.r]||[])[F.c]:a[qn(F)])&&(H<0&&(H=G),W=G);H<0||(++C,d.write_shift(4,H),d.write_shift(4,W))}var V=d.l;return d.l=I,d.write_shift(4,C),d.l=V,d.length>d.l?d.slice(0,d.l):d}(d,a,l);(h.length>17||(l["!rows"]||[])[d])&&Nt(s,0,h)}var Cv=ru,Rw=$f;function ws(s){return[nu(s),Vr(s),"n"]}var qP=ru,GP=$f,hk=["left","right","top","bottom","header","footer"];function _k(s,l,a,d,h,y,b){if(void 0===l.v)return!1;var C="";switch(l.t){case"b":C=l.v?"1":"0";break;case"d":(l=Bn(l)).z=l.z||Wn[14],l.v=ns(Kn(l.v)),l.t="n";break;case"n":case"e":C=""+l.v;break;default:C=l.v}var I={r:a,c:d};switch(I.s=pu(h.cellXfs,l,h),l.l&&y["!links"].push([qn(I),l.l]),l.c&&y["!comments"].push([qn(I),l.c]),l.t){case"s":case"str":return h.bookSST?(C=hv(h.Strings,l.v,h.revStrings),I.t="s",I.v=C,b?Nt(s,18,function rk(s,l,a){return null==a&&(a=Tt(8)),zf(l,a),a.write_shift(4,l.v),a}(0,I)):Nt(s,7,function dp(s,l,a){return null==a&&(a=Tt(12)),Qu(l,a),a.write_shift(4,l.v),a}(0,I))):(I.t="str",b?Nt(s,17,function Gw(s,l,a){return null==a&&(a=Tt(8+4*s.v.length)),zf(l,a),js(s.v,a),a.length>a.l?a.slice(0,a.l):a}(l,I)):Nt(s,6,function ck(s,l,a){return null==a&&(a=Tt(12+4*s.v.length)),Qu(l,a),js(s.v,a),a.length>a.l?a.slice(0,a.l):a}(l,I))),!0;case"n":return l.v==(0|l.v)&&l.v>-1e3&&l.v<1e3?b?Nt(s,13,function qw(s,l,a){return null==a&&(a=Tt(8)),zf(l,a),s1(s.v,a),a}(l,I)):Nt(s,2,function $w(s,l,a){return null==a&&(a=Tt(12)),Qu(l,a),s1(s.v,a),a}(l,I)):b?Nt(s,16,function kv(s,l,a){return null==a&&(a=Tt(12)),zf(l,a),ou(s.v,a),a}(l,I)):Nt(s,5,function sk(s,l,a){return null==a&&(a=Tt(16)),Qu(l,a),ou(s.v,a),a}(l,I)),!0;case"b":return I.t="b",b?Nt(s,15,function ek(s,l,a){return null==a&&(a=Tt(5)),zf(l,a),a.write_shift(1,s.v?1:0),a}(l,I)):Nt(s,4,function Ev(s,l,a){return null==a&&(a=Tt(9)),Qu(l,a),a.write_shift(1,s.v?1:0),a}(l,I)),!0;case"e":return I.t="e",b?Nt(s,14,function tk(s,l,a){return null==a&&(a=Tt(8)),zf(l,a),a.write_shift(1,s.v),a.write_shift(2,0),a.write_shift(1,0),a}(l,I)):Nt(s,3,function up(s,l,a){return null==a&&(a=Tt(9)),Qu(l,a),a.write_shift(1,s.v),a}(l,I)),!0}return b?Nt(s,12,function Vw(s,l,a){return null==a&&(a=Tt(4)),zf(l,a)}(0,I)):Nt(s,1,function Bw(s,l,a){return null==a&&(a=Tt(8)),Qu(l,a)}(0,I)),!0}function Sk(s,l,a,d){var h=Vn(),y=a.SheetNames[s],b=a.Sheets[y]||{},C=y;try{a&&a.Workbook&&(C=a.Workbook.Sheets[s].CodeName||C)}catch(F){}var I=Yi(b["!ref"]||"A1");if(I.e.c>16383||I.e.r>1048575){if(l.WTF)throw new Error("Range "+(b["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");I.e.c=Math.min(I.e.c,16383),I.e.r=Math.min(I.e.c,1048575)}return b["!links"]=[],b["!comments"]=[],Nt(h,129),(a.vbaraw||b["!outline"])&&Nt(h,147,function Q4(s,l,a){null==a&&(a=Tt(84+4*s.length));var d=192;l&&(l.above&&(d&=-65),l.left&&(d&=-129)),a.write_shift(1,d);for(var h=1;h<3;++h)a.write_shift(1,0);return Wf({auto:1},a),a.write_shift(-4,-1),a.write_shift(-4,-1),H5(s,a),a.slice(0,a.l)}(C,b["!outline"])),Nt(h,148,Rw(I)),function Ck(s,l,a){Nt(s,133),Nt(s,137,function mk(s,l,a){null==a&&(a=Tt(30));var d=924;return(((l||{}).Views||[])[0]||{}).RTL&&(d|=32),a.write_shift(2,d),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,100),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a}(0,a)),Nt(s,138),Nt(s,134)}(h,0,a.Workbook),function bk(s,l){!l||!l["!cols"]||(Nt(s,390),l["!cols"].forEach(function(a,d){a&&Nt(s,60,function YP(s,l,a){null==a&&(a=Tt(18));var d=am(s,l);a.write_shift(-4,s),a.write_shift(-4,s),a.write_shift(4,256*(d.width||10)),a.write_shift(4,0);var h=0;return l.hidden&&(h|=1),"number"==typeof d.width&&(h|=2),l.level&&(h|=l.level<<8),a.write_shift(2,h),a}(d,a))}),Nt(s,391))}(h,b),function vk(s,l,a,d){var h=Yi(l["!ref"]||"A1"),b="",C=[];Nt(s,145);var I=Array.isArray(l),F=h.e.r;l["!rows"]&&(F=Math.max(h.e.r,l["!rows"].length-1));for(var O=h.s.r;O<=F;++O){b=jr(O),$P(s,l,h,O);var H=!1;if(O<=h.e.r)for(var W=h.s.c;W<=h.e.c;++W){O===h.s.r&&(C[W]=to(W));var G=I?(l[O]||[])[W]:l[C[W]+b];H=!!G&&_k(s,G,O,W,d,l,H)}}Nt(s,146)}(h,b,0,l),function Tk(s,l){!l["!protect"]||Nt(s,535,function eC(s,l){return null==l&&(l=Tt(66)),l.write_shift(2,s.password?qh(s.password):0),l.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(a){l.write_shift(4,a[1]?null==s[a[0]]||s[a[0]]?0:1:null!=s[a[0]]&&s[a[0]]?0:1)}),l}(l["!protect"]))}(h,b),function fp(s,l,a,d){if(l["!autofilter"]){var h=l["!autofilter"],y="string"==typeof h.ref?h.ref:yi(h.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var b=a.Workbook.Names,C=no(y);C.s.r==C.e.r&&(C.e.r=no(l["!ref"]).e.r,y=yi(C));for(var I=0;I<b.length;++I){var F=b[I];if("_xlnm._FilterDatabase"==F.Name&&F.Sheet==d){F.Ref="'"+a.SheetNames[d]+"'!"+y;break}}I==b.length&&b.push({Name:"_xlnm._FilterDatabase",Sheet:d,Ref:"'"+a.SheetNames[d]+"'!"+y}),Nt(s,161,$f(Yi(y))),Nt(s,162)}}(h,b,a,s),function yk(s,l){!l||!l["!merges"]||(Nt(s,177,function Dv(s,l){return null==l&&(l=Tt(4)),l.write_shift(4,s),l}(l["!merges"].length)),l["!merges"].forEach(function(a){Nt(s,176,GP(a))}),Nt(s,178))}(h,b),function wk(s,l,a){l["!links"].forEach(function(d){if(d[1].Target){var h=Ni(a,-1,d[1].Target.replace(/#.*$/,""),z.HLINK);Nt(s,494,function Yw(s,l){var a=Tt(50+4*(s[1].Target.length+(s[1].Tooltip||"").length));$f({s:Xr(s[0]),e:Xr(s[0])},a),r1("rId"+l,a);var d=s[1].Target.indexOf("#");return js((-1==d?"":s[1].Target.slice(d+1))||"",a),js(s[1].Tooltip||"",a),js("",a),a.slice(0,a.l)}(d,h))}}),delete l["!links"]}(h,b,d),b["!margins"]&&Nt(h,476,function Jw(s,l){return null==l&&(l=Tt(48)),Jd(s),hk.forEach(function(a){ou(s[a],l)}),l}(b["!margins"])),(!l||l.ignoreEC||null==l.ignoreEC)&&function xk(s,l){!l||!l["!ref"]||(Nt(s,648),Nt(s,649,function XP(s){var l=Tt(24);return l.write_shift(4,4),l.write_shift(4,1),$f(s,l),l}(Yi(l["!ref"]))),Nt(s,650))}(h,b),function l0(s,l,a,d){if(l["!comments"].length>0){var h=Ni(d,-1,"../drawings/vmlDrawing"+(a+1)+".vml",z.VML);Nt(s,551,r1("rId"+h)),l["!legacy"]=h}}(h,b,s,d),Nt(h,130),h.end()}var Ai=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],pp=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],hp=[],mp=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ef(s,l){for(var a=0;a!=s.length;++a)for(var d=s[a],h=0;h!=l.length;++h){var y=l[h];if(null==d[y[0]])d[y[0]]=y[1];else switch(y[2]){case"bool":"string"==typeof d[y[0]]&&(d[y[0]]=Kr(d[y[0]]));break;case"int":"string"==typeof d[y[0]]&&(d[y[0]]=parseInt(d[y[0]],10))}}}function tf(s,l){for(var a=0;a!=l.length;++a){var d=l[a];if(null==s[d[0]])s[d[0]]=d[1];else switch(d[2]){case"bool":"string"==typeof s[d[0]]&&(s[d[0]]=Kr(s[d[0]]));break;case"int":"string"==typeof s[d[0]]&&(s[d[0]]=parseInt(s[d[0]],10))}}}function nf(s){tf(s.WBProps,Ai),tf(s.CalcPr,mp),ef(s.WBView,pp),ef(s.Sheets,hp),cp.date1904=Kr(s.WBProps.date1904)}var _p="][*?/\\".split("");function rf(s,l){if(s.length>31){if(l)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var a=!0;return _p.forEach(function(d){if(-1!=s.indexOf(d)){if(!l)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");a=!1}}),a}function Mv(s){if(!s||!s.SheetNames||!s.Sheets)throw new Error("Invalid Workbook");if(!s.SheetNames.length)throw new Error("Workbook is empty");!function tC(s,l,a){s.forEach(function(d,h){rf(d);for(var y=0;y<h;++y)if(d==s[y])throw new Error("Duplicate Sheet Name: "+d);if(a){var b=l&&l[h]&&l[h].CodeName||d;if(95==b.charCodeAt(0)&&b.length>22)throw new Error("Bad Code Name: Worksheet"+b)}})}(s.SheetNames,s.Workbook&&s.Workbook.Sheets||[],!!s.vbaraw);for(var a=0;a<s.SheetNames.length;++a)R4(s.Sheets[s.SheetNames[a]],0,a)}var nC=/<\w+:workbook/;function Fv(s){var l=[br];l[l.length]=Jt("workbook",null,{xmlns:Bd[0],"xmlns:r":is_r});var a=s.Workbook&&(s.Workbook.Names||[]).length>0,d={codeName:"ThisWorkbook"};s.Workbook&&s.Workbook.WBProps&&(Ai.forEach(function(C){null!=s.Workbook.WBProps[C[0]]&&s.Workbook.WBProps[C[0]]!=C[1]&&(d[C[0]]=s.Workbook.WBProps[C[0]])}),s.Workbook.WBProps.CodeName&&(d.codeName=s.Workbook.WBProps.CodeName,delete d.CodeName)),l[l.length]=Jt("workbookPr",null,d);var h=s.Workbook&&s.Workbook.Sheets||[],y=0;if(h&&h[0]&&h[0].Hidden){for(l[l.length]="<bookViews>",y=0;y!=s.SheetNames.length&&h[y]&&h[y].Hidden;++y);y==s.SheetNames.length&&(y=0),l[l.length]='<workbookView firstSheet="'+y+'" activeTab="'+y+'"/>',l[l.length]="</bookViews>"}for(l[l.length]="<sheets>",y=0;y!=s.SheetNames.length;++y){var b={name:Vt(s.SheetNames[y].slice(0,31))};if(b.sheetId=""+(y+1),b["r:id"]="rId"+(y+1),h[y])switch(h[y].Hidden){case 1:b.state="hidden";break;case 2:b.state="veryHidden"}l[l.length]=Jt("sheet",null,b)}return l[l.length]="</sheets>",a&&(l[l.length]="<definedNames>",s.Workbook&&s.Workbook.Names&&s.Workbook.Names.forEach(function(C){var I={name:C.Name};C.Comment&&(I.comment=C.Comment),null!=C.Sheet&&(I.localSheetId=""+C.Sheet),C.Hidden&&(I.hidden="1"),C.Ref&&(l[l.length]=Jt("definedName",Vt(C.Ref),I))}),l[l.length]="</definedNames>"),l.length>2&&(l[l.length]="</workbook>",l[1]=l[1].replace("/>",">")),l.join("")}function oC(s,l){return l||(l=Tt(127)),l.write_shift(4,s.Hidden),l.write_shift(4,s.iTabID),r1(s.strRelID,l),js(s.name.slice(0,31),l),l.length>l.l?l.slice(0,l.l):l}function Ek(s,l){var a={};return s.read_shift(4),a.ArchID=s.read_shift(4),s.l+=l-8,a}function cC(s,l){var a=Vn();return Nt(a,131),Nt(a,128,function lC(s,l){l||(l=Tt(127));for(var a=0;4!=a;++a)l.write_shift(4,0);return js("SheetJS",l),js(fi_version,l),js(fi_version,l),js("7262",l),l.length>l.l?l.slice(0,l.l):l}()),Nt(a,153,function aC(s,l){l||(l=Tt(72));var a=0;return s&&s.filterPrivacy&&(a|=8),l.write_shift(4,a),l.write_shift(4,0),H5(s&&s.CodeName||"ThisWorkbook",l),l.slice(0,l.l)}(s.Workbook&&s.Workbook.WBProps||null)),function Ik(s,l){if(l.Workbook&&l.Workbook.Sheets){for(var a=l.Workbook.Sheets,d=0,h=-1,y=-1;d<a.length;++d)!a[d]||!a[d].Hidden&&-1==h?h=d:1==a[d].Hidden&&-1==y&&(y=d);y>h||(Nt(s,135),Nt(s,158,function Dk(s,l){return l||(l=Tt(29)),l.write_shift(-4,0),l.write_shift(-4,460),l.write_shift(4,28800),l.write_shift(4,17600),l.write_shift(4,500),l.write_shift(4,s),l.write_shift(4,s),l.write_shift(1,120),l.length>l.l?l.slice(0,l.l):l}(h)),Nt(s,136))}}(a,s),function Fa(s,l){Nt(s,143);for(var a=0;a!=l.SheetNames.length;++a)Nt(s,156,oC({Hidden:l.Workbook&&l.Workbook.Sheets&&l.Workbook.Sheets[a]&&l.Workbook.Sheets[a].Hidden||0,iTabID:a+1,strRelID:"rId"+(a+1),name:l.SheetNames[a]}));Nt(s,144)}(a,s),Nt(a,132),a.end()}function uC(s,l,a,d,h,y,b,C){return".bin"===l.slice(-4)?function Iv(s,l,a,d,h,y,b){if(!s)return s;var C=l||{};d||(d={"!id":{}});var F,X,V,Z,he,ge,le,Ke,tt,ze,I=C.dense?[]:{},O={s:{r:2e6,c:2e6},e:{r:0,c:0}},H=[],W=!1,G=!1,be=[];C.biff=12,C["!row"]=0;var Qe=0,qe=!1,gt=[],bt={},et=C.supbooks||h.supbooks||[[]];if(et.sharedf=bt,et.arrayf=gt,et.SheetNames=h.SheetNames||h.Sheets.map(function(Mn){return Mn.name}),!C.supbooks&&(C.supbooks=et,h.Names))for(var Xt=0;Xt<h.Names.length;++Xt)et[0][Xt+1]=h.Names[Xt];var Dn,Li,vn=[],Zt=[],Fn=!1;if(bp[16]={n:"BrtShortReal",f:ws},Ma(s,function(Pt,Ee,dt){if(!G)switch(dt){case 148:F=Pt;break;case 0:X=Pt,C.sheetRows&&C.sheetRows<=X.r&&(G=!0),tt=jr(he=X.r),C["!row"]=X.r,(Pt.hidden||Pt.hpt||null!=Pt.level)&&(Pt.hpt&&(Pt.hpx=Xh(Pt.hpt)),Zt[Pt.r]=Pt);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(V={t:Pt[2]},Pt[2]){case"n":V.v=Pt[1];break;case"s":V.v=(Ke=lp[Pt[1]]).t,V.r=Ke.r;break;case"b":V.v=!!Pt[1];break;case"e":V.v=Pt[1],!1!==C.cellText&&(V.w=su[V.v]);break;case"str":V.t="s",V.v=Pt[1];break;case"is":V.t="s",V.v=Pt[1].t}if((Z=b.CellXf[Pt[0].iStyleRef])&&Dw(V,Z.numFmtId,null,C,y,b),ge=-1==Pt[0].c?ge+1:Pt[0].c,C.dense?(I[he]||(I[he]=[]),I[he][ge]=V):I[to(ge)+tt]=V,C.cellFormula){for(qe=!1,Qe=0;Qe<gt.length;++Qe){var Fe=gt[Qe];X.r>=Fe[0].s.r&&X.r<=Fe[0].e.r&&ge>=Fe[0].s.c&&ge<=Fe[0].e.c&&(V.F=yi(Fe[0]),qe=!0)}!qe&&Pt.length>3&&(V.f=Pt[3])}if(O.s.r>X.r&&(O.s.r=X.r),O.s.c>ge&&(O.s.c=ge),O.e.r<X.r&&(O.e.r=X.r),O.e.c<ge&&(O.e.c=ge),C.cellDates&&Z&&"n"==V.t&&Ku(Wn[Z.numFmtId])){var Pe=Gu(V.v);Pe&&(V.t="d",V.v=new Date(Pe.y,Pe.m-1,Pe.d,Pe.H,Pe.M,Pe.S,Pe.u))}Dn&&("XLDAPR"==Dn.type&&(V.D=!0),Dn=void 0),Li&&(Li=void 0);break;case 1:case 12:if(!C.sheetStubs||W)break;V={t:"z",v:void 0},ge=-1==Pt[0].c?ge+1:Pt[0].c,C.dense?(I[he]||(I[he]=[]),I[he][ge]=V):I[to(ge)+tt]=V,O.s.r>X.r&&(O.s.r=X.r),O.s.c>ge&&(O.s.c=ge),O.e.r<X.r&&(O.e.r=X.r),O.e.c<ge&&(O.e.c=ge),Dn&&("XLDAPR"==Dn.type&&(V.D=!0),Dn=void 0),Li&&(Li=void 0);break;case 176:be.push(Pt);break;case 49:Dn=((C.xlmeta||{}).Cell||[])[Pt-1];break;case 494:var It=d["!id"][Pt.relId];for(It?(Pt.Target=It.Target,Pt.loc&&(Pt.Target+="#"+Pt.loc),Pt.Rel=It):""==Pt.relId&&(Pt.Target="#"+Pt.loc),he=Pt.rfx.s.r;he<=Pt.rfx.e.r;++he)for(ge=Pt.rfx.s.c;ge<=Pt.rfx.e.c;++ge)C.dense?(I[he]||(I[he]=[]),I[he][ge]||(I[he][ge]={t:"z",v:void 0}),I[he][ge].l=Pt):(le=qn({c:ge,r:he}),I[le]||(I[le]={t:"z",v:void 0}),I[le].l=Pt);break;case 426:if(!C.cellFormula)break;gt.push(Pt),(ze=C.dense?I[he][ge]:I[to(ge)+tt]).f=xs(Pt[1],0,{r:X.r,c:ge},et,C),ze.F=yi(Pt[0]);break;case 427:if(!C.cellFormula)break;bt[qn(Pt[0].s)]=Pt[1],(ze=C.dense?I[he][ge]:I[to(ge)+tt]).f=xs(Pt[1],0,{r:X.r,c:ge},et,C);break;case 60:if(!C.cellStyles)break;for(;Pt.e>=Pt.s;)vn[Pt.e--]={width:Pt.w/256,hidden:!!(1&Pt.flags),level:Pt.level},Fn||(Fn=!0,L1(Pt.w/256)),od(vn[Pt.e+1]);break;case 161:I["!autofilter"]={ref:yi(Pt)};break;case 476:I["!margins"]=Pt;break;case 147:h.Sheets[a]||(h.Sheets[a]={}),Pt.name&&(h.Sheets[a].CodeName=Pt.name),(Pt.above||Pt.left)&&(I["!outline"]={above:Pt.above,left:Pt.left});break;case 137:h.Views||(h.Views=[{}]),h.Views[0]||(h.Views[0]={}),Pt.RTL&&(h.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:W=!0;break;case 36:W=!1;break;case 37:H.push(dt),W=!0;break;case 38:H.pop(),W=!1;break;default:if(!Ee.T&&(!W||C.WTF))throw new Error("Unexpected record 0x"+dt.toString(16))}},C),delete C.supbooks,delete C["!row"],!I["!ref"]&&(O.s.r<2e6||F&&(F.e.r>0||F.e.c>0||F.s.r>0||F.s.c>0))&&(I["!ref"]=yi(F||O)),C.sheetRows&&I["!ref"]){var ln=Yi(I["!ref"]);C.sheetRows<=+ln.e.r&&(ln.e.r=C.sheetRows-1,ln.e.r>O.e.r&&(ln.e.r=O.e.r),ln.e.r<ln.s.r&&(ln.s.r=ln.e.r),ln.e.c>O.e.c&&(ln.e.c=O.e.c),ln.e.c<ln.s.c&&(ln.s.c=ln.e.c),I["!fullref"]=I["!ref"],I["!ref"]=yi(ln))}return be.length>0&&(I["!merges"]=be),vn.length>0&&(I["!cols"]=vn),Zt.length>0&&(I["!rows"]=Zt),I}(s,d,a,h,y,b,C):function z4(s,l,a,d,h,y,b){if(!s)return s;d||(d={"!id":{}});var C=l.dense?[]:{},I={s:{r:2e6,c:2e6},e:{r:0,c:0}},F="",O="",H=s.match(B4);H?(F=s.slice(0,H.index),O=s.slice(H.index+H[0].length)):F=O=s;var W=F.match(gv);W?vv(W[0],0,h,a):(W=F.match(U4))&&function $4(s,l,a,d,h){vv(s.slice(0,s.indexOf(">")),0,d,h)}(W[0],0,0,h,a);var G=(F.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(G>0){var X=F.slice(G,G+50).match(mv);X&&function Iw(s,l){var a=Yi(l);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(s["!ref"]=yi(a))}(C,X[1])}var V=F.match(H4);V&&V[1]&&function Pw(s,l){l.Views||(l.Views=[{}]),(s.match(Fw)||[]).forEach(function(a,d){var h=Qn(a);l.Views[d]||(l.Views[d]={}),+h.zoomScale&&(l.Views[d].zoom=+h.zoomScale),Kr(h.rightToLeft)&&(l.Views[d].RTL=!0)})}(V[1],h);var Z=[];if(l.cellStyles){var he=F.match(j4);he&&function G4(s,l){for(var a=!1,d=0;d!=l.length;++d){var h=Qn(l[d],!0);h.hidden&&(h.hidden=Kr(h.hidden));var y=parseInt(h.min,10)-1,b=parseInt(h.max,10)-1;for(h.outlineLevel&&(h.level=+h.outlineLevel||0),delete h.min,delete h.max,h.width=+h.width,!a&&h.width&&(a=!0,L1(h.width)),od(h);y<=b;)s[y++]=Bn(h)}}(Z,he)}H&&Lw(H[1],C,l,I,y,b);var ge=O.match(V4);ge&&(C["!autofilter"]=function zP(s){return{ref:(s.match(/ref="([^"]*)"/)||[])[1]}}(ge[0]));var le=[],Ke=O.match(Aw);if(Ke)for(G=0;G!=Ke.length;++G)le[G]=Yi(Ke[G].slice(Ke[G].indexOf('"')+1));var tt=O.match(Mc);tt&&function xv(s,l,a){for(var d=Array.isArray(s),h=0;h!=l.length;++h){var y=Qn(_n(l[h]),!0);if(!y.ref)return;var b=((a||{})["!id"]||[])[y.id];b?(y.Target=b.Target,y.location&&(y.Target+="#"+lr(y.location))):(y.Target="#"+lr(y.location),b={Target:y.Target,TargetMode:"Internal"}),y.Rel=b,y.tooltip&&(y.Tooltip=y.tooltip,delete y.tooltip);for(var C=Yi(y.ref),I=C.s.r;I<=C.e.r;++I)for(var F=C.s.c;F<=C.e.c;++F){var O=qn({c:F,r:I});d?(s[I]||(s[I]=[]),s[I][F]||(s[I][F]={t:"z",v:void 0}),s[I][F].l=y):(s[O]||(s[O]={t:"z",v:void 0}),s[O].l=y)}}}(C,tt,d);var ze=O.match(HP);if(ze&&(C["!margins"]=function Mw(s){var l={};return["left","right","top","bottom","header","footer"].forEach(function(a){s[a]&&(l[a]=parseFloat(s[a]))}),l}(Qn(ze[0]))),!C["!ref"]&&I.e.c>=I.s.c&&I.e.r>=I.s.r&&(C["!ref"]=yi(I)),l.sheetRows>0&&C["!ref"]){var be=Yi(C["!ref"]);l.sheetRows<=+be.e.r&&(be.e.r=l.sheetRows-1,be.e.r>I.e.r&&(be.e.r=I.e.r),be.e.r<be.s.r&&(be.s.r=be.e.r),be.e.c>I.e.c&&(be.e.c=I.e.c),be.e.c<be.s.c&&(be.s.c=be.e.c),C["!fullref"]=C["!ref"],C["!ref"]=yi(be))}return Z.length>0&&(C["!cols"]=Z),le.length>0&&(C["!merges"]=le),C}(s,d,a,h,y,b,C)}function dC(s,l,a,d,h){return(".bin"===l.slice(-4)?Sk:lm)(s,a,d,h)}function Rk(s,l,a){return(".bin"===l.slice(-4)?X1:tm)(s,a)}var yp,pC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Nv=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Pa(s,l){var a=s.split(/\s+/),d=[];if(l||(d[0]=a[0]),1===a.length)return d;var y,b,I,h=s.match(pC);if(h)for(I=0;I!=h.length;++I)-1===(b=(y=h[I].match(Nv))[1].indexOf(":"))?d[y[1]]=y[2].slice(1,y[2].length-1):d["xmlns:"===y[1].slice(0,6)?"xmlns"+y[1].slice(6):y[1].slice(b+1)]=y[2].slice(1,y[2].length-1);return d}function Bk(s){var a={};if(1===s.split(/\s+/).length)return a;var h,y,C,d=s.match(pC);if(d)for(C=0;C!=d.length;++C)-1===(y=(h=d[C].match(Nv))[1].indexOf(":"))?a[h[1]]=h[2].slice(1,h[2].length-1):a["xmlns:"===h[1].slice(0,6)?"xmlns"+h[1].slice(6):h[1].slice(y+1)]=h[2].slice(1,h[2].length-1);return a}function Vk(s,l,a,d){var h=d;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":h=Kr(d);break;case"i2":case"int":h=parseInt(d,10);break;case"r4":case"float":h=parseFloat(d);break;case"date":case"dateTime.tz":h=Kn(d);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}s[lr(l)]=h}function Hk(s,l,a){if(a.cellStyles&&l.Interior){var d=l.Interior;d.Pattern&&(d.patternType=Qh[d.Pattern]||d.Pattern)}s[l.ID]=l}function zk(s,l,a,d,h,y,b,C,I,F){var O="General",H=d.StyleID,W={};F=F||{};var G=[],X=0;for(void 0===H&&C&&(H=C.StyleID),void 0===H&&b&&(H=b.StyleID);void 0!==y[H]&&(y[H].nf&&(O=y[H].nf),y[H].Interior&&G.push(y[H].Interior),y[H].Parent);)H=y[H].Parent;switch(a.Type){case"Boolean":d.t="b",d.v=Kr(s);break;case"String":d.t="s",d.r=d2(lr(s)),d.v=s.indexOf("<")>-1?lr(l||s).replace(/<.*?>/g,""):d.r;break;case"DateTime":"Z"!=s.slice(-1)&&(s+="Z"),d.v=(Kn(s)-new Date(Date.UTC(1899,11,30)))/864e5,d.v!=d.v?d.v=lr(s):d.v<60&&(d.v=d.v-1),(!O||"General"==O)&&(O="yyyy-mm-dd");case"Number":void 0===d.v&&(d.v=+s),d.t||(d.t="n");break;case"Error":d.t="e",d.v=b2[s],!1!==F.cellText&&(d.w=s);break;default:""==s&&""==l?d.t="z":(d.t="s",d.v=d2(l||s))}if(function Uk(s,l,a){if("z"!==s.t){if(!a||!1!==a.cellText)try{s.w="e"===s.t?s.w||su[s.v]:"General"===l?"n"===s.t?(0|s.v)===s.v?s.v.toString(10):jf(s.v):Od(s.v):function jk(s,l){var a=yp[s]||lr(s);return"General"===a?Od(l):Ka(a,l)}(l||"General",s.v)}catch(y){if(a.WTF)throw y}try{var d=yp[l]||l||"General";if(a.cellNF&&(s.z=d),a.cellDates&&"n"==s.t&&Ku(d)){var h=Gu(s.v);h&&(s.t="d",s.v=new Date(h.y,h.m-1,h.d,h.H,h.M,h.S,h.u))}}catch(y){if(a.WTF)throw y}}}(d,O,F),!1!==F.cellFormula)if(d.Formula){var V=lr(d.Formula);61==V.charCodeAt(0)&&(V=V.slice(1)),d.f=ad(V,h),delete d.Formula,"RC"==d.ArrayRange?d.F=ad("RC:RC",h):d.ArrayRange&&(d.F=ad(d.ArrayRange,h),I.push([Yi(d.F),d.F]))}else for(X=0;X<I.length;++X)h.r>=I[X][0].s.r&&h.r<=I[X][0].e.r&&h.c>=I[X][0].s.c&&h.c<=I[X][0].e.c&&(d.F=I[X][1]);F.cellStyles&&(G.forEach(function(Z){!W.patternType&&Z.patternType&&(W.patternType=Z.patternType)}),d.s=W),void 0!==d.StyleID&&(d.ixfe=d.StyleID)}function hC(s){s.t=s.v||"",s.t=s.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),s.v=s.w=s.ixfe=void 0}function Lv(s,l){var a=l||{};Nd();var d=ar(p2(s));("binary"==a.type||"array"==a.type||"base64"==a.type)&&(d=void 0!==Pi?Pi.utils.decode(65001,pi(d)):_n(d));var h=d.slice(0,1024).toLowerCase(),y=!1;if((1023&(h=h.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&h.indexOf(","),1023&h.indexOf(";"))){var b=Bn(a);return b.type="string",$h.to_workbook(d,b)}if(-1==h.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(Po){h.indexOf("<"+Po)>=0&&(y=!0)}),y)return function AC(s,l){var a=s.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||0==a.length)throw new Error("Invalid HTML: could not find <table>");if(1==a.length)return $d(DC(a[0],l),l);var d={SheetNames:[],Sheets:{}};return a.forEach(function(h,y){sy(d,DC(h,l),"Sheet"+(y+1))}),d}(d,a);yp={"General Number":"General","General Date":Wn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Wn[15],"Short Date":Wn[14],"Long Time":Wn[19],"Medium Time":Wn[18],"Short Time":Wn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Wn[2],Standard:Wn[4],Percent:Wn[10],Scientific:Wn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var C,F,Dn,I=[],O={},H=[],W=a.dense?[]:{},G="",X={},V={},Z=Pa('<Data ss:Type="String">'),he=0,ge=0,le=0,Ke={s:{r:2e6,c:2e6},e:{r:0,c:0}},tt={},ze={},be="",Qe=0,qe=[],gt={},bt={},et=0,Xt=[],vn=[],Zt={},Fn=[],Li=!1,ln=[],Mn=[],Pt={},Ee=0,dt=0,Fe={Sheets:[],WBProps:{date1904:!1}},Pe={};cr.lastIndex=0,d=d.replace(/<!--([\s\S]*?)-->/gm,"");for(var It="";C=cr.exec(d);)switch(C[3]=(It=C[3]).toLowerCase()){case"data":if("data"==It){if("/"===C[1]){if((F=I.pop())[0]!==C[3])throw new Error("Bad state: "+F.join("|"))}else"/"!==C[0].charAt(C[0].length-2)&&I.push([C[3],!0]);break}if(I[I.length-1][1])break;"/"===C[1]?zk(d.slice(he,C.index),be,Z,"comment"==I[I.length-1][0]?Zt:X,{c:ge,r:le},tt,Fn[ge],V,ln,a):(be="",Z=Pa(C[0]),he=C.index+C[0].length);break;case"cell":if("/"===C[1])if(vn.length>0&&(X.c=vn),(!a.sheetRows||a.sheetRows>le)&&void 0!==X.v&&(a.dense?(W[le]||(W[le]=[]),W[le][ge]=X):W[to(ge)+jr(le)]=X),X.HRef&&(X.l={Target:lr(X.HRef)},X.HRefScreenTip&&(X.l.Tooltip=X.HRefScreenTip),delete X.HRef,delete X.HRefScreenTip),(X.MergeAcross||X.MergeDown)&&(Ee=ge+(0|parseInt(X.MergeAcross,10)),dt=le+(0|parseInt(X.MergeDown,10)),qe.push({s:{c:ge,r:le},e:{c:Ee,r:dt}})),a.sheetStubs)if(X.MergeAcross||X.MergeDown){for(var sn=ge;sn<=Ee;++sn)for(var Yt=le;Yt<=dt;++Yt)(sn>ge||Yt>le)&&(a.dense?(W[Yt]||(W[Yt]=[]),W[Yt][sn]={t:"z"}):W[to(sn)+jr(Yt)]={t:"z"});ge=Ee+1}else++ge;else X.MergeAcross?ge=Ee+1:++ge;else(X=Bk(C[0])).Index&&(ge=+X.Index-1),ge<Ke.s.c&&(Ke.s.c=ge),ge>Ke.e.c&&(Ke.e.c=ge),"/>"===C[0].slice(-2)&&++ge,vn=[];break;case"row":"/"===C[1]||"/>"===C[0].slice(-2)?(le<Ke.s.r&&(Ke.s.r=le),le>Ke.e.r&&(Ke.e.r=le),"/>"===C[0].slice(-2)&&(V=Pa(C[0])).Index&&(le=+V.Index-1),ge=0,++le):((V=Pa(C[0])).Index&&(le=+V.Index-1),Pt={},("0"==V.AutoFitHeight||V.Height)&&(Pt.hpx=parseInt(V.Height,10),Pt.hpt=qg(Pt.hpx),Mn[le]=Pt),"1"==V.Hidden&&(Pt.hidden=!0,Mn[le]=Pt));break;case"worksheet":if("/"===C[1]){if((F=I.pop())[0]!==C[3])throw new Error("Bad state: "+F.join("|"));H.push(G),Ke.s.r<=Ke.e.r&&Ke.s.c<=Ke.e.c&&(W["!ref"]=yi(Ke),a.sheetRows&&a.sheetRows<=Ke.e.r&&(W["!fullref"]=W["!ref"],Ke.e.r=a.sheetRows-1,W["!ref"]=yi(Ke))),qe.length&&(W["!merges"]=qe),Fn.length>0&&(W["!cols"]=Fn),Mn.length>0&&(W["!rows"]=Mn),O[G]=W}else Ke={s:{r:2e6,c:2e6},e:{r:0,c:0}},le=ge=0,I.push([C[3],!1]),F=Pa(C[0]),G=lr(F.Name),W=a.dense?[]:{},qe=[],ln=[],Mn=[],Fe.Sheets.push(Pe={name:G,Hidden:0});break;case"table":if("/"===C[1]){if((F=I.pop())[0]!==C[3])throw new Error("Bad state: "+F.join("|"))}else{if("/>"==C[0].slice(-2))break;I.push([C[3],!1]),Fn=[],Li=!1}break;case"style":"/"===C[1]?Hk(tt,ze,a):ze=Pa(C[0]);break;case"numberformat":ze.nf=lr(Pa(C[0]).Format||"General"),yp[ze.nf]&&(ze.nf=yp[ze.nf]);for(var Qt=0;392!=Qt&&Wn[Qt]!=ze.nf;++Qt);if(392==Qt)for(Qt=57;392!=Qt;++Qt)if(null==Wn[Qt]){gc(ze.nf,Qt);break}break;case"column":if("table"!==I[I.length-1][0])break;if((Dn=Pa(C[0])).Hidden&&(Dn.hidden=!0,delete Dn.Hidden),Dn.Width&&(Dn.wpx=parseInt(Dn.Width,10)),!Li&&Dn.wpx>10){Li=!0,Us=6;for(var Rt=0;Rt<Fn.length;++Rt)Fn[Rt]&&od(Fn[Rt])}Li&&od(Dn),Fn[Dn.Index-1||Fn.length]=Dn;for(var gi=0;gi<+Dn.Span;++gi)Fn[Fn.length]=Bn(Dn);break;case"namedrange":if("/"===C[1])break;Fe.Names||(Fe.Names=[]);var Se=Qn(C[0]),Tr={Name:Se.Name,Ref:ad(Se.RefersTo.slice(1),{r:0,c:0})};Fe.Sheets.length>0&&(Tr.Sheet=Fe.Sheets.length-1),Fe.Names.push(Tr);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===C[0].slice(-2))break;"/"===C[1]?be+=d.slice(Qe,C.index):Qe=C.index+C[0].length;break;case"interior":if(!a.cellStyles)break;ze.Interior=Pa(C[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===C[0].slice(-2))break;"/"===C[1]?D2(gt,It,d.slice(et,C.index)):et=C.index+C[0].length;break;case"styles":case"workbook":if("/"===C[1]){if((F=I.pop())[0]!==C[3])throw new Error("Bad state: "+F.join("|"))}else I.push([C[3],!1]);break;case"comment":if("/"===C[1]){if((F=I.pop())[0]!==C[3])throw new Error("Bad state: "+F.join("|"));hC(Zt),vn.push(Zt)}else I.push([C[3],!1]),Zt={a:(F=Pa(C[0])).Author};break;case"autofilter":if("/"===C[1]){if((F=I.pop())[0]!==C[3])throw new Error("Bad state: "+F.join("|"))}else if("/"!==C[0].charAt(C[0].length-2)){var Hi=Pa(C[0]);W["!autofilter"]={ref:ad(Hi.Range).replace(/\$/g,"")},I.push([C[3],!0])}break;case"datavalidation":if("/"===C[1]){if((F=I.pop())[0]!==C[3])throw new Error("Bad state: "+F.join("|"))}else"/"!==C[0].charAt(C[0].length-2)&&I.push([C[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===C[1]){if((F=I.pop())[0]!==C[3])throw new Error("Bad state: "+F.join("|"))}else"/"!==C[0].charAt(C[0].length-2)&&I.push([C[3],!0]);break;default:if(0==I.length&&"document"==C[3]||0==I.length&&"uof"==C[3])return qv(d,a);var Dr=!0;switch(I[I.length-1][0]){case"officedocumentsettings":switch(C[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Dr=!1}break;case"componentoptions":switch(C[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Dr=!1}break;case"excelworkbook":switch(C[3]){case"date1904":Fe.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Dr=!1}break;case"workbookoptions":switch(C[3]){case"owcversion":case"height":case"width":break;default:Dr=!1}break;case"worksheetoptions":switch(C[3]){case"visible":if("/>"!==C[0].slice(-2))if("/"===C[1])switch(d.slice(et,C.index)){case"SheetHidden":Pe.Hidden=1;break;case"SheetVeryHidden":Pe.Hidden=2}else et=C.index+C[0].length;break;case"header":W["!margins"]||Jd(W["!margins"]={},"xlml"),isNaN(+Qn(C[0]).Margin)||(W["!margins"].header=+Qn(C[0]).Margin);break;case"footer":W["!margins"]||Jd(W["!margins"]={},"xlml"),isNaN(+Qn(C[0]).Margin)||(W["!margins"].footer=+Qn(C[0]).Margin);break;case"pagemargins":var zi=Qn(C[0]);W["!margins"]||Jd(W["!margins"]={},"xlml"),isNaN(+zi.Top)||(W["!margins"].top=+zi.Top),isNaN(+zi.Left)||(W["!margins"].left=+zi.Left),isNaN(+zi.Right)||(W["!margins"].right=+zi.Right),isNaN(+zi.Bottom)||(W["!margins"].bottom=+zi.Bottom);break;case"displayrighttoleft":Fe.Views||(Fe.Views=[]),Fe.Views[0]||(Fe.Views[0]={}),Fe.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":W["!outline"]||(W["!outline"]={}),W["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":W["!outline"]||(W["!outline"]={}),W["!outline"].left=!0;break;default:Dr=!1}break;case"pivottable":case"pivotcache":switch(C[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Dr=!1}break;case"pagebreaks":switch(C[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Dr=!1}break;case"autofilter":switch(C[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Dr=!1}break;case"querytable":switch(C[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Dr=!1}break;case"datavalidation":switch(C[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Dr=!1}break;case"sorting":case"conditionalformatting":switch(C[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Dr=!1}break;case"mapinfo":case"schema":case"data":switch(C[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Dr=!1}break;case"smarttags":break;default:Dr=!1}if(Dr||C[3].match(/!\[CDATA/))break;if(!I[I.length-1][1])throw"Unrecognized tag: "+C[3]+"|"+I.join("|");if("customdocumentproperties"===I[I.length-1][0]){if("/>"===C[0].slice(-2))break;"/"===C[1]?Vk(bt,It,Xt,d.slice(et,C.index)):(Xt=C,et=C.index+C[0].length);break}if(a.WTF)throw"Unrecognized tag: "+C[3]+"|"+I.join("|")}var fn={};return!a.bookSheets&&!a.bookProps&&(fn.Sheets=O),fn.SheetNames=H,fn.Workbook=Fe,fn.SSF=Bn(Wn),fn.Props=gt,fn.Custprops=bt,fn}function d0(s,l){switch(Qv(l=l||{}),l.type||"base64"){case"base64":return Lv(pa(s),l);case"binary":case"buffer":case"file":return Lv(s,l);case"array":return Lv(hc(s),l)}}function f0(s){return Jt("NamedRange",null,{"ss:Name":s.Name,"ss:RefersTo":"="+rw(s.Ref,{r:0,c:0})})}function T(s,l,a,d,h,y,b){if(!s||null==s.v&&null==s.f)return"";var C={};if(s.f&&(C["ss:Formula"]="="+Vt(rw(s.f,b))),s.F&&s.F.slice(0,l.length)==l){var I=Xr(s.F.slice(l.length+1));C["ss:ArrayRange"]="RC:R"+(I.r==b.r?"":"["+(I.r-b.r)+"]")+"C"+(I.c==b.c?"":"["+(I.c-b.c)+"]")}if(s.l&&s.l.Target&&(C["ss:HRef"]=Vt(s.l.Target),s.l.Tooltip&&(C["x:HRefScreenTip"]=Vt(s.l.Tooltip))),a["!merges"])for(var F=a["!merges"],O=0;O!=F.length;++O)F[O].s.c!=b.c||F[O].s.r!=b.r||(F[O].e.c>F[O].s.c&&(C["ss:MergeAcross"]=F[O].e.c-F[O].s.c),F[O].e.r>F[O].s.r&&(C["ss:MergeDown"]=F[O].e.r-F[O].s.r));var H="",W="";switch(s.t){case"z":if(!d.sheetStubs)return"";break;case"n":H="Number",W=String(s.v);break;case"b":H="Boolean",W=s.v?"1":"0";break;case"e":H="Error",W=su[s.v];break;case"d":H="DateTime",W=new Date(s.v).toISOString(),null==s.z&&(s.z=s.z||Wn[14]);break;case"s":H="String",W=function u2(s){return(s+"").replace(c2,function(a){return Rr[a]}).replace(Ci,function(a){return"&#x"+a.charCodeAt(0).toString(16).toUpperCase()+";"})}(s.v||"")}var G=pu(d.cellXfs,s,d);C["ss:StyleID"]="s"+(21+G),C["ss:Index"]=b.c+1;var V="z"==s.t?"":'<Data ss:Type="'+H+'">'+(null!=s.v?W:"")+"</Data>";return(s.c||[]).length>0&&(V+=function Bv(s){return s.map(function(l){var a=function B5(s){return s.replace(/(\r\n|[\r\n])/g,"&#10;")}(l.t||""),d=Jt("ss:Data",a,{xmlns:"http://www.w3.org/TR/REC-html40"});return Jt("Comment",d,{"ss:Author":l.a})}).join("")}(s.c)),Jt("Cell",V,C)}function jv(s,l){var a='<Row ss:Index="'+(s+1)+'"';return l&&(l.hpt&&!l.hpx&&(l.hpx=Xh(l.hpt)),l.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+l.hpx+'"'),l.hidden&&(a+=' ss:Hidden="1"')),a+">"}function f(s,l,a){var d=[],y=a.Sheets[a.SheetNames[s]],b=y?function n6(s,l,a,d){if(!s||!((d||{}).Workbook||{}).Names)return"";for(var h=d.Workbook.Names,y=[],b=0;b<h.length;++b){var C=h[b];C.Sheet==a&&(C.Name.match(/^_xlfn\./)||y.push(f0(C)))}return y.join("")}(y,0,s,a):"";return b.length>0&&d.push("<Names>"+b+"</Names>"),b=y?function Wk(s,l,a,d){if(!s["!ref"])return"";var h=Yi(s["!ref"]),y=s["!merges"]||[],b=0,C=[];s["!cols"]&&s["!cols"].forEach(function(Z,he){od(Z);var ge=!!Z.width,le=am(he,Z),Ke={"ss:Index":he+1};ge&&(Ke["ss:Width"]=Kh(le.width)),Z.hidden&&(Ke["ss:Hidden"]="1"),C.push(Jt("Column",null,Ke))});for(var I=Array.isArray(s),F=h.s.r;F<=h.e.r;++F){for(var O=[jv(F,(s["!rows"]||[])[F])],H=h.s.c;H<=h.e.c;++H){var W=!1;for(b=0;b!=y.length;++b)if(!(y[b].s.c>H||y[b].s.r>F||y[b].e.c<H||y[b].e.r<F)){(y[b].s.c!=H||y[b].s.r!=F)&&(W=!0);break}if(!W){var G={r:F,c:H},X=qn(G);O.push(T(I?(s[F]||[])[H]:s[X],X,s,l,0,0,G))}}O.push("</Row>"),O.length>2&&C.push(O.join(""))}return C.join("")}(y,l):"",b.length>0&&d.push("<Table>"+b+"</Table>"),d.push(function te(s,l,a,d){if(!s)return"";var h=[];if(s["!margins"]&&(h.push("<PageSetup>"),s["!margins"].header&&h.push(Jt("Header",null,{"x:Margin":s["!margins"].header})),s["!margins"].footer&&h.push(Jt("Footer",null,{"x:Margin":s["!margins"].footer})),h.push(Jt("PageMargins",null,{"x:Bottom":s["!margins"].bottom||"0.75","x:Left":s["!margins"].left||"0.7","x:Right":s["!margins"].right||"0.7","x:Top":s["!margins"].top||"0.75"})),h.push("</PageSetup>")),d&&d.Workbook&&d.Workbook.Sheets&&d.Workbook.Sheets[a])if(d.Workbook.Sheets[a].Hidden)h.push(Jt("Visible",1==d.Workbook.Sheets[a].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var y=0;y<a&&(!d.Workbook.Sheets[y]||d.Workbook.Sheets[y].Hidden);++y);y==a&&h.push("<Selected/>")}return((((d||{}).Workbook||{}).Views||[])[0]||{}).RTL&&h.push("<DisplayRightToLeft/>"),s["!protect"]&&(h.push(Xs("ProtectContents","True")),s["!protect"].objects&&h.push(Xs("ProtectObjects","True")),s["!protect"].scenarios&&h.push(Xs("ProtectScenarios","True")),null==s["!protect"].selectLockedCells||s["!protect"].selectLockedCells?null!=s["!protect"].selectUnlockedCells&&!s["!protect"].selectUnlockedCells&&h.push(Xs("EnableSelection","UnlockedCells")):h.push(Xs("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(b){s["!protect"][b[0]]&&h.push("<"+b[1]+"/>")})),0==h.length?"":Jt("WorksheetOptions",h.join(""),{xmlns:ys_x})}(y,0,s,a)),d.join("")}function p(s,l){l||(l={}),s.SSF||(s.SSF=Bn(Wn)),s.SSF&&(Nd(),yh(s.SSF),l.revssf=wh(s.SSF),l.revssf[s.SSF[65535]]=0,l.ssf=s.SSF,l.cellXfs=[],pu(l.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(function mC(s,l){var a=[];return s.Props&&a.push(function I2(s,l){var a=[];return Gr(wg).map(function(d){for(var h=0;h<Vo.length;++h)if(Vo[h][1]==d)return Vo[h];for(h=0;h<Ju.length;++h)if(Ju[h][1]==d)return Ju[h];throw d}).forEach(function(d){if(null!=s[d[1]]){var h=l&&l.Props&&null!=l.Props[d[1]]?l.Props[d[1]]:s[d[1]];"date"===d[2]&&(h=new Date(h).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof h?h=String(h):!0===h||!1===h?h=h?"1":"0":h instanceof Date&&(h=new Date(h).toISOString().replace(/\.\d*Z/,"")),a.push(Xs(wg[d[1]]||d[1],h))}}),Jt("DocumentProperties",a.join(""),{xmlns:ys_o})}(s.Props,l)),s.Custprops&&a.push(function A2(s,l){var a=["Worksheets","SheetNames"],d="CustomDocumentProperties",h=[];return s&&Gr(s).forEach(function(y){if(Object.prototype.hasOwnProperty.call(s,y)){for(var b=0;b<Vo.length;++b)if(y==Vo[b][1])return;for(b=0;b<Ju.length;++b)if(y==Ju[b][1])return;for(b=0;b<a.length;++b)if(y==a[b])return;var C=s[y],I="string";"number"==typeof C?(I="float",C=String(C)):!0===C||!1===C?(I="boolean",C=C?"1":"0"):C=String(C),h.push(Jt(R5(y),C,{"dt:dt":I}))}}),l&&Gr(l).forEach(function(y){if(Object.prototype.hasOwnProperty.call(l,y)&&(!s||!Object.prototype.hasOwnProperty.call(s,y))){var b=l[y],C="string";"number"==typeof b?(C="float",b=String(b)):!0===b||!1===b?(C="boolean",b=b?"1":"0"):b instanceof Date?(C="dateTime.tz",b=b.toISOString()):b=String(b),h.push(Jt(R5(y),b,{"dt:dt":C}))}}),"<"+d+' xmlns="'+ys_o+'">'+h.join("")+"</"+d+">"}(s.Props,s.Custprops)),a.join("")}(s,l)),a.push(""),a.push(""),a.push("");for(var d=0;d<s.SheetNames.length;++d)a.push(Jt("Worksheet",f(d,l,s),{"ss:Name":Vt(s.SheetNames[d])}));return a[2]=function t6(s,l){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return l.cellXfs.forEach(function(d,h){var y=[];y.push(Jt("NumberFormat",null,{"ss:Format":Vt(Wn[d.numFmtId])}));var b={"ss:ID":"s"+(21+h)};a.push(Jt("Style",y.join(""),b))}),Jt("Styles",a.join(""))}(0,l),a[3]=function $k(s){if(!((s||{}).Workbook||{}).Names)return"";for(var l=s.Workbook.Names,a=[],d=0;d<l.length;++d){var h=l[d];null==h.Sheet&&(h.Name.match(/^_xlfn\./)||a.push(f0(h)))}return Jt("Names",a.join(""))}(s),br+Jt("Workbook",a.join(""),{xmlns:ys_ss,"xmlns:o":ys_o,"xmlns:x":ys_x,"xmlns:ss":ys_ss,"xmlns:dt":"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882","xmlns:html":"http://www.w3.org/TR/REC-html40"})}var r6=[60,1084,2066,2165,2175];function qk(s,l,a,d,h){var y=d,b=[],C=a.slice(a.l,a.l+y);if(h&&h.enc&&h.enc.insitu&&C.length>0)switch(s){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:h.enc.insitu(C)}b.push(C),a.l+=y;for(var I=_l(a,a.l),F=Vv[I],O=0;null!=F&&r6.indexOf(I)>-1;)y=_l(a,a.l+2),O=a.l+4,2066==I?O+=4:(2165==I||2175==I)&&(O+=12),C=a.slice(O,a.l+4+y),b.push(C),a.l+=4+y,F=Vv[I=_l(a,a.l)];var H=es(b);yo(H,0);var W=0;H.lens=[];for(var G=0;G<b.length;++G)H.lens.push(W),W+=b[G].length;if(H.length<d)throw"XLS Record 0x"+s.toString(16)+" Truncated: "+H.length+" < "+d;return l.f(H,H.length,h)}function ni(s,l,a){if("z"!==s.t&&s.XF){var d=0;try{d=s.z||s.XF.numFmtId||0,l.cellNF&&(s.z=Wn[d])}catch(y){if(l.WTF)throw y}if(!l||!1!==l.cellText)try{s.w="e"===s.t?s.w||su[s.v]:0===d||"General"==d?"n"===s.t?(0|s.v)===s.v?s.v.toString(10):jf(s.v):Od(s.v):Ka(d,s.v,{date1904:!!a,dateNF:l&&l.dateNF})}catch(y){if(l.WTF)throw y}if(l.cellDates&&d&&"n"==s.t&&Ku(Wn[d]||String(d))){var h=Gu(s.v);h&&(s.t="d",s.v=new Date(h.y,h.m-1,h.d,h.H,h.M,h.S,h.u))}}}function Si(s,l,a){return{v:s,ixfe:l,t:a}}var Ie_SI="e0859ff2f94f6810ab9108002b27b3d9",Ie_DSI="02d5cdd59c2e1b10939708002b2cf9ae";function fm(s,l){var a,d,h,y;if(l||(l={}),Qv(l),Ao(),l.codepage&&fa(l.codepage),s.FullPaths){if(In.find(s,"/encryption"))throw new Error("File is password-protected");a=In.find(s,"!CompObj"),d=In.find(s,"/Workbook")||In.find(s,"/Book")}else{switch(l.type){case"base64":s=ha(pa(s));break;case"binary":s=ha(s);break;case"buffer":break;case"array":Array.isArray(s)||(s=Array.prototype.slice.call(s))}yo(s,0),d={content:s}}if(a&&function ee(s){var l={},a=s.content;if(a.l=28,l.AnsiUserType=a.read_shift(0,"lpstr-ansi"),l.AnsiClipboardFormat=function G5(s){return mg(s,1)}(a),a.length-a.l<=4)return l;var d=a.read_shift(4);if(0==d||d>40||(a.l-=4,l.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4)||1907505652!==(d=a.read_shift(4))||(l.UnicodeClipboardFormat=function l1(s){return mg(s,2)}(a),0==(d=a.read_shift(4))||d>40))return l;a.l-=4,l.Reserved2=a.read_shift(0,"lpwstr")}(a),l.bookProps&&!l.bookSheets)h={};else{var b=Oi?"buffer":"array";if(d&&d.content)h=function Jn(s,l){var H,G,V,Z,le,Ke,a={opts:{}},d={},h=l.dense?[]:{},y={},b={},C=null,I=[],F="",O={},W="",he={},ge=[],tt=[],ze=[],be={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Qe={},qe=function(Mi){return Mi<8?Wd[Mi]:Mi<64&&ze[Mi-8]||Wd[Mi]},bt=function(Mi,wo,nl){if(!(Pt>1||nl.sheetRows&&Mi.r>=nl.sheetRows)){if(nl.cellStyles&&wo.XF&&wo.XF.data&&function(Mi,wo,nl){var uf,Oo=wo.XF.data;Oo&&Oo.patternType&&nl&&nl.cellStyles&&(wo.s={},wo.s.patternType=Oo.patternType,(uf=Gh(qe(Oo.icvFore)))&&(wo.s.fgColor={rgb:uf}),(uf=Gh(qe(Oo.icvBack)))&&(wo.s.bgColor={rgb:uf}))}(0,wo,nl),delete wo.ixfe,delete wo.XF,H=Mi,W=qn(Mi),(!b||!b.s||!b.e)&&(b={s:{r:0,c:0},e:{r:0,c:0}}),Mi.r<b.s.r&&(b.s.r=Mi.r),Mi.c<b.s.c&&(b.s.c=Mi.c),Mi.r+1>b.e.r&&(b.e.r=Mi.r+1),Mi.c+1>b.e.c&&(b.e.c=Mi.c+1),nl.cellFormula&&wo.f)for(var Oo=0;Oo<ge.length;++Oo)if(!(ge[Oo][0].s.c>Mi.c||ge[Oo][0].s.r>Mi.r||ge[Oo][0].e.c<Mi.c||ge[Oo][0].e.r<Mi.r)){wo.F=yi(ge[Oo][0]),(ge[Oo][0].s.c!=Mi.c||ge[Oo][0].s.r!=Mi.r)&&delete wo.f,wo.f&&(wo.f=""+xs(ge[Oo][1],0,Mi,ln,et));break}nl.dense?(h[Mi.r]||(h[Mi.r]=[]),h[Mi.r][Mi.c]=wo):h[W]=wo}},et={enc:!1,sbcch:0,snames:[],sharedf:he,arrayf:ge,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!l&&!!l.cellStyles,WTF:!!l&&!!l.wtf};l.password&&(et.password=l.password);var Xt,vn=[],Zt=[],Fn=[],Dn=[],Li=!1,ln=[];ln.SheetNames=et.snames,ln.sharedf=et.sharedf,ln.arrayf=et.arrayf,ln.names=[],ln.XTI=[];var Pe,Mn=0,Pt=0,Ee=0,dt=[],Fe=[];et.codepage=1200,Io(1200);for(var It=!1;s.l<s.length-1;){var sn=s.l,Yt=s.read_shift(2);if(0===Yt&&10===Mn)break;var Qt=s.l===s.length?0:s.read_shift(2),Rt=Vv[Yt];if(Rt&&Rt.f){if(l.bookSheets&&133===Mn&&133!==Yt)break;if(Mn=Yt,2===Rt.r||12==Rt.r){var gi=s.read_shift(2);if(Qt-=2,!et.enc&&gi!==Yt&&((255&gi)<<8|gi>>8)!==Yt)throw new Error("rt mismatch: "+gi+"!="+Yt);12==Rt.r&&(s.l+=10,Qt-=10)}var Se={};if(Se=10===Yt?Rt.f(s,Qt,et):qk(Yt,Rt,s,Qt,et),0==Pt&&-1===[9,521,1033,2057].indexOf(Mn))continue;switch(Yt){case 34:a.opts.Date1904=be.WBProps.date1904=Se;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(et.enc||(s.l=0),et.enc=Se,!l.password)throw new Error("File is password-protected");if(null==Se.valid)throw new Error("Encryption scheme unsupported");if(!Se.valid)throw new Error("Password is incorrect");break;case 92:et.lastuser=Se;break;case 66:var Tr=Number(Se);switch(Tr){case 21010:Tr=1200;break;case 32768:Tr=1e4;break;case 32769:Tr=1252}Io(et.codepage=Tr),It=!0;break;case 317:et.rrtabid=Se;break;case 25:et.winlocked=Se;break;case 439:a.opts.RefreshAll=Se;break;case 12:a.opts.CalcCount=Se;break;case 16:a.opts.CalcDelta=Se;break;case 17:a.opts.CalcIter=Se;break;case 13:a.opts.CalcMode=Se;break;case 14:a.opts.CalcPrecision=Se;break;case 95:a.opts.CalcSaveRecalc=Se;break;case 15:et.CalcRefMode=Se;break;case 2211:a.opts.FullCalc=Se;break;case 129:Se.fDialog&&(h["!type"]="dialog"),Se.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),Se.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:tt.push(Se);break;case 430:ln.push([Se]),ln[ln.length-1].XTI=[];break;case 35:case 547:ln[ln.length-1].push(Se);break;case 24:case 536:Pe={Name:Se.Name,Ref:xs(Se.rgce,0,null,ln,et)},Se.itab>0&&(Pe.Sheet=Se.itab-1),ln.names.push(Pe),ln[0]||(ln[0]=[],ln[0].XTI=[]),ln[ln.length-1].push(Se),"_xlnm._FilterDatabase"==Se.Name&&Se.itab>0&&Se.rgce&&Se.rgce[0]&&Se.rgce[0][0]&&"PtgArea3d"==Se.rgce[0][0][0]&&(Fe[Se.itab-1]={ref:yi(Se.rgce[0][0][1][2])});break;case 22:et.ExternCount=Se;break;case 23:0==ln.length&&(ln[0]=[],ln[0].XTI=[]),ln[ln.length-1].XTI=ln[ln.length-1].XTI.concat(Se),ln.XTI=ln.XTI.concat(Se);break;case 2196:if(et.biff<8)break;null!=Pe&&(Pe.Comment=Se[1]);break;case 18:h["!protect"]=Se;break;case 19:0!==Se&&et.WTF&&console.error("Password verifier: "+Se);break;case 133:y[Se.pos]=Se,et.snames.push(Se.name);break;case 10:if(--Pt)break;if(b.e){if(b.e.r>0&&b.e.c>0){if(b.e.r--,b.e.c--,h["!ref"]=yi(b),l.sheetRows&&l.sheetRows<=b.e.r){var Hi=b.e.r;b.e.r=l.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=yi(b),b.e.r=Hi}b.e.r++,b.e.c++}vn.length>0&&(h["!merges"]=vn),Zt.length>0&&(h["!objects"]=Zt),Fn.length>0&&(h["!cols"]=Fn),Dn.length>0&&(h["!rows"]=Dn),be.Sheets.push(Qe)}""===F?O=h:d[F]=h,h=l.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===et.biff&&(et.biff={9:2,521:3,1033:4}[Yt]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Se.BIFFVer]||8),et.biffguess=0==Se.BIFFVer,0==Se.BIFFVer&&4096==Se.dt&&(et.biff=5,It=!0,Io(et.codepage=28591)),8==et.biff&&0==Se.BIFFVer&&16==Se.dt&&(et.biff=2),Pt++)break;if(h=l.dense?[]:{},et.biff<8&&!It&&(It=!0,Io(et.codepage=l.codepage||1252)),et.biff<5||0==Se.BIFFVer&&4096==Se.dt){""===F&&(F="Sheet1"),b={s:{r:0,c:0},e:{r:0,c:0}};var Dr={pos:s.l-Qt,name:F};y[Dr.pos]=Dr,et.snames.push(F)}else F=(y[sn]||{name:""}).name;32==Se.dt&&(h["!type"]="chart"),64==Se.dt&&(h["!type"]="macro"),vn=[],Zt=[],et.arrayf=ge=[],Fn=[],Dn=[],Li=!1,Qe={Hidden:(y[sn]||{hs:0}).hs,name:F};break;case 515:case 3:case 2:"chart"==h["!type"]&&(l.dense?(h[Se.r]||[])[Se.c]:h[qn({c:Se.c,r:Se.r})])&&++Se.c,le={ixfe:Se.ixfe,XF:tt[Se.ixfe]||{},v:Se.val,t:"n"},Ee>0&&(le.z=dt[le.ixfe>>8&63]),ni(le,l,a.opts.Date1904),bt({c:Se.c,r:Se.r},le,l);break;case 5:case 517:le={ixfe:Se.ixfe,XF:tt[Se.ixfe],v:Se.val,t:Se.t},Ee>0&&(le.z=dt[le.ixfe>>8&63]),ni(le,l,a.opts.Date1904),bt({c:Se.c,r:Se.r},le,l);break;case 638:le={ixfe:Se.ixfe,XF:tt[Se.ixfe],v:Se.rknum,t:"n"},Ee>0&&(le.z=dt[le.ixfe>>8&63]),ni(le,l,a.opts.Date1904),bt({c:Se.c,r:Se.r},le,l);break;case 189:for(var zi=Se.c;zi<=Se.C;++zi){var fn=Se.rkrec[zi-Se.c][0];le={ixfe:fn,XF:tt[fn],v:Se.rkrec[zi-Se.c][1],t:"n"},Ee>0&&(le.z=dt[le.ixfe>>8&63]),ni(le,l,a.opts.Date1904),bt({c:zi,r:Se.r},le,l)}break;case 6:case 518:case 1030:if("String"==Se.val){C=Se;break}if((le=Si(Se.val,Se.cell.ixfe,Se.tt)).XF=tt[le.ixfe],l.cellFormula){var Po=Se.formula;if(Po&&Po[0]&&Po[0][0]&&"PtgExp"==Po[0][0][0]){var Il=Po[0][0][1][0],Nc=Po[0][0][1][1],_u=qn({r:Il,c:Nc});he[_u]?le.f=""+xs(Se.formula,0,Se.cell,ln,et):le.F=((l.dense?(h[Il]||[])[Nc]:h[_u])||{}).F}else le.f=""+xs(Se.formula,0,Se.cell,ln,et)}Ee>0&&(le.z=dt[le.ixfe>>8&63]),ni(le,l,a.opts.Date1904),bt(Se.cell,le,l),C=Se;break;case 7:case 519:if(!C)throw new Error("String record expects Formula");C.val=Se,(le=Si(Se,C.cell.ixfe,"s")).XF=tt[le.ixfe],l.cellFormula&&(le.f=""+xs(C.formula,0,C.cell,ln,et)),Ee>0&&(le.z=dt[le.ixfe>>8&63]),ni(le,l,a.opts.Date1904),bt(C.cell,le,l),C=null;break;case 33:case 545:ge.push(Se);var Cp=qn(Se[0].s);if(G=l.dense?(h[Se[0].s.r]||[])[Se[0].s.c]:h[Cp],l.cellFormula&&G){if(!C||!Cp||!G)break;G.f=""+xs(Se[1],0,Se[0],ln,et),G.F=yi(Se[0])}break;case 1212:if(!l.cellFormula)break;if(W){if(!C)break;he[qn(C.cell)]=Se[0],((G=l.dense?(h[C.cell.r]||[])[C.cell.c]:h[qn(C.cell)])||{}).f=""+xs(Se[0],0,H,ln,et)}break;case 253:le=Si(I[Se.isst].t,Se.ixfe,"s"),I[Se.isst].h&&(le.h=I[Se.isst].h),le.XF=tt[le.ixfe],Ee>0&&(le.z=dt[le.ixfe>>8&63]),ni(le,l,a.opts.Date1904),bt({c:Se.c,r:Se.r},le,l);break;case 513:l.sheetStubs&&(le={ixfe:Se.ixfe,XF:tt[Se.ixfe],t:"z"},Ee>0&&(le.z=dt[le.ixfe>>8&63]),ni(le,l,a.opts.Date1904),bt({c:Se.c,r:Se.r},le,l));break;case 190:if(l.sheetStubs)for(var vu=Se.c;vu<=Se.C;++vu){var tl=Se.ixfe[vu-Se.c];le={ixfe:tl,XF:tt[tl],t:"z"},Ee>0&&(le.z=dt[le.ixfe>>8&63]),ni(le,l,a.opts.Date1904),bt({c:vu,r:Se.r},le,l)}break;case 214:case 516:case 4:(le=Si(Se.val,Se.ixfe,"s")).XF=tt[le.ixfe],Ee>0&&(le.z=dt[le.ixfe>>8&63]),ni(le,l,a.opts.Date1904),bt({c:Se.c,r:Se.r},le,l);break;case 0:case 512:1===Pt&&(b=Se);break;case 252:I=Se;break;case 1054:if(4==et.biff){dt[Ee++]=Se[1];for(var yu=0;yu<Ee+163&&Wn[yu]!=Se[1];++yu);yu>=163&&gc(Se[1],Ee+163)}else gc(Se[1],Se[0]);break;case 30:dt[Ee++]=Se;for(var bu=0;bu<Ee+163&&Wn[bu]!=Se;++bu);bu>=163&&gc(Se,Ee+163);break;case 229:vn=vn.concat(Se);break;case 93:Zt[Se.cmo[0]]=et.lastobj=Se;break;case 438:et.lastobj.TxO=Se;break;case 127:et.lastobj.ImData=Se;break;case 440:for(Z=Se[0].s.r;Z<=Se[0].e.r;++Z)for(V=Se[0].s.c;V<=Se[0].e.c;++V)(G=l.dense?(h[Z]||[])[V]:h[qn({c:V,r:Z})])&&(G.l=Se[1]);break;case 2048:for(Z=Se[0].s.r;Z<=Se[0].e.r;++Z)for(V=Se[0].s.c;V<=Se[0].e.c;++V)(G=l.dense?(h[Z]||[])[V]:h[qn({c:V,r:Z})])&&G.l&&(G.l.Tooltip=Se[1]);break;case 28:if(et.biff<=5&&et.biff>=2)break;G=l.dense?(h[Se[0].r]||[])[Se[0].c]:h[qn(Se[0])];var gm=Zt[Se[2]];G||(l.dense?(h[Se[0].r]||(h[Se[0].r]=[]),G=h[Se[0].r][Se[0].c]={t:"z"}):G=h[qn(Se[0])]={t:"z"},b.e.r=Math.max(b.e.r,Se[0].r),b.s.r=Math.min(b.s.r,Se[0].r),b.e.c=Math.max(b.e.c,Se[0].c),b.s.c=Math.min(b.s.c,Se[0].c)),G.c||(G.c=[]),G.c.push({a:Se[1],t:gm.TxO.t});break;case 2173:$1(0,Se.ext);break;case 125:if(!et.cellStyles)break;for(;Se.e>=Se.s;)Fn[Se.e--]={width:Se.w/256,level:Se.level||0,hidden:!!(1&Se.flags)},Li||(Li=!0,L1(Se.w/256)),od(Fn[Se.e+1]);break;case 520:var Ta={};null!=Se.level&&(Dn[Se.r]=Ta,Ta.level=Se.level),Se.hidden&&(Dn[Se.r]=Ta,Ta.hidden=!0),Se.hpt&&(Dn[Se.r]=Ta,Ta.hpt=Se.hpt,Ta.hpx=Xh(Se.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||Jd(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Yt]]=Se;break;case 161:h["!margins"]||Jd(h["!margins"]={}),h["!margins"].header=Se.header,h["!margins"].footer=Se.footer;break;case 574:Se.RTL&&(be.Views[0].RTL=!0);break;case 146:ze=Se;break;case 2198:Xt=Se;break;case 140:Ke=Se;break;case 442:F?Qe.CodeName=Se||Qe.name:be.WBProps.CodeName=Se||"ThisWorkbook"}}else Rt||console.error("Missing Info for XLS Record 0x"+Yt.toString(16)),s.l+=Qt}return a.SheetNames=Gr(y).sort(function(Lc,Mi){return Number(Lc)-Number(Mi)}).map(function(Lc){return y[Lc].name}),l.bookSheets||(a.Sheets=d),!a.SheetNames.length&&O["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=O)):a.Preamble=O,a.Sheets&&Fe.forEach(function(Lc,Mi){a.Sheets[a.SheetNames[Mi]]["!autofilter"]=Lc}),a.Strings=I,a.SSF=Bn(Wn),et.enc&&(a.Encryption=et.enc),Xt&&(a.Themes=Xt),a.Metadata={},void 0!==Ke&&(a.Metadata.Country=Ke),ln.names.length>0&&(be.Names=ln.names),a.Workbook=be,a}(d.content,l);else if((y=In.find(s,"PerfectOffice_MAIN"))&&y.content)h=cu.to_workbook(y.content,(l.type=b,l));else{if(!(y=In.find(s,"NativeContent_MAIN"))||!y.content)throw(y=In.find(s,"MN0"))&&y.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");h=cu.to_workbook(y.content,(l.type=b,l))}l.bookVBA&&s.FullPaths&&In.find(s,"/_VBA_PROJECT_CUR/VBA/dir")&&(h.vbaraw=function Q1(s){var l=In.utils.cfb_new({root:"R"});return s.FullPaths.forEach(function(a,d){if("/"!==a.slice(-1)&&a.match(/_VBA_PROJECT_CUR/)){var h=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");In.utils.cfb_add(l,h,s.FileIndex[d].content)}}),In.write(l)}(s))}var C={};return s.FullPaths&&function dm(s,l,a){var d=In.find(s,"/!DocumentSummaryInformation");if(d&&d.size>0)try{var h=Yf(d,p1,Ie_DSI);for(var y in h)l[y]=h[y]}catch(F){if(a.WTF)throw F}var b=In.find(s,"/!SummaryInformation");if(b&&b.size>0)try{var C=Yf(b,Sc,Ie_SI);for(var I in C)null==l[I]&&(l[I]=C[I])}catch(F){if(a.WTF)throw F}l.HeadingPairs&&l.TitlesOfParts&&(S2(l.HeadingPairs,l.TitlesOfParts,l,a),delete l.HeadingPairs,delete l.TitlesOfParts)}(s,C,l),h.Props=h.Custprops=C,l.bookFiles&&(h.cfb=s),h}var bp={0:{f:function Y4(s,l){var a={},d=s.l+l;a.r=s.read_shift(4),s.l+=4;var h=s.read_shift(2);s.l+=1;var y=s.read_shift(1);return s.l=d,7&y&&(a.level=7&y),16&y&&(a.hidden=!0),32&y&&(a.hpt=h/20),a}},1:{f:function Sv(s){return[Yl(s)]}},2:{f:function zw(s){return[Yl(s),o1(s),"n"]}},3:{f:function Uw(s){return[Yl(s),s.read_shift(1),"e"]}},4:{f:function J4(s){return[Yl(s),s.read_shift(1),"b"]}},5:{f:function ok(s){return[Yl(s),Vr(s),"n"]}},6:{f:function lk(s){return[Yl(s),xa(s),"str"]}},7:{f:function nk(s){return[Yl(s),s.read_shift(4),"s"]}},8:{f:function fk(s,l,a){var d=s.l+l,h=Yl(s);h.r=a["!row"];var b=[h,xa(s),"str"];if(a.cellFormula){s.l+=2;var C=s0(s,d-s.l,a);b[3]=xs(C,0,h,a.supbooks,a)}else s.l=d;return b}},9:{f:function dk(s,l,a){var d=s.l+l,h=Yl(s);h.r=a["!row"];var b=[h,Vr(s),"n"];if(a.cellFormula){s.l+=2;var C=s0(s,d-s.l,a);b[3]=xs(C,0,h,a.supbooks,a)}else s.l=d;return b}},10:{f:function WP(s,l,a){var d=s.l+l,h=Yl(s);h.r=a["!row"];var b=[h,s.read_shift(1),"b"];if(a.cellFormula){s.l+=2;var C=s0(s,d-s.l,a);b[3]=xs(C,0,h,a.supbooks,a)}else s.l=d;return b}},11:{f:function Kw(s,l,a){var d=s.l+l,h=Yl(s);h.r=a["!row"];var b=[h,s.read_shift(1),"e"];if(a.cellFormula){s.l+=2;var C=s0(s,d-s.l,a);b[3]=xs(C,0,h,a.supbooks,a)}else s.l=d;return b}},12:{f:function jw(s){return[nu(s)]}},13:{f:function Ww(s){return[nu(s),o1(s),"n"]}},14:{f:function Hw(s){return[nu(s),s.read_shift(1),"e"]}},15:{f:function Z4(s){return[nu(s),s.read_shift(1),"b"]}},16:{f:ws},17:{f:function uk(s){return[nu(s),xa(s),"str"]}},18:{f:function ik(s){return[nu(s),s.read_shift(4),"s"]}},19:{f:_2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function D(s,l,a){var d=s.l+l;s.l+=4,s.l+=1;var h=s.read_shift(4),y=Vs(s),b=Za(s,0,a),C=iu(s);s.l=d;var I={Name:y,Ptg:b};return h<268435455&&(I.Sheet=h),C&&(I.Comment=C),I}},40:{},42:{},43:{f:function Ox(s,l,a){var d={};d.sz=s.read_shift(2)/20;var h=function W5(s){var l=s.read_shift(1);return s.l++,{fBold:1&l,fItalic:2&l,fUnderline:4&l,fStrikeout:8&l,fOutline:16&l,fShadow:32&l,fCondense:64&l,fExtend:128&l}}(s);switch(h.fItalic&&(d.italic=1),h.fCondense&&(d.condense=1),h.fExtend&&(d.extend=1),h.fShadow&&(d.shadow=1),h.fOutline&&(d.outline=1),h.fStrikeout&&(d.strike=1),700===s.read_shift(2)&&(d.bold=1),s.read_shift(2)){case 1:d.vertAlign="superscript";break;case 2:d.vertAlign="subscript"}var b=s.read_shift(1);0!=b&&(d.underline=b);var C=s.read_shift(1);C>0&&(d.family=C);var I=s.read_shift(1);switch(I>0&&(d.charset=I),s.l++,d.color=function $5(s){var l={},d=s.read_shift(1)>>>1,h=s.read_shift(1),y=s.read_shift(2,"i"),b=s.read_shift(1),C=s.read_shift(1),I=s.read_shift(1);switch(s.l++,d){case 0:l.auto=1;break;case 1:l.index=h;var F=Wd[h];F&&(l.rgb=Gh(F));break;case 2:l.rgb=Gh([b,C,I]);break;case 3:l.theme=h}return 0!=y&&(l.tint=y>0?y/32767:y/32768),l}(s),s.read_shift(1)){case 1:d.scheme="major";break;case 2:d.scheme="minor"}return d.name=xa(s),d}},44:{f:function Px(s,l){return[s.read_shift(2),xa(s)]}},45:{f:VE},46:{f:em},47:{f:function B1(s,l){var a=s.l+l,d=s.read_shift(2),h=s.read_shift(2);return s.l=a,{ixfe:d,numFmtId:h}}},48:{},49:{f:function jF(s){return s.read_shift(4,"i")}},50:{},51:{f:function W1(s){for(var l=[],a=s.read_shift(4);a-- >0;)l.push([s.read_shift(4),s.read_shift(4)]);return l}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:cx},62:{f:function ak(s){return[Yl(s),_2(s),"is"]}},63:{f:function q1(s){var l={};l.i=s.read_shift(4);var a={};a.r=s.read_shift(4),a.c=s.read_shift(4),l.r=qn(a);var d=s.read_shift(1);return 2&d&&(l.l="1"),8&d&&(l.a="1"),l}},64:{f:function wr(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function Zw(s){var l=s.read_shift(2);return s.l+=28,{RTL:32&l}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function cm(s,l){var a={},d=s[s.l];return++s.l,a.above=!(64&d),a.left=!(128&d),s.l+=18,a.name=WF(s,l-19),a}},148:{f:Cv,p:16},151:{f:function Xw(){}},152:{},153:{f:function sC(s,l){var a={},d=s.read_shift(4);a.defaultThemeVersion=s.read_shift(4);var h=l>8?xa(s):"";return h.length>0&&(a.CodeName=h),a.autoCompressPictures=!!(65536&d),a.backupFile=!!(64&d),a.checkCompatibility=!!(4096&d),a.date1904=!!(1&d),a.filterPrivacy=!!(8&d),a.hidePivotFieldList=!!(1024&d),a.promptedSolutions=!!(16&d),a.publishItems=!!(2048&d),a.refreshAllConnections=!!(262144&d),a.saveExternalLinkValues=!!(128&d),a.showBorderUnselectedTables=!!(4&d),a.showInkAnnotation=!!(32&d),a.showObjects=["all","placeholders","none"][d>>13&3],a.showPivotChartFilter=!!(32768&d),a.updateLinks=["userSet","never","always"][d>>8&3],a}},154:{},155:{},156:{f:function rC(s,l){var a={};return a.Hidden=s.read_shift(4),a.iTabID=s.read_shift(4),a.strRelID=hg(s,l-8),a.name=xa(s),a}},157:{},158:{},159:{T:1,f:function uP(s){return[s.read_shift(4),s.read_shift(4)]}},160:{T:-1},161:{T:1,f:ru},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:qP},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function $x(s,l){return{flags:s.read_shift(4),version:s.read_shift(4),name:xa(s)}}},336:{T:-1},337:{f:function t4(s){return s.l+=4,0!=s.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ep},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function KP(s,l,a){var d=s.l+l,h=a1(s),y=s.read_shift(1),b=[h];if(b[2]=y,a.cellFormula){var C=P4(s,d-s.l,a);b[1]=C}else s.l=d;return b}},427:{f:function ec(s,l,a){var d=s.l+l,y=[ru(s,16)];if(a.cellFormula){var b=O4(s,d-s.l,a);y[1]=b,s.l=d}else s.l=d;return y}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function Qw(s){var l={};return hk.forEach(function(a){l[a]=Vr(s)}),l}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function Tv(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function pk(s,l){var a=s.l+l,d=ru(s,16),h=iu(s),y=xa(s),b=xa(s),C=xa(s);s.l=a;var I={rfx:d,relId:h,loc:y,display:C};return b&&(I.Tooltip=b),I}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Kg},633:{T:1},634:{T:-1},635:{T:1,f:function Y1(s){var l={};l.iauthor=s.read_shift(4);var a=ru(s,16);return l.rfx=a.s,l.ref=qn(a.s),s.l+=16,l}},636:{T:-1},637:{f:zF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function Zd(s,l){return s.l+=10,{name:xa(s)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function gk(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Vv={6:{f:o0},10:{f:Zu},12:{f:os},13:{f:os},14:{f:Fo},15:{f:Fo},16:{f:Vr},17:{f:Fo},18:{f:Fo},19:{f:os},20:{f:tx},21:{f:tx},23:{f:ep},24:{f:aE},25:{f:Fo},26:{},27:{},28:{f:function uE(s,l,a){return function rx(s,l,a){if(!(a.biff<8)){var d=s.read_shift(2),h=s.read_shift(2),y=s.read_shift(2),b=s.read_shift(2),C=xl(s,0,a);return a.biff<8&&s.read_shift(1),[{r:d,c:h},C,b,y]}}(s,0,a)}},29:{},34:{f:Fo},35:{f:Og},38:{f:Vr},39:{f:Vr},40:{f:Vr},41:{f:Vr},42:{f:Fo},43:{f:Fo},47:{f:function ME(s,l,a){var d={Type:a.biff>=8?s.read_shift(2):0};return d.Type?function Sx(s,l,a){var d=a||{};return d.Info=s.read_shift(2),s.l-=2,d.Data=1===d.Info?function _P(s){var l={},a=l.EncryptionVersionInfo=uu(s,4);if(1!=a.Major||1!=a.Minor)throw"unrecognized version code "+a.Major+" : "+a.Minor;return l.Salt=s.read_shift(16),l.EncryptedVerifier=s.read_shift(16),l.EncryptedVerifierHash=s.read_shift(16),l}(s):function gP(s,l){var a={},d=a.EncryptionVersionInfo=uu(s,4);if(l-=4,2!=d.Minor)throw new Error("unrecognized minor version code: "+d.Minor);if(d.Major>4||d.Major<2)throw new Error("unrecognized major version code: "+d.Major);a.Flags=s.read_shift(4),l-=4;var h=s.read_shift(4);return l-=4,a.EncryptionHeader=Jl(s,h),a.EncryptionVerifier=np(s,l-=h),a}(s,l),d}(s,l-2,d):function yP(s,l,a,d){var h={key:os(s),verificationBytes:os(s)};a.password&&(h.verifier=qh(a.password)),d.valid=h.verificationBytes===h.verifier,d.valid&&(d.insitu=function(s){var l=0,a=Hg(s);return function(d){var h=function(s,l,a,d,h){var y,b;for(h||(h=l),d||(d=Hg("")),y=0;y!=l.length;++y)b=l[y],h[y]=b=255&((b^=d[a])>>5|b<<3),++a;return[h,a,d]}(0,d,l,a);return l=h[1],h[0]}}(a.password))}(s,0,a,d),d}},49:{f:function Rh(s,l,a){var d={dyHeight:s.read_shift(2),fl:s.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:s.l+=2;break;default:s.l+=10}return d.name=ed(s,0,a),d}},51:{f:os},60:{},61:{f:function nP(s){return{Pos:[s.read_shift(2),s.read_shift(2)],Dim:[s.read_shift(2),s.read_shift(2)],Flags:s.read_shift(2),CurTab:s.read_shift(2),FirstTab:s.read_shift(2),Selected:s.read_shift(2),TabRatio:s.read_shift(2)}}},64:{f:Fo},65:{f:function D1(){}},66:{f:os},77:{},80:{},81:{},82:{},85:{f:os},89:{},90:{},91:{},92:{f:function K2(s,l,a){if(a.enc)return s.l+=l,"";var d=s.l,h=xl(s,0,a);return s.read_shift(l+d-s.l),h}},93:{f:function dE(s,l,a){if(a&&a.biff<8)return function sx(s,l,a){s.l+=4;var d=s.read_shift(2),h=s.read_shift(2),y=s.read_shift(2);s.l+=2,s.l+=2,s.l+=2,s.l+=2,s.l+=2,s.l+=2,s.l+=2,s.l+=2,s.l+=2,s.l+=6;var b=[];return b.push((zt[d]||qi)(s,l-=36,a)),{cmo:[h,d,y],ft:b}}(s,l,a);var d=S1(s),h=function Nh(s,l){for(var a=s.l+l,d=[];s.l<a;){var h=s.read_shift(2);s.l-=2;try{d.push(E1[h](s,a-s.l))}catch(y){return s.l=a,d}}return s.l!=a&&(s.l=a),d}(s,l-22);return{cmo:d,ft:h}}},94:{},95:{f:Fo},96:{},97:{},99:{f:Fo},125:{f:cx},128:{f:function aP(s){s.l+=4;var l=[s.read_shift(2),s.read_shift(2)];if(0!==l[0]&&l[0]--,0!==l[1]&&l[1]--,l[0]>7||l[1]>7)throw new Error("Bad Gutters: "+l.join("|"));return l}},129:{f:function Zf(s,l,a){var d=a&&8==a.biff||2==l?s.read_shift(2):(s.l+=l,0);return{fDialog:16&d,fBelow:64&d,fRight:128&d}}},130:{f:os},131:{f:Fo},132:{f:Fo},133:{f:function QF(s,l,a){var d=s.read_shift(4),h=3&s.read_shift(1),y=s.read_shift(1);switch(y){case 0:y="Worksheet";break;case 1:y="Macrosheet";break;case 2:y="Chartsheet";break;case 6:y="VBAModule"}var b=ed(s,0,a);return 0===b.length&&(b="Sheet1"),{pos:d,hs:h,dt:y,name:b}}},134:{},140:{f:function hE(s){var a,l=[0,0];return a=s.read_shift(2),l[0]=h1[a]||a,a=s.read_shift(2),l[1]=h1[a]||a,l}},141:{f:os},144:{},146:{f:function lx(s){for(var l=s.read_shift(2),a=[];l-- >0;)a.push(Ph(s));return a}},151:{},152:{},153:{},154:{},155:{},156:{f:os},157:{},158:{},160:{f:gE},161:{f:function F1(s,l){var a={};return l<32||(s.l+=16,a.header=Vr(s),a.footer=Vr(s),s.l+=2),a}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function sP(s,l){for(var a=s.l+l-2,d=s.read_shift(2),h=s.read_shift(2),y=[];s.l<a;)y.push(T1(s));if(s.l!==a)throw new Error("MulRK read error");var b=s.read_shift(2);if(y.length!=b-h+1)throw new Error("MulRK length mismatch");return{r:d,c:h,C:b,rkrec:y}}},190:{f:function J2(s,l){for(var a=s.l+l-2,d=s.read_shift(2),h=s.read_shift(2),y=[];s.l<a;)y.push(s.read_shift(2));if(s.l!==a)throw new Error("MulBlank read error");var b=s.read_shift(2);if(y.length!=b-h+1)throw new Error("MulBlank length mismatch");return{r:d,c:h,C:b,ixfe:y}}},193:{f:Zu},197:{},198:{},199:{},200:{},201:{},202:{f:Fo},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:os},220:{},221:{f:Fo},222:{},224:{f:function I1(s,l,a){var d={};return d.ifnt=s.read_shift(2),d.numFmtId=s.read_shift(2),d.flags=s.read_shift(2),d.fStyle=d.flags>>2&1,d.data=function Qa(s,l,a,d){var h={},y=s.read_shift(4),b=s.read_shift(4),C=s.read_shift(4),I=s.read_shift(2);return h.patternType=m1[C>>26],d.cellStyles&&(h.alc=7&y,h.fWrap=y>>3&1,h.alcV=y>>4&7,h.fJustLast=y>>7&1,h.trot=y>>8&255,h.cIndent=y>>16&15,h.fShrinkToFit=y>>20&1,h.iReadOrder=y>>22&2,h.fAtrNum=y>>26&1,h.fAtrFnt=y>>27&1,h.fAtrAlc=y>>28&1,h.fAtrBdr=y>>29&1,h.fAtrPat=y>>30&1,h.fAtrProt=y>>31&1,h.dgLeft=15&b,h.dgRight=b>>4&15,h.dgTop=b>>8&15,h.dgBottom=b>>12&15,h.icvLeft=b>>16&127,h.icvRight=b>>23&127,h.grbitDiag=b>>30&3,h.icvTop=127&C,h.icvBottom=C>>7&127,h.icvDiag=C>>14&127,h.dgDiag=C>>21&15,h.icvFore=127&I,h.icvBack=I>>7&127,h.fsxButton=I>>14&1),h}(s,0,0,a),d}},225:{f:function Jf(s,l){return 0===l||s.read_shift(2),1200}},226:{f:Zu},227:{},229:{f:function jh(s,l){for(var a=[],d=s.read_shift(2);d--;)a.push(Fg(s));return a}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function hi(s,l){for(var a=s.l+l,d=s.read_shift(4),h=s.read_shift(4),y=[],b=0;b!=h&&s.l<a;++b)y.push(j2(s));return y.Count=d,y.Unique=h,y}},253:{f:function nE(s){var l=Xa(s);return l.isst=s.read_shift(4),l}},255:{f:function JF(s,l){var a={};return a.dsst=s.read_shift(2),s.l+=l-2,a}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ah},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Fo},353:{f:Zu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function nx(s,l,a){var d=s.l+l,h=s.read_shift(2),y=s.read_shift(2);if(a.sbcch=y,1025==y||14849==y)return[y,h];if(y<1||y>255)throw new Error("Unexpected SupBook type: "+y);for(var b=bl(s,y),C=[];d>s.l;)C.push(Mh(s));return[y,h,b,C]}},431:{f:Fo},432:{},433:{},434:{},437:{},438:{f:function ax(s,l,a){var d=s.l,h="";try{s.l+=4,-1==[0,5,7,11,12,14].indexOf((a.lastobj||{cmo:[0,0]}).cmo[1])?s.l+=6:function Ig(s){var l=s.read_shift(1);s.l++;var a=s.read_shift(2);s.l+=2}(s);var C=s.read_shift(2);s.read_shift(2),os(s);var I=s.read_shift(2);s.l+=I;for(var F=1;F<s.lens.length-1;++F){if(s.l-d!=s.lens[F])throw new Error("TxO: bad continue record");var O=s[s.l];if((h+=bl(s,s.lens[F+1]-s.lens[F]-1)).length>=(O?C:2*C))break}if(h.length!==C&&h.length!==2*C)throw new Error("cchText: "+C+" != "+h.length);return s.l=d+l,{t:h}}catch(W){return s.l=d+l,{t:h}}}},439:{f:Fo},440:{f:function M1(s,l){var a=Fg(s);s.l+=16;var d=function Fh(s,l){var a=s.l+l,d=s.read_shift(4);if(2!==d)throw new Error("Unrecognized streamVersion: "+d);var h=s.read_shift(2);s.l+=2;var y,b,C,I,O,H,F="";16&h&&(y=Ag(s)),128&h&&(b=Ag(s)),257==(257&h)&&(C=Ag(s)),1==(257&h)&&(I=function H2(s,l){var a=s.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return function XF(s){var l=s.read_shift(4),a=s.l,d=!1;l>24&&(s.l+=l-24,"795881f43b1d7f48af2c825dc4852763"===s.read_shift(16)&&(d=!0),s.l=a);var h=s.read_shift((d?l-24:l)>>1,"utf16le").replace(Ns,"");return d&&(s.l+=24),h}(s);case"0303000000000000c000000000000046":return function U2(s){for(var l=s.read_shift(2),a="";l-- >0;)a+="../";var d=s.read_shift(0,"lpstr-ansi");if(s.l+=2,57005!=s.read_shift(2))throw new Error("Bad FileMoniker");if(0===s.read_shift(4))return a+d.replace(/\\/g,"/");var y=s.read_shift(4);if(3!=s.read_shift(2))throw new Error("Bad FileMoniker");return a+s.read_shift(y>>1,"utf16le").replace(Ns,"")}(s);default:throw new Error("Unsupported Moniker "+a)}}(s)),8&h&&(F=Ag(s)),32&h&&(O=s.read_shift(16)),64&h&&(H=Cg(s)),s.l=a;var W=b||C||I||"";W&&F&&(W+="#"+F),W||(W="#"+F),2&h&&"/"==W.charAt(0)&&"/"!=W.charAt(1)&&(W="file://"+W);var G={Target:W};return O&&(G.guid=O),H&&(G.time=H),y&&(G.Tooltip=y),G}(s,l-24);return[a,d]}},441:{},442:{f:Mh},443:{},444:{f:os},445:{},446:{},448:{f:Zu},449:{f:function tP(s){return s.read_shift(2),s.read_shift(4)},r:2},450:{f:Zu},512:{f:Q2},513:{f:mE},515:{f:function oE(s,l,a){a.biffguess&&2==a.biff&&(a.biff=5);var d=Xa(s),h=Vr(s);return d.val=h,d}},516:{f:function Dc(s,l,a){a.biffguess&&2==a.biff&&(a.biff=5);var h=Xa(s);2==a.biff&&s.l++;var y=Mh(s,0,a);return h.val=y,h}},517:{f:ex},519:{f:tp},520:{f:function ZF(s){var l={};l.r=s.read_shift(2),l.c=s.read_shift(2),l.cnt=s.read_shift(2)-l.c;var a=s.read_shift(2);s.l+=4;var d=s.read_shift(1);return s.l+=3,7&d&&(l.level=7&d),32&d&&(l.hidden=!0),64&d&&(l.hpt=a/20),l}},523:{},545:{f:ix},549:{f:tE},566:{},574:{f:function iP(s,l,a){return a&&a.biff>=2&&a.biff<5?{}:{RTL:64&s.read_shift(2)}}},638:{f:function oP(s){var l=s.read_shift(2),a=s.read_shift(2),d=T1(s);return{r:l,c:a,ixfe:d[0],rknum:d[1]}}},659:{},1048:{},1054:{f:function Pg(s,l,a){return[s.read_shift(2),xl(s,0,a)]}},1084:{},1212:{f:function lE(s,l,a){var d=Xf(s);s.l++;var h=s.read_shift(1);return[Ew(s,l-=8,a),h,d]}},2048:{f:function fE(s,l){s.read_shift(2);var a=Fg(s),d=s.read_shift((l-10)/2,"dbcs-cont");return[a,d=d.replace(Ns,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:lu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Zu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function Uh(s){s.l+=2;var l={cxfs:0,crc:0};return l.cxfs=s.read_shift(2),l.crc=s.read_shift(4),l},r:12},2173:{f:function op(s,l){s.l+=2;var d=s.read_shift(2);s.l+=2;for(var h=s.read_shift(2),y=[];h-- >0;)y.push(TP(s));return{ixfe:d,ext:y}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Fo,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function Lg(s,l,a){if(!(a.biff<8)){var d=s.read_shift(2),h=s.read_shift(2);return[bl(s,d,a),bl(s,h,a)]}s.l+=l},r:12},2197:{},2198:{f:function Ux(s,l,a){var d=s.l+l;if(124226!==s.read_shift(4)){if(!a.cellStyles)return void(s.l=d);var b,y=s.slice(s.l);s.l=d;try{b=l2(y,{type:"array"})}catch(I){return}var C=pl(b,"theme/theme/theme1.xml",!0);if(C)return U1(C,a)}},r:12},2199:{},2200:{},2201:{},2202:{f:function cE(s){return[0!==s.read_shift(4),0!==s.read_shift(4),s.read_shift(4)]},r:12},2203:{f:Zu},2204:{},2205:{},2206:{},2207:{},2211:{f:function eP(s){var l=function $2(s){var l=s.read_shift(2),a=s.read_shift(2);return s.l+=8,{type:l,flags:a}}(s);if(2211!=l.type)throw new Error("Invalid Future Record "+l.type);return 0!==s.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:os},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function Bg(s,l,a){var d={area:!1};if(5!=a.biff)return s.l+=l,d;var h=s.read_shift(1);return s.l+=3,16&h&&(d.area=!0),d}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function nd(s){for(var l=s.read_shift(2),a=[];l-- >0;)a.push(Ph(s));return a}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Q2},1:{},2:{f:function vE(s){var l=Xa(s);++s.l;var a=s.read_shift(2);return l.t="n",l.val=a,l}},3:{f:function lP(s){var l=Xa(s);++s.l;var a=Vr(s);return l.t="n",l.val=a,l}},4:{f:function _E(s,l,a){a.biffguess&&5==a.biff&&(a.biff=2);var d=Xa(s);++s.l;var h=xl(s,0,a);return d.t="str",d.val=h,d}},5:{f:ex},7:{f:function yE(s){var l=s.read_shift(1);return 0===l?(s.l++,""):s.read_shift(l,"sbcs-cont")}},8:{},9:{f:lu},11:{},22:{f:os},30:{f:X2},31:{},32:{},33:{f:ix},36:{},37:{f:tE},50:{f:function bE(s,l){s.l+=6,s.l+=2,s.l+=1,s.l+=3,s.l+=1,s.l+=l-13}},62:{},52:{},67:{},68:{f:os},69:{},86:{},126:{},127:{f:function Hh(s){var l=s.read_shift(2),a=s.read_shift(2),d=s.read_shift(4),h={fmt:l,env:a,len:d,data:s.slice(s.l,s.l+d)};return s.l+=d,h}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function xE(s,l,a){var d=s.l+l,h=Xa(s),y=s.read_shift(2),b=bl(s,y,a);return s.l=d,h.t="str",h.val=b,h}},223:{},234:{},354:{},421:{},518:{f:o0},521:{f:lu},536:{f:aE},547:{f:Og},561:{},579:{},1030:{f:o0},1033:{f:lu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function tn(s,l,a,d){var h=l;if(!isNaN(h)){var y=d||(a||[]).length||0,b=s.next(4);b.write_shift(2,h),b.write_shift(2,y),y>0&&Hf(a)&&s.push(a)}}function of(s,l,a){return s||(s=Tt(7)),s.write_shift(2,l),s.write_shift(2,a),s.write_shift(2,0),s.write_shift(1,0),s}function mu(s,l,a,d){if(null!=l.v)switch(l.t){case"d":case"n":var h="d"==l.t?ns(Kn(l.v)):l.v;return void(h==(0|h)&&h>=0&&h<65536?tn(s,2,function cP(s,l,a){var d=Tt(9);return of(d,s,l),d.write_shift(2,a),d}(a,d,h)):tn(s,3,function fx(s,l,a){var d=Tt(15);return of(d,s,l),d.write_shift(8,a,"f"),d}(a,d,h)));case"b":case"e":return void tn(s,5,function A(s,l,a,d){var h=Tt(9);return of(h,s,l),kg(a,d||"b",h),h}(a,d,l.v,l.t));case"s":case"str":return void tn(s,4,function Gk(s,l,a){var d=Tt(8+2*a.length);return of(d,s,l),d.write_shift(1,a.length),d.write_shift(a.length,a,"sbcs"),d.l<d.length?d.slice(0,d.l):d}(a,d,(l.v||"").slice(0,255)))}tn(s,1,of(null,a,d))}function TC(s,l,a,d,h){var y=16+pu(h.cellXfs,l,h);if(null!=l.v||l.bf)if(l.bf)tn(s,6,function F4(s,l,a,d,h){var y=Kd(l,a,h),b=function kw(s){if(null==s){var l=Tt(8);return l.write_shift(1,3),l.write_shift(1,0),l.write_shift(2,0),l.write_shift(2,0),l.write_shift(2,65535),l}return ou("number"==typeof s?s:0)}(s.v),C=Tt(6);C.write_shift(2,33),C.write_shift(4,0);for(var F=Tt(s.bf.length),O=0;O<s.bf.length;++O)F[O]=s.bf[O];return es([y,b,C,F])}(l,a,d,0,y));else switch(l.t){case"d":case"n":tn(s,515,function sE(s,l,a,d){var h=Tt(14);return Kd(s,l,d,h),ou(a,h),h}(a,d,"d"==l.t?ns(Kn(l.v)):l.v,y));break;case"b":case"e":tn(s,517,function rE(s,l,a,d,h,y){var b=Tt(8);return Kd(s,l,d,b),kg(a,y,b),b}(a,d,l.v,y,0,l.t));break;case"s":case"str":h.bookSST?tn(s,253,function wl(s,l,a,d){var h=Tt(10);return Kd(s,l,d,h),h.write_shift(4,a),h}(a,d,hv(h.Strings,l.v,h.revStrings),y)):tn(s,516,function Y2(s,l,a,d,h){var y=!h||8==h.biff,b=Tt(+y+8+(1+y)*a.length);return Kd(s,l,d,b),b.write_shift(2,a.length),y&&b.write_shift(1,1),b.write_shift((1+y)*a.length,a,y?"utf16le":"sbcs"),b}(a,d,(l.v||"").slice(0,255),y,h));break;default:tn(s,513,Kd(a,d,y))}else tn(s,513,Kd(a,d,y))}function SC(s,l,a){var O,d=Vn(),h=a.SheetNames[s],y=a.Sheets[h]||{},b=(a||{}).Workbook||{},C=(b.Sheets||[])[s]||{},I=Array.isArray(y),F=8==l.biff,H="",W=[],G=Yi(y["!ref"]||"A1"),X=F?65536:16384;if(G.e.c>255||G.e.r>=X){if(l.WTF)throw new Error("Range "+(y["!ref"]||"A1")+" exceeds format limit A1:IV16384");G.e.c=Math.min(G.e.c,255),G.e.r=Math.min(G.e.c,X-1)}tn(d,2057,td(0,16,l)),tn(d,13,Ql(1)),tn(d,12,Ql(100)),tn(d,15,wa(!0)),tn(d,17,wa(!1)),tn(d,16,ou(.001)),tn(d,95,wa(!0)),tn(d,42,wa(!1)),tn(d,43,wa(!1)),tn(d,130,Ql(1)),tn(d,128,function Z2(s){var l=Tt(8);return l.write_shift(4,0),l.write_shift(2,s[0]?s[0]+1:0),l.write_shift(2,s[1]?s[1]+1:0),l}([0,0])),tn(d,131,wa(!1)),tn(d,132,wa(!1)),F&&function CC(s,l){if(l){var a=0;l.forEach(function(d,h){++a<=256&&d&&tn(s,125,function ux(s,l){var a=Tt(12);a.write_shift(2,l),a.write_shift(2,l),a.write_shift(2,256*s.width),a.write_shift(2,0);var d=0;return s.hidden&&(d|=1),a.write_shift(1,d),a.write_shift(1,d=s.level||0),a.write_shift(2,0),a}(am(h,d),h))})}}(d,y["!cols"]),tn(d,512,function iE(s,l){var a=8!=l.biff&&l.biff?2:4,d=Tt(2*a+6);return d.write_shift(a,s.s.r),d.write_shift(a,s.e.r+1),d.write_shift(2,s.s.c),d.write_shift(2,s.e.c+1),d.write_shift(2,0),d}(G,l)),F&&(y["!links"]=[]);for(var V=G.s.r;V<=G.e.r;++V){H=jr(V);for(var Z=G.s.c;Z<=G.e.c;++Z){V===G.s.r&&(W[Z]=to(Z)),O=W[Z]+H;var he=I?(y[V]||[])[Z]:y[O];!he||(TC(d,he,V,Z,l),F&&he.l&&y["!links"].push([O,he.l]))}}var ge=C.CodeName||C.name||h;return F&&tn(d,574,function ss(s){var l=Tt(18),a=1718;return s&&s.RTL&&(a|=64),l.write_shift(2,a),l.write_shift(4,0),l.write_shift(4,64),l.write_shift(4,0),l.write_shift(4,0),l}((b.Views||[])[0])),F&&(y["!merges"]||[]).length&&tn(d,229,function ox(s){var l=Tt(2+8*s.length);l.write_shift(2,s.length);for(var a=0;a<s.length;++a)Oh(s[a],l);return l}(y["!merges"])),F&&function wC(s,l){for(var a=0;a<l["!links"].length;++a){var d=l["!links"][a];tn(s,440,Vh(d)),d[1].Tooltip&&tn(s,2048,pE(d))}delete l["!links"]}(d,y),tn(d,442,Dg(ge)),F&&function bC(s,l){var a=Tt(19);a.write_shift(4,2151),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,1),a.write_shift(4,0),tn(s,2151,a),(a=Tt(39)).write_shift(4,2152),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(2,1),a.write_shift(4,4),a.write_shift(2,0),Oh(Yi(l["!ref"]||"A1"),a),a.write_shift(4,4),tn(s,2152,a)}(d,y),tn(d,10),d.end()}function EC(s,l,a){var d=Vn(),h=(s||{}).Workbook||{},y=h.Sheets||[],b=h.WBProps||{},C=8==a.biff,I=5==a.biff;tn(d,2057,td(0,5,a)),"xla"==a.bookType&&tn(d,135),tn(d,225,C?Ql(1200):null),tn(d,193,function Ih(s,l){l||(l=Tt(s));for(var a=0;a<s;++a)l.write_shift(1,0);return l}(2)),I&&tn(d,191),I&&tn(d,192),tn(d,226),tn(d,92,function k1(s,l){var a=!l||8==l.biff,d=Tt(a?112:54);for(d.write_shift(8==l.biff?2:1,7),a&&d.write_shift(1,0),d.write_shift(4,859007059),d.write_shift(4,5458548|(a?0:536870912));d.l<d.length;)d.write_shift(1,a?0:32);return d}(0,a)),tn(d,66,Ql(C?1200:1252)),C&&tn(d,353,Ql(0)),C&&tn(d,448),tn(d,317,function dx(s){for(var l=Tt(2*s),a=0;a<s;++a)l.write_shift(2,a+1);return l}(s.SheetNames.length)),C&&s.vbaraw&&tn(d,211),C&&s.vbaraw&&tn(d,442,Dg(b.CodeName||"ThisWorkbook")),tn(d,156,Ql(17)),tn(d,25,wa(!1)),tn(d,18,wa(!1)),tn(d,19,Ql(0)),C&&tn(d,431,wa(!1)),C&&tn(d,444,Ql(0)),tn(d,61,function Lh(){var s=Tt(18);return s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,29280),s.write_shift(2,17600),s.write_shift(2,56),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,1),s.write_shift(2,500),s}()),tn(d,64,wa(!1)),tn(d,141,Ql(0)),tn(d,34,wa("true"==function gp(s){return s.Workbook&&s.Workbook.WBProps&&Kr(s.Workbook.WBProps.date1904)?"true":"false"}(s))),tn(d,14,wa(!0)),C&&tn(d,439,wa(!1)),tn(d,218,Ql(0)),function Uv(s,l,a){tn(s,49,function rP(s,l){var a=s.name||"Arial",d=l&&5==l.biff,y=Tt(d?15+a.length:16+2*a.length);return y.write_shift(2,20*(s.sz||12)),y.write_shift(4,0),y.write_shift(2,400),y.write_shift(4,0),y.write_shift(2,0),y.write_shift(1,a.length),d||y.write_shift(1,1),y.write_shift((d?1:2)*a.length,a,d?"sbcs":"utf16le"),y}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},a))}(d,0,a),function yC(s,l,a){!l||[[5,8],[23,26],[41,44],[50,392]].forEach(function(d){for(var h=d[0];h<=d[1];++h)null!=l[h]&&tn(s,1054,Bh(h,l[h],a))})}(d,s.SSF,a),function xC(s,l){for(var a=0;a<16;++a)tn(s,224,Yd({numFmtId:0,style:!0},0,l));l.cellXfs.forEach(function(d){tn(s,224,Yd(d,0,l))})}(d,a),C&&tn(d,352,wa(!1));var O=d.end(),H=Vn();C&&tn(H,140,function Rg(s){return s||(s=Tt(4)),s.write_shift(2,1),s.write_shift(2,1),s}()),C&&a.Strings&&function _C(s,l,a,d){var h=d||(a||[]).length||0;if(h<=8224)return tn(s,l,a,h);var y=l;if(!isNaN(y)){for(var b=a.parts||[],C=0,I=0,F=0;F+(b[C]||8224)<=8224;)F+=b[C]||8224,C++;var O=s.next(4);for(O.write_shift(2,y),O.write_shift(2,F),s.push(a.slice(I,I+F)),I+=F;I<h;){for((O=s.next(4)).write_shift(2,60),F=0;F+(b[C]||8224)<=8224;)F+=b[C]||8224,C++;O.write_shift(2,F),s.push(a.slice(I,I+F)),I+=F}}}(H,252,function eE(s,l){var a=Tt(8);a.write_shift(4,s.Count),a.write_shift(4,s.Unique);for(var d=[],h=0;h<s.length;++h)d[h]=V2(s[h]);var y=es([a].concat(d));return y.parts=[a.length].concat(d.map(function(b){return b.length})),y}(a.Strings)),tn(H,10);var W=H.end(),G=Vn(),X=0,V=0;for(V=0;V<s.SheetNames.length;++V)X+=(C?12:11)+(C?2:1)*s.SheetNames[V].length;var Z=O.length+X+W.length;for(V=0;V<s.SheetNames.length;++V)tn(G,133,Z5({pos:Z,hs:(y[V]||{}).Hidden||0,dt:0,name:s.SheetNames[V]},a)),Z+=l[V].length;var ge=G.end();if(X!=ge.length)throw new Error("BS8 "+X+" != "+ge.length);var le=[];return O.length&&le.push(O),ge.length&&le.push(ge),W.length&&le.push(W),es(le)}function kC(s,l){for(var a=0;a<=s.SheetNames.length;++a){var d=s.Sheets[s.SheetNames[a]];d&&d["!ref"]&&no(d["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+s.SheetNames[a]+"' extends beyond column IV (255).  Data may be lost.")}var y=l||{};switch(y.biff||2){case 8:case 5:return function o6(s,l){var a=l||{},d=[];s&&!s.SSF&&(s.SSF=Bn(Wn)),s&&s.SSF&&(Nd(),yh(s.SSF),a.revssf=wh(s.SSF),a.revssf[s.SSF[65535]]=0,a.ssf=s.SSF),a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,Jv(a),a.cellXfs=[],pu(a.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={});for(var h=0;h<s.SheetNames.length;++h)d[d.length]=SC(h,a,s);return d.unshift(EC(s,d,a)),es(d)}(s,l);case 4:case 3:case 2:return function vC(s,l){for(var a=l||{},d=Vn(),h=0,y=0;y<s.SheetNames.length;++y)s.SheetNames[y]==a.sheet&&(h=y);if(0==h&&a.sheet&&s.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);return tn(d,4==a.biff?1033:3==a.biff?521:9,td(0,16,a)),function Sl(s,l,a,d){var b,h=Array.isArray(l),y=Yi(l["!ref"]||"A1"),C="",I=[];if(y.e.c>255||y.e.r>16383){if(d.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,16383),b=yi(y)}for(var F=y.s.r;F<=y.e.r;++F){C=jr(F);for(var O=y.s.c;O<=y.e.c;++O){F===y.s.r&&(I[O]=to(O)),b=I[O]+C;var H=h?(l[F]||[])[O]:l[b];!H||mu(s,H,F,O)}}}(d,s.Sheets[s.SheetNames[h]],0,a),tn(d,10),d.end()}(s,l)}throw new Error("invalid type "+y.bookType+" for BIFF")}function DC(s,l){var a=l||{},d=a.dense?[]:{},h=(s=s.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!h)throw new Error("Invalid HTML: could not find <table>");var y=s.match(/<\/table/i),b=h.index,C=y&&y.index||s.length,I=s2(s.slice(b,C),/(:?<tr[^>]*>)/i,"<tr>"),F=-1,O=0,H=0,W=0,G={s:{r:1e7,c:1e7},e:{r:0,c:0}},X=[];for(b=0;b<I.length;++b){var V=I[b].trim(),Z=V.slice(0,3).toLowerCase();if("<tr"!=Z){if("<td"==Z||"<th"==Z){var he=V.split(/<\/t[dh]>/i);for(C=0;C<he.length;++C){var ge=he[C].trim();if(ge.match(/<t[dh]/i)){for(var le=ge,Ke=0;"<"==le.charAt(0)&&(Ke=le.indexOf(">"))>-1;)le=le.slice(Ke+1);for(var tt=0;tt<X.length;++tt){var ze=X[tt];ze.s.c==O&&ze.s.r<F&&F<=ze.e.r&&(O=ze.e.c+1,tt=-1)}var be=Qn(ge.slice(0,ge.indexOf(">")));W=be.colspan?+be.colspan:1,((H=+be.rowspan)>1||W>1)&&X.push({s:{r:F,c:O},e:{r:F+(H||1)-1,c:O+W-1}});var Qe=be.t||be["data-t"]||"";if(!le.length){O+=W;continue}if(le=tu(le),G.s.r>F&&(G.s.r=F),G.e.r<F&&(G.e.r=F),G.s.c>O&&(G.s.c=O),G.e.c<O&&(G.e.c=O),!le.length){O+=W;continue}var qe={t:"s",v:le};a.raw||!le.trim().length||"s"==Qe||("TRUE"===le?qe={t:"b",v:!0}:"FALSE"===le?qe={t:"b",v:!1}:isNaN(ql(le))?isNaN(si(le).getDate())||(qe={t:"d",v:Kn(le)},a.cellDates||(qe={t:"n",v:ns(qe.v)}),qe.z=a.dateNF||Wn[14]):qe={t:"n",v:ql(le)}),a.dense?(d[F]||(d[F]=[]),d[F][O]=qe):d[qn({r:F,c:O})]=qe,O+=W}}}}else{if(++F,a.sheetRows&&a.sheetRows<=F){--F;break}O=0}}return d["!ref"]=yi(G),X.length&&(d["!merges"]=X),d}function Hv(s,l,a,d){for(var h=s["!merges"]||[],y=[],b=l.s.c;b<=l.e.c;++b){for(var C=0,I=0,F=0;F<h.length;++F)if(!(h[F].s.r>a||h[F].s.c>b||h[F].e.r<a||h[F].e.c<b)){if(h[F].s.r<a||h[F].s.c<b){C=-1;break}C=h[F].e.r-h[F].s.r+1,I=h[F].e.c-h[F].s.c+1;break}if(!(C<0)){var O=qn({r:a,c:b}),H=d.dense?(s[a]||[])[b]:s[O],W=H&&null!=H.v&&(H.h||Th(H.w||(Cc(H),H.w)||""))||"",G={};C>1&&(G.rowspan=C),I>1&&(G.colspan=I),d.editable?W='<span contenteditable="true">'+W+"</span>":H&&(G["data-t"]=H&&H.t||"z",null!=H.v&&(G["data-v"]=H.v),null!=H.z&&(G["data-z"]=H.z),H.l&&"#"!=(H.l.Target||"#").charAt(0)&&(W='<a href="'+H.l.Target+'">'+W+"</a>")),G.id=(d.id||"sjs")+"-"+O,y.push(Jt("td",W,G))}}return"<tr>"+y.join("")+"</tr>"}var IC='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',zo="</body></html>";function MC(s,l,a){return[].join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function FC(s,l){var a=l||{},h=null!=a.footer?a.footer:zo,y=[null!=a.header?a.header:IC],b=no(s["!ref"]);a.dense=Array.isArray(s),y.push(MC(0,0,a));for(var C=b.s.r;C<=b.e.r;++C)y.push(Hv(s,b,C,a));return y.push("</table>"+h),y.join("")}function zv(s,l,a){var d=a||{},h=0,y=0;if(null!=d.origin)if("number"==typeof d.origin)h=d.origin;else{var b="string"==typeof d.origin?Xr(d.origin):d.origin;h=b.r,y=b.c}var C=l.getElementsByTagName("tr"),I=Math.min(d.sheetRows||1e7,C.length),F={s:{r:0,c:0},e:{r:h,c:y}};if(s["!ref"]){var O=no(s["!ref"]);F.s.r=Math.min(F.s.r,O.s.r),F.s.c=Math.min(F.s.c,O.s.c),F.e.r=Math.max(F.e.r,O.e.r),F.e.c=Math.max(F.e.c,O.e.c),-1==h&&(F.e.r=h=O.e.r+1)}var H=[],W=0,G=s["!rows"]||(s["!rows"]=[]),X=0,V=0,Z=0,he=0,ge=0,le=0;for(s["!cols"]||(s["!cols"]=[]);X<C.length&&V<I;++X){var Ke=C[X];if($v(Ke)){if(d.display)continue;G[V]={hidden:!0}}var tt=Ke.children;for(Z=he=0;Z<tt.length;++Z){var ze=tt[Z];if(!d.display||!$v(ze)){var be=ze.hasAttribute("data-v")?ze.getAttribute("data-v"):ze.hasAttribute("v")?ze.getAttribute("v"):tu(ze.innerHTML),Qe=ze.getAttribute("data-z")||ze.getAttribute("z");for(W=0;W<H.length;++W){var qe=H[W];qe.s.c==he+y&&qe.s.r<V+h&&V+h<=qe.e.r&&(he=qe.e.c+1-y,W=-1)}le=+ze.getAttribute("colspan")||1,((ge=+ze.getAttribute("rowspan")||1)>1||le>1)&&H.push({s:{r:V+h,c:he+y},e:{r:V+h+(ge||1)-1,c:he+y+(le||1)-1}});var gt={t:"s",v:be},bt=ze.getAttribute("data-t")||ze.getAttribute("t")||"";null!=be&&(0==be.length?gt.t=bt||"z":d.raw||0==be.trim().length||"s"==bt||("TRUE"===be?gt={t:"b",v:!0}:"FALSE"===be?gt={t:"b",v:!1}:isNaN(ql(be))?isNaN(si(be).getDate())||(gt={t:"d",v:Kn(be)},d.cellDates||(gt={t:"n",v:ns(gt.v)}),gt.z=d.dateNF||Wn[14]):gt={t:"n",v:ql(be)})),void 0===gt.z&&null!=Qe&&(gt.z=Qe);var et="",Xt=ze.getElementsByTagName("A");if(Xt&&Xt.length)for(var vn=0;vn<Xt.length&&(!Xt[vn].hasAttribute("href")||"#"==(et=Xt[vn].getAttribute("href")).charAt(0));++vn);et&&"#"!=et.charAt(0)&&(gt.l={Target:et}),d.dense?(s[V+h]||(s[V+h]=[]),s[V+h][he+y]=gt):s[qn({c:he+y,r:V+h})]=gt,F.e.c<he+y&&(F.e.c=he+y),he+=le}}++V}return H.length&&(s["!merges"]=(s["!merges"]||[]).concat(H)),F.e.r=Math.max(F.e.r,V-1+h),s["!ref"]=yi(F),V>=I&&(s["!fullref"]=yi((F.e.r=C.length-X+V-1+h,F))),s}function PC(s,l){return zv((l||{}).dense?[]:{},s,l)}function $v(s){var l="",a=function xp(s){return s.ownerDocument.defaultView&&"function"==typeof s.ownerDocument.defaultView.getComputedStyle?s.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(s);return a&&(l=a(s).getPropertyValue("display")),l||(l=s.style&&s.style.display),"none"===l}function Kk(s){var l=s.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(d,h){return Array(parseInt(h,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[lr(l.replace(/<[^>]*>/g,""))]}var NC={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Wv(s,l){var y,b,O,H,V,Z,a=l||{},d=p2(s),h=[],C={name:""},I="",F=0,W={},G=[],X=a.dense?[]:{},he={value:""},ge="",le=0,tt=[],ze=-1,be=-1,Qe={s:{r:1e6,c:1e7},e:{r:0,c:0}},qe=0,gt={},bt=[],et={},Xt=0,vn=0,Zt=[],Fn=1,Dn=1,Li=[],ln={Names:[]},Mn={},Pt=["",""],Ee=[],dt={},Fe="",Pe=0,It=!1,sn=!1,Yt=0;for(cr.lastIndex=0,d=d.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");V=cr.exec(d);)switch(V[3]=V[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===V[1]?(X["!ref"]=Qe.e.c>=Qe.s.c&&Qe.e.r>=Qe.s.r?yi(Qe):"A1:A1",a.sheetRows>0&&a.sheetRows<=Qe.e.r&&(X["!fullref"]=X["!ref"],Qe.e.r=a.sheetRows-1,X["!ref"]=yi(Qe)),bt.length&&(X["!merges"]=bt),Zt.length&&(X["!rows"]=Zt),O.name=O.\u540d\u79f0||O.name,"undefined"!=typeof JSON&&JSON.stringify(O),G.push(O.name),W[O.name]=X,sn=!1):"/"!==V[0].charAt(V[0].length-2)&&(O=Qn(V[0],!1),ze=be=-1,Qe.s.r=Qe.s.c=1e7,Qe.e.r=Qe.e.c=0,X=a.dense?[]:{},bt=[],Zt=[],sn=!0);break;case"table-row-group":"/"===V[1]?--qe:++qe;break;case"table-row":case"\u884c":if("/"===V[1]){ze+=Fn,Fn=1;break}if((H=Qn(V[0],!1)).\u884c\u53f7?ze=H.\u884c\u53f7-1:-1==ze&&(ze=0),(Fn=+H["number-rows-repeated"]||1)<10)for(Yt=0;Yt<Fn;++Yt)qe>0&&(Zt[ze+Yt]={level:qe});be=-1;break;case"covered-table-cell":"/"!==V[1]&&++be,a.sheetStubs&&(a.dense?(X[ze]||(X[ze]=[]),X[ze][be]={t:"z"}):X[qn({r:ze,c:be})]={t:"z"}),ge="",tt=[];break;case"table-cell":case"\u6570\u636e":if("/"===V[0].charAt(V[0].length-2))++be,he=Qn(V[0],!1),Dn=parseInt(he["number-columns-repeated"]||"1",10),Z={t:"z",v:null},he.formula&&0!=a.cellFormula&&(Z.f=dv(lr(he.formula))),"string"==(he.\u6570\u636e\u7c7b\u578b||he["value-type"])&&(Z.t="s",Z.v=lr(he["string-value"]||""),a.dense?(X[ze]||(X[ze]=[]),X[ze][be]=Z):X[qn({r:ze,c:be})]=Z),be+=Dn-1;else if("/"!==V[1]){ge="",le=0,tt=[],Dn=1;var Qt=Fn?ze+Fn-1:ze;if(++be>Qe.e.c&&(Qe.e.c=be),be<Qe.s.c&&(Qe.s.c=be),ze<Qe.s.r&&(Qe.s.r=ze),Qt>Qe.e.r&&(Qe.e.r=Qt),Ee=[],dt={},Z={t:(he=Qn(V[0],!1)).\u6570\u636e\u7c7b\u578b||he["value-type"],v:null},a.cellFormula)if(he.formula&&(he.formula=lr(he.formula)),he["number-matrix-columns-spanned"]&&he["number-matrix-rows-spanned"]&&(Xt=parseInt(he["number-matrix-rows-spanned"],10)||0,vn=parseInt(he["number-matrix-columns-spanned"],10)||0,Z.F=yi(et={s:{r:ze,c:be},e:{r:ze+Xt-1,c:be+vn-1}}),Li.push([et,Z.F])),he.formula)Z.f=dv(he.formula);else for(Yt=0;Yt<Li.length;++Yt)ze>=Li[Yt][0].s.r&&ze<=Li[Yt][0].e.r&&be>=Li[Yt][0].s.c&&be<=Li[Yt][0].e.c&&(Z.F=Li[Yt][1]);switch((he["number-columns-spanned"]||he["number-rows-spanned"])&&(Xt=parseInt(he["number-rows-spanned"],10)||0,vn=parseInt(he["number-columns-spanned"],10)||0,bt.push(et={s:{r:ze,c:be},e:{r:ze+Xt-1,c:be+vn-1}})),he["number-columns-repeated"]&&(Dn=parseInt(he["number-columns-repeated"],10)),Z.t){case"boolean":Z.t="b",Z.v=Kr(he["boolean-value"]);break;case"float":case"percentage":case"currency":Z.t="n",Z.v=parseFloat(he.value);break;case"date":Z.t="d",Z.v=Kn(he["date-value"]),a.cellDates||(Z.t="n",Z.v=ns(Z.v)),Z.z="m/d/yy";break;case"time":Z.t="n",Z.v=Ls(he["time-value"])/86400,a.cellDates&&(Z.t="d",Z.v=ng(Z.v)),Z.z="HH:MM:SS";break;case"number":Z.t="n",Z.v=parseFloat(he.\u6570\u636e\u6570\u503c);break;default:if("string"!==Z.t&&"text"!==Z.t&&Z.t)throw new Error("Unsupported value type "+Z.t);Z.t="s",null!=he["string-value"]&&(ge=lr(he["string-value"]),tt=[])}}else{if(It=!1,"s"===Z.t&&(Z.v=ge||"",tt.length&&(Z.R=tt),It=0==le),Mn.Target&&(Z.l=Mn),Ee.length>0&&(Z.c=Ee,Ee=[]),ge&&!1!==a.cellText&&(Z.w=ge),It&&(Z.t="z",delete Z.v),(!It||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=ze))for(var Rt=0;Rt<Fn;++Rt){if(Dn=parseInt(he["number-columns-repeated"]||"1",10),a.dense)for(X[ze+Rt]||(X[ze+Rt]=[]),X[ze+Rt][be]=0==Rt?Z:Bn(Z);--Dn>0;)X[ze+Rt][be+Dn]=Bn(Z);else for(X[qn({r:ze+Rt,c:be})]=Z;--Dn>0;)X[qn({r:ze+Rt,c:be+Dn})]=Bn(Z);Qe.e.c<=be&&(Qe.e.c=be)}be+=(Dn=parseInt(he["number-columns-repeated"]||"1",10))-1,Dn=0,Z={},ge="",tt=[]}Mn={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===V[1]){if((y=h.pop())[0]!==V[3])throw"Bad state: "+y}else"/"!==V[0].charAt(V[0].length-2)&&h.push([V[3],!0]);break;case"annotation":if("/"===V[1]){if((y=h.pop())[0]!==V[3])throw"Bad state: "+y;dt.t=ge,tt.length&&(dt.R=tt),dt.a=Fe,Ee.push(dt)}else"/"!==V[0].charAt(V[0].length-2)&&h.push([V[3],!1]);Fe="",Pe=0,ge="",le=0,tt=[];break;case"creator":"/"===V[1]?Fe=d.slice(Pe,V.index):Pe=V.index+V[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===V[1]){if((y=h.pop())[0]!==V[3])throw"Bad state: "+y}else"/"!==V[0].charAt(V[0].length-2)&&h.push([V[3],!1]);ge="",le=0,tt=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===V[1]){if(gt[C.name]=I,(y=h.pop())[0]!==V[3])throw"Bad state: "+y}else"/"!==V[0].charAt(V[0].length-2)&&(I="",C=Qn(V[0],!1),h.push([V[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(h[h.length-1][0]){case"time-style":case"date-style":b=Qn(V[0],!1),I+=NC[V[3]]["long"===b.style?1:0]}break;case"text":if("/>"===V[0].slice(-2))break;if("/"===V[1])switch(h[h.length-1][0]){case"number-style":case"date-style":case"time-style":I+=d.slice(F,V.index)}else F=V.index+V[0].length;break;case"named-range":Pt=fv((b=Qn(V[0],!1))["cell-range-address"]);var gi={Name:b.name,Ref:Pt[0]+"!"+Pt[1]};sn&&(gi.Sheet=G.length),ln.Names.push(gi);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(h[h.length-1][0])>-1)break;if("/"!==V[1]||he&&he["string-value"])Qn(V[0],!1),le=V.index+V[0].length;else{var Se=Kk(d.slice(le,V.index));ge=(ge.length>0?ge+"\n":"")+Se[0]}break;case"database-range":if("/"===V[1])break;try{W[(Pt=fv(Qn(V[0])["target-range-address"]))[0]]["!autofilter"]={ref:Pt[1]}}catch(Hi){}break;case"a":if("/"!==V[1]){if(!(Mn=Qn(V[0],!1)).href)break;Mn.Target=lr(Mn.href),delete Mn.href,"#"==Mn.Target.charAt(0)&&Mn.Target.indexOf(".")>-1?(Pt=fv(Mn.Target.slice(1)),Mn.Target="#"+Pt[0]+"!"+Pt[1]):Mn.Target.match(/^\.\.[\\\/]/)&&(Mn.Target=Mn.Target.slice(3))}break;default:switch(V[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(a.WTF)throw new Error(V)}}var Tr={Sheets:W,SheetNames:G,Workbook:ln};return a.bookSheets&&delete Tr.Sheets,Tr}function qv(s,l){return Wv(s,l)}var s6=function(){var s=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),l="<office:document-styles "+ya({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+s+"</office:document-styles>";return function(){return br+l}}(),ud=function(){var s=function(y){return Vt(y).replace(/  +/g,function(b){return'<text:s text:c="'+b.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},l="          <table:table-cell />\n",d=function(y,b,C){var I=[];I.push('      <table:table table:name="'+Vt(b.SheetNames[C])+'" table:style-name="ta1">\n');var F=0,O=0,H=no(y["!ref"]||"A1"),W=y["!merges"]||[],G=0,X=Array.isArray(y);if(y["!cols"])for(O=0;O<=H.e.c;++O)I.push("        <table:table-column"+(y["!cols"][O]?' table:style-name="co'+y["!cols"][O].ods+'"':"")+"></table:table-column>\n");var Z=y["!rows"]||[];for(F=0;F<H.s.r;++F)I.push("        <table:table-row"+(Z[F]?' table:style-name="ro'+Z[F].ods+'"':"")+"></table:table-row>\n");for(;F<=H.e.r;++F){for(I.push("        <table:table-row"+(Z[F]?' table:style-name="ro'+Z[F].ods+'"':"")+">\n"),O=0;O<H.s.c;++O)I.push(l);for(;O<=H.e.c;++O){var he=!1,ge={},le="";for(G=0;G!=W.length;++G)if(!(W[G].s.c>O||W[G].s.r>F||W[G].e.c<O||W[G].e.r<F)){(W[G].s.c!=O||W[G].s.r!=F)&&(he=!0),ge["table:number-columns-spanned"]=W[G].e.c-W[G].s.c+1,ge["table:number-rows-spanned"]=W[G].e.r-W[G].s.r+1;break}if(he)I.push("          <table:covered-table-cell/>\n");else{var Ke=qn({r:F,c:O}),tt=X?(y[F]||[])[O]:y[Ke];if(tt&&tt.f&&(ge["table:formula"]=Vt(UP(tt.f)),tt.F&&tt.F.slice(0,Ke.length)==Ke)){var ze=no(tt.F);ge["table:number-matrix-columns-spanned"]=ze.e.c-ze.s.c+1,ge["table:number-matrix-rows-spanned"]=ze.e.r-ze.s.r+1}if(tt){switch(tt.t){case"b":le=tt.v?"TRUE":"FALSE",ge["office:value-type"]="boolean",ge["office:boolean-value"]=tt.v?"true":"false";break;case"n":le=tt.w||String(tt.v||0),ge["office:value-type"]="float",ge["office:value"]=tt.v||0;break;case"s":case"str":le=null==tt.v?"":tt.v,ge["office:value-type"]="string";break;case"d":le=tt.w||Kn(tt.v).toISOString(),ge["office:value-type"]="date",ge["office:date-value"]=Kn(tt.v).toISOString(),ge["table:style-name"]="ce1";break;default:I.push(l);continue}var be=s(le);if(tt.l&&tt.l.Target){var Qe=tt.l.Target;"#"!=(Qe="#"==Qe.charAt(0)?"#"+pv(Qe.slice(1)):Qe).charAt(0)&&!Qe.match(/^\w+:/)&&(Qe="../"+Qe),be=Jt("text:a",be,{"xlink:href":Qe.replace(/&/g,"&amp;")})}I.push("          "+Jt("table:table-cell",Jt("text:p",be,{}),ge)+"\n")}else I.push(l)}}I.push("        </table:table-row>\n")}return I.push("      </table:table>\n"),I.join("")};return function(b,C){var I=[br],F=ya({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),O=ya({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==C.bookType?(I.push("<office:document"+F+O+">\n"),I.push(Zs().replace(/office:document-meta/g,"office:meta"))):I.push("<office:document-content"+F+">\n"),function(y,b){y.push(" <office:automatic-styles>\n"),y.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),y.push('   <number:month number:style="long"/>\n'),y.push("   <number:text>/</number:text>\n"),y.push('   <number:day number:style="long"/>\n'),y.push("   <number:text>/</number:text>\n"),y.push("   <number:year/>\n"),y.push("  </number:date-style>\n");var C=0;b.SheetNames.map(function(F){return b.Sheets[F]}).forEach(function(F){if(F&&F["!cols"])for(var O=0;O<F["!cols"].length;++O)if(F["!cols"][O]){var H=F["!cols"][O];if(null==H.width&&null==H.wpx&&null==H.wch)continue;od(H),H.ods=C;var W=F["!cols"][O].wpx+"px";y.push('  <style:style style:name="co'+C+'" style:family="table-column">\n'),y.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+W+'"/>\n'),y.push("  </style:style>\n"),++C}});var I=0;b.SheetNames.map(function(F){return b.Sheets[F]}).forEach(function(F){if(F&&F["!rows"])for(var O=0;O<F["!rows"].length;++O)if(F["!rows"][O]){F["!rows"][O].ods=I;var H=F["!rows"][O].hpx+"px";y.push('  <style:style style:name="ro'+I+'" style:family="table-row">\n'),y.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+H+'"/>\n'),y.push("  </style:style>\n"),++I}}),y.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),y.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),y.push("  </style:style>\n"),y.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),y.push(" </office:automatic-styles>\n")}(I,b),I.push("  <office:body>\n"),I.push("    <office:spreadsheet>\n");for(var H=0;H!=b.SheetNames.length;++H)I.push(d(b.Sheets[b.SheetNames[H]],b,H));return I.push("    </office:spreadsheet>\n"),I.push("  </office:body>\n"),I.push("fods"==C.bookType?"</office:document>":"</office:document-content>"),I.join("")}}();function po(s,l){if("fods"==l.bookType)return ud(s,l);var a=a2(),d="",h=[],y=[];return Hn(a,d="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Hn(a,d="content.xml",ud(s,l)),h.push([d,"text/xml"]),y.push([d,"ContentFile"]),Hn(a,d="styles.xml",s6(s,l)),h.push([d,"text/xml"]),y.push([d,"StylesFile"]),Hn(a,d="meta.xml",br+Zs()),h.push([d,"text/xml"]),y.push([d,"MetadataFile"]),Hn(a,d="manifest.rdf",function bg(s){var l=[br];l.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var a=0;a!=s.length;++a)l.push(x2(s[a][0],s[a][1])),l.push(yg("",s[a][0]));return l.push(x2("","Document","pkg")),l.push("</rdf:RDF>"),l.join("")}(y)),h.push([d,"application/rdf+xml"]),Hn(a,d="META-INF/manifest.xml",function YF(s){var l=[br];l.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),l.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var a=0;a<s.length;++a)l.push('  <manifest:file-entry manifest:full-path="'+s[a][0]+'" manifest:media-type="'+s[a][1]+'"/>\n');return l.push("</manifest:manifest>"),l.join("")}(h)),a}function Ft(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function Gv(s){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(s):_n(hc(s))}function Ji(s){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(s):ha(hl(s))}function Cs(s){var l=s.reduce(function(h,y){return h+y.length},0),a=new Uint8Array(l),d=0;return s.forEach(function(h){a.set(h,d),d+=h.length}),a}function El(s){return 16843009*((s=(858993459&(s-=s>>1&1431655765))+(s>>2&858993459))+(s>>4)&252645135)>>>24}function pm(s,l){var a=l?l[0]:0,d=127&s[a];e:if(s[a++]>=128&&(d|=(127&s[a])<<7,s[a++]<128||(d|=(127&s[a])<<14,s[a++]<128)||(d|=(127&s[a])<<21,s[a++]<128)||(d+=(127&s[a])*Math.pow(2,28),++a,s[a++]<128)||(d+=(127&s[a])*Math.pow(2,35),++a,s[a++]<128)||(d+=(127&s[a])*Math.pow(2,42),++a,s[a++]<128)))break e;return l&&(l[0]=a),d}function Cr(s){var l=new Uint8Array(7);l[0]=127&s;var a=1;e:if(s>127){if(l[a-1]|=128,l[a]=s>>7&127,++a,s<=16383||(l[a-1]|=128,l[a]=s>>14&127,++a,s<=2097151)||(l[a-1]|=128,l[a]=s>>21&127,++a,s<=268435455)||(l[a-1]|=128,l[a]=s/256>>>21&127,++a,s<=34359738367)||(l[a-1]|=128,l[a]=s/65536>>>21&127,++a,s<=4398046511103))break e;l[a-1]|=128,l[a]=s/16777216>>>21&127,++a}return l.slice(0,a)}function So(s){var l=0,a=127&s[l];e:if(s[l++]>=128){if(a|=(127&s[l])<<7,s[l++]<128||(a|=(127&s[l])<<14,s[l++]<128)||(a|=(127&s[l])<<21,s[l++]<128))break e;a|=(127&s[l])<<28}return a}function ur(s){for(var l=[],a=[0];a[0]<s.length;){var C,d=a[0],h=pm(s,a),y=7&h,b=0;if(0==(h=Math.floor(h/8)))break;switch(y){case 0:for(var I=a[0];s[a[0]++]>=128;);C=s.slice(I,a[0]);break;case 5:C=s.slice(a[0],a[0]+(b=4)),a[0]+=b;break;case 1:C=s.slice(a[0],a[0]+(b=8)),a[0]+=b;break;case 2:b=pm(s,a),C=s.slice(a[0],a[0]+b),a[0]+=b;break;default:throw new Error("PB Type ".concat(y," for Field ").concat(h," at offset ").concat(d))}var F={data:C,type:y};null==l[h]?l[h]=[F]:l[h].push(F)}return l}function $o(s){var l=[];return s.forEach(function(a,d){a.forEach(function(h){!h.data||(l.push(Cr(8*d+h.type)),2==h.type&&l.push(Cr(h.data.length)),l.push(h.data))})}),Cs(l)}function sf(s,l){return(null==s?void 0:s.map(function(a){return l(a.data)}))||[]}function kl(s){for(var l,a=[],d=[0];d[0]<s.length;){var h=pm(s,d),y=ur(s.slice(d[0],d[0]+h));d[0]+=h;var b={id:So(y[1][0].data),messages:[]};y[2].forEach(function(C){var I=ur(C.data),F=So(I[3][0].data);b.messages.push({meta:I,data:s.slice(d[0],d[0]+F)}),d[0]+=F}),(null==(l=y[3])?void 0:l[0])&&(b.merge=So(y[3][0].data)>>>0>0),a.push(b)}return a}function af(s){var l=[];return s.forEach(function(a){var d=[];d[1]=[{data:Cr(a.id),type:0}],d[2]=[],null!=a.merge&&(d[3]=[{data:Cr(+!!a.merge),type:0}]);var h=[];a.messages.forEach(function(b){h.push(b.data),b.meta[3]=[{type:0,data:Cr(b.data.length)}],d[2].push({data:$o(b.meta),type:2})});var y=$o(d);l.push(Cr(y.length)),l.push(y),h.forEach(function(b){return l.push(b)})}),Cs(l)}function Yk(s,l){if(0!=s)throw new Error("Unexpected Snappy chunk type ".concat(s));for(var a=[0],d=pm(l,a),h=[];a[0]<l.length;){var y=3&l[a[0]];if(0!=y){var I=0,F=0;if(1==y?(F=4+(l[a[0]]>>2&7),I=(224&l[a[0]++])<<3,I|=l[a[0]++]):(F=1+(l[a[0]++]>>2),2==y?(I=l[a[0]]|l[a[0]+1]<<8,a[0]+=2):(I=(l[a[0]]|l[a[0]+1]<<8|l[a[0]+2]<<16|l[a[0]+3]<<24)>>>0,a[0]+=4)),h=[Cs(h)],0==I)throw new Error("Invalid offset 0");if(I>h[0].length)throw new Error("Invalid offset beyond length");if(F>=I)for(h.push(h[0].slice(-I)),F-=I;F>=h[h.length-1].length;)h.push(h[h.length-1]),F-=h[h.length-1].length;h.push(h[0].slice(-I,-I+F))}else{var b=l[a[0]++]>>2;if(b<60)++b;else{var C=b-59;b=l[a[0]],C>1&&(b|=l[a[0]+1]<<8),C>2&&(b|=l[a[0]+2]<<16),C>3&&(b|=l[a[0]+3]<<24),b>>>=0,b++,a[0]+=C}h.push(l.slice(a[0],a[0]+b)),a[0]+=b}}var O=Cs(h);if(O.length!=d)throw new Error("Unexpected length: ".concat(O.length," != ").concat(d));return O}function el(s){for(var l=[],a=0;a<s.length;){var d=s[a++],h=s[a]|s[a+1]<<8|s[a+2]<<16;l.push(Yk(d,s.slice(a+=3,a+h))),a+=h}if(a!==s.length)throw new Error("data is not a valid framed stream!");return Cs(l)}function lf(s){for(var l=[],a=0;a<s.length;){var d=Math.min(s.length-a,268435455),h=new Uint8Array(4);l.push(h);var y=Cr(d),b=y.length;l.push(y),d<=60?(b++,l.push(new Uint8Array([d-1<<2]))):d<=256?(b+=2,l.push(new Uint8Array([240,d-1&255]))):d<=65536?(b+=3,l.push(new Uint8Array([244,d-1&255,d-1>>8&255]))):d<=16777216?(b+=4,l.push(new Uint8Array([248,d-1&255,d-1>>8&255,d-1>>16&255]))):d<=4294967296&&(b+=5,l.push(new Uint8Array([252,d-1&255,d-1>>8&255,d-1>>16&255,d-1>>>24&255]))),l.push(s.slice(a,a+d)),b+=d,h[0]=0,h[1]=255&b,h[2]=b>>8&255,h[3]=b>>16&255,a+=d}return Cs(l)}function h0(s,l){var a=new Uint8Array(32),d=Ft(a),h=12,y=0;switch(a[0]=5,s.t){case"n":a[1]=2,function BC(s,l,a){var d=Math.floor(0==a?0:Math.LOG10E*Math.log(Math.abs(a)))+6176-20,h=a/Math.pow(10,d-6176);s[l+15]|=d>>7,s[l+14]|=(127&d)<<1;for(var y=0;h>=1;++y,h/=256)s[l+y]=255&h;s[l+15]|=a>=0?0:128}(a,h,s.v),y|=1,h+=16;break;case"b":a[1]=6,d.setFloat64(h,s.v?1:0,!0),y|=2,h+=8;break;case"s":if(-1==l.indexOf(s.v))throw new Error("Value ".concat(s.v," missing from SST!"));a[1]=3,d.setUint32(h,l.indexOf(s.v),!0),y|=8,h+=4;break;default:throw"unsupported cell type "+s.t}return d.setUint32(8,y,!0),a.slice(0,h)}function _(s,l){var a=new Uint8Array(32),d=Ft(a),h=12,y=0;switch(a[0]=3,s.t){case"n":a[2]=2,d.setFloat64(h,s.v,!0),y|=32,h+=8;break;case"b":a[2]=6,d.setFloat64(h,s.v?1:0,!0),y|=32,h+=8;break;case"s":if(-1==l.indexOf(s.v))throw new Error("Value ".concat(s.v," missing from SST!"));a[2]=3,d.setUint32(h,l.indexOf(s.v),!0),y|=16,h+=4;break;default:throw"unsupported cell type "+s.t}return d.setUint32(4,y,!0),a.slice(0,h)}function U(s,l,a){switch(s[0]){case 0:case 1:case 2:case 3:return function p0(s,l,a,d){var H,h=Ft(s),y=h.getUint32(4,!0),b=(d>1?12:8)+4*El(y&(d>1?3470:398)),C=-1,I=-1,F=NaN,O=new Date(2001,0,1);switch(512&y&&(C=h.getUint32(b,!0),b+=4),b+=4*El(y&(d>1?12288:4096)),16&y&&(I=h.getUint32(b,!0),b+=4),32&y&&(F=h.getFloat64(b,!0),b+=8),64&y&&(O.setTime(O.getTime()+1e3*h.getFloat64(b,!0)),b+=8),s[2]){case 0:break;case 2:H={t:"n",v:F};break;case 3:H={t:"s",v:l[I]};break;case 5:H={t:"d",v:O};break;case 6:H={t:"b",v:F>0};break;case 7:H={t:"n",v:F/86400};break;case 8:H={t:"e",v:0};break;case 9:if(C>-1)H={t:"s",v:a[C]};else if(I>-1)H={t:"s",v:l[I]};else{if(isNaN(F))throw new Error("Unsupported cell type ".concat(s.slice(0,4)));H={t:"n",v:F}}break;default:throw new Error("Unsupported cell type ".concat(s.slice(0,4)))}return H}(s,l,a,s[0]);case 5:return function Xk(s,l,a){var H,d=Ft(s),h=d.getUint32(8,!0),y=12,b=-1,C=-1,I=NaN,F=NaN,O=new Date(2001,0,1);switch(1&h&&(I=function RC(s,l){for(var a=(127&s[l+15])<<7|s[l+14]>>1,d=1&s[l+14],h=l+13;h>=l;--h)d=256*d+s[h];return(128&s[l+15]?-d:d)*Math.pow(10,a-6176)}(s,y),y+=16),2&h&&(F=d.getFloat64(y,!0),y+=8),4&h&&(O.setTime(O.getTime()+1e3*d.getFloat64(y,!0)),y+=8),8&h&&(C=d.getUint32(y,!0),y+=4),16&h&&(b=d.getUint32(y,!0),y+=4),s[1]){case 0:break;case 2:case 10:H={t:"n",v:I};break;case 3:H={t:"s",v:l[C]};break;case 5:H={t:"d",v:O};break;case 6:H={t:"b",v:F>0};break;case 7:H={t:"n",v:F/86400};break;case 8:H={t:"e",v:0};break;case 9:if(!(b>-1))throw new Error("Unsupported cell type ".concat(s[1]," : ").concat(31&h," : ").concat(s.slice(0,4)));H={t:"s",v:a[b]};break;default:throw new Error("Unsupported cell type ".concat(s[1]," : ").concat(31&h," : ").concat(s.slice(0,4)))}return H}(s,l,a);default:throw new Error("Unsupported payload version ".concat(s[0]))}}function hn(s){return pm(ur(s)[1][0].data)}function Yv(s,l){var a=ur(l.data),d=So(a[1][0].data),y=[];return(a[3]||[]).forEach(function(b){var C=ur(b.data),I=So(C[1][0].data)>>>0;switch(d){case 1:y[I]=Gv(C[3][0].data);break;case 8:var O=ur(s[hn(C[9][0].data)][0].data),H=s[hn(O[1][0].data)][0],W=So(H.meta[1][0].data);if(2001!=W)throw new Error("2000 unexpected reference to ".concat(W));var G=ur(H.data);y[I]=G[3].map(function(X){return Gv(X.data)}).join("")}}),y}function HC(s,l){var d={"!ref":"A1"},h=s[hn(ur(l.data)[2][0].data)],y=So(h[0].meta[1][0].data);if(6001!=y)throw new Error("6000 unexpected reference to ".concat(y));return function UC(s,l,a){var d,h=ur(l.data),y={s:{r:0,c:0},e:{r:0,c:0}};if(y.e.r=(So(h[6][0].data)>>>0)-1,y.e.r<0)throw new Error("Invalid row varint ".concat(h[6][0].data));if(y.e.c=(So(h[7][0].data)>>>0)-1,y.e.c<0)throw new Error("Invalid col varint ".concat(h[7][0].data));a["!ref"]=yi(y);var b=ur(h[4][0].data),C=Yv(s,s[hn(b[4][0].data)][0]),I=(null==(d=b[17])?void 0:d[0])?Yv(s,s[hn(b[17][0].data)][0]):[],F=ur(b[3][0].data),O=0;F[1].forEach(function(H){var W=ur(H.data),G=s[hn(W[2][0].data)][0],X=So(G.meta[1][0].data);if(6002!=X)throw new Error("6001 unexpected reference to ".concat(X));var V=function VC(s,l){var a,d=ur(l.data),h=(null==(a=null==d?void 0:d[7])?void 0:a[0])?So(d[7][0].data)>>>0>0?1:0:-1,y=sf(d[5],function(b){return function jC(s,l){var a,d,h,y,b,C,I,F,O,H,W,G,X,V,Ke,tt,Z=ur(s),he=So(Z[1][0].data)>>>0,ge=So(Z[2][0].data)>>>0,le=(null==(d=null==(a=Z[8])?void 0:a[0])?void 0:d.data)&&So(Z[8][0].data)>0||!1;if((null==(y=null==(h=Z[7])?void 0:h[0])?void 0:y.data)&&0!=l)Ke=null==(C=null==(b=Z[7])?void 0:b[0])?void 0:C.data,tt=null==(F=null==(I=Z[6])?void 0:I[0])?void 0:F.data;else{if(!(null==(H=null==(O=Z[4])?void 0:O[0])?void 0:H.data)||1==l)throw"NUMBERS Tile missing ".concat(l," cell storage");Ke=null==(G=null==(W=Z[4])?void 0:W[0])?void 0:G.data,tt=null==(V=null==(X=Z[3])?void 0:X[0])?void 0:V.data}for(var ze=le?4:1,be=Ft(Ke),Qe=[],qe=0;qe<Ke.length/2;++qe){var gt=be.getUint16(2*qe,!0);gt<65535&&Qe.push([qe,gt])}if(Qe.length!=ge)throw"Expected ".concat(ge," cells, found ").concat(Qe.length);var bt=[];for(qe=0;qe<Qe.length-1;++qe)bt[Qe[qe][0]]=tt.subarray(Qe[qe][1]*ze,Qe[qe+1][1]*ze);return Qe.length>=1&&(bt[Qe[Qe.length-1][0]]=tt.subarray(Qe[Qe.length-1][1]*ze)),{R:he,cells:bt}}(b,h)});return{nrows:So(d[4][0].data)>>>0,data:y.reduce(function(b,C){return b[C.R]||(b[C.R]=[]),C.cells.forEach(function(I,F){if(b[C.R][F])throw new Error("Duplicate cell r=".concat(C.R," c=").concat(F));b[C.R][F]=I}),b},[])}}(0,G);V.data.forEach(function(Z,he){Z.forEach(function(ge,le){var Ke=qn({r:O+he,c:le}),tt=U(ge,C,I);tt&&(a[Ke]=tt)})}),O+=V.nrows})}(s,h[0],d),d}function Xv(s){var l,a,d,h,y={},b=[];if(s.FullPaths.forEach(function(I){if(I.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),s.FileIndex.forEach(function(I){if(I.name.match(/\.iwa$/)){var F,O;try{F=el(I.content)}catch(H){return console.log("?? "+I.content.length+" "+(H.message||H))}try{O=kl(F)}catch(H){return console.log("## "+(H.message||H))}O.forEach(function(H){y[H.id]=H.messages,b.push(H.id)})}}),!b.length)throw new Error("File has no messages");var C=(null==(h=null==(d=null==(a=null==(l=null==y?void 0:y[1])?void 0:l[0])?void 0:a.meta)?void 0:d[1])?void 0:h[0].data)&&1==So(y[1][0].meta[1][0].data)&&y[1][0];if(C||b.forEach(function(I){y[I].forEach(function(F){if(1==So(F.meta[1][0].data)>>>0){if(C)throw new Error("Document has multiple roots");C=F}})}),!C)throw new Error("Cannot find Document root");return function $C(s,l){var a={SheetNames:[],Sheets:{}};if(sf(ur(l.data)[1],hn).forEach(function(y){s[y].forEach(function(b){if(2==So(b.meta[1][0].data)){var I=function zC(s,l){var a,d=ur(l.data),h={name:(null==(a=d[1])?void 0:a[0])?Gv(d[1][0].data):"",sheets:[]};return sf(d[2],hn).forEach(function(b){s[b].forEach(function(C){6e3==So(C.meta[1][0].data)&&h.sheets.push(HC(s,C))})}),h}(s,b);I.sheets.forEach(function(F,O){sy(a,F,0==O?I.name:I.name+"_"+O,!0)})}})}),0==a.SheetNames.length)throw new Error("Empty NUMBERS file");return a}(y,C)}function Qk(s,l,a){var d,h,y,b;if(!(null==(d=s[6])?void 0:d[0])||!(null==(h=s[7])?void 0:h[0]))throw"Mutation only works on post-BNC storages!";if((null==(b=null==(y=s[8])?void 0:y[0])?void 0:b.data)&&So(s[8][0].data)>0)throw"Math only works with normal offsets";for(var I=0,F=Ft(s[7][0].data),O=0,H=[],W=Ft(s[4][0].data),G=0,X=[],V=0;V<l.length;++V)if(null!=l[V]){var Z,he;switch(F.setUint16(2*V,O,!0),W.setUint16(2*V,G,!0),typeof l[V]){case"string":Z=h0({t:"s",v:l[V]},a),he=_({t:"s",v:l[V]},a);break;case"number":Z=h0({t:"n",v:l[V]},a),he=_({t:"n",v:l[V]},a);break;case"boolean":Z=h0({t:"b",v:l[V]},a),he=_({t:"b",v:l[V]},a);break;default:throw new Error("Unsupported value "+l[V])}H.push(Z),O+=Z.length,X.push(he),G+=he.length,++I}else F.setUint16(2*V,65535,!0),W.setUint16(2*V,65535);for(s[2][0].data=Cr(I);V<s[7][0].data.length/2;++V)F.setUint16(2*V,65535,!0),W.setUint16(2*V,65535,!0);return s[6][0].data=Cs(H),s[3][0].data=Cs(X),I}function WC(s){return function(a){for(var d=0;d!=s.length;++d){var h=s[d];void 0===a[h[0]]&&(a[h[0]]=h[1]),"n"===h[2]&&(a[h[0]]=Number(a[h[0]]))}}}function Qv(s){WC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(s)}function Jv(s){WC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(s)}function Zk(s){return z.WS.indexOf(s)>-1?"sheet":z.CS&&s==z.CS?"chart":z.DS&&s==z.DS?"dialog":z.MS&&s==z.MS?"macro":s&&s.length?s:"sheet"}function tD(s,l,a,d,h,y,b,C,I,F,O,H){try{y[d]=Gf(pl(s,a,!0),l);var G,W=jo(s,l);switch(C){case"sheet":G=uC(W,l,h,I,y[d],F,O,H);break;case"chart":if(!(G=function Mk(s,l,a,d,h,y,b,C){return".bin"===l.slice(-4)?function u0(s,l,a,d,h){if(!s)return s;d||(d={"!id":{}});var y={"!type":"chart","!drawel":null,"!rel":""},b=[],C=!1;return Ma(s,function(F,O,H){switch(H){case 550:y["!rel"]=F;break;case 651:h.Sheets[a]||(h.Sheets[a]={}),F.name&&(h.Sheets[a].CodeName=F.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:C=!0;break;case 36:C=!1;break;case 37:b.push(H);break;case 38:b.pop();break;default:if(O.T>0)b.push(H);else if(O.T<0)b.pop();else if(!C||l.WTF)throw new Error("Unexpected record 0x"+H.toString(16))}},l),d["!id"][y["!rel"]]&&(y["!drawel"]=d["!id"][y["!rel"]]),y}(s,d,a,h,y):function um(s,l,a,d,h){if(!s)return s;d||(d={"!id":{}});var b,y={"!type":"chart","!drawel":null,"!rel":""},C=s.match(gv);return C&&vv(C[0],0,h,a),(b=s.match(/drawing r:id="(.*?)"/))&&(y["!rel"]=b[1]),d["!id"][y["!rel"]]&&(y["!drawel"]=d["!id"][y["!rel"]]),y}(s,0,a,h,y)}(W,l,h,I,y[d],F))||!G["!drawel"])break;var X=ig(G["!drawel"].Target,l),V=xo(X),Z=function Kx(s,l){if(!s)return"??";var a=(s.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return l["!id"][a].Target}(pl(s,X,!0),Gf(pl(s,V,!0),X)),he=ig(Z,X),ge=xo(he);G=function Fc(s,l,a,d,h,y){var b=y||{"!type":"chart"};if(!s)return y;var C=0,I=0,F="A",O={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(s.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(H){var W=function Av(s){var d,l=[],a=s.match(/^<c:numCache>/);(s.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(y){var b=y.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);!b||(l[+b[1]]=a?+b[2]:b[2])});var h=lr((s.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(s.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(y){d=y.replace(/<.*?>/g,"")}),[l,h,d]}(H);O.s.r=O.s.c=0,O.e.c=C,F=to(C),W[0].forEach(function(G,X){b[F+jr(X)]={t:"n",v:G,z:W[1]},I=X}),O.e.r<I&&(O.e.r=I),++C}),C>0&&(b["!ref"]=yi(O)),b}(pl(s,he,!0),0,0,Gf(pl(s,ge,!0),he),0,G);break;case"macro":G=function Fk(s,l,a,d,h,y,b,C){return l.slice(-4),{"!type":"macro"}}(0,l);break;case"dialog":G=function QP(s,l,a,d,h,y,b,C){return l.slice(-4),{"!type":"dialog"}}(0,l);break;default:throw new Error("Unrecognized sheet type "+C)}b[d]=G;var le=[];y&&y[d]&&Gr(y[d]).forEach(function(Ke){var tt="";if(y[d][Ke].Type==z.CMNT){tt=ig(y[d][Ke].Target,l);var ze=function Ok(s,l,a){return".bin"===l.slice(-4)?function Zx(s,l){var a=[],d=[],h={},y=!1;return Ma(s,function(C,I,F){switch(F){case 632:d.push(C);break;case 635:h=C;break;case 637:h.t=C.t,h.h=C.h,h.r=C.r;break;case 636:if(h.author=d[h.iauthor],delete h.iauthor,l.sheetRows&&h.rfx&&l.sheetRows<=h.rfx.r)break;h.t||(h.t=""),delete h.rfx,a.push(h);break;case 3072:case 37:case 38:break;case 35:y=!0;break;case 36:y=!1;break;default:if(!I.T&&(!y||l.WTF))throw new Error("Unexpected record 0x"+F.toString(16))}}),a}(s,a):function a4(s,l){if(s.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],d=[],h=s.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);h&&h[1]&&h[1].split(/<\/\w*:?author>/).forEach(function(b){if(""!==b&&""!==b.trim()){var C=b.match(/<(?:\w+:)?author[^>]*>(.*)/);C&&a.push(C[1])}});var y=s.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return y&&y[1]&&y[1].split(/<\/\w*:?comment>/).forEach(function(b){if(""!==b&&""!==b.trim()){var C=b.match(/<(?:\w+:)?comment[^>]*>/);if(C){var I=Qn(C[0]),F={author:I.authorId&&a[I.authorId]||"sheetjsghost",ref:I.ref,guid:I.guid},O=Xr(I.ref);if(!(l.sheetRows&&l.sheetRows<=O.r)){var H=b.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),W=!!H&&!!H[1]&&P1(H[1])||{r:"",t:"",h:""};F.r=W.r,"<t></t>"==W.r&&(W.t=W.h=""),F.t=(W.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),l.cellHTML&&(F.h=W.h),d.push(F)}}}}),d}(s,a)}(jo(s,tt,!0),tt,I);if(!ze||!ze.length)return;K1(G,ze,!1)}y[d][Ke].Type==z.TCMNT&&(tt=ig(y[d][Ke].Target,l),le=le.concat(function l4(s,l){var a=[],d=!1,h={},y=0;return s.replace(va,function(C,I){var F=Qn(C);switch(eu(F[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":h={author:F.personId,guid:F.id,ref:F.ref,T:1};break;case"</threadedComment>":null!=h.t&&a.push(h);break;case"<text>":case"<text":y=I+C.length;break;case"</text>":h.t=s.slice(y,I).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":d=!0;break;case"</mentions>":case"</ext>":d=!1;break;default:if(!d&&l.WTF)throw new Error("unrecognized "+F[0]+" in threaded comments")}return C}),a}(jo(s,tt,!0),I)))}),le&&le.length&&K1(G,le,!0,I.people||[])}catch(Ke){if(I.WTF)throw Ke}}function Dl(s){return"/"==s.charAt(0)?s.slice(1):s}function qC(s,l){if(Nd(),Qv(l=l||{}),jn(s,"META-INF/manifest.xml")||jn(s,"objectdata.xml"))return function LC(s,l){l=l||{},jn(s,"META-INF/manifest.xml")&&function v1(s,l){for(var d,h,a=p2(s);d=cr.exec(a);)switch(d[3]){case"manifest":break;case"file-entry":if("/"==(h=Qn(d[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==h.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(l&&l.WTF)throw d}}(jo(s,"META-INF/manifest.xml"),l);var a=pl(s,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var d=Wv(_n(a),l);return jn(s,"meta.xml")&&(d.Props=qd(jo(s,"meta.xml"))),d}(s,l);if(jn(s,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(void 0!==Xv){if(s.FileIndex)return Xv(s);var a=In.utils.cfb_new();return Ch(s).forEach(function(vn){Hn(a,vn,O5(s,vn))}),Xv(a)}throw new Error("Unsupported NUMBERS file")}if(!jn(s,"[Content_Types].xml"))throw jn(s,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):jn(s,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var b,C,d=Ch(s),h=function Ut(s){var l={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!s||!s.match)return l;var a={};if((s.match(va)||[]).forEach(function(d){var h=Qn(d);switch(h[0].replace(L5,"<")){case"<?xml":break;case"<Types":l.xmlns=h["xmlns"+(h[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[h.Extension]=h.ContentType;break;case"<Override":void 0!==l[_g[h.ContentType]]&&l[_g[h.ContentType]].push(h.PartName)}}),l.xmlns!==is_CT)throw new Error("Unknown Namespace: "+l.xmlns);return l.calcchain=l.calcchains.length>0?l.calcchains[0]:"",l.sst=l.strs.length>0?l.strs[0]:"",l.style=l.styles.length>0?l.styles[0]:"",l.defaults=a,delete l.calcchains,l}(pl(s,"[Content_Types].xml")),y=!1;if(0===h.workbooks.length&&jo(s,C="xl/workbook.xml",!0)&&h.workbooks.push(C),0===h.workbooks.length){if(!jo(s,C="xl/workbook.bin",!0))throw new Error("Could not find workbook");h.workbooks.push(C),y=!0}"bin"==h.workbooks[0].slice(-3)&&(y=!0);var I={},F={};if(!l.bookSheets&&!l.bookProps){if(lp=[],h.sst)try{lp=function Ov(s,l,a){return".bin"===l.slice(-4)?function dP(s,l){var a=[],d=!1;return Ma(s,function(y,b,C){switch(C){case 159:a.Count=y[0],a.Unique=y[1];break;case 19:a.push(y);break;case 160:return!0;case 35:d=!0;break;case 36:d=!1;break;default:if(!d||l.WTF)throw new Error("Unexpected record 0x"+C.toString(16))}}),a}(s,a):function Wh(s,l){var a=[],d="";if(!s)return a;var h=s.match(TE);if(h){d=h[2].replace(SE,"").split(id);for(var y=0;y!=d.length;++y){var b=P1(d[y].trim(),l);null!=b&&(a[a.length]=b)}h=Qn(h[1]),a.Count=h.count,a.Unique=h.uniqueCount}return a}(s,a)}(jo(s,Dl(h.sst)),h.sst,l)}catch(vn){if(l.WTF)throw vn}l.cellStyles&&h.themes.length&&(I=function Pv(s,l,a){return U1(s,a)}(pl(s,h.themes[0].replace(/^\//,""),!0)||"",0,l)),h.style&&(F=function Pk(s,l,a,d){return".bin"===l.slice(-4)?function $E(s,l,a){var d={NumberFmt:[]};for(var h in Wn)d.NumberFmt[h]=Wn[h];d.CellXf=[],d.Fonts=[];var y=[],b=!1;return Ma(s,function(I,F,O){switch(O){case 44:d.NumberFmt[I[0]]=I[1],gc(I[1],I[0]);break;case 43:d.Fonts.push(I),null!=I.color.theme&&l&&l.themeElements&&l.themeElements.clrScheme&&(I.color.rgb=$g(l.themeElements.clrScheme[I.color.theme].rgb,I.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==y[y.length-1]&&d.CellXf.push(I);break;case 35:b=!0;break;case 36:b=!1;break;case 37:y.push(O),b=!0;break;case 38:y.pop(),b=!1;break;default:if(F.T>0)y.push(O);else if(F.T<0)y.pop();else if(!b||a.WTF&&37!=y[y.length-1])throw new Error("Unexpected record 0x"+O.toString(16))}}),d}(s,a,d):Mx(s,a,d)}(jo(s,Dl(h.style)),h.style,I,l))}h.links.map(function(vn){try{return Gf(pl(s,xo(Dl(vn))),vn),function ZP(s,l,a,d){return".bin"===a.slice(-4)?function Gx(s,l,a,d){if(!s)return s;var h=d||{},y=!1;Ma(s,function(I,F,O){switch(O){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:y=!0;break;case 36:y=!1;break;default:if(!F.T&&(!y||h.WTF))throw new Error("Unexpected record 0x"+O.toString(16))}},h)}(s,0,0,d):void 0}(jo(s,Dl(vn)),0,vn,l)}catch(Fn){}});var O=function Ak(s,l,a){return".bin"===l.slice(-4)?function kk(s,l){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},d=[],h=!1;l||(l={}),l.biff=12;var y=[],b=[[]];return b.SheetNames=[],b.XTI=[],bp[16]={n:"BrtFRTArchID$",f:Ek},Ma(s,function(I,F,O){switch(O){case 156:b.SheetNames.push(I.name),a.Sheets.push(I);break;case 153:a.WBProps=I;break;case 39:null!=I.Sheet&&(l.SID=I.Sheet),I.Ref=xs(I.Ptg,0,null,b,l),delete l.SID,delete I.Ptg,y.push(I);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:b[0].length?b.push([O,I]):b[0]=[O,I],b[b.length-1].XTI=[];break;case 362:0===b.length&&(b[0]=[],b[0].XTI=[]),b[b.length-1].XTI=b[b.length-1].XTI.concat(I),b.XTI=b.XTI.concat(I);break;case 35:case 37:d.push(O),h=!0;break;case 36:case 38:d.pop(),h=!1;break;default:if(!F.T&&(!h||l.WTF&&37!=d[d.length-1]&&35!=d[d.length-1]))throw new Error("Unexpected record 0x"+O.toString(16))}},l),nf(a),a.Names=y,a.supbooks=b,a}(s,a):function iC(s,l){if(!s)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},d=!1,h="xmlns",y={},b=0;if(s.replace(va,function(I,F){var O=Qn(I);switch(eu(O[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":I.match(nC)&&(h="xmlns"+I.match(/<(\w+):/)[1]),a.xmlns=O[h];break;case"<fileVersion":delete O[0],a.AppVersion=O;break;case"<workbookPr":case"<workbookPr/>":Ai.forEach(function(H){if(null!=O[H[0]])switch(H[2]){case"bool":a.WBProps[H[0]]=Kr(O[H[0]]);break;case"int":a.WBProps[H[0]]=parseInt(O[H[0]],10);break;default:a.WBProps[H[0]]=O[H[0]]}}),O.codeName&&(a.WBProps.CodeName=_n(O.codeName));break;case"<workbookView":case"<workbookView/>":delete O[0],a.WBView.push(O);break;case"<sheet":switch(O.state){case"hidden":O.Hidden=1;break;case"veryHidden":O.Hidden=2;break;default:O.Hidden=0}delete O.state,O.name=lr(_n(O.name)),delete O[0],a.Sheets.push(O);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":d=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":d=!1;break;case"<definedName":(y={}).Name=_n(O.name),O.comment&&(y.Comment=O.comment),O.localSheetId&&(y.Sheet=+O.localSheetId),Kr(O.hidden||"0")&&(y.Hidden=!0),b=F+I.length;break;case"</definedName>":y.Ref=lr(_n(s.slice(b,F))),a.Names.push(y);break;case"<calcPr":case"<calcPr/>":delete O[0],a.CalcPr=O;break;default:if(!d&&l.WTF)throw new Error("unrecognized "+O[0]+" in workbook")}return I}),-1===Bd.indexOf(a.xmlns))throw new Error("Unknown Namespace: "+a.xmlns);return nf(a),a}(s,a)}(jo(s,Dl(h.workbooks[0])),h.workbooks[0],l),H={},W="";h.coreprops.length&&((W=jo(s,Dl(h.coreprops[0]),!0))&&(H=qd(W)),0!==h.extprops.length&&(W=jo(s,Dl(h.extprops[0]),!0))&&function y1(s,l,a){var d={};l||(l={}),s=_n(s),Ju.forEach(function(h){var y=(s.match(Sh(h[0]))||[])[1];switch(h[2]){case"string":y&&(l[h[1]]=lr(y));break;case"bool":l[h[1]]="true"===y;break;case"raw":var b=s.match(new RegExp("<"+h[0]+"[^>]*>([\\s\\S]*?)</"+h[0]+">"));b&&b.length>0&&(d[h[1]]=b[1])}}),d.HeadingPairs&&d.TitlesOfParts&&S2(d.HeadingPairs,d.TitlesOfParts,l,a)}(W,H,l));var G={};(!l.bookSheets||l.bookProps)&&0!==h.custprops.length&&(W=pl(s,Dl(h.custprops[0]),!0))&&(G=function b1(s,l){var a={},d="",h=s.match(E2);if(h)for(var y=0;y!=h.length;++y){var b=h[y],C=Qn(b);switch(C[0]){case"<?xml":case"<Properties":break;case"<property":d=lr(C.name);break;case"</property>":d=null;break;default:if(0===b.indexOf("<vt:")){var I=b.split(">"),F=I[0].slice(4),O=I[1];switch(F){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":a[d]=lr(O);break;case"bool":a[d]=Kr(O);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[d]=parseInt(O,10);break;case"r4":case"r8":case"decimal":a[d]=parseFloat(O);break;case"filetime":case"date":a[d]=Kn(O);break;default:if("/"==F.slice(-1))break;l.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",b,F,I)}}else if("</"!==b.slice(0,2)&&l.WTF)throw new Error(b)}}return a}(W,l));var X={};if((l.bookSheets||l.bookProps)&&(O.Sheets?b=O.Sheets.map(function(Zt){return Zt.name}):H.Worksheets&&H.SheetNames.length>0&&(b=H.SheetNames),l.bookProps&&(X.Props=H,X.Custprops=G),l.bookSheets&&void 0!==b&&(X.SheetNames=b),l.bookSheets?X.SheetNames:l.bookProps))return X;b={};var V={};l.bookDeps&&h.calcchain&&(V=function JP(s,l,a){return".bin"===l.slice(-4)?function s4(s,l,a){var d=[];return Ma(s,function(b,C,I){if(63===I)d.push(b);else if(!C.T)throw new Error("Unexpected record 0x"+I.toString(16))}),d}(s):function qx(s){var l=[];if(!s)return l;var a=1;return(s.match(va)||[]).forEach(function(d){var h=Qn(d);switch(h[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete h[0],h.i?a=h.i:h.i=a,l.push(h)}}),l}(s)}(jo(s,Dl(h.calcchain)),h.calcchain));var ge,le,Z=0,he={},Ke=O.Sheets;H.Worksheets=Ke.length,H.SheetNames=[];for(var tt=0;tt!=Ke.length;++tt)H.SheetNames[tt]=Ke[tt].name;var ze=y?"bin":"xml",be=h.workbooks[0].lastIndexOf("/"),Qe=(h.workbooks[0].slice(0,be+1)+"_rels/"+h.workbooks[0].slice(be+1)+".rels").replace(/^\//,"");jn(s,Qe)||(Qe="xl/_rels/workbook."+ze+".rels");var qe=Gf(pl(s,Qe,!0),Qe.replace(/_rels.*/,"s5s"));(h.metadata||[]).length>=1&&(l.xlmeta=function e6(s,l,a){return".bin"===l.slice(-4)?function r4(s,l,a){var d={Types:[],Cell:[],Value:[]},h=a||{},y=[],b=!1,C=2;return Ma(s,function(I,F,O){switch(O){case 335:d.Types.push({name:I.name});break;case 51:I.forEach(function(H){1==C?d.Cell.push({type:d.Types[H[0]-1].name,index:H[1]}):0==C&&d.Value.push({type:d.Types[H[0]-1].name,index:H[1]})});break;case 337:C=I?1:0;break;case 338:C=2;break;case 35:y.push(O),b=!0;break;case 36:y.pop(),b=!1;break;default:if(!F.T&&(!b||h.WTF&&35!=y[y.length-1]))throw new Error("Unexpected record 0x"+O.toString(16))}}),d}(s,0,a):function Wx(s,l,a){var d={Types:[],Cell:[],Value:[]};if(!s)return d;var b,h=!1,y=2;return s.replace(va,function(C){var I=Qn(C);switch(eu(I[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":d.Types.push({name:I.name});break;case"<futureMetadata":for(var F=0;F<d.Types.length;++F)d.Types[F].name==I.name&&(b=d.Types[F]);break;case"<rc":1==y?d.Cell.push({type:d.Types[I.t-1].name,index:+I.v}):0==y&&d.Value.push({type:d.Types[I.t-1].name,index:+I.v});break;case"<cellMetadata":y=1;break;case"</cellMetadata>":case"</valueMetadata>":y=2;break;case"<valueMetadata":y=0;break;case"<ext":h=!0;break;case"</ext>":h=!1;break;case"<rvb":if(!b)break;b.offsets||(b.offsets=[]),b.offsets.push(+I.i);break;default:if(!h&&a.WTF)throw new Error("unrecognized "+I[0]+" in metadata")}return C}),d}(s,0,a)}(jo(s,Dl(h.metadata[0])),h.metadata[0],l)),(h.people||[]).length>=1&&(l.people=function Xx(s,l){var a=[],d=!1;return s.replace(va,function(y){var b=Qn(y);switch(eu(b[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":a.push({name:b.displayname,id:b.id});break;case"<ext":d=!0;break;case"</ext>":d=!1;break;default:if(!d&&l.WTF)throw new Error("unrecognized "+b[0]+" in threaded comments")}return y}),a}(jo(s,Dl(h.people[0])),l)),qe&&(qe=function eD(s,l){if(!s)return 0;try{s=l.map(function(d){return d.id||(d.id=d.strRelID),[d.name,s["!id"][d.id].Target,Zk(s["!id"][d.id].Type)]})}catch(a){return null}return s&&0!==s.length?s:null}(qe,O.Sheets));var gt=jo(s,"xl/worksheets/sheet.xml",!0)?1:0;e:for(Z=0;Z!=H.Worksheets;++Z){var bt="sheet";if(qe&&qe[Z]?(ge="xl/"+qe[Z][1].replace(/[\/]?xl\//,""),jn(s,ge)||(ge=qe[Z][1]),jn(s,ge)||(ge=Qe.replace(/_rels\/.*$/,"")+qe[Z][1]),bt=qe[Z][2]):ge=(ge="xl/worksheets/sheet"+(Z+1-gt)+"."+ze).replace(/sheet0\./,"sheet."),le=ge.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),l&&null!=l.sheets)switch(typeof l.sheets){case"number":if(Z!=l.sheets)continue e;break;case"string":if(H.SheetNames[Z].toLowerCase()!=l.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(l.sheets)){for(var et=!1,Xt=0;Xt!=l.sheets.length;++Xt)"number"==typeof l.sheets[Xt]&&l.sheets[Xt]==Z&&(et=1),"string"==typeof l.sheets[Xt]&&l.sheets[Xt].toLowerCase()==H.SheetNames[Z].toLowerCase()&&(et=1);if(!et)continue e}}tD(s,ge,le,H.SheetNames[Z],Z,he,b,bt,l,O,I,F)}return X={Directory:h,Workbook:O,Props:H,Custprops:G,Deps:V,Sheets:b,SheetNames:H.SheetNames,Strings:lp,Styles:F,Themes:I,SSF:Bn(Wn)},l&&l.bookFiles&&(s.files?(X.keys=d,X.files=s.files):(X.keys=[],X.files={},s.FullPaths.forEach(function(vn,Zt){vn=vn.replace(/^Root Entry[\/]/,""),X.keys.push(vn),X.files[vn]=s.FileIndex[Zt]}))),l&&l.bookVBA&&(h.vba.length>0?X.vbaraw=jo(s,Dl(h.vba[0]),!0):h.defaults&&"application/vnd.ms-office.vbaProject"===h.defaults.bin&&(X.vbaraw=jo(s,"xl/vbaProject.bin",!0))),X}function nD(s,l){var a=l||{},d="Workbook",h=In.find(s,d);try{if(!(h=In.find(s,d="/!DataSpaces/Version"))||!h.content)throw new Error("ECMA-376 Encrypted file missing "+d);if(function DE(s){var l={};l.id=s.read_shift(0,"lpp4"),l.R=uu(s,4),l.U=uu(s,4),l.W=uu(s,4)}(h.content),!(h=In.find(s,d="/!DataSpaces/DataSpaceMap"))||!h.content)throw new Error("ECMA-376 Encrypted file missing "+d);var y=function hP(s){var l=[];s.l+=4;for(var a=s.read_shift(4);a-- >0;)l.push(IE(s));return l}(h.content);if(1!==y.length||1!==y[0].comps.length||0!==y[0].comps[0].t||"StrongEncryptionDataSpace"!==y[0].name||"EncryptedPackage"!==y[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+d);if(!(h=In.find(s,d="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace"))||!h.content)throw new Error("ECMA-376 Encrypted file missing "+d);var b=function AE(s){var l=[];s.l+=4;for(var a=s.read_shift(4);a-- >0;)l.push(s.read_shift(0,"lpp4"));return l}(h.content);if(1!=b.length||"StrongEncryptionTransform"!=b[0])throw new Error("ECMA-376 Encrypted file bad "+d);if(!(h=In.find(s,d="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary"))||!h.content)throw new Error("ECMA-376 Encrypted file missing "+d);!function xx(s){var l=function Ug(s){var l={};return s.read_shift(4),s.l+=4,l.id=s.read_shift(0,"lpp4"),l.name=s.read_shift(0,"lpp4"),l.R=uu(s,4),l.U=uu(s,4),l.W=uu(s,4),l}(s);if(l.ename=s.read_shift(0,"8lpp4"),l.blksz=s.read_shift(4),l.cmode=s.read_shift(4),4!=s.read_shift(4))throw new Error("Bad !Primary record");return l}(h.content)}catch(I){}if(!(h=In.find(s,d="/EncryptionInfo"))||!h.content)throw new Error("ECMA-376 Encrypted file missing "+d);var C=function wx(s){var l=uu(s);switch(l.Minor){case 2:return[l.Minor,Cx(s)];case 3:return[l.Minor,Tx()];case 4:return[l.Minor,mP(s)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+l.Minor)}(h.content);if(!(h=In.find(s,d="/EncryptedPackage"))||!h.content)throw new Error("ECMA-376 Encrypted file missing "+d);if(4==C[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(C[1],h.content,a.password||"",a);if(2==C[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(C[1],h.content,a.password||"",a);throw new Error("File is password-protected")}function iD(s,l){return"ods"==l.bookType?po(s,l):"numbers"==l.bookType?function Jk(s,l){if(!l||!l.numbers)throw new Error("Must pass a `numbers` option -- check the README");var a=s.Sheets[s.SheetNames[0]];s.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var d=no(a["!ref"]);d.s.r=d.s.c=0;var h=!1;d.e.c>9&&(h=!0,d.e.c=9),d.e.r>49&&(h=!0,d.e.r=49),h&&console.error("The Numbers writer is currently limited to ".concat(yi(d)));var y=g0(a,{range:d,header:1}),b=["~Sh33tJ5~"];y.forEach(function(Fe){return Fe.forEach(function(Pe){"string"==typeof Pe&&b.push(Pe)})});var C={},I=[],F=In.read(l.numbers,{type:"base64"});F.FileIndex.map(function(Fe,Pe){return[Fe,F.FullPaths[Pe]]}).forEach(function(Fe){var Pe=Fe[0],It=Fe[1];2==Pe.type&&Pe.name.match(/\.iwa/)&&kl(el(Pe.content)).forEach(function(Rt){I.push(Rt.id),C[Rt.id]={deps:[],location:It,type:So(Rt.messages[0].meta[1][0].data)}})}),I.sort(function(Fe,Pe){return Fe-Pe});var O=I.filter(function(Fe){return Fe>1}).map(function(Fe){return[Fe,Cr(Fe)]});F.FileIndex.map(function(Fe,Pe){return[Fe,F.FullPaths[Pe]]}).forEach(function(Fe){var Pe=Fe[0];Pe.name.match(/\.iwa/)&&kl(el(Pe.content)).forEach(function(Yt){Yt.messages.forEach(function(Qt){O.forEach(function(Rt){Yt.messages.some(function(gi){return 11006!=So(gi.meta[1][0].data)&&function Pc(s,l){e:for(var a=0;a<=s.length-l.length;++a){for(var d=0;d<l.length;++d)if(s[a+d]!=l[d])continue e;return!0}return!1}(gi.data,Rt[1])})&&C[Rt[0]].deps.push(Yt.id)})})})});for(var X,W=In.find(F,C[1].location),G=kl(el(W.content)),V=0;V<G.length;++V){var Z=G[V];1==Z.id&&(X=Z)}var he=hn(ur(X.messages[0].data)[1][0].data);for(G=kl(el((W=In.find(F,C[he].location)).content)),V=0;V<G.length;++V)(Z=G[V]).id==he&&(X=Z);for(he=hn(ur(X.messages[0].data)[2][0].data),G=kl(el((W=In.find(F,C[he].location)).content)),V=0;V<G.length;++V)(Z=G[V]).id==he&&(X=Z);for(he=hn(ur(X.messages[0].data)[2][0].data),G=kl(el((W=In.find(F,C[he].location)).content)),V=0;V<G.length;++V)(Z=G[V]).id==he&&(X=Z);var ge=ur(X.messages[0].data);ge[6][0].data=Cr(d.e.r+1),ge[7][0].data=Cr(d.e.c+1);for(var le=hn(ge[46][0].data),Ke=In.find(F,C[le].location),tt=kl(el(Ke.content)),ze=0;ze<tt.length&&tt[ze].id!=le;++ze);if(tt[ze].id!=le)throw"Bad ColumnRowUIDMapArchive";var be=ur(tt[ze].messages[0].data);be[1]=[],be[2]=[],be[3]=[];for(var Qe=0;Qe<=d.e.c;++Qe){var qe=[];qe[1]=qe[2]=[{type:0,data:Cr(Qe+420690)}],be[1].push({type:2,data:$o(qe)}),be[2].push({type:0,data:Cr(Qe)}),be[3].push({type:0,data:Cr(Qe)})}be[4]=[],be[5]=[],be[6]=[];for(var gt=0;gt<=d.e.r;++gt)(qe=[])[1]=qe[2]=[{type:0,data:Cr(gt+726270)}],be[4].push({type:2,data:$o(qe)}),be[5].push({type:0,data:Cr(gt)}),be[6].push({type:0,data:Cr(gt)});tt[ze].messages[0].data=$o(be),Ke.content=lf(af(tt)),Ke.size=Ke.content.length,delete ge[46];var bt=ur(ge[4][0].data);bt[7][0].data=Cr(d.e.r+1);var Xt=hn(ur(bt[1][0].data)[2][0].data);if((tt=kl(el((Ke=In.find(F,C[Xt].location)).content)))[0].id!=Xt)throw"Bad HeaderStorageBucket";var vn=ur(tt[0].messages[0].data);for(gt=0;gt<y.length;++gt){var Zt=ur(vn[2][0].data);Zt[1][0].data=Cr(gt),Zt[4][0].data=Cr(y[gt].length),vn[2][gt]={type:vn[2][0].type,data:$o(Zt)}}tt[0].messages[0].data=$o(vn),Ke.content=lf(af(tt)),Ke.size=Ke.content.length;var Fn=hn(bt[2][0].data);if((tt=kl(el((Ke=In.find(F,C[Fn].location)).content)))[0].id!=Fn)throw"Bad HeaderStorageBucket";for(vn=ur(tt[0].messages[0].data),Qe=0;Qe<=d.e.c;++Qe)(Zt=ur(vn[2][0].data))[1][0].data=Cr(Qe),Zt[4][0].data=Cr(d.e.r+1),vn[2][Qe]={type:vn[2][0].type,data:$o(Zt)};tt[0].messages[0].data=$o(vn),Ke.content=lf(af(tt)),Ke.size=Ke.content.length;var Dn=hn(bt[4][0].data);!function(){for(var It,Fe=In.find(F,C[Dn].location),Pe=kl(el(Fe.content)),sn=0;sn<Pe.length;++sn){var Yt=Pe[sn];Yt.id==Dn&&(It=Yt)}var Qt=ur(It.messages[0].data);Qt[3]=[];var Rt=[];b.forEach(function(Tr,Hi){Rt[1]=[{type:0,data:Cr(Hi)}],Rt[2]=[{type:0,data:Cr(1)}],Rt[3]=[{type:2,data:Ji(Tr)}],Qt[3].push({type:2,data:$o(Rt)})}),It.messages[0].data=$o(Qt);var Se=lf(af(Pe));Fe.content=Se,Fe.size=Fe.content.length}();var Li=ur(bt[3][0].data),ln=Li[1][0];delete Li[2];var Mn=ur(ln.data),Pt=hn(Mn[2][0].data);!function(){for(var It,Fe=In.find(F,C[Pt].location),Pe=kl(el(Fe.content)),sn=0;sn<Pe.length;++sn){var Yt=Pe[sn];Yt.id==Pt&&(It=Yt)}var Qt=ur(It.messages[0].data);delete Qt[6],delete Li[7];var Rt=new Uint8Array(Qt[5][0].data);Qt[5]=[];for(var gi=0,Se=0;Se<=d.e.r;++Se){var Tr=ur(Rt);gi+=Qk(Tr,y[Se],b),Tr[1][0].data=Cr(Se),Qt[5].push({data:$o(Tr),type:2})}Qt[1]=[{type:0,data:Cr(d.e.c+1)}],Qt[2]=[{type:0,data:Cr(d.e.r+1)}],Qt[3]=[{type:0,data:Cr(gi)}],Qt[4]=[{type:0,data:Cr(d.e.r+1)}],It.messages[0].data=$o(Qt);var Dr=lf(af(Pe));Fe.content=Dr,Fe.size=Fe.content.length}(),ln.data=$o(Mn),bt[3][0].data=$o(Li),ge[4][0].data=$o(bt),X.messages[0].data=$o(ge);var dt=lf(af(G));return W.content=dt,W.size=W.content.length,F}(s,l):"xlsb"==l.bookType?function rD(s,l){Cl=1024,s&&!s.SSF&&(s.SSF=Bn(Wn)),s&&s.SSF&&(Nd(),yh(s.SSF),l.revssf=wh(s.SSF),l.revssf[s.SSF[65535]]=0,l.ssf=s.SSF),l.rels={},l.wbrels={},l.Strings=[],l.Strings.Count=0,l.Strings.Unique=0,sm?l.revStrings=new Map:(l.revStrings={},l.revStrings.foo=[],delete l.revStrings.foo);var a="xlsb"==l.bookType?"bin":"xml",d=tw.indexOf(l.bookType)>-1,h={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Jv(l=l||{});var y=a2(),b="",C=0;if(l.cellXfs=[],pu(l.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={}),Hn(y,b="docProps/core.xml",C2(s.Props,l)),h.coreprops.push(b),Ni(l.rels,2,b,z.CORE_PROPS),b="docProps/app.xml",!s.Props||!s.Props.SheetNames)if(s.Workbook&&s.Workbook.Sheets){for(var I=[],F=0;F<s.SheetNames.length;++F)2!=(s.Workbook.Sheets[F]||{}).Hidden&&I.push(s.SheetNames[F]);s.Props.SheetNames=I}else s.Props.SheetNames=s.SheetNames;for(s.Props.Worksheets=s.Props.SheetNames.length,Hn(y,b,xg(s.Props)),h.extprops.push(b),Ni(l.rels,3,b,z.EXT_PROPS),s.Custprops!==s.Props&&Gr(s.Custprops||{}).length>0&&(Hn(y,b="docProps/custom.xml",k2(s.Custprops)),h.custprops.push(b),Ni(l.rels,4,b,z.CUST_PROPS)),C=1;C<=s.SheetNames.length;++C){var O={"!id":{}},H=s.Sheets[s.SheetNames[C-1]];if(Hn(y,b="xl/worksheets/sheet"+C+"."+a,dC(C-1,b,l,s,O)),h.sheets.push(b),Ni(l.wbrels,-1,"worksheets/sheet"+C+"."+a,z.WS[0]),H){var G=H["!comments"],X=!1,V="";G&&G.length>0&&(Hn(y,V="xl/comments"+C+"."+a,Rk(G,V,l)),h.comments.push(V),Ni(O,-1,"../comments"+C+"."+a,z.CMNT),X=!0),H["!legacy"]&&X&&Hn(y,"xl/drawings/vmlDrawing"+C+".vml",G1(C,H["!comments"])),delete H["!comments"],delete H["!legacy"]}O["!id"].rId1&&Hn(y,xo(b),Ec(O))}return null!=l.Strings&&l.Strings.length>0&&(Hn(y,b="xl/sharedStrings."+a,function vp(s,l,a){return(".bin"===l.slice(-4)?yx:kE)(s,a)}(l.Strings,b,l)),h.strs.push(b),Ni(l.wbrels,-1,"sharedStrings."+a,z.SST)),Hn(y,b="xl/workbook."+a,function Nk(s,l,a){return(".bin"===l.slice(-4)?cC:Fv)(s,a)}(s,b,l)),h.workbooks.push(b),Ni(l.rels,1,b,z.WB),Hn(y,b="xl/theme/theme1.xml",Qd(s.Themes,l)),h.themes.push(b),Ni(l.wbrels,-1,"theme/theme1.xml",z.THEME),Hn(y,b="xl/styles."+a,function Lk(s,l,a){return(".bin"===l.slice(-4)?rp:Fx)(s,a)}(s,b,l)),h.styles.push(b),Ni(l.wbrels,-1,"styles."+a,z.STY),s.vbaraw&&d&&(Hn(y,b="xl/vbaProject.bin",s.vbaraw),h.vba.push(b),Ni(l.wbrels,-1,"vbaProject.bin",z.VBA)),Hn(y,b="xl/metadata."+a,function fC(s){return(".bin"===s.slice(-4)?o4:Gg)()}(b)),h.metadata.push(b),Ni(l.wbrels,-1,"metadata."+a,z.XLMETA),Hn(y,"[Content_Types].xml",Qi(h,l)),Hn(y,"_rels/.rels",Ec(l.rels)),Hn(y,"xl/_rels/workbook."+a+".rels",Ec(l.wbrels)),delete l.revssf,delete l.ssf,y}(s,l):GC(s,l)}function GC(s,l){Cl=1024,s&&!s.SSF&&(s.SSF=Bn(Wn)),s&&s.SSF&&(Nd(),yh(s.SSF),l.revssf=wh(s.SSF),l.revssf[s.SSF[65535]]=0,l.ssf=s.SSF),l.rels={},l.wbrels={},l.Strings=[],l.Strings.Count=0,l.Strings.Unique=0,sm?l.revStrings=new Map:(l.revStrings={},l.revStrings.foo=[],delete l.revStrings.foo);var a="xml",d=tw.indexOf(l.bookType)>-1,h={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Jv(l=l||{});var y=a2(),b="",C=0;if(l.cellXfs=[],pu(l.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={}),Hn(y,b="docProps/core.xml",C2(s.Props,l)),h.coreprops.push(b),Ni(l.rels,2,b,z.CORE_PROPS),b="docProps/app.xml",!s.Props||!s.Props.SheetNames)if(s.Workbook&&s.Workbook.Sheets){for(var I=[],F=0;F<s.SheetNames.length;++F)2!=(s.Workbook.Sheets[F]||{}).Hidden&&I.push(s.SheetNames[F]);s.Props.SheetNames=I}else s.Props.SheetNames=s.SheetNames;s.Props.Worksheets=s.Props.SheetNames.length,Hn(y,b,xg(s.Props)),h.extprops.push(b),Ni(l.rels,3,b,z.EXT_PROPS),s.Custprops!==s.Props&&Gr(s.Custprops||{}).length>0&&(Hn(y,b="docProps/custom.xml",k2(s.Custprops)),h.custprops.push(b),Ni(l.rels,4,b,z.CUST_PROPS));var O=["SheetJ5"];for(l.tcid=0,C=1;C<=s.SheetNames.length;++C){var H={"!id":{}},W=s.Sheets[s.SheetNames[C-1]];if(Hn(y,b="xl/worksheets/sheet"+C+"."+a,lm(C-1,l,s,H)),h.sheets.push(b),Ni(l.wbrels,-1,"worksheets/sheet"+C+"."+a,z.WS[0]),W){var X=W["!comments"],V=!1,Z="";if(X&&X.length>0){var he=!1;X.forEach(function(ge){ge[1].forEach(function(le){1==le.T&&(he=!0)})}),he&&(Hn(y,Z="xl/threadedComments/threadedComment"+C+"."+a,Yx(X,O,l)),h.threadedcomments.push(Z),Ni(H,-1,"../threadedComments/threadedComment"+C+"."+a,z.TCMNT)),Hn(y,Z="xl/comments"+C+"."+a,tm(X)),h.comments.push(Z),Ni(H,-1,"../comments"+C+"."+a,z.CMNT),V=!0}W["!legacy"]&&V&&Hn(y,"xl/drawings/vmlDrawing"+C+".vml",G1(C,W["!comments"])),delete W["!comments"],delete W["!legacy"]}H["!id"].rId1&&Hn(y,xo(b),Ec(H))}return null!=l.Strings&&l.Strings.length>0&&(Hn(y,b="xl/sharedStrings."+a,kE(l.Strings,l)),h.strs.push(b),Ni(l.wbrels,-1,"sharedStrings."+a,z.SST)),Hn(y,b="xl/workbook."+a,Fv(s)),h.workbooks.push(b),Ni(l.rels,1,b,z.WB),Hn(y,b="xl/theme/theme1.xml",Qd(s.Themes,l)),h.themes.push(b),Ni(l.wbrels,-1,"theme/theme1.xml",z.THEME),Hn(y,b="xl/styles."+a,Fx(s,l)),h.styles.push(b),Ni(l.wbrels,-1,"styles."+a,z.STY),s.vbaraw&&d&&(Hn(y,b="xl/vbaProject.bin",s.vbaraw),h.vba.push(b),Ni(l.wbrels,-1,"vbaProject.bin",z.VBA)),Hn(y,b="xl/metadata."+a,Gg()),h.metadata.push(b),Ni(l.wbrels,-1,"metadata."+a,z.XLMETA),O.length>1&&(Hn(y,b="xl/persons/person.xml",function Qx(s){var l=[br,Jt("personList",null,{xmlns:is_TCMNT,"xmlns:x":Bd[0]}).replace(/[\/]>/,">")];return s.forEach(function(a,d){l.push(Jt("person",null,{displayName:a,id:"{54EE7950-7262-4200-6969-"+("000000000000"+d).slice(-12)+"}",userId:a,providerId:"None"}))}),l.push("</personList>"),l.join("")}(O)),h.people.push(b),Ni(l.wbrels,-1,"persons/person.xml",z.PEOPLE)),Hn(y,"[Content_Types].xml",Qi(h,l)),Hn(y,"_rels/.rels",Ec(l.rels)),Hn(y,"xl/_rels/workbook.xml.rels",Ec(l.wbrels)),delete l.revssf,delete l.ssf,y}function Zv(s,l){var a="";switch((l||{}).type||"base64"){case"buffer":case"array":return[s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]];case"base64":a=pa(s.slice(0,12));break;case"binary":a=s;break;default:throw new Error("Unrecognized type "+(l&&l.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function ey(s,l){var a=0;e:for(;a<s.length;)switch(s.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return d0(s.slice(a),l);default:break e}return $h.to_workbook(s,l)}function m0(s,l,a,d){return d?(a.type="string",$h.to_workbook(s,a)):$h.to_workbook(l,a)}function hm(s,l){Ao();var a=l||{};if("undefined"!=typeof ArrayBuffer&&s instanceof ArrayBuffer)return hm(new Uint8Array(s),((a=Bn(a)).type="array",a));"undefined"!=typeof Uint8Array&&s instanceof Uint8Array&&!a.type&&(a.type="undefined"!=typeof Deno?"buffer":"array");var h,d=s,y=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),cp={},a.dateNF&&(cp.dateNF=a.dateNF),a.type||(a.type=Oi&&Buffer.isBuffer(s)?"buffer":"base64"),"file"==a.type&&(a.type=Oi?"buffer":"binary",d=function Zb(s){if(void 0!==Ld)return Ld.readFileSync(s);if("undefined"!=typeof Deno)return Deno.readFileSync(s);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var l=File(s);l.open("r"),l.encoding="binary";var a=l.read();return l.close(),a}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("Cannot access file "+s)}(s),"undefined"!=typeof Uint8Array&&!Oi&&(a.type="array")),"string"==a.type&&(y=!0,a.type="binary",a.codepage=65001,d=function XC(s){return s.match(/[^\x00-\x7F]/)?hl(s):s}(s)),"array"==a.type&&"undefined"!=typeof Uint8Array&&s instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var b=new ArrayBuffer(3),C=new Uint8Array(b);if(C.foo="bar",!C.foo)return(a=Bn(a)).type="array",hm(Rb(d),a)}switch((h=Zv(d,a))[0]){case 208:if(207===h[1]&&17===h[2]&&224===h[3]&&161===h[4]&&177===h[5]&&26===h[6]&&225===h[7])return function oD(s,l){return In.find(s,"EncryptedPackage")?nD(s,l):fm(s,l)}(In.read(d,a),a);break;case 9:if(h[1]<=8)return fm(d,a);break;case 60:return d0(d,a);case 73:if(73===h[1]&&42===h[2]&&0===h[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===h[1])return function Vg(s,l){var a=l||{},d=!!a.WTF;a.WTF=!0;try{var h=Xd.to_workbook(s,a);return a.WTF=d,h}catch(y){if(a.WTF=d,!y.message.match(/SYLK bad record ID/)&&d)throw y;return $h.to_workbook(s,l)}}(d,a);break;case 84:if(65===h[1]&&66===h[2]&&76===h[3])return px.to_workbook(d,a);break;case 80:return 75===h[1]&&h[2]<9&&h[3]<9?function sD(s,l){var d=s,h=l||{};return h.type||(h.type=Oi&&Buffer.isBuffer(s)?"buffer":"base64"),qC(l2(d,h),h)}(d,a):m0(s,d,a,y);case 239:return 60===h[3]?d0(d,a):m0(s,d,a,y);case 255:if(254===h[1])return function YC(s,l){var a=s;return"base64"==l.type&&(a=pa(a)),a=Pi.utils.decode(1200,a.slice(2),"str"),l.type="binary",ey(a,l)}(d,a);if(0===h[1]&&2===h[2]&&0===h[3])return cu.to_workbook(d,a);break;case 0:if(0===h[1]&&(h[2]>=2&&0===h[3]||0===h[2]&&(8===h[3]||9===h[3])))return cu.to_workbook(d,a);break;case 3:case 131:case 139:case 140:return zh.to_workbook(d,a);case 123:if(92===h[1]&&114===h[2]&&116===h[3])return Ex.to_workbook(d,a);break;case 10:case 13:case 32:return function KC(s,l){var a="",d=Zv(s,l);switch(l.type){case"base64":a=pa(s);break;case"binary":a=s;break;case"buffer":a=s.toString("binary");break;case"array":a=Zc(s);break;default:throw new Error("Unrecognized type "+l.type)}return 239==d[0]&&187==d[1]&&191==d[2]&&(a=_n(a)),l.type="binary",ey(a,l)}(d,a);case 137:if(80===h[1]&&78===h[2]&&71===h[3])throw new Error("PNG Image File is not a spreadsheet")}return jg.indexOf(h[0])>-1&&h[2]<=12&&h[3]<=31?zh.to_workbook(d,a):m0(s,d,a,y)}function ty(s,l){var a=l||{};return a.type="file",hm(s,a)}function ny(s,l){switch(l.type){case"base64":case"binary":break;case"buffer":case"array":l.type="";break;case"file":return Rd(l.file,In.write(s,{type:Oi?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+l.bookType+"' files");default:throw new Error("Unrecognized type "+l.type)}return In.write(s,l)}function iy(s,l){var a={},d=Oi?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";if(l.compression&&(a.compression="DEFLATE"),l.password)a.type=d;else switch(l.type){case"base64":a.type="base64";break;case"binary":a.type="string";break;case"string":throw new Error("'string' output type invalid for '"+l.bookType+"' files");case"buffer":case"file":a.type=d;break;default:throw new Error("Unrecognized type "+l.type)}var h=s.FullPaths?In.write(s,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[a.type]||a.type,compression:!!l.compression}):s.generate(a);if("undefined"!=typeof Deno&&"string"==typeof h){if("binary"==l.type||"base64"==l.type)return h;h=new Uint8Array(gh(h))}return l.password&&"undefined"!=typeof encrypt_agile?ny(encrypt_agile(h,l.password),l):"file"===l.type?Rd(l.file,h):"string"==l.type?_n(h):h}function Oc(s,l,a){a||(a="");var d=a+s;switch(l.type){case"base64":return mh(hl(d));case"binary":return hl(d);case"string":return s;case"file":return Rd(l.file,d,"utf8");case"buffer":return Oi?Ga(d,"utf8"):"undefined"!=typeof TextEncoder?(new TextEncoder).encode(d):Oc(d,{type:"binary"}).split("").map(function(h){return h.charCodeAt(0)})}throw new Error("Unrecognized type "+l.type)}function gu(s,l){switch(l.type){case"string":case"base64":case"binary":for(var a="",d=0;d<s.length;++d)a+=String.fromCharCode(s[d]);return"base64"==l.type?mh(a):"string"==l.type?_n(a):a;case"file":return Rd(l.file,s);case"buffer":return s;default:throw new Error("Unrecognized type "+l.type)}}function ZC(s,l){Ao(),Mv(s);var a=Bn(l||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),"array"==a.type){a.type="binary";var d=ZC(s,a);return a.type="array",gh(d)}return function JC(s,l){var a=Bn(l||{});return iy(GC(s,a),a)}(s,a)}function Ts(s,l){Ao(),Mv(s);var a=Bn(l||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),"array"==a.type){a.type="binary";var d=Ts(s,a);return a.type="array",gh(d)}var h=0;if(a.sheet&&(h="number"==typeof a.sheet?a.sheet:s.SheetNames.indexOf(a.sheet),!s.SheetNames[h]))throw new Error("Sheet not found: "+a.sheet+" : "+typeof a.sheet);switch(a.bookType||"xlsb"){case"xml":case"xlml":return Oc(p(s,a),a);case"slk":case"sylk":return Oc(Xd.from_sheet(s.Sheets[s.SheetNames[h]],a),a);case"htm":case"html":return Oc(FC(s.Sheets[s.SheetNames[h]],a),a);case"txt":return function aD(s,l){switch(l.type){case"base64":return mh(s);case"binary":case"string":return s;case"file":return Rd(l.file,s,"binary");case"buffer":return Oi?Ga(s,"binary"):s.split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+l.type)}(r3(s.Sheets[s.SheetNames[h]],a),a);case"csv":return Oc(wp(s.Sheets[s.SheetNames[h]],a),a,"\ufeff");case"dif":return Oc(px.from_sheet(s.Sheets[s.SheetNames[h]],a),a);case"dbf":return gu(zh.from_sheet(s.Sheets[s.SheetNames[h]],a),a);case"prn":return Oc($h.from_sheet(s.Sheets[s.SheetNames[h]],a),a);case"rtf":return Oc(Ex.from_sheet(s.Sheets[s.SheetNames[h]],a),a);case"eth":return Oc(hx.from_sheet(s.Sheets[s.SheetNames[h]],a),a);case"fods":return Oc(po(s,a),a);case"wk1":return gu(cu.sheet_to_wk1(s.Sheets[s.SheetNames[h]],a),a);case"wk3":return gu(cu.book_to_wk3(s,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),gu(kC(s,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),function cf(s,l){var a=l||{};return ny(function L(s,l){var a=l||{},d=In.utils.cfb_new({root:"R"}),h="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":h="/Workbook",a.biff=8;break;case"biff5":h="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return In.utils.cfb_add(d,h,kC(s,a)),8==a.biff&&(s.Props||s.Custprops)&&function gC(s,l){var b,a=[],d=[],h=[],y=0,C=e2(p1,"n"),I=e2(Sc,"n");if(s.Props)for(b=Gr(s.Props),y=0;y<b.length;++y)(Object.prototype.hasOwnProperty.call(C,b[y])?a:Object.prototype.hasOwnProperty.call(I,b[y])?d:h).push([b[y],s.Props[b[y]]]);if(s.Custprops)for(b=Gr(s.Custprops),y=0;y<b.length;++y)Object.prototype.hasOwnProperty.call(s.Props||{},b[y])||(Object.prototype.hasOwnProperty.call(C,b[y])?a:Object.prototype.hasOwnProperty.call(I,b[y])?d:h).push([b[y],s.Custprops[b[y]]]);var F=[];for(y=0;y<h.length;++y)x1.indexOf(h[y][0])>-1||T2.indexOf(h[y][0])>-1||null!=h[y][1]&&F.push(h[y]);d.length&&In.utils.cfb_add(l,"/\x05SummaryInformation",R2(d,Ie_SI,I,Sc)),(a.length||F.length)&&In.utils.cfb_add(l,"/\x05DocumentSummaryInformation",R2(a,Ie_DSI,C,p1,F.length?F:null,"05d5cdd59c2e1b10939708002b2cf9ae"))}(s,d),8==a.biff&&s.vbaraw&&function nm(s,l){l.FullPaths.forEach(function(a,d){if(0!=d){var h=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==h.slice(-1)&&In.utils.cfb_add(s,h,l.FileIndex[d].content)}})}(d,In.read(s.vbaraw,{type:"string"==typeof s.vbaraw?"binary":"buffer"})),d}(s,a),a)}(s,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function QC(s,l){var a=Bn(l||{});return iy(iD(s,a),a)}(s,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function e3(s){if(!s.bookType){var a=s.file.slice(s.file.lastIndexOf(".")).toLowerCase();a.match(/^\.[a-z]+$/)&&(s.bookType=a.slice(1)),s.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[s.bookType]||s.bookType}}function ry(s,l,a){var d=a||{};return d.type="file",d.file=l,e3(d),Ts(s,d)}function t3(s,l,a){var d=a||{};return d.type="file",d.file=l,e3(d),ZC(s,d)}function a6(s,l,a,d){var h=a||{};h.type="file",h.file=s,e3(h),h.type="buffer";var y=d;return y instanceof Function||(y=a),Ld.writeFile(s,Ts(l,h),y)}function mn(s,l,a,d,h,y,b,C){var I=jr(a),F=C.defval,O=C.raw||!Object.prototype.hasOwnProperty.call(C,"raw"),H=!0,W=1===h?[]:{};if(1!==h)if(Object.defineProperty)try{Object.defineProperty(W,"__rowNum__",{value:a,enumerable:!1})}catch(Z){W.__rowNum__=a}else W.__rowNum__=a;if(!b||s[a])for(var G=l.s.c;G<=l.e.c;++G){var X=b?s[a][G]:s[d[G]+I];if(void 0!==X&&void 0!==X.t){var V=X.v;switch(X.t){case"z":if(null==V)break;continue;case"e":V=0==V?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+X.t)}if(null!=y[G]){if(null==V)if("e"==X.t&&null===V)W[y[G]]=null;else if(void 0!==F)W[y[G]]=F;else{if(!O||null!==V)continue;W[y[G]]=null}else W[y[G]]=O&&("n"!==X.t||"n"===X.t&&!1!==C.rawNumbers)?V:Cc(X,V,C);null!=V&&(H=!1)}}else{if(void 0===F)continue;null!=y[G]&&(W[y[G]]=F)}}return{row:W,isempty:H}}function g0(s,l){if(null==s||null==s["!ref"])return[];var a={t:"n",v:0},d=0,h=1,y=[],b=0,C="",I={s:{r:0,c:0},e:{r:0,c:0}},F=l||{},O=null!=F.range?F.range:s["!ref"];switch(1===F.header?d=1:"A"===F.header?d=2:Array.isArray(F.header)?d=3:null==F.header&&(d=0),typeof O){case"string":I=Yi(O);break;case"number":(I=Yi(s["!ref"])).s.r=O;break;default:I=O}d>0&&(h=0);var H=jr(I.s.r),W=[],G=[],X=0,V=0,Z=Array.isArray(s),he=I.s.r,ge=0,le={};Z&&!s[he]&&(s[he]=[]);var Ke=F.skipHidden&&s["!cols"]||[],tt=F.skipHidden&&s["!rows"]||[];for(ge=I.s.c;ge<=I.e.c;++ge)if(!(Ke[ge]||{}).hidden)switch(W[ge]=to(ge),a=Z?s[he][ge]:s[W[ge]+H],d){case 1:y[ge]=ge-I.s.c;break;case 2:y[ge]=W[ge];break;case 3:y[ge]=F.header[ge-I.s.c];break;default:if(null==a&&(a={w:"__EMPTY",t:"s"}),C=b=Cc(a,null,F),V=le[b]||0){do{C=b+"_"+V++}while(le[C]);le[b]=V,le[C]=1}else le[b]=1;y[ge]=C}for(he=I.s.r+h;he<=I.e.r;++he)if(!(tt[he]||{}).hidden){var ze=mn(s,I,he,W,d,y,Z,F);(!1===ze.isempty||(1===d?!1!==F.blankrows:F.blankrows))&&(G[X++]=ze.row)}return G.length=X,G}var n3=/"/g;function i3(s,l,a,d,h,y,b,C){for(var I=!0,F=[],O="",H=jr(a),W=l.s.c;W<=l.e.c;++W)if(d[W]){var G=C.dense?(s[a]||[])[W]:s[d[W]+H];if(null==G)O="";else if(null!=G.v){I=!1,O=""+(C.rawNumbers&&"n"==G.t?G.v:Cc(G,null,C));for(var X=0,V=0;X!==O.length;++X)if((V=O.charCodeAt(X))===h||V===y||34===V||C.forceQuotes){O='"'+O.replace(n3,'""')+'"';break}"ID"==O&&(O='"ID"')}else null==G.f||G.F?O="":(I=!1,(O="="+G.f).indexOf(",")>=0&&(O='"'+O.replace(n3,'""')+'"'));F.push(O)}return!1===C.blankrows&&I?null:F.join(b)}function wp(s,l){var a=[],d=null==l?{}:l;if(null==s||null==s["!ref"])return"";var h=Yi(s["!ref"]),y=void 0!==d.FS?d.FS:",",b=y.charCodeAt(0),C=void 0!==d.RS?d.RS:"\n",I=C.charCodeAt(0),F=new RegExp(("|"==y?"\\|":y)+"+$"),O="",H=[];d.dense=Array.isArray(s);for(var W=d.skipHidden&&s["!cols"]||[],G=d.skipHidden&&s["!rows"]||[],X=h.s.c;X<=h.e.c;++X)(W[X]||{}).hidden||(H[X]=to(X));for(var V=0,Z=h.s.r;Z<=h.e.r;++Z)(G[Z]||{}).hidden||null!=(O=i3(s,h,Z,H,b,I,y,d))&&(d.strip&&(O=O.replace(F,"")),(O||!1!==d.blankrows)&&a.push((V++?C:"")+O));return delete d.dense,a.join("")}function r3(s,l){l||(l={}),l.FS="\t",l.RS="\n";var a=wp(s,l);if(void 0===Pi||"string"==l.type)return a;var d=Pi.utils.encode(1200,a,"str");return String.fromCharCode(255)+String.fromCharCode(254)+d}function mm(s,l,a){var d=a||{},h=+!d.skipHeader,y=s||{},b=0,C=0;if(y&&null!=d.origin)if("number"==typeof d.origin)b=d.origin;else{var I="string"==typeof d.origin?Xr(d.origin):d.origin;b=I.r,C=I.c}var F,O={s:{c:0,r:0},e:{c:C,r:b+l.length-1+h}};if(y["!ref"]){var H=Yi(y["!ref"]);O.e.c=Math.max(O.e.c,H.e.c),O.e.r=Math.max(O.e.r,H.e.r),-1==b&&(O.e.r=(b=H.e.r+1)+l.length-1+h)}else-1==b&&(b=0,O.e.r=l.length-1+h);var W=d.header||[],G=0;l.forEach(function(V,Z){Gr(V).forEach(function(he){-1==(G=W.indexOf(he))&&(W[G=W.length]=he);var ge=V[he],le="z",Ke="",tt=qn({c:C+G,r:b+Z+h});F=v0(y,tt),!ge||"object"!=typeof ge||ge instanceof Date?("number"==typeof ge?le="n":"boolean"==typeof ge?le="b":"string"==typeof ge?le="s":ge instanceof Date?(le="d",d.cellDates||(le="n",ge=ns(ge)),Ke=d.dateNF||Wn[14]):null===ge&&d.nullError&&(le="e",ge=0),F?(F.t=le,F.v=ge,delete F.w,delete F.R,Ke&&(F.z=Ke)):y[tt]=F={t:le,v:ge},Ke&&(F.z=Ke)):y[tt]=ge})}),O.e.c=Math.max(O.e.c,C+W.length-1);var X=jr(b);if(h)for(G=0;G<W.length;++G)y[to(G+C)+X]={t:"s",v:W[G]};return y["!ref"]=yi(O),y}function v0(s,l,a){if("string"==typeof l){if(Array.isArray(s)){var d=Xr(l);return s[d.r]||(s[d.r]=[]),s[d.r][d.c]||(s[d.r][d.c]={t:"z"})}return s[l]||(s[l]={t:"z"})}return v0(s,qn("number"!=typeof l?l:{r:l,c:a||0}))}function sy(s,l,a,d){var h=1;if(!a)for(;h<=65535&&-1!=s.SheetNames.indexOf(a="Sheet"+h);++h,a=void 0);if(!a||s.SheetNames.length>=65535)throw new Error("Too many worksheets");if(d&&s.SheetNames.indexOf(a)>=0){var y=a.match(/(^.*?)(\d+)$/);h=y&&+y[2]||0;var b=y&&y[1]||a;for(++h;h<=65535&&-1!=s.SheetNames.indexOf(a=b+h);++h);}if(rf(a),s.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return s.SheetNames.push(a),s.Sheets[a]=l,a}function ay(s,l,a){return l?(s.l={Target:l},a&&(s.l.Tooltip=a)):delete s.l,s}var dd,uD={encode_col:to,encode_row:jr,encode_cell:qn,encode_range:yi,decode_col:t1,decode_row:zd,split_cell:function n1(s){return s.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Xr,decode_range:no,format_cell:Cc,sheet_add_aoa:U5,sheet_add_json:mm,sheet_add_dom:zv,aoa_to_sheet:Eh,json_to_sheet:function Eo(s,l){return mm(null,s,l)},table_to_sheet:PC,table_to_book:function OC(s,l){return $d(PC(s,l),l)},sheet_to_csv:wp,sheet_to_txt:r3,sheet_to_json:g0,sheet_to_html:FC,sheet_to_formulae:function _0(s){var a,l="",d="";if(null==s||null==s["!ref"])return[];var C,h=Yi(s["!ref"]),y="",b=[],I=[],F=Array.isArray(s);for(C=h.s.c;C<=h.e.c;++C)b[C]=to(C);for(var O=h.s.r;O<=h.e.r;++O)for(y=jr(O),C=h.s.c;C<=h.e.c;++C)if(l=b[C]+y,d="",void 0!==(a=F?(s[O]||[])[C]:s[l])){if(null!=a.F){if(l=a.F,!a.f)continue;d=a.f,-1==l.indexOf(":")&&(l=l+":"+l)}if(null!=a.f)d=a.f;else{if("z"==a.t)continue;if("n"==a.t&&null!=a.v)d=""+a.v;else if("b"==a.t)d=a.v?"TRUE":"FALSE";else if(void 0!==a.w)d="'"+a.w;else{if(void 0===a.v)continue;d="s"==a.t?"'"+a.v:""+a.v}}I[I.length]=l+"="+d}return I},sheet_to_row_object_array:g0,sheet_get_cell:v0,book_new:function oy(){return{SheetNames:[],Sheets:{}}},book_append_sheet:sy,book_set_sheet_visibility:function s3(s,l,a){s.Workbook||(s.Workbook={}),s.Workbook.Sheets||(s.Workbook.Sheets=[]);var d=function o3(s,l){if("number"==typeof l){if(l>=0&&s.SheetNames.length>l)return l;throw new Error("Cannot find sheet # "+l)}if("string"==typeof l){var a=s.SheetNames.indexOf(l);if(a>-1)return a;throw new Error("Cannot find sheet name |"+l+"|")}throw new Error("Cannot find sheet |"+l+"|")}(s,l);switch(s.Workbook.Sheets[d]||(s.Workbook.Sheets[d]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}s.Workbook.Sheets[d].Hidden=a},cell_set_number_format:function a3(s,l){return s.z=l,s},cell_set_hyperlink:ay,cell_set_internal_link:function l3(s,l,a){return ay(s,"#"+l,a)},cell_add_comment:function lD(s,l,a){s.c||(s.c=[]),s.c.push({t:l,a:a||"SheetJS"})},sheet_set_array_formula:function cD(s,l,a,d){for(var h="string"!=typeof l?l:Yi(l),y="string"==typeof l?l:yi(l),b=h.s.r;b<=h.e.r;++b)for(var C=h.s.c;C<=h.e.c;++C){var I=v0(s,b,C);I.t="n",I.F=y,delete I.v,b==h.s.r&&C==h.s.c&&(I.f=a,d&&(I.D=!0))}return s},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},c3={to_json:function y0(s,l){var a=dd({objectMode:!0});if(null==s||null==s["!ref"])return a.push(null),a;var d={t:"n",v:0},h=0,y=1,b=[],C=0,I="",F={s:{r:0,c:0},e:{r:0,c:0}},O=l||{},H=null!=O.range?O.range:s["!ref"];switch(1===O.header?h=1:"A"===O.header?h=2:Array.isArray(O.header)&&(h=3),typeof H){case"string":F=Yi(H);break;case"number":(F=Yi(s["!ref"])).s.r=H;break;default:F=H}h>0&&(y=0);var W=jr(F.s.r),G=[],X=0,V=Array.isArray(s),Z=F.s.r,he=0,ge={};V&&!s[Z]&&(s[Z]=[]);var le=O.skipHidden&&s["!cols"]||[],Ke=O.skipHidden&&s["!rows"]||[];for(he=F.s.c;he<=F.e.c;++he)if(!(le[he]||{}).hidden)switch(G[he]=to(he),d=V?s[Z][he]:s[G[he]+W],h){case 1:b[he]=he-F.s.c;break;case 2:b[he]=G[he];break;case 3:b[he]=O.header[he-F.s.c];break;default:if(null==d&&(d={w:"__EMPTY",t:"s"}),I=C=Cc(d,null,O),X=ge[C]||0){do{I=C+"_"+X++}while(ge[I]);ge[C]=X,ge[I]=1}else ge[C]=1;b[he]=I}return Z=F.s.r+y,a._read=function(){for(;Z<=F.e.r;)if(!(Ke[Z-1]||{}).hidden){var tt=mn(s,F,Z,G,h,b,V,O);if(++Z,!1===tt.isempty||(1===h?!1!==O.blankrows:O.blankrows))return void a.push(tt.row)}return a.push(null)},a},to_html:function pD(s,l){var a=dd(),d=l||{},y=null!=d.footer?d.footer:zo;a.push(null!=d.header?d.header:IC);var b=no(s["!ref"]);d.dense=Array.isArray(s),a.push(MC(0,0,d));var C=b.s.r,I=!1;return a._read=function(){if(C>b.e.r)return I||(I=!0,a.push("</table>"+y)),a.push(null);for(;C<=b.e.r;){a.push(Hv(s,b,C,d)),++C;break}},a},to_csv:function fD(s,l){var a=dd(),d=null==l?{}:l;if(null==s||null==s["!ref"])return a.push(null),a;var h=Yi(s["!ref"]),y=void 0!==d.FS?d.FS:",",b=y.charCodeAt(0),C=void 0!==d.RS?d.RS:"\n",I=C.charCodeAt(0),F=new RegExp(("|"==y?"\\|":y)+"+$"),O="",H=[];d.dense=Array.isArray(s);for(var W=d.skipHidden&&s["!cols"]||[],G=d.skipHidden&&s["!rows"]||[],X=h.s.c;X<=h.e.c;++X)(W[X]||{}).hidden||(H[X]=to(X));var V=h.s.r,Z=!1,he=0;return a._read=function(){if(!Z)return Z=!0,a.push("\ufeff");for(;V<=h.e.r;)if(++V,!(G[V-1]||{}).hidden&&null!=(O=i3(s,h,V-1,H,b,I,y,d))&&(d.strip&&(O=O.replace(F,"")),O||!1!==d.blankrows))return a.push((he++?C:"")+O);return a.push(null)},a},set_readable:function dD(s){dd=s}};const u3=fi_version},5861:(Lf,Pd,vo)=>{"use strict";function fi(Ks,Ia,lo,fa,vs,Io,Ao){try{var pi=Ks[Io](Ao),ji=pi.value}catch(Os){return void lo(Os)}pi.done?Ia(ji):Promise.resolve(ji).then(fa,vs)}function Do(Ks){return function(){var Ia=this,lo=arguments;return new Promise(function(fa,vs){var Io=Ks.apply(Ia,lo);function Ao(ji){fi(Io,fa,vs,Ao,pi,"next",ji)}function pi(ji){fi(Io,fa,vs,Ao,pi,"throw",ji)}Ao(void 0)})}}vo.d(Pd,{Z:()=>Do})}},Lf=>{Lf(Lf.s=1773)}]);